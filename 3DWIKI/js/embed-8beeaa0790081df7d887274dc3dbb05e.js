!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(window,function(){return(window.webpackJsonp=window.webpackJsonp||[]).push([[83,3,37,42,43,44,45,53,54,55,102],{"+5pB":function(e,t){e.exports="uniform float uOutlineFactor;\nuniform vec2 uPixelRatio;\nuniform float uHighlightFactor;\nuniform float uLineWidth;\n\nuniform sampler2D TextureOutline;\nuniform vec2 uTextureOutlineSize;\n\nvec4 outline() {\n    float fac0 = 2.0;\n    float fac1 = 1.0;\n    float offsetx = uPixelRatio.x / uTextureOutlineSize[0] * uLineWidth;\n    float offsety = uPixelRatio.y / uTextureOutlineSize[1] * uLineWidth;\n\n    vec4 texel0 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(offsetx, offsety));\n    vec4 texel1 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(offsetx, 0.0));\n    vec4 texel2 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(offsetx, -offsety));\n    vec4 texel3 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(0.0, -offsety));\n    vec4 texel4 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(-offsetx, -offsety));\n    vec4 texel5 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(-offsetx, 0.0));\n    vec4 texel6 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(-offsetx, offsety));\n    vec4 texel7 = TEXTURE_2D_TextureOutline(gTexCoord + vec2(0.0, offsety));\n\n    vec4 rowx = -fac0 * texel5 + fac0 * texel1 + -fac1 * texel6 + fac1 * texel0 + -fac1 * texel4 + fac1 * texel2;\n    vec4 rowy = -fac0 * texel3 + fac0 * texel7 + -fac1 * texel4 + fac1 * texel6 + -fac1 * texel2 + fac1 * texel0;\n\n    float magSqr = sqrt(dot(rowy, rowy) + dot(rowx, rowx));\n    bool infMag = magSqr < 1.0 / 65025.0;\n\n    vec3 texelCenter = TEXTURE_2D_TextureOutline(gTexCoord).rgb;\n    if (texelCenter == vec3(0.0) || (uHighlightFactor == 0.0 && infMag)) {\n        discard;\n    }\n\n    float finalFactor = infMag ? uHighlightFactor : min(1.0, sqrt(magSqr) * uOutlineFactor);\n\n    return finalFactor * vec4(texelCenter, 1.0);\n}\n"},"+L90":function(e,t,n){"use strict";var i=n("YfG3"),r=n("OZf9"),a=n("hbEN"),o=n("syB0"),s=n("EVdn"),u=n.n(s),l=n("G9Ht"),c=n.n(l),h=n("htjh"),d=n.n(h),f=n("vBtE"),p=n("Y14P"),g=n("QKgc"),m=n("JoeM"),v=n("6xPH"),_=n("gCTM"),b=n("gBaA"),S=n("xvcl"),y=n("JJ+t"),x=n("6uKY"),C=n("IKww"),w=n("P1HB"),T=n("qCPs"),M=n("i4v/"),E=M.a.extend({VIEWER_MODE_ORBIT:0,VIEWER_MODE_FPS:1,HOTSPOT_CYCLE_PAUSE:1e4,events:{"click .has-menu":"toggleMenu","touchstart .has-menu":"toggleMenuTouch",keydown:"onKeydown",wheel:"onMousewheel","mousedown  .webgl .canvas":"cameraMoveStart","touchstart .webgl .canvas":"cameraMoveStart","mousedown  .webgl":"mouseDownEvent","mouseup    .webgl":"mouseUpEvent","touchstart .webgl":"mouseDownEvent","touchend   .webgl":"mouseUpEvent","mousedown  .fallback":"mouseDownEvent","touchstart .fallback":"mouseDownEvent",'click      [data-action="watermark"]':"onWatermarkClick",'touchend   [data-action="watermark"]':"onWatermarkClick"},constructor:function(){this.globalCloseEvent=this.globalCloseEvent.bind(this),this.globalMouseUpEvent=this.globalMouseUpEvent.bind(this),this.onKeydown=this.onKeydown.bind(this),M.a.prototype.constructor.apply(this,arguments)},delegateEvents:function(){M.a.prototype.delegateEvents.apply(this,arguments);var e=u()(document);e.on("keydown",this.onKeydown),e.on("mousedown",this.globalCloseEvent),e.on("mouseup",this.globalMouseUpEvent),e.on("mousewheel.delegateEvents"+this.cid,".annotation",this.preventScroll)},undelegateEvents:function(){M.a.prototype.undelegateEvents.apply(this,arguments);var e=u()(document);e.off("keydown",this.onKeydown),e.off("mousedown",this.globalCloseEvent),e.off("mouseup",this.globalMouseUpEvent),e.off("mousewheel.delegateEvents"+this.cid,".annotation",this.preventScroll)},enable:function(){this.$(".gui").removeClass("hidden"),Object(o.a)(function(){this.$(".gui").addClass("enabled")}.bind(this))},disable:function(){this.$(".gui").removeClass("enabled").addClass("hidden")},closeMenus:function(){this.$(".gui").find(".has-menu").removeClass("active"),this.viewer.subviews.generalControls&&this.viewer.subviews.generalControls.settings&&this.viewer.subviews.generalControls.settings.togglePane(!1)},cameraMoveStart:function(){this.viewer.$(".webgl").addClass("camera-moving"),this.viewer.subviews.hotspots&&this.viewer.subviews.hotspots.pauseHotspotCycleInterval()},cameraMoveEnd:function(){this.viewer.$(".webgl").removeClass("camera-moving"),this.viewer.subviews.hotspots&&this.viewer.subviews.hotspots._hotspotCycleIntervalPaused&&this.viewer.subviews.hotspots.beginHotspotCycleInterval(this.HOTSPOT_CYCLE_PAUSE)},onMousewheel:function(){var e;if(this.viewer.scene){var t=this.viewer.scene.getFeatures();t.hasOwnProperty("camera")&&(e=t.camera.getModel().get("indexManipulator"))}if(e===this.VIEWER_MODE_FPS){var n=this.viewer.scene.getViewerOSGJS().getManipulator().getCurrentManipulator()._stepFactor,i=Math.round(n/4*100);this.viewer.subviews.osd.show("Walking speed: "+i,{duration:1e3})}},onKeydown:function(e){var t=document.activeElement,n="";32===e.which&&t&&(n=t.tagName,-1!==["BODY","CANVAS"].indexOf(n)&&(this.recenter(),e.preventDefault())),e.which>=96&&e.which<=105&&this.timeline&&this.timeline.setCurrentAnimation(e.which-96),27===e.which&&(this.viewer.subviews.hotspots&&this.viewer.subviews.hotspots._hotspots.length&&(this.viewer.subviews.hotspots.currentHotspot=-1,this.viewer.subviews.hotspots.applyCurrentHotspot(),this.viewer.subviews.hotspots.unrevealHotspots(),this.viewer.subviews.hotspots.stopHotspotCycleInterval()),this.closeMenus(),this.viewer.subviews.helpOverlay.hide())},preventParentScroll:function(e,t){var n=u()(".hotspot-controls .list"),i=n.height(),r=n.children()[0].scrollHeight,a=n.children()[0].scrollTop;(a===r-i&&t<0||0===a&&t>0)&&e.preventDefault()},preventScroll:function(e){e.preventDefault()},globalMouseUpEvent:function(){this.cameraMoveEnd()},globalCloseEvent:function(e){u()(e.target).hasClass("has-menu")||u()(e.target).parents(".has-menu").length||this.closeMenus(e)},toggleMenuTouch:function(e){if("label"===e.target.tagName.toLowerCase())return e;e.preventDefault(),e.stopPropagation(),this.toggleMenu(e)},toggleMenu:function(e){if("label"===e.target.tagName.toLowerCase())return e;e.preventDefault(),e.stopPropagation();var t=u()(e.currentTarget);t.hasClass("active")?e.currentTarget===e.target&&t.attr("data-title",t.attr("title")).removeClass("active"):(this.closeMenus(),t.attr("title",t.attr("data-title")).removeAttr("data-title").addClass("active"))},renderSetting:function(e,t){this.viewer.$('[data-setting="'+e+'"]').removeClass("active"),"wireframeColor"===e&&!1===this.viewer.proxySettings.get("wireframeEnable")||this.viewer.$('[data-setting="'+e+'"][data-value="'+t+'"]').addClass("active")},getPointerPosition:function(e){var t,n=e.originalEvent?e.originalEvent:e,i={};return n.touches&&n.touches.length||n.changedTouches&&n.changedTouches.length?(t=(t=n.touches&&n.touches.length?n.touches:n.changedTouches)[0],i.x=t.pageX,i.y=t.pageY,i.type="Touch"):(i.x=e.pageX,i.y=e.pageY,i.type="Mouse"),i},mouseDownEvent:function(e){this.mouseDownPosition=this.getPointerPosition(e),this.viewer.subviews.hint.hide(),"touchstart"===e.type&&(e.target===e.currentTarget||this.scene&&this.scene.getCanvas&&e.target===this.viewer.scene.getCanvas())&&e.preventDefault()},mouseUpEvent:function(e){if(this.mouseDownPosition){var t=this.getPointerPosition(e);if(this.viewer.$el.hasClass("started")){if(Math.abs(this.mouseDownPosition.x-t.x)>20||Math.abs(this.mouseDownPosition.y-t.y)>20){var n=this.viewer._currentModel?this.viewer._currentModel.get("uid"):this.viewer._currentUid;b.a.modelEmbedModelInteraction(n,t.type)}this.mouseDownPosition=null}}},recenter:function(){this.viewer.scene&&this.viewer.scene.getViewerOSGJS().getManipulator().computeHomePosition()},onWatermarkClick:function(){var e=u()(".watermark").find("a").attr("href").split("models/").pop().split("/")[0];b.a.modelEmbedWatermarkClicked(e)}}),A=n("MVZn"),O=n.n(A),R=n("QLQS"),P=n("fgaA"),I=n("f5KD"),N=n("wsGC"),L=R.a.osg,k=new d.a({device:"VWR"}),D=M.a.extend({optionTypes:{color:I.b.string},initialize:function(){M.a.prototype.initialize.apply(this,arguments),this.options=O()({},this.options,{color:this.options.color||N.b.skfbBlue})},reset:function(){this._primaryProgress=0,this._secondaryProgress=0},handleLoading:function(e){e.scene.on("primary-progress",function(e){if(this.setPrimaryProgress(e.progress),Object(P.a)().isApp){var t=k.createMessage({data:{progress:e.progress+""}});this.previousMessage&&this.previousMessage.removeFromHash(),t.appendToHash(),this.previousMessage=t}}.bind(this)),e.scene.on("secondary-progress",function(e){this.setSecondaryProgress(e.progress)}.bind(this)),e.scene.on("success",function(){this.viewer.$el.removeClass("model-loading").addClass("model-loaded"),e.model.trigger("status:loaded"),this.trigger("loaded")}.bind(this)),e.scene.on("fail",function(){L.error("Viewer instanciation failed")}.bind(this))},setPrimaryProgress:function(e){this._primaryProgress=Math.min(Math.max(this._primaryProgress,e),1),this.updateMainProgressBar(),1===this._primaryProgress&&this.setSecondaryProgress(0)},setSecondaryProgress:function(e){this._secondaryProgress=Math.min(Math.max(0,e),1),this.updateSecondaryProgressBar()},updateMainProgressBar:function(){var e=this._primaryProgress,t=1===e;this.$(".main-progress").toggleClass("loading",!t),this.$(".main-progress-display__progress").css({width:100*e+"%",backgroundColor:this.options.color}),this.$(".main-progress-percentage").text(Math.floor(100*e)+" %")},updateSecondaryProgressBar:function(){var e=this._secondaryProgress;this.$(".secondary-progress-percentage").text(Math.floor(100*e)+" %"),this.$(".secondary-progress-display").css("width",100*e+"%");var t=1===this._primaryProgress,n=1===e;this.$(".secondary-progress").toggleClass("visible",t&&!n)}}),F=n("4kdM"),V=M.a.extend({initialize:function(){M.a.prototype.initialize.apply(this,arguments),this.$hint=this.$(".viewer-hint"),this.$hint.find(".viewer-movehint .label").html(this.moveHintTemplate()),this.options.fallback&&this.$hint.addClass("fallback-position")},show:function(e){e=Object(F.a)(Object(i.a)({},e),{force:!1});var t=1===p.a.get("sf_show_viewer_hint",1),n=Object(P.a)().uiHint;2===n&&(e.force=!0),(e.force||1===n&&t)&&this.$hint.addClass("active")},hide:function(e){e=Object(F.a)(Object(i.a)({},e),{remember:!0}),this.$hint.removeClass("active"),e.remember&&p.a.set("sf_show_viewer_hint",0,{expires:15552e6})},moveHintTemplate:function(){return c.a.any?"touch &amp; drag<br>to rotate":"click &amp; hold<br>to rotate"}}),B=n("CpTu"),U=n("qAkX"),j=n("fujP"),G=n("dZz+"),H=n("eEbW"),z=n("12sq"),W=n("22T1");var q=n("dAuA"),X=n("9mpE"),Y=function(e){var t=u()(document);t.on("fullscreenchange",e),t.on("webkitfullscreenchange",e),t.on("MSFullscreenchange",e),t.on("mozfullscreenchange",e)},K=function(e){var t=u()(document);t.off("fullscreenchange",e),t.off("webkitfullscreenchange",e),t.off("MSFullscreenchange",e),t.off("mozfullscreenchange",e)},Q=function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled},J=function(){return document.fullScreen||document.mozFullScreen||void 0!==document.msFullscreenElement&&null!==document.msFullscreenElement||document.webkitIsFullScreen},Z=function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen&&e.mozRequestFullScreen()},$=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen()},ee=n("RKCD"),te=n("dYt1"),ne=n("1myf"),ie=n("xM9Z"),re=Object(ee.a)(['<div class="setting" data-setting="<%= name %>" data-setting-group="<%= group %>">','   <p class="setting-label"><%= label %></p>',"</div>"].join("")),ae=Object(ee.a)(['<div class="setting" data-setting="<%= name %>" data-setting-group="<%= group %>" data-setting-type="<%= type %>">','   <p class="setting-label"><%= label %></p>','   <p class="setting-value" data-value="<%= value %>" ><%= prettyValue %></p>',"</div>"].join("")),oe=Object(ee.a)(['   <a class="control-menu-back back">Back</a>','   <ul class="setting-list" data-setting="<%= name %>" data-setting-type="<%= type %>">',"       <%= listItems %>","   </ul>"].join("")),se=Object(ee.a)(['<li class="setting-item <% if (selected) { %>selected<% } %>" data-value="<%= value %>">',"   <%= prettyValue %>",'   <span class="shortcut" title="Keyboard shortcut"><%= shortcut %></span>',"</li>"].join("")),ue=M.a.extend({events:{"click .setting":"onSettingClick","touchend .setting":"onSettingClick","click .back":"togglePane","touchend .back":"togglePane","click .setting-item":"onSettingValueClick","touchend .setting-item":"onSettingValueClick",'click [data-setting="viewerMode"] li':"onViewerModeChange",'touchend [data-setting="viewerMode"] li':"onViewerModeChange"},initialize:function(e){if(M.a.prototype.initialize.apply(this,arguments),this.settings=e.settings,this.viewer=e.viewer,Object(j.a)(this.settings))return console.warn("No settings object given to SettingsMenu"),void this.$el.hide();this.$list=this.$(".control-menu-list"),this.$pane=this.$(".control-menu-pane"),this.$el.on("click touchend",'.wireframe-colors a[data-setting="wireframeColor"]:not(.active)',this.onWireframeColorClick.bind(this)),this.$el.on("click touchend",'.wireframe-colors a[data-setting="wireframeColor"].active',this.onDisableWireframeClick.bind(this)),this.$el.on("click touchend",'.wireframe-colors a[data-setting="wireframeEnable"]',this.onDisableWireframeClick.bind(this)),this.viewer.proxySettings.on("change",this.render.bind(this))},onViewerModeChange:function(e){e&&"touchend"===e.type&&e.preventDefault(),"0"===this.viewer.proxySettings.get("viewerMode")?this.viewer.subviews.osd.show("Click and hold to rotate",{position:"top",duration:3e3}):this.viewer.subviews.osd.show("Mouse to look around, keyboard to move",{position:"top",duration:3e3})},onDisableWireframeClick:function(e){e&&"touchend"===e.type&&e.preventDefault();var t=this.$('.wireframe-colors [data-setting="wireframeEnable"]');b.a.modelViewerWireframeToggleClicked(!1),this.viewer.proxySettings.set("wireframeEnable",!1),t.parent().find(".active").removeClass("active"),t.addClass("active")},onWireframeColorClick:function(e){e&&"touchend"===e.type&&e.preventDefault();var t=u()(e.currentTarget),n=t.attr("data-value");this.viewer.proxySettings.set("wireframeColor",n),this.viewer.proxySettings.set("wireframeEnable",!0),t.parent().find(".active").removeClass("active"),t.addClass("active"),b.a.modelViewerWireframeColorSelected(n)},onSettingClick:function(e){e&&"touchend"===e.type&&e.preventDefault&&e.preventDefault();var t=u()(e.currentTarget).attr("data-setting"),n=this.settings[t];if(n.name=t,n.isButton)return this[n.action]&&this[n.action](e);this.renderSettingPane(n),this.togglePane(!0)},onSettingValueClick:function(e){e.preventDefault(),e.stopPropagation();var t=u()(e.currentTarget),n=t.attr("data-value"),i=t.closest("[data-setting]"),r=i.attr("data-setting"),a=i.attr("data-setting-type")||"string";switch(r){case"shadingStyle":b.a.modelViewerShadingSelected(n);break;case"viewerMode":b.a.modelViewerViewerModeSelected(n)}switch(a){case"number":n=parseFloat(n);break;case"bool":n="true"===n}this.viewer.proxySettings.set(r,n)},onSettingChangeWhileOpen:function(){this.renderSettingPane(this._currentSetting)},renderSettingPane:function(e){var t,n="",i=this.viewer.proxySettings.get(e.name),a=this.getSettingFromValue(e.name,i),o=this.viewer._currentModel.get("options").shading.type;this._currentSetting&&this.viewer.proxySettings.off("change:"+this._currentSetting.name,this.onSettingChangeWhileOpen,this),this._currentSetting=e,this._currentSetting&&this.viewer.proxySettings.on("change:"+this._currentSetting.name,this.onSettingChangeWhileOpen,this),"shadingStyle"===e.name&&"lit"!==o||Object(r.a)(e.settings,function(e){n+=se({value:e.value,type:e.type||"string",prettyValue:e.label,selected:a===e,shortcut:e.shortcut||""})}),t=(e.paneTemplate||oe)({listItems:n,name:e.name,type:e.type||"string",viewerSettings:this.viewer.proxySettings.toJSON()}),this.$pane.html(t);var s=this.viewer.scene.getFeatures().webVR.getModel();"viewerMode"!==this._currentSetting.name||s.get("hasNativeHMD")?this.$('[data-value="2"]').show():this.$('[data-value="2"]').hide()},getSettingFromValue:function(e,t){var n;return(this.settings[e].settings||[]).forEach(function(e){e.value!==t&&e.value+""!=t+""||(n=e)}),n},togglePane:function(e,t){var n=this;t&&"touchend"===t.type&&t.preventDefault(),this.$el.toggleClass("detail",e),Object(ie.a)(this.$(".control-menu-wrapper")).then(function(){n.$el.hasClass("detail")||n.clearPane()})},clearPane:function(){this.$pane.html("")},render:function(){var e="",t=this.viewer.scene.getFeatures().quality.getModel(),n=this.viewer.scene.getFeatures().hotspot.getModel(),i=this.viewer.scene.getFeatures().animation.getModel(),a=[];Object(r.a)(this.settings,function(e,t){var n=Object(te.a)(e);n.name=t,a.push(n)}),a=Object(ne.a)(a,"order"),Object(r.a)(a,function(t){var n,i=t.name;if(t.isButton)n=re({name:i,label:t.label,group:t.group});else{var r=this.getSettingFromValue(i,this.viewer.proxySettings.get(i))||t.settings[0];n=ae({name:i,label:t.label,value:r.value,prettyValue:r.label,group:t.group,type:r.type})}e+=n}.bind(this)),this.$list.html(e),M.a.prototype.render.apply(this,arguments),i&&i.get("animations").length?this.$('[data-setting-group="animation"]').show():this.$('[data-setting-group="animation"]').hide(),t&&t.get("promiseReady").isFulfilled()?this.$('[data-setting-group="textureQuality"]').show():this.$('[data-setting-group="textureQuality"]').hide(),n&&n.get("hotspots").length?this.$('[data-setting-group="annotation"]').show():this.$('[data-setting-group="annotation"]').hide(),t&&t.get("promiseReady").isFulfilled()&&window.requestAnimationFrame(function(){var e=this.getSettingFromValue("textureQuality",t.get("level"));this.$('[data-setting="textureQuality"] .setting-value').attr("data-value",e.value).text(e.label)}.bind(this))},onTextureQualityReady:function(e){var t=this.viewer.scene.getFeatures().quality;if(t)if(e.low||e.mid||e.high){var n=t.getModel().get("level");this.viewer.proxySettings.set("textureQuality",n),this.render()}else this.$('[data-setting="textureQuality"]').remove()}}),le=n("uGjJ"),ce=n("K/JG"),he=z.a.shortcuts;Object(P.a)().uiInspector?(he.inspectorControl.shortcuts[0].keyCombinations="1",he.inspectorControl.shortcuts[1].keyCombinations="2",he.inspectorControl.shortcuts[2].keyCombinations="3",he.inspectorControl.shortcuts[3].keyCombinations="4",he.inspectorControl.shortcuts[4].keyCombinations="6",he.viewerRendering.shortcuts[0].keyCombinations="",he.viewerRendering.shortcuts[1].keyCombinations="",he.viewerRendering.shortcuts[2].keyCombinations="",he.viewerRendering.shortcuts[3].keyCombinations="5"):(he.inspectorControl.shortcuts[0].keyCombinations="",he.inspectorControl.shortcuts[1].keyCombinations="",he.inspectorControl.shortcuts[2].keyCombinations="",he.inspectorControl.shortcuts[3].keyCombinations="",he.inspectorControl.shortcuts[4].keyCombinations="");var de=new y.a(he.viewerRendering),fe=function(e){var t=_.default.getFromString('<a           class="{{ className }} {{ "active" if isActive else "" }}"           data-setting="{{ dataSetting }}"           data-value="{{ dataValue }}"           title="{{ title }}">        </a>');return _.default.getFromString('<p class="wireframe-title">        Wireframe         <span class="shortcut" title="Keyboard shortcut">           {{ shortcut | safe }}        </span>        </p>        <div class="wireframe-colors">           {{ colorItems | safe }}        </div>')({shortcut:de.getShortDescriptionById("toggleWireframe"),colorItems:[{title:"Off",className:"colors-none",dataSetting:"wireframeEnable",dataValue:"0"},{title:"Black",className:"colors-black",dataSetting:"wireframeColor",dataValue:"000000FF"},{title:"White",className:"colors-white",dataSetting:"wireframeColor",dataValue:"ffffffFF"},{title:"Red",className:"colors-red",dataSetting:"wireframeColor",dataValue:"ff0000FF"},{title:"Blue",className:"colors-blue",dataSetting:"wireframeColor",dataValue:"0000FFFF"},{title:"Green",className:"colors-green",dataSetting:"wireframeColor",dataValue:"00FF00FF"},{title:"Yellow",className:"colors-yellow",dataSetting:"wireframeColor",dataValue:"FFFF00FF"}].map(function(n){return t(O()({},n,{isActive:e.wireframeColor===n.dataValue}))}).join("")})},pe={};Object(P.a)().uiInspector||(pe.shadingStyle={label:"Rendering",settings:[{label:"Lit",value:"lit",shortcut:de.getShortDescriptionById("defaultRenderingMode")},{label:"Shadeless",value:"shadeless",shortcut:de.getShortDescriptionById("shadelessRenderingMode")},{label:"MatCap",value:"matcap",shortcut:de.getShortDescriptionById("matcapRenderingMode")}],paneTemplate:function(e){var t=e.viewerSettings.hasWireframe,n=e.viewerSettings.wireframeColor;return _.default.getFromString('    <div class="setting-list-header">               <a class="back control-menu-back">Back</a>               <span class="setting-list-header-help">Key</span>           </div>            <ul class="setting-list" data-setting="{{ name }}">                {{ listItems | safe }}            </ul>            {{ wireframe | safe }}',O()({},e,{wireframe:t?fe({wireframeColor:n}):""}))},order:2});var ge=M.a.extend({events:{"click .help":"onHelpClick","click .ar":"onArClick","click .vr":"onVrClick","click .fullscreen":"onFullscreenClick","click .theatre":"onTheatreClick","touchend .control.tooltip":"replaceDOMElement"},constructor:function(){this.fullScreenChange=this.fullScreenChange.bind(this),this.onVrClick=this.onVrClick.bind(this),this.onFullscreenClick=this.onFullscreenClick.bind(this),this.onTheatreClick=this.onTheatreClick.bind(this),this.onArClick=this.onArClick.bind(this),M.a.prototype.constructor.apply(this,arguments)},initialize:function(){M.a.prototype.initialize.apply(this,arguments),this.enableVR=!1,this.wasClicked=this.$el.parents(".model-container").hasClass("theatre"),!Q()&&Object(W.default)()&&window.self===window.top&&(this.viewer.$el.addClass("no-fullscreen"),this.viewer.$el.find(".controls .settings").addClass("shift-menu-left")),this._theatreActive="false"!==p.a.get("sb_theatre_mode","false"),this.viewer.on("model-loaded",this.updateNavigationSettings.bind(this)),this.generalControlsShortcuts=new y.a(he.generalControls),this.generalControlsShortcuts.on("fullscreen",this.onToggleFullScreen,this),this.generalControlsShortcuts.listen([this.generalControlsShortcuts.getShortcut("fullscreen")])},delegateEvents:function(){M.a.prototype.delegateEvents.apply(this,arguments),this.onFullScreenChange(this.fullScreenChange),this.viewer.proxySettings.on("change",this.renderSettings,this),this.viewer.on("model-loaded",this.setModelListeners.bind(this))},undelegateEvents:function(){if(M.a.prototype.undelegateEvents.apply(this,arguments),!this.$el)return this;this.offFullScreenChange(this.fullScreenChange),this.viewer.proxySettings.off("change",this.renderSettings,this),this.viewer.on("model-loaded",this.removeModelListeners.bind(this))},setModelListeners:function(){this.viewer.scene.getFeatures().animation.getModel().get("animations").on("add remove reset",this.renderSettings,this);var e=this.viewer.scene.getFeatures().camera.getModel();this.listenTo(e,"change:useCameraConstraints",this.updateNavigationSettings.bind(this))},removeModelListeners:function(){this.viewer.scene.getFeatures().animation.getModel().get("animations").off("add remove reset",this.renderSettings,this);var e=this.viewer.scene.getFeatures().camera.getModel();this.stopListening(e,"change:useCameraConstraints",this.updateNavigationSettings.bind(this))},setHasAnimations:function(e){this.hasAnimations=e},getSettingLabelForValue:function(e,t){return Object(B.a)(pe[e].settings,function(e){return e.value===t}).label},getEmbedUrl:function(e){var t=X.c.craft(O()({},Object(q.b)(location.search),e));return this.viewer._currentModel.get("embedUrl")+"?"+t},onHelpClick:function(e){e.preventDefault(),e.stopPropagation(),b.a.modelViewerHelpButtonCliked(),this.viewer.subviews.helpOverlay.show()},generateTextureQualitySettings:function(e){pe.textureQuality={label:"Textures",group:"textureQuality",settings:[{label:"LD",value:"0"},{label:"SD",value:"1"},{label:"HD",value:"2"}],order:5};var t=0;["low","mid","high"].forEach(function(n,i){e[n]||(pe.textureQuality.settings.splice(i-t,1),t++)}.bind(this)),Object(U.a)(pe.textureQuality.settings).label="HD",this.renderSettings()},updateNavigationSettings:function(){this.viewer.scene.getFeatures().camera.getModel().get("useCameraConstraints")?delete pe.viewerMode:pe.viewerMode||(pe.viewerMode={label:"Navigation",settings:[{label:"Orbit",value:"0"},{label:"First Person",value:"1"}],order:4}),this.renderSettings()},renderSettings:function(){Object(j.a)(pe)?this.$(".control.settings").hide():(this.$(".control.settings").show(),this.settings||(this.settings=new ue({el:this.$(".settings-menu"),viewer:this.viewer,settings:pe})),this.settings.render())},getQrCode:function(){var e=document.getElementById("qrCode"),t=this.viewer._currentModel.attributes.viewerUrl;return n.e(107).then(n.t.bind(null,"ua8w",7)).then(function(n){return n.toCanvas(e,t,function(e){e&&console.error(e)})})},getPlatform:function(){var e=c.a.apple.device,t=c.a.android.device;return e?function(){try{return parseInt(navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/)[1],10)}catch(e){console.error(e)}}()>=11?"ios":"mobileIos":t?function(){try{return parseInt(navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/i)[1],10)}catch(e){console.error(e)}}()>=7?"android":"mobileAndroid":"others"},openArDesktopInstructions:function(){this.viewer._currentModel.sharing().then(function(){var e=this.viewer._currentModel.get("sharing").shortUrl;this.viewer.subviews.arOverlayDesktop.setUrl(e),this.viewer.subviews.arOverlayDesktop.show()}.bind(this))},openArMobileInstructions:function(e,t){this.viewer.subviews.arOverlayMobile.setPlatform(e),this.viewer.subviews.arOverlayMobile.setMinVersion(t),this.viewer.subviews.arOverlayMobile.show()},setArLoaderListener:function(){var e=this;document.addEventListener("visibilitychange",function t(){e.viewer.subviews.arOverlayLoading.hide(),document.removeEventListener("visibilitychange",t,!1)},!1)},onArClick:function(e){var t=this;e.stopPropagation();var n=this.getPlatform(),i=this.viewer._currentModel.get("viewerUrl"),r=this.viewer._currentModel.get("name");"ios"===n?(this.viewer.subviews.arOverlayLoading.show(),this.setArLoaderListener(),S.a||setTimeout(function(){this.viewer.subviews.arOverlayLoading.hide()}.bind(this),1e4),H.b.getModelArEnterprise(n,this.viewer._currentModel.id).then(function(e){var t=document.createElement("a"),n=document.createElement("img");t.href=e.url,t.rel="ar",t.appendChild(n),t.click()}).catch(function(e){t.viewer.subviews.arOverlayLoading.hide(),t.viewer.subviews.arOverlayErrorMessage.show(),console.error(e)})):"android"===n?(this.viewer.subviews.arOverlayLoading.show(),this.setArLoaderListener(),H.b.getModelArEnterprise(n,this.viewer._currentModel.id).then(function(e){var t=e.url;window.location.href="intent://arvr.google.com/scene-viewer/1.0?file="+encodeURIComponent(t)+"&mode=ar_only&link="+encodeURIComponent(i)+"&title="+encodeURIComponent(r)+"#Intent;scheme=https;package=com.google.ar.core;action=android.intent.action.VIEW;S.browser_fallback_url=https://developers.google.com/ar;end;"}).catch(function(e){t.viewer.subviews.arOverlayLoading.hide(),t.viewer.subviews.arOverlayErrorMessage.show(),console.error(e)})):"mobileIos"===n?this.openArMobileInstructions("iOS","11"):"mobileAndroid"===n?this.openArMobileInstructions("Android","7"):(this.getQrCode(),this.openArDesktopInstructions())},onVrClick:function(e){var t=this;e.stopPropagation();var n=function(){if(t.widgets.hotspots&&(t.widgets.hotspots.hideTooltips(),t.widgets.hotspots.currentHotspot=-1,t.widgets.hotspots.renderControl()),t.viewer.scene.getViewerOSGJS().isVRSupported()){if(t.viewer.scene.getViewerOSGJS().needsVRPolyFill()){var n=new ce.a({message:"Initializing VR ..."});return n.open(),void t.viewer.scene.getViewerOSGJS().loadWebxrPolyFill().then(function(e){var t=this,i=new le.default({title:"Ready",text:'Press the "Enter VR" button to proceed.',buttons:{ok:!0,okLabel:"Enter VR"}});n.replaceWith(i),i.getPromise().then(function(){return t.onVrClick(e)})}.bind(t)).catch(function(){n.hide(),this.openVrInstructions(),b.a.modelViewerVrButtonClicked("desktop")}.bind(t))}var i=t.viewer.scene.getFeatures().webVR.getModel();i.set("enable",!i.get("enable")),b.a.modelViewerVrButtonClicked("nativeVR")}else c.a.any?(t.fullscreenVR(e),b.a.modelViewerVrButtonClicked("mobile")):(t.openVrInstructions(),b.a.modelViewerVrButtonClicked("desktop"))};"undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then(function(e){"granted"===e&&n()}).catch(function(){alert("Accelerometer permission couldn't be granted. Please try again at a later time.")}):n()},openVrWindow:function(){this.viewer._currentModel&&window.open(this.getEmbedUrl({cardboard:1,autostart:1}),"skfbCardboard","menubar=no,toolbar=no")},openVrInstructions:function(){this.viewer._currentModel.sharing().then(function(){var e=this.viewer._currentModel.get("sharing").shortUrl;this.viewer.subviews.helperVrOverlay.setUrl(e),this.viewer.subviews.helperVrOverlay.show()}.bind(this))},isTheatreActive:function(){return this._theatreActive},onTheatreClick:function(e){e.stopPropagation(),e.preventDefault();var t=this.isTheatreActive(),n=G.a.me().get("isAnonymous")&&!this.wasClicked;return this.wasClicked=!0,this.viewer.trigger(t&&!n?"leaveTheatreMode":"enterTheatreMode"),p.a.set("sb_theatre_mode",!t),this._theatreActive=!t,!1},onFullscreenClick:function(e,t){e.stopPropagation(),this.onToggleFullScreen(t)},onToggleFullScreen:function(e){if(Q()){var t=J();b.a.modelViewerFullscreenButtonClicked(!t),t?$():Z(this.viewer.el)}else e?this.openVrWindow():this.openFakeFullscreen()},openFakeFullscreen:function(){this.viewer._currentModel&&(c.a.any?window.open(this.getEmbedUrl()):window.open(this.getEmbedUrl(),"skfbFullscreenFallback","menubar=no,toolbar=no"))},onFullScreenChange:function(e){Y(e)},offFullScreenChange:function(e){K(e)},fullScreenChange:function(){u()('[data-action="fullscreen"] > .icon').toggleClass("icon-fullscreen-icon").toggleClass("icon-fullscreen-off-icon"),this.viewer.$el.toggleClass("fullscreen",J()),this.viewer.scene.trigger("resizeViewerOnNextFrame",-1,-1);var e=this.viewer.scene.getFeatures().webVR;if(e){var t=e.getModel();J()?!0===this.enableVR&&t.set("enable",!0):!0===this.enableVR&&(t.set("enable",!1),this.enableVR=!1)}},fullscreenVR:function(e){return this.enableVR=!0,this.onFullscreenClick(e,!0)},replaceDOMElement:Object(a.a)(function(e){var t=e.target.parentElement,n=e.target.nextSibling;t&&(t.removeChild(e.target),Object(o.a)(function(){t.insertBefore(e.target,n)}))},2e3)}),me=M.a.extend({events:{"click .close":"close"},close:function(e){e&&e.preventDefault&&e.preventDefault()}}),ve=n("KOua"),_e=n("tSPY"),be=n("FPmW"),Se=z.a.shortcuts,ye=_e.a.extend({displayName:"HelpOverlay",mixins:[Object(be.a)(".tabs-container")],events:{"click .tabs a":"onTabClick","touchstart .tabs a":"onTabClick",'click [data-action="reset-camera"]':"onResetCameraClick",'touchstart [data-action="reset-camera"]':"onResetCameraClick"},initialize:function(){_e.a.prototype.initialize.apply(this,arguments),this.generalShortcuts=new y.a(Se.generalControls),this.renderingShortcuts=new y.a(Se.viewerRendering),this.annotationShortcuts=new y.a(Se.annotationControl),this.animationShortcuts=new y.a(Se.animationControl),this.soundShortcuts=new y.a(Se.sound),this.inspectorShortcuts=new y.a(Se.inspectorControl),this.render()},onResetCameraClick:function(e){e.preventDefault(),b.a.modelViewerResetCameraButtonClicked(),this.hide(),this.viewer.scene.getFeaturesManager().focusOnSavedCamera(2),Object(o.a)(function(e){e.target.blur()},e)},render:function(){var e=this.renderingShortcuts.generateHelpSection(),t=this.generalShortcuts.generateHelpSection(),n=this.animationShortcuts.generateHelpSection(),i=this.annotationShortcuts.generateHelpSection(),r=this.inspectorShortcuts.generateHelpSection(),a=this.soundShortcuts.generateHelpSection();this.$(".rendering-shortcuts").html(e),this.$(".general-shortcuts").html(t),this.$(".animation-shortcuts").html(n),this.$(".annotation-shortcuts").html(i),this.$(".inspector-shortcuts").html(r),this.$(".sound-shortcuts").html(a)},onTabClick:function(e){e.preventDefault();var t=u()(e.currentTarget),n=t.attr("data-target"),i=this.$("[data-tab].active"),r=this.$('[data-tab="'+n+'"]');b.a.modelViewerHelpTabClicked(n),this.$(".tabs li").removeClass("active"),t.parent().addClass("active"),i.removeClass("active"),r.addClass("active")}}),xe=n("O67m"),Ce=_e.a.extend({mixins:[xe.a,Object(be.a)(".js-scrollable")],setModel:function(e){this.model=e,this.render()},render:function(){this.model&&(this.$(".hotspot-title").html(this.model.get("name")),this.$(".hotspot-content").html(this.model.get("content").rendered),this.handleLazyLoading())}}),we=n("lSNA"),Te=n.n(we),Me=n("owWc"),Ee=n("HI9p"),Ae=n("0Uag"),Oe=n("QYQF"),Re=n("w0gJ"),Pe=n("JW7N"),Ie=n("+lWh"),Ne=n("x2jA"),Le=(n("fsbH"),Oe.a.extend({displayName:"Dropdown",mixins:[Object(be.a)('[data-ref="menu"]'),Pe.a],optionTypes:{child:I.b.component.isRequired,labelTitle:I.b.string,labelValue:I.b.string,longestLabelValue:I.b.string,placeholder:I.b.string,color:I.b.string,className:I.b.string,theme:I.b.oneOf(["dark","light","white-background","grey-background"]),menuAlign:I.b.oneOf(["left","right"]),disabled:I.b.bool,withBackground:I.b.bool,grey:I.b.bool},defaultOptions:{color:"",theme:"light",menuAlign:"left",disabled:!1,withBackground:!1,grey:!1},events:{'click [data-action="toggle-menu"]:not([data-disabled="true"])':"onToggle","click window":"onWindowClick","resize window":"setMenuPosition"},state:{isOpen:!1},viewDidMount:function(){this.setMenuPosition()},viewDidUpdate:function(){this.setMenuPosition()},onToggle:function(){this.setState({isOpen:!this.state.isOpen})},onWindowClick:function(e){!Object(Ie.g)(this.el,e.target)&&this.state.isOpen&&this.setState({isOpen:!1})},setMenuPosition:function(){var e=this.el.getBoundingClientRect(),t=this.refs.menu.getBoundingClientRect();this.refs.$menu.css({bottom:-Math.min(0,window.innerHeight-(e.bottom+t.height+10)),right:"right"===this.options.menuAlign?Math.min(0,e.right-(t.width+10)):"auto",left:"left"===this.options.menuAlign?Math.min(0,window.innerWidth-(e.left+t.width+10)):"auto"})},scrollToHeightPercent:function(e){var t=this.refs.$menu.prop("scrollHeight");this.refs.$menu.scrollTop(Object(Ne.b)(0,1,e)*t)},template:function(){var e=this;return _.default.getFromMacro("skfb_front/macros/components/atoms/dropdown","dropdown",[{isOpen:this.state.isOpen&&!this.options.disabled,labelTitle:this.options.labelTitle,labelValue:this.options.labelValue,longestLabelValue:this.options.longestLabelValue,placeholder:this.options.placeholder,color:this.options.color,disabled:this.options.disabled,withBackground:this.options.withBackground,grey:this.options.grey,theme:this.options.theme,className:this.options.className,components:this.createChildrenComponents({child:[].concat(this.options.child).map(function(t,n){return O()({},t,{options:O()({},t.options,{key:t.options.key||n,dropdown:{isOpen:e.state.isOpen,onToggle:e.onToggle.bind(e),scrollToHeightPercent:e.scrollToHeightPercent.bind(e)}})})})})}])}})),ke=Object(Ae.a)(function(e,t){return e+t}),De=function(e,t){return Object(Re.b)(e,{},function(e){return e.value===t})},Fe=Oe.a.extend({displayName:"DropdownOptionList",mixins:[Pe.a],optionTypes:{value:I.b.string.isRequired,options:I.b.arrayOf(I.b.shape({title:I.b.string.isRequired,value:I.b.string.isRequired,default:I.b.bool}).isRequired).isRequired,onSelectOption:I.b.func.isRequired,dropdown:I.b.shape({isOpen:I.b.bool.isRequired,onToggle:I.b.func.isRequired,scrollToHeightPercent:I.b.func.isRequired}).isRequired,color:I.b.string,theme:I.b.string,closeOnSelection:I.b.bool},events:{'click [data-action="select-option"]':"onOptionClick",'mouseenter [data-action="select-option"]':"onMouseEnterOption",'mouseleave [data-action="select-option"]':"onMouseLeaveOption","keydown window":"onWindowKeyDown"},viewDidMount:function(){this.updateScrollPosition()},viewDidUpdate:function(){this.updateScrollPosition()},getSelectedIndex:function(){return this.options.options.indexOf(De(this.options.options,this.options.value))},onOptionClick:function(e){this.options.onSelectOption(e.target.getAttribute("data-value")),this.options.closeOnSelection&&this.options.dropdown.isOpen&&this.options.dropdown.onToggle()},onMouseEnterOption:function(e){e.target.style.color=this.options.color},onMouseLeaveOption:function(e){e.target.getAttribute("data-active")||(e.target.style.color="")},onWindowKeyDown:function(e){this.options.dropdown.isOpen&&this.options.options.length&&(38!==e.which&&40!==e.which||e.preventDefault(),38===e.which&&this.selectIndex(ke(-1)),40===e.which&&this.selectIndex(ke(1)))},selectIndex:function(e){var t=this.getSelectedIndex(),n=this.options.options.length,i=(n+e(t))%n;this.options.onSelectOption(this.options.options[i].value),this.scrollAtNextRender=!0},scrollToSelectedOption:function(){var e=(this.getSelectedIndex()-1)/this.options.options.length;this.options.dropdown.scrollToHeightPercent(e)},updateScrollPosition:function(){this.scrollAtNextRender&&(this.scrollAtNextRender=!1,this.scrollToSelectedOption())},template:function(){return _.default.getFromString(["<ul class=\"c-dropdown-select {{ '--' + theme + '-theme' if theme else '' }}\">","    {% for optionItem in options %}","        {% set isActive = optionItem.value == value %}","        <li",'            class="c-dropdown-select__option {{ {',"                '--active': isActive",'            } | class_names }}"','            style="{{ {',"                'color': color if isActive else ''",'            } | style }}"','            {% if isActive %} data-active="true" {% endif %}','            data-value="{{ optionItem.value }}"','            data-action="select-option">',"            {{ optionItem.title }}","        </li>","    {% endfor %}","</ul>"].join("\n"),{options:this.options.options,value:this.options.value,color:this.options.color,theme:this.options.theme})}}),Ve=Oe.a.extend({displayName:"DropdownSelect",optionTypes:{value:I.b.string.isRequired,onChange:I.b.func.isRequired,options:I.b.arrayOf(I.b.shape({title:I.b.string.isRequired,value:I.b.string.isRequired,default:I.b.bool}).isRequired).isRequired,title:I.b.string,placeholder:I.b.string,color:I.b.string,theme:I.b.oneOf(["dark","light","white-background","grey-background"]),menuAlign:I.b.oneOf(["left","right"]),disabled:I.b.bool,closeOnSelection:I.b.bool,autoScale:I.b.bool},defaultOptions:{theme:"light",closeOnSelection:!0,autoScale:!1},initialize:function(){Oe.a.prototype.initialize.apply(this,arguments);var e=this.getDefaultValue();!this.options.value&&e&&this.options.onChange(e)},getDefaultValue:function(){return Object(Re.b)(this.options.options,{},function(e){return e.default}).value},template:function(){return _.default.getFromString("{{ components.dropdown | component }}",{components:this.createChildrenComponents({dropdown:{viewClass:Le,options:{disabled:this.options.disabled,labelTitle:this.options.title,labelValue:De(this.options.options,this.options.value).title,longestLabelValue:this.options.autoScale?this.options.options.reduce(function(e,t){return e.length>t.title.length?e:t.title},""):"",placeholder:this.options.placeholder,color:this.options.color,theme:this.options.theme,className:this.options.className,menuAlign:this.options.menuAlign,child:{viewClass:Fe,options:{value:this.options.value,options:this.options.options,color:this.options.color,theme:this.options.theme,closeOnSelection:this.options.closeOnSelection,onSelectOption:this.options.onChange}}}}})})}}),Be=(n("a1dx"),Oe.a.extend({displayName:"SwitchButton",optionTypes:{isChecked:I.b.bool.isRequired,onChange:I.b.func.isRequired,prepopulated:I.b.bool,disabled:I.b.bool,name:I.b.string},defaultOptions:{prepopulated:!1,disabled:!1,name:""},events:{click:function(e){e.preventDefault(),this.options.onChange(!this.options.isChecked)}},initialize:function(){Oe.a.prototype.initialize.apply(this,arguments),this.options.prepopulated&&this.options.onChange(this.refs.$input.prop("checked"))},template:function(){return _.default.getFromMacro("skfb_front/macros/components/atoms/switch-button","switch_button",[{isChecked:this.options.isChecked,name:this.options.name,disabled:this.options.disabled}])}})),Ue=(n("A35o"),Oe.a.extend({displayName:"LabelSwitchButton",optionTypes:{isChecked:I.b.bool.isRequired,onChange:I.b.func.isRequired,label:I.b.string,error:I.b.string,attrs:I.b.object},defaultOptions:{attrs:{}},template:function(){var e=this.options.isTouched&&!!this.options.error;return _.default.getFromMacro("skfb_front/macros/components/molecules/label-switch-button","label_switch_button",[{label:this.options.label,error:e?this.options.error:"",components:this.createChildrenComponents({switchButton:{viewClass:Be,options:O()({},this.options,{attrs:{classNames:O()({"--error":e},this.options.attrs.classNames)}})}})}])}})),je=z.a.shortcuts,Ge={render:{title:"Render ("+je.inspectorControl.shortcuts[0].keyCombinations+")",displayViews:[{text:"Final Render",icon:"icon-final-render",value:"Default",has2dView:!1},{text:"No Post-Processing",icon:"icon-final-render",value:"DefaultNoPostProcess",has2dView:!1}]},animation:{title:"Animation ("+je.inspectorControl.shortcuts[4].keyCombinations+")",displayViews:[{text:"Bones",icon:"icon-bones",value:"Bones",has2dView:!0},{text:"Bones Influence",icon:"icon-influences",value:"BoneWeights",has2dView:!0}]},materials:{title:"Material channels ("+je.inspectorControl.shortcuts[1].keyCombinations+")",displayViews:[{text:"Albedo",icon:"icon-diffuse",value:"DiffusePBR",has2dView:!0},{text:"Base Color",icon:"icon-diffuse",value:"AlbedoPBR",has2dView:!0},{text:"Diffuse",icon:"icon-diffuse",value:"DiffuseColor",has2dView:!0},{text:"Specular",icon:"icon-specular",value:"SpecularPBR",has2dView:!0},{text:"Metalness",icon:"icon-metalness",value:"MetalnessPBR",has2dView:!0},{text:"Specular Color",icon:"icon-specular",value:"SpecularColor",has2dView:!0},{text:"Glossiness",icon:"icon-roughness",value:"GlossinessPBR",has2dView:!0},{text:"Roughness",icon:"icon-roughness",value:"RoughnessPBR",has2dView:!0},{text:"Specular Glossiness",icon:"icon-specular",value:"SpecularHardness",has2dView:!0},{text:"Scattering",icon:"icon-subsurface",value:"SubsurfaceScattering",has2dView:!0},{text:"Translucency",icon:"icon-subsurface",value:"SubsurfaceTranslucency",has2dView:!0},{text:"Normal Map",icon:"icon-normal-map",value:"NormalMap",has2dView:!0},{text:"Bump Map",icon:"icon-normal-map",value:"BumpMap",has2dView:!0},{text:"AO map",icon:"icon-AO",value:"AOPBR",has2dView:!0},{text:"Cavity",icon:"icon-AO",value:"CavityPBR",has2dView:!0},{text:"Lightmap",icon:"icon-lightmap",value:"DiffuseIntensity",has2dView:!0},{text:"Displacement",icon:"icon-displacement",value:"Displacement",has2dView:!0},{text:"Opacity",icon:"icon-transparency",value:"Opacity",has2dView:!0},{text:"Emission",icon:"icon-emission",value:"EmitColor",has2dView:!0},{text:"Specular F0",icon:"icon-specular",value:"SpecularF0",has2dView:!0},{text:"Vertex Color",icon:"icon-diffuse",value:"VertexColor",has2dView:!0},{text:"Vertex Alpha",icon:"icon-transparency",value:"VertexAlpha",has2dView:!0},{text:"Clear Coat",icon:"icon-specular",value:"ClearCoat",has2dView:!0},{text:"Clear Coat Roughness",icon:"icon-roughness",value:"ClearCoatRoughness",has2dView:!0},{text:"Clear Coat Normal Map",icon:"icon-normal-map",value:"ClearCoatNormalMap",has2dView:!0}]},geometry:{title:"Geometry ("+je.inspectorControl.shortcuts[2].keyCombinations+")",displayViews:[{text:"Matcap",icon:"icon-final-render",value:"MatcapFlat",has2dView:!1},{text:"Matcap+Surface",icon:"icon-final-render",value:"MatcapDetail",has2dView:!1},{text:"Wireframe",icon:"icon-geometry",value:"Wireframe",has2dView:!0},{text:"Vertex Normals",icon:"icon-vertex-normals",value:"VertexNormal",has2dView:!1}]},uv:{title:"UV ("+je.inspectorControl.shortcuts[3].keyCombinations+")",displayViews:[{text:"UV Checker",icon:"icon-UV",value:"UVChecker",has2dView:!0}]}},He=_.default.getFromString('\n        <div class="model-inspector__wireframe">\n            {{ wireframe | safe }}\n        </div>\n        <div class="model-inspector__single-sided-button"></div>\n        {{ components.singleSidedButton | component }}\n        {% if inspectableTextures or isStaff %}\n            <div class="mode__title">Viewport{%if not inspectableTextures and isStaff %} (Staff only){% endif %}</div>\n            <div class="toggle-button{%if not inspectableTextures and isStaff %} --staff{% endif %}">\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="3d" id="splitType-3d">\n                    <label for="splitType-3d">3D</label>\n                </span>\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="split" id="splitType-split">\n                    <label for="splitType-split">3D + 2D</label>\n                </span>\n                <span class="toggle-button__option">\n                    <input type="radio" name="splitType" data-value="2d" id="splitType-2d">\n                    <label for="splitType-2d">2D</label>\n                </span>\n            </div>\n        {% endif %}\n       {% for category, mode in modes %}\n            {% if mode.displayViews %}\n                <div class="mode__title">{{ mode.title }}</div>\n            {% endif %}\n            <ul>\n                {% for button in mode.displayViews %}\n                    <li                        class="mode {{ "selected" if button.value == active else "" }}" data-mode="{{ mode.title }}" data-value="{{ button.value }}"\n                        style="{{ button.style }}"\n                    >\n                        <i class="mode__icon custom-icons {{ button.icon }}"></i>\n                        <span>{{ button.text }}</span>\n                    </li>\n                    {% endfor %}\n            </ul>\n       {% endfor %}\n    '),ze=["displayView","material","splitType","texCoord","forceSingleSided"],We={displayView:"Default",forceSingleSided:!1,splitType:"3d"},qe=M.a.extend({mixins:[Object(be.a)(".js-scrollable")],children:{singleSidedButton:{selector:".model-inspector__single-sided-button",viewClass:Ue,options:function(){var e=this;return{label:"Single Sided",isChecked:Boolean(this.model.get("forceSingleSided")),onChange:function(t){return e.model.set("forceSingleSided",t)}}}},materialSelector:{selector:".model-inspector__2D-options .model-inspector__material-options",viewClass:Ve,shouldCreateChild:function(){return this.canInspectTextures()},options:function(){var e=this;return{theme:"dark",value:this.model.get("material").toString(),onChange:function(t){return e.model.set("material",t)},options:this.model.get("materialList").filter(function(e){return!e.uidUniqueMerged}).map(function(e){var t=e.uidListUnusedDuplicates.length?"Merged ("+e.name+", ...)":e.name;return{title:this.model.materialHasTextureInView2d(e.uid)?t:t+" (no texture)",value:e.uid}}.bind(this)).sort(function(e,t){return e.title<t.title?-1:e.title>t.title?1:void 0}),closeOnSelection:!1,autoScale:!0}}},UVSelector:{selector:".model-inspector__2D-options .model-inspector__UV-options",viewClass:Ve,shouldCreateChild:function(){return this.canInspectTextures()&&this.model.getCurrentUVs().length>1},options:function(){return{theme:"dark",value:this.model.get("texCoord").toString(),onChange:function(e){this.model.set("texCoord",e)}.bind(this),options:this.model.getCurrentUVs().sort(function(e,t){return e-t}).map(function(e){return{title:"UV "+e.toString(),value:e.toString()}}),closeOnSelection:!1,autoScale:!0}}}},events:{"click .mode":"onSelectDisplayView","click .model-inspector__minimize":"toggleVisibility",'click [name="splitType"]':"onSelectSplitType","click [data-setting]":"changeWireframe"},initialize:function(){M.a.prototype.initialize.apply(this,arguments),this.initializeShortcuts(),this.updateModes(),this.updateSavedState(),this._selectors=this.$(".model-inspector__2D-options"),this.render(),this._selectors.css({visibility:"hidden"})},delegateEvents:function(){M.a.prototype.delegateEvents.apply(this,arguments),this.model.on("change:displayView",this.updateDisplayViewUI,this),this.model.on("change:material change:texCoord change:displayView change:forceSingleSided",this.renderChildren,this),this.model.on("change:material change:displayView change:splitType",this.update2DView,this),this.model.on("change:availableDisplayView",this.updateAvailableDisplayView,this),this.model.on("change:uiVisible",this.show,this)},undelegateEvents:function(){M.a.prototype.undelegateEvents.apply(this,arguments),this.model.off("change:displayView",this.updateDisplayViewUI,this),this.model.off("change:material change:texCoord change:displayView change:forceSingleSided",this.renderChildren,this),this.model.off("change:material change:displayView change:splitType",this.update2DView,this),this.model.off("change:availableDisplayView",this.updateAvailableDisplayView,this),this.model.off("change:uiVisible",this.show,this)},updateModes:function(){var e=this.model.get("availableDisplayView");this.modes=Object(Me.a)(Ge,function(t,n,r){var a=n.displayViews.filter(function(t){return-1!==e.indexOf(t.value)});if(0===a.length)return t;var o=Object(i.a)({},n,{displayViews:a});return t[r]=o,t},{}),this.modeNamesWith2d=Object(Me.a)(this.modes,function(e,t){var n=t.displayViews.filter(function(e){return e.has2dView}).map(function(e){return e.value});return e.concat(n)},[])},changeWireframe:function(e){var t=e.currentTarget.dataset.setting,n=e.currentTarget.dataset.value;if("wireframeEnable"===t){var i=!this.options.wireframeModel.get("wireframeEnable");return b.a.modelViewerWireframeToggleClicked(i),this.options.wireframeModel.set("wireframeEnable",i)}b.a.modelViewerWireframeColorSelected(n),this.options.wireframeModel.set("wireframeEnable",!0),this.options.wireframeModel.set(t,n)},onSelectDisplayView:function(e){var t=e.currentTarget.getAttribute("data-mode"),n=e.currentTarget.getAttribute("data-value");b.a.inspectorDisplayViewClicked(t,n),this.model.set("displayView",n)},canInspectTextures:function(){return this.options.inspectableTextures||G.a.me().get("isStaff")},_currentModeHas2dView:function(){var e=this.model.get("displayView");return-1!==this.modeNamesWith2d.indexOf(e)},_getDisplayViewLabel:function(){return this.$el.find("[data-value="+this.model.get("displayView")+"]").text().trim()},updateDisplayViewUI:function(){this.$el.find(".selected").removeClass("selected"),this.$el.find("[data-value="+this.model.get("displayView")+"]").addClass("selected")},updateAvailableDisplayView:function(){this.updateModes(),-1===this.model.get("availableDisplayView").indexOf(this._savedState.displayView)&&(this._savedState.displayView="Default"),this.render()},update2DView:function(){if(this.canInspectTextures())if(this.updateSelectorsUI(),"3d"===this.model.get("splitType")||this.model.materialHasContentInView2d(this.model.get("material")))this.$el.find(".model-inspector__empty-2d-view").text("");else{var e=this.model.get("materialByUid")[this.model.get("material")].name,t=this.$el.find(".model-inspector__empty-2d-view"),n="2d"===this.model.get("splitType")?"50%":"25%",i="";i=this._currentModeHas2dView()?"No data in "+e+"/"+this._getDisplayViewLabel():"2D view isn't available for "+this._getDisplayViewLabel()+".<br>Select a Material Channel to view textures.",t.html(i).css("right",n)}},updateSelectorsUI:function(){"3d"!==this.model.get("splitType")&&this._currentModeHas2dView()?this._selectors.css({visibility:"visible"}):this._selectors.css({visibility:"hidden"})},onSelectSplitType:function(e){this.canInspectTextures()&&(b.a.inspectorSplitTypeClicked(e.currentTarget.getAttribute("data-value")),this.model.set("splitType",e.currentTarget.getAttribute("data-value")))},initializeShortcuts:function(){var e=new y.a(je.inspectorControl),t=this.onShortcut.bind(this),n=function(){b.a.modelViewerInspectorShortcut(),this.toggle()}.bind(this);e.on("render materials geometry uv animation",t),e.on("inspector",n),e.listen()},onShortcut:function(e){var t=this.modes[e.id],n=this._savedState.displayView,i=(Object(Ee.a)(t.displayViews,function(e){return e.value===n})+1)%t.displayViews.length,r=t.displayViews[i];this.model.get("uiVisible")?this.options.osd.hide():Object(v.a)()?this.model.set("uiVisible",!0):this.options.osd.show(r.text,{duration:1e3}),b.a.inspectorModeShortcut(t.title,r.value),this.model.set("displayView",r.value),this.updateSavedState()},close:function(){this.$el.removeClass("--show"),this.updateSavedState(),this.model.set(We)},show:function(e,t){this.$el.toggleClass("--show --open",t)},restoreState:function(){this.model.set(this._savedState)},updateSavedState:function(){var e=this;this._savedState=ze.reduce(function(t,n){return O()({},t,Te()({},n,e.model.get(n)))},{})},toggle:function(){this.model.get("uiVisible")?(this.model.set("uiVisible",!1),this.close()):(this.model.set("uiVisible",!0),this.restoreState())},toggleVisibility:function(){b.a.inspectorUIVisibilityToggleClicked(),this.$el.toggleClass("--open")},render:function(){var e=this.viewer.proxySettings.get("setting.name");this.$(".model-inspector__modes").html(He({inspectableTextures:this.options.inspectableTextures,modes:this.modes,active:this.model.get("displayView"),wireframe:fe({wireframeColor:e}),isStaff:G.a.me().get("isStaff")})),this.renderChildren(),this.afterRender()},afterRender:function(){this.$('[data-value="'+this.model.get("splitType")+'"]').prop("checked",!0)}}),Xe=M.a.extend({events:{"click .osd":"hide"},show:function(e,t){this.osdTimeout&&window.clearTimeout(this.osdTimeout),t=Object(i.a)({position:"center"},t);var n=this.$(".osd");n.find(".osd-content").html(e),n.addClass("active"),n.removeClass("osd-top osd-center"),n.addClass("osd-"+t.position),t.duration&&(t.duration=Math.max(0,t.duration),t.duration!==1/0&&(this.osdTimeout=setTimeout(this.hide.bind(this),t.duration)))},hide:function(){this.$(".osd").removeClass("active")}}),Ye=n("JFXa"),Ke=M.a.extend({_isHover:!1,events:{touchstart:"onTouchStart",mousedown:"onClick",mouseover:"onMouseover",mouseout:"onMouseout",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},initialize:function(){M.a.prototype.initialize.apply(this,arguments),this.previousValue=null,this._touched=!1,this.$icon=this.$(".fa"),this.listenTo(this.model,"change:volume",this.render.bind(this)),this.render(),this.$volumeMenu=this.$(".volume-menu"),this.slider=new Ye.a(void 0,{model:this.model,global:!0,orientation:"vertical"}),this.$volumeMenu.append(this.slider.$el),this.initializeShortcuts()},delegateEvents:function(){M.a.prototype.delegateEvents.apply(this,arguments),u()(window).on("mouseup.delegateEvents"+this.cid,this.onVolumeInteractionEnd.bind(this)),u()(window).on("touchend.delegateEvents"+this.cid,this.onVolumeInteractionEnd.bind(this))},undelegateEvents:function(){M.a.prototype.undelegateEvents.apply(this,arguments),u()(window).off(".delegateEvents"+this.cid)},initializeShortcuts:function(){this.soundControlShortcuts=new y.a(z.a.shortcuts.sound),this.soundControlShortcuts.on("mute",this.toggleMute.bind(this)),this.soundControlShortcuts.listen()},onTouchStart:function(){this._touched=!0},onClick:function(e){e.preventDefault();var t=u()(e.target);t.is(".volume-menu")||t.parents(".volume-menu").length||this.toggleMute()},onMouseEnter:function(){this._isHover=!0},onMouseLeave:function(){this._isHover=!1},toggleMute:function(){this.slider.onoff()},togglePane:function(e){this.$el.toggleClass("--active",e)},onMouseover:function(){this._touched?this._touched=!1:this.togglePane(!0)},onMouseout:function(){!1===this.slider.started&&this.togglePane(!1)},onVolumeInteractionEnd:function(){this.model.get("enable")&&(this._isHover||this.togglePane(!1))},show:function(){this.viewer.$el.addClass("sound-enabled")},hide:function(){this.viewer.$el.removeClass("sound-enabled")},render:function(){var e=this.model.get("volume");return this.$icon.toggleClass("fa-volume-up",e>=.5),this.$icon.toggleClass("fa-volume-down",e>0&&e<.5),this.$icon.toggleClass("fa-volume-off",0===e),this}}),Qe=n("nqMk"),Je=n("tLMR"),Ze=n("UpON"),$e=n("+Umg"),et=n("KxLt"),tt=n("j3Bp"),nt=n("tNdj").a.extend({}),it=tt.a.extend({model:nt,parse:function(e){return e.results.images},url:function(){return"/i/models/"+this.options.uid+"/fallback"}}),rt=f.a.extend({_isLoaded:!1,_context:null,isMoving:!1,startX:0,sensitivity:20,sprite:{current:0,steps:15,ratio:null,width:0},size:1,autospinTimer:null,events:{mousedown:"onMouseDown",mouseup:"onMouseUp","mousemove ":"onMouseMove",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove"},constructor:function(){this._boundResizeEvent=this.onWindowResize.bind(this),f.a.prototype.constructor.apply(this,arguments)},initialize:function(){f.a.prototype.initialize.apply(this,arguments),this.$viewport=u()(),this.$image=u()()},delegateEvents:function(){f.a.prototype.delegateEvents.apply(this,arguments),u()(window).on("resize",this._boundResizeEvent)},undelegateEvents:function(){f.a.prototype.undelegateEvents.apply(this,arguments),u()(window).off("resize",this._boundResizeEvent),this.autospinTimer&&clearInterval(this.autospinTimer)},isViewerReady:function(){return this._isLoaded},run:function(){var e=new et.a;this._context=e,this.$el.show(),this.$el.siblings(".webgl").hide(),this.$el.siblings(".osd").hide();var t=this.model.get("uid"),n=this._fallbackCollection=new it([],{uid:t});return n.fetch().then(function(){n.length>0?this.displayFallback():this.displayNoFallbackError()}.bind(this)).catch(function(){this.displayNoFallbackError()}.bind(this)),this._isLoaded=!0,!0},getContext:function(){return this._context},getFeatures:function(){return{}},findBestImage:function(){for(var e,t=this._fallbackCollection.toJSON(),n=this.$el.height(),i=1/0,r=0,a=t.length;r<a;++r){var o=t[r],s=Math.abs(n-o.height);s<i&&(i=s,e=o)}return e},displayFallback:function(){this.$viewport=u()(".fallback-viewport"),this.$image=this.$viewport.find("img.fallback-sprite");var e=this.findBestImage(),t=e.url;this._currentHeight=e.height,this.$image.on("load",function(e){var t=e.target.naturalHeight,n=e.target.naturalWidth/this.sprite.steps;this.sprite.ratio=t?n/t:0,u()(e.target).css("display","block"),this.trigger("secondary-progress",{progress:1}),this.trigger("success"),this.displayFallbackWarning(),this.onWindowResize()}.bind(this)),this.$image.on("error",function(e){console.error("Fallback loading failed. URL : "+t+" ERROR : "+e.toString()),this.trigger("fail"),this.displayFallbackLoadingError()}.bind(this)),this.$image.attr("src",t)},displayFallbackLoadingError:function(){this.$el.find(".fallback-error-loading").show()},displayNoFallbackError:function(){this.$el.find(".fallback-error-nofallback").show()},displayFallbackWarning:function(){this._warningDisplayed||(this._warningDisplayed=!0,this.$el.find(".fallback-warning").show(),this.fallbackWarning=setTimeout(function(){this.$el.find(".fallback-warning").fadeOut()}.bind(this),5e3))},onWindowResize:function(){if(this._fallbackCollection.length){var e,t,n=this.$el.width(),i=this.$el.height(),r=n/i;this.findBestImage().height>this._currentHeight&&this.displayFallback(),2===this.size?r<this.sprite.ratio?(e=n,t=Math.floor(e/this.sprite.ratio)):(t=i,e=Math.floor(t*this.sprite.ratio)):r<this.sprite.ratio?(t=i,e=Math.floor(t*this.sprite.ratio)):(e=n,t=Math.floor(e/this.sprite.ratio)),this.$viewport.width(e).height(t).css({"margin-top":Math.round(-1*t/2),"margin-left":Math.round(-1*e/2)}),this.sprite.width=Math.round(this.$image.prop("scrollHeight")*this.sprite.ratio),this.$viewport.scrollLeft(this.sprite.width*this.sprite.current)}},onMouseDown:function(e){e.preventDefault(),this.isMoving=!0,this.startX=e.clientX},onMouseMove:function(e){e.preventDefault(),this.move(e.clientX)},onMouseUp:function(e){e.preventDefault(),this.isMoving=!1},onTouchStart:function(e){e.preventDefault(),this.isMoving=!0;var t=e.originalEvent.touches[0];this.startX=t.clientX},onTouchMove:function(e){e.preventDefault(),this.move(e.originalEvent.touches[0].clientX)},onTouchEnd:function(e){e.preventDefault(),this.isMoving=!1},move:function(e){this.isMoving&&(this.autospinTimer&&this.stopAutospin(),e>this.startX+this.sensitivity&&(this.startX=e,this.moveRight()),e<this.startX-this.sensitivity&&(this.startX=e,this.moveLeft()))},moveRight:function(){0===this.sprite.current?this.sprite.current=this.sprite.steps-1:this.sprite.current=this.sprite.current-1,this.$viewport.scrollLeft(this.sprite.width*this.sprite.current)},moveLeft:function(){this.sprite.current=(this.sprite.current+1)%this.sprite.steps,this.$viewport.scrollLeft(this.sprite.width*this.sprite.current)},startAutospin:function(){this.autospinTimer=setInterval(Object($e.a)(function(){this.moveLeft()},this),500)},stopAutospin:function(){clearInterval(this.autospinTimer),this.autospinTimer=null},toggleAutospin:function(){this.autospinTimer?this.stopAutospin():this.startAutospin()}}),at=n("l/Ry"),ot=n("8eYQ"),st=n("GFHa"),ut=(n("g+9p"),z.a.shortcuts),lt=new d.a({device:"WEB",listen:!0});t.a=f.a.extend({subviews:{},events:{'click [data-action="start"]':"onStart",'click [data-action="stop"]':"onStop",click:"globalCloseEvent",touchend:"globalCloseEvent",'click [data-action="inspector"]':"toggleInspector",'click [data-action="ascii"]':"toggleASCII"},templates:{viewerMode:_.default.getFromMacro("skfb_front/macros/viewer","help_viewer_mode"),viewerVr:_.default.getFromMacro("skfb_front/macros/viewer","help_vr_mode")},initialize:function(){f.a.prototype.initialize.apply(this,arguments),this.proxySettings=new T.a({shadingStyle:null,viewerMode:null,wireframeColor:null,wireframeEnable:null,hasWireframe:null,annotationsVisible:null,textureQuality:null,speed:null,cycleMode:null,fps:null}),this.initializeMandatorySubviews(),this.initializeHashMessages(),this.initializeSoundManager(),this.delegateGlobalMoveEvent(),this.delegateSubviews(),this.isVR()&&c.a.apple.device&&this.hackIosCanvasRender(),c.a.any||!S.a||Object(P.a)().transparent||this.hackDesktopSafariCanvasBackground()},_createSubview:function(e,t,n){return this.subviews[e]=new t(Object(i.a)({},{viewer:this,widgets:this.subviews},n)),this.subviews[e]},globalCloseEvent:function(e){u()(e.target).hasClass("has-menu")||u()(e.target).parents(".has-menu").length||(this.subviews.hotspots&&this.subviews.hotspots.toggleAnnotationList(!1),this.subviews.gui.closeMenus())},delegateGlobalMoveEvent:function(){var e;Object(v.a)()||(this.el.addEventListener("touchmove",this.preventScroll.bind(this),{passive:!1}),this.$el.on("mousedown touchstart",function(e){"canvas"===e.target.tagName.toLowerCase()&&(clearTimeout(this._showGuiTimeout),clearTimeout(this._hideGuiTimeout),this._hideGuiTimeout=setTimeout(function(){this.$el.addClass("moving")}.bind(this),150))}.bind(this)),this.$el.on("mouseup touchend",function(e){"canvas"===e.target.tagName.toLowerCase()&&(clearTimeout(this._hideGuiTimeout),clearTimeout(this._showGuiTimeout),e.preventDefault(),this._showGuiTimeout=setTimeout(function(){this.$el.hasClass("moving")&&this.$el.removeClass("moving")}.bind(this),500))}.bind(this)),this.$el.on("wheel",function(t){"canvas"===t.target.tagName.toLowerCase()&&(this.$el.addClass("moving"),clearTimeout(e),e=setTimeout(function(){this.$el.removeClass("moving")}.bind(this),300))}.bind(this)),u()(this.el).on("mouseout",function(e){var t=e.relatedTarget||e.toElement;c.a.any||(clearTimeout(this.globalIdleTimeout),this.$el.find(t).length||(this.globalIdleTimeout=setTimeout(this.onGlobalIdleTimeout.bind(this),3500)))}.bind(this)),u()(this.el).on("mouseenter mousein",function(){clearTimeout(this.globalIdleTimeout),(this.$el.hasClass("idle")||this.$el.hasClass("moving"))&&(this.$el.removeClass("idle moving"),Object(r.a)(this.subviews,function(e){e.trigger("idle",!1)}))}.bind(this)))},preventScroll:function(e){if(e.target.classList.contains("canvas"))return e.preventDefault();var t=void 0!==e.target.dataset.hotspotTarget;this.subviews&&this.subviews.helpOverlay&&!this.subviews.helpOverlay.isVisible()&&!t&&e.preventDefault()},onGlobalIdleTimeout:function(){Object(v.a)()||(this.$el.addClass("idle"),Object(r.a)(this.subviews,function(e){e.trigger("idle",!0)}))},initializeMandatorySubviews:function(){this._createSubview("gui",E,{el:this.$el}),this._createSubview("loading",D,{el:this.$(".loading-container"),color:Object(st.b)(Object(P.a)().uiColor)}),this._createSubview("hint",V,{el:this.$el,fallback:!Object(m.a)()}),this._createSubview("generalControls",ge,{el:Object(m.a)()?this.$(".general-controls"):this.$(".fallback .controls"),fallback:!Object(m.a)()}),this._createSubview("header",me,{el:this.$(".titlebar")}),this._createSubview("snapshot",ve.a,{el:this.$el}),this._createSubview("helpOverlay",ye,{el:this.$(".help.overlay")}),this._createSubview("hotspotsOverlay",Ce,{el:this.$(".hotspots-overlay")}),this._createSubview("arOverlayDesktop",_e.a.extend({setUrl:function(e){this.$(".url").attr("href",e).text(e)}}),{el:this.$(".ar-overlay-desktop")}),this._createSubview("arOverlayMobile",_e.a.extend({setPlatform:function(e){this.$(".mobilePlatform").text(e)},setMinVersion:function(e){this.$(".minVersion").text(e)}}),{el:this.$(".ar-overlay-mobile")}),this._createSubview("arOverlayLoading",_e.a.extend({}),{el:this.$(".ar-overlay-loading")}),this._createSubview("arOverlayErrorMessage",_e.a.extend({}),{el:this.$(".ar-overlay-error")}),this._createSubview("helperVrOverlay",_e.a.extend({setUrl:function(e){this.$(".url").attr("href",e).text(e)}}),{el:this.$(".helper-vr-overlay")}),this._createSubview("osd",Xe,{el:this.$el})},initShortcuts:function(){this.viewerRenderingShortcuts=new y.a(ut.viewerRendering),this.viewerRenderingShortcuts.on("toggleWireframe",function(){if(this.proxySettings.get("hasWireframe")){var e=!this.proxySettings.get("wireframeEnable");b.a.modelViewerWireframeShortcut(e),this.proxySettings.set("wireframeEnable",e)}}.bind(this)),this.viewerRenderingShortcuts.on("inspector",this.toggleInspector,this),this.viewerRenderingShortcuts.listen([this.viewerRenderingShortcuts.getShortcut("toggleWireframe"),this.viewerRenderingShortcuts.getShortcut("inspector")]),this.viewerRenderingShortcuts.on("defaultRenderingMode",function(){this.proxySettings.set("shadingStyle","lit")}.bind(this)),this.viewerRenderingShortcuts.on("shadelessRenderingMode",function(){this.proxySettings.set("shadingStyle","shadeless")}.bind(this)),this.viewerRenderingShortcuts.on("matcapRenderingMode",function(){this.proxySettings.set("shadingStyle","matcap")}.bind(this)),this.updateShorcuts()},updateShorcuts:function(){"lit"===this._currentModel.get("options").shading.type||Object(v.a)()?this.viewerRenderingShortcuts.listen([this.viewerRenderingShortcuts.getShortcut("defaultRenderingMode"),this.viewerRenderingShortcuts.getShortcut("shadelessRenderingMode"),this.viewerRenderingShortcuts.getShortcut("matcapRenderingMode")]):this.viewerRenderingShortcuts.stopListening(["defaultRenderingMode","shadelessRenderingMode","matcapRenderingMode"])},blurHotspots:function(){this.subviews.hotspots&&(this.subviews.hotspots.hideTooltips(),this.subviews.hotspots.currentHotspot=-1,this.subviews.hotspots.renderControl())},initializeHashMessages:function(){Object(P.a)().isApp&&lt.on("message:vrMode",function(e){var t=parseInt(e.data.vrMode,10);this.blurHotspots(),this.scene.getFeatures().webVR.getModel().set("enable",!!t),e.removeFromHash()}.bind(this))},initializeHotspotsSubviews:function(e){var t=this;Promise.all([n.e(2),n.e(162)]).then(n.bind(null,"v187")).then(function(n){var i=n.default,r=t.scene.getFeatures().hotspot.getModel();if(t._createSubview("hotspots",i,{el:t.$el,model:r,container:t.$(".hotspots"),fallback:!Object(m.a)()}),0===Object(P.a)().annotationTooltipVisible){var a=t.subviews.hotspots;return a.hideAnnotationControls(),void a.hideTooltips()}"function"==typeof e&&e()})},initializeAnimationSubviews:function(e){var t=this;n.e(170).then(n.bind(null,"Smm5")).then(function(n){var i=n.default,r=t.scene.getFeatures().animation.getModel();t._createSubview("animationControls",i,{el:t.$(".animation-controls"),model:r,currentModel:t._currentModel,enabled:!t.isVR()}),"function"==typeof e&&e()})},delegateSubviews:function(){this.isVR()?(this.subviews.gui.disable(),this.subviews.header.disable()):(this.subviews.loading.on("loaded",setTimeout.bind(window,this.subviews.gui.enable.bind(this.subviews.gui),500)),this.subviews.header.enable()),this.subviews.loading.on("loaded",function(){Object(P.a)().transparent||this.$el.addClass("transparent-pattern")}.bind(this))},onStart:function(){this.start(),this._startTracked||(this._startTracked=!0)},start:function(e){this.$el.addClass("started"),!0===e?b.a.modelEmbedAutostart(this._currentUid):b.a.modelEmbedPlayButtonClicked(this._currentUid),this.$el.hasClass("transparent")||this.$el.addClass("transparent-pattern"),this._options&&this.load();var t=this.scene&&this.scene.getViewerOSGJS&&this.scene.getViewerOSGJS();return t&&Ze.a.getHasAnimation().then(function(e){if(e){var n=this.scene.getFeatures().animation.getModel();this._wasPlaying&&(n.set("playing",!0),this._wasPlaying=void 0)}t.run()}.bind(this)),C.a.setEnabled(!0),this.trigger("started"),this},onStop:function(){this.subviews.modelInspector&&(this.subviews.modelInspector.close(),u()(".summary").removeClass("shifted"),u()(".watermark").removeClass("shifted-watermark")),this.stop()},stop:function(){var e=this._currentModel?this._currentModel.get("uid"):this._currentUid;b.a.modelEmbedStopButtonClicked(e),this.$el.removeClass("started");var t=this.scene&&this.scene.getViewerOSGJS&&this.scene.getViewerOSGJS();return t&&(Ze.a.getHasAnimation().then(function(e){if(e){var t=this.scene.getFeatures().animation.getModel();this._wasPlaying=t.get("playing"),this._wasPlaying&&t.set("playing",!1)}}.bind(this)),t.stop()),this.subviews.hotspots&&this.subviews.hotspots.triggerHotspotCycle(!1),C.a.setEnabled(!1),this.trigger("stopped"),this},load:function(){if(this._options){var e=this._options;this._options=null,this.scene&&(this.scene.drop(),this.scene=null),this.subviews.loading.reset(),this.$el.removeClass("model-loaded"),this.$el.addClass("model-loading"),T.a.get(e.uid).then(this.onModelLoad.bind(this,e))}},lookat:function(e,t,n){void 0===n&&(n=1);var i=this.scene.getFeatures().camera.getModel();i.set("animationDuration",n),i.setTargetAndEye(t,e)},isVR:function(){return this.scene?this.scene.getFeatures().webVR.getModel().get("enable"):Object(P.a)().cardboard>0},isCardboard:function(){return Object(P.a)().cardboard>0},onModelLoad:function(e,t){ot.a.client.configureScope(function(e){e.setTag("frontend","3d")}),this._currentModel=t,t.hit();var n=this.scene=this.createScene(t,e);this.subviews.loading.handleLoading({model:t,scene:n}),n.run(),Object(m.a)()?(this.initShortcuts(),this.initViewerFeatures(),this.subviews.hint.show(),this.trigger("model-loaded"),ot.a.client.configureScope(function(e){e.setTag("frontend","web")})):this.$el.addClass("fallback-mode")},errorHandler:function(e){if(e instanceof g.e){var t,n,r,a,o,s=Object(w.c)(e.account);switch(e.feature){case"sound":n="sound track",r="sounds",o=e.limit===z.a.maxSoundtracksPerModel.ent;break;case"hotspot":n="annotation",r="annotations",o=e.limit===z.a.maxHotspotsPerModel.ent;break;default:throw e}if(o)a=["You have reached the maximum number of <b>"+n+"s</b> allowed by Sketchfab.","Have custom needs?"],t={text:"Contact us",callback:function(e){e.preventDefault(),new Je.a({title:"Get in touch",url:Object(Je.b)("m136bey3108spbc",{sourceField:13,mediumField:14,campaignField:15,gclidField:18,fbclidField:17,contentField:20,refField:21},{interestedInField:11,interestedIn:"Sketchfab for Enterprise"})}).open()}};else{var u=e.value?e.value-e.limit:0;a=["You have reached the maximum number of <b>"+e.limit+" "+n+x.pluralize(e.limit)+"</b> allowed by your plan.","To add a new "+n+", you need to "+(u?" delete "+u+" "+n+x.pluralize(e.limit)+" or ":"")+"upgrade to "+s+" plan."],t={href:"/plans",text:"Upgrade to "+s}}new Qe.a(Object(i.a)(e,{popupSubTitle:"You cannot add a new "+n,popupMessages:a,additionalButton:t,popupImg:r})).open()}else this.subviews.osd.show(e.message,arguments)},setScene:function(e){if(this.scene)throw new Error("It is currently impossible to reset a scene");return this._options=e,this._currentUid=e.uid,this},createScene:function(e,t){if(Object(m.a)()){var n={};return n.el=this.$(".webgl"),n.features=t.features,n.widgetAPI=t.widgetAPI,n.model=e,n.viewerAPI=t.viewerAPI,Ze.a.getPolygon().then(function(e){b.a.modelViewerPolygonLoaded(e.time)}),Ze.a.getWireframe().then(function(e){b.a.modelViewerWireframeLoaded(e.time)}),Ze.a.getLowResLoaded().then(function(e){b.a.modelViewerLowResTexturesLoaded(e.time,e.count)}),Ze.a.getHighResLoaded().then(function(e){b.a.modelViewerHighResTexturesLoaded(e.time,e.count)}),Ze.a.getModelDisplayed().then(function(e){b.a.modelViewerModelDisplayed(e.time)}),new at.a(n)}return b.a.modelViewerFallbackDisplayed(e.get("uid")),new rt({model:e,el:this.$(".fallback"),features:t.features})},initViewerFeatures:function(){this.initializeSound(),Ze.a.getModelDisplayed().then(function(){Ze.a.getHasAnimation().then(function(e){e&&this.initializeAnimation()}.bind(this)),this.initializeHotspots(),this.initializeShading(),this.initializeViewerMode(),this.initializeTextureQuality(),this.initializeVr(),this.initializeModelInspector()}.bind(this))},initializeHotspots:function(){var e=this.scene.getFeatures().hotspot,t=e&&e.getModel();t&&this.initializeHotspotsSubviews(function(){var e=this.subviews.hotspots;t.setUpdateCallback(e.refreshHotspots.bind(e));var n=t.get("hotspots");n.on("add remove sort change:title change:description change:position",e.refreshHotspots,e),n.on("add remove sort change:name",e.updateHotspotsControls,e),n.on("add remove",Object(a.a)(this.subviews.generalControls.renderSettings,100),this.subviews.generalControls),n.on("select",e.onHotspotSelected,e),n.on("add",e.showAnnotations,e),n.on("remove",function(){0===n.length&&e.hideAnnotations()}),this.proxySettings.on("change:annotationsVisible",function(){n.length&&this.proxySettings.get("annotationsVisible")?e.showAnnotations():e.hideAnnotations()}.bind(this)),this.proxySettings.set("annotationsVisible",t.get("visible"),{silent:!0}),t.set("proxyModel",this.proxySettings),e.refreshHotspots(),e.updateHotspotsControls(),Ze.a.getFirstCameraAnimation().then(function(){if(t.on("hotspot-error",this.errorHandler.bind(this)),!0===Object(P.a)().annotationCycleAutostart){var e=Math.max(Object(P.a)().annotation,1);n.trigger("select",n.at(e-1)),this.subviews.hotspots.triggerHotspotCycle(!0)}else Object(P.a)().annotation>0&&n.trigger("select",n.at(Object(P.a)().annotation-1))}.bind(this))}.bind(this))},initializeAnimation:function(){var e=this.scene.getFeatures().animation.getModel();this.initializeAnimationSubviews(function(){this.$el.addClass("has-animation"),this.subviews.generalControls.setHasAnimations(!0),this.proxySettings.set("speed",e.get("speed")),this.proxySettings.set("cycleMode",e.get("cycleMode")),this.proxySettings.set("fps",e.get("fps")),this.proxySettings.on("change:speed",function(t,n){e.set("speed",n)}),this.proxySettings.on("change:cycleMode",function(t,n){e.set("cycleMode",n)}),this.proxySettings.on("change:fps",function(t,n){e.set("fps",n)}),e.on("change:fps",function(e,t){this.proxySettings.set("fps",t)}.bind(this)),this.$(".osd").addClass("padded"),this.$(".timeline").removeClass("disabled")}.bind(this))},isFeatureAvailable:function(e,t,n){return e&&t&&0!==n.length},initializeModelInspector:function(){var e=this.scene.getFeatures().inspector,t=this.proxySettings,n=this.$(".model-inspector");if(this.isFeatureAvailable(Object(P.a)().uiInspector,e,n)){var i=e.getModel();this._createSubview("modelInspector",qe,{model:i,inspectableTextures:Object(v.a)()||this.scene.model.get("isInspectable"),wireframeModel:t,osd:this.subviews.osd,el:n}),Object(P.a)().uiInspectorOpen&&this.toggleInspector(),this.subviews.generalControls.listenTo(i,"change:uiVisible",function(e,t){this.$('[data-action="inspector"]').toggleClass("active",t),u()(".summary").toggleClass("shifted",t),u()(".controls").toggleClass("shifted",t)}.bind(this)),Object(v.a)()&&this.listenTo(i,"change:uiVisible",function(e,t){var n=this.scene._widgetAPI,i=this.subviews.modelInspector.model;t?(i.initAvailableView(),n.alert("To edit the model, close the Inspector.",{continue:!0,continueLabel:"Close Inspector"}).then(function(){this.$("canvas").focus(),this.toggleInspector()}.bind(this)).catch(function(e){if("Resuming editor"!==e)throw e})):n.resume()}.bind(this))}else this.$('[data-action="inspector"]').hide()},toggleInspector:function(){this.subviews.modelInspector&&(b.a.modelViewerInspectorButtonClicked(),this.subviews.modelInspector.toggle(),this.subviews.snapshot.$(".snapshot.widget").toggle(),this.subviews.header.$(".actions").toggle())},toggleASCII:function(){var e=new URLSearchParams(window.location.search);e.set("post_process_ascii","1"!==e.get("post_process_ascii")?"1":"0"),window.location.search=e.toString()},initializeTextureQuality:function(){var e=this,t=this.scene.getFeatures().quality;if(t){var n=t.getModel();n.get("promiseReady").then(function(e){this.subviews.generalControls.generateTextureQualitySettings(e),this.subviews.generalControls.settings.onTextureQualityReady.call(this.subviews.generalControls.settings,e)}.bind(this)),this.proxySettings.on("change:textureQuality",function(){var t=parseInt(this.get("textureQuality"),10);window.requestAnimationFrame(function(){n.set("level",t)});var i=e.subviews.generalControls.getSettingLabelForValue("textureQuality",t+"");e.$(".control-badge").text(i).addClass("active")})}},initializeViewerMode:function(){var e=this.scene.getFeatures().camera;if(e){var t=e.getModel(),n=t.get("indexManipulator");this.proxySettings.set("viewerMode",n),this.subviews.gui.renderSetting("viewerMode",n),this.proxySettings.on("change:viewerMode",function(){t.set("indexManipulator",parseInt(this.proxySettings.get("viewerMode"),10)),this.scene.getFeaturesManager().focusOnSavedCamera(1),this.$("canvas").focus()}.bind(this))}},initializeShading:function(){var e=this.scene.getFeatures().shadingStyle;if(e){var t=e.getModel(),n=this,i=function(){n.proxySettings.set("shadingStyle",t.get("type")),n.proxySettings.set("wireframeColor",t.get("wireframeColor")),n.proxySettings.set("wireframeEnable",t.get("wireframeEnable")),n.proxySettings.set("hasWireframe",t.get("hasWireframe")),n.subviews.gui.renderSetting("wireframeColor",n.proxySettings.get("wireframeColor")),n.subviews.gui.renderSetting("wireframeEnable",n.proxySettings.get("wireframeEnable")?1:0),n.subviews.gui.renderSetting("hasWireframe",n.proxySettings.get("hasWireframe")?1:0),n.subviews.gui.renderSetting("shadingStyle",n.proxySettings.get("shadingStyle"))};i(),this.proxySettings.listenTo(t,"change",i),this.proxySettings.on("change:shadingStyle",function(){t.set("type",this.get("shadingStyle"))}),this.proxySettings.on("change:wireframeColor",function(){this.get("wireframeEnable")?t.setWireframeColorSmooth(this.get("wireframeColor")):t.set("wireframeColor",this.get("wireframeColor"))}),this.proxySettings.on("change:wireframeEnable",function(){t.set("wireframeEnable",!!this.get("wireframeEnable"))})}},initializeVr:function(){if(this.isVR()){if(this.$el.addClass("vr-mode"),1===p.a.get("sf_show_vr_hint",1)){var e=this.templates.viewerVr([Q()]);this.subviews.osd.show(e,{duration:5e3})}p.a.set("sf_show_vr_hint",0,{expires:504e5})}else Object(P.a)().vrLinkNavigation&&this.subviews.osd.show(c.a.any?"Tap on Screen or Press any button to switch to VR":"Press Enter to switch to VR",{duration:5e3})},initializeSoundManager:function(){this.proxySettings.on("sound-error",this.errorHandler.bind(this)),this.proxySettings.on("sound-hide",this.subviews.osd.hide.bind(this.subviews.osd)),this.proxySettings.on("sound-show",this.subviews.osd.show.bind(this.subviews.osd)),C.a.setProxyModel(this.proxySettings)},initializeSound:function(){var e=this.scene.getFeatures().sound;if(e){var t=e.getModel(),n=t.get("soundtracks"),i=this._createSubview("sound",Ke,{el:this.$(".general-controls .volume"),model:t});n.on("add",i.show,i),n.on("remove",function(){0===n.length&&i.hide()}),n.length&&t.get("visible")&&i.show(),t.on("sound-error",this.errorHandler.bind(this))}},hackDesktopSafariCanvasBackground:function(){this.$("canvas").parent().css({backgroundColor:"#000"})},hackIosCanvasRender:function(){Object(o.a)(function(){u()("canvas")[0].style.width=u()("canvas")[0].clientWidth+1+"px",Object(o.a)(function(){u()("canvas")[0].style.width=u()("canvas")[0].clientWidth-1+"px",u()("canvas")[0].style.width=""})})},isStarted:function(){return this.el.classList.contains("started")}})},"+N0+":function(e,t,n){"use strict";var i=n("MVZn"),r=n.n(i);t.a={setCustomData:function(e){window.adroll_custom_data=e},setStoreProductId:function(e){return this.setCustomData(e)},recordUser:function(e){return void 0===window.adroll_adv_id?void 0:window.__adroll.record_user(e)},recordAddToCart:function(e){return this.recordUser(r()({product_action:"AddToCart"},e))}}},"+XBE":function(e,t){e.exports='uniform vec4 uLineColor;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n    vec4 color = sRGBToLinear(uLineColor);\n    color.rgb *= color.a;\n    gl_FragColor = linearTosRGB(color);\n}\n'},"+cEC":function(e,t,n){"use strict";var i=n("QLQS"),r=n("AhqU"),a=n("1f5D"),o=n("JQdh"),s=n("fgaA"),u=i.a.osg,l=function(){u.CullVisitor.call(this),this._separateVR=!1,this._isEnv=!1,this._isRootModel=!1},c=l.vrConfig={doVR:!1,framebufferWidth:0,framebufferHeight:0,leftRenderWidth:0,rightRenderWidth:0,leftRenderHeight:0,rightRenderHeight:0,rightProjection:u.mat4.create(),leftProjection:u.mat4.create(),leftOffsetView:u.mat4.create(),rightOffsetView:u.mat4.create()};l.cameraMain=void 0,l.cameraEnvironment=void 0,l.nodePostProcessOut=void 0,l.nodeRootModel=void 0,u.createPrototypeObject(l,u.objectInherit(u.CullVisitor.prototype,{popCameraModelViewProjectionMatrix:function(e){this.popModelViewMatrix(),this.popProjectionMatrix(e)},reset:function(){u.CullVisitor.prototype.reset.call(this),this._minNear=this._computedNear,this._maxFar=this._computedFar},updateNearFar:function(){this._minNear=Math.min(this._minNear,this._computedNear),this._maxFar=Math.max(this._maxFar,this._computedFar)},_handleMainCamera:function(e){var t=this.getCurrentProjectionMatrix(),n=this._computedNear,i=this._computedFar,r=this._nearFarRatio,o=this._projectionMatrixStack.getArray()[0];u.mat4.copy(o,t),this.clampProjectionMatrix(o,this._minNear,this._maxFar,1e-5),c.doVR&&(this.clampProjectionMatrix(c.leftProjection,n,i,r),this.clampProjectionMatrix(c.rightProjection,n,i,r));var s=a.a.uNearFar.getInternalArray();this.clampProjectionMatrix(t,n,i,r,s),e.clampedProjectionMatrix?u.mat4.copy(e.clampedProjectionMatrix,t):e.clampedProjectionMatrix=u.mat4.clone(t)},popProjectionMatrix:function(e){if(!0===this._computeNearFar&&this._computedFar>=this._computedNear){var t=e===l.cameraMain;(t||e.getReferenceFrame()===u.Transform.RELATIVE_RF&&!e.isRenderToTextureCamera())&&this.updateNearFar(),t?this._handleMainCamera(e):this.clampProjectionMatrix(this.getCurrentProjectionMatrix(),this._computedNear,this._computedFar,this._nearFarRatio)}u.CullStack.prototype.popProjectionMatrix.call(this)},handleCullCallbacksAndTraverse:function(e){e===l.nodePostProcessOut?this._separateVR=c.doVR:e===l.cameraEnvironment?this._isEnv=!0:e===l.nodeRootModel&&(this._isRootModel=!0);var t=e.getCullCallback();t&&!t.cull(e,this)||this.traverse(e),e===l.nodePostProcessOut?this._separateVR=!1:e===l.cameraEnvironment?this._isEnv=!1:e===l.nodeRootModel&&(this._isRootModel=!1)},pushLeaf:function(e,t){var n=this._currentStateGraph._leafs;0===n.getLength()&&this._currentRenderBin.addStateGraph(this._currentStateGraph);var i=this._separateVR&&this.traversalMask!==r.a.SHADOW,a=this.createOrReuseRenderLeaf();if(a.isVR=i,i){var o=this._isEnv,s=this.getCurrentModelViewMatrix(),l=this.getCurrentViewMatrix();a.leftProjection=c.leftProjection,a.rightProjection=c.rightProjection;var h=a.leftModelView||u.mat4.create(),d=a.rightModelView||u.mat4.create();a.leftModelView=o?u.mat4.copy(h,s):u.mat4.multiply(h,c.leftOffsetView,s),a.rightModelView=o?u.mat4.copy(d,s):u.mat4.multiply(d,c.rightOffsetView,s);var f=a.leftView||u.mat4.create(),p=a.rightView||u.mat4.create();a.leftView=o?u.mat4.copy(f,l):u.mat4.multiply(f,c.leftOffsetView,l),a.rightView=o?u.mat4.copy(p,l):u.mat4.multiply(p,c.rightOffsetView,l)}a.init(this._currentStateGraph,e,this.getCurrentProjectionMatrix(),this.getCurrentViewMatrix(),this.getCurrentModelViewMatrix(),this.getCurrentModelMatrix(),t),n.push(a)},updateCalculatedNearFar:function(e,t){var n=o.a.getModelBoxWithoutDisplacement();if(n&&this._isRootModel){var i=Object(s.a)().scaleEpsilon*n.radius()/t.getBound().radius();i*=i;var r=e[0],a=e[4],l=e[8];if(r*r+a*a+l*l<i&&(r=e[1])*r+(a=e[5])*a+(l=e[9])*l<i&&(r=e[2])*r+(a=e[6])*a+(l=e[10])*l<i)return!1}return u.CullVisitor.prototype.updateCalculatedNearFar.call(this,e,t)}}),"osgSketchfab","CullVisitor"),t.a=l},"+lWh":function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return o}),n.d(t,"g",function(){return s}),n.d(t,"n",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"l",function(){return c}),n.d(t,"k",function(){return h}),n.d(t,"i",function(){return d}),n.d(t,"e",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"m",function(){return g}),n.d(t,"o",function(){return m}),n.d(t,"a",function(){return v}),n.d(t,"p",function(){return _}),n.d(t,"j",function(){return b}),n.d(t,"d",function(){return S}),n.d(t,"h",function(){return y});var i=n("vJtL"),r=n("oTSI"),a=n("6uKY"),o=function(e){var t=e.getBoundingClientRect(),n=t.left+t.width/2,i=t.top+t.height/2,r=(window.innerHeight||document.documentElement.clientHeight)/2;return n-(window.innerWidth||document.documentElement.clientWidth)/2+(i-r)},s=function e(t,n){return null!==n.parentNode&&(n.parentNode===t||e(t,n.parentNode))},u=function(e){var t=e.getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft,width:t.width,height:t.height}},l=function(e){var t=e.getBoundingClientRect(),n=document.body,i=document.documentElement,r=window.pageYOffset||i.scrollTop||n.scrollTop,a=window.pageXOffset||i.scrollLeft||n.scrollLeft,o=i.clientTop||n.clientTop||0,s=i.clientLeft||n.clientLeft||0,u=Math.round(t.top+r-o),l=Math.round(t.left+a-s);return{top:u,left:l,bottom:u+t.height,right:l+t.width}},c=function(t){return new e(function(e,n){var i=new Image;i.onload=function(){return e(i)},i.onerror=n,i.src=t,i.complete&&e(i)})},h=function(e){return c(e).then(function(){return null}).catch(function(){return null})},d=function(e){var t=new Image;return t.src=e,t.complete&&0!==t.naturalHeight},f=function(e,t,n){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("width",t),i.setAttribute("height",n),i.innerHTML='\n        <foreignObject\n            x="0"\n            y="0"\n            width="'.concat(t,'"\n            height="').concat(n,'">\n            <div xmlns="http://www.w3.org/1999/xhtml">\n                ').concat(e,"\n            </div>\n        </foreignObject>\n    "),i},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.92,i=document.createElement("canvas");i.setAttribute("width","".concat(2*e.width)),i.setAttribute("height","".concat(2*e.height));var r=i.getContext("2d");return r.scale(2,2),r.fillStyle="#fff",r.fillRect(0,0,i.width,i.height),r.drawImage(e,0,0),i.toDataURL(t,n)},g=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.margin,r=void 0===i?20:i,a=n.threshold,o=void 0===a?[0,1]:a,s=n.visibilityThreshold;return"IntersectionObserver"in window?function(e,t,n){var i=n.visibilityThreshold,r=n.margin,a=n.threshold,o=!1,s=new IntersectionObserver(function(e){e.forEach(function(e){var n=e.intersectionRatio>i;n!==o&&t(n),o=n})},{threshold:a,rootMargin:"".concat(r,"px ").concat(r,"px ").concat(r,"px ").concat(r,"px")});return s.observe(e),function(){return s.unobserve(e)}}(e,t,{visibilityThreshold:void 0===s?0:s,margin:r,threshold:o}):function(e){return setTimeout(function(){return e(!0)}),function(){}}(t)},m=function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"string";if(!(t=document.getElementById("js-dom-data-"+e)))return null;if(n=t.firstChild.textContent.replace(/SKFB_COMMENT_END/g,"--\x3e").trim(),n=Object(a.decodeHTMLEntities)(n),"json"===i)try{return JSON.parse(n)}catch(e){console.warn("Failed to JSON decode DOM data."),console.warn(e)}return n},v=function(e,t,n,r){Object(i.a)(e.on)?e.on(t,n):Object(i.a)(e.addEventListener)&&e.addEventListener(t,n,r)},_=function(e,t,n,r){Object(i.a)(e.off)?e.off(t,n):Object(i.a)(e.removeEventListener)&&e.removeEventListener(t,n,r)},b=Object(r.a)(function(){return!0===window.__IS_JSDOM__}),S=function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild},y=Object(r.a)(function(){return!(b()||!navigator.userAgent.includes("MSIE ")&&!navigator.userAgent.match(/Trident.*rv\:11\./))})}).call(this,n("CSL1"))},"+vFx":function(e,t,n){"use strict";var i=n("QLQS"),r=n("fgaA"),a=i.a.osg,o=function(e){a.StateAttribute.call(this),this._enable=!e&&Object(r.a)().zz};a.createPrototypeStateAttribute(o,a.objectInherit(a.StateAttribute.prototype,{attributeType:"VertexCompression",cloneType:function(){return new o(!0)},isEnabled:function(){return this._enable},getHash:function(){return"VCMP"+(this._enable?1:0)}}),"osg","VertexCompression"),t.a=o},"+vQk":function(e,t,n){"use strict";var i=n("icjm"),r={instance:function(){return r._instance||(r._instance=r,r._instance.plugins=new window.Map),r._instance},addReaderWriter:function(e,t){void 0!==r.instance().plugins.get(e)&&i.a.warn("the '"+e+"' plugin already exists"),r.instance().plugins.set(e,t)},getReaderWriterForExtension:function(e){return r.instance().plugins.get(e)}};t.a=r},"/+vK":function(e,t){e.exports="uniform vec4 uHalton;\n\nuniform float uSSAARestart;\nuniform sampler2D TexturePrevious;\nuniform vec2 uTexturePreviousSize;\n\n// static in place amortized supersampling\nvec4 supersample() {\n    vec4 currFragColor = TEXTURE_2D_TextureInput(gTexCoord).rgba;\n\n    float haltz = abs(uHalton.z);\n    if (haltz == 1.0) {\n        // just return the color.\n        return currFragColor;\n    }\n\n    // same pixel for same projected interpolated vertex on prev frame\n    vec4 accumColorN = TEXTURE_2D_NEAREST_TexturePrevious(gTexCoord).rgba;\n\n    // mix frames\n    float lerpFac = 1.0 / uHalton.w;\n\n    // if uTaaSSSRestart is 0.0, then we used the previous TAAed image to start supersampling\n    // we do that to avoid a sudden re-aliasing of the image (which is perceptible)\n    if (uHalton.w == 1.0) lerpFac = uSSAARestart;\n\n    if (haltz == 3.0) {\n        // No supersample, crude motion blur by accumulation\n        return mix(currFragColor, accumColorN, lerpFac);\n    }\n\n    // Supsersample, accumulation + jittering\n    // http://en.wikipedia.org/wiki/Moving_average#Cumulative_moving_average\n    // cumulative moving average over frameNum (which starts at 2)\n    // n is previous frame\n    // accumColorN = Accum(n)\n    // return value is accumColor( n +1 )\n    // Accum(n+1) = Accum(n) + ((x(n+1) - Accum(n)) / (n + 1)))\n    // formula above is equal to glsl  mix\n    return mix(accumColorN, currFragColor, lerpFac);\n}\n"},"/0FW":function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return y});var i=n("o0o1"),r=n.n(i),a=n("yXPU"),o=n.n(a),s=n("MVZn"),u=n.n(s),l=n("QILm"),c=n.n(l),h=n("vDqi"),d=n.n(h),f=n("bLLl"),p=n("Y14P"),g=n("RzKY"),m=n("QKgc"),v=function(e){return e.match(new RegExp("^(".concat(window.location.origin,"|/)")))},_=function(e){return v(e)?{"X-CsrfToken":p.a.get("sb_csrftoken")||"skfb-no-token"}:{}},b=d.a.create({headers:{"X-Requested-With":"XMLHttpRequest"}}),S=function(){return p.a.get("sb_csrftoken")?e.resolve():b.get("/i/csrf").then(function(){return e.resolve()})},y=function(t){var n=function(e){return e>3e4?e:2*e};return{get:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.allowPrefetching,a=void 0===r||r,o=i.headers,s=void 0===o?{}:o,l=c()(i,["allowPrefetching","headers"]),h=t.get(n);return a&&h?e.resolve(h):e.resolve(b.get(n,u()({},l,{headers:u()({},_(n),s)})).then(function(e){var i=e.data;return t.register(n,i),i}))},post:function(){var n=o()(r.a.mark(function n(i,a){var o,s,l,h,d,f,p=arguments;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=p.length>2&&void 0!==p[2]?p[2]:{},s=o.cacheBusting,l=void 0===s||s,h=o.headers,d=void 0===h?{}:h,f=c()(o,["cacheBusting","headers"]),l&&t.invalidate(i),!v(i)){n.next=6;break}return n.next=6,S();case 6:return n.abrupt("return",e.resolve(b.post(i,a,u()({},f,{headers:u()({},_(i),d)})).then(function(e){return e.data})));case 7:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}(),delete:function(){var n=o()(r.a.mark(function n(i,a){var o,s,l,h,d,f,p=arguments;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=p.length>2&&void 0!==p[2]?p[2]:{},s=o.cacheBusting,l=void 0===s||s,h=o.headers,d=void 0===h?{}:h,f=c()(o,["cacheBusting","headers"]),l&&t.invalidate(i),!v(i)){n.next=6;break}return n.next=6,S();case 6:return n.abrupt("return",e.resolve(b.request(u()({},f,{url:i,data:a,method:"DELETE",headers:u()({},_(i),d)})).then(function(e){return e.data})));case 7:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}(),patch:function(){var n=o()(r.a.mark(function n(i,a){var o,s,l,h,d=arguments;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=d.length>2&&void 0!==d[2]?d[2]:{},s=o.headers,l=void 0===s?{}:s,h=c()(o,["headers"]),t.invalidate(i),!v(i)){n.next=6;break}return n.next=6,S();case 6:return n.abrupt("return",e.resolve(b.patch(i,a,u()({},h,{headers:u()({},_(i),l)})).then(function(e){return e.data})));case 7:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}(),poll:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return g.g(1/0,function(){return e.resolve(b.get(t,{headers:u()({},_(t))}).catch(function(e){if(429===e.status)throw new m.f;throw e}).then(function(e){var t=e.status,n=e.data;if(202===t)throw new m.f("Resource isn't ready");return n}))},{interval:i,prevInterval:r})},retry:function(e,t,n){return g.g(e,function(){return t().catch(function(e){if(429===e.status)throw new m.f;throw e})},n)}}},x=y(f.b);t.b=x}).call(this,n("CSL1"))},"/3JF":function(e,t,n){e.exports=n.p+"static/assets/images/sketchfab-white-white-a67a66d0659dfcc7a39aefd3c415435d.svg"},"/QLk":function(e,t,n){"use strict";var i=n("icjm"),r=function(e){this._data=void 0,this._transpose=!1,this._glCall="",this._cache=void 0,this._name=e,this._type=void 0,this._isMatrix=!1};r.isUniform=function(e){return"object"==typeof e&&window.Object.getPrototypeOf(e)===r.prototype},(r.prototype={getName:function(){return this._name},getType:function(){return this._type},apply:function(e,t){this._cache||(this._cache=e[this._glCall]),this._isMatrix?this._cache.call(e,t,this._transpose,this._data):this._cache.call(e,t,this._data)},setInternalArray:function(e){i.a.warn("setInternalArray deprecated, please use getInternalArray instead: "+e.length),this._data=e},getInternalArray:function(){return this._data},setFloat:function(e){this._data[0]=e},setFloat1:function(e){this._data[0]=e[0]},setFloat2:function(e){this._data[0]=e[0],this._data[1]=e[1]},setFloat3:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2]},setFloat4:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2],this._data[3]=e[3]},setFloat9:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2],this._data[3]=e[3],this._data[4]=e[4],this._data[5]=e[5],this._data[6]=e[6],this._data[7]=e[7],this._data[8]=e[8]},setFloat16:function(e){this._data[0]=e[0],this._data[1]=e[1],this._data[2]=e[2],this._data[3]=e[3],this._data[4]=e[4],this._data[5]=e[5],this._data[6]=e[6],this._data[7]=e[7],this._data[8]=e[8],this._data[9]=e[9],this._data[10]=e[10],this._data[11]=e[11],this._data[12]=e[12],this._data[13]=e[13],this._data[14]=e[14],this._data[15]=e[15]}}).setVec2=r.prototype.setFloat2,r.prototype.setVec3=r.prototype.setFloat3,r.prototype.setVec4=r.prototype.setFloat4,r.prototype.setMatrix4=r.prototype.setFloat16,r.prototype.setMatrix3=r.prototype.setFloat9,r.prototype.setInt=r.prototype.setFloat,r.prototype.setInt1=r.prototype.setFloat1,r.prototype.setInt2=r.prototype.setFloat2,r.prototype.setInt3=r.prototype.setFloat3,r.prototype.setInt4=r.prototype.setFloat4;var a=function(e,t,n,i,a,o){var s=t&&t.length?e:void 0,u=new r(void 0!==s?t:e);if(u._data=n,void 0!==s)if(s.length)for(var l=0,c=s.length;l<c;++l)u._data[l]=s[l];else u._data[0]=s;return u._glCall=i,u._type=a,u._isMatrix=!!o,u},o=function(e,t,n){return n&&!n.length?n:"string"!=typeof t?(t.length||1)/e:1};r.createFloat1=function(e,t){return a(e,t,new Float32Array(1*o(1,e,t)),"uniform1fv","float")},r.createFloat2=function(e,t){return a(e,t,new Float32Array(2*o(2,e,t)),"uniform2fv","vec2")},r.createFloat3=function(e,t){return a(e,t,new Float32Array(3*o(3,e,t)),"uniform3fv","vec3")},r.createFloat4=function(e,t){return a(e,t,new Float32Array(4*o(4,e,t)),"uniform4fv","vec4")},r.createInt1=function(e,t){return a(e,t,new Int32Array(1*o(1,e,t)),"uniform1iv","int")},r.createInt2=function(e,t){return a(e,t,new Int32Array(2*o(2,e,t)),"uniform2iv","vec2i")},r.createInt3=function(e,t){return a(e,t,new Int32Array(3*o(3,e,t)),"uniform3iv","vec3i")},r.createInt4=function(e,t){return a(e,t,new Int32Array(4*o(4,e,t)),"uniform4iv","vec4i")},r.createMatrix2=function(e,t){return a(e,t,function(e){for(var t=new Float32Array(4*e),n=0;n<t.length;n+=4)t[n]=t[n+3]=1;return t}(o(4,e,t)),"uniformMatrix2fv","mat2",!0)},r.createMatrix3=function(e,t){return a(e,t,function(e){for(var t=new Float32Array(9*e),n=0;n<t.length;n+=9)t[n]=t[n+4]=t[n+8]=1;return t}(o(9,e,t)),"uniformMatrix3fv","mat3",!0)},r.createMatrix4=function(e,t){return a(e,t,function(e){for(var t=new Float32Array(16*e),n=0;n<t.length;n+=16)t[n]=t[n+5]=t[n+10]=t[n+15]=1;return t}(o(16,e,t)),"uniformMatrix4fv","mat4",!0)},r.float=r.createFloatArray=r.createFloat=r.createFloat1,r.vec2=r.createFloat2Array=r.createFloat2,r.vec3=r.createFloat3Array=r.createFloat3,r.vec4=r.createFloat4Array=r.createFloat4,r.int=r.createIntArray=r.createInt=r.createInt1,r.vec2i=r.createInt2Array=r.createInt2,r.vec3i=r.createInt3Array=r.createInt3,r.vec4i=r.createInt4Array=r.createInt4,r.mat2=r.createMat2Array=r.createMat2=r.createMatrix2,r.mat3=r.createMat3Array=r.createMat3=r.createMatrix3,r.mat4=r.createMat4Array=r.createMat4=r.createMatrix4,t.a=r},"/f4T":function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("QILm"),o=n.n(a),s=n("pVnL"),u=n.n(s),l=n("q1tI"),c=n("wsGC"),h=n("gCTM"),d=(n("SF8B"),function(){return r()("div",{className:"sketchfab-spinner",dangerouslySetInnerHTML:{__html:h.default.getFromMacro("skfb_front/macros/logo","sketchfab_spinner",[])}})}),f=function(){return r()("div",{className:"check",dangerouslySetInnerHTML:{__html:h.default.getFromMacro("skfb_front/macros/logo","spinner_check",[])}})},p=l.forwardRef(function(e,t){return e.href&&!e.disabled?l.createElement("a",u()({ref:t},e)):l.createElement("button",u()({ref:t},e))}),g=r()(f,{}),m=r()(d,{});t.a=l.forwardRef(function(e,t){var n=e.subtext,i=e.text,a=e.onClick,s=e.icon,h=e.size,d=void 0===h?"medium":h,f=e.type,v=void 0===f?"primary":f,_=e.className,b=void 0===_?"":_,S=e.iconClassName,y=void 0===S?"":S,x=e.disabled,C=void 0!==x&&x,w=e.loading,T=void 0!==w&&w,M=e.success,E=void 0!==M&&M,A=e.progress,O=e.htmlType,R=e.children,P=o()(e,["subtext","text","onClick","icon","size","type","className","iconClassName","disabled","loading","success","progress","htmlType","children"]),I=C||T;return l.createElement(p,u()({ref:t},P,{type:O,className:Object(c.a)("button","btn-".concat(v),"btn-".concat(d),b,{"btn-loading":T}),disabled:I,onClick:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){!I&&a&&a(e)})}),E?g:T?m:s?r()("span",{className:"icon"},void 0,s):y?r()("span",{className:Object(c.a)("icon ",y)}):null,r()("span",{className:"button__text-container"},void 0,i,n?r()("span",{className:"button__subtext"},void 0,n):null),R,T&&void 0!==A?r()("span",{className:"button__progress",style:{width:100*A+"%"}}):null)})},"/fpw":function(e,t,n){"use strict";var i=n("jPMi"),r=n("OL4R"),a=n("xjMu"),o=n("6xPH"),s=n("joy8"),u=n("fgaA"),l=a.a.extend({getModelOptionPath:function(){return"animation"},defaults:function(){var e=this.getResourceManager().getAnimationCollection(),t=[];return Object(o.a)()||(t=e.remove(e.where({isEnabled:!1}))),{animations:e,disabledAnimations:t,currentUID:"-1",playing:!0,fps:-1,progress:0}},getName:function(){return"Animation"},getResourceManager:function(){return this._resourceManager||s.default.instance},getAnimationByUID:function(e){return this.get("animations").find(function(t){return t.get("uid")===e})},getCurrentAnimation:function(){return this.getAnimationByUID(this.get("currentUID"))},canActivateTAA:function(){return!this.isPlaying()||Object(u.a)().taaAnimation},isPlaying:function(){return!!this.get("animations").length&&(!!this.get("playing")&&"-1"!==this.get("currentUID"))},getEnabledAnimationsCount:function(){return this.get("animations").where({isEnabled:!0}).length},getFirstEnabledAnimation:function(){for(var e=this.get("animations"),t=e.length,n=0;n<t;++n){var i=e.at(n);if(i&&i.get("isEnabled"))return i}},init:function(e){this._viewer=e.getViewer();var t=e.getModel().get("options").animation;t&&t.order&&(this.setJSON(t),this.set("playing",Object(u.a)().animationAutoplay))},setJSON:function(e,t){var n=t||{};n.ignore=["order"],a.a.prototype.setJSON.call(this,e,n);var i=this.get("animations"),o=Object(r.a)(e.order);i.forEach(function(e){e.set("order",parseInt(o[e.get("uid")],10))}),i.sort()},getJSON:function(){for(var e=a.a.prototype.getJSON.call(this),t=this.get("animations").pluck("uid"),n=this.get("disabledAnimations"),i=0;i<n.length;++i)t.push(n[i].get("uid"));return e.order=t,e}}),c=n("9oTK"),h=n.n(c),d=n("QLQS"),f=n("OZ7T"),p=function(e,t,n){for(var i=e.length/n,r=0;r<i;++r)for(var a=r*n,o=0;o<n;++o)t[a+o]=e[r+i*o];return t},g=function(e,t){for(var n=t||1,i=1,r=e.length/n;i<r;++i)for(var a=(i-1)*n,o=i*n,s=0;s<n;++s)e[o+s]+=e[a+s];return e},m=function(e){for(var t=1,n=e.length/4;t<n;++t){var i=4*(t-1),r=4*t,a=e[i],o=e[i+1],s=e[i+2],u=e[i+3],l=e[r],c=e[r+1],h=e[r+2],d=e[r+3];e[r]=a*d+o*h-s*c+u*l,e[r+1]=-a*h+o*d+s*l+u*c,e[r+2]=a*c-o*l+s*d+u*h,e[r+3]=-a*l-o*c-s*h+u*d}return e},v=n("LfNR"),_=n("9PC4"),b=n("CAIV"),S=d.a.osg,y=d.a.osgDB,x=d.a.osgAnimation,C=d.a.osgWrappers.osgAnimation,w=x.Channel,T=function(){},M=y.registry();M.registerObject("osgAnimation.Vec3LerpChannelCompressedPacked",T),M.registerObject("osgAnimation.Vec3LerpChannelCompressed",T),M.registerObject("osgAnimation.Vec3LerpChannelPacked",T),M.registerObject("osgAnimation.QuatSlerpChannelCompressedPacked",T),M.registerObject("osgAnimation.QuatSlerpChannelCompressed",T),M.registerObject("osgAnimation.QuatSlerpChannelPacked",T),M.registerObject("osgAnimation.FloatLerpChannelCompressedPacked",T),M.registerObject("osgAnimation.FloatLerpChannelCompressed",T),M.registerObject("osgAnimation.FloatLerpChannelPacked",T);var E={},A=(new s.default)._resourceLoader,O=1,R=4,P=8,I=16,N=function(e,t,n,i,r,a){var o,s=t.ItemSize,u=Object.keys(t.Array)[0],l=t.Array[u],c=l.Offset?l.Offset:0,h=l.Size,d=n.channel_mode||0,f=!!(1===a?d&I:d&R),y=new ArrayBuffer(4*(f?h+2:h+1)*a),x=new Float32Array(y,f?4*a:0,h*a);return o=l.Encoding&&"varint"===l.Encoding?Object(v.a)(new Uint8Array(e,c),s*h,u):new S[u](e,c,s*h),4===a&&d&P?(r&&(o=p(o,new Float32Array(o.length),s)),Object(b.a)(o,x,a,n.epsilon,n.nphi,!0),f&&((x=new Float32Array(y,0,(h+1)*a))[0]=n.ox,x[1]=n.oy,x[2]=n.oz,x[3]=n.ow,m(x)),x):(r&&1!==a?p(o,x,s):x.set(o),i?(3===a&&d&O&&Object(_.a)(x,x,[n.bx,n.by,n.bz],[n.hx,n.hy,n.hz],a),f&&(x=new Float32Array(y,0,(h+1)*a),3===a?(x[0]=n.ox,x[1]=n.oy,x[2]=n.oz):x[0]=n.ot,g(x,s)),x):x)},L=function(e,t,n,i,r,a){var o=e.getJSON();if(!(void 0!==o.TargetName&&o.KeyFrames&&o.Name&&o.KeyFrames.Time&&o.KeyFrames.Key))return h.a.reject(new Error);var s=o.UserDataContainer,u=s?f.a.convertUserDataToObject(e.setJSON(s).readUserDataContainer()):E;return A.getBinaryArray(e.getOptions().currentAnimationUID).getPromise().then(function(e){var s=N(e,o.KeyFrames.Time,u,i,!1,1),l=N(e,o.KeyFrames.Key,u,i,r,a);return n(l,s,o.TargetName,o.Name,t),t})};C.Vec3LerpChannel=function(e,t){return L(e,t,w.createVec3Channel,!1,!1,3)},C.Vec3LerpChannelCompressedPacked=function(e,t){return L(e,t,w.createVec3Channel,!0,!0,3)},C.Vec3LerpChannelCompressed=function(e,t){return L(e,t,w.createVec3Channel,!0,!1,3)},C.Vec3LerpChannelPacked=function(e,t){return L(e,t,w.createVec3Channel,!1,!0,3)},C.QuatSlerpChannel=function(e,t){return L(e,t,w.createQuatChannel,!1,!1,4)},C.QuatSlerpChannelCompressedPacked=function(e,t){return L(e,t,w.createQuatChannel,!0,!0,4)},C.QuatSlerpChannelCompressed=function(e,t){return L(e,t,w.createQuatChannel,!0,!1,4)},C.QuatSlerpChannelPacked=function(e,t){return L(e,t,w.createQuatChannel,!1,!0,4)},C.FloatLerpChannel=function(e,t){return L(e,t,w.createFloatChannel,!1,!1,1)},C.FloatLerpChannelCompressedPacked=function(e,t){return L(e,t,w.createFloatChannel,!0,!0,1)},C.FloatLerpChannelCompressed=function(e,t){return L(e,t,w.createFloatChannel,!0,!1,1)},C.FloatLerpChannelPacked=function(e,t){return L(e,t,w.createFloatChannel,!1,!0,1)};var k=n("UpON"),D=n("vBtE"),F=n("9D1Z"),V=n("par7"),B=d.a.osg,U=d.a.osgAnimation,j=d.a.osgWrappers,G=j.osg,H={FeatureName:"animation",ModelType:l,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments);var e=this.model;e.bind("change:playing",this.onPlayingChanged,this),e.bind("change:speed",this.onSpeedChanged,this),e.bind("change:currentUID",this.onCurrentAnimationChanged,this),e.bind("afterFirstVisibleFrame",this.onAfterFirstVisibleFrame,this),e.bind("seek",this.onSeek,this),this._manager=null,this._idLoop=0,this._loopEnded=!1,this._skeletons=[],this._viewer=this.options.context.getViewer(),this._firstAnimationPlayed=!1,this._animationPromises=[],this._hookBasicAnimationManager(k.a.getPolygon()),k.a.getMaterial().then(this._initAnimation.bind(this)),k.a.getModelDisplayed().then(this._resolveAllAnimations.bind(this))},onAfterFirstVisibleFrame:function(){this._manager&&(this.model.set("playing",Object(u.a)().animationAutoplay),this.onCurrentAnimationChanged())},_resolveAllAnimations:function(){0===this._animationPromises.length?(k.a.resolveFirstAnimation(),k.a.resolveAllAnimations()):h.a.all(this._animationPromises).then(k.a.resolveAllAnimations.bind(k.a))},_initAnimation:function(){if(!this._manager)return f.a.hasRigsOrMorphs&&F.a.init(this._skeletons,this._viewer),void k.a.getWireframeOptimized().then(k.a.resolveWireframeOptimizedSplit.bind(k.a));this.onSpeedChanged(),F.a.init(this._skeletons,this._viewer),k.a.getWireframeOptimized().then(k.a.resolveWireframeOptimizedSplit.bind(k.a))},_getHookUpdateManager:function(){var e=this,t=U.BasicAnimationManager.prototype.updateManager;return function(n){var i=e.getCurrentInstanceAnimation();return!(i&&!e._loopEnded)||(-1===this._seekTime&&this._pause||V.a.draw(),n=e._detectAnimationEnd(n,i),n=e._snapTimeOnFrame(n,i),t.call(this,n))}},_snapTimeOnFrame:function(e,t){var n=this.model.get("fps");if(n<=0)return e;var i=1/n,r=(e-t.start)%i;return r>.5*i?e+i-r:e-r},_detectAnimationEnd:function(e,t){var n=Math.max(0,e-t.start),i=n%t.duration*100/t.duration,r=Math.floor(n/t.duration);return r<=this._idLoop?(this._idLoop=r,this.model.set("progress",i),e):(this._viewer.trigger("animationEnded"),this._onAnimationEnd(),t=this.getCurrentInstanceAnimation(),this._loopEnded?(e=t.duration-.01,this.model.set("progress",100)):(this._idLoop=r,e=t.start,this.model.set("progress",0)),e)},_onAnimationEnd:function(){var e=this.model.get("cycleMode");if("oneAndStop"===e)return this.model.set("playing",!1),void(this._loopEnded=!0);if("one"!==e){for(var t,n=this.model.get("animations"),i="-1",r=n.indexOf(this.getCurrentAnimation())+1,a=n.length;r<a;++r)if((t=n.at(r))&&t.get("isEnabled")){i=t.get("uid");break}if("-1"===i&&"all"===e){var o=this.model.getFirstEnabledAnimation();i=o?o.get("uid"):"-1"}"-1"!==i?this.model.set("currentUID",i):(this.model.set("playing",!1),this._loopEnded=!0)}else this.model.trigger("cycleMode")},_debugSnapKeyFrameHook:function(){Object(u.a)().snapKeyframe&&(U.BasicAnimationManager.prototype._updateChannelsType=function(e,t,n){for(var i=0,r=t.length;i<r;i++){var a=t[i],o=a.instanceAnimation,s=o.loop,u=e-a.t;s&&o.duration>0&&(u%=o.duration),u+=o.firstKeyTime;var l=a.channel;if(u>l.start&&u<l.end){var c=l.times,h=a.key;if(u>c[h])for(;c[h+1]<u;)h++;else if(u<c[h])for(;c[h]>u;)h--;var d=c[h],f=c[h+1];u=Math.abs(u-d)<Math.abs(u-f)?d:f}n(u,a)}})},_hookBasicAnimationManager:function(e){var t=this,n=this._animationPromises,i=this._getHookUpdateManager();this._debugSnapKeyFrameHook(),j.osgAnimation.BasicAnimationManager=function(r,a){var o=r.getJSON();return o.Animations?(G.Object(r,a),k.a.OSG_VERSION<8?h.a.resolve(a):t._manager?(B.error("More than one basicAnimationManager !"),h.a.resolve(a)):(t._manager=a,t.model.get("playing")||a.togglePause(),a.updateManager=i,e.then(function(){var e=r.getOptions();e.progress=void 0;for(var i=o.Animations.length,a=0;a<i;++a){var s=o.Animations[a],u=r.setJSON(s["osgAnimation.Animation"].UserDataContainer).readUserDataContainer(),l=f.a.convertUserDataToObject(u),c=t.model.getAnimationByUID(l.AnimationUID);if(c){e.currentAnimationUID=c.get("url");var h=r.setJSON(s).readObject();h.isRejected()?B.Notify.warn("An Animation failed on the parsing!"):(h.then(t.onAddAnimation.bind(t,a,l)),n.push(h))}}}),h.a.resolve(a))):h.a.reject(new Error)}},onAddAnimation:function(e,t,n){var i=t.AnimationUID;n.name=i,n.duration||(n.duration=2.5,n.still=!0),this._manager.addAnimations([n]),0===n.duration&&(this._manager.getAnimations()[i].duration=2.5);var r=this.model;r.trigger("change:animations");var a=r.getAnimationByUID(i);a.on("change:isLoop",this.onAnimationChangeLoop.bind(this)),a.get("isLoop")&&this.onAnimationChangeLoop(a),this.model.get("currentUID")===i&&this.onCurrentAnimationChanged(),this._firstAnimationPlayed||(this._playFirstAnimation(i)&&(this._firstAnimationPlayed=!0,this.model.set("currentUID",i)),k.a.getModelDisplayed().then(k.a.resolveFirstAnimation.bind(k.a)))},_playFirstAnimation:function(e){if(this.model.get("initializeWithRestPose"))return!1;var t=this.model.getFirstEnabledAnimation();return t&&e===t.get("uid")},onAnimationChangeLoop:function(e){var t=this._manager.getAnimations()[e.get("uid")];this._manager.setAnimationLerpEndStart(t,e.get("isLoop")?1/30:0)},onCurrentAnimationChanged:function(){this._loopEnded=!1,this._idLoop=0;var e=this._manager;if(e.stopAllAnimation(),e.resetUpdateCallbacks(),this.getCurrentAnimation()){var t=this.getCurrentInstanceAnimation();t&&(e.playAnimation(t),e.setSeekTime(t.start))}var n=this.getCurrentAnimation();n?(this._viewer.trigger("animationChange",n.get("uid")),Object(o.a)()&&this.model.set("initializeWithRestPose",!1)):Object(o.a)()&&this.model.set("initializeWithRestPose",!0),V.a.draw()},getCurrentAnimation:function(){return this.model.getCurrentAnimation()},getCurrentInstanceAnimation:function(){var e=this.getCurrentAnimation();return e?this._manager.getAnimations()[e.get("uid")]:void 0},onPlayingChanged:function(){if(this._loopEnded){this._loopEnded=!1;var e=this.model.getFirstEnabledAnimation().get("uid")||"-1";e===this.getCurrentAnimation().get("uid")?this.model.trigger("seek",0):this.model.set("currentUID",e)}this._viewer.trigger(this.model.get("playing")?"animationPlay":"animationStop"),this._manager.togglePause(),V.a.draw()},onSeek:function(e){var t=this.getCurrentInstanceAnimation();if(t){this._loopEnded=!1;var n=Math.min(t.duration-.01,t.duration*e/100);this._manager.setSeekTime(t.start+n/this._manager.getTimeFactor()),V.a.draw(),V.a.redrawShadow()}},onSpeedChanged:function(){this._manager.setTimeFactor(this.model.get("speed"))}})]},z=!1;k.a.getHasAnimation().then(function(e){e&&(z=e)});var W=i.a.create(H);W.prototype.prepareForScreenShot=function(){return!!z&&(this._oldPlayingAnimation=this.getModel().get("playing"),this.getModel().set("playing",!1),!0)},W.prototype.resetAfterScreenShot=function(){this._oldPlayingAnimation&&this.getModel().set("playing",!0)};var q=W,X=n("JQdh"),Y=n("oaNE"),K=d.a.osg,Q=Math.PI/2,J=a.a.extend({getModelOptionPath:function(){return"camera"},defaults:{webVR:!1,indexManipulator:"fps"===Object(u.a)().navigation?1:0,node:void 0,minSpeed:.1,displayGizmo:!1,animationEye:K.vec3.create(),animationTarget:K.vec3.create(),animationDuration:1,enableCameraConstraints:!0,offset:0,angle:2*Math.PI},getName:function(){return"Camera"},setTargetAndEye:function(e,t,n){return this.set("animationTarget",e),this.set("animationEye",t),this.trigger("setTargetAndEye",n)},init:function(e){this._viewer=e.getViewer();var t=e.getModel().get("options").camera;this.set("enableCameraConstraints",Object(u.a)().cameraConstraints);var n=this._getUrlOptions(),i=Object(Y.a)(t,n);this.setJSON(i),this.yawLeftRightToAngleOffset(),this.on("change:zoomIn",this.checkOverLap.bind(this,"zoomOut","zoomIn","zoomOut")),this.on("change:zoomOut",this.checkOverLap.bind(this,"zoomOut","zoomIn","zoomIn")),this.on("change:up",this.checkOverLap.bind(this,"up","down","down")),this.on("change:down",this.checkOverLap.bind(this,"up","down","up")),this.on("change:offset",this.yawAngleOffsetToLeftRight.bind(this)),this.on("change:angle",this.yawAngleOffsetToLeftRight.bind(this))},shouldPlayFirstCameraAnimation:function(){return!0===Object(u.a)().camera&&!this.get("useCameraConstraints")},initAfterFirstFrame:function(){var e=Math.floor(X.a.getModelBoxWithoutDisplacement().radius()*(180-this.get("fov")));-1===this.get("zoomOut")&&this.set("zoomOut",e),-1===this.get("zoomIn")&&this.set("zoomIn",e),this.set("maxZoom",e),this.trigger("uiReady")},_getUrlOptions:function(){var e={usePanConstraints:Object(u.a)().orbitConstraintPan,zoomIn:Object(u.a)().orbitConstraintZoomIn,zoomOut:Object(u.a)().orbitConstraintZoomOut,left:Object(u.a)().orbitConstraintYawLeft,right:Object(u.a)().orbitConstraintYawRight,up:Object(u.a)().orbitConstraintPitchUp,down:Object(u.a)().orbitConstraintPitchDown};return e.useZoomConstraints=void 0!==e.zoomOut||void 0!==e.zoomIn||void 0,e.useYawConstraints=void 0!==e.left||void 0!==e.right||void 0,e.usePitchConstraints=void 0!==e.up||void 0!==e.down||void 0,e.useCameraConstraints=e.useZoomConstraints||e.useYawConstraints||e.usePitchConstraints||e.usePanConstraints,e},getCameraPosition:function(e,t){var n=this._viewer.getFeaturesManager();if(n&&(n.getCameraWithoutAutospin(e,t),0!==this.get("indexManipulator")&&this.get("node"))){var i=this.get("node").getMinimumBound(),r=K.vec3.dist(e,i.center()),a=Math.max(.1*i.radius(),r);K.vec3.sub(t,t,e),K.vec3.normalize(t,t),K.vec3.scale(t,t,a),K.vec3.add(t,e,t)}},saveCameraPosition:function(){!this.get("useCameraConstraints")||this.get("enableCameraConstraints")?this.getCameraPosition(this.get("position"),this.get("target")):this.getCameraPosition(this.get("position"),K.vec3.create())},validateEyeTarget:function(e,t){var n=K.vec3.dist(e,t);if(n<=1e-8)return!1;var i=this.get("node").getMinimumBound().radius();return n<=.001*i&&(K.vec3.sub(t,t,e),K.vec3.scale(t,t,.01*i/n),K.vec3.add(t,e,t)),!0},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){var t=this.setJSON(e,{validate:!0});return t||h.a.resolve(!0)},range:function(e){return"["+e.min+", "+e.max+"]"},limits:function(){return{zoomIn:{min:0,max:this.get("maxZoom")},zoomOut:{min:0,max:this.get("maxZoom")},offset:{min:0,max:2*Math.PI},angle:{min:0,max:2*Math.PI},up:{min:-Q,max:Q},down:{min:-Q,max:Q},fov:{min:1,max:179},nearFarRatio:{min:1e-4,max:.005}}},yawAngleOffsetToLeftRight:function(){var e=this.get("offset"),t=this.get("angle"),n=e-t/2,i=0;t===2*Math.PI&&(i=-.001);var r=e+t/2+i;n>=Math.PI&&(n-=2*Math.PI),r>=Math.PI&&(r-=2*Math.PI),this.set("left",n),this.set("right",r)},yawLeftRightToAngleOffset:function(){var e=this._getYawValue(this.get("left")),t=this._getYawValue(this.get("right")),n=this.computeAngleOffset(e,t);this.set("angle",n[0]),this.set("offset",n[1])},_getYawValue:function(e){return e<=-3.14?-Math.PI:e>=3.14?Math.PI:e},computeAngleOffset:function(e,t){var n=t-e;n<0&&(n+=2*Math.PI);var i=e+n/2;return i<0&&(i+=2*Math.PI),[n,i]},checkOverLap:function(e,t,n){var i=this.get(e),r=this.get(t);r>i&&this.set(n,n===e?r:i)}}),Z=d.a.osg,$=d.a.osgGA,ee=function(e){$.FirstPersonManipulator.call(this,e);var t=Math.max(0,Math.min(4,Object(u.a)().fpsSpeed/25));this._stepFactor=t,this.getControllerList().StandardMouseKeyboard._stepFactor=t,this._postMultRotate=Z.quat.create(),this._resetInitialVR=!1,this._lookPosition._delay=.25};Z.createPrototypeObject(ee,Z.objectInherit($.FirstPersonManipulator.prototype,{getPostMultRotate:function(){return this._postMultRotate},setResetInitialRotationVR:function(e){this._resetInitialVR=e,e||Z.quat.identity(this._postMultRotate)},setNode:function(e){$.FirstPersonManipulator.prototype.setNode.call(this,e);var t=this.getHomeBoundingSphere();t&&t.valid()&&(this._distance=this.getHomeDistance(t))},setInitialPoseVR:function(){var e=Z.quat.create(),t=Z.mat4.create(),n=Z.vec3.fromValues(0,0,1);return function(i,r){Z.mat4.lookAt(t,i,r,n),Z.mat4.invert(t,t),Z.mat4.getRotation(e,t),e[1]=e[0]=0,Z.quat.normalize(e,e),Z.quat.copy(this._postMultRotate,e),this.setEyePosition(i),this.setTarget(r),this.setResetInitialRotationVR(!0)}}(),setPoseVR:function(){var e=Z.vec3.create();return function(t,n){this._resetInitialVR&&(Z.quat.invert(this._vrRot,t),this._vrRot[0]=this._vrRot[1]=0,Z.quat.normalize(this._vrRot,this._vrRot),Z.quat.multiply(this._postMultRotate,this._vrRot,this._postMultRotate)),Z.quat.multiply(this._vrRot,this._postMultRotate,t),Z.vec3.transformQuat(e,n,this._postMultRotate),this._resetInitialVR?(Z.vec3.set(this._vrTrans,0,0,0),this._resetInitialVR=!1):Z.vec3.sub(this._vrTrans,e,this._vrPos),Z.vec3.copy(this._vrPos,e),this._vrEnable=!0}}()}),"osgSketchfab","FirstPersonManipulator");var te=ee,ne=.5*Math.PI*.99,ie=d.a.osg,re=d.a.osgGA,ae=function(e){re.OrbitManipulator.call(this,e),this.setLimitPitchUp(ne),this.setLimitPitchDown(-ne),this._enableRecenter=!0,this._zoomEMA=0,this._pitchEMA=0,this._yawEMA=0,this._panVEMA=0,this._panHEMA=0,this._constrainPan=!1,this._constrainedTarget=ie.vec3.create()};ie.createPrototypeObject(ae,ie.objectInherit(re.OrbitManipulator.prototype,{setEyePosition:function(){var e=ie.vec3.create(),t=ie.vec3.create(),n=ie.vec3.create();return function(i,r){var a=this._rotation,o=this._target;if(ie.vec3.sub(e,i,o),ie.vec3.normalize(e,e),r){var s=ie.vec3.dot(e,this._upz);if(Math.abs(s)>.99){var u=Math.sqrt((1-.9801)/(e[0]*e[0]+e[1]*e[1]));e[0]*=u,e[1]*=u,e[2]=.99*Math.sign(s)}}ie.vec3.cross(t,e,this._upz),ie.vec3.normalize(t,t),ie.vec3.cross(n,t,e),ie.vec3.normalize(n,n),a[0]=t[0],a[1]=e[0],a[2]=n[0],a[3]=0,a[4]=t[1],a[5]=e[1],a[6]=n[1],a[7]=0,a[8]=t[2],a[9]=e[2],a[10]=n[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this._distance=ie.vec3.dist(o,i)}}(),enableRecenter:function(e){this._enableRecenter=e},computeHomePosition:function(e){this._enableRecenter&&re.OrbitManipulator.prototype.computeHomePosition.call(this,e)},_computeEMA:function(e,t){return 0===t?e:.2*e+.8*t},_getLimitReached:function(e,t,n){return Math.abs(e-n)<.001?n:Math.abs(e-t)<.001?t:void 0},computeZoom:function(e){if(re.OrbitManipulator.prototype.computeZoom.call(this,e),this._constrainZoom){var t=1;(e-=1)<0&&(e=-e,t=-1);var n=this.getSpeedFactor()*e,i=this._getLimitReached(this.getDistance(),this._limitZoomIn,this._limitZoomOut);void 0!==i&&(void 0===this._prevDistance&&(this._prevDistance=i),n=n/(1+n)*(.1*this.getDistance()),this._zoomEMA=this._computeEMA(n,this._zoomEMA),t<0&&this._prevDistance>i||t>0&&this._prevDistance<i?this._distance=this._prevDistance+this.getSpeedFactor()*e*t:this._distance=i+this._zoomEMA*t),this._prevDistance=this._distance}},_computePitch:function(e,t){var n;if(e=void 0!==this._previousPitch?this._previousPitch:e,n=re.OrbitManipulator.prototype._computePitch.call(this,e,t),!this._constrainPitch||0===t)return this._previousPitch=void 0,n;this._previousPitch=n;var i=t/10;i=i/(1+i)*.5;var r=this._getLimitReached(n,this._limitPitchUp,this._limitPitchDown);return void 0!==r&&(this._pitchEMA=this._computeEMA(i,this._pitchEMA),n=r+this._pitchEMA),Math.max(Math.min(n,ne),-ne)},_computeYaw:function(e,t){var n;if(e=void 0!==this._previousYaw?this._previousYaw:e,n=re.OrbitManipulator.prototype._computeYaw.call(this,e,t),!this._constrainYaw||0===t)return this._previousYaw=void 0,n;this._previousYaw=n;var i=t/10;i=i/(1+i)*3;var r=this._getLimitReached(n,this._limitYawLeft,this._limitYawRight);return void 0!==r&&(this._yawEMA=this._computeEMA(i,this._yawEMA),n=r+this._yawEMA),n},computePan:function(e,t){!this._constrainPan||0===e&&0===t||(this._panVEMA=this._computeEMA(e/(1+e)*.5,this._panVEMA),this._panHEMA=this._computeEMA(t/(1+t)*.5,this._panHEMA),e=this._panVEMA,t=this._panHEMA,ie.vec3.copy(this._target,this._constrainedTarget)),re.OrbitManipulator.prototype.computePan.call(this,e,t)},setConstrainPan:function(e){this._constrainPan=e},isConstrainPan:function(){return this._constrainPan},setPanConstraintTarget:function(e){ie.vec3.copy(this._constrainedTarget,e)}}),"osgSketchfab","OrbitManipulator");var oe,se=ae,ue=d.a.osg,le=d.a.osgGA,ce=d.a.osgUtil.DelayInterpolator.prototype,he=ce.set;ce.set=function(){he.apply(this,arguments),this._epsilon>=0&&!this.isDone()&&oe(!0)};var de=ce.setTarget;ce.setTarget=function(){de.apply(this,arguments),this._epsilon>=0&&!this.isDone()&&oe(!0)};var fe=ce.addTarget;ce.addTarget=function(){fe.apply(this,arguments),this._epsilon>=0&&!this.isDone()&&oe(!0)},ce.isDone=function(e){e=e||1;for(var t=Math.abs(this._epsilon),n=0,i=this._current.length;n<i;++n)if(Math.abs(this._target[n]-this._current[n])>t*e)return!1;return!0};var pe=ce.update;ce.update=function(e){var t=pe.call(this,e);if(this._epsilon>=0)if(this.isDone())for(var n=0,i=this._current.length;n<i;++n)this._current[n]=this._target[n];else oe(),this.isDone(100)?V.a.draw():V.a.drawNoJitter();return t};var ge=function(e){e.isDone=function(){for(var e=Math.abs(this._epsilon),t=0,n=this._current.length;t<n;++t)if(1===Math.abs(this._target[t])||Math.abs(this._target[t]-this._current[t])>e)return!1;return!0}.bind(e)},me=function(e,t){oe=t,le.SwitchManipulator.call(this),this._boundStrategy=le.Manipulator.COMPUTE_HOME_USING_SPHERE|le.Manipulator.COMPUTE_HOME_USING_BBOX,this._inputManager=e,this.init()};ue.createPrototypeObject(me,ue.objectInherit(le.SwitchManipulator.prototype,{init:function(){le.SwitchManipulator.prototype.setManipulatorIndex.call(this,0);var e=new se({boundStrategy:this._boundStrategy,inputManager:this._inputManager});e.getRotateInterpolator()._epsilon=.1,e.getPanInterpolator()._epsilon=.1,e.getZoomInterpolator()._epsilon=.001,e.setZoomFactor(Object(u.a)().orbitZoomFactor),e.setRotationFactor(Object(u.a)().orbitRotationFactor),e.setPanFactor(Object(u.a)().orbitPanFactor),e.getPanInterpolator()._isOrbitPan=!0;var t=new te({boundStrategy:this._boundStrategy,inputManager:this._inputManager});t.getLookPositionInterpolator()._epsilon=.1,t.getSideInterpolator()._epsilon=.001,ge(t.getSideInterpolator()),t.getForwardInterpolator()._epsilon=.001,ge(t.getForwardInterpolator()),t.getPanInterpolator()._epsilon=.001,ge(t.getPanInterpolator()),t.getZoomInterpolator()._epsilon=.001,ge(t.getZoomInterpolator()),this.addManipulator(e,"ORBIT"),this.addManipulator(t,"FPS"),void 0!==Object(u.a)().cameraEasing&&this.setDelay(1-Object(u.a)().cameraEasing)},getOrbitManipulator:function(){return this._manipulatorList[me.ORBIT]},getFirstPersonManipulator:function(){return this._manipulatorList[me.FPS]},_setManipulatorDelay:function(e,t){e.setDelay(t);var n=e._controllerList;for(var i in n){var r=n[i];void 0!==r._delay&&(r._delay=t)}},setDelay:function(e){this._setManipulatorDelay(this._manipulatorList[me.ORBIT],e),this._setManipulatorDelay(this._manipulatorList[me.FPS],e)},addManipulator:function(e,t){le.SwitchManipulator.prototype.addManipulator.call(this,e),t&&(me[t]=this.getManipulatorList().length-1)},setManipulatorIndex:function(){var e=ue.vec3.create(),t=ue.vec3.create();return function(n){if(n!==this.getCurrentManipulatorIndex()){var i=this.getCurrentManipulator();le.SwitchManipulator.prototype.setManipulatorIndex.call(this,n),this.setTargetAndEye(i.getTarget(e),i.getEyePosition(t))}}}(),setTargetAndEye:function(e,t){var n=this.getCurrentManipulator();this.getCurrentManipulatorIndex()===me.ORBIT?(e&&n.setTarget(e),t&&n.setEyePosition(t)):(t&&n.setEyePosition(t),e&&n.setTarget(e)),oe(!0)},setEyePosition:function(e,t){this.getCurrentManipulator().setEyePosition(e,t),oe(!0)},getEyePosition:function(e){return this.getCurrentManipulator().getEyePosition(e)},setTarget:function(e){this.getCurrentManipulator().setTarget(e),oe(!0)},getTarget:function(e){return this.getCurrentManipulator().getTarget(e)},setDistance:function(e){this.getCurrentManipulatorIndex()===me.ORBIT&&(this.getCurrentManipulator().setDistance(e),oe(!0))},getDistance:function(){return this.getCurrentManipulator().getDistance()},computeHomePosition:function(e){le.SwitchManipulator.prototype.computeHomePosition.call(this,e),oe(!0)}}),"osgSketchfab","SwitchManipulator");var ve=me,_e=n("AhqU"),be=n("3rl3"),Se=n("Hi2/"),ye={iconCamCenter:n("l8+D"),iconZoomHint:n("99M6"),iconsLight:{DIRECTION:n("xPCe"),SPOT:n("1kUg"),POINT:n("cAcU"),HEMI:n("u4Ci")},iconSound:n("r5U0"),iconHotspot:n("Ru/i")},xe=n("kUJ5"),Ce=n("Auie"),we=n("PnIl"),Te=n("T1IQ"),Me=n("3CjY"),Ee=n.n(Me),Ae=n("IJ4l"),Oe=n.n(Ae),Re=d.a.osg,Pe=d.a.osgUtil,Ie=d.a.InputGroups,Ne=Re.vec4.fromValues(.309375,.8640625,1,1),Le=Re.vec4.fromValues(1,1,0,1),ke=Re.vec3.fromValues(-1,0,0),De=Re.vec3.fromValues(.05,.05,.05),Fe=2*Math.PI,Ve=we.a.BLEND_SUBSTRACTIVE,Be=we.a.DEPTH_DISABLE,Ue=Re.StateAttribute.ON,je=function(e,t){return(e%t+t)%t},Ge=function(e,t){Re.MatrixTransform.call(this),this.setName("Camera - Constraints Gizmo"),this._manipulator=e,this._model=t,this._defaults=this._model.getInstance();var n=this._model.computeAngleOffset(this._defaults.left,this._defaults.right);this._defaults.angle=n[0],this._defaults.offset=n[1],this._circleGeom=Pe.GizmoGeometry.createCircleGeometry(128,1,2.015*Math.PI),this._arcGeom=Pe.GizmoGeometry.createCircleGeometry(64,1,1.015*Math.PI),this._pivotNode=new Re.MatrixTransform,this._arcNode=new Re.MatrixTransform,this._circleNode=new Re.MatrixTransform,this._circleNode.setName("Camera - Constraints Gizmo - circleNode"),this._pivotNode.addChild(this._arcNode),this._pivotNode.addChild(this._circleNode),this._arcCenter=this._makeArc(this._arcGeom),this._arcLeft=this._makeArc(this._arcGeom,-Math.PI),this._arcRight=this._makeArc(this._arcGeom,Math.PI),this._arcHalfLeft=this._makeArc(this._arcGeom,.5*-Math.PI),this._arcHalfRight=this._makeArc(this._arcGeom,.5*Math.PI),this._circleCenter=this._makeCircle(),this._circleUp=this._makeCircle(),this._circleDown=this._makeCircle(),this._pivotNode.editMask=Pe.NodeGizmo.PICK_ARROW|Pe.NodeGizmo.PICK_PLANE,this.addChild(this._pivotNode),this.setGizmoStateset(Ne),this._makeCenter(),this._geomHandle=new Re.createTexturedBoxGeometry(0,0,0,.02,.02,.02),this._handleCenter=this._makeHandle("handleCenter"),this._handleUp=this._makeHandle("handleUp"),this._handleDown=this._makeHandle("handleDown"),this._handleLeft=this._makeHandle("handleLeft"),this._handleRight=this._makeHandle("handleRight"),this._startCoord=Re.vec2.create(),Te.a.initCamera(this),this.setVisible(!1)};Ge.prototype=Re.objectInherit(Re.MatrixTransform.prototype,{_makeArc:function(e,t){var n=new Re.MatrixTransform,i=new Re.MatrixTransform;return i.addChild(e),Re.mat4.fromRotation(i.getMatrix(),.5*-Math.PI,Re.vec3.fromValues(0,1,0)),t&&Re.mat4.fromZRotation(n.getMatrix(),t),n.addChild(i),this._arcNode.addChild(n),n},_makeCircle:function(){var e=new Re.MatrixTransform;return this._circleNode.addChild(e),e.addChild(this._circleGeom),e},_makeCenter:function(){this._centerNode=new Re.MatrixTransform,this._pivotNode.addChild(this._centerNode);var e=this._centerNode.getOrCreateStateSet(),t=be.a.getOrCreateShader(Ee.a,Oe.a,"icon","CamConstraintsIcon","ICON");e.setAttributeAndModes(t),this._centerIcon=this._addIcon(this._centerNode,ye.iconCamCenter,"center")},_makeHandle:function(e){var t=new Re.MatrixTransform;t.setName(e),t.setNodeMask(-1),t.addChild(this._geomHandle),Re.mat4.fromTranslation(t.getMatrix(),ke);var n=t.getOrCreateStateSet();return this._setupColorAndAlpha(Ne,1,n),n.addUniform(Re.Uniform.createFloat(1,"uUp")),n.addUniform(Re.Uniform.createFloat(-1,"uDown")),this._circleNode.addChild(t),t},_getIconGeom:function(){return this._quadGeom||(this._quadGeom=Re.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),this._quadGeom.setNodeMask(-1),this._quadGeom.setName("iconGeom")),this._quadGeom},_addIcon:function(e,t,n){var i=new Re.MatrixTransform;i.addChild(this._getIconGeom()),i.setName(n+"Icon"),e.addChild(i);var r=s.default.instance.getOrCreateTexture(t,{internalFormat:Re.Texture.RGBA}),a=i.getOrCreateStateSet();return a.setTextureAttributeAndModes(0,r.texture,Ue),a.addUniform(Re.Uniform.createInt(0,"uTextureIcon")),this._setupColorAndAlpha(Ne,1,a),i},_getGizmo:function(){var e=this._model._viewer.getFeaturesManager();return e?e.getNodeGizmo():null},setPivotSelected:function(e){this._getGizmo().attachToNode(e?this._centerNode:void 0)},setGizmoStateset:function(e){this._circleGeom.getOrCreateStateSet().removeAttribute("Program"),this._arcGeom.getOrCreateStateSet().removeAttribute("Program");var t=this._pivotNode.getOrCreateStateSet();t.setRenderBinDetails(Se.a.EDITOR_GIZMO,"RenderBin"),t.setAttributeAndModes(be.a.getOrCreateShader(Ee.a,Oe.a,"gizmo","CamConstraintsGizmo"),Ue),t.setAttributeAndModes(Ve,Ue),t.setAttributeAndModes(Be,Ue),this._setupColorAndAlpha(e,.4,t),this._setupColorAndAlpha(e,1,this._circleDown.getOrCreateStateSet()),this._setupColorAndAlpha(e,1,this._circleUp.getOrCreateStateSet()),this._setupColorAndAlpha(e,1,this._arcLeft.getOrCreateStateSet()),this._setupColorAndAlpha(e,1,this._arcRight.getOrCreateStateSet());var n=this._arcNode.getOrCreateStateSet();this._uUp=Re.Uniform.createFloat(1,"uUp"),n.addUniform(this._uUp),this._uDown=Re.Uniform.createFloat(-1,"uDown"),n.addUniform(this._uDown);var i=this._circleNode.getOrCreateStateSet();this._uHUp=Re.Uniform.createFloat(1,"uUp"),i.addUniform(this._uHUp),i.addUniform(Re.Uniform.createFloat(-1,"uDown"))},_setupColorAndAlpha:function(e,t,n){n.addUniform(Re.Uniform.createFloat4(e,"uColor")),n.addUniform(Re.Uniform.createFloat(t,"uAlpha"))},setVisible:function(e){this.setNodeMask(e?_e.a.NO_SHADOW:0),e?this._manipulator.getInputManager().setEnable(Ie.CAMERA_GIZMO,!0):this._manipulator.getInputManager().setEnable(Ie.CAMERA_GIZMO,!1)},motion:function(){var e=Re.vec2.create();return function(t){if(Re.vec2.set(e,t.canvasX,t.canvasY),this._dragging)this._onDrag(e);else if(Ce.a.isInitialized()){var n=Ce.a.computeNearestIntersection2D(e[0],e[1],_e.a.PICK,this);if(n){var i=n._nodePath.length,r=n._nodePath[i-1];if(r===this._getIconGeom()||r===this._geomHandle){var a=n._nodePath[i-2];this._onHover(a)}}else this._onHover()}}}(),_onDrag:function(){var e=Re.vec3.create(),t=Re.vec3.create();return function(n){var i=this._model._viewer.getCanvas().height,r=this._model.get("usePitchConstraints"),a=this._model.get("useYawConstraints");if(r){var o=(this._startCoord[1]-n[1])/i*2;if(this._dragging===this._handleUp)return void this._model.set("up",Math.asin(Re.clamp(this._startModel.up+o,-1,1)));if(this._dragging===this._handleDown)return void this._model.set("down",Math.asin(Re.clamp(this._startModel.down+o,-1,1)))}if(a){this._getDragPosition(t,n),Re.vec3.sub(e,t,this._model.get("target")),Re.vec3.normalize(e,e);var s=this._startModel.a1,u=Math.atan2(e[0],e[1]),l=Math.sign(Re.vec3.cross(e,this._startModel.baseDir,e)[2]),c=0,h=this._model.get("angle");if(this._dragging===this._handleLeft)return c=this._clampAngle(2*(u-s),-l,h),void this._model.set("angle",c);if(u>0&&(u-=Fe),this._dragging===this._handleRight)return c=this._clampAngle(2*(s-u),l,h),void this._model.set("angle",c);this._dragging===this._handleCenter&&this._model.set("offset",je(this._startModel.offset+(s-u),Fe))}}}(),_getDragPosition:function(){var e=Re.vec3.create(),t=Re.vec3.create(),n=Re.vec3.create(),i=Re.vec3.create(),r=Re.vec3.create(),a=Re.vec3.create();return function(o,s){xe.a.canvasCoordToGL(s[0],s[1],i),i[2]=0,Ce.a.getWorldPositionFromScreenPoint(i,e),i[2]=1,Ce.a.getWorldPositionFromScreenPoint(i,t),Re.vec3.sub(a,t,e),Re.vec3.normalize(a,a),Re.vec3.set(r,0,0,1);var u=-this._startModel.startPosition[2],l=Re.vec3.dot(r,a);if(Math.abs(l)<.05){var c=this._startModel.startPosition;Re.vec3.sub(r,c,this._model.get("target")),r[2]=0,Re.vec3.normalize(r,r),Re.vec3.set(n,c[0],c[1],0),n[2]=0,u=-Re.vec3.dot(r,n),l=Re.vec3.dot(r,a)}var h=-(Re.vec3.dot(r,e)+u)/l;return Re.vec3.scaleAndAdd(o,e,a,h),o}}(),_clampAngle:function(e,t,n){return e=je(e,Fe),t<0?n<Fe-n?0:Fe:e},startDrag:function(){var e=Re.vec3.create(),t=Re.vec3.create(),n=Re.mat4.create();return function(i){this._hovered&&this._hovered!==this._centerNode&&(this._dragging=this._hovered,Re.vec2.set(this._startCoord,i.canvasX,i.canvasY),this._handleCenter.getWorldMatrix(this,n),Re.mat4.getTranslation(e,n),Re.vec3.sub(t,e,this._model.get("target")),Re.vec3.normalize(t,t),this._dragging.getWorldMatrix(this,n),Re.mat4.getTranslation(e,n),this._startModel={up:Math.sin(this._model.get("up")),down:Math.sin(this._model.get("down")),offset:this._model.get("offset"),angle:this._model.get("angle"),startPosition:e,baseDir:t,a1:Math.atan2(t[0],t[1])},this._manipulator.getInputManager().setEnable(Ie.MANIPULATORS,!1),this._savedEnableState=this._model.get("enableCameraConstraints"),this._model.set("enableCameraConstraints",!1))}}(),endDrag:function(e){this._dragging&&(this._manipulator.getInputManager().setEnable(Ie.MANIPULATORS,!0),this._dragging=void 0,this.motion(e),this._model.set("enableCameraConstraints",this._savedEnableState))},_onHover:function(e){if(e!==this._hovered)if(this._hovered&&(this._changeColor(this._hovered.getStateSet(),Ne),this._changeColor(this._circleUp.getStateSet(),Ne),this._changeColor(this._arcLeft.getStateSet(),Ne),this._changeColor(this._arcRight.getStateSet(),Ne),this._changeColor(this._circleDown.getStateSet(),Ne),V.a.draw()),e){switch(this._hovered=e,this._changeColor(e.getStateSet(),Le),e){case this._handleCenter:this._changeColor(this._circleDown.getStateSet(),Le),this._changeColor(this._circleUp.getStateSet(),Le),this._changeColor(this._arcLeft.getStateSet(),Le),this._changeColor(this._arcRight.getStateSet(),Le);break;case this._handleUp:this._changeColor(this._circleUp.getStateSet(),Le);break;case this._handleDown:this._changeColor(this._circleDown.getStateSet(),Le);break;case this._handleLeft:this._changeColor(this._arcLeft.getStateSet(),Le);break;case this._handleRight:this._changeColor(this._arcRight.getStateSet(),Le)}V.a.draw()}else this._hovered=void 0},_changeColor:function(e,t){var n=e.getUniform("uColor").getInternalArray();Re.vec4.copy(n,t)},update:function(){var e=Re.vec4.create(),t=Re.vec3.create(),n=Re.vec3.create();return function(i){var r=i.getViewport(),a=r.width()/r.height(),o=Re.mat4.getScale(e,i.getProjectionMatrix())[0],s=Math.max(1.2,a*(1.1+.2/o)*o);this._manipulator.getEyePosition(t);var u=this._model.get("target"),l=this._getGizmo();l.isEditing()?(Re.mat4.getTranslation(u,l.getMatrix()),this._needsCameraUpdate=!0):this._needsCameraUpdate&&(this._needsCameraUpdate=!1,this._model.trigger("targetChanged"));var c=Re.vec3.dist(t,u)/s,h=this._pivotNode.getMatrix();Re.vec3.set(n,c,c,c),Re.mat4.fromTranslation(h,u),Re.mat4.scale(h,h,n);var d=this._centerNode.getMatrix();Re.mat4.invert(d,i.getViewMatrix()),Re.mat4.setTranslation(d,Re.vec3.ZERO),Re.mat4.scale(d,d,De),this._pivotNode.dirtyBound(),this._centerNode.dirtyBound()}}(),updateConstraints:function(){var e=this._model.get("usePitchConstraints"),t=this._model.get("useYawConstraints"),n=e?this._model.get("up"):this._defaults.up,i=e?this._model.get("down"):this._defaults.down,r=.5*(n+i);this._updatePitchWidget(this._circleUp,n),this._updatePitchWidget(this._circleDown,i),this._updatePitchWidget(this._circleCenter,r);var a=t?this._model.get("offset"):this._defaults.offset,o=t?this._model.get("angle"):this._defaults.angle,s=.5*o;e||t?(this._circleNode.setNodeMask(-1),this._arcNode.setNodeMask(-1),Re.mat4.fromZRotation(this._circleNode.getMatrix(),a-.5*Math.PI),Re.mat4.fromZRotation(this._arcCenter.getMatrix(),a),Re.mat4.fromZRotation(this._arcLeft.getMatrix(),a-s),Re.mat4.fromZRotation(this._arcRight.getMatrix(),a+s),Re.mat4.fromZRotation(this._arcHalfLeft.getMatrix(),a-.5*s),Re.mat4.fromZRotation(this._arcHalfRight.getMatrix(),a+.5*s)):(this._circleNode.setNodeMask(0),this._arcNode.setNodeMask(0)),this._updateHandles(e,t,n,i,r,s),Re.mat4.fromTranslation(this._pivotNode.getMatrix(),this._model.get("target")),this._uUp.getInternalArray()[0]=Math.sin(n),this._uDown.getInternalArray()[0]=Math.sin(i),this._uHUp.getInternalArray()[0]=-Math.cos(.5*o),this.dirtyBound(),this._pivotNode.dirtyBound(),this._circleNode.dirtyBound(),V.a.draw()},_updateHandles:function(e,t,n,i,r,a){if(e){this._handleUp.setNodeMask(-1),this._handleDown.setNodeMask(-1);var o=n-i;this._updateHandleWidget(this._handleUp,o<.07?r+.035:n,0),this._updateHandleWidget(this._handleDown,o<.07?r-.035:i,0)}else this._handleUp.setNodeMask(0),this._handleDown.setNodeMask(0);t?(this._handleRight.setNodeMask(-1),this._handleLeft.setNodeMask(-1),this._handleCenter.setNodeMask(-1),a=(a=a<.035?.035:a)>Math.PI-.035?Math.PI-.035:a,this._updateHandleWidget(this._handleRight,r,a),this._updateHandleWidget(this._handleLeft,r,-a),this._updateHandleWidget(this._handleCenter,r,0)):(this._handleRight.setNodeMask(0),this._handleLeft.setNodeMask(0),this._handleCenter.setNodeMask(0))},_updateHandleWidget:function(e,t,n){var i=e.getMatrix();Re.mat4.fromZRotation(i,n),Re.mat4.rotateY(i,i,t),Re.mat4.translate(i,i,ke),e.dirtyBound()},_updatePitchWidget:function(){var e=Re.vec3.create(),t=Re.vec3.create();return function(n,i){var r=n.getMatrix(),a=Math.sin(i),o=Math.cos(i);Re.vec3.set(e,0,0,a),Re.vec3.set(t,o,o,1),Re.mat4.fromTranslation(r,e),Re.mat4.scale(r,r,t)}}()});var He=Ge,ze=n("gRsq"),We=n("/s5t"),qe=d.a.osg,Xe=d.a.osgAnimation,Ye=function(e,t,n){this.cameraUpdateCallback=n,this._fpsDist=-1,this._manipulator=e,this._eyeEnd=qe.vec3.create(),this._eyeDeltaLen=0,this._targetEnd=qe.vec3.create(),this._targetDeltaLen=0,this._lastRatio=0,this._preventFlip=!1,We.a.call(this,t),this._finished=!0,this._easingFunction=Xe.easeOutQuart};qe.createPrototypeObject(Ye,qe.objectInherit(We.a.prototype,{setTargetAndEye:function(){var e=qe.vec3.create();return function(t,n,i){if(this._preventFlip=i,this._finished){var r=this._manipulator.getManipulatorList()[ve.FPS];this._fpsDist=r.getDistance()}qe.vec3.copy(this._eyeEnd,n),this._manipulator.getEyePosition(e),this._eyeDeltaLen=qe.vec3.len(qe.vec3.sub(e,n,e)),qe.vec3.copy(this._targetEnd,t),this._manipulator.getTarget(e),this._targetDeltaLen=qe.vec3.len(qe.vec3.sub(e,t,e)),this._lastRatio=0,this.reset()}}(),update:function(){var e=qe.vec3.create(),t=qe.vec3.create(),n=qe.vec3.create(),i=qe.vec3.create();return function(r,a){if(!0===this._finished)return!0;var o=this._manipulator,s=o.getCurrentManipulatorIndex();s===ve.FPS&&o.setManipulatorIndex(ve.ORBIT);var u=a.getFrameStamp().getSimulationTime(),l=this.interpolate(u,r,a),c=(l=this._easingFunction(l))-this._lastRatio;this._lastRatio=l;var h=this._manipulator;if(h.getEyePosition(e),h.getTarget(t),qe.vec3.sub(n,this._targetEnd,t),qe.vec3.normalize(n,n),qe.vec3.add(i,t,qe.vec3.scale(i,n,c*this._targetDeltaLen)),h.setTarget(i),qe.vec3.sub(n,this._eyeEnd,e),qe.vec3.normalize(n,n),qe.vec3.add(i,e,qe.vec3.scale(i,n,c*this._eyeDeltaLen)),h.setEyePosition(i,this._preventFlip),s===ve.FPS){var d=o.getDistance();o.setManipulatorIndex(s),o.getCurrentManipulator().setDistance(this._finished?this._fpsDist:d)}return!0===this._finished&&k.a.resolveFirstCameraAnimation(),this.cameraUpdateCallback(),!0}}(),setEasingFunction:function(e){this._easingFunction=Xe[e]}}),"osgSketchfab","UpdateCallbackCameraAnimation");var Ke=Ye,Qe=d.a.osg,Je=d.a.InputGroups,Ze=Math.PI/180,$e={FeatureName:"camera",ModelType:J,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments);var e=this.model;if(e.bind("change:indexManipulator",this.onIndexManipulatorChanged,this),e.bind("change:node",this.onNodeChanged,this),e.bind("change:minSpeed",this.onNodeChanged,this),e.bind("change:webVR",this.setVR,this),e.bind("change:fov",this.onFov,this),e.bind("change:nearFarRatio",this.onNearFarRatio,this),e.bind("change:animationDuration",this.onDurationChanged,this),e.bind("change:easingFunction",this.onEasingChanged,this),e.bind("setTargetAndEye",this.onTargetAndEyeChanged,this),e.bind("change:useCameraConstraints",this._onUseCamConstrainsToggle,this),e.bind("change:usePanConstraints",this.refreshConstraints,this),e.bind("change:useZoomConstraints",this.refreshConstraints,this),e.bind("change:zoomIn",this.refreshConstraints,this),e.bind("change:zoomOut",this.refreshConstraints,this),e.bind("change:usePitchConstraints",this.refreshConstraints,this),e.bind("change:right",this.refreshConstraints,this),e.bind("change:useYawConstraints",this.refreshConstraints,this),e.bind("change:up",this.refreshConstraints,this),e.bind("change:down",this.refreshConstraints,this),e.bind("targetChanged",this.onTargetChanged,this),e.bind("refreshConstraints",this.refreshConstraints,this),e.bind("saveZoomIn",this._saveZoom.bind(this,"zoomIn")),e.bind("saveZoomOut",this._saveZoom.bind(this,"zoomOut")),e.bind("change:displayGizmo",this._updateGizmoDisplay.bind(this)),this._viewer=this.options.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._switchManipulator=new ve(this._viewer.getInputManager(),this.cameraMove.bind(this)),this._viewerOSGJS.setupManipulator(this._switchManipulator),this._featureNode=new Qe.Node("Camera"),this._callbackCameraAnimation=new Ke(this._switchManipulator,e.get("animationDuration"),this.cameraMove.bind(this)),this._featureNode.addUpdateCallback(this._callbackCameraAnimation),this.model.bind("change:enableCameraConstraints",this.focusOnTarget,this),this.onIndexManipulatorChanged(),this._dolly=!1,this.onFov(),this.onNearFarRatio(),this._dolly=!0,k.a.getFirstCameraAnimation().then(function(){!e.get("webVR")&&this.model.get("useCameraConstraints")&&(this._updateGizmoDisplay(),this.focusOnTarget(),this._switchManipulator.getOrbitManipulator().enableRecenter(!this.model.get("useCameraConstraints")),this.initFeatureBridge())}.bind(this)),!Object(ze.a)()){this._cameraIdle=!0;var t=V.a.getFrameTimeAverage();this.cameraIdleNessDetectBinded=this.cameraIdleNessDetect.bind(this),this.timer=window.setTimeout(this.cameraIdleNessDetectBinded,t)}},initFeatureBridge:function(){this.model._viewer.getFeatures().inspector.getModel().bind("change:uiVisible",this._onInspectorVisiblilityChange.bind(this))},_onInspectorVisiblilityChange:function(e){var t=e.get("uiVisible");this.model.set("enableCameraConstraints",!t)},setVR:function(){var e=this._viewerOSGJS.getManipulator(),t=this.model.get("webVR");e.setDelay(t?1:.15);var n=this._viewerOSGJS.getInputManager();if(this._viewerOSGJS.requestContinuousUpdate(!0),t){this.lastMode=this.model.get("indexManipulator");var i=!!this._viewerOSGJS.getVRSession();n.setEnable(Je.FPS_MANIPULATOR_TOUCH,!1),n.setEnable(Je.FPS_MANIPULATOR_WEBVR,i),n.setEnable(Je.FPS_MANIPULATOR_DEVICEORIENTATION,!i),this.model.set("indexManipulator",ve.FPS)}else n.setEnable(Je.FPS_MANIPULATOR_TOUCH,!0),n.setEnable(Je.FPS_MANIPULATOR_WEBVR,!1),n.setEnable(Je.FPS_MANIPULATOR_DEVICEORIENTATION,!1),void 0!==this.lastMode&&this.model.set("indexManipulator",this.lastMode);var r=this._viewer.getFeatures();r&&!r.webVR&&e.computeHomePosition()},onDurationChanged:function(){this._callbackCameraAnimation.setDuration(this.model.get("animationDuration"))},onEasingChanged:function(){this._callbackCameraAnimation.setEasingFunction(this.model.get("easingFunction"))},onTargetAndEyeChanged:function(e){this._callbackCameraAnimation.setTargetAndEye(this.model.get("animationTarget"),this.model.get("animationEye"),e)},canMoveTarget:function(){return this.model.get("indexManipulator")===ve.FPS||!this._switchManipulator.getOrbitManipulator().isConstrainPan()},onFov:function(){var e=this._viewer.getCamera(),t=e.getViewport(),n=t.width()/t.height();if(Qe.mat4.perspective(e.getProjectionMatrix(),this.model.get("fov")*Ze,n,1,1e3),V.a.draw(),!this.model.get("dollyPrevent")){if(this._dolly){var i=this.options.context.getViewer().getViewerOSGJS().getManipulator(),r=i.getCurrentManipulator();if(r){var a=r.getHomeBoundingSphere();a&&i.setDistance(r.getHomeDistance(a))}}this.model.saveCameraPosition()}},onNearFarRatio:function(){this.model.set("minSpeed",15*this.model.get("nearFarRatio")),V.a.draw()},getNode:function(){return this._featureNode},getWidgetNode:function(){return this._widgetNode||(this._widgetNode=new Qe.Node,this._widgetNode.setNodeMask(0)),this._widgetNode},onIndexManipulatorChanged:function(){this._switchManipulator.setManipulatorIndex(this.model.get("indexManipulator"))},onNodeChanged:function(){if(this._dolly){var e=this._switchManipulator;e.setNode(this.model.get("node"));var t=e.getOrbitManipulator(),n=this._switchManipulator.getHomeBoundingSphere().radius();t.setMinSpeed(this.model.get("minSpeed")*n)}},focusOnTarget:function(){this.model.get("enableCameraConstraints")&&this.lookatTarget(),this.refreshConstraints()},lookatTarget:function(){var e=Qe.vec3.create();return function(){this._switchManipulator.getOrbitManipulator().getEyePosition(e),this._viewer.getFeaturesManager().focusOnTargetAndEye(this.model.get("target"),e,.3,!0)}}(),onTargetChanged:function(){this.model.get("usePanConstraints")&&this.model.get("enableCameraConstraints")&&this.focusOnTarget()},_initGizmo:function(){this._widgetNode=new Qe.Camera,this._widgetNode.setName("Camera - Constraints - Widgets"),this._featureNode.addChild(this._widgetNode),this._widgetNode.setNearFarRatio(5e-5),this._widgetNode.setNodeMask(_e.a.NO_SHADOW),this._gizmo=new He(this._switchManipulator.getOrbitManipulator(),this.model),this._widgetNode.addChild(this._gizmo),this._widgetNode.addUpdateCallback(this)},_updateGizmoDisplay:function(){if(k.a.getFirstCameraAnimation().isFulfilled()){var e=this.model.get("displayGizmo");!this._gizmo&&e&&(this._initGizmo(),this.refreshConstraints(),Object(o.a)()&&this._gizmo.setPivotSelected(this.model.get("useCameraConstraints"))),this._gizmo&&this._gizmo.setVisible(e)}},_onUseCamConstrainsToggle:function(){var e=this.model.get("useCameraConstraints");this._gizmo&&this._gizmo.setPivotSelected(e),this.refreshConstraints(),this._switchManipulator.getOrbitManipulator().enableRecenter(!e)},refreshConstraints:function(){k.a.getFirstCameraAnimation().isFulfilled()&&this.applyConstraints()},applyConstraints:function(){if(!this._hasHotSpots()){var e=this.model,t=e.getInstance();e.get("enableCameraConstraints")&&this._applyModel(t);var n=this._switchManipulator.getOrbitManipulator();n.setLimitYawLeft(t.left),n.setLimitYawRight(t.right),n.setConstrainYaw(t.useYawConstraints);var i=.5*Math.PI*.99;n.setLimitPitchDown(Math.min(i,Math.max(-i,t.down))),n.setLimitPitchUp(Math.min(i,Math.max(-i,t.up))),n.setConstrainPitch(t.usePitchConstraints),-1===t.zoomOut&&(t.zoomOut=1/0),n.setLimitZoomOut(t.zoomOut),n.setConstrainZoom(t.useZoomConstraints);var r=!(t.usePanConstraints&&e.get("enableCameraConstraints")&&e.get("useCameraConstraints"));if(t.zoomIn>0)n.setLimitZoomIn(t.zoomIn);else{var a=this._switchManipulator.getHomeBoundingSphere().radius();n.setLimitZoomIn(.001*a)}n.setAutoPushTarget(r&&!t.useZoomConstraints),n.setConstrainPan(!r),n.setPanConstraintTarget(e.get("target")),this._gizmo&&(this._gizmo.updateConstraints(),r||this.lookatTarget()),V.a.draw()}},update:function(){if(this._hasHotSpots())return!1;var e=this._viewer.getOptions().widgetAPI,t=e&&e.getTabbedWidget().get();return this.model.get("displayGizmo")&&this._gizmo.update(this._viewer.getCamera()),"scene"===t?this._currentTab!==t&&this.model.trigger("TabEnter"):this._currentTab!==t&&(this.model.trigger("TabLeave"),this.model.set("displayGizmo",!1)),this._currentTab=t,!0},_hasHotSpots:function(){if(this.model.get("viewer-api-hotspots"))return!1;var e=this._viewer.getFeatures().hotspot.getModel(),t=e.get("hotspots").length&&e.get("visible");return t&&this.model.get("useCameraConstraints")&&(this.model.set("useCameraConstraints",!1),Object(o.a)()&&this.model.trigger("ForceDisable")),t},_applyModel:function(e){var t=this.model;t.get("useCameraConstraints")&&(e.useCameraConstraints=!0,e.usePanConstraints=t.get("usePanConstraints"),e.useZoomConstraints=t.get("useZoomConstraints"),e.useZoomConstraints&&(e.zoomIn=t.get("zoomIn"),e.zoomOut=t.get("zoomOut")),e.useYawConstraints=t.get("useYawConstraints"),e.useYawConstraints&&(e.left=Math.max(t.get("left"),-3.14159265),e.right=Math.min(t.get("right"),3.14159265)),e.usePitchConstraints=t.get("usePitchConstraints"),e.usePitchConstraints&&(e.up=t.get("up"),e.down=t.get("down")),Object(o.a)()&&Object(u.a)().apiLog&&(console.log("------"),console.log("Viewer API  Camera Constraints json:"),console.log(t.editorGetJSON()),console.log("------")))},_saveZoom:function(e){var t=this.model.limits(),n=Math.max(this._switchManipulator.getOrbitManipulator().getDistance(),t[e].min);this.model.set(e,n)},cameraMove:function(e){e&&V.a.draw(),this._cameraMoved=Qe.Timer.instance().tick(),this._cameraIdle&&(this._viewer.trigger("cameraStart"),this._cameraIdle=!1)},cameraIdleNessDetect:function(){var e=2*V.a.getFrameTimeAverage();this.timer=window.setTimeout(this.cameraIdleNessDetectBinded,e),Qe.Timer.instance().tick()-this._cameraMoved-e<=e||this._cameraIdle||(this._viewer.trigger("cameraStop"),this._cameraIdle=!0)}})]},et=i.a.create($e);et.prototype.getManipulator=function(){return this._views[0]._switchManipulator},et.prototype.canMoveTarget=function(){return this._views[0].canMoveTarget()},et.prototype.getNode=function(){return this._views[0].getNode()},et.prototype.getWidgetNode=function(){return this._views[0].getWidgetNode()};var tt=et,nt=n("zmn3"),it=n("uPP5"),rt=d.a.osg,at=function(){rt.NodeVisitor.call(this,rt.NodeVisitor.TRAVERSE_ALL_CHILDREN),this._source="",this._authoringTool="",this._sourceTool=""};rt.createPrototypeObject(at,rt.objectInherit(rt.NodeVisitor.prototype,{getSource:function(){return this._source},getAuthoringTool:function(){return this._authoringTool},getSourceTool:function(){return this._sourceTool},extractSource:function(e){for(var t=0,n=e.length;t<n;++t){var i=e[t],r=i.Name;"source"===r?this._source=i.Value:"authoring_tool"===r?this._authoringTool=i.Value:"source_tool"===r&&(this._sourceTool=i.Value)}},checkStateSet:function(e){e&&e.getUserData()&&this.extractSource(e.getUserData())},checkNode:function(e){var t=e.getUserData();if(!t){if("LightSource"!==e.className())return;if(!e.getLight())return;if(!(t=e.getLight().getUserData()))return}this.extractSource(t)},apply:function(e){this._source||(this.checkNode(e),this._source||(this.checkStateSet(e.getStateSet()),this._source||this.traverse(e)))}}));var ot=at,st=n("dtwz"),ut=n("OtLZ"),lt=n("BeL+"),ct=n("1myf"),ht=n("OZf9"),dt=n("Z0Cl"),ft=n("NFsq"),pt=n("12sq"),gt=n("dPYE"),mt=n("nSmV"),vt=n("xszh"),_t=n("B306"),bt=d.a.osg,St=function(e,t,n){bt.NodeVisitor.call(this,bt.NodeVisitor.TRAVERSE_ALL_CHILDREN),this._lights=[],this._materials=[],this._materialManager=e,this._stateSetsProcessed={},this._authoringTool=t,this._source=n,this._style="",this._hasMetal=void 0,this._globalEnforceRoughness=void 0,this._dictionary=pt.a.channelNames,this._dictionaryKeys=Object.keys(pt.a.channelNames),this._sortedImages=void 0,this._textureFactor1=!1,this._textureUnit0=!1};bt.createPrototypeObject(St,bt.objectInherit(bt.NodeVisitor.prototype,{getStyle:function(){return this._style},hasMetallicWorkflow:function(){return this._hasMetal},getLights:function(){return this._lights},getMaterials:function(){return this._materials},copyDiffuse:function(e){var t=e.getChannels().DiffuseColor,n=e.getChannels().AlbedoPBR,i=e.getChannels().DiffusePBR,r=t.getColor(),a=t.getFactor(),o=t.getTextureModel();r&&(n.setColor(r),i.setColor(r)),n.setFactor(a),i.setFactor(a),o&&(n.setTextureModel(o),i.setTextureModel(o))},matchNameAgainstDict:function(e,t,n){var i=Object(mt.a)(e);if(!t)return!1;for(var r=0;r<t.length;r++){var a=t[r],o=Object(gt.a)(i,a);if(o<n&&o<a.length)return!0}return!1},channelTextureExtract:function(e,t){var n=e.getChannels()[t];if(n){var i=n.getTextureModel();if(i)return i.getImageModel().get("name")}},channelTextureMatch:function(e,t,n,i){var r=this.channelTextureExtract(e,t);return r&&this.matchNameAgainstDict(r,n,i)},hasTextureChannel:function(e,t){return void 0!==this.channelTextureExtract(e,t)},channelTextureCopy:function(e,t,n){var i=e.getChannels();if(this.channelTextureExtract(e,t))for(var r=n.length;r--;)i[n[r]].setTextureModel(i[t].getTextureModel().clone())},checkPBRSlot:function(e){if(e)for(var t=0;t<this._dictionaryKeys.length;t++){var n=this._dictionaryKeys[t],i=this._dictionary[n];if(this.matchNameAgainstDict(e,i,pt.a.maxLevenshteinDistance))return n}},assignPBRTextureFromFilenames:function(e,t){for(var n=0,i=e.length;n<i;++n){var r=e[n],a=r.getName(),o=this.checkPBRSlot(a);if(!o&&r.getImage()&&(a=r.getImage().getURL(),o=this.checkPBRSlot(a)),o){var s=t.getChannels()[o];if(!s.getTextureModel()){var u=this.createTextureOptionsFromTextureOSG(r);u&&s.setupTextureModel(u)}}}},checkChannelsAndSetWorkFlowRoughGloss:function(e){if(e){var t=e.getChannels(),n=this.hasTextureChannel(e,"GlossinessPBR"),i=this.hasTextureChannel(e,"SpecularPBR"),r=this.hasTextureChannel(e,"RoughnessPBR");this.hasTextureChannel(e,"BumpMap")&&t.BumpMap.setFactor(10),this.hasTextureChannel(e,"MetalnessPBR")&&(this._hasMetal=!0),i&&void 0===this._hasMetal&&(this._hasMetal=!1);var a=r||this._globalEnforceRoughness;a||(a=!n&&void 0===this._globalEnforceRoughness),e.setWorkFlowRoughGloss(a,!1)}},matchFullNameAgainstDict:function(e,t){if(!t)return!1;for(var n=0;n<t.length;++n)if(!(t[n].length<4)&&-1!==e.indexOf(t[n]))return!0;return!1},setChannelsFromImagesNames:function(e,t,n,i){for(var r=pt.a.maxLevenshteinDistance,a=0,o=t.length;a<o;a++)for(var s=t[a],u=this._dictionary[s],l=0,c=n.length;l<c;l++){var h=n[l].get("name");if(i?this.matchFullNameAgainstDict(h,u):this.matchNameAgainstDict(h,u,r)){var d=e.getChannels()[s];d.setTextureModel(new vt.a({image:n[l]})),d.setFactor(1),e.setChannelEnable(d.get("name"),!0)}}},setGlossinessPBRFromSpecularGlossiness:function(e,t,n){var i=.2126*t[0]+.7152*t[1]+.0722*t[2],r=Math.pow(1e4*n,.25)/100*i;e.setChannelFactor("GlossinessPBR",r),e.setChannelEnable("GlossinessPBR",!0),this._globalEnforceRoughness=!1},getPBRChannels:function(e){var t=[],n=e.getChannels();for(var i in n)-1!==i.indexOf("PBR")&&t.push(i);return t},channelMatchAndCopy:function(e,t,n){var i=this._dictionary[n];if(this.channelTextureMatch(e,t,i,2))return this.channelTextureCopy(e,t,[n])},checkForPBRTextureFromChannelsAndFilenames:function(e){if(e){for(var t=this.getPBRChannels(e),n=t.length;n--;)if(void 0!==this.channelTextureExtract(e,t[n]))return;this.channelTextureCopy(e,"DiffuseColor",["AlbedoPBR","DiffusePBR"]),this.channelTextureCopy(e,"DiffuseIntensity",["AOPBR"]),this.channelMatchAndCopy(e,"SpecularColor","MetalnessPBR")||this.channelMatchAndCopy(e,"SpecularHardness","MetalnessPBR")||this.channelMatchAndCopy(e,"SpecularColor","SpecularPBR")||this.channelMatchAndCopy(e,"SpecularHardness","SpecularPBR"),this.channelMatchAndCopy(e,"SpecularColor","RoughnessPBR")||this.channelMatchAndCopy(e,"SpecularHardness","RoughnessPBR")||this.channelMatchAndCopy(e,"SpecularColor","GlossinessPBR")||this.channelMatchAndCopy(e,"SpecularHardness","GlossinessPBR")}},getOrCreateSortedImagesList:function(){return void 0===this._sortedImages&&(this._sortedImages=this._materialManager.getImageCollection().clone(),this._sortedImages.comparator=function(e,t){return(e.get("version")||0)-(t.get("version")||0)},this._sortedImages.sort()),this._sortedImages},checkForPBRTextureFromMaterialAndFilenames:function(e,t){if(e&&0!==this._materialManager.getImageCollection().length){var n=[],i=e.getChannels();for(var r in i)this.channelTextureExtract(e,r)||n.push(r);for(var a=[],o=this.getOrCreateSortedImagesList(),s=e.get("name").toLowerCase(),u=0;u<o.length;u++){var l=o.models[u].get("name");(t||-1!==l.toLowerCase().indexOf(s))&&a.push(o.models[u])}this.setChannelsFromImagesNames(e,n,a,t)}},hasMaterialAttributes:function(e){return e.getAttribute("Material")},hasTextureAttributes:function(e){for(var t=0,n=e.getNumTextureAttributeLists();t<n;t++)if(e.getTextureAttribute(t,"Texture"))return!0;return!1},processDefaultMaterial:function(e,t){t.removeAttribute("Material");for(var n=0,i=t.getNumTextureAttributeLists();n<i;n++)t.removeTextureAttribute(n,"Texture")},getReferencedTextures:function(e){for(var t=[],n=0;n<e.getNumTextureAttributeLists();n++){var i=e.getTextureAttribute(n,"Texture");i&&("PackedMaterialTexture"===i.className()&&(i=i.getTexture()),t[n]=i)}return t},createMaterial:function(e,t){var n=this._materialManager.createMaterial(e,t);return this._materials.push(n),n},createTextureOptionsFromTextureOSG:function(e){var t=_t.a.getOptions(e),n=e.getImage().getURL(),i=this._materialManager.getImageCollection().getImageFromURL(n);if(i)return t.image=i,t;bt.error("Cannot find image in collection : "+n)},mapTexturesOnMaterial:function(e,t){for(var n=["EmitColor","DiffuseColor","SpecularColor"],i=this.getReferencedTextures(e),r=e.getNumTextureAttributeLists(),a=0,o=r;a<o;a++)if(e.getTextureAttribute(a,"Texture")){var s=1===r?"DiffuseColor":n[a];if(s&&i[a]){var u=this.createTextureOptionsFromTextureOSG(i[a]);if(u){var l=new vt.a(u);this.setMaterialChannelTexture(e,t,a,s,l)}}}},applyExistingMaterial:function(e,t){if(e){var n=this._materialManager.getMaterialByStateSet(e);if(n){var i=(n.get("stateSet")||e).getInstanceID();if(!0===this._stateSetsProcessed[i])return n;this._stateSetsProcessed[i]=!0;var r=e.getAttributeMap().Material,a=this._materialManager.getUniqueMaterialName(r,e,t);return n.set("name",a),n.setStateSet(e),this._materials.push(n),n}this._stateSetsProcessed[e.getInstanceID()]=!0}},processLightSource:function(){},pushLight:function(e){var t=this.nodePath[this.nodePath.length-1];t instanceof bt.LightSource&&(t.setNodeMask(0),t.setLight(e)),e._worldMatrix=bt.computeLocalToWorld(this.nodePath),this._lights.push(e)},processNode:function(e){var t=e.getStateSet();if(t){var n=this.applyExistingMaterial(t,e);if(n)e.setStateSet(n.get("stateSet"));else{var i=t.getUserData();if(this.hasMaterialAttributes(t)||this.hasTextureAttributes(t))if(i){var r=f.a.convertUserDataToObject(i);this.processMaterial(e,t,r)}else this.processDefaultMaterial(e,t);n=this._materialManager.getMaterialByStateSet(t),this.checkForPBRTextureFromChannelsAndFilenames(n),this.checkForPBRTextureFromMaterialAndFilenames(n),this.checkChannelsAndSetWorkFlowRoughGloss(n)}}},apply:function(e){e.typeID===bt.LightSource.typeID&&this.processLightSource(e),this.processNode(e),this.traverse(e)},handleSingleMaterialMapping:function(){if(1===this.getMaterials().length){var e=this.getMaterials()[0];this.checkForPBRTextureFromMaterialAndFilenames(e,!0),this.checkChannelsAndSetWorkFlowRoughGloss(e)}},setMaterialChannelColor:function(e,t,n,i){var r=t.getChannels()[n];return r.setColor&&r.setColor(i),r.setEnable(!0),r},setMaterialChannelFactor:function(e,t,n,i){var r=t.getChannels()[n];return r.setFactor(i),r.setEnable(!0),r},setMaterialChannelTexture:function(e,t,n,i,r){e.removeTextureAttribute(n,"Texture");var a=t.getChannels()[i];return a.setTextureModel(r),a.resetTextureFormat(),this._textureFactor1&&a.setFactor(1),a.setTexCoordUnit(this._textureUnit0?0:n),a.setEnable(!0),a},setChannelsFromMetaDataFactor:function(e,t){if(this._metaMapFactor){var n=this._metaMapFactor;for(var i in n)if(void 0!==e[i]){var r=JSON.parse(e[i]);this.setMaterialChannelFactor(e,t,n[i],r)}}},setChannelsFromMetaDataColor:function(e,t){if(this._metaMapColor){var n=this._metaMapColor;for(var i in n)if(void 0!==e[i]){var r=JSON.parse(e[i]);this.setMaterialChannelColor(e,t,n[i],r)}}},setChannelsFromMetaDataTexture:function(e,t,n){if(this._metaMapTexture){var i=this.getReferencedTextures(t),r=this._metaMapTexture;for(var a in r)if(void 0!==e[a]){var o=JSON.parse(e[a]),s=i[o];if(s){var u=this.createTextureOptionsFromTextureOSG(s);if(u){var l=new vt.a(u),c=r[a];this.setMaterialChannelTexture(t,n,o,c,l)}}}}}}));var yt=St,xt=d.a.osg,Ct=function(){xt.Light.apply(this,arguments)};Ct.DIRECTION=xt.Light.DIRECTION,Ct.SPOT=xt.Light.SPOT,Ct.POINT=xt.Light.POINT,Ct.HEMI=xt.Light.HEMI,xt.createPrototypeStateAttribute(Ct,xt.objectInherit(xt.Light.prototype,{attributeType:"SketchfabLight",isDirectionLight:function(){return 0===this._position[3]&&(-1===this._ground[3]||0===this._ground[3])}}),"osgSketchfab","Light");var wt=xt.vec3.create();xt.LightSource.prototype.computeBoundingSphere=function(e){if(xt.Node.prototype.computeBoundingSphere.call(this,e),!e.valid())return e;if(void 0!==this._light&&this._referenceFrame===xt.Transform.RELATIVE_RF){var t=this._light.getPosition();0!==t[3]&&e.expandByVec3(xt.vec3.scale(wt,t,1/t[3]))}return e};var Tt=Ct,Mt=d.a.osg,Et=function(){yt.apply(this,arguments)};Mt.createPrototypeObject(Et,Mt.objectInherit(yt.prototype,{_handleCycleDefaultValue:function(e,t,n,i,r,a){if(void 0!==e)if(Array.isArray(e))if("Opacity"===t)if("Color"===n){var o=e[0]*e[1]*e[2]*e[3];1===o&&(o=.15),i[r](t,o)}else i[r](t,e);else"SpecularPBR"===t?"Color"===n?i[r](t,e):(e=e[0]*e[1]*e[2]*e[3],i[r](t,e)):"Color"===n&&"NormalMap"===t||i[r](t,e);else"setChannelFactor"===r&&("Strength"===n&&"Emission"===a&&(e/=10),i[r](t,e))},_handleCycleLinkSpecular:function(e,t,n,i,r,a){for(var o=0;o<e.links.length;o++){var s=e.links[o];if(s.from_node){var u=t.nodes[s.from_node],l=u&&u.texture_slot,c=u&&n.getTextureAttribute(l,"Texture");if(!u||!c)return void Mt.warn("Missing Texture linked in "+a+" node destined to "+r);var h=this.createTextureOptionsFromTextureOSG(c);if(h){var d=i.getChannels()[r];d.setupTextureModel(h),d.resetTextureFormat(),d.setTexCoordUnit(l),d.setEnable(!0),this._texturesAssigned.push(c)}}}},cyclesNodeToMaterial:function(e,t,n,i,r,a,o){var s=e.nodes[r];if(void 0!==s)if(!s.value||s.inputs){for(var u=0;u<s.inputs.length;u++){var l=s.inputs[u];if(l.name===a){var c=l.default_value;if(this._handleCycleDefaultValue(c,o,a,t,i,r),l.links&&"SpecularPBR"!==o)return void this._handleCycleLinkSpecular(l,e,n,t,o,r)}}(s=this.findNodeByValueCyclesMetadata(e.nodes,r))&&s.value&&t[i](o,s.value)}else t[i](o,s.value)},findNodeByValueCyclesMetadata:function(e,t){for(var n in e){var i=e[n];if(i instanceof Object){var r=this.findNodeByValueCyclesMetadata(i,t);if(void 0!==r)return r}else if(i===t)return e}},metaDataToMaterial:function(e,t,n,i,r,a){if(void 0!==e[i]){void 0===r&&(r=i);var o="setChannel"+n;void 0!==t[o]?void 0===a||!0===a?t[o](r,JSON.parse(e[i])):t[o](r,e[i]):Mt.warn("material has not method "+o)}},setTextureFromBlender:function(e,t,n,i,r){var a=this.createTextureOptionsFromTextureOSG(i);if(a){var o=e.getChannels()[t];o.setFactor(r),o.setupTextureModel(a),o.setTexCoordUnit(n),o.setEnable(!0)}},processDefaultMaterial:function(e,t){t.removeAttribute("Material");for(var n=0,i=t.getNumTextureAttributeLists();n<i;n++)t.removeTextureAttribute(n,"Texture");e.setStateSet(void 0)},processLightSource:function(e){var t=e.getLight();if(t&&void 0!==t.getUserData()&&t.typeID!==Tt.typeID){var n=t.getUserData(),i=f.a.convertUserDataToObject(n),r=new Tt;"AREA"!==i.Type&&"SUN"!==i.Type&&"HEMI"!==i.Type||(i.Type="DIRECTION"),r.setLightType(i.Type),void 0!==i.SpotSize&&r.setSpotCutoff(90*JSON.parse(i.SpotSize)/Math.PI),void 0!==i.SpotBlend&&r.setSpotBlend(JSON.parse(i.SpotBlend)),Mt.vec3.scale(r.getDiffuse(),JSON.parse(i.Color),JSON.parse(i.Energy));var a=1/JSON.parse(i.Distance);r.setQuadraticAttenuation(Math.abs(a)===1/0?0:a),this.pushLight(r)}},processCyclesGraph:function(e,t,n){var i;try{i=JSON.parse(n.NodeTree)}catch(e){return Mt.warn("error in blender cycle graph json "+e),!0}if(void 0===i)return!0;this._texturesAssigned=[],this.cyclesNodeToMaterial(i,e,t,"setChannelColor","Diffuse BSDF","Color","DiffusePBR"),this.cyclesNodeToMaterial(i,e,t,"setChannelFactor","Diffuse BSDF","Roughness","RoughnessPBR"),this.cyclesNodeToMaterial(i,e,t,"setChannelColor","Diffuse BSDF","Normal","NormalMap"),this.cyclesNodeToMaterial(i,e,t,"setChannelColor","Glossy BSDF","Color","SpecularPBR"),e.setChannelFactor("SpecularPBR",1),this.cyclesNodeToMaterial(i,e,t,"setChannelFactor","Glossy BSDF","Roughness","RoughnessPBR"),this.cyclesNodeToMaterial(i,e,t,"setChannelColor","Glossy BSDF","Normal","NormalMap"),this.cyclesNodeToMaterial(i,e,t,"setChannelColor","Bump","Height","NormalMap"),this.cyclesNodeToMaterial(i,e,t,"setChannelFactor","Bump","Strength","NormalMap"),this.cyclesNodeToMaterial(i,e,t,"setChannelColor","Emission","Color","EmitColor"),this.cyclesNodeToMaterial(i,e,t,"setChannelFactor","Emission","Strength","EmitColor"),this.cyclesNodeToMaterial(i,e,t,"setChannelColor","Ambient Occlusion","Color","AOPBR"),this.cyclesNodeToMaterial(i,e,t,"setChannelFactor","Ambient Occlusion","Strength","AOPBR"),this.cyclesNodeToMaterial(i,e,t,"setChannelFactor","Transparency","Strength","Opacity"),this.cyclesNodeToMaterial(i,e,t,"setChannelFactor","Transparent BSDF","Color","Opacity"),this.cyclesNodeToMaterial(i,e,t,"setChannelFactor","Glass BSDF","Color","Opacity");for(var r=[],a=0,o=t.getNumTextureAttributeLists();a<o;a++){var s=t.getTextureAttribute(a,"Texture");s&&-1===this._texturesAssigned.indexOf(s)&&r.push(s)}return this.assignPBRTextureFromFilenames(r,e),e.setWorkFlowMetalSpec(!1,!1),e.setWorkFlowRoughGloss(!0,!1),this._hasMetal=!1,!1},processMaterial:function(e,t,n){var i=this.createMaterial(e,t),r=t.getAttribute("Material"),a=r&&r.getUserData(),o=f.a.convertUserDataToObject(a),s=!0;o.NodeTree&&(s=this.processCyclesGraph(i,t,o)),s&&(this.metaDataToMaterial(o,i,"Color","DiffuseColor"),this.metaDataToMaterial(o,i,"Factor","DiffuseIntensity","DiffuseColor"),i.setChannelEnable("DiffuseColor",!0),this.metaDataToMaterial(o,i,"Color","SpecularColor"),this.metaDataToMaterial(o,i,"Factor","SpecularIntensity","SpecularColor"),i.setChannelEnable("SpecularColor",!0),this.metaDataToMaterial(o,i,"Factor","Emit","EmitColor"),i.setChannelEnable("EmitColor",!0),this.metaDataToMaterial(o,i,"Factor","SpecularHardness"),i.setChannelEnable("SpecularHardness",!0),void 0!==o.Translucency&&(i.setChannelFactor("Opacity",1-JSON.parse(o.Translucency)),i.setChannelEnable("Opacity",!0)),void 0!==n.Shadeless&&i.set("shadeless",n.Shadeless));var u=Object(st.a)([function(e){return Object(nt.a)(e,function(e){var t=e.Name.substr(0,2),n=parseInt(t,10);if(!isNaN(n))return n})},function(e){return Object(ut.a)(e,void 0)},lt.a,function(e){return Object(ct.a)(e,function(e){return e})}])(t.getUserData());t.removeAttribute("Material");var l={},c=["DiffuseColor","DiffuseIntensity","SpecularColor","Normal","Bump","Translucency","Alpha","EmitColor","SpecularHardness"],h=this;for(var d in Object(ht.a)(u,function(e){var n=Object(dt.a)(t.getUserData(),function(t){var n=t.Name.substr(0,2);return parseInt(n,10)===e});Object(ht.a)(n,function(e){var n=e.Name.substr(0,2),r=parseInt(n,10),a=t.getTextureAttribute(r,"Texture");if(void 0!==a){l[r]=a;var o=e.Name.substr(3);if(!0===Object(ft.a)(c,o)){var s=parseFloat(e.Value);"DiffuseColor"===o?void 0!==i.getChannels().DiffuseColor.getTextureModel()&&void 0===i.getChannels().DiffuseIntensity.getTextureModel()&&(o="DiffuseIntensity"):"Alpha"===o?o="Opacity":"Translucency"===o?(o="Opacity",s=1-s):"Normal"===o?o="NormalMap":"Bump"===o&&(o="BumpMap"),h.setTextureFromBlender(i,o,r,a,s)}else"UsePremultiplyAlpha"===o?Mt.warn("UsePremultiplyAlpha not supported"):"UseAlpha"===o?Mt.warn("UseAlpha not supported"):Mt.warn("channel "+o+" not supported")}else Mt.warn("missing texture")})}),l)t.removeTextureAttribute(parseInt(d,10),"Texture");"ksp"===o.source&&(-1===i.attributes.name.toLowerCase().indexOf("wheel")?i.getChannels().MetalnessPBR.setFactor(1):i.getChannels().SpecularF0.setFactor(0),-1!==i.attributes.name.toLowerCase().indexOf("fairing")&&i.getChannels().Opacity.setFactor(.25)),i.setStateSet(t)}}));var At=Et,Ot=d.a.osg,Rt=function(){yt.apply(this,arguments),this._metaMapColor={emission_color:"EmitColor",diffuse_color:"DiffuseColor",specular_color:"SpecularColor",transparency_color:"Opacity"},this._metaMapFactor={bump_amount:"BumpMap",normal_amount:"NormalMap",shininess_amount:"SpecularHardness",transparency_amount:"Opacity"},this._metaMapTexture={emissive_unit:"EmitColor",diffuse_unit:"DiffuseColor",specular_unit:"SpecularColor",shininess_unit:"SpecularHardness",transparency_unit:"Opacity",bump_unit:"BumpMap",normal_unit:"NormalMap"}};Ot.createPrototypeObject(Rt,Ot.objectInherit(yt.prototype,{setMaterialChannelColor:function(e,t,n,i){var r=t.getChannels()[n];r.setEnable(!0),"Opacity"!==n?(r.setColor&&r.setColor(i),"SpecularColor"===n&&r.setFactor(1)):r.setFactor(i[3])},setMaterialChannelFactor:function(e,t,n,i){var r=t.getChannels()[n];if(r.setEnable(!0),"SpecularHardness"===n){i*=128;var a=e.specular_color?JSON.parse(e.specular_color):Ot.vec3.ZERO;this.setGlossinessPBRFromSpecularGlossiness(t,a,i)}r.setFactor(i)},_extractMetaData:function(e,t,n){for(var i in t)if(i.startsWith(n)){var r=i.substr(n.length+1);e[r]||(e[r]=t[i])}},_cleanMetaData:function(e){var t={};return this._extractMetaData(t,e,"lambert"),this._extractMetaData(t,e,"blinn"),this._extractMetaData(t,e,"phong"),this._extractMetaData(t,e,"extra"),t},processMaterial:function(e,t,n){var i=this.createMaterial(e,t),r=i.getChannels();n=this._cleanMetaData(n),this.setChannelsFromMetaDataFactor(n,i),this.setChannelsFromMetaDataColor(n,i),this.setChannelsFromMetaDataTexture(n,t,i),n.transparency_alphamask&&r.Opacity.getTextureModel()&&r.Opacity.setTransparency("alphaMask"),"substancepainter"===this._source&&r.NormalMap.set("flipY",!1),t.removeAttribute("Material"),i.setStateSet(t)}}));var Pt=Rt,It=d.a.osg,Nt=function(){yt.apply(this,arguments)};It.createPrototypeObject(Nt,It.objectInherit(yt.prototype,{processMaterial:function(e,t){return this.processDefaultMaterial(e,t)},processDefaultMaterial:function(e,t){var n=this.createMaterial(e,t),i=t.getAttribute("Material");return void 0!==i&&(n.setChannelColor("EmitColor",i.getAmbient()),n.setChannelColor("DiffuseColor",i.getDiffuse()),n.setChannelColor("SpecularColor",i.getSpecular()),n.setChannelFactor("SpecularHardness",i.getShininess()),n.setChannelFactor("Opacity",i.getDiffuse()[3]),n.setChannelEnable("EmitColor",!0),n.setChannelEnable("DiffuseColor",!0),n.setChannelEnable("SpecularColor",!0),n.setChannelEnable("SpecularHardness",!0),n.setChannelEnable("Opacity",!0),t.removeAttribute("Material")),this.mapTexturesOnMaterial(t,n),n.setStateSet(t),n}}));var Lt=Nt,kt=d.a.osg,Dt=function(){yt.apply(this,arguments),this._textureFactor1=!0,this._metaMapColor={LambertDiffuseColor:"DiffuseColor",LambertEmissiveColor:"EmitColor",PhongSpecularColor:"SpecularColor"},this._metaMapFactor={LambertDiffuseFactor:"DiffuseColor",LambertBumpFactor:"BumpMap",LambertEmissiveFactor:"EmitColor",PhongSpecularFactor:"SpecularColor",PhongShininess:"SpecularHardness"},this._metaMapTexture={sDiffuse:"DiffuseColor",sNormalMap:"NormalMap",sBump:"BumpMap",sEmissive:"EmitColor",sSpecular:"SpecularColor",sOpacity:"Opacity",sAo:"AOPBR",sRoughness:"RoughnessPBR",sMetallic:"MetalnessPBR"}};kt.createPrototypeObject(Dt,kt.objectInherit(yt.prototype,{setMaterialChannelColor:function(e,t,n,i){var r=t.getChannels()[n];r.setColor&&r.setColor(i),r.setEnable(!0)},setMaterialChannelFactor:function(e,t,n,i){var r=t.getChannels()[n];if(r.setFactor(i),r.setEnable(!0),"SpecularHardness"===n){var a=e.PhongSpecularColor?JSON.parse(e.PhongSpecularColor):[0,0,0];this.setGlossinessPBRFromSpecularGlossiness(t,a,i)}},processLightSource:function(e){var t=e.getLight();if(t){var n=t.getUserData();if(void 0!==n&&t.typeID!==Tt.typeID){var i=f.a.convertUserDataToObject(n),r=new Tt;if("directional"===i.Type)r.setLightType("DIRECTION");else if("point"===i.Type)r.setLightType("POINT");else{if("spot"!==i.Type)return;r.setLightType("SPOT")}if("spot"===i.Type){r.setSpotCutoff(JSON.parse(i.OuterAngle)/2);var a=JSON.parse(i.InnerAngle)/JSON.parse(i.OuterAngle);r.setSpotBlend(a!=a||Math.abs(a)===1/0?.5:Math.min(a,1))}kt.vec3.scale(r.getDiffuse(),JSON.parse(i.Color),JSON.parse(i.Intensity)/100);var o=1/JSON.parse(i.DecayStart);r.setQuadraticAttenuation(Math.abs(o)===1/0?0:o),this.pushLight(r)}}},processMaterial:function(e,t,n){var i=this.createMaterial(e,t);if(this.setChannelsFromMetaDataColor(n,i),this.setChannelsFromMetaDataFactor(n,i),this.setChannelsFromMetaDataTexture(n,t,i),n.LambertBumpFactor&&!n.sBump&&i.getChannels().BumpMap.setEnable(!1),"Agisoft Metashape"===this._authoringTool){var r=i.getChannels().NormalMap;r.getTextureModel()&&r.set("flipY",!1)}if("Tilt Brush"===this._authoringTool){var a=i.getChannels(),o=a.EmitColor;if(o.set("type","multiplicative"),!o.getTextureModel()){var s=o.getColor();0===s[0]&&0===s[1]&&0===s[2]&&o.setColor(kt.vec3.ONE)}a.SpecularF0.setFactor(0),a.RoughnessPBR.setFactor(1);var u=n.BlendMode;"AlphaMask"===u?(a.Opacity.setFactor(JSON.parse(n.LambertTransparencyFactor||0)),a.Opacity.setTransparency("alphaMask")):"AdditiveBlend"===u?(a.Opacity.setFactor(1-JSON.parse(n.LambertTransparencyFactor||0)),a.Opacity.setTransparency("additive")):a.Opacity.setEnable(!1)}t.removeAttribute("Material"),i.setStateSet(t)}}));var Ft=Dt,Vt=d.a.osg,Bt=function(){yt.apply(this,arguments),this._metaMapTexture={diffuse:"DiffuseColor",specular:"SpecularColor",transparency:"Opacity"}};Vt.createPrototypeObject(Bt,Vt.objectInherit(yt.prototype,{processMaterial:function(e,t,n){var i=this.createMaterial(e,t);this.setChannelsFromMetaDataTexture(n,t,i),t.removeAttribute("Material"),i.setStateSet(t)}}));var Ut=Bt,jt=d.a.osg,Gt=function(){yt.apply(this,arguments),this._metaMapColor={kd:"DiffuseColor",ka:"EmitColor",ks:"SpecularColor"},this._metaMapFactor={ns:"SpecularHardness",tr:"Opacity",d:"Opacity"},this._metaMapTexture={map_ka:"EmitColor",map_kd:"DiffuseColor",map_occlusion:"DiffuseIntensity",map_d:"Opacity",map_ks:"SpecularColor",map_ns:"SpecularHardness",map_normal:"NormalMap",bump:"BumpMap"}};jt.createPrototypeObject(Gt,jt.objectInherit(yt.prototype,{checkOpacityFactor:function(e){var t=e.getChannels().Opacity;t.getFactor()<.001&&t.setFactor(1)},setMaterialChannelColor:function(e,t,n,i){var r=t.getChannels()[n];r.setColor&&r.setColor(i),r.setEnable(!0),"SpecularColor"===n&&r.setFactor(1)},setMaterialChannelFactor:function(e,t,n,i){var r=t.getChannels()[n];if(r.setFactor(i),r.setEnable(!0),"SpecularHardness"===n){var a=void 0!==e.ks?JSON.parse(e.ks):[0,0,0];this.setGlossinessPBRFromSpecularGlossiness(t,a,i)}},processMaterial:function(e,t,n){var i=this.createMaterial(e,t);this.setChannelsFromMetaDataColor(n,i),this.setChannelsFromMetaDataFactor(n,i),this.setChannelsFromMetaDataTexture(n,t,i),this.checkOpacityFactor(i),t.removeAttribute("Material"),i.setStateSet(t)}}));var Ht=Gt,zt=d.a.osg,Wt=function(){yt.apply(this,arguments),this._metaMapColor={kd:"DiffuseColor"},this._metaMapFactor={tr:"Opacity",d:"Opacity"}};zt.createPrototypeObject(Wt,zt.objectInherit(Ht.prototype,{isSelfIlluminationSurface:function(e){if(!e.length)return!1;var t=e[0].getImage().getURL().split("/").pop().split(".").shift();return!!(t.match("carrot_crop_(.*)")||t.match("crops_(.*)")||"fern"===t||"dead_shrub"===t||"flower_red"===t||"flower_yellow"===t||"lilypad"===t||"mushroom_brown"===t||"mushroom_red"===t||t.match("netherwart_(.*)")||t.match("potato_crop_(.*)")||t.match("sapling_(.*)")||"tall_grass"===t||"torch"===t||"torch_flame"===t)},getReferencedTextures:function(e){for(var t=[],n=0;n<e.getNumTextureAttributeLists();n++){var i=e.getTextureAttribute(n,"Texture");void 0!==i&&("PackedMaterialTexture"===i.className()&&(i=i.getTexture()),t[n]=i)}return t},setMaterialChannelTexture:function(e,t,n,i,r,a,o){e.removeTextureAttribute(n,"Texture");var s=t.getChannels()[r],u=this.createTextureOptionsFromTextureOSG(i);u&&(u.wrapT=zt.Texture[a],u.wrapS=zt.Texture[a],o&&(u.minFilter=zt.Texture.NEAREST_MIPMAP_LINEAR,u.magFilter=zt.Texture.NEAREST),s.setupTextureModel(u),s.setTexCoordUnit(0),s.setEnable(!0))},processMaterial:function(e,t,n){var i,r,a=this.createMaterial(e,t);this.setChannelsFromMetaDataColor(n,a),this.setChannelsFromMetaDataFactor(n,a),void 0!==n.ka&&(a.setChannelFactor("EmitColor",.1),a.setChannelEnable("EmitColor",!0)),a.setChannelColor("SpecularColor",zt.vec3.create()),a.setChannelEnable("SpecularColor",!0),a.setChannelFactor("SpecularHardness",1),a.setChannelEnable("SpecularHardness",!0),this.checkOpacityFactor(a);var o="mineways"===n.source,s=this.getReferencedTextures(t),u=this.isSelfIlluminationSurface(s),l=u?"CLAMP_TO_EDGE":"REPEAT";if(void 0!==n.map_kd&&void 0!==(r=s[i=JSON.parse(n.map_kd)])&&this.setMaterialChannelTexture(t,a,i,r,"DiffuseColor",l,o),u||(void 0!==n.map_ke?void 0!==(r=s[i=JSON.parse(n.map_ke)])&&(this.setMaterialChannelTexture(t,a,i,r,"EmitColor",l,o),a.setChannelFactor("EmitColor",1)):void 0!==n.map_ka?void 0!==(r=s[i=JSON.parse(n.map_ka)])&&this.setMaterialChannelTexture(t,a,i,r,"EmitColor",l,o):void 0!==(r=s[i=JSON.parse(n.map_kd)])&&(this.setMaterialChannelTexture(t,a,i,r,"EmitColor",l,o),a.setChannelFactor("EmitColor",.1))),u&&(a.set("shadeless",!0),a.setChannelFactor("EmitColor",0),a.setChannelEnable("EmitColor",!0)),void 0!==n.map_d&&void 0!==(r=s[i=JSON.parse(n.map_d)])){this.setMaterialChannelTexture(t,a,i,r,"Opacity",l,o);var c=a.getChannels().Opacity;o?(c.getTextureModel().set("internalFormat",zt.Texture.ALPHA),-1!==a.attributes.name.toLowerCase().indexOf("leaves")&&(c.setTransparency("alphaMask"),a.setChannelFactor("Opacity",.2))):(c.getTextureModel().set("internalFormat",zt.Texture.LUMINANCE),c.setTransparency("alphaBlend")),a.set("cullFace",zt.CullFace.BACK)}if(a.setChannelFactor("RoughnessPBR",1),a.setChannelFactor("SpecularF0",0),!this._lights.length){var h=new Tt;h.setLightType("DIRECTION"),zt.vec3.set(h.getDiffuse(),1,1,1),this._lights.push(h),h._worldMatrix=zt.mat4.fromRotation(zt.mat4.create(),Math.PI/6,zt.vec3.fromValues(1,1,0))}t.removeAttribute("Material"),a.setStateSet(t)}}));var qt=Wt,Xt=d.a.osg,Yt=function(){yt.apply(this,arguments),this._textureFactor1=!0,this._metaMapColor={DiffuseColor:"DiffuseColor",SpecularPBRColor:"SpecularPBR",EmissiveColor:"EmitColor"},this._metaMapFactor={DiffuseFactor:"DiffuseColor",EmissiveFactor:"EmitColor",MetallicFactor:"MetalnessPBR",RoughnessFactor:"RoughnessPBR",GlossinessPBRFactor:"GlossinessPBR",SpecularPBRFactor:"SpecularPBR",AOFactor:"AOPBR",NormalFactor:"NormalMap"},this._metaMapTexture={sDiffuse:"DiffuseColor",sMetallic:"MetalnessPBR",sRoughness:"RoughnessPBR",sSpecularPBR:"SpecularPBR",sGlossinessPBR:"GlossinessPBR",sNormalMap:"NormalMap",sEmissive:"EmitColor",sOpacity:"Opacity",sAO:"AOPBR"}};Xt.createPrototypeObject(Yt,Xt.objectInherit(yt.prototype,{setMaterialChannelColor:function(e,t,n,i){var r=t.getChannels()[n];r.getTextureModel()||(r.setColor&&r.setColor(i),r.setFactor(1))},checkWorkflowPBR:function(e){e.sMetallic||e.MetallicFactor||!e.sSpecularPBR&&!e.SpecularPBRColor&&!e.SpecularPBRFactor?this._hasMetal=!0:void 0===this._hasMetal&&(this._hasMetal=!1)},checkWorkflowRoughGloss:function(e){e.RoughnessPBR||e.RoughnessFactor||!e.GlossinessPBR&&!e.GlossinessPBRFactor?this._globalEnforceRoughness=!0:void 0===this._globalEnforceRoughness&&(this._globalEnforceRoughness=!1)},checkAlphaMode:function(e,t){var n=t.getChannels();if(e.alphaMode&&"OPAQUE"!==e.alphaMode){var i=n.Opacity;if(this.hasTextureChannel(t,"DiffuseColor")){var r=n.DiffuseColor,a=r.getTextureModel().clone();if(!a||!a.getImageModel()||!a.getImageModel().get("alpha"))return void i.setEnable(!1);a.set("internalFormat",Xt.Texture.ALPHA),a.updateMultiresTexture(),i.setTextureModel(a),i.setTexCoordUnit(r.getTexCoordUnit())}"BLEND"===e.alphaMode?i.setFactor(JSON.parse(e.OpacityFactor||1)):"MASK"===e.alphaMode&&(i.setTransparency("alphaMask"),i.setFactor(JSON.parse(e.alphaCutoff||.5))),i.setEnable(!0)}},checkNormalMap:function(e,t){t.getChannels().NormalMap.set("flipY",void 0!==e.yUp&&!1===JSON.parse(e.yUp))},checkCullFace:function(e,t){void 0!==e.doubleSided&&!1!==JSON.parse(e.doubleSided)||t.set("cullFace",Xt.CullFace.BACK)},processMaterial:function(e,t,n){var i=this.createMaterial(e,t);this.checkWorkflowPBR(n),this.checkWorkflowRoughGloss(n),this.setChannelsFromMetaDataTexture(n,t,i),this.setChannelsFromMetaDataFactor(n,i),this.setChannelsFromMetaDataColor(n,i),this.checkAlphaMode(n,i),this.checkNormalMap(n,i),this.checkCullFace(n,i),i.getChannels().AOPBR.set("occludeSpecular",!0),this.copyDiffuse(i),t.removeAttribute("Material"),i.setStateSet(t)}}));var Kt={default:Lt,wavefront:Ht,blender:At,ksp:At,lightwave:Ut,minecraft:qt,collada:Pt,fbx:Ft,substancepainter:Pt,mineways:qt,gltf:Yt},Qt=n("h/Nh"),Jt=function(e){this._materialManager=e};Jt.prototype={apply:function(e){var t=new ot;e.accept(t);var n=t.getSource(),i=t.getAuthoringTool();n=n?n.toLowerCase():"default";var r=new(Kt[n]?Kt[n]:Kt.default)(this._materialManager,i,n);e.accept(r),Object(Qt.a)()&&r.handleSingleMaterialMapping();var a=!f.a.hasTriangles&&!f.a.hasVertexNormals;("q3d"===n||a)&&(r._style="shadeless");var o=e.getUserData()||[];return o.push({Name:"source",Value:n}),o.push({Name:"authoringTool",Value:i}),o.push({Name:"sourceTool",Value:t.getSourceTool()}),e.setUserData(o),e.userDataMap=f.a.convertUserDataToObject(o),r}};var Zt=Jt,$t=d.a.osg,en=function(){$t.NodeVisitor.call(this,$t.NodeVisitor.TRAVERSE_ALL_CHILDREN),this._paths=[],this._pathsStateSet=[],this._currentStateSet=[],this._stateSetMap={},this._stateSetMapNodes={},this._wireframePaths=[],this._noGeometryPaths=[],this.nodeMaskOverride=-1};$t.createPrototypeObject(en,$t.objectInherit($t.NodeVisitor.prototype,{getPathList:function(){return this._paths},getStateSetMap:function(){return this._stateSetMap},getStateSetMapNodes:function(){return this._stateSetMapNodes},getStateSetPathList:function(){return this._pathsStateSet},getWireframePathList:function(){return this._wireframePaths},getNoGeometryPathList:function(){return this._noGeometryPaths},apply:function(e){var t=e.getStateSet();if(t){var n=t._uniqueID;this._stateSetMap[n]||(this._stateSetMap[n]=t,this._stateSetMapNodes[n]=[]),this._stateSetMapNodes[n].push(e),this._currentStateSet.push(t)}e instanceof $t.Geometry?e.userDataMap&&e.userDataMap.wireframe?this._wireframePaths.push(this.nodePath.slice(0)):(this._pathsStateSet.push(this._currentStateSet.slice(0)),this._paths.push(this.nodePath.slice(0))):(this.traverse(e),0===e.getChildren().length&&this._noGeometryPaths.push(this.nodePath.slice(0))),t&&this._currentStateSet.pop()}}));var tn=en,nn=n("JBIC"),rn=n("kZIE"),an=n("dtSa"),on=n("drU4"),sn=n("a5Z4"),un=d.a.osg,ln=d.a.osgAnimation,cn=function(){un.NodeVisitor.call(this),this._stats={nodeCount:0,matrixTransformCount:0,geometryCount:0,boneCount:0,skeletonCount:0,morphGeometryCount:0,rigGeometryCount:0}},hn=new it.a;cn.stats=window.sketchfabViewerStats={promiseReady:hn.promise,materialCountBefore:0,materialCountAfter:0,nodeCountBefore:0,nodeCountAfter:0,matrixTransformCountBefore:0,matrixTransformCountAfter:0,geometryCountBefore:0,geometryCountAfter:0,boneCountBefore:0,boneCountAfter:0,skeletonCountBefore:0,skeletonCountAfter:0,morphGeometryCountBefore:0,morphGeometryCountAfter:0,rigGeometryCountBefore:0,rigGeometryCountAfter:0},cn.registerStats=function(e,t){var n=new cn;e.accept(n);var i=n.getStats(),r=cn.stats;r["nodeCount"+t]=i.nodeCount,r["matrixTransformCount"+t]=i.matrixTransformCount,r["geometryCount"+t]=i.geometryCount,r["boneCount"+t]=i.boneCount,r["skeletonCount"+t]=i.skeletonCount,r["morphGeometryCount"+t]=i.morphGeometryCount,r["rigGeometryCount"+t]=i.rigGeometryCount};var dn=function(e){for(var t=["geometry","rigGeometry","morphGeometry"],n=0,i=0;i<t.length;++i)n+=cn.stats[t[i]+e];return n};cn.computeStats=function(e){if(!Object(ze.a)()&&!window.RunningTests){var t=cn.stats;if(Object(u.a)().graphOptimizer){var n=dn("CountBefore"),i=dn("CountAfter");sn.default.logMessage("Geometry count : before "+n+", after "+i)}if(Object(u.a)().mergeMaterials){var r="Material count : before ";r+=t.materialCountBefore,r+=", after ",r+=t.materialCountAfter,sn.default.logMessage(r)}var a=e.getFeatures(),o=a.animation.getModel(),s=a.environment.getModel(),l=a.lighting.getModel(),c=o.getEnabledAnimationsCount(),h=0,d=0,f=0;if(rn.a.get("mask")&rn.a.LIT){for(var p=l.get("lights"),g=0,m=p.length;g<m;++g){var v=p[g];v&&v.get("enable")&&"NONE"!==v.get("type")&&(f++,v.isCastingShadows()&&(d++,(c||v.isAttachedToCamera())&&h++))}s.get("enable")&&(f++,s.get("shadowEnable")&&(f++,d++,c&&h++)),t.pbr=rn.a.get("mask")&rn.a.PBR?1:0}t.lights=f,t.shadows=d,t.realTimeShadows=h,t.vertexCount=e._currentScene._dataScene.vertexCount;var _=t.materialCountAfter/10;_*=f>0&&t.pbr?t.lights+t.shadows:1,_*=t.transparent?4:1;var b=0;b+=t.boneCountAfter/35,b+=t.morphGeometryCountAfter/2,b+=t.geometryCountAfter/5,b+=t.vertexCount/15e4,b+=t.matrixTransformCountAfter/50,b+=t.nodeCountAfter/100;var S=_+(b*=t.realTimeShadows>0?t.realTimeShadows+1:1);t.complexity=S,t.shadingComplexity=_,t.meshComplexity=b,hn.resolve(t)}};var fn=un.Node.typeID,pn=un.MatrixTransform.typeID,gn=ln.Bone.typeID,mn=ln.Skeleton.typeID,vn=un.Geometry.typeID,_n=ln.MorphGeometry.typeID,bn=ln.RigGeometry.typeID;un.createPrototypeObject(cn,un.objectInherit(un.NodeVisitor.prototype,{getStats:function(){return this._stats},apply:function(e){var t=this._stats,n=e.typeID;e.userDataMap&&e.userDataMap.wireframe||(n===fn?t.nodeCount++:n===pn?t.matrixTransformCount++:n===vn?t.geometryCount++:n===gn?t.boneCount++:n===mn?t.skeletonCount++:n===_n?t.morphGeometryCount++:n===bn?(t.rigGeometryCount++,e.getSourceGeometry().typeID===_n&&t.morphGeometryCount++):console.error("Unknown node type ID : "+n+" "+e.className()),this.traverse(e))}}));var Sn=cn,yn=d.a.osg,xn=yn.WebGLCaps.instance().getWebGLExtension("OES_element_index_uint")?4294967296:65535,Cn={splitLimit:Math.min(Object(u.a)().splitLimit,xn),limitMergePerMaterial:100,canMergeGeometry:!0,isWireframe:!1,bakedGeometriesFromID:{},hasTransparency:!0,multiParentPathFromGeometryID:{},protectedGeometries:{}},wn={};wn[yn.primitiveSet.POINTS]=!0,wn[yn.primitiveSet.LINES]=!0,wn[yn.primitiveSet.TRIANGLES]=!0;var Tn={};Tn[yn.primitiveSet.POINTS]=!0,Tn[yn.primitiveSet.LINES]=!0,Tn[yn.primitiveSet.TRIANGLES]=!0,Tn[yn.primitiveSet.TRIANGLE_STRIP]=!0;var Mn={Vertex:1,Normal:1,Tangent:1},En=function(e){var t=e.getStateSet();return t&&t.getAttribute("SketchfabMaterial")?t:void 0},An=function(e,t){var n=e[e.length-1].getVertexAttributeList().Vertex;return t[t.length-1].getVertexAttributeList().Vertex.getElements().length-n.getElements().length},On=function(e){return e.getVertexAttributeList().Vertex.getElements().length/3},Rn=function(e){return e[e.length-1].getVertexAttributeList().Vertex.getElements().length/3},Pn=function(e){var t=e[e.length-1].getInstanceID(),n=Cn.multiParentPathFromGeometryID;return Boolean(n[t])},In=function(e,t){t.xmin<e.xmin&&(e.xmin=t.xmin),t.ymin<e.ymin&&(e.ymin=t.ymin),t.zmin<e.zmin&&(e.zmin=t.zmin),t.xmax>e.xmax&&(e.xmax=t.xmax),t.ymax>e.ymax&&(e.ymax=t.ymax),t.zmax>e.zmax&&(e.zmax=t.zmax)},Nn=function(e,t){var n=Math.min(e.xmax-e.xmin,t.xmax-t.xmin),i=Math.min(e.ymax-e.ymin,t.ymax-t.ymin),r=Math.min(e.zmax-e.zmin,t.zmax-t.zmin);return In(e,t),n=0===n?0:(e.xmax-e.xmin)/n,i=0===i?0:(e.ymax-e.ymin)/i,r=0===r?0:(e.zmax-e.zmin)/r,Math.max(n,i,r)>Object(u.a)().zratio},Ln=function(e,t,n){if(!t._FQU){var i=e.getElements().length,r=Math.min(i,t.getElements().length-n);t._boxTest||(t._boxTest=t.computeMinMaxVertex({},0,n));var a=t.computeMinMaxVertex({},n,r);t._FQU=Nn(t._boxTest,a)}},kn=function(e,t,n){var i=e.getElements(),r=t.getElements(),a=e.getItemSize(),o=t.getItemSize();if(a!==o)for(var s=r.length/o,u=0;u<s;++u){var l=u*a,c=u*o;i[n+l]=r[c],i[n+l+1]=r[c+1],i[n+l+2]=r[c+2]}else i.set(r,n)},Dn=function(e,t,n){var i=t.getVertexAttributeList().Vertex,r=e.getVertexAttributeList().Vertex.getElements(),a=i.getElements();i.setElements(r.subarray(n,n+a.length)),e._boundingBox.copy(t.getBoundingBox()),e._boundingBoxComputed=!0;var o=t.getBoundingSphere(),s=e._boundingSphere;s.set(yn.vec3.copy(s.center(),o.center()),o.radius()),e._boundingSphereComputed=!0,i.setElements(a),t.dirtyBound()},Fn=function(e,t,n,i){var r=Cn.bakedGeometriesFromID[t.getInstanceID()];if(r||(Cn.bakedGeometriesFromID[n.getInstanceID()]=!0),r||function(e){return 9===e.length?yn.mat3.equals(yn.mat3.IDENTITY,e):yn.mat4.equals(yn.mat4.IDENTITY,e)}(e))n!==t&&kn(n,t,i||0);else{var a=n.getElements();i&&(a=a.subarray(i));for(var o=t.getElements(),s=9===e.length?yn.vec3.transformMat3:yn.vec3.transformMat4,u=t.getItemSize(),l=yn.vec3.create(),c=Math.min(o.length,a.length),h=0;h<c;h+=u)l[0]=o[h],l[1]=o[h+1],l[2]=o[h+2],s(l,l,e),a[h]=l[0],a[h+1]=l[1],a[h+2]=l[2],4===u&&(a[h+3]=o[h+3])}},Vn=function(e,t,n,i){var r=n.getIndices().getElements(),a=n.getCount(),o=0,s=n.getMode(),u=e[s].primitive,l=u.getIndices().getElements(),c=u.getCount(),h=Tn[s]&&Cn.canMergeGeometry,d=c;if(s===yn.primitiveSet.TRIANGLE_STRIP&&h){var f=c>0,p=f?l[c-1]:void 0,g=r[0]+i,m=f&&p!==g?2:0;m&&(l[c]=p,l[c+1]=g);var v=c%2;v&&(l[c+m]=g),d+=m+v}l.set(r,d),u.setCount(d+a);var _=d+a;for(o=d;o<_;++o)l[o]+=i;h||(n.setIndices(u.getIndices()),n.setCount(a),n.setFirst(d*l.BYTES_PER_ELEMENT),Cn.canMergeGeometry&&t.push(n))},Bn=function(e,t,n,i){for(var r=n.length,a=Cn.canMergeGeometry,o=e.DrawElements,s=e.DrawArrays,u=0;u<r;++u){var l=n[u],c=l.getMode();if(l instanceof yn.DrawElements)Vn(o,t,l,i);else if(l instanceof yn.DrawArrays){var h=s[c];if(a)if(h&&h.primitive.count===i&&0===l.getFirst())h.primitive.count+=l.getCount();else{var d=l.getFirst()+i;t.push(new yn.DrawArrays(c,d,l.getCount()))}else l.first+=i}else if(l instanceof yn.DrawArrayLengths)if(a){var f=l.getFirst()+i,p=l.getArrayLengths().slice();t.push(new yn.DrawArrayLengths(c,f,p))}else l.first+=i}},Un=function(e,t){var n=e.getElements(),i=n.BYTES_PER_ELEMENT;e.setNormalize(4!==i);var r=1;1===i?r=255:2===i&&(r=65535);for(var a=n.length,o=t*e.getItemSize();o<a;++o)n[o]=r},jn=function(e,t){var n=new yn.Geometry;return n.setName(t.getName()),function(e,t,n){if(Pn(e))for(var i=0,r=n.length;i<r;++i){var a,o=n[i],s=o.getMode(),u=o.getFirst();if(o instanceof yn.DrawElements){var l=o.getIndices(),c=l.getElements(),h=new c.constructor(c),d=l.getItemSize(),f=new yn.BufferArray(yn.BufferArray.ELEMENT_ARRAY_BUFFER,h,d);a=new yn.DrawElements(s,f)}else o instanceof yn.DrawArrays?a=new yn.DrawArrays(s,u,o.getCount()):o instanceof yn.DrawArrayLengths&&(a=new yn.DrawArrayLengths(s,u,o.getArrayLengths().slice()));t.push(a)}else Array.prototype.push.apply(t,n)}(e,n.getPrimitiveSetList(),t.getPrimitiveSetList()),n},Gn=function(e,t,n){var i=t[t.length-1],r=e.getVertexAttributeList(),a=i.getVertexAttributeList(),o=yn.computeLocalToWorld(t),s=yn.mat3.create();for(var u in yn.mat3.normalFromMat4(s,o),a){var l=r[u],c=a[u],h=n*l.getItemSize();if(Mn[u])Fn("Vertex"===u?o:s,c,l,h),"Vertex"===u&&Ln(c,l,h);else kn(l,c,h)}},Hn=function(e,t,n){for(var i in t)if(!e[i]){var r=t[i].getItemSize(),a="Color"===i,o=new(a?t[i].getElements().constructor:Float32Array)(n*r),s=new yn.BufferArray(yn.BufferArray.ARRAY_BUFFER,o,r);e[i]=s,a&&Un(s,0)}},zn=function(e,t,n,i){for(var r=t.DrawElements,a=t.DrawArrays,o=Cn.canMergeGeometry,s=0,u=n.length;s<u;++s){var l=n[s],c=l.getMode();if(l instanceof yn.DrawElements){var h=r[c];if(!h){var d=l.getIndices().getItemSize(),f=new yn.BufferArray(yn.BufferArray.ELEMENT_ARRAY_BUFFER,new Uint16Array,d);h=r[c]={primitive:new yn.DrawElements(c,f),lastElement:-1,initCount:0},o&&e.push(h.primitive)}var p=h.primitive;if(c===yn.primitiveSet.TRIANGLE_STRIP&&Tn[c]&&o){var g=l.getIndices().getElements(),m=g[0]+i,v=h.lastElement!==m&&0!==p.getCount()?2:0,_=p.getCount()%2;p.setCount(p.getCount()+l.getCount()+v+_),h.lastElement=g[g.length-1]+i}else p.setCount(p.getCount()+l.getCount())}else l instanceof yn.DrawArrays&&wn[c]&&o&&(a[c]||(a[c]={primitive:new yn.DrawArrays(c,0,0),initCount:0},e.push(a[c].primitive)))}},Wn=function(e,t,n,i){for(var r=e.getVertexAttributeList(),a=e.getPrimitiveSetList(),o=On(e),s=i,u=0,l=t.length;u<l;++u){var c=t[u],h=c[c.length-1];Hn(r,h.getVertexAttributeList(),o),zn(a,n,h.getPrimitiveSetList(),s),s+=Rn(c)}!function(e,t){for(var n in e){var i=e[n].primitive,r=i.getIndices(),a=r.getElements(),o=t>=65535?Uint32Array:Uint16Array;r.setElements(new o(i.getCount())),r.getElements().set(a),i.setIndices(r),i.setCount(a.length)}}(n.DrawElements,o)},qn=function(e,t){var n=e.pathList,i=n.pop(),r=On(i[i.length-1]),a=function(e,t,n){var i=e[e.length-1],r=jn(e,i),a=yn.computeLocalToWorld(e),o=yn.mat3.create();yn.mat3.normalFromMat4(o,a);var s=function(e,t){var n=t.getVertexAttributeList().Color;if(n&&4===n.getItemSize())return 4;for(var i=0,r=e.length;i<r;++i){var a=e[i],o=a[a.length-1].getVertexAttributeList().Color;if(o&&4===o.getItemSize())return 4}return 3}(n,i),u=t!==On(i),l=Pn(e),c=r.getVertexAttributeList(),h=i.getVertexAttributeList();for(var d in h){var f,p=h[d],g=Mn[d],m="Color"===d,v=m?s:p.getItemSize();if(u?f=new(m?p.getElements().constructor:Float32Array)(t*v):g&&l?f=new Float32Array(p.getElements().length):c[d]=p,f){var _=new yn.BufferArray(yn.BufferArray.ARRAY_BUFFER,f,v);m&&Un(_,p.getElements().length/p.getItemSize()),c[d]=_,g||kn(_,p,0)}g&&Fn("Vertex"===d?a:o,p,c[d],0)}return Cn.canMergeGeometry||Dn(r,i,0),r}(i,e.nbVertex,n);if(t.addChild(a),0!==n.length){var o=a.getPrimitiveSetList(),s=function(e){for(var t={DrawElements:{},DrawArrays:{}},n=Cn.canMergeGeometry,i=0,r=e.length;i<r;++i){var a=e[i],o=a.getMode();if(a instanceof yn.DrawElements){var s=a.getIndices().getElements();t.DrawElements[o]={primitive:a,lastElement:s[s.length-1],initCount:a.getCount()}}else a instanceof yn.DrawArrays&&wn[o]&&n&&(t.DrawArrays[o]={primitive:a,first:a.getFirst(),initCount:a.getCount()})}return t}(o);Wn(a,n,s,r);for(var u=Cn.canMergeGeometry,l=0,c=n.length;l<c;++l){var h=n[l];Gn(a,h,r);var d=h[h.length-1];if(!u||Pn(h)){var f=jn(h,d);u||(f._attributes=a.getVertexAttributeList(),t.addChild(f),Dn(f,d,3*r)),d=f}var p=d.getPrimitiveSetList();Bn(s,o,p,r),r+=Rn(h)}!function(e){var t=e.DrawElements,n=Cn.canMergeGeometry;for(var i in t){var r=t[i];n&&Tn[i]||r.primitive.setCount(r.initCount)}}(s)}},Xn=function(e){var t=e.localRoot;e.renderPathList.sort(An);for(var n=function(e){for(var t=[{nbVertex:Rn(e[0]),pathList:[e[0]]}],n=e.length,i=1;i<n;++i){for(var r=e[i],a=t[t.length-1],o=Rn(r),s=!1,u=r[r.length-1]._primitives,l=0;l<u.length;l++)if(u[l].getMode()===yn.primitiveSet.TRIANGLES&&u[l].getCount()%3!=0){console.error("incorrect number ("+u[l].getCount()+") in Triangles IndexBuffer"),s=!0;break}s||(o+a.nbVertex>=Cn.splitLimit?t.push({nbVertex:o,pathList:[r]}):(a.nbVertex+=o,a.pathList.push(r)))}return t}(e.renderPathList),i=n.length,r=0;r<i;++r)qn(n[r],t)},Yn=function(e,t){for(var n=e.getAttribute("SketchfabMaterial").getMaterialModel(),i=n.get(Cn.isWireframe?"wireframeList":"geometryList"),r=Cn.protectedGeometries,a=[],o=0,s=i.length;o<s;++o){var u=i[o];r[u.getInstanceID()]&&a.push(u)}i.length=0,Array.prototype.push.apply(i,a),Array.prototype.push.apply(i,t.getChildren()),Cn.isWireframe&&n.getChannels().Displacement.updateGeometryOffsets(),function(e){if(!Cn.isWireframe)for(var t={xmin:1/0,ymin:1/0,zmin:1/0,xmax:-1/0,ymax:-1/0,zmax:-1/0},n=Cn.bakedGeometriesFromID,i={},r=0,a=e.length;r<a;++r){var o=e[r].getVertexAttributeList().Vertex;n[o.getInstanceID()]&&(o._minMax||(o._minMax=t,o.computeMinMaxVertex(i),t.xmin===1/0||t._FQU||o._FQU?(o._FQU&&(t._FQU=!0),In(t,i)):t._FQU=Nn(t,i)))}}(i)},Kn=function(e){var t=e.localRoot,n=t.getStateSet(),i=n&&function(e){return e===Se.a.TRANSPARENT}(n.getBinNumber());i&&(Cn.hasTransparency=!0),Cn.canMergeGeometry=!i,e.renderPathList.length>Cn.limitMergePerMaterial&&(Cn.canMergeGeometry=!0),Xn(e),Yn(n,t)},Qn=function(e,t,n){var i=function(e,t){for(var n=t||0,i=e.length-1;i>=n;--i){var r=En(e[i]);if(r)return r}}(e),r=i.getInstanceID(),a=t[r];a||(t[r]=a={localRoot:new yn.Node,renderPathList:[]},a.localRoot.setStateSet(i),a.localRoot.setName(i.getName()),n.addChild(a.localRoot)),a.renderPathList.push(e),e[0]===n&&e.shift()};Cn.optimizePaths=function(e,t,n){Cn.isWireframe=!!n;for(var i={},r=t.length,a=0;a<r;++a)Qn(t[a],i,e);for(var o in i)Kn(i[o])},Cn.optimizeWireframe=function(e,t,n){var i=e.getChildren(),r=i.length;Cn.optimizePaths(e,t,!0);for(var a=i.length,o=r;o<a;++o)n.push(i[o])};var Jn,Zn,$n=Cn,ei=d.a.osg,ti=d.a.osgAnimation,ni={},ii=function(e){var t=e.getStateSet();return t&&t.getAttribute("SketchfabMaterial")?t:void 0},ri=function(e,t){for(var n=t||0,i=e.length-1;i>=n;--i){var r=ii(e[i]);if(r)return r}},ai=function(e){for(var t=0,n=e.length;t<n;++t)e[t].removeChildren()},oi=function(e){for(var t=0,n=e.length-1;t<n;++t)e[t].addChild(e[t+1])},si=function(e){for(var t=e.length,n=0;n<t;++n)ai(e[n])},ui=function(e){for(var t=!1,n=ni,i=0,r=e.length;i<r;++i){var a,o=e[i],s=!1;if(o instanceof ti.Bone)a=ti.UpdateBone;else{if(!(o instanceof ei.MatrixTransform))continue;a=ti.UpdateMatrixTransform,s=!0}for(var u=o.getUpdateCallbackList(),l=u.length-1;l>=0;--l){var c=u[l];c instanceof a!=!1&&(n[c.getName()]||!s?t=!0:(c.update(o),o.removeUpdateCallback(c)))}}var h=e[e.length-1];return t||h instanceof ti.RigGeometry||h instanceof ti.MorphGeometry},li=function(){var e=[];return function(t){return e[0]=t,ui(e)}}();d.a.osgDB.Input.prototype.getJSON=function(){return Zn=this,this._json.Animations&&(Jn=this._json),this._json};var ci=function(e,t,n){for(var i=t.length-1;i>=0;--i){var r=t[i],a=r.length,o=r[a-1],s=o._uniqueID;if(o.getVertexAttributeList&&(s=o.getVertexAttributeList().Vertex.getInstanceID()),e[o._uniqueID]||e[s])e[s]=!0,n.push(r),t.splice(i,1);else if(o instanceof ei.Geometry||o instanceof ti.Bone)ui(r)&&(n.push(r),t.splice(i,1));else{for(var u=a-2;u>=0;--u)if(r[u]instanceof ti.Bone){n.push(r);break}t.splice(i,1)}}},hi=function(e){for(var t=$n.protectedGeometries,n=0,i=e.length;n<i;++n){var r=e[n],a=r[r.length-1];a instanceof ei.Geometry&&(t[a.getInstanceID()]=!0)}},di=function(e){for(var t=$n.multiParentPathFromGeometryID,n=0,i=e.length;n<i;++n){for(var r=e[n],a=!1,o=0,s=r.length;o<s;++o)if(r[o].getParents().length>1){a=!0;break}t[r[r.length-1].getInstanceID()]=a}},fi=function(e,t){var n=e.length;if(0!==n)for(var i=e[0].indexOf(t),r=t.getStateSet()?0:1,a=0;a<n;++a){e[a].splice(0,i+r)}},pi=function(e){for(var t=e.getUpdateCallbackList(),n=0,i=t.length;n<i;++n){var r=t[n];if(r instanceof ti.BasicAnimationManager)return e.removeUpdateCallback(r),r}},gi=function(e,t){!function(e){var t,n=e.getFeatures().material.getModel().attributes,i={},r=nn.a.length;for(var a in n){var o=n[a];if(!o.get("uidUniqueMerged")){var s=o.get("texCoordUnitList");s.length=0;var u=o.getChannels();for(t=0;t<r;++t){var l=nn.a[t],c=u[l];if(c.isEnableEffective()&&c.getTextureModel()&&"Matcap"!==l){var h=c.getTexCoordUnit();-1===s.indexOf(h)&&s.push(h)}}var d=o.get("geometryList"),f=d.length;for(t=0;t<f;++t){var p=d[t],g=i[p.getInstanceID()];if(g)for(var m=s.length,v=0;v<m;++v)-1===g.uvList.indexOf(s[v])&&g.uvList.push(s[v]);else i[p.getInstanceID()]={geometry:p,uvList:s.slice()}}}}for(var _ in i){var b=i[_],S=b.uvList,y=b.geometry.getVertexAttributeList();for(var x in y)-1!==x.indexOf("TexCoord")&&-1===S.indexOf(parseInt(x.substring(8)))&&delete y[x]}}(t);var n=t.getOrCreateScene().getWireframeNodes();n.length=0;var i=[],r=[],a=e.getPathList(),o=e.getWireframePathList();!function(e){var t=ni;if(!Jn||!Jn.Animations||k.a.OSG_VERSION<8)return t;for(var n=e.getFeatures().animation.getModel(),i=Jn.Animations,r=0,a=i.length;r<a;++r){var o=i[r]["osgAnimation.Animation"],s=Zn.setJSON(o.UserDataContainer).readUserDataContainer(),u=f.a.convertUserDataToObject(s);if(n.getAnimationByUID(u.AnimationUID))for(var l=o.Channels,c=0,h=l.length;c<h;++c){var d=l[c];t[d[Object.keys(d)[0]].TargetName]=1}}}(t);var s=function(e){for(var t,n,i=e.getPathList(),r=i[0][0],a=r,o=[];;){t=ii(a)||t,n=n||pi(a);var s=a.getChildren();if(1!==s.length)break;if(s[0]instanceof ti.Skeleton)break;if(s[0]instanceof ei.Geometry)break;if(li(a))break;o.push(a),a=s[0]}if(r.removeChildren(),n&&r.addUpdateCallback(n),r===a)return a;for(var u=a.getParents(),l=0,c=u.length;l<c;++l)u[l].removeChild(a);r.setStateSet(void 0),a.setStateSet(t);var h=ei.computeLocalToWorld(o);if(ei.mat4.equals(ei.mat4.IDENTITY,h))r.addChild(a);else{var d=new ei.MatrixTransform;d.setName("Optim - RootMatrix"),ei.mat4.copy(d.getMatrix(),h),r.addChild(d),d.addChild(a)}return fi(i,a),fi(e.getWireframePathList(),a),fi(e.getNoGeometryPathList(),a),a}(e);if(function(e){di(e.getPathList()),di(e.getNoGeometryPathList()),di(e.getWireframePathList())}(e),s.removeChildren(),function(e){si(e.getPathList()),si(e.getNoGeometryPathList()),si(e.getWireframePathList())}(e),function(e,t,n,i){var r=function(e){var t=e.getFeatures(),n=t.hotspot.getModel().get("hotspots"),i=n.length,r={},a=0;for(a=0;a<i;++a){var o=n.at(a).get("geometryUid");o>=0&&(r[o]=!0)}var s=t.sound.getModel().get("soundtracks"),u=s.length;for(a=0;a<u;++a){var l=s.at(a).get("geometryUid");l>=0&&(r[l]=!0)}return r}(e);ci(r,t.getPathList(),n),ci(r,t.getNoGeometryPathList(),n),ci(r,t.getWireframePathList(),i),hi(n),hi(i)}(t,e,i,r),$n.optimizePaths(s,a),function(e,t,n,i){var r=0,a=e.length,o=n.length,s=!1;for(r=a-1;r>=0;--r){var u=e[r];oi(u);var l=u[0]===t;ri(u,l?1:0)||(s=!0),l||t.addChild(u[0])}for(r=o-1;r>=0;--r){var c=n[r];oi(c),i.push(c[c.length-1]),c[0]!==t&&t.addChild(c[0])}s||t.setStateSet(void 0)}(i,s,r,n),o.length>0){var u=n.slice(0);k.a.getWireframe().then(function(){for(var e=n.length=u.length,t=0;t<e;++t)n[t]=u[t];ei.time("optimizer - wireframe"),$n.optimizeWireframe(s,o,n),ei.timeEnd("optimizer - wireframe"),k.a.resolveWireframeOptimized()})}else k.a.getWireframe().then(function(){k.a.resolveWireframeOptimized()})},mi=function(e,t){for(var n=t.length,i=0;i<n;++i)-1===e.indexOf(t[i])&&e.push(t[i]);t.length=0},vi={};vi.reports=Sn.stats,vi.optimize=function(e,t){Object(u.a)().graphOptimizer||k.a.getWireframe().then(k.a.resolveWireframeOptimized);var n=t.getRootModel();Object(u.a)().graphOptimizer||Object(u.a)().mergeMaterials?(ei.time("optimizer"),Sn.registerStats(n,"Before"),Object(u.a)().mergeMaterials&&(ei.time("optimizer - materials"),function(e){var t=e.getFeatures().material.getModel().attributes,n={},i={},r=nn.a.length,a=0;for(var o in t){var s=t[o],u=s.get("stateSet");if(!u)return;var l=s.getChannels(),c=rn.a.get("mask"),h=[];h.push(s.get("cullFace")?1:0),h.push(s.hasOnlyPoints()?1:0),c&rn.a.LIT&&h.push(s.get("shadeless")?1:0),c===rn.a.CLASSIC_LIT&&h.push(s.get("reflection")),c!==rn.a.MATCAP&&h.push(s.get("hasVertexColor")?1:0),l.Opacity.isEffective()&&h.push(s.get("hasVertexAlpha")?1:0);for(var d=0;d<r;++d){var f=nn.a[d],p=l[f];if(p.isEnableEffective()){var g=p.isEffective()?JSON.stringify(p.getJSON()):p.getFactor();h.push(f+g)}}var m=n[h=h.join(" / ")];if(m){i[u.getInstanceID()]=m.get("stateSet"),a++,m.get("uidListUnusedDuplicates").push(s.get("id")),s.set("uidUniqueMerged",m.get("id"));var v=s.get("stateSetWireframe");if(v){var _=m.get("stateSetWireframe");i[v.getInstanceID()]=_}mi(m.get("geometryList"),s.get("geometryList")),mi(m.get("wireframeList"),s.get("wireframeList")),s.get("texCoordUnitList").length=0}else n[h]=s}var b=Object.keys(i).length,S=Object.keys(t).length;if(Sn.stats.materialCountBefore=S,Sn.stats.materialCountAfter=S-a,0!==b){var y=function(){ei.NodeVisitor.call(this)};ei.createPrototypeObject(y,ei.objectInherit(ei.NodeVisitor.prototype,{apply:function(e){var t=e.getStateSet();if(t){var n=i[t.getInstanceID()];n&&e.setStateSet(n)}this.traverse(e)}}));var x=e.getRootModel(),C=new y;C.setNodeMaskOverride(-1),x.accept(C)}}(t),ei.timeEnd("optimizer - materials")),Object(u.a)().graphOptimizer&&(ei.time("optimizer - nodes"),gi(e,t),ei.timeEnd("optimizer - nodes"),Sn.stats.transparent=$n.hasTransparency),Sn.registerStats(n,"After"),Sn.computeStats(t),ei.timeEnd("optimizer")):Sn.registerStats(n,"Stats")};var _i=vi,bi=n("tNdj"),Si=new bi.a({hasTransparency:!1,hasScattering:!1,hasRefraction:!1,hasExtra:!1,protectDepthAndColorUnit:!1}),yi=function(e,t,n){var i=t.getInstanceID();!!e.activeStateSets[i]!==n&&(e.activeStateSets[i]=n,e.count+=n?1:-1,Si.set(e.modelkey,e.count>0))};Si.registerStateSetIsTransparent=yi.bind(yi,{modelkey:"hasTransparency",activeStateSets:{},count:0}),Si.registerStateSetIsScattering=yi.bind(yi,{modelkey:"hasScattering",activeStateSets:{},count:0}),Si.registerStateSetIsRefraction=yi.bind(yi,{modelkey:"hasRefraction",activeStateSets:{},count:0});var xi=!1,Ci=!1,wi=!1,Ti=!1,Mi=!1,Ei=!1,Ai=function(){Si.set("hasExtra",Mi||Ti||xi||Ci||wi||Ei||Object(u.a)().debug3D||Object(o.a)()||!Object(u.a)().vrStereo)};Si.setHotspot=function(e){Ci=e,Ai()},Si.setWireframe=function(e){xi=e,Ai()},Si.setGizmo=function(e){wi=e,Ai()},Si.setDebugNormal=function(e){Ti=e,Ai()},Si.setOutline=function(e){Ei=e,Ai()},Si.setDebugSkeleton=function(e){Mi=e,Ai()},Ai();var Oi=Si,Ri=d.a.osg,Pi=D.a.extend({getName:function(){return"MaterialManagerView3D"},initialize:function(){D.a.prototype.initialize.apply(this,arguments),this.model.bind("change",this.render,this),rn.a.bind("change:mask",this.cleanAndApplyMaterials,this),this._sceneLights=[],this._defaultStateSet=void 0,this._defaultMaterial=void 0,this._tracePathVisitor=new tn,this.model.setImageCollection(this.getTextureCollection()),this.model.setMatcapCollection(this.getMatcapCollection()),this.init()},init:function(){this._context=this.options.context,this._viewer=this._context.getViewer();var e=this._context.getScene();this._resourceDefer=new it.a,e.addResourcePromise(this._resourceDefer),k.a.getPolygon().then(this.initSceneGraph.bind(this))},getTextureCollection:function(){return this.getResourceManager().getTextureCollection()},getMatcapCollection:function(){return this.getResourceManager().getMatcapCollection()},getResourceManager:function(){return this._resourceManager||s.default.instance},getOrCreateDefaultStateSet:function(){return void 0===this._defaultStateSet&&(this._defaultStateSet=new Ri.StateSet,this._defaultStateSet._uniqueID=0),this._defaultStateSet},setDefaultMaterial:function(e,t){var n=this.getOrCreateDefaultStateSet();if(e.setStateSet(n),!this._defaultMaterial){if(this._defaultMaterial=t.getMaterialByStateSet(n),this._defaultMaterial){var i=n.getAttributeMap().Material,r=t.getUniqueMaterialName(i,n,e);this._defaultMaterial.set("name",r)}else this._defaultMaterial=t.createMaterial(e,n);this._defaultMaterial.setStateSet(n)}},addDefaultMaterial:function(e,t,n){0===e.getMaterials().length&&this.setDefaultMaterial(t,n);for(var i=this._tracePathVisitor.getPathList(),r=0,a=i.length;r<a;++r){for(var o=i[r],s=o.length,u=!1,l=0;l<s;++l){var c=o[l].getStateSet();if(c&&c.getAttribute("SketchfabMaterial")){u=!0;break}}if(!u){var h=o[s-1];this.setDefaultMaterial(h,n)}}},_handleCullFace:function(e){var t=this._context.getModel().get("options"),n=e.userDataMap.sourceTool.toLowerCase(),i=Object(u.a)().singleSided,r=-1!==n.indexOf("sketchup"),a=r&&t.version<6,o=r&&Object(Qt.a)();if(void 0!==i||o||a){var s=!1===i?Ri.CullFace.DISABLE:Ri.CullFace.BACK,l=this.model.getMaterials();for(var c in l)l[c].set("cullFace",s)}},processSceneGraph:function(e,t){var n=new Zt(t).apply(e);(e.accept(this._tracePathVisitor),this.deleteUnusedMaterials(this._tracePathVisitor),this.addDefaultMaterial(n,e,t),this._sceneLights=n.getLights(),this._handleCullFace(e),Object(Qt.a)()&&"substancepainter"===e.userDataMap.source)&&this._viewer.getFeatures().shadingStyle.getModel().set("vertexColorEnable",!1);return n},getSceneLights:function(){return this._sceneLights},initSceneGraph:function(){var e=this.model,t=this._viewer.getRootModel(),n=this._viewer.getFeatures();if(Ri.time("initSceneGraph - create saved materials"),!1===Object(u.a)().processMaterial){var i=this._context.getModel().get("options").materials;for(var r in i)e.addMaterial(i[r])}Ri.timeEnd("initSceneGraph - create saved materials"),Ri.time("initSceneGraph - processSceneGraph");var a=this.processSceneGraph(t,e);Ri.timeEnd("initSceneGraph - processSceneGraph"),Ri.time("initSceneGraph - apply materials"),e.removeUnboundMaterial();var o=n.shadingStyle.getModel(),s=o.get("vertexColorEnable")&&o.get("vertexColorUseAlpha");e.tagMaterialWithGeometryInfo(t,s),this._requestTextures(),e._style=a.getStyle();var l=a.hasMetallicWorkflow();void 0!==l&&e.setWorkFlowMetalSpec(l,!1),e.overrideMaterialChannels(Object(u.a)()),e.enforceWorkflowPerMaterial(),e.updateTexCoordUnitList(),Oi.set("protectDepthAndColorUnit",this._checkProtectDepthColor()),this.applyMaterials(),this.setWireframeStateSets(),Ri.timeEnd("initSceneGraph - apply materials"),_i.optimize(this._tracePathVisitor,this._viewer),n.quality&&n.quality.getModel().trigger("updateTexelPolicy"),k.a.resolveMaterial(),on.a.packAllMaterialsTextures(e.getMaterials())},_checkProtectDepthColor:function(){if(window.RunningTests)return!1;if(Object(o.a)()||Object(u.a)().materialShowcase||Object(u.a)().apiVersion)return!0;if(this._viewer.getFeatures().postProcess.getModel().isEffectiveSsr())return!0;var e=this.model.getMaterials();for(var t in e){var n=e[t].getChannels().Opacity;if(n.isEffective()&&"refraction"===n.getTransparency())return!0}return!1},setWireframeStateSets:function(){if(this._viewer.hasIntegratedWireframe()){var e=0,t=this.model,n={},i=this._tracePathVisitor.getPathList(),r=i.length;for(e=0;e<r;++e){var a=i[e],o=a[a.length-1];if(o instanceof Ri.Geometry!=!1){var s=o.getVertexAttributeList().Vertex;s&&(n[s.getInstanceID()]=a)}}var u={},l=this._tracePathVisitor.getWireframePathList(),c=this._context.getScene().getWireframeNodes(),h=c.length;for(e=0;e<h;++e){var d=c[e],f=n[d.getVertexAttributeList().Vertex.getInstanceID()];if(f){var p=f[f.length-1],g=t.findFirstMaterial(f);g.get("wireframeList").push(d);var m=g.get("stateSet");d._attributes=p.getVertexAttributeList();var v=m.getAttribute("SketchfabMaterial"),_=v.getInstanceID(),b=u[_];b||((b=u[_]=new an.a)._textureAttributeArrayList=m._textureAttributeArrayList,b._activeTextureAttributeUnit=m._activeTextureAttributeUnit,b._activeTextureAttribute=m._activeTextureAttribute,b.setAttributeAndModes(v),v.getMaterialModel().set("stateSetWireframe",b)),d.setStateSet(b)}else{c.splice(e,1),e--,h--;for(var S=d.getParents(),y=0,x=S.length;y<x;++y)S[y].removeChild(d);for(var C=0;C<l.length;++C){var w=l[C];w[w.length-1]===d&&(l.splice(C,1),C--)}}}}},deleteUnusedMaterials:function(e){for(var t=e.getStateSetMapNodes(),n=e.getStateSetPathList(),i=e.getStateSetMap(),r={},a=0,o=n.length;a<o;a++){var s=n[a];if(s.length>0){var u=s.length-1;r[s[u]._uniqueID]=s[u]}}for(var l in t)if(void 0===r[l]){this.model.removeMaterialByStateSet(i[l]);for(var c=0,h=t[l].length;c<h;c++){t[l][c].setStateSet(void 0)}}},cleanAndApplyMaterials:function(){var e=this.model.getMaterials();for(var t in e){var n=e[t];n.get("stateSet")&&n.trigger("change:stateSet")}this.applyMaterials()},applyMaterials:function(){var e=this.model.getMaterials();for(var t in e){e[t].trigger("apply")}},_requestTexture:function(e,t,n){if(e){var i=e.getChannels()[t],r=i.getTextureModel();if(r&&i.isEffective()){var a=r.getMultiresTexture();if(a){if(0!==a.getImageCount())return(n?a.getImageSmallest():a.getImageMaxSupported()).promise;i.setColor&&i.setColor(Ri.vec3.fromValues(.9,.9,.9))}}}},_requestAllTextures:function(e,t){for(var n=[],i=new window.Set,r=0;r<nn.a.length;++r){var a=nn.a[r];for(var o in e){var s=e[o],u=this._requestTexture(s,a,t);u&&!i.has(u)&&(i.add(u),n.push(u))}}return n},_resolvePromiseTextures:function(e,t,n){for(var i=(new Date).getTime()-t,r=0,a=0,o=e.length;a<o;++a)!0!==e[a]&&r++;(n?k.a.resolveLowResLoaded:k.a.resolveHighResLoaded)({time:r>0?i:0,count:r})},requestAllLowResTextures:function(e){return this._requestAllTextures(e,!0)},requestAllHighResTextures:function(e){for(var t=this._requestAllTextures(e,!1),n=0,i=0,r=t.length;i<r;i++)n+=t[i].progressSize;return k.a.resolveDataSizeTextures(n),t},_resolvePromiseLowResTextures:function(e,t){return this._resolvePromiseTextures(e,t,!0)},_resolvePromiseHighResTextures:function(e,t){return this._resolvePromiseTextures(e,t,!1)},_startHighResAfterLowRes:function(e,t,n,i){var r=Date.now();this._resolvePromiseLowResTextures(e,t);var a=this.requestAllHighResTextures(i);this._viewer.setFakeProgress(a,!n,"texture");var o=this;h.a.all(Object(nt.a)(a,function(e){return e.reflect()})).then(function(){o._resolvePromiseHighResTextures(a,r),n&&o._resourceDefer.resolve()}),n||this._resourceDefer.resolve()},_requestTextures:function(){var e=Object(u.a)().preload,t=this.model.toJSON();if(e)this._startHighResAfterLowRes(h.a.resolve(),Date.now(),e,t);else{var n=Date.now(),i=this.requestAllLowResTextures(t);this._viewer.setFakePrimaryProgress(i,"texture");var r=this;h.a.all(Object(nt.a)(i,function(e){return e.reflect()})).then(function(){r._startHighResAfterLowRes(i,n,e,t)})}},_getUniqueTextures:function(){var e={},t=this.model.getMaterials(),n=[];for(var i in t)for(var r=t[i].get("stateSet"),a=r.getNumTextureAttributeLists(),o=0;o<a;++o){var s=r.getTextureAttribute(o,"Texture");s&&s.getChannelPacking&&(s.isTextureNull()||s.isColorAtlas()||e[s.getInstanceID()]||(e[s.getInstanceID()]=!0,n.push(s)))}return n},getOrCreateTexelInfos:function(){if(this._infoTex)return this._infoTex;for(var e=this._infoTex={missingTextures:{},gpuTextureCount:0,gpuPixelCount:0,min:1/0,max:-1/0},t={width:0,height:0,missingTextures:e.missingTextures},n=this._getUniqueTextures(),i=n.length,r=0;r<i;++r){t=n[r].getMaxTextureSizePacked(t),e.gpuTextureCount++,e.gpuPixelCount+=t.width*t.height;var a=Math.max(t.width,t.height);e.min=Math.min(a,e.min),e.max=Math.max(a,e.max)}return e}}),Ii=n("q1z7"),Ni=n.n(Ii),Li=n("CpTu"),ki=n("t8Ru"),Di=n("4E7f"),Fi=d.a.osg,Vi=function(e,t){return e-t},Bi={Matcap:"Matcap",SubsurfaceScattering:"Subsurface scattering",SubsurfaceTranslucency:"Subsurface translucency",DiffuseColor:"Diffuse",DiffuseIntensity:"Lightmap",SpecularColor:"Specular Color",SpecularHardness:"Glossiness",Displacement:"Displacement",NormalMap:"Normal map",BumpMap:"Bump map",Opacity:"Opacity",EmitColor:"Emission",DiffusePBR:"Albedo",AlbedoPBR:"Base Color",SpecularPBR:"Specular",GlossinessPBR:"Glossiness",RoughnessPBR:"Roughness",MetalnessPBR:"Metalness",SpecularF0:"Specular F0",AOPBR:"Ambient Occlusion",CavityPBR:"Cavity",ClearCoat:"Clear Coat",ClearCoatRoughness:"Clear Coat roughness",ClearCoatNormalMap:"Clear Coat normap map",Anisotropy:"Anisotropy"},Ui=a.a.extend({initDefaults:function(e){var t=e.channels;for(var n in delete e.channels,e.reflection=Object(Qt.a)()?.1:.3,e.verison=3,a.a.prototype.initDefaults.call(this,e),t.Inspector={factor:1,enable:!0,maskThreshold:0,invert:!1,color:Fi.vec3.fromValues(1,1,1)},t){var i=t[n];switch(i.name=n,i.material=this,i.displayName=Bi[n],n){case"DiffuseColor":i.color=Object(Qt.a)()?Fi.vec3.fromValues(1,1,1):Fi.vec3.fromValues(.5,.5,.5);break;case"Opacity":i.useAlbedoTint=!Object(Qt.a)(),i.thinLayer=!Object(Qt.a)()}t[n]=new Di.default[n].model(i)}this.set("channels",t)},getModelOptionPath:function(){return"materials:0"},defaults:function(){return{geometryList:[],wireframeList:[],texCoordUnitList:[],vertexColorColorSpace:"srgb",vertexColorEnable:!1,vertexAlphaEnable:!1,hasVertexColor:!1,hasVertexAlpha:!1,hasTriangles:!1,hasPoints:!1,hasLines:!1,stateSet:void 0,stateSetWireframe:void 0,uidUniqueMerged:"",uidListUnusedDuplicates:[]}},setMaterial:function(e){this.set(e);var t=this.getChannels();for(var n in e.channels)t[n].set(e.channels[n])},setMaterialJSON:function(e,t,n){var i=n||{},r=e.channels;i.ignore=["channels"];var o=a.a.prototype.setJSON.call(this,e,i);if(r){for(var s=this.getChannels(),u=nn.a.length,l=0;l<u;++l){var c=nn.a[l],h=r[c];if(h){var d=s[c];if(d){var f=d.setChannelJSON(h,t,i);f.length&&o.concat(f)}}}return o}},getChannels:function(){return this.get("channels")},setStateSet:function(e){return this.set("stateSet",e),this},setChannelEnable:function(e,t){var n=this.get("channels");return n[e]?(n[e].setEnable(t),this):this},setChannelColor:function(e,t){var n=this.get("channels")[e];return n&&n.setColor?(n.setColor(t),this):this},setChannelTexture:function(e,t){var n=this.get("channels");return n[e]?(n[e].setTextureModel(t),this):this},setChannelFactor:function(e,t){var n=this.get("channels");return n[e]?(n[e].setFactor(t),this):this},getJSON:function(){var e=a.a.prototype.getJSON.call(this,{ignore:["channels"]});e.version=3,e.channels={};var t=this.get("channels");for(var n in t)"Inspector"!==n&&(e.channels[n]=t[n].getJSON());return e},copyDualChannel:function(e,t){var n=this.getChannels(),i=n[e],r=n[t],a=r.getTextureModel(),o="MetalnessPBR"===e||"SpecularPBR"===e,s="NormalMap"===e||"BumpMap"===e;a?(a=a.clone(),(o||s)&&(a.setImageModel(a.getImageModel()),a.set("internalFormat","NormalMap"===e||"SpecularPBR"===e?Fi.Texture.RGB:Fi.Texture.LUMINANCE),a.updateMultiresTexture()),i.setTextureModel(a)):o||(i.setColor?r.getColor&&i.setColor(r.getColor()):i.setTextureModel(void 0)),s||i.setFactor(r.getFactor())},isWorkflowMetalness:function(){return this.getChannels().MetalnessPBR.getEnable()},setWorkFlowRoughGloss:function(e,t){var n=e?"GlossinessPBR":"RoughnessPBR",i=e?"RoughnessPBR":"GlossinessPBR",r=this.getChannels();r[n].setEnable(!1),r[i].setEnable(!0),t&&this.copyDualChannel(i,n,r)},setWorkFlowMetalSpec:function(e,t){var n=e?"DiffusePBR":"AlbedoPBR",i=e?"SpecularPBR":"MetalnessPBR",r=e?"AlbedoPBR":"DiffusePBR",a=e?"MetalnessPBR":"SpecularPBR",o=this.getChannels();o[n].setEnable(!1),o[i].setEnable(!1),o.SpecularF0.setEnable(e),o[r].setEnable(!0),o[a].setEnable(!0),t&&(this.copyDualChannel(r,n),this.copyDualChannel(a,i))},hasOnlyPoints:function(){return this.get("hasPoints")&&!this.get("hasTriangles")&&!this.get("hasLines")},updateTexCoordUnitList:function(){var e=this.get("texCoordUnitList");e.length=0;for(var t,n,i=this.get("geometryList"),r=i.length,a=[],o=[],s=0;s<r;++s){var u=i[s].getVertexAttributeList();for(var l in o.length=0,u)-1!==l.indexOf("TexCoord")&&o.push(parseInt(l.substring(8)));for(0===o.length&&this.set("missingUvs",!0),o.sort(Vi),t=o.length-1;t>=0;--t){var c=o[t],h=u["TexCoord"+c];for(n=0;n<t;++n){var d=o[n];if(h===u["TexCoord"+d]){var f=a[c];void 0!==f&&f!==d?-1===e.indexOf(c)&&e.push(c):a[c]=d;break}}var p=o[n];-1===e.indexOf(p)&&e.push(p)}}if(e.sort(Vi),0!==a.length){var g=e.length;for(t=0;t<g;++t)a[e[t]]=e[t];var m=this.getChannels(),v=nn.a.length;for(t=0;t<v;++t){var _=m[nn.a[t]];_.setTexCoordUnit(a[_.getTexCoordUnit()])}}},enforceWorkflow:function(){var e=this.getChannels(),t=e.MetalnessPBR.getEnable();e.AlbedoPBR.setEnable(t),e.SpecularF0.setEnable(t),e.DiffusePBR.setEnable(!t),e.SpecularPBR.setEnable(!t);var n=e.RoughnessPBR.getEnable();e.GlossinessPBR.setEnable(!n),e.BumpMap.getEnable()&&e.NormalMap.getEnable()&&e.BumpMap.setEnable(!1)}}),ji=n("gUpJ"),Gi=d.a.osg,Hi={};Hi[Gi.Texture.LUMINANCE]="r",Hi[Gi.Texture.ALPHA]="a",Hi[Gi.Texture.RGB]="rgb";var zi=function(e){Gi.Texture.call(this),this._texture=e,this._isColorAtlas=!1,this._channels=[],this._packedTextures={}},Wi=function(e,t){var n=nn.a.getDefaultComponentCount(e),i=nn.a.getDefaultComponentCount(t);return i===n?e<t?1:-1:i-n};Gi.createPrototypeStateAttribute(zi,Gi.objectInherit(Gi.Texture.prototype,{attributeType:"Texture",invalidate:function(){this._isColorAtlas||(this._texture=void 0)},isColorAtlas:function(){return this._isColorAtlas},setIsColorAtlas:function(e){this._isColorAtlas=e},getChannelPacking:function(e){var t=this._packedTextures[e];return t?t.pack:""},getPackedTextures:function(){return this._packedTextures},getOrderedChannels:function(){return this._channels},getTexture:function(){return this._texture||(this._texture=on.a.packTextures(this)),this._texture},setTexture:function(e){this._texture=e},getChannelCount:function(){return this._channels.length},addChannel:function(e,t,n){this._packedTextures[e]||(this._packedTextures[e]={texture:t,pack:"rgb"},n||this._channels.push(e),this._isColorAtlas||(this._texture=void 0,this.updatePacking()))},removeChannel:function(e){this._packedTextures[e]&&(delete this._packedTextures[e],this._channels.splice(this._channels.indexOf(e),1),this._isColorAtlas||(this._texture=void 0,this.updatePacking()))},packChannelIfPossible:function(e,t){if(this._isColorAtlas||!Object(u.a)().materialPacking||t.isVideo())return!1;var n=this._channels,i=n.length;if(0===i)return!1;for(var r=4,a=0;a<i;++a)r-=this._packedTextures[n[a]].pack.length;return 0!==r&&(!(nn.a.getDefaultComponentCount(e)>r)&&(!!this.isFilteringFriendly(t,this._packedTextures[n[0]].texture)&&(n.push(e),this.addChannel(e,t,!0),this.updatePacking(),!0)))},isFilteringFriendly:function(e,t){return e.getMinFilter()===t.getMinFilter()&&(e.getMagFilter()===t.getMagFilter()&&(e.getWrapS()===t.getWrapS()&&e.getWrapT()===t.getWrapT()))},getSinglePacking:function(e,t){if("Opacity"===e){var n=t.getInternalFormat()&&Hi[t.getInternalFormat()];return n&&1===n.length?n:"r"}return"EmitColor"===e&&t.getInternalFormat()===Gi.Texture.ALPHA?"aaa":nn.a.getDefaultFormatComponent(e)},updatePacking:function(){var e=this._channels,t=0,n=e.length;if(1!==n){e.sort(Wi);for(var i=0;i<n;++i){var r=e[i],a=this._packedTextures[r];if(a){var o=nn.a.getDefaultFormatComponent(r).length;a.pack="rgba".substr(t,o),t+=o}}}else{var s=this._packedTextures[e[0]];s.pack=this.getSinglePacking(e[0],s.texture)}},getMaxTextureSizePacked:function(e){e.width=0,e.height=0;for(var t=this._channels,n=t.length,i=0;i<n;++i){var r=t[i],a=this._packedTextures[r];if(a){var o=a.texture;if(o.getImageJSONMaxSupported){var s=o.getImageJSONMaxSupported();if(e.width=Math.max(e.width,s.width),e.height=Math.max(e.height,s.height),!(s.width<=512&&s.height<=512)){var u=o.getImageJSONMaxSupported(512);if(512!==u.width&&512!==u.height){var l=o.getImageModel().getUID(),c=e.missingTextures[l];c?-1===c.indexOf("channelName")&&c.push(r):e.missingTextures[l]=[r]}}}}}return e},isProtectedTexture:function(){for(var e=ki.a.compilerChannels[ki.a.EARLYZ_COMPILER],t=0;t<e.length;++t)if(this._packedTextures[e[t]])return!0;return!1},getImage:function(){return this.getTexture().getImage()},cloneType:function(){return new zi(new ji.a)},isTextureNull:function(){return!(!this._isColorAtlas||0!==this._channels.length)||this.getTexture().isTextureNull()},apply:function(e){var t=e.getGraphicContext();this.setGraphicContext(t);var n=this.getTexture(),i=n._textureObject&&!n.isDirty();n.apply(e),i||(this._packedTextures.Opacity||this._packedTextures.Displacement)&&V.a.redrawShadowNextFrame()},getHash:function(){return""}}),"osgSketchfab","PackedMaterialTexture");var qi=zi,Xi=n("w3fr"),Yi=d.a.osg,Ki=Yi.Texture.textureNull,Qi=we.a.CULL_BACK,Ji=we.a.CULL_DISABLE,Zi=new Yi.PointSizeAttribute,$i=new Yi.PointSizeAttribute;$i.setCircleShape(!0);var er=function(e){this._stateSet=void 0,this._materialModel=e,this._material=new ki.a,this._material.setMaterialModel(this._materialModel),this._material.setStateSetContext(this);var t=new Yi.Texture;t.setImage(new Uint8Array(12),Yi.Texture.RGB),t.setTextureSize(4,1),t.setMinFilter(Yi.Texture.NEAREST),t.setMagFilter(Yi.Texture.NEAREST),this._colorAtlas=new qi(t),this._colorAtlas.setIsColorAtlas(!0),this._packedMaterialTextureCache={},this._maxTextureUnits=Object(Xi.a)()};er.cachedSquarePoint=Zi,er.cachedCirclePoint=$i,er.prototype={dirtyMaterial:function(){this._material&&this._material.dirtyMaterial()},getStateSet:function(){return this._stateSet},getChannelPacking:function(e){var t=this._packedMaterialTextureCache[e];return t.getChannelPacking&&t.getChannelPacking(e)},setStateSet:function(e){this._stateSet=e,e.getAttribute("SketchfabMaterial")||(this._material.setName(e.getName()),e.setAttributeAndModes(this._material));for(var t=0,n=e.getNumTextureAttributeLists();t<n;t++)e.removeTextureAttribute(t,"Texture")},setStateSetAlphaBlending:function(){this._stateSet&&(this._stateSet.setRenderBinDetails(Se.a.TRANSPARENT,"DepthSortedBin"),Oi.registerStateSetIsTransparent(this._stateSet,!0),Oi.registerStateSetIsRefraction(this._stateSet,!1))},setStateSetOpaque:function(){this._stateSet&&(this._stateSet.setRenderBinDetails(Se.a.OPAQUE,"RenderBin"),Oi.registerStateSetIsTransparent(this._stateSet,!1),Oi.registerStateSetIsRefraction(this._stateSet,!1))},setStateSetRefraction:function(){this._stateSet&&(this._stateSet.setRenderBinDetails(Se.a.REFRACTION,"RenderBin"),Oi.registerStateSetIsTransparent(this._stateSet,!1),Oi.registerStateSetIsRefraction(this._stateSet,!0))},setCullface:function(e){this._stateSet&&(this._stateSet.setAttributeAndModes(e?Qi:Ji),this._material.dirtyMaterial())},setPointCircle:function(e){this._stateSet&&(this._stateSet.setAttributeAndModes(e?$i:Zi),this._material.dirtyMaterial())},isFreeSlot:function(e,t){return void 0===e||e===Ki||(!(!e.getChannelCount||0!==e.getChannelCount())||!(!t||e!==this._colorAtlas))},isProtectedUnit:function(e){return!(!Oi.get("protectDepthAndColorUnit")||4!==e&&5!==e)||(6===e||8===e||Object(u.a)().shadowAtlas&&7===e)},_getFirstFreeUnit:function(e){for(;this.isProtectedUnit(e);)e++;return Math.min(e,this._maxTextureUnits-1)},getAvailableTextureUnit:function(e,t){for(var n=t===this._colorAtlas,i=t===Ki,r=this._stateSet,a=r.getNumTextureAttributeLists(),o=this._getFirstFreeUnit(a),s=-1,u=0;u<=o;++u)if(!this.isProtectedUnit(u)){var l=r.getTextureAttribute(u,"Texture");if(-1===s&&this.isFreeSlot(l,n)&&(s=u,n||i))break;if(!i&&!n&&l&&l.packChannelIfPossible&&l.packChannelIfPossible(e,t)){s=u;break}}return s},setPackedMaterialTextureToStateSet:function(e,t){var n=e.getName(),i=this._packedMaterialTextureCache[n];i&&i instanceof qi&&(i.removeChannel(n),on.a.removePackedTexture(i));var r=this.getAvailableTextureUnit(n,t);if(r<0)return this._packedMaterialTextureCache[n]=Ki,void this._material.setChannelMapping(n,-1);var a=this._stateSet.getTextureAttribute(r,"Texture");t===this._colorAtlas?a=this._colorAtlas:a&&a!==this._colorAtlas||(a=new qi),a.setName("Texture"+r),this._material.setChannelMapping(n,t===Ki?-1:r),this._packedMaterialTextureCache[n]=a,a&&a.addChannel&&t!==Ki&&a.addChannel(n,t);var o=a instanceof qi,s=o&&a.isProtectedTexture()?Yi.StateAttribute.PROTECTED:Yi.StateAttribute.ON;this._stateSet.setTextureAttributeAndModes(r,a,s),o&&on.a.addPackedTexture(a)},setTexture:function(e){var t=e.getTextureModel(),n=t.getImageModel(),i=t.getMultiresTexture();if(n&&i){this.setPackedMaterialTextureToStateSet(e,i),i.isTextureNull()&&i.setTextureSize(1,1);var r=k.a.getLowResLoaded();if(r.isFulfilled())return i.setImageMaxSupported();i.setImageSmallest().promise.then(function(){r.then(i.setImageMaxSupported.bind(i))})}},setColor:function(e){var t=nn.a.getColorPacking(e.getName());if(t<0)this.setPackedMaterialTextureToStateSet(e,Ki);else{var n=e.getColor();t*=3;var i=this._colorAtlas.getTexture(),r=i.getImage().getImage();r[t]=Math.round(255*n[0]),r[t+1]=Math.round(255*n[1]),r[t+2]=Math.round(255*n[2]),i.dirty(),this.setPackedMaterialTextureToStateSet(e,this._colorAtlas)}},setChannelEnable:function(e,t){return!1===t?this.setPackedMaterialTextureToStateSet(e,Ki):e.getTextureModel()?this.setTexture(e):void this.setColor(e)},setChannelOpacity:function(e,t){var n=e.getTransparency(),i="additive"===n,r="alphaBlend"===n,a="alphaMask"===n,o="dithering"===n,s="refraction"===n;return this._material&&this._material.updateOpacity(),!1===t||a||o?this.setStateSetOpaque():r||i?this.setStateSetAlphaBlending():s?this.setStateSetRefraction():void Yi.warn("Unknow alpha type : "+n)},updateChannel:function(e){if(this._stateSet){var t=e.isEffective();this.setChannelEnable(e,t);var n=e.getName();"Opacity"===n&&this.setChannelOpacity(e,t),"SubsurfaceScattering"===n&&(Oi.registerStateSetIsScattering(this._stateSet,t),this._materialModel.getChannels().Opacity.trigger("updateChannel")),this._material.dirtyMaterial()}}};var tr=er,nr=D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments),this.model.bind("change:stateSet",this.stateSet,this),this.model.bind("change:cullFace",this.onCullFace,this),this.model.bind("change:shadeless",this.onDirty,this),this.model.bind("change:vertexColorEnable",this.onDirty,this),this.model.bind("change:vertexColorColorSpace",this.onDirty,this),this.model.bind("change:vertexAlphaEnable",this.onDirty,this),rn.a.bind("change:hasSsr",this.onDirty,this),this.model.bind("change:hasPoints",this.onPrimitive,this),this.model.bind("change:hasTriangles",this.onPrimitive,this),this.model.bind("change:hasLines",this.onPrimitive,this),this.model.bind("apply",this.apply,this),this.model.bind("change",V.a.draw),this._context=new tr(this.model),this._views={};for(var e=this.model.get("channels"),t=nn.a.length,n=0;n<t;++n){var i=nn.a[n],r=e[i];this._views[i]=new Di.default[i].view({model:r}),this._views[i].stateSetContext=this._context,r.bind("change:enable",this.model.enforceWorkflow,this.model)}},getStateSetContext:function(){return this._context},stateSet:function(){var e=this.model.get("stateSet");return e.setName(this.model.get("name")),this.getStateSetContext().setStateSet(e),this},apply:function(){for(var e in this._views)this._views[e].updateChannel();this.onCullFace(),this.onDirty()},onDirty:function(){this.getStateSetContext().dirtyMaterial()},onCullFace:function(){this.getStateSetContext().setCullface(this.model.get("cullFace"))},onPrimitive:function(){this.getStateSetContext().setPointCircle(this.model.hasOnlyPoints())}}),ir=d.a.osg,rr=1,ar=function(){ir.NodeVisitor.call(this,ir.NodeVisitor.TRAVERSE_PARENTS),this._material=void 0,this._manager=void 0};ir.createPrototypeObject(ar,ir.objectInherit(ir.NodeVisitor.prototype,{setManager:function(e){this._manager=e},reset:function(){this.nodePath.length=0,this._material=void 0},apply:function(e){if(!this._material){var t=e.getStateSet();t&&(this._material=this._manager.getMaterialByStateSet(t)),this._material||this.traverse(e)}}}));var or=function(e,t){ir.NodeVisitor.call(this),this._manager=e,this._useVertexAlpha=t,this._stackMaterial=[]};ir.createPrototypeObject(or,ir.objectInherit(ir.NodeVisitor.prototype,{apply:function(e){var t=e.getStateSet(),n=t&&this._manager.getMaterialByStateSet(t);if(n&&this._stackMaterial.push(n),e instanceof ir.Geometry&&this._stackMaterial.length>0){var i=this._stackMaterial[this._stackMaterial.length-1];e.getVertexAttributeList().Color&&(i.set("hasVertexColor",!0),!i.get("hasVertexAlpha")&&e.userDataMap.hasVertexAlpha&&(i.set("hasVertexAlpha",!0),i.set("vertexAlphaEnable",this._useVertexAlpha))),e.userDataMap&&(i.set("hasPoints",e.userDataMap.hasPoints),i.set("hasTriangles",e.userDataMap.hasTriangles),i.set("hasLines",e.userDataMap.hasLines)),i.get("geometryList").push(e)}this.traverse(e),n&&this._stackMaterial.pop()}}));var sr=Ni.a.Model.extend({initialize:function(){this._materialByStateSetID={},this._materialNames={material_:0}},getImageCollection:function(){return this._imageCollection||d.a.osg.error("ImageCollection not initialized in MaterialManager, something is wrong"),this._imageCollection},setImageCollection:function(e){this._imageCollection=e},getMatcapCollection:function(){return this._matcapCollection||d.a.osg.error("matcapCollection not initialized in MaterialManager, somewhing wrong"),this._matcapCollection},setMatcapCollection:function(e){this._matcapCollection=e},setNewMaterial:function(e,t){this.attributes[e]=t;var n=t.get("stateSetID");void 0!==n&&(this._materialByStateSetID[n]=t)},addMaterial:function(e){var t=new Ui,n=this.getImageCollection();return t.setMaterialJSON(e,n),new nr({model:t}),this.setNewMaterial(e.id,t),t},getMaterials:function(){return this.attributes},getMaterialStateID:function(e){if(void 0!==e._materialID)return e._materialID;var t=e.getUserData();if(t)for(var n=t.length-1;n>=0;--n)if("UniqueID"===t[n].Name){e._materialID=parseInt(t[n].Value,10);break}return void 0===e._materialID&&(void 0!==e._uniqueID?e._materialID=e._uniqueID:(d.a.osg.warn("v0 StateSet detected"),e._materialID=rr++)),e._materialID},getMaterialByStateSetID:function(e){return void 0!==e?this._materialByStateSetID[e]:void 0},getMaterialByStateSet:function(e){return this.getMaterialByStateSetID(this.getMaterialStateID(e))},_getChannel:function(e,t){var n=this.getMaterialByStateSetID(e);if(!n)return"Unknown material for id"+e;var i=n.get("channels")[t];return i&&i.changeTexCoordTransform?i:"Couldn't find channel "+t+" or it doesn't have a texture"},setUVOffset:function(e,t,n,i){var r=this._getChannel(e,t);if(r.length)return r;r.set("UVOffset",ir.vec2.fromValues(n,i)),r.get("UVTransforms")||r.set("UVTransforms",ir.vec4.fromValues(1,0,0,1)),r.changeTexCoordTransform()},setUVRotation:function(e,t,n){var i=this._getChannel(e,t);if(i.length)return i;var r=i.get("UVTransforms"),a=1,o=1;r&&(a=Math.sqrt(r[0]*r[0]+r[2]*r[2]),o=Math.sqrt(r[1]*r[1]+r[3]*r[3]));var s=Math.cos(n),u=Math.sin(n);i.set("UVTransforms",ir.vec4.fromValues(s*a,-u*o,u*a,s*o)),i.get("UVOffset")||i.set("UVOffset",ir.vec2.fromValues(0,0)),i.changeTexCoordTransform()},setUVScale:function(e,t,n,i){var r=this._getChannel(e,t);if(r.length)return r;n=n>0?n:.001,i=i>0?i:.001;var a=r.get("UVTransforms"),o=ir.vec4.fromValues(1,0,0,1);if(a){var s=ir.vec2.fromValues(a[0],a[2]);ir.vec2.normalize(s,s);var u=ir.vec2.fromValues(a[1],a[3]);ir.vec2.normalize(u,u),ir.vec4.set(o,s[0],u[0],s[1],u[1])}r.set("UVTransforms",ir.vec4.fromValues(o[0]*n,o[1]*i,o[2]*n,o[3]*i)),r.get("UVOffset")||r.set("UVOffset",ir.vec2.fromValues(0,0)),r.changeTexCoordTransform()},_deleteMaterialById:function(e){var t=this.attributes[e];t&&delete this._materialByStateSetID[t.get("stateSetID")],delete this.attributes[e]},removeMaterialByStateSetID:function(e){var t=this.attributes;for(var n in t)t[n].get("stateSetID")===e&&this._deleteMaterialById(n)},removeMaterialByStateSet:function(e){var t=this.attributes;for(var n in t){if(t[n].get("stateSet")===e)return void this._deleteMaterialById(n)}},removeUnboundMaterial:function(){var e=this.attributes;for(var t in e){e[t].get("stateSet")||this._deleteMaterialById(t)}},getMaxUvCount:function(){var e=this.attributes,t=0;for(var n in e){var i=e[n];if(!i.get("uidUniqueMerged")){var r=i.get("texCoordUnitList").length;r>t&&(t=r)}}return t},createMaterial:function(e,t){void 0===t&&(t=e.getOrCreateStateSet());var n=new Ui;new nr({model:n});var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});return n.set("id",i),n.set("stateSetID",this.getMaterialStateID(t)),n.set("name",this.getUniqueMaterialName(t.getAttributeMap().Material,t,e)),this.setNewMaterial(i,n),n},getUniqueMaterialName:function(e,t,n){var i=this._materialNames,r=e&&e.getAttribute()?e.getAttribute().getName():void 0;return void 0===r&&(r=void 0!==t.getName()?t.getName():n.getName()),void 0===r?"material_"+i.material_++:(void 0===i[r]?i[r]=0:r+="_"+i[r]++,r)},setWorkFlowMetalSpec:function(e,t){var n=this.attributes;for(var i in n)n[i].setWorkFlowMetalSpec(e,t)},setWorkFlowRoughGloss:function(e,t){var n=this.attributes;for(var i in n)n[i].setWorkFlowRoughGloss(e,t)},overrideMaterialChannels:function(e){if(!Object(o.a)()&&e.materialShowcase){var t=e.materialDisplacement,n=e.materialDisplacementFactor,i=e.materialNormal,r=e.materialDiffuse,a=e.materialMetalness,s=e.materialRoughness,u=e.materialGlossiness,l=e.materialSpecular,c=e.materialEmissive,h=e.materialTransparency,d=e.materialCavity,f=e.materialAO,p=e.materialF0,g=(e.materialNames||"main_material").split(";");if(e.substanceDisplacement&&void 0!==t){var m=this.attributes["ae605e73-2987-4b0f-b25b-bdf1dc02e6ed"];m||(m=Object(Li.a)(this.attributes,function(e){return"Sides"===e.get("name")})),m&&this._replaceChannelURL(m.getChannels(),"Displacement",t,!0,n)}for(var v in this.attributes){var _=this.attributes[v];if(-1!==g.indexOf(_.get("name"))){var b=_.getChannels();r&&(this._replaceChannelURL(b,"DiffuseColor",r),this._replaceChannelURL(b,"AlbedoPBR",r),this._replaceChannelURL(b,"DiffusePBR",r)),void 0!==p&&(p.length?this._replaceChannelURL(b,"SpecularF0",p):(b.SpecularF0.reset(),b.SpecularF0.setFactor(.5))),void 0!==i&&this._replaceChannelURL(b,"NormalMap",i,!0),void 0!==t&&this._replaceChannelURL(b,"Displacement",t,!0,n),void 0!==d&&this._replaceChannelURL(b,"CavityPBR",d,!0),void 0!==c&&this._replaceChannelURL(b,"EmitColor",c,!0),void 0!==h&&this._replaceChannelURL(b,"Opacity",h,!0),void 0!==f&&(this._replaceChannelURL(b,"AOPBR",f,!0),this._replaceChannelURL(b,"DiffuseIntensity",f,!0)),(l||a)&&(this._replaceChannelURL(b,"SpecularPBR",l),this._replaceChannelURL(b,"MetalnessPBR",a),_.setWorkFlowMetalSpec(Boolean(a))),(s||u)&&(this._replaceChannelURL(b,"RoughnessPBR",s),this._replaceChannelURL(b,"GlossinessPBR",u),_.setWorkFlowRoughGloss(Boolean(s)))}}}},enforceWorkflowPerMaterial:function(){var e=this.attributes;for(var t in e)e[t].enforceWorkflow()},_replaceChannelURL:function(e,t,n,i,r){var a=e[t];if(n&&n.length){var o=this.getImageCollection().addNewImage({url:n,name:n,width:1,height:1});a.setupTextureModel({image:o}),i&&a.setEnable(!0),a.setFactor(void 0===r?1:r)}else a.setEnable(!1)},tagMaterialWithGeometryInfo:function(e,t){var n=new or(this,t);e.accept(n)},updateTexCoordUnitList:function(){var e=this.attributes;for(var t in e)e[t].updateTexCoordUnitList()},findFirstMaterial:function(){var e=new ar;return function(t){var n=t.length,i=t[n-1];if(i._mostInfluencedRig)return e.reset(),e.setManager(this),i._mostInfluencedRig.accept(e),e._material;for(var r=n-1;r>=0;--r){var a=t[r].getStateSet();if(a){var o=this.getMaterialByStateSet(a);if(o)return o}}}}(),getJSON:function(){var e={},t=this.attributes;for(var n in t)e[n]=t[n].getJSON();return e},editorGetJSON:function(){var e={},t=this.getImageCollection(),n=this.getMatcapCollection();for(var i in this.attributes){var r=this.attributes[i].getJSON(),a=r.channels;for(var o in a){var s=a[o];if(s.texture){var u=("Matcap"===o?n:t).get(s.texture.uid).get("name");s.texture.name=u,delete s.texture.uid,delete s.texture.texCoordUnit,delete s.texture.textureTarget}}e[i]={shadeless:r.shadeless,name:r.name,cullFace:r.cullFace,reflection:r.reflection,channels:a}}return e},editorSetJSON:function(e){var t=this.getImageCollection(),n=this.getMatcapCollection(),i=function(e,i){for(var r=[],a=0,o=nn.a.length;a<o;a++){var s=nn.a[a],u=e.channels[s];if(u&&u.texture&&u.texture.name){var l=("Matcap"===s?n:t).where({name:u.texture.name})[0];l?u.texture.uid=l.getUID():(e.channels[s]=void 0,r.push("texture "+u.texture.name+" not found in the current scene, skipping channel "+s+" for material "+i.get("name")))}}var c=i.setMaterialJSON(e,t,{validate:!0});return c?h.a.reject(c):h.a.resolve(r)},r=[];for(var a in this.attributes){var o=e[a];o&&r.push(i(o,this.attributes[a]))}return h.a.all(r)}});sr.createMaterialModel=function(e){var t=new Ui;new nr({model:t});var n=e.getName();return n&&t.set("name",n),(new ki.a).setMaterialModel(t),t.setStateSet(e),t};var ur=sr,lr={FeatureName:"material",ModelType:ur.extend({_textureTrashbin:[],_matcapTrashbin:[],getName:function(){return"Material"}}),ViewListType:[Pi]},cr=i.a.create(lr);cr.prototype.getSceneLights=function(){return this._views[0].getSceneLights()};var hr=cr,dr=a.a.extend({initialize:function(){a.a.prototype.initialize.apply(this,arguments),this._wireframeSchema=this.getSubSchema("wireframe");var e=this.getInstance(this._wireframeSchema);this.set("wireframeEnable",e.enable),this.set("wireframeColor",e.color)},getModelOptionPath:function(){return"shading"},defaults:function(){return{hasWireframe:!0,hasVertexColor:!1,hasVertexAlpha:!1,hasPoints:!1,hasLines:!1,hasTriangles:!1,webVR:!1}},getName:function(){return"ShadingStyle"},init:function(e){this.set("hasWireframe",!!e.getScene().getWireframeSize()),this.set("vertexColorUseAlpha",Object(Qt.a)()),this.set("vertexColorColorSpace",Object(Qt.a)()?"srgb":"linear"),this.set("pointSize",Object(Qt.a)()?2:0);var t=e.getModel().get("options"),n=t.shading,i=t.wireframe;n&&this.setJSON({shading:n,wireframe:i}),Object(Qt.a)()&&k.a.getMaterial().then(function(){var t=e.getFeatures().material.getModel();this.set("renderer","pbr",{copyChannel:!0,overrideTexture:!1}),t._style&&this.set("type",t._style)}.bind(this))},setWireframeColorSmooth:function(e){this.trigger("setWireframeColorSmooth",e)},setWireframeJSON:function(e,t){if(t&&t.validate){var n=this.validate(e,{schema:this._wireframeSchema});if(n.length)return n.join("\n")}return void 0!==e.enable&&this.set("wireframeEnable",e.enable),e.color&&e.enable&&this.set("wireframeColor",e.color),[]},setJSON:function(e,t){var n=a.a.prototype.setJSON.call(this,e.shading,t),i=this.setWireframeJSON(e.wireframe,t);return n.concat(i),n},getJSON:function(){return{shading:a.a.prototype.getJSON.call(this),wireframe:{enable:this.get("wireframeEnable"),color:this.get("wireframeColor")}}},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0})}}),fr=d.a.osg,pr={FeatureName:"shadingStyle",ModelType:dr,ViewListType:[D.a.extend({initialize:function(e){D.a.prototype.initialize.apply(this,arguments);var t=this.model;t.bind("change:webVR",this.onWebVRChanged,this),t.bind("change:renderer",this.onRendererChanged,this),t.bind("change:type",this.onShadingChanged,this),t.bind("change:pointSize",this.onPointSizeChanged,this),t.bind("change:wireframeEnable",this.onWireframeEnableChanged,this),t.bind("change:wireframeColor",this.onWireframeColorChanged,this),t.bind("change:vertexColorEnable",this.onVertexColorChanged,this),t.bind("change:vertexColorUseAlpha",this.onVertexColorChanged,this),t.bind("change:vertexColorColorSpace",this.onVertexColorChanged,this),t.bind("setWireframeColorSmooth",this.onSetWireframeColorSmooth,this),this._viewer=e.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._rootStateSet=this._viewerOSGJS.getSceneData().getOrCreateStateSet(),this._rootStateSet.setShaderGeneratorName(this.getCompilerName()),this.updateShadingGlobal(),this._wireframeNodes=e.context.getScene().getWireframeNodes(),k.a.getPolygon().then(function(){this.model.set("hasVertexColor",ki.a.hasVertexColor),this.model.set("hasVertexAlpha",ki.a.hasVertexAlpha),!1===ki.a.hasVertexColor&&this.model.set("vertexColorEnable",!1),!1===ki.a.hasVertexAlpha&&this.model.set("vertexColorUseAlpha",!1),this.onVertexColorChanged(),this.model.set("hasPoints",f.a.hasPoints),this.model.set("hasTriangles",f.a.hasTriangles),this.model.set("hasLines",f.a.hasLines)}.bind(this)),X.a.getBoxReady().then(this.onPointSizeChanged.bind(this)),k.a.getWireframeOptimizedSplit().then(this.initWireframe.bind(this)),this._viewer.bind("resizeRatio",this.updatePointSize,this),k.a.getMaterial().then(function(){this._viewer.getFeatures().camera.getModel().bind("change:fov",this.onPointSizeChanged,this)}.bind(this))},onWebVRChanged:function(){for(var e=this._wireframeNodes,t=0,n=e.length;t<n;++t)e[t].getStateSet().setRenderBinVR(this.model.get("webVR"))},updatePointSize:function(){var e=this._viewer.getFeatures(),t=this._viewer.getFeaturesManager(),n=X.a.getModelBoxWithDisplacement().radius();n*=this.model.get("pointSize"),n*=45/e.camera.getModel().get("fov"),n*=75e-5*t.getViewport3d().height(),tr.cachedSquarePoint.setPointSize(n),tr.cachedCirclePoint.setPointSize(n)},onPointSizeChanged:function(){this.updatePointSize(),V.a.draw()},initWireframe:function(){var e=!0===this.model.get("wireframeEnable")?_e.a.NO_PICK_NO_SHADOW:0;this.setWireframeNodesMask(e);var t=this.setWireframeNodesMask.bind(this,0);an.a.updateCallback.setFinishCallback(t),this.onWireframeColorChanged(),this.model.get("wireframeEnable")&&this.onWireframeEnableChanged()},setWireframeNodesMask:function(e){for(var t=this._wireframeNodes,n=0,i=t.length;n<i;++n)t[n].setNodeMask(e);Oi.setWireframe(0!==e)},getCompilerName:function(){var e=this.model.get("type");return"matcap"===e||"inspector"===e?e:e+"-"+this.model.get("renderer")},updateShadingGlobal:function(){var e,t=this.model.get("type"),n="pbr"===this.model.get("renderer");e="matcap"===t?rn.a.MATCAP:"inspector"===t?rn.a.INSPECTOR:"shadeless"===t?n?rn.a.PBR_SHADELESS:rn.a.CLASSIC_SHADELESS:n?rn.a.PBR_LIT:rn.a.CLASSIC_LIT,rn.a.set("mask",e)},_overrideChannelTexture:function(e,t,n){e.getTextureModel()?!n&&t.getTextureModel()||t.setTextureModel(e.getTextureModel().clone()):!t.getTextureModel()&&t.setColor&&e.getColor&&t.setColor(e.getColor())},copyChannels:function(e,t,n){var i={DiffusePBR:"DiffuseColor",AlbedoPBR:"DiffuseColor",AOPBR:"DiffuseIntensity"};for(var r in i){var a=t.getChannels(),o=a[r],s=a[i[r]];if("pbr"!==e){var u=t.isWorkflowMetalness();(u&&"DiffusePBR"!==r||!u&&"AlbedoPBR"!==r)&&this._overrideChannelTexture(o,s,n)}else this._overrideChannelTexture(s,o,n)}},onRendererChanged:function(e,t,n){this.onShadingChanged();var i=this.model.get("renderer"),r=void 0===n.copyChannel||n.copyChannel,a=void 0===n.overrideTexture||n.overrideTexture,o=this._viewer.getFeatures().material;if(o){var s=o.getModel().attributes;if(r)for(var u in s)this.copyChannels(i,s[u],a);V.a.draw()}else fr.error("The renderer has been changed before the material feature is initialized")},onShadingChanged:function(){this.updateShadingGlobal(),this._rootStateSet.setShaderGeneratorName(this.getCompilerName()),V.a.draw()},onWireframeColorChanged:function(){for(var e=this._wireframeNodes,t=0,n=e.length;t<n;++t)e[t].getStateSet().setWireframeColor(this.getRGBA())},onSetWireframeColorSmooth:function(e){var t=this.model;t.off("change:wireframeColor",this.onWireframeColorChanged,this),t.set("wireframeColor",e),t.bind("change:wireframeColor",this.onWireframeColorChanged,this);for(var n=this._wireframeNodes,i=0,r=n.length;i<r;++i)n[i].getStateSet().setWireframeColorSmooth(this.getRGBA());t.off("change:wireframeColor",this.onWireframeColorChanged,this),t.set("wireframeColor",e),t.on("change:wireframeColor",this.onWireframeColorChanged,this)},onWireframeEnableChanged:function(){this.setWireframeNodesMask(_e.a.NO_PICK_NO_SHADOW);for(var e=this._wireframeNodes,t=this.model.get("wireframeEnable"),n=0,i=e.length;n<i;++n)e[n].getStateSet().setWireframeEnable(t,this.getRGBA())},getRGBA:function(){var e=fr.vec4.create();return function(t){var n=t||this.model.get("wireframeColor");return e[0]=parseInt(n.substr(0,2),16)/255,e[1]=parseInt(n.substr(2,2),16)/255,e[2]=parseInt(n.substr(4,2),16)/255,e[3]=parseInt(n.substr(6,2),16)/255,e}}(),_inspectorForceAlpha:function(){var e=this._viewer.getFeatures().inspector.getModel();return"Default"!==e.get("displayView")&&-1!==e.get("availableDisplayView").indexOf("VertexAlpha")},onVertexColorChanged:function(){var e=this._viewer.getFeatures().material;if(e){var t=this.model.get("vertexColorEnable"),n=this.model.get("vertexColorColorSpace"),i=this.model.get("vertexColorUseAlpha")&&(this._inspectorForceAlpha()||t),r=e.getModel().attributes;for(var a in r){var o=r[a];o.set("vertexColorEnable",t&&o.get("hasVertexColor")),o.set("vertexColorColorSpace",n);var s=i&&o.get("hasVertexAlpha");o.set("vertexAlphaEnable",s)}V.a.draw()}}})]},gr=i.a.create(pr),mr=n("G9Ht"),vr=n.n(mr),_r=d.a.osg,br=bi.a.extend({defaults:function(){var e=1;return vr.a.any?e=0:Object(o.a)()&&(e=2),this._deferReady=Object(it.a)(),{promiseReady:this._deferReady.promise,level:e,maxQuality:!1,dynamicResolutionScaling:_r.vec2.fromValues(1,1)}},getBudget:function(){var e=Object(u.a)();return void 0!==e.pixelBudget?e.pixelBudget<0?1/0:e.pixelBudget:this.getBudgetFromLevel(this.get("level"))},getBudgetFromLevel:function(e){return 0===e?6144:1===e?12288:1/0},getName:function(){return"Quality"}}),Sr=n("0iCP"),yr=n("mbgM"),xr=d.a.osg.Timer.instance(),Cr=Object(u.a)().drs?Object(u.a)().drsRatio:0,wr=Object(u.a)().drsMin,Tr=1e3/Object(u.a)().drsFps,Mr={FeatureName:"quality",ModelType:br,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments);var e=this.options.context;this._viewer=e.getViewer(),this._fMaterial=e.getFeatures().material,this._version=e.getModel().get("options").version,this.model.bind("change:level",this.onLevelChanged,this),this.model.bind("updateTexelPolicy",this.updateTexelPolicy,this),this.model.bind("updateDynamicResolutionScaling",this._updatePixelRatio.bind(this)),this._maxSize=Object(Sr.a)(),this._resumeDrs=1,this._resumeQuality=1,this._resumeAfterSSAA=!0,this._drsTest=Object(u.a)().drsTest,this._lastTickIncreaseDrs=0,this._lastTickIncreasePP=0,this._continuousDrs=0,this._continuousQuality=0,k.a.getFirstCameraAnimation().then(this.initTimers.bind(this))},initTimers:function(){this._lastTick=xr.tick(),this._viewer.getRootScene().addUpdateCallback(this)},_updatePixelRatio:function(){var e=this.model.get("dynamicResolutionScaling"),t=this._viewer.getViewerOSGJS().getCanvasPixelRatio(),n=this._viewer.getInputManager().getParam("pixelRatio");n[0]=t*e[0],n[1]=t*e[1]},_forceFullRes:function(){if(this.model.get("maxQuality"))return!0;var e=this._viewer.getSuperSample();return!(!e.isEnabled()&&!e.isFakeEnabled())||!!this._viewer.getFeatures().webVR.getModel().get("enable")},_sceneBeingDrawn:function(){return this._viewer.getFeatures().postProcess.getCamera().getNodeMask()},_handleQualitySSAA:function(){var e=this._viewer.getFeatures().postProcess.getModel(),t=this.model.get("dynamicResolutionScaling");if(this._forceFullRes()){if(this._resumeAfterSSAA)return!0;this._resumeQuality=e.getQuality(),this._resumeDrs=t[0],t[0]=1;var n=this.model.get("maxQuality")?1.01:Math.max(.5,.3+this._resumeQuality);return e.setQuality(n),this._resumeAfterSSAA=!0,!0}return!this._sceneBeingDrawn()||!!this._resumeAfterSSAA&&(this._resumeAfterSSAA=!1,t[0]=this._resumeDrs,e.setQuality(this._resumeQuality),this._continuousQuality=this._resumeQuality,this._continuousDrs=this._resumeDrs,!0)},_updateQuality:function(e,t){if(!this._handleQualitySSAA()){var n=e-t,i=this._viewer.getFeatures().postProcess.getModel(),r=this.model.get("dynamicResolutionScaling"),a=(Tr-n)/Tr;this._continuousDrs=this._continuousDrs+this._continuousDrs*Cr*a,this._continuousDrs=Math.min(1,Math.max(wr,this._continuousDrs));var o=Math.min(1,1.2*r[0]);if(this._continuousDrs<r[0]?(r[0]=this._continuousDrs,this._lastTickIncreaseDrs=e):this._continuousDrs>=o&&e-this._lastTickIncreaseDrs>500&&(r[0]=o,this._lastTickIncreaseDrs=e),this._drsTest){this._drsTest++,r[0]=this._drsTest%200>100?1:.3,V.a.draw()}var s=(1e3/55-n)/(1e3/55);this._continuousQuality=Math.min(Math.max(0,this._continuousQuality+s),1);var u=i.getQuality(),l=Math.min(1,u+.2),c=Math.max(0,u-.2);e-this._lastTickIncreasePP>500&&(this._continuousQuality<c?(i.setQuality(c),this._lastTickIncreasePP=e):this._continuousQuality>=l&&(i.setQuality(l),this._lastTickIncreasePP=e))}},update:function(){var e=this.model.get("dynamicResolutionScaling"),t=e[0],n=xr.tick();return this._updateQuality(n,this._lastTick),this._lastTick=n,e[1]=e[0],t!==e[0]&&this.model.trigger("updateDynamicResolutionScaling"),!0},getMaterials:function(){return this._fMaterial.getModel().attributes},onLevelChanged:function(){this.updateTexelPolicy();var e=this._fMaterial._views[0].requestAllHighResTextures(this._fMaterial.getModel().attributes);this._viewer.setFakeSecondaryProgress(e,"texture"),this._fMaterial._views[0].cleanAndApplyMaterials()},getOrCreateTexelInfos:function(){return this._fMaterial._views[0].getOrCreateTexelInfos()},getMaxSizeFromBudget:function(e){var t=e*e,n=this.getOrCreateTexelInfos();if(0===n.gpuTextureCount||n.gpuPixelCount<=t)return this._maxSize;var i=Math.min(this._maxSize,Math.sqrt(t/n.gpuTextureCount));return i=yr.a.snapToPowerOf2(i,.75),this._version<2&&(i<1024?i=512:i>=1024&&i<2048&&(i=2048)),n.max<=i||n.gpuPixelCount<=i*i?this._maxSize:i},_printErrorMissingResolution:function(e){var t=Object.keys(e.missingTextures).length;if(0===t)return 0;var n="",i=e.missingTextures;for(var r in i)n+="\n"+r+" ("+i[r].join(", ")+")";return console.error("Multi-resolution textures missing : "+t+n),t},updateTexelPolicy:function(){if(Object(u.a)().imageCompression){var e=this.getOrCreateTexelInfos(),t=this._printErrorMissingResolution(e);0===e.gpuTextureCount||t>=e.gpuTextureCount||(this.model.get("promiseReady").isPending()&&this.initAvailableTextureQuality(),Object(u.a)().maxTextureSize=this.getMaxSizeFromBudget(this.model.getBudget()))}},initAvailableTextureQuality:function(){var e=this.getMaxSizeFromBudget(this.model.getBudgetFromLevel(0)),t=this.getMaxSizeFromBudget(this.model.getBudgetFromLevel(1)),n={low:!0,mid:t!==e,high:t!==this._maxSize},i=this.model.get("level");n.high||2!==i||(i=1),n.mid||1!==i||(i=0),1===i&&(n.low=!1),this.model.off(null,this.onLevelChanged,this),this.model.set("level",i),this.model.on("change:level",this.onLevelChanged,this),this.model._deferReady.resolve(n)}})]},Er=i.a.create(Mr);Er.prototype.prepareForScreenShot=function(){this._model.set("maxQuality",!0)},Er.prototype.resetAfterScreenShot=function(){this._model.set("maxQuality",!1)};var Ar=Er,Or=Ni.a.Model.extend({defaults:{enable:!1,paused:!1,speed:.6},getName:function(){return"Autospin"},init:function(){var e=Object(u.a)();void 0!==e.autospin&&(this.set("enable",!!e.autospin),this.set("speed",e.autospin))}}),Rr=d.a.osg,Pr=function(e,t,n){this._speed=void 0!==e?e:-.6,this._fadeStart=void 0!==t?t:2,this._fadeEnd=void 0!==n?n:2,this._enable=!0,this._rotation=0,this._lastTime=-1,this._startTime=0,this._endTime=0,this._checkIfFinished=!1,this._fixedCenter=void 0};Rr.createPrototypeObject(Pr,{setSpeed:function(e){this._speed=e},setFadeStart:function(e){this._fadeStart=e},setFadeEnd:function(e){this._fadeEnd=e},deactivate:function(){this._enable=!1},resume:function(){this._enable=!0,this._checkIfFinished=!1;var e=Math.max((this._endTime-this._lastTime)/this._fadeEnd,0);this._startTime=this._lastTime-this._fadeStart*e,this._endTime=this._lastTime,V.a.draw()},pause:function(){var e=Math.min((this._lastTime-this._startTime)/this._fadeStart,1);this._endTime=this._lastTime+this._fadeEnd*e,this._checkIfFinished=!0},update:function(){var e=Rr.mat4.create();return function(t,n){if(!1===this._enable)return!0;V.a.draw();var i=n.getFrameStamp().getSimulationTime();if(!0===this._checkIfFinished&&this._endTime<i)return this._enable=!1,this._checkIfFinished=!1,this._lastTime=-1,!0;if(this._lastTime<0)return this._lastTime=i,this._startTime=i,!0;var r=i-this._lastTime;this._lastTime=i,this._endTime>i?this._rotation+=r*Rr.smoothStep(0,1,(this._endTime-i)/this._fadeEnd):i-this._startTime<this._fadeStart?this._rotation+=r*Rr.smoothStep(0,1,(i-this._startTime)/this._fadeStart):this._rotation+=r;var a=t.getMatrix();Rr.mat4.fromZRotation(a,-this._rotation*this._speed);var o=t.getChildren();if(o.length>0){if(!this._fixedCenter){var s=o[0].getMinimumBound();s.valid()&&(this._fixedCenter=Rr.vec3.create(),Rr.vec3.copy(this._fixedCenter,s.center()))}var u=this._fixedCenter||o[0].getMinimumBound().center();Rr.vec3.negate(u,u),Rr.mat4.fromTranslation(e,u),Rr.mat4.multiply(a,a,e),Rr.vec3.negate(u,u),Rr.mat4.fromTranslation(e,u),Rr.mat4.multiply(a,e,a)}return t.dirtyBound(),!0}}()},"osgSketchfab","UpdateCallbackAutospin");var Ir=Pr,Nr=d.a.osg,Lr=d.a.InputGroups,kr={FeatureName:"autospin",ModelType:Or,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments),this._viewer=this.options.context.getViewer(),this._inputManager=this._viewer.getInputManager();var e=this.model;e.bind("change:enable",this.onEnableChanged,this),e.bind("change:paused",this.onPausedChanged,this),e.bind("change:speed",this.onSpeedChanged,this),this._nodeAutospin=new Nr.MatrixTransform,this._nodeAutospin.setName("Feature - Autospin"),this._callbackAutospin=new Ir(e.get("speed"),1,1),this._nodeAutospin.addUpdateCallback(this._callbackAutospin),!1===e.get("enable")&&this._callbackAutospin.deactivate(),Te.a.initAutospin(this,this.model.get("enable")),k.a.getModelDisplayed().then(this.linkWithEvents.bind(this))},isOrbit:function(){var e=this._viewer.getFeatures().camera;return e&&e.getModel().get("indexManipulator")===ve.ORBIT},linkWithEvents:function(){this._viewer.getFeatures().camera.getModel().bind("change:indexManipulator",this.onManipulatorChange.bind(this)),this.onManipulatorChange()},onManipulatorChange:function(){clearTimeout(this._timerAutospin),this.model.set("paused",!this.isOrbit())},pause:function(){clearTimeout(this._timerAutospin),this.model.set("paused",!0)},resume:function(){if(this.isOrbit()){var e=this.model;this._timerAutospin=setTimeout(function(){e.set("paused",!1)},5e3)}},onEnableChanged:function(){!0===this.model.get("enable")?(this._callbackAutospin.resume(),this._inputManager.setEnable(Lr.AUTOSPIN,!0)):(this._callbackAutospin.deactivate(),this._inputManager.setEnable(Lr.AUTOSPIN,!1))},onPausedChanged:function(){!1!==this.model.get("enable")&&(!0===this.model.get("paused")?this._callbackAutospin.pause():this._callbackAutospin.resume())},onSpeedChanged:function(){this._callbackAutospin.setSpeed(this.model.get("speed"))}})]},Dr=i.a.create(kr);Dr.prototype.getNode=function(){return this._views[0]._nodeAutospin};var Fr=Dr,Vr=d.a.osg,Br=a.a.extend({getModelOptionPath:function(){return"orientation"},defaults:{showGizmo:!1},getName:function(){return"Orientation"},init:function(e){this.setJSON(e.getModel().get("options").orientation);var t=Object(u.a)().scale,n=this.get("matrix");1!==t&&Vr.mat4.scale(n,n,Vr.vec3.fromValues(t,t,t))},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0})}}),Ur=d.a.osg,jr=function(e,t,n,i){this._model=n.model,this._manipulator=e,this._applyWithoutTranslation=!1,this._quatCurrent=Ur.mat4.getRotation(Ur.quat.create(),this._model.get("matrix")),this._quatTarget=Ur.quat.create(),this._quatStart=Ur.quat.create(),this._nodeGrid=n._nodeGrid,We.a.call(this,t),this._finished=!0,this._nodeGizmo=n._nodeGizmo,this._gizmoTra=n._gizmoTra,this._gizmoMode=!1,this._rootModel=i,this._nodeOrientation=n._nodeOrientation,this._features=n.options.context.getFeatures(),this._viewer=n._viewer,this._scaleModel=Ur.vec3.create(),this._worldCenter=Ur.vec3.create(),this._negateLocalCenter=Ur.vec3.create(),X.a.getBoxReady().then(this.initModelBound.bind(this))};Ur.createPrototypeObject(jr,Ur.objectInherit(We.a.prototype,{setQuatTarget:function(e){Ur.quat.copy(this._quatStart,this._quatCurrent),Ur.quat.copy(this._quatTarget,e),this.reset(),this._gizmoMode=!1},initModelBound:function(){var e=X.a.getModelBoxWithoutDisplacement();e.center(this._worldCenter);var t=this._rootModel.getMinimumBound();Ur.vec3.negate(this._negateLocalCenter,t.center());var n=e.radius();Ur.vec3.set(this._scaleModel,n,n,n),this._nodeGizmo.getMatrix()[14]-=.51*(e.getMax()[2]-e.getMin()[2])},setGizmoMode:function(e){this._gizmoMode=e,this.rotateNode(this._nodeOrientation)},getQuatTarget:function(){return this._quatTarget},getQuatStart:function(){return this._quatStart},update:function(e,t){if(this._gizmoMode){Ur.mat4.getRotation(this._quatCurrent,this._nodeGizmo.getMatrix()),this.rotateNode(e);var n=this._viewer.getFeaturesManager().getNodeGizmo();return this._editing&&!n.isEditing()&&this._model.trigger("orientationDirty"),this._editing=n.isEditing(),!0}if(this._finished)return!0;V.a.draw();var i=t.getFrameStamp().getSimulationTime(),r=this.interpolate(i,e,t);if(r=Ur.smoothStep(0,1,r),Ur.quat.slerp(this._quatCurrent,this._quatStart,this._quatTarget,r),this.rotateNode(e),this._finished){var a=this._nodeGizmo.getMatrix(),o=a[14];Ur.mat4.fromQuat(a,this._quatCurrent),a[14]=o,this._gizmoMode=this._model.get("showGizmo"),this._model.trigger("orientationDirty")}return!0},rotateNode:function(){var e=Ur.mat4.create();return function(t){var n=this._gizmoTra.getMatrix();Ur.mat4.fromTranslation(n,this._worldCenter);var i=t.getMatrix();Ur.mat4.fromQuat(i,this._quatCurrent),Ur.mat4.mul(i,n,i),Ur.mat4.translate(i,i,this._negateLocalCenter);var r=this._nodeGrid.getMatrix();Ur.mat4.scale(r,n,this._scaleModel),r[14]+=this._nodeGizmo.getMatrix()[14],Ur.mat4.invert(e,i),Ur.mat4.mul(r,e,r),this.updateShadows(),t.dirtyBound()}}(),updateShadows:function(){var e=this._features.environment;e&&e.getNode().updateShadow();var t=this._features.lighting;if(t)for(var n=t.getModel().get("lights"),i=0,r=n.length;i<r;++i)n[i].dirty()}}));var Gr=jr,Hr=n("yWLT"),zr=n("WIUU"),Wr=n.n(zr),qr=n("gspP"),Xr=n.n(qr),Yr=n("4HDP"),Kr=n.n(Yr),Qr=n("rGsq"),Jr=n.n(Qr),Zr=d.a.osg,$r=function(){Zr.MatrixTransform.call(this),this._timeGrid=0;var e=Zr.Uniform.createFloat4(Zr.vec4.fromValues(.5,.5,.5,0),"uColor");this._callbackColor=new Hr.a(e.getInternalArray(),1),this._callbackColor.setFinishCallback(this._disableGrid.bind(this)),this.addUpdateCallback(this._callbackColor);var t=this.getOrCreateStateSet();t.setAttributeAndModes(we.a.DEPTH_LEQUAL_WRITE),t.setAttributeAndModes(we.a.BLEND_SUBSTRACTIVE),t.setRenderBinDetails(Se.a.GRID,"RenderBin"),t.addUniform(e),this._grid=Zr.createGridGeometry(-1,-1,0,2,0,0,0,2,0,10,10),this._axis=Zr.createAxisGeometry(1),this.addChild(this._grid),this.addChild(this._axis),this._grid.getOrCreateStateSet().setAttributeAndModes(be.a.getOrCreateShader(Wr.a,Xr.a,"orientation-grid","Grid")),this._axis.getOrCreateStateSet().setAttributeAndModes(be.a.getOrCreateShader(Kr.a,Jr.a,"orientation-axis","OrientationAxis")),this._disableGrid()};Zr.createPrototypeNode($r,Zr.objectInherit(Zr.MatrixTransform.prototype,{showGridTemporary:function(e){this._grid.dirtyBound(),this._axis.dirtyBound(),this.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this._callbackColor.show(),window.clearTimeout(this._timeGrid),e&&(this._timeGrid=window.setTimeout(this.hideGrid.bind(this),1e3*e))},_invalidateNodeBound:function(e){e.dirtyBound(),e.getBoundingBox().init(),e.getBoundingSphere().init()},_disableGrid:function(){this.setNodeMask(0),this._invalidateNodeBound(this._grid),this._invalidateNodeBound(this._axis),this._invalidateNodeBound(this)},hideGrid:function(){this._timeGrid=0,this._callbackColor.hide()}}),"osgSketchfab","Grid");var ea=$r,ta=d.a.osg,na=d.a.osgUtil,ia={FeatureName:"orientation",ModelType:Br,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments);var e=this.model;e.bind("change:matrix",this.onMatrixChanged,this),e.bind("change:showGizmo",this.onGizmoShowChanged,this),e.bind("turn",this.onTurn,this),e.bind("reset",this.onReset,this),e.bind("orientationDirty",this.onOrientationDirty,this);var t=this.options.context;this._viewer=t.getViewer(),this._nodeGrid=new ea,this._nodeGrid.setName("Node grid"),this._nodeOrientation=new ta.MatrixTransform,this._nodeOrientation.setName("Feature - Orientation"),this._nodeOrientation.addChild(this._nodeGrid),this._nodeGizmo=new ta.MatrixTransform,this._nodeGizmo.setCullingActive(!1),this._nodeGizmo.editMask=na.NodeGizmo.PICK_ARC|na.NodeGizmo.PICK_ARROW_Z,this._gizmoTra=new ta.MatrixTransform,this._gizmoTra.setReferenceFrame(ta.Transform.ABSOLUTE_RF),this._gizmoTra.addChild(this._nodeGizmo);var n=this.model.get("matrix");this._nodeOrientation.setMatrix(n);var i=ta.mat4.getRotation(ta.quat.create(),n);ta.mat4.fromQuat(this._nodeGizmo.getMatrix(),i);var r=this._viewer.getRootModel(),a=this._viewer.getViewerOSGJS().getManipulator();this._callbackOrientation=new Gr(a,.5,this,r),this._nodeOrientation.addUpdateCallback(this._callbackOrientation)},onReset:function(){var e=ta.mat4.getTranslation(ta.vec3.create(),this.model.get("matrix"));ta.mat4.fromTranslation(this.model.get("matrix"),e),this.onMatrixChanged()},onTurn:function(e,t){var n="right"===t?1:-1,i="x"===e?n:0,r="y"===e?n:0,a="z"===e?n:0,o=ta.mat4.fromRotation(ta.mat4.create(),-Math.PI/2,ta.vec3.fromValues(i,r,a)),s=this.model.get("matrix");ta.mat4.multiply(s,o,s),this.onMatrixChanged()},onGizmoShowChanged:function(){var e=this.model.get("showGizmo"),t=this._viewer.getFeaturesManager();if(t){var n=t.getNodeGizmo();if(n){var i=this._nodeGizmo.getMatrix(),r=i[14];ta.mat4.copy(i,this.model.get("matrix")),i[12]=0,i[13]=0,i[14]=r,n.setForcePicking(e),n.setRotateInLocal(!e),n.setTranslateInLocal(!e),n.attachToNode(e?this._nodeGizmo:null),this._nodeGrid.showGridTemporary(e?0:2.5),this._callbackOrientation.setGizmoMode(e)}}},onMatrixChanged:function(){this.model.get("showGizmo")||this._nodeGrid.showGridTemporary(2.5),this._callbackOrientation.setQuatTarget(ta.mat4.getRotation(ta.quat.create(),this.model.get("matrix")))},onOrientationDirty:function(){var e=this.options.context.getFeatures().orientation.getNode();X.a.computePreciseBox(e),this.model.trigger("orientationChanged")},getNodeGrid:function(){return this._nodeGrid},getNodeOrientation:function(){return this._nodeOrientation}})]},ra=i.a.create(ia);ra.prototype.getNode=function(){return this._views[0].getNodeOrientation()},ra.prototype.getWidgetNode=function(){return this._views[0].getNodeGrid()};var aa,oa=ra,sa=n("YfG3"),ua={substancepainter:{"80fba9759ab94307a782f38d359b8ea8":{rotation:1.57,environmentExposure:8.5,lightIntensity:1.5,brightness:1},"2e9c3708feb74137b0436f946b8b66b8":{rotation:1.6,environmentExposure:2.5,lightIntensity:2,brightness:1.12},"268447ca0a954f44b06d1387863d114e":{rotation:6.25,environmentExposure:1.2,lightIntensity:2.5,brightness:1},"3e2ad3e1f1ea47679f045a7eb0e6af49":{rotation:.3,environmentExposure:.59,lightIntensity:2.5,brightness:1},"2fa15e0b1cee45a5b02605a288934e1b ":{rotation:.68,environmentExposure:2.5,lightIntensity:2.5,brightness:1},"9190e8da70694ef3b9d1d0c01541917e":{rotation:3.24,environmentExposure:1.7,lightIntensity:2.5,brightness:.57},"749a0594343e4ff9a2875cb411d0ad1a":{rotation:4.73,environmentExposure:.35,lightIntensity:3,brightness:1},f2dabeb04674446696486eea67028bd8:{rotation:4.71,environmentExposure:.35,lightIntensity:3,brightness:1.5},df380da788ee444885722735039b0c09:{rotation:.27,environmentExposure:.55,lightIntensity:3,brightness:1.46},"16cdcddf277d423d99094f8db0c731e9":{rotation:3.73,environmentExposure:1.5,lightIntensity:2.2,brightness:.53},c281dff366844cbc8b33179337037f42:{rotation:3.64,environmentExposure:4.5,lightIntensity:3,brightness:.53}}};aa={e871dd2920334a0f9c3107a00da3c24a:{uid:"e871dd2920334a0f9c3107a00da3c24a",name:"Gareoult",environmentExposure:.7,lightIntensity:3},"102d22e28ca34190a8470402ccdc35d3":{uid:"102d22e28ca34190a8470402ccdc35d3",name:"Milkyway",environmentExposure:6.8,lightIntensity:3},cd5e5b1607d844cdb928e96ff9c36b5c:{uid:"cd5e5b1607d844cdb928e96ff9c36b5c",name:"QueenMary chimney",environmentExposure:7,lightIntensity:3},"8653449395004fd58820874bfff93ce7":{uid:"8653449395004fd58820874bfff93ce7",name:"Kirby_cove",environmentExposure:.6,lightIntensity:4},"3e2ad3e1f1ea47679f045a7eb0e6af49":{uid:"3e2ad3e1f1ea47679f045a7eb0e6af49",name:"Gdansk shipyard buildings",environmentExposure:.4,lightIntensity:3},d348dfd2a8104ab0b8528f885d645eb3:{uid:"d348dfd2a8104ab0b8528f885d645eb3",name:"footprint",environmentExposure:1.2,lightIntensity:5},"2fa15e0b1cee45a5b02605a288934e1b":{uid:"2fa15e0b1cee45a5b02605a288934e1b",name:"glazed patio by restaurant",environmentExposure:2.7,lightIntensity:3},"5335c7c5c2434866ac8a442157f24f5e":{uid:"5335c7c5c2434866ac8a442157f24f5e",name:"tropical ruins",environmentExposure:2,lightIntensity:3},"9190e8da70694ef3b9d1d0c01541917e":{uid:"9190e8da70694ef3b9d1d0c01541917e",name:"industrial room",environmentExposure:1,lightIntensity:3},df380da788ee444885722735039b0c09:{uid:"df380da788ee444885722735039b0c09",name:"studio",environmentExposure:.8,lightIntensity:3},"4eda3e78ed214dc8852c439dc64b9c9d":{uid:"4eda3e78ed214dc8852c439dc64b9c9d",name:"road in dordogne",environmentExposure:.6,lightIntensity:2.5},"749a0594343e4ff9a2875cb411d0ad1a":{uid:"749a0594343e4ff9a2875cb411d0ad1a",name:"road in tenerife mountain",environmentExposure:.7,lightIntensity:3.5},c281dff366844cbc8b33179337037f42:{uid:"c281dff366844cbc8b33179337037f42",name:"urban exploring interior",environmentExposure:12,lightIntensity:3.3},"41192cc664484a0fa565da3361d10c9c":{uid:"41192cc664484a0fa565da3361d10c9c",name:"muir wood",environmentExposure:.9,lightIntensity:3},"5e7120378b00431ea18151e97a8366ec":{uid:"5e7120378b00431ea18151e97a8366ec",name:"treasure island",environmentExposure:.55,lightIntensity:3.5},e00dc642058b4176a4aaa449ea8ad5f8:{uid:"e00dc642058b4176a4aaa449ea8ad5f8",name:"trinitatis church",environmentExposure:.6,lightIntensity:4},e2aa1ab3582c4feab7371baf1e4cd734:{uid:"e2aa1ab3582c4feab7371baf1e4cd734",name:"arche pinetree",environmentExposure:2.3,lightIntensity:3.5},"2a016b232e444ef3a6ba323c51aa5063":{uid:"2a016b232e444ef3a6ba323c51aa5063",name:"tokyo bigsight",environmentExposure:2.3,lightIntensity:3.5}};var la=function(e){return ua[e]||aa},ca=n("OLaa"),ha=d.a.osg,da={uid:"9190e8da70694ef3b9d1d0c01541917e",brightness:1.6868},fa=a.a.extend({_trashbin:[],getModelOptionPath:function(){return"environment"},getRandomEnvironment:function(){var e=[];return this.environmentCollection.each(function(t){t.get("isDefault")&&-1===ca.a.indexOf(t.get("uid"))&&e.push({uid:t.get("uid"),brightness:t.get("brightness")})}),0===e.length?da:e[Math.round(Math.random()*(e.length-1))]},resetToDefaultEnvironment:function(){return this.set("uid",da.uid),this.set("exposure",da.brightness),this},defaults:function(){return{}},initDefaults:function(e){e.enable=Object(Qt.a)(),e.uid=da.uid,e.exposure=da.brightness,e.shadowEnable=Object(Qt.a)(),a.a.prototype.initDefaults.call(this,e)},init:function(e){this._context=e,this._viewer=e.getViewer();var t=e.getModel().get("options").environment,n=void 0===t.uid;t&&this.setJSON(t),this.environmentCollection=s.default.instance.getEnvironmentCollection(),n&&this.resetToDefaultEnvironment(),this.checkEnvironmentValidity(),Object(Qt.a)()?k.a.getPolygon().then(this.updateEnvironmentConfig.bind(this)):k.a.getPolygon().then(function(){var e=this.getEnvironment();if(e){var t=this._getYRotationFromLightDirection(e);this.set("lightRotation",t)}else this.checkEnvironmentValidity()}.bind(this)),Object(o.a)()&&Object(u.a)().apiLog&&(console.log("------"),console.log("Viewer API environment uid list:"),this.environmentCollection.each(function(e){console.log("- "+e.get("name")+": "+e.get("uid"))}),console.log("------"))},_getYRotationFromLightDirection:function(e){var t=e.get("lights"),n=0;if(t.length){var i=ha.vec3.clone(t[0].direction);if(Math.abs(i[1])<.99999){i[1]=0,ha.vec3.normalize(i,i);var r=Math.acos(i[0]);n=i[2]>0?r:2*Math.PI-r}}return n},updateEnvironmentConfig:function(){var e=this.getEnvironment();if(e){var t=this.get("rotation"),n=this.get("lightRotation"),i=this._getYRotationFromLightDirection(e);this.set("lightRotation",i);var r=0;void 0!==n&&(r=n-i);var a=2*Math.PI,o=(a+t+r)%a,s=la(this._viewer.getRootUserData().source)[e.get("uid")];s?(void 0!==s.environmentExposure&&this.set("exposure",parseFloat(s.environmentExposure)),void 0!==s.lightIntensity&&this.set("lightIntensity",parseFloat(s.lightIntensity)),void 0!==s.brightness&&this.set("backgroundExposure",parseFloat(s.brightness)),void 0!==s.rotation&&(o=parseFloat(s.rotation))):this.set("exposure",parseFloat(e.get("brightness"))||1),this.set("rotation",o);var u=this._viewer.getRootUserData();Object(Qt.a)()&&"Tilt Brush"===u.authoringTool&&(this.set("uid","3e2ad3e1f1ea47679f045a7eb0e6af49"),this.set("exposure",.5))}else this.checkEnvironmentValidity()},getEnvironmentCollection:function(){return this.environmentCollection},checkEnvironmentValidity:function(){this.getEnvironment()||(this.set("uid",da.uid),this.set("exposure",da.brightness))},getName:function(){return"Environment"},getEnvironment:function(){var e=this.get("uid");return this.environmentCollection.find(function(t){return t.get("uid")===e})},isShadowEnable:function(){return this.get("shadowEnable")},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0})}}),pa=n("82Lz"),ga=n.n(pa),ma=n("XZvc"),va=n.n(ma),_a=d.a.osg,ba={},Sa=function(e,t){if(ba[e])return ba[e];var n=e.toLowerCase();return ba[e]=be.a.getOrCreateShader(ga.a,va.a,n,t,e),ba[e]},ya=function(){return Sa("LINE","LightingLineGizmo")},xa=we.a.BLEND_SUBSTRACTIVE,Ca={},wa=function(e){if(Ca[e])return Ca[e];var t=ye.iconsLight[e];t||(t=ye.iconsLight.DIRECTION);var n=s.default.instance.getOrCreateTexture(t,{internalFormat:_a.Texture.RGBA});return Ca[e]=n.texture,n.texture},Ta={};Ta.createIconGeometry=function(){var e=_a.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),t=e.getOrCreateStateSet();return t.setTextureAttributeAndModes(1,wa("DIRECTION")),t.addUniform(_a.Uniform.createInt(1,"uTextureIcon")),t.setAttributeAndModes(xa),t.setAttributeAndModes(Sa("ICON","LightingIcon")),e.setLightType=function(e){t.setTextureAttributeAndModes(1,wa(e))},e},Ta.createDirectionalGeometry=function(e){for(var t=void 0===e?-1:-e,n=t/15,i=2*Math.PI,r=new Float32Array(180),a=0;a<5;++a){var o=6*a,s=i*a/5;r[o]=r[o+3]=Math.cos(s)*n,r[o+1]=r[o+4]=Math.sin(s)*n,r[o+5]=t}var u=new _a.DrawArrays(_a.primitiveSet.LINES,0,30),l=new _a.Geometry;return l.getAttributes().Vertex=new _a.BufferArray(_a.BufferArray.ARRAY_BUFFER,r,3),l.getPrimitives().push(u),l.getOrCreateStateSet().setAttributeAndModes(ya()),l.getOrCreateStateSet().setAttributeAndModes(xa),l},Ta.createSpotGeometry=function(e){var t=void 0===e?-1:-e,n=2*Math.PI,i=new _a.Geometry,r=new Float32Array(300),a=i.getAttributes().Vertex=new _a.BufferArray(_a.BufferArray.ARRAY_BUFFER,r,3),o=0,s=new Uint16Array(50);for(o=0;o<50;++o)s[o]=2*o+1;var u=new _a.DrawElements(_a.primitiveSet.LINE_LOOP,new _a.BufferArray(_a.BufferArray.ELEMENT_ARRAY_BUFFER,s,1)),l=new Uint16Array(10);for(o=0;o<5;++o)l[2*o]=20*o,l[2*o+1]=20*o+1;var c=new _a.DrawElements(_a.primitiveSet.LINES,new _a.BufferArray(_a.BufferArray.ELEMENT_ARRAY_BUFFER,l,1));return i.getPrimitives().push(c,u),i.getOrCreateStateSet().setAttributeAndModes(ya()),i.getOrCreateStateSet().setAttributeAndModes(xa),i.updateCone=function(e,s){var u=s?2*-s:t,l=Math.cos(e)*u,c=Math.sin(e)*u;for(o=0;o<50;++o){var h=6*o,d=n*o/50;r[h+3]=Math.cos(d)*c,r[h+4]=Math.sin(d)*c,r[h+5]=l}a.dirty(),i.dirtyBound()},i.updateCone(.1),i},Ta.createHemiGeometry=function(e){for(var t=void 0===e?-1:-e,n=new _a.Geometry,i=new Float32Array(450),r=Math.PI,a=0;a<50;++a){var o=3*a,s=r*a/49,u=Math.cos(s),l=Math.sin(s);i[o]=u*t,i[o+2]=-l*t,i[150+o+1]=u*t,i[150+o+2]=-l*t,s=2*r*a/49,i[300+o]=Math.cos(s)*t,i[300+o+1]=Math.sin(s)*t}n.getAttributes().Vertex=new _a.BufferArray(_a.BufferArray.ARRAY_BUFFER,i,3);var c=new _a.DrawArrays(_a.primitiveSet.LINE_STRIP,0,50),h=new _a.DrawArrays(_a.primitiveSet.LINE_STRIP,50,50),d=new _a.DrawArrays(_a.primitiveSet.LINE_STRIP,100,50);n.getPrimitives().push(c,h,d);var f=n.getOrCreateStateSet();return f.setAttributeAndModes(Sa("HEMI","LightingHemiGizmo")),f.setAttributeAndModes(xa),f.addUniform(_a.Uniform.createFloat(-t,"uRadius")),n},Ta.createPointGeometry=function(){var e=2*Math.PI,t=new _a.Geometry,n=new Float32Array(1350),i=t.getAttributes().Vertex=new _a.BufferArray(_a.BufferArray.ARRAY_BUFFER,n,3),r=new _a.DrawArrays(_a.primitiveSet.LINE_STRIP,0,50),a=new _a.DrawArrays(_a.primitiveSet.LINE_STRIP,50,50),o=new _a.DrawArrays(_a.primitiveSet.LINE_STRIP,100,50);return t.getPrimitives().push(r,a,o),t.getOrCreateStateSet().setAttributeAndModes(ya()),t.getOrCreateStateSet().setAttributeAndModes(xa),t.updateRadius=function(r){for(var a=0;a<50;++a){var o=3*a,s=e*a/49;n[o]=n[150+o]=n[300+o+1]=Math.cos(s)*r,n[o+1]=n[150+o+2]=n[300+o+2]=Math.sin(s)*r}i.dirty(),t.dirtyBound()},t.updateRadius(1),t};var Ma,Ea=Ta,Aa=n("93PM"),Oa=n("1f5D"),Ra=d.a.osg,Pa=Object(u.a)().shadow,Ia=Object(u.a)().shadowAtlas,Na=Ia?7:12,La=Object(u.a)().shadowTextureSize;d.a.osgShadow.ShadowMap.prototype._preventTextureBindingDuringShadowCasting=function(){for(var e=Object(Xi.a)(),t=Ra.StateAttribute.OVERRIDE_ON,n=0;n<e;n++)this._casterStateSet.setTextureAttributeAndModes(n,Ra.Texture.textureNull,t)};var ka,Da,Fa=function(e){return(Ma=new d.a.osgShadow.ShadowSettings).setLight(e),Ma.setShadowCastShaderGeneratorName("shadowcast"),Ma.setCastsShadowDrawTraversalMask(_e.a.SHADOW),Ma.setCastsShadowBoundsTraversalMask(_e.a.SHADOW_BOUNDS),Ma.userShadowCasterVisitor=!1,Ma.kernelSizePCF=Object(u.a)().shadowPCF,Ma.fakePCF=!1,Ma.setTextureSize(Object(u.a)().shadowTextureSize),Ma};Ia&&((ka=Fa()).atlasSize=2*La,ka.setTextureSize(La),(Da=new d.a.osgShadow.ShadowMapAtlas(ka)).setTextureUnitBase(Na));var Va=Oa.a.uShadowMapSize.getInternalArray();Va[0]=La,Va[1]=La;var Ba=function(e,t,n){var i=new Ra.MatrixTransform;i.setName(e+" - LightNode "+t),i.getOrCreateStateSet().setAttributeAndModes(we.a.DEPTH_DISABLE);var r=new Tt(t);n&&r.setLightType(n),r.setName(e+" - Light "+t),Ra.vec3.copy(r.getAmbient(),Ra.vec3.ZERO),Ra.vec3.copy(r.getSpecular(),Ra.vec3.ZERO),r.setLinearAttenuation(0);var a,o,s=new Ra.LightSource;if(s.setName("skfb"+e+" - LightSource "+t),s.setLight(r),!Pa)return{node:i,light:r,lightSource:s,shadowSettings:Da?ka:Fa(r),enableShadow:!1};if(Da?(o=ka,a=Da.addLight(r)):(o=Fa(r),(a=new d.a.osgShadow.ShadowMap(o)).setTextureUnitBase(Na),a.setContinuousUpdate(!1),a.setTextureSize(Object(u.a)().shadowTextureSize)),a.setJitterOffset(Object(u.a)().shadowJitterOffset),Object(u.a)().stats){var l=a.getCamera(),c=Aa.a.getTimerGPU();l.setInitialDrawCallback(function(){c.start("ShadowMap"),c.start("ShadowMap"+t)}),l.setFinalDrawCallback(function(){c.end("ShadowMap"+t),c.end("ShadowMap")})}return{node:i,light:r,lightSource:s,shadowSettings:o,shadowMap:a,enableShadow:Pa&&Object(Xi.a)()>Na}},Ua=function(e,t){Pa&&(t.setContinuousUpdate(!1),Ia?(e.addShadowTechnique(Da),Da.addShadowMap(t)):e.addShadowTechnique(t))},ja=function(e,t){Ia?Da.removeShadowMap(t):e.removeShadowTechnique(t)},Ga=n("DWkk"),Ha=d.a.osg,za={ambient:Ha.Uniform.createInt1(0,"uAmbient"),texture0:Ha.Uniform.createInt1(0,"uTexture0"),backgroundExposure:Ha.Uniform.createFloat(1,"uBackgroundExposure"),size:Ha.Uniform.createFloat(1,"uSize"),color:Ha.Uniform.createFloat3(Ha.vec3.fromValues(0,0,1),"uBackgroundColor"),scale:Ha.Uniform.createFloat2(Ha.vec2.fromValues(1,1),"uFixedScale")},Wa=n("pts4"),qa=n.n(Wa),Xa=n("YVvG"),Ya=n.n(Xa),Ka=d.a.osg,Qa=function(){Ka.Node.call(this),this._geometry=Ka.createTexturedBoxGeometry(0,0,0,5,5,5),this._show="NONE",this._bgEnv=null,this._bgFixed=null,this._texRatio=1,this._canvasWidth=1,this._canvasHidth=1,this.init(),this.hide()};Ka.createPrototypeNode(Qa,Ka.objectInherit(Ka.Node.prototype,{init:function(){var e=this._geometry,t=e.getOrCreateStateSet();for(var n in t.setAttributeAndModes(we.a.DEPTH_LEQUAL_BACKGROUND_NO_WRITE,Ka.StateAttribute.PROTECTED),t.setRenderBinDetails(Se.a.BACKGROUND,"RenderBin"),t.setAttributeAndModes(be.a.getOrCreateShader(qa.a,Ya.a,"environment-background","Environment")),t.setTextureAttributeAndModes(0,Ga.a.dummyTexture),za)t.addUniform(za[n]);this.addChild(e)},rescale:function(e,t){e&&(this._canvasWidth=e),t&&(this._canvasHeight=t);var n=this._canvasWidth/this._canvasHeight,i=za.scale.getInternalArray();n>=this._texRatio?(i[0]=1,i[1]=this._texRatio/n):(i[0]=n/this._texRatio,i[1]=1)},getBackground:function(){return this._bgFixed},getEnvironment:function(){return this._bgEnv},hide:function(){this._show="NONE",this._update()},showColor:function(){this._show="COLOR",this._update()},showEnvironment:function(){this._show="ENV",this._update()},setEnvironment:function(e,t){this._bgEnv=e,void 0!==t&&za.size.setFloat(t),this._update()},setExposure:function(e){za.backgroundExposure.setFloat(e)},showAmbient:function(){this._show="AMBIENT",this._update()},showBackground:function(){this._show="FIXED",this._update()},setBackground:function(e){this._texRatio=e.getWidth()/e.getHeight(),this._bgFixed=e,this._update()},_update:function(){V.a.draw(),"ENV"===this._show||"AMBIENT"===this._show?(this._geometry.setNodeMask(-1),za.ambient.getInternalArray()[0]="AMBIENT"===this._show,this._bgEnv&&"ENV"===this._show&&this._geometry.getOrCreateStateSet().setTextureAttributeAndModes(0,this._bgEnv)):this._geometry.setNodeMask(0)}}),"osgSketchfab","Background");var Ja=Qa,Za=d.a.osg,$a={environmentTransform:Za.Uniform.createMatrix3("uEnvironmentTransform"),exposure:Za.Uniform.createFloat1(1,"uEnvironmentExposure"),diffuseSPH:Za.Uniform.createFloat3Array(new Float32Array(27),"uDiffuseSPH"),textureSpecular:Za.Uniform.createInt1("sEnvironmentSpecular"),textureSpecularPBR:Za.Uniform.createInt1("sSpecularPBR"),textureIntegrateBRDF:Za.Uniform.createInt1("sIntegrateBRDF"),factorShadowEnv0:Za.Uniform.createFloat(0,"uFactorShadowEnv0")},eo=d.a.osg,to=function(e,t){this._texture=e,this._channel=t||"Specular",this._isCubemap=!1,this._hash="Specular"===t?"EnvSpec":"SpecularPBR"===t?"EnvSpecPBR":"EnvBRDF"};to.uniforms={},eo.createPrototypeStateAttribute(to,eo.objectInherit(eo.Texture.prototype,{attributeType:"Texture",channelType:["Specular","SpecularPBR","IntegrateBRDF"],getUniformName:function(e){return"uTextureEnvironment"+this.getChannel()+e},getOrCreateUniforms:function(){var e=to.uniforms,t=this.getChannel();if(e[t])return e[t];var n=this._texture;return e[t]={size:eo.Uniform.createFloat2([n.getWidth(),n.getHeight()],this.getUniformName("TextureSize"))},e[t]},setIsCubemap:function(e){this._isCubemap=e},getIsCubemap:function(){return this._isCubemap},getUniforms:function(){return $a},getTexture:function(){return this._texture},getChannel:function(){return this._channel},cloneType:function(){return new to(new eo.Texture)},getHash:function(){return this._hash},updateLodRange:function(e){var t=this.getOrCreateUniforms(),n=Math.log(this._texture.getWidth())/Math.LN2,i=n-Math.log(e)/Math.LN2;if(t.lodRange){var r=t.lodRange.getInternalArray();r[0]=n,r[1]=i}else t.lodRange=eo.Uniform.createFloat2([n,i],this.getUniformName("LodRange"))},apply:function(e,t){var n=this._texture;void 0!==n&&n.apply(e);var i=this.getOrCreateUniforms(t).size.getInternalArray();i[0]=n.getWidth(),i[1]=n.getHeight()}}),"osgSketchfab","TextureEnvironment");var no=to,io=n("+cEC"),ro=d.a.osg,ao=function(e){ro.Node.call(this),this.getOrCreateStateSet(),this._enable=!0,this._viewer=e,this._isPBR=!1,this._textureSpecular=void 0,this._textureSpecularUnit=6,this._textureSpecularPBR=void 0,this._textureIntegrateBRDF=void 0,this._textureSpecularPBRUnit=6,this._textureIntegrateBRDFUnit=8,this._nodeBackground=new Ja,this._adjustRotation=ro.mat4.fromXRotation(ro.mat4.create(),Math.PI/2),this._root=new ro.MatrixTransform,ro.mat4.multiply(this._root.getMatrix(),this._root.getMatrix(),this._adjustRotation),this._lightProbes=[];var t=Ba("Environment",3,Tt.DIRECTION);this._light=t.light,this._mtLight=t.node,this._shadow=t.shadowMap,this._mtLight.addChild(t.lightSource),this._lightIntensity=1,this._lightShadowEnabled=!1,this._shadowBias=5e-4,this._shadowedScene=void 0,this._lightNodeRoot=new ro.MatrixTransform,this._lightNodeRoot.setName("Env Lighting - Light"),ro.mat4.copy(this._lightNodeRoot.getMatrix(),this._root.getMatrix()),this._lightNodeRoot.addChild(this._mtLight),this.addUpdateCallback(this),rn.a.bind("change:mask",this.updateLightShadow,this)};ro.createPrototypeNode(ao,ro.objectInherit(ro.Node.prototype,{getBackground:function(){return this._nodeBackground},enable:function(){this._enable=!0,this.setTexturesStateSet(),V.a.draw()},disable:function(){this._enable=!1,this.removeTexturesStateSet(),V.a.draw()},setBackgroundExposure:function(e){this._nodeBackground.setExposure(e),V.a.draw()},setBackgroundTexture:function(e,t){this._nodeBackground.setEnvironment(e,t),V.a.draw()},createCameraNode:function(){var e={},t=this,n=ro.mat4.create(),i=$a.environmentTransform.getInternalArray(),r=new ro.Camera;return r.setName("Environment - Camera"),r.setCullCallback(new function(){this.cull=function(r,a){ro.mat4.getPerspective(e,t._mainCamera.getProjectionMatrix()),ro.mat4.perspective(a.getCurrentProjectionMatrix(),e.fovy*Math.PI/180,e.aspectRatio,1,1e3),ro.mat4.copy(a.getCurrentModelViewMatrix(),t._mainCamera.getViewMatrix()),ro.mat4.setTranslation(a.getCurrentModelViewMatrix(),ro.vec3.ZERO);var o=a.getCurrentModelViewMatrix();return ro.mat4.multiply(n,o,t._root.getMatrix()),ro.mat3.fromMat4(i,n),ro.mat3.transpose(i,i),!0}}),r.setReferenceFrame(ro.Transform.ABSOLUTE_RF),io.a.cameraEnvironment=r,r},init:function(e,t){for(var n in this._mainCamera=e,this._shadowedScene=t,this._shadowedScene.addChild(this._lightNodeRoot),$a)this.getStateSet().addUniform($a[n]);var i=this.createCameraNode();i.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this.addChild(i),i.addChild(this._root),this._root.addChild(this._nodeBackground),this.updateTextureUnits(),this.updateLightShadow()},setLightShadowEnabled:function(e){this._lightShadowEnabled=e&&Object(u.a)().shadow,this.updateLightShadow()},setLightIntensity:function(e){this._lightIntensity=e,this.updateLightColorAndIntensity(),V.a.draw()},setShadowBias:function(e){this._shadowBias=e,this._shadow&&(this._shadow.setBias(e),this._shadow.requestRedraw(),V.a.draw())},setLightProbes:function(e){this._lightProbes=e,this.updateLightShadow()},removeTexturesStateSet:function(){var e=this.getStateSet();e&&(this._isPBR?(this._textureSpecularPBR&&e.removeTextureAttribute(this._textureSpecularPBRUnit,this._textureSpecularPBR.getTypeMember()),this._textureIntegrateBRDF&&e.removeTextureAttribute(this._textureIntegrateBRDFUnit,this._textureIntegrateBRDF.getTypeMember())):this._textureSpecular&&e.removeTextureAttribute(this._textureSpecularUnit,this._textureSpecular.getTypeMember()))},setTexturesStateSet:function(){var e=this.getStateSet();e&&(this._isPBR?(this._textureSpecularPBR&&e.setTextureAttributeAndModes(this._textureSpecularPBRUnit,this._textureSpecularPBR),this._textureIntegrateBRDF&&e.setTextureAttributeAndModes(this._textureIntegrateBRDFUnit,this._textureIntegrateBRDF)):this._textureSpecular&&e.setTextureAttributeAndModes(this._textureSpecularUnit,this._textureSpecular))},updateLightColorAndIntensity:function(){if(this._light&&0!==this._lightProbes.length){var e=$a.exposure.getInternalArray()[0]/this._defaultExposure,t=this._lightProbes[0].color;ro.vec3.normalize(t,t),ro.vec3.scale(this._light.getDiffuse(),t,this._lightIntensity*e)}},setDefaultExposure:function(e){this._defaultExposure=e},setExposure:function(e){$a.exposure.setFloat(e),this.updateLightColorAndIntensity()},updateLightFromProbes:function(){var e=this._lightProbes[0].direction,t=Math.abs(e[2])>.999?ro.vec3.fromValues(0,1,0):ro.vec3.fromValues(0,0,1),n=this._mtLight.getMatrix();ro.mat4.lookAtDirection(n,ro.vec3.ZERO,e,t),ro.mat4.invert(n,n),this.updateLightColorAndIntensity(),Object(u.a)().debugEnvShadow&&this._debugShadow()},_debugShadow:function(){if(!this._debugDone){this._debugDone=!0;var e=ro.createAxisGeometry(),t=new ro.MatrixTransform;t.setMatrix(ro.mat4.fromScaling(ro.mat4.create(),[100,100,-500])),ro.mat4.setTranslation(t.getMatrix(),[0,0,500]),t.addChild(e);var n=new Ea.createDirectionalGeometry(5);t.addChild(n),t.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this._mtLight.addChild(t)}},isUsingLightShadow:function(){return rn.a.get("mask")&rn.a.LIT&&this._lightShadowEnabled&&this._lightProbes.length>0},updateLightShadow:function(){if(this._shadowedScene){var e=this.isUsingLightShadow();if(this._light.setEnabled(e),ja(this._shadowedScene,this._shadow),e){var t=Object(Xi.a)();(Object(u.a)().shadowAtlas&&t>7||t>12)&&Ua(this._shadowedScene,this._shadow),this._shadow.setBias(this._shadowBias),ro.mat4.copy(this._lightNodeRoot.getMatrix(),this._root.getMatrix()),this.updateLightFromProbes(),this._shadow.requestRedraw(),V.a.draw()}}},update:function(e,t){if(e.getNumChildrenRequiringUpdateTraversal()>0&&t.traverse(e),!this._light||!this._shadow)return!1;var n=this._viewer.getFeaturesManager();return n&&n.getShadowForcedUpdate()&&this._shadow.requestRedraw(),!1},updateShadow:function(){this._light&&this._shadow&&this._shadow.requestRedraw()},updateRotation:function(e){ro.mat4.fromZRotation(this._root.getMatrix(),-e),ro.mat4.multiply(this._root.getMatrix(),this._root.getMatrix(),this._adjustRotation),ro.mat4.copy(this._lightNodeRoot.getMatrix(),this._root.getMatrix()),this._shadow&&this._shadow.requestRedraw()},setDiffuseSPH:function(e){for(var t=$a.diffuseSPH.getInternalArray(),n=1/(2*Math.sqrt(Math.PI)),i=-.5*Math.sqrt(3/Math.PI),r=-i,a=i,o=.5*Math.sqrt(15/Math.PI),s=-o,u=.25*Math.sqrt(5/Math.PI),l=s,c=.25*Math.sqrt(15/Math.PI),h=[n,n,n,i,i,i,r,r,r,a,a,a,o,o,o,s,s,s,u,u,u,l,l,l,c,c,c],d=0;d<27;++d)t[d]=e[d]*h[d]},setSpecularTexture:function(e){this._enable&&(this._textureSpecular=new no(e,"Specular"),this._textureSpecular.setIsCubemap(!0),this.updateTextureUnits(),$a.textureSpecular.setInt(this._textureSpecularUnit),V.a.draw())},setSpecularPBRTexture:function(e,t){if(this._enable){this._textureSpecularPBR=new no(e,"SpecularPBR");var n="TextureCubeMap"===e.className();this._textureSpecularPBR.setIsCubemap(n),this._textureSpecularPBR.updateLodRange(t),this.updateTextureUnits(),$a.textureSpecularPBR.setInt(this._textureSpecularPBRUnit),V.a.draw()}},setIntegrateBRDFTexture:function(e){this._enable&&(this._textureIntegrateBRDF=new no(e,"IntegrateBRDF"),this.updateTextureUnits(),$a.textureIntegrateBRDF.setInt(this._textureIntegrateBRDFUnit),V.a.draw())},updateTextureUnits:function(){this.setTexturesStateSet()},setIsPBR:function(e){this._isPBR=e}}),"osgSketchfab","Environment");var oo=ao,so=n("CXDX"),uo=d.a.osg,lo=d.a.InputGroups,co={FeatureName:"environment",ModelType:fa,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments),this._viewer=this.options.context.getViewer(),this._inputManager=this._viewer.getInputManager(),this._nodeEnvironment=new oo(this._viewer),this._nodeEnvironment.setName("Feature - Environment"),this._backgroundLoaded={},this.model.bind("change:enable",this.onEnableChanged,this),this.model.bind("change:exposure",this.onExposureChanged,this),this.model.bind("change:backgroundExposure",this.onExposureChanged,this),this.model.bind("change:rotation",this.onRotationChanged,this),this.model.bind("change:uid",this.onUIDChanged,this),this.model.bind("updateBackground",this.onBackgroundEnableChanged,this),this.model.bind("change:blur",this.onBlurChanged,this),rn.a.bind("change:mask",this.onEnvironmentChanged,this),this.model.bind("change",V.a.draw),this._resourceDefer=new it.a,this.options.context.getScene().addResourcePromise(this._resourceDefer),this.model.bind("change:shadowEnable",this.onShadowEnable,this),this.model.bind("change:shadowBias",this.onShadowBiasChanged,this),this.model.bind("change:lightIntensity",this.onLightIntensityChanged,this),k.a.getMaterial().then(function(){this.initEnvironment(),this.initRotateEnvironment()}.bind(this))},getBackgroundEnableType:function(){var e=this._viewer.getFeatures().background;return e?e.getModel().getEnableType():"none"},isBackgroundEnvironment:function(){return"environment"===this.getBackgroundEnableType()},initEnvironment:function(){this.onRotationChanged(),this.onExposureChanged(),this.onEnableChanged(),this.model.get("enable")||k.a.resolveDataSizeEnvironment(0)},initRotateEnvironment:function(){this._viewer.getViewerOSGJS()&&(this._rotEnv=!1,this.mx_=0,Te.a.initEnvironment(this))},startRotate:function(e){this._rotEnv=!0,this.mx_=e.canvasX,this._inputManager.setEnable(lo.MANIPULATORS,!1)},_computeDelta:function(e){V.a.draw();var t=(e.canvasX-this.mx_)/100;return this.mx_=e.canvasX,t},rotateEnv:function(e,t){if(this._rotEnv){t||(t=this._computeDelta(e));var n=(this.model.get("rotation")+t)%(2*Math.PI);this.model.set("rotation",n<0?n+2*Math.PI:n)}},rotateLight:function(){var e=uo.mat4.create(),t=uo.mat4.create();return function(n,i){if(this._rotEnv){i||(i=this._computeDelta(n));var r=this.options.context.getFeatures().lighting;if(r){var a=this._viewer.getFeaturesManager().getWorldNode().getMinimumBound().center();uo.mat4.fromZRotation(e,-i%(2*Math.PI)),uo.vec3.negate(a,a),uo.mat4.multiply(e,e,uo.mat4.fromTranslation(t,a)),uo.vec3.negate(a,a),uo.mat4.multiply(e,uo.mat4.fromTranslation(t,a),e);for(var o=r.getModel().get("lights"),s=0,u=o.length;s<u;++s){var l=o[s];if(!l.isAttachedToCamera()){var c=l.get("matrix");uo.mat4.multiply(c,e,c),l.dirty()}}}}}}(),rotateEnvAndLight:function(e){if(this._rotEnv){var t=this._computeDelta(e);this.rotateEnv(e,t),this.rotateLight(e,t)}},endRotate:function(){this._rotEnv&&(this._rotEnv=!1,this._inputManager.setEnable(lo.MANIPULATORS,!0))},onUIDChanged:function(){this.model.updateEnvironmentConfig(),this.onEnvironmentChanged(),this.onBackgroundEnableChanged()},getRotating:function(){return this._rotEnv},getNodeEnvironment:function(){return this._nodeEnvironment},getResourceManager:function(){return this._resourceManager||s.default.instance},onEnableChanged:function(){this.model.get("enable")?(this._nodeEnvironment.enable(),this._nodeEnvironment.setLightShadowEnabled(this.model.get("shadowEnable")),this._nodeEnvironment.setLightIntensity(this.model.get("lightIntensity")),this._nodeEnvironment.setShadowBias(this.model.get("shadowBias"))):(this._nodeEnvironment.disable(),this._nodeEnvironment.setLightShadowEnabled(!1)),this.onEnvironmentChanged()},onShadowEnable:function(){var e=this.getEnvironment().get("lights");!this.model.get("shadowEnable")||e&&0!==e.length?this._nodeEnvironment.setLightShadowEnabled(this.model.get("shadowEnable")):this.model.set("shadowEnable",!1)},onShadowBiasChanged:function(){this._nodeEnvironment.setShadowBias(this.model.get("shadowBias"))},onLightIntensityChanged:function(){this._nodeEnvironment.setLightIntensity(this.model.get("lightIntensity"))},onExposureChanged:function(){this._nodeEnvironment.setExposure(this.model.get("exposure")),this._nodeEnvironment.setBackgroundExposure(this.model.get("backgroundExposure"))},onRotationChanged:function(){this._nodeEnvironment.updateRotation(this.model.get("rotation"))},onBlurChanged:function(){this.abortLastDownloadEnv(),this.isBackgroundEnvironment()&&this.setBackgroundTexture()},onBackgroundEnableChanged:function(){var e=this.getBackgroundEnableType();"environment"===e?this.setBackgroundTexture():"ambient"===e&&this.setBackgroundAmbient()},resolvePreload:function(){this._resourceDefer&&(this._resourceDefer.resolve(),this._resourceDefer=void 0)},onEnvironmentChanged:function(){var e=this.getEnvironment();e&&this.model.get("enable")?(this._onlyLowRes=!0,this.setEnvironment(e).then(function(){var t=e.get("uid")===this.model.get("uid");Object(u.a)().preload&&t||this.resolvePreload(),t&&(this._onlyLowRes=!1,this.setEnvironment(e).finally(this.resolvePreload.bind(this)))}.bind(this))):this.resolvePreload()},getEnvironment:function(){return this.model.getEnvironment()},getName:function(){return"Environment3D"},abortLastDownloadEnv:function(){for(var e=this.model.get("uid"),t=this.model.get("blur"),n=this.getResourceManager()._resourceLoader._processing,i=0,r=n.length;i<r;++i){var a=n[i],o=a.getXHR();o&&(void 0!==a._envUID&&a._envUID!==e&&o.abort(),void 0!==a._envBlur&&a._envBlur!==t&&o.abort())}},setEnvironment:function(e){this.abortLastDownloadEnv();var t=[];if(rn.a.get("mask")&rn.a.LIT){var n=rn.a.get("mask")&rn.a.PBR;this._nodeEnvironment.setIsPBR(n),this._nodeEnvironment.setDiffuseSPH(e.get("diffuseSPH"));var i=e.get("lights")||[];this._nodeEnvironment.setLightProbes(i,e.id),this.model.get("shadowEnable")&&this.model.set("shadowEnable",i.length>0),this._nodeEnvironment.setDefaultExposure(e.get("brightness")),n?this.setEnvironmentPBR(e,t):this.setEnvironmentOld(e,t),this.setProgress(t.slice(),"environment")}return this.isBackgroundEnvironment()&&t.push(this.setBackgroundTexture()),0===t.length?h.a.resolve():h.a.all(Object(nt.a)(t,function(e){return e.reflect()}))},setEnvironmentPBR:function(e,t){var n=this._nodeEnvironment,i=e.get("textures"),r=!1;uo.WebGLCaps.instance().getWebGLExtension("EXT_shader_texture_lod")&&(r=!0),Object(u.a)().panorama&&(r=!1);var a=Object(Li.a)(i,{encoding:"luv",type:"specular_ue4",format:r?"cubemap":"panorama"}),o=this.getImageRes(a),s={cubemap:r,panoramaLUV:!r,cubemapLUV:r,size:o.width,minFilter:r?uo.Texture.LINEAR_MIPMAP_LINEAR:uo.Texture.LINEAR,magFilter:uo.Texture.LINEAR,wrapS:uo.Texture.CLAMP_TO_EDGE,wrapT:uo.Texture.CLAMP_TO_EDGE,transferToGPU:!0,internalFormat:uo.Texture.RGBA},l=this.getResourceManager().getOrCreateTexture(o.file,s);this.markLastXHR(this.model.get("uid")),l.texture.setFlipY(!r),this._onlyLowRes&&n.setSpecularPBRTexture(l.texture,a.limitSize);var c=this.getPromiseTexture(l);c.then(n.setSpecularPBRTexture.bind(n,l.texture,a.limitSize)),t.push(c);var h=o.sizeCompressed,d=Object(Xi.a)();if(!vr.a.any&&d>8){var f=Object(Li.a)(i,{type:"brdf_ue4"});s={integrateBRDFLUV:!0,minFilter:uo.Texture.NEAREST,magFilter:uo.Texture.NEAREST,wrapS:uo.Texture.CLAMP_TO_EDGE,wrapT:uo.Texture.CLAMP_TO_EDGE,transferToGPU:!0,internalFormat:uo.Texture.RGBA},h+=(o=this.getImageRes(f)).sizeCompressed;var p=this.getResourceManager().getOrCreateTexture(o.file,s);this.markLastXHR(this.model.get("uid")),p.texture.setFlipY(!1),n.setIntegrateBRDFTexture(p.texture);var g=this.getPromiseTexture(p);g.then(n.setIntegrateBRDFTexture.bind(n,p.texture)),t.push(g)}k.a.resolveDataSizeEnvironment(h)},getBackgroundResource:function(e,t,n){var i,r=Object(Li.a)(e,{encoding:"luv",type:"background",format:"cubemap"});return i=void 0!==n?this.getClosestBlur(r,n):this.getImageRes(r,512),t.cubemap=!0,t.cubemapLUV=!0,t.size=i.width,t.minFilter=uo.Texture.LINEAR,t.magFilter=uo.Texture.LINEAR,t.wrapS=uo.Texture.CLAMP_TO_EDGE,t.wrapT=uo.Texture.CLAMP_TO_EDGE,t.transferToGPU=!0,t.internalFormat=uo.Texture.RGBA,i},setEnvironmentOld:function(e,t){var n=this._nodeEnvironment,i={},r=this.getBackgroundResource(e.get("textures"),i),a=this.getResourceManager().getOrCreateTexture(r.file,i);this.markLastXHR(this.model.get("uid")),this._onlyLowRes&&n.setSpecularTexture(a.texture);var o=this.getPromiseTexture(a);o.then(n.setSpecularTexture.bind(n,a.texture)),k.a.resolveDataSizeEnvironment(r.sizeCompressed),t.push(o)},setBackgroundTexture:function(){var e=this.getEnvironment();if(!e)return h.a.reject(new Error);var t={},n=this.getBackgroundResource(e.get("textures"),t,this.model.get("blur")),i=this._backgroundLoaded;if(this.getRequestLowRes()){if(i[n.file])return i[n.file].promise;n=this.getBackgroundResource(e.get("textures"),t,1)}var r=this._nodeEnvironment,a=this.getResourceManager().getOrCreateTexture(n.file,t);this.markLastXHR(this.model.get("uid"),this.model.get("blur"));var o=this.getPromiseTexture(a);return o.then(function(){r.setBackgroundTexture(a.texture,n.width),i[n.file]=a}),this.setProgress(o,"background"),o},setProgress:function(e,t){var n=this._viewer.setFakeSecondaryProgress.bind(this._viewer,e,t);k.a.getHighResLoaded().then(n)},setBackgroundAmbient:function(){var e=this.getEnvironment();return e?(this._nodeEnvironment.setDiffuseSPH(e.get("diffuseSPH")),h.a.resolve()):h.a.reject(new Error)},markLastXHR:function(e,t){var n=this.getResourceManager()._resourceLoader._processing;if(n.length>0){var i=n[n.length-1];i._envUID=e,void 0===t||this.getRequestLowRes()||(i._envBlur=t)}},getPromiseTexture:function(e){return this._onlyLowRes||Object(u.a)().preload?e.promise:h.a.all([e.promise,k.a.getFirstCameraAnimation()])},getRequestLowRes:function(){return this._onlyLowRes&&!Object(u.a)().preload},getImageRes:function(e,t){var n=new so.a(e);if(this.getRequestLowRes())return n.findImageSmallest();var i=void 0!==t?t:1/0;return n.findImageNearestPowerOfTwoUpToResolution(i,i)},getClosestBlur:function(e,t){for(var n=e.images,i=0,r=1/0,a=0,o=n.length;a<o;++a){var s=Math.abs(n[a].blur-t);s<r&&(i=a,r=s)}return n[i]}})]},ho=i.a.create(co);ho.prototype=Object(sa.a)({},i.a.prototype,{getNode:function(){return this._views[0].getNodeEnvironment()},getRotating:function(){return this._views[0].getRotating()}});var fo=ho,po=d.a.osg,go=a.a.extend({_trashbin:[],getModelOptionPath:function(){return"background"},defaults:function(){return{webVR:!1}},init:function(e){this.backgroundCollection=s.default.instance.getBackgroundCollection(),this._defaultBackground=this.get("uid"),this.set("enable",Object(Qt.a)()?"color":"fixed");var t=e.getModel().get("options").background;t&&this.setJSON(t),Object(u.a)().transparent&&this.set("enable","none");var n=e.getViewer();Object(Qt.a)()&&k.a.getPolygon().then(function(){"Tilt Brush"===n.getRootUserData().authoringTool&&(this.set("enable","color"),this.set("color",po.vec3.create()))}.bind(this)),Object(o.a)()&&Object(u.a)().apiLog&&(console.log("------"),console.log("Viewer Api Background uid list:"),this.backgroundCollection.each(function(e){console.log("- "+e.get("name")+": "+e.get("uid"))}),console.log("------"))},getName:function(){return"Background"},setBackground:function(e){return this.setBackgroundUID(e.uid)},setBackgroundUID:function(e){e&&this.set("uid",e)},getBackground:function(){if(this.backgroundCollection){var e=this.get("uid"),t=this.backgroundCollection.find(function(t){return t.get("uid")===e||t.get("id")===e});if(t)return t;this.set("uid",this._defaultBackground)}},resetToDefaultBackground:function(){return this.set("uid",this._defaultBackground),this},getEnableType:function(){var e=this.get("enable");return"fixed"!==e&&"none"!==e||!this.get("webVR")||Object(u.a)().vrAr?e:"ambient"},getColor:function(){return this.get("color")},validate:function(e,t){var n=a.a.prototype.validate.call(this,e,t),i=this.get("uid");i!==this._defaultBackground&&(this.getBackground()||console.warn("Couldn't find background "+i));return n},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0})}}),mo=d.a.osg,vo={FeatureName:"background",ModelType:go,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments),this.model.bind("change:enable",this.onEnableChanged,this),this.model.bind("change:webVR",this.onEnableChanged,this),this.model.bind("change:uid",this.onBackgroundChanged,this),this.model.bind("change",V.a.draw),this._viewer=this.options.context.getViewer();var e=this.options.context.getFeatures().environment;e&&(this._resourceDefer=new it.a,this.options.context.getScene().addResourcePromise(this._resourceDefer.promise),this._modelEnvironment=e.getModel(),this._nodeBackground=e.getNode().getBackground(),this._nodeBackground.addUpdateCallback(this),k.a.getMaterial().then(this.onEnableChanged.bind(this)))},getResourceManager:function(){return this._resourceManager||s.default.instance},onBackgroundChanged:function(){var e=this.model.getBackground();if(e){var t=this.options.context.getViewer(),n=Math.max(Object(Sr.a)(t.getWidth()),Object(Sr.a)(t.getHeight())),i=e.findImageNearestToResolution(n,n).url;return this.getResources(i)}},getResources:function(e){for(var t={minFilter:mo.Texture.LINEAR,magFilter:mo.Texture.LINEAR,transferToGPU:!0,convertNPOT:!1,backgroundUid:this.model.get("uid"),internalFormat:mo.Texture.RGB},n=this.getResourceManager()._resourceLoader._processing,i=0;i<n.length;++i){var r=n[i],a=r._options;a&&a.backgroundUid&&a.backgroundUid!==this.model.get("uid")&&r.abort()}var o=this.getResourceManager().getOrCreateTexture(e,t);o.promise.then(function(e){this._nodeBackground.setBackground(e),this._nodeBackground.rescale(this._viewWidth,this._viewHeight),this.model.trigger("backgroundUpdated",e),"fixed"===this.model.getEnableType()&&this._nodeBackground.showBackground()}.bind(this));var s=this.options.context.getViewer();return this._resourceDefer?(o.promise.finally(this._resourceDefer.resolve.bind(this._resourceDefer)),this._resourceDefer=void 0):k.a.getHighResLoaded().then(s.setFakeSecondaryProgress.bind(s,o.promise,"background")),o.promise},onEnableChanged:function(){var e=this.model.getEnableType();"color"===e?this._nodeBackground.showColor():"fixed"===e?this._nodeBackground.getBackground()?this._nodeBackground.showBackground():void 0!==this.model.get("uid")&&this.onBackgroundChanged():"environment"===e?(this._modelEnvironment.trigger("updateBackground"),this._nodeBackground.showEnvironment()):"ambient"===e?(this._modelEnvironment.trigger("updateBackground"),this._nodeBackground.showAmbient()):"none"===e&&this._nodeBackground.hide(),this._resourceDefer&&(this._resourceDefer.resolve(),this._resourceDefer=void 0)},requireBiggerTexture:function(){var e=this.options.context.getViewer(),t=Math.max(Object(Sr.a)(e.getWidth()),Object(Sr.a)(e.getHeight())),n=this.model.getBackground();if(n){var i=n.findImageNearestUpToResolution(t,t);if(void 0!==this._nodeBackground&&!this._nodeBackground.getBackground())return!1;if(i.width<this._nodeBackground.getBackground().getWidth())return!1}return!0},update:function(){if("fixed"!==this.model.getEnableType())return!0;var e=this._viewer.getCamera().getViewport(),t=e.width(),n=e.height();return this._viewWidth===t&&this._viewHeight===n||(this._viewWidth=t,this._viewHeight=n,!0===this.requireBiggerTexture()&&this.onBackgroundChanged(),this._nodeBackground.rescale(t,n)),!0}})]},_o=i.a.create(vo),bo=n("fp5s"),So=n("Z3Pq"),yo=n("nLHx"),xo=n("dERi"),Co=n("d1qz"),wo=d.a.osg,To=function(e){var t=wo.vec3.create(),n=wo.vec3.create();e.getFeatures().camera.getModel().getCameraPosition(t,n),this.set("eye",t),this.set("target",n);var i=e.getScreenShot(128,128).toDataURL("image/jpeg");this.set("uidImage",void 0),this.set("imageFile",Object(yo.a)(i)),this.set("preview",i)},Mo=a.a.extend({getModelOptionPath:function(){return"hotspot"},defaults:function(){return{webVR:!1,currentHotspotIndex:-1}},getName:function(){return"Hotspot"},getResourceManager:function(){return this._resourceManager||s.default.instance},init:function(e){var t=this.getResourceManager().getHotspotCollection();this.set("hotspots",t),t.on("remove",this.onRemove,this),this._viewer=e.getViewer(),this.hotspotsToBeDeleted=[];var n=e.getModel().get("options").hotspot;this.setJSON(n)},onRemove:function(e){e.isNew()||this.hotspotsToBeDeleted.push(e)},setUpdateCallback:function(e){this.callback=e},_hotspotInitialize:function(e,t,n){return this.get("visible")||this.set("visible",!0),e.add(t,{sort:!1}),t.set("order",e.indexOf(t)),t.set("refreshAction",To.bind(t,this._viewer)),t.get("refreshAction")(),void 0===n&&e.trigger("select",t),this.get("started")||this.set("started",!0),t},preventHotspotCameraAction:function(e,t){this.get("hotspots").each(function(n){n.set("cameraPreventAnimation",e),n.set("cameraPreventMove",t)})},createHotspotFromWorldPosition:function(e,t){var n=this.get("hotspots"),i=new xo.a;return i.set("uid","tmp_"+Object(bo.a)()),Object(Co.d)(i,e),this._hotspotInitialize(n,i,t)},createHotspotFromScenePosition:function(e,t){var n=this.get("hotspots"),i=new xo.a;return i.set("uid","tmp_"+Object(bo.a)()),Object(Co.c)(i,e),this._hotspotInitialize(n,i,t)},createHotspot:function(e,t){var n=this.get("hotspots"),i=new xo.a;return i.set("uid","tmp_"+Object(bo.a)()),Object(Co.b)(i,e),this._hotspotInitialize(n,i,t)},setJSON:function(e,t){if(t&&t.validate){var n=this.validate(e);if(n.length)return n.join("\n")}void 0!==Object(u.a)().annotationsVisible?this.set("visible",Object(u.a)().annotationsVisible):void 0!==e.visible?this.set("visible",e.visible):this.set("visible",!0);var i=e&&e.hotspots&&Object(So.a)(e.hotspots,"uid"),r=this.get("hotspots");return r.each(function(e){e.collection=null;var t=e.get("images")[0];t&&(e.set("uidImage",t.uid),e.set("imageFile",Object(yo.a)(t.url)),e.set("preview",t.url)),e.set("refreshAction",To.bind(e,this._viewer));var n=i&&i[e.get("uid")];n&&(e.set("geometryUid",n.geometryUid),e.set("indices",n.indices),e.set("barycentricWeights",n.barycentricWeights),e.set("localPosition",n.localPosition)),r.add(e)}.bind(this)),[]},getJSON:function(){var e=[];return this.get("hotspots").each(function(t){var n={uid:t.get("uid"),geometryUid:t.get("geometryUid"),indices:t.get("indices"),barycentricWeights:t.get("barycentricWeights"),localPosition:t.get("localPosition")};e.push(n)}),Object(o.a)()&&Object(u.a)().apiLog&&(console.log("------"),console.log("Viewer API environment hotspot list:"),this.get("hotspots").each(function(e){var t={ScenePosition:e.get("lastComputedScenePosition"),WorldPosition:e.get("lastComputedWorldPosition"),eye:e.get("eye"),target:e.get("target"),title:e.get("name"),text:e.get("content")?e.get("content").raw:""};console.log(t)}),console.log("------")),{hotspots:e,visible:this.get("visible")}}}),Eo=n("DWw0"),Ao=n("gBaA"),Oo=n("dZz+"),Ro={STRIP:Uint16Array,TRIANGLES:Uint16Array,VERTEX:Float32Array,NORMAL:Float32Array,COLOR:Float32Array},Po=function(e){for(var t in e){var n=e[t];e[t]=n.length?new Ro[t](n):Po(n)}return e},Io=function(e){Promise.all([n.e(108),n.e(160)]).then(function(){e(n("Rtjr").default)}.bind(null,n)).catch(n.oe)},No=function(e){n.e(174).then(function(){e(Po(n("M1xk").default))}.bind(null,n)).catch(n.oe)},Lo=function(e){n.e(173).then(function(){e(Po(n("X6b8").default))}.bind(null,n)).catch(n.oe)},ko=function(e){n.e(172).then(function(){e(Po(n("AhiT").default))}.bind(null,n)).catch(n.oe)},Do=function(e){n.e(175).then(function(){e(Po(n("+1cR").default))}.bind(null,n)).catch(n.oe)},Fo=function(e){n.e(171).then(function(){e(Po(n("preZ").default))}.bind(null,n)).catch(n.oe)},Vo=function(e){n.e(176).then(function(){e(Po(n("E2C9").default))}.bind(null,n)).catch(n.oe)},Bo=n("wwK1"),Uo=n.n(Bo),jo=n("tkW9"),Go=n.n(jo),Ho=d.a.osg,zo=Ho.BufferArray,Wo=Ho.Geometry,qo=Ho.primitiveSet,Xo=Ho.DrawElements,Yo=Ho.vec4.fromValues(1,1,1,1),Ko=function(e,t,n,i,r,a){Ho.MatrixTransform.call(this),this._subX=void 0!==r?r:1,this._subY=void 0!==a?a:1,this._curveAxis=n,this._curveFactor=i,this._distanceFromCam=2.5,this._width=1,t&&(this._distanceFromCam=t),e&&(this._width=e),this._clickActions={},this._opacity=1,this._round=.02,this._opaqueRollover=!1,this._visible=!0,this._currentPage=0,this._enabled=!0};Ko.AXIS_X=0,Ko.AXIS_Y=1,Ko.AXIS_BOTH=2,Ho.createPrototypeNode(Ko,Ho.objectInherit(Ho.MatrixTransform.prototype,{initialize:function(e,t){this._texPanel=e,this._metaData=this._computeMetaData(t),this._panelGeom=this._createGridGeometry(this._metaData.cells),this.addChild(this._panelGeom);var n=this._panelGeom.getOrCreateStateSet(),i=Ho.Uniform.createFloat1(this._opacity,"uAlpha");this._uAlpha=i.getInternalArray(),n.addUniform(i);var r=Ho.Uniform.createFloat1(t.aspectRatio,"uRatio");this._uRatio=r.getInternalArray(),n.addUniform(r);var a=Ho.Uniform.createFloat1(this._enabled?1:.5,"uVeilFactor");this._uVeilFactor=a.getInternalArray(),n.addUniform(a),n.addUniform(Ho.Uniform.createFloat1(this._opaqueRollover?1:0,"uHoveredOpaque"));var o=Ho.Uniform.createFloat1(this._round,"uRound");n.addUniform(o),n.addUniform(Ho.Uniform.createInt(0,"uTexturePanel")),n.setTextureAttributeAndModes(0,this._texPanel),n.setAttributeAndModes(we.a.CULL_DISABLE);var s=be.a.getOrCreateShader(Uo.a,Go.a,"textured-panel","TexturedPanel");n.setAttributeAndModes(s);var u=Ho.Uniform.createFloat4(Yo,"uHoveredArea");this._uHoveredArea=u.getInternalArray(),n.addUniform(u),n.setRenderBinDetails(Se.a.VR_MENU,"RenderBin"),n.setAttributeAndModes(we.a.BLEND_SUBSTRACTIVE),this.initPage(),this._initialized=!0},changeTexture:function(e){var t=this._panelGeom.getOrCreateStateSet();this._texPanel=e,t.setTextureAttributeAndModes(0,this._texPanel)},updateMetaData:function(e){this._metaData=this._computeMetaData(e),this._uRatio[0]=this._metaData.aspectRatio},setEnabled:function(e){this._enabled=e,this._uVeilFactor&&(this._uVeilFactor[0]=e?1:.5)},setMetaData:function(e){this._metaData=e,this._uRatio[0]=this._metaData.aspectRatio},getTexture:function(){return this._texPanel},isInitialized:function(){return this._initialized},setVisible:function(e){if(this._visible!==e){if(this._animation){if(!this._animation.isFinished())return;e&&this._doSetVisible(!0),this._animation.start(0)}else this._doSetVisible(e);this._visible=e}},_doSetVisible:function(e){this.setNodeMask(e?_e.a.PICK_GEOMETRY_FAST:0),this._uAlpha&&(this._uAlpha[0]=1),e||this.initPage()},isVisible:function(){return this._visible},setOpacity:function(e){this._opacity=e,this._uAlpha&&(this._uAlpha[0]=e)},updateHit:function(e){if(this._initialized&&this._enabled){var t=e&&e._localIntersectionPoint;if(e&&-1!==e._nodePath.indexOf(this)){var n={x:(t[0]+.5*this._width)/this._width,y:(t[1]+.5*this._height)/this._height},i=this._metaData.pages?this._findPage(n):void 0,r=n.x,a=n.y;if(i){var o=i.areas;if(o)for(var s=0;s<o.length;s++)if(this._checkArea(o[s],r,a,i.items[s],i))return this}return"WHOLE_PANEL"!==this._currentHovered&&(this._currentHovered="WHOLE_PANEL",Ho.vec4.copy(this._uHoveredArea,Yo)),this}void 0!==this._currentHovered&&(this._currentHovered=void 0,Ho.vec4.copy(this._uHoveredArea,Yo))}},_findPage:function(e){for(var t=e.x,n=e.y,i=0;i<this._metaData.cells.length;i++){var r=this._metaData.cells[i],a=r.x/this._width,o=1-r.y/this._height,s=(r.x+r.width)/this._width,u=1-(r.y+r.height)/this._height;if(t>=a&&t<=s&&n<=o&&n>=u)return e.x=(t-a)/(s-a),e.y=(n-u)/(o-u),r.page}},_checkArea:function(e,t,n,i,r){return t>e[0]&&t<e[1]&&n<e[2]&&n>e[3]&&(this._currentHovered!==i&&(this._currentHovered=i,r?(this._uHoveredArea[0]=r.x+e[0]*r.width,this._uHoveredArea[1]=r.x+e[1]*r.width,this._uHoveredArea[2]=1-r.y-r.height+e[2]*r.height,this._uHoveredArea[3]=1-r.y-r.height+e[3]*r.height):Ho.vec4.copy(this._uHoveredArea,e)),!0)},click:function(){if(this._currentHovered)if("WHOLE_PANEL"!==this._currentHovered){var e=this._clickActions[this._currentHovered];e&&e()}else this._panelClickAction&&this._panelClickAction()},initPage:function(){this._metaData&&this._metaData.pages&&this.setPageForCell(this._metaData.pages[0].id,this._metaData.cells[0].id)},setPageForCell:function(e,t){var n=this._getPage(e);if(n){var i=this._getCell(t);if(i){i.page=n;for(var r=this._panelGeom.getAttributes().TexCoord0,a=r.getElements(),o=this._subY,s=this._subX,u=i.startIndex?i.startIndex:0,l=0;l<=o;l++)for(var c=0;c<=s;c++){var h=2*u;a[h]=n.x+c/s*n.width,a[h+1]=1-n.y-l/o*n.height,u++}r.dirty(),this._panelGeom.dirty()}else Ho.log("can't find cell named "+t+" for panel "+(this._metaData?this._metaData.id:"unknown"))}else Ho.log("can't find page named "+e+" for panel "+(this._metaData?this._metaData.id:"unknown"))},_getPage:function(e){if(this._metaData&&this._metaData.pages)for(var t=0;t<this._metaData.pages.length;t++)if(this._metaData.pages[t].id===e)return this._metaData.pages[t]},_getCell:function(e){var t=this._metaData&&this._metaData.cells;if(t)for(var n=0;n<t.length;++n)if(t[n].id===e)return t[n]},setClickAction:function(e,t){this._clickActions[e]=t},removeClickAction:function(e){delete this._clickActions[e]},setPanelClickAction:function(e){this._panelClickAction=e},removePanelClickAction:function(){this._panelClickAction=void 0},displayInView:function(){var e=Ho.vec3.create(),t=Ho.vec3.create(),n=Ho.vec3.fromValues(0,0,.1),i=Ho.vec3.create();return function(r,a,o){Ho.vec3.copy(e,a),e[2]=r[2];var s=Ho.mat4.lookAt(this.getMatrix(),r,e,n);Ho.mat4.invert(s,s);var u=o;Ho.mat4.scale(s,s,Ho.vec3.set(t,u,u,u)),Ho.vec3.sub(i,e,r),Ho.vec3.normalize(i,i),Ho.vec3.scale(i,i,this._distanceFromCam*o),Ho.vec3.add(i,r,i),i[2]+=-.2*o,Ho.mat4.setTranslation(s,i),this.dirtyBound(),this.setVisible(!0)}}(),setAnimation:function(e){e.setOnFinishCallback(this._onAnimationFinished.bind(this)),this._animation=e,this.addUpdateCallback(e)},getAnimation:function(){return this._animation},_onAnimationFinished:function(){this._visible||this._doSetVisible(!1)},_computeMetaData:function(e){var t,n,i=Object(sa.a)(e,{aspectRatio:e.cellsWidth?e.cellsWidth/e.cellsHeight:e.width/e.height});if(this._height=this._width/i.aspectRatio,i.pages)for(n=0;n<i.pages.length;n++){var r=i.pages[n];if(r.areas)for(t=0;t<r.areas.length;t++){var a=r.areas[t];a[0]=a[0]/r.width,a[1]=a[1]/r.width,a[2]=1-a[2]/r.height,a[3]=1-a[3]/r.height}r.x/=e.width,r.y/=e.height,r.width/=e.width,r.height/=e.height}if(i.cells&&i.cells.length>0)for(t=0;t<i.cells.length;t++){var o=i.cells[t];o.x=o.x/i.cellsWidth*this._width,o.y=o.y/i.cellsHeight*this._height,o.z/=100,o.width=o.width/i.cellsWidth*this._width,o.height=o.height/i.cellsHeight*this._height}else i.cells=[{id:"default",x:0,y:0,z:0,width:this._width,height:this._height}];return i},_createTexturedGridGeometry:function(e,t,n,i,r,a,o,s,u,l,c,h){t*=-1,s&&(u=void 0!==u?u:.2);for(var d=i/a,f=r/o,p=this._verticesIndex,g=0,m=0,v=this._indicesIndex,_=0,b=0,S=0;S<=o;S++)for(var y=0;y<=a;y++)g=3*p,c[m=2*p]=y/a,c[m+1]=1-S/o,s&&(s!==Ko.AXIS_X&&s!==Ko.AXIS_BOTH||(_=(_=y/a-.5)*_*u),s!==Ko.AXIS_Y&&s!==Ko.AXIS_BOTH||(b=(b=S/o-.5)*b*u)),l[g]=e+d*y,l[g+1]=t-f*S,l[g+2]=n+_+b,p++;var x=this._verticesIndex;this._verticesIndex=p;for(var C=0;C<a*o;C++)v=this._indicesIndex+6*C,p=x+C+Math.floor(C/a),h[v]=p,h[v+1]=a+1+p,h[v+2]=a+1+p+1,h[v+3]=a+1+p+1,h[v+4]=p+1,h[v+5]=p;this._indicesIndex=v+6},_createGridGeometry:function(e){var t=this._subY,n=this._subX,i=(n+1)*(t+1)*e.length,r=new Wo,a=new Float32Array(3*i),o=new Float32Array(2*i),s=new Uint8Array(n*t*6*e.length);this._verticesIndex=0,this._indicesIndex=0;for(var u=.5*this._width,l=.5*this._height,c=0;c<e.length;c++){var h=e[c];h.startIndex=this._verticesIndex,this._createTexturedGridGeometry(h.x-u,h.y-l,h.z,h.width,h.height,n,t,this._curveAxis,this._curveFactor,a,o,s)}r.getAttributes().Vertex=new zo(zo.ARRAY_BUFFER,a,3),r.getAttributes().TexCoord0=new zo(zo.ARRAY_BUFFER,o,2);var d=new Xo(qo.TRIANGLES,new zo(zo.ELEMENT_ARRAY_BUFFER,s,1));return r.getPrimitives().push(d),r}}),"osgSketchfab","TexturedPanel");var Qo=Ko,Jo=n("htjh"),Zo=n.n(Jo),$o=n("EVdn"),es=n.n($o),ts=n("xvcl"),ns=d.a.osg,is=new Zo.a({device:"VWR",listen:!0}),rs={},as=function(e){return 1<<Math.ceil(Math.log2(e))},os=function(e){var t,n,i=0;if(0===e.length)return i;for(t=0,n=e.length;t<n;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return"vr-browser-"+i},ss=function(e,t,n,i,r,a){Qo.call(this,e,t,n,i,r,a),this._uPaginate=void 0,this._textureWidth=1024,this._textureHeight=1024,this._useCache=!1};ss.prototype=ns.objectInherit(Qo.prototype,{initialize:function(e,t,n){ts.a&&!Object(u.a)().isApp||(t=Object(sa.a)({},t),Io(function(i){this._styles=i.vrStyles,this._appendVrElement();var r=es()(i.TEMPLATES.getFromMacro(e,"panel",[t]));this._templatePath=e,r.css("position","absolute"),r.css("top","0"),r.css("left","0"),this._$uiPanelsDiv.append(r);var a=this._extractMetaData(r);if(this._useCache){var o=os(r.html()),s=localStorage.getItem(o);if(s){var l=new Image;return l.crossOrigin="anonymous",l.onload=function(){var e=new ns.Texture;e.setTextureSize(1,1),e.setImage(l),this._applyTexture(e,a,n)}.bind(this),l.src=s,void r.remove()}}if(!Object(u.a)().vrGenerateUiTextures)return n(ji.a.dummyTexture,a),void r.remove();this._rasterizeElement(i.rasterizeHTML,r).then(function(e){if(this._useCache){var t=e.toDataURL(),n=os(r.html());this._storeInCache(n,t)}var i=new ns.Texture;return i.setTextureSize(1,1),i.setImage(e),i}.bind(this)).then(function(e){this._applyTexture(e,a,n)}.bind(this)),r.remove()}.bind(this)))},_storeInCache:function(e,t){try{localStorage.setItem(e,t)}catch(i){localStorage.removeItem(localStorage.key(0));for(var n=0;n<localStorage.length&&0!==localStorage.key(n).indexOf("vr-browser-");n++)localStorage.removeItem(localStorage.key(n));this._storeInCache(e,t)}},setUseCache:function(e){this._useCache=e||!1},_applyTexture:function(e,t,n){this.isInitialized()?(this.changeTexture(e),this.updateMetaData(t)):Qo.prototype.initialize.call(this,e,t),n&&n(e,t)},_appendVrElement:function(){this._$uiPanelsDiv=es()("#vr-ui-panels"),this._$uiPanelsDiv.length||(this._$uiPanelsDiv=es()('<div id="vr-ui-panels" style="position:absolue; top:0;bottom:0;left:0;right:0; background:transparent"/>'),es()("body").append(this._$uiPanelsDiv),this._$uiPanelsDiv.append('<style id="vr-panel-style">'+this._styles+"</style>"))},_rasterizeElement:function(e,t){var n=document.createElement("canvas");return n.width=t.outerWidth(),n.height=t.outerHeight(),e.drawHTML(this._$uiPanelsDiv.prop("outerHTML"),n,{cacheBucket:rs,cache:"all"}).then(function(e){if(vr.a.apple.phone){var t="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(e.svg))),i=Object(bo.a)("rasterize");return is.createMessage({data:{_key:i,height:n.height+"",width:n.width+"",svg:t}}).appendToHash(),new h.a(function(e){is.on("message:"+i,function(t){var n,i=new Image;i.crossOrigin="anonymous",i.onload=function(){e(i)},t.b64&&(n=t.b64),t.data.b64&&(n=t.data.b64),n.indexOf("%3D")>-1&&(n=decodeURIComponent(n)),-1===n.indexOf("data:image/png")&&(n="data:image/png;base64,"+n),i.src=n})})}if(this._textureWidth=as(n.width),this._textureHeight=as(n.height),n.width===this._textureWidth&&n.height===this._textureHeight)return n;var r=document.createElement("canvas");return r.width=this._textureWidth,r.height=this._textureHeight,r.getContext("2d").drawImage(n,0,0,this._textureWidth,this._textureHeight),r}.bind(this),function(e){console.log(e)})},_extractMetaData:function(e){var t=e.find(".page"),n=e.outerHeight(!0),i=e.outerWidth(!0),r={id:e.attr("id"),width:i,height:n,cells:[],pages:[]};if(0===t.length)this._extractButtons(e,r,0,"default");else for(var a=0;a<t.length;a++)this._extractButtons(es()(t[a]),r,a,t[a].id);return this._extractCells(e,r),r},_extractButtons:function(e,t,n,i){if(i){var r=e.find("button"),a=e.offset().top,o=e.offset().left,s=e.outerHeight(!0),u=e.outerWidth(!0);t.pages[n]={id:i,num:n,x:o,y:a,width:u,height:s,items:[],areas:[]};for(var l=0;l<r.length;l++){var c=r[l].id,h=r[l].disabled;if(c&&!h){var d=es()(r[l]),f=ns.vec4.create();f[0]=d.offset().left-o,f[1]=f[0]+d.outerWidth(),f[2]=d.offset().top-a,f[3]=f[2]+d.outerHeight(),f[0]>t.width&&(f[0]%=t.width),f[1]>t.width&&(f[1]%=t.width),t.pages[n].items.push(c),t.pages[n].areas.push(f)}}}},_extractCells:function(e,t){for(var n=e.find(".cell"),i=e.offset().top,r=e.offset().left,a=0,o=1/0,s=1/0,u=0,l=0;l<n.length;l++){var c=n[l].id;if(c){var h=es()(n[l]),d={};d.id=c,d.x=h.offset().left-r,d.y=h.offset().top-i;var f=h.css("z-index");d.z=isNaN(f)?0:f,d.width=h.outerWidth(!1),d.height=h.outerHeight(!1);var p=d.x+d.width;p>a&&(a=p),d.x<o&&(o=d.x);var g=d.y+d.height;g>u&&(u=g),d.y<s&&(s=d.y),t.cells[l]=d}}0===n.length?(t.cellsWidth=e.outerWidth(!1),t.cellsHeight=e.outerHeight(!1)):(t.cellsWidth=a-o,t.cellsHeight=u-s)}});var us=ss,ls=d.a.osg,cs=function(e,t){us.call(this,e,t),this._round=.005};cs.prototype=ls.objectInherit(us.prototype,{initialize:function(e,t){us.prototype.initialize.call(this,e,t,function(){this.setClickAction("nextPage",function(){this.setPage(this._currentPage+1)}.bind(this)),this.setClickAction("prevPage",function(){this.setPage(this._currentPage-1)}.bind(this))}.bind(this)),this._nbColumns=t.column,this._currentPage=0},setHinted:function(e){this._hinted=e,this.setNodeMask(e?_e.a.NO_PICK:0),this._uAlpha&&(this._uAlpha[0]=.1)},isHinted:function(){return this._hinted},getNbPage:function(){return this._nbColumns},getCurrentPage:function(){return this._currentPage},setPage:function(e){if(this._currentPage!==e){var t=this.getNbPage(),n=Math.min(t-1,Math.max(0,e));this.setPageForCell("column"+n,"default"),this._currentPage=n}}});var hs=cs,ds=(n("UESx"),d.a.osg),fs=d.a.osgUtil,ps=ds.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),gs=fs.GizmoGeometry.createCylinderGeometry(.0025,.0025,1,8,1,!1,!1),ms=new ds.MatrixTransform;ms.getMatrix()[14]=.5,ms.addChild(gs),gs._boundingBoxComputed=!0,gs._boundingSphereComputed=!0;var vs=function(e,t){ds.Node.call(this),this._idHotspot=e,this._viewer=t,this._hotspotMT=new ds.MatrixTransform,this._cardPanel=new hs,this._lineToCardMT=new ds.MatrixTransform,this._hotspotMT.addChild(ps),this.addChild(this._hotspotMT),this.addChild(this._lineToCardMT),this.addChild(this._cardPanel),this._cardPanel.setVisible(!1),this._lineToCardMT.setNodeMask(0),this._worldTeleportPos=void 0,this._cardInitialized=!1,this._texCard=new ds.Texture,this._texCard.setTextureSize(1,1),this._canTeleport=!1,this._uAlpha=void 0,this._color=void 0,this._lineToCardMT.addChild(ms),this._hotspotMT._boundingBoxComputed=!0,this._hotspotMT._boundingSphereComputed=!0,this.init()};vs.COLOR_NORMAL=ds.vec3.fromValues(1,1,1),vs.COLOR_HOVERED=ds.vec3.fromValues(0,.8,1),vs.COLOR_DRAG_OK=ds.vec3.fromValues(0,.4,1),vs.COLOR_DRAG_FAIL=ds.vec3.fromValues(.8,.2,.2),vs.initLineShader=function(e){var t=gs.getOrCreateStateSet();t.setAttributeAndModes(e),t.addUniform(ds.Uniform.createFloat4(ds.vec4.fromValues(.03,.59,.78,.4),"uLineColor")),t.setRenderBinDetails(Se.a.TOOLTIP,"RenderBin")},ds.createPrototypeNode(vs,ds.objectInherit(ds.Node.prototype,{init:function(){var e=this.getOrCreateStateSet();e.addUniform(ds.Uniform.createFloat(this._idHotspot,"uHotspotIndex"));var t=ds.Uniform.createFloat3(ds.vec3.fromValues(1,1,1),"uColor");this._color=t.getInternalArray(),e.addUniform(t)},getIndex:function(){return this._idHotspot},getHotspotMatrix:function(){return this._hotspotMT.getMatrix()},getColor:function(){return this._color},isFullyVisibleCard:function(){return this._cardPanel.isVisible()},isVisibleCard:function(){return this._cardPanel.isHinted()||this._cardPanel.isVisible()},canTeleport:function(){return this._canTeleport&&!this.isFullyVisibleCard()},setWorldTeleportPosition:function(){var e=ds.vec3.create(),t=ds.vec3.create(),n=ds.vec3.create();return function(i,r,a){if(!this.isFullyVisibleCard()){var o=this._cardPanel.getMatrix();this._worldTeleportPos=ds.vec3.copy(this._worldTeleportPos||ds.vec3.create(),r),ds.vec3.copy(n,r),n[2]+=1.5*a,ds.vec3.sub(t,i,n),t[2]=0,ds.vec3.normalize(t,t),ds.vec3.scale(t,t,1*a),ds.vec3.add(t,n,t),this.lookToWorld(o,t,n,a),ds.vec3.sub(e,r,i);var s=ds.vec3.length(e);ds.vec3.sub(e,r,t);var u=s<ds.vec3.length(e)?-1:1;t[2]+=.5*u*.5625*a;var l=this._lineToCardMT.getMatrix();this.lookToWorld(l,i,t,1);var c=ds.vec3.dist(t,i);ds.vec3.set(e,a,a,c),ds.mat4.scale(l,l,e),this._cardPanel.dirtyBound()}}}(),setCardVisibilityListener:function(e){this._cardVisibilityListener=e},setVisibleCard:function(e){this._isCardInitialized||this.initCard(),this._cardPanel.setVisible(e),this._lineToCardMT.setNodeMask(e?_e.a.NO_PICK:0),this._cardVisibilityListener&&this._cardVisibilityListener(this,e)},setVisible:function(e){this.setNodeMask(e?-1:0)},setHovered:function(e){this._isCardInitialized||this.initCard(),ds.vec3.copy(this.getColor(),e?vs.COLOR_HOVERED:vs.COLOR_NORMAL),this.isFullyVisibleCard()||(this._cardPanel.setHinted(e),this._lineToCardMT.setNodeMask(e?_e.a.NO_PICK:0))},initCard:function(){var e=es()(".hotspots"),t=es()(e.get(0).childNodes[this._idHotspot]),n=this._viewer.getFeatures().hotspot._views[0]._hotspots;this._setDescriptionStyle(t,{width:"1024px",lineHeight:"2",fontSize:"38px"});var i=t.find(".description").outerHeight()+4*t.find(".title").outerHeight(),r=Math.max(1,Math.round(i/576)+(i%576>0?1:0));this._setDescriptionStyle(t,null),this._cardPanel.initialize("skfb_front/macros/hotspot",{hotspotIndex:this._idHotspot,displayNavigation:n.length&&n.length>1,column:r,widthContent:1024*r,title:t.find(".title")[0].innerText,description:t.find(".description").html()}),this._isCardInitialized=!0},_setDescriptionStyle:function(e,t){e.find(".description").css({width:null!==t?t.width:"",lineHeight:null!==t?t.lineHeight:"",fontSize:null!==t?t.fontSize:""})},updateCardHit:function(e){this._hoveredCard=this._cardPanel.updateHit(e)},onCardHit:function(e){this._isCallbackSetup||(this._setupCallback(e),this._isCallbackSetup=!0),this._hoveredCard?this._cardPanel.click():this._cardPanel.setVisible(!1)},_setupCallback:function(e){this._cardPanel.setClickAction("closeButton",function(){this.setVisibleCard(!1)}.bind(this)),this._cardPanel.setClickAction("nextButton",function(){e.goToNextHotspot()}),this._cardPanel.setClickAction("prevButton",function(){e.goToPrevHotspot()})},lookToWorld:function(){var e=ds.vec3.create(),t=ds.vec3.fromValues(0,0,-1),n=ds.mat4.fromXRotation(ds.mat4.create(),Math.PI);return function(i,r,a,o){ds.mat4.lookAt(i,r,a,t),ds.mat4.multiply(i,n,i),ds.mat4.invert(i,i),ds.mat4.scale(i,i,ds.vec3.set(e,o,o,o))}}(),updatePositionVR:function(e,t,n,i){var r=this._hotspotMT.getMatrix(),a=e.get("lastComputedWorldPosition");n=Math.max(1.5*n,.1*i),n=Math.min(4*n,n),this.lookToWorld(r,a,t,n);var o=1/0;this._worldTeleportPos&&(o=ds.vec2.dist(this._worldTeleportPos,t));var s=o<.5*i;this._canTeleport=!s,this._hotspotMT.dirtyBound()},updatePosition:function(){var e=ds.vec3.create();return function(t,n,i,r){var a=this._hotspotMT.getMatrix(),o=t.get("lastComputedWorldPosition");ds.mat4.copy(a,r),ds.vec3.set(e,i,i,i),ds.mat4.scale(a,a,e),ds.mat4.setTranslation(a,o),this.isVisibleCard()&&this.setVisibleCard(!1),this._hotspotMT.dirtyBound()}}()}),"osgSketchfab","Hotspot");var _s=vs,bs=n("QKgc"),Ss=n("gLrx"),ys=n.n(Ss),xs=n("HxyN"),Cs=n.n(xs),ws=n("T5Q4"),Ts=n.n(ws),Ms=n("+XBE"),Es=n.n(Ms),As=d.a.osg,Os=d.a.InputGroups,Rs={FeatureName:"hotspot",ModelType:Mo,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments),this._nodeHotspot=new As.Node,this._nodeHotspot.setName("Feature - Hotspot"),this._hotspots=this.model.get("hotspots");var e=this._hotspots.length>0;Oi.setHotspot(e),this.model.set("started",e),this._hotspots.on("sort",V.a.draw),this._hotspots.on("remove",this.onHotspotRemoved,this),this._hotspots.on("add",this.onHotspotAdded,this),this._hotspots.on("select",this.onHotspotSelected,this),this._hotspots.on("inserted",this.onHotspotInserted,this),this.model.on("change:started",this.onHotspotStarted,this),this.model.on("change:visible",this.onVisible,this),this.model.on("change:textureOptions",this.setTextureHotspot,this),this._lastSuccessHit=void 0;var t=this.options.context;this._viewer=t.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._manipulator=this._viewerOSGJS.getManipulator(),this._inputManager=this._viewerOSGJS.getInputManager(),this._idDragging=-1,this._dragHotspotStarted=!1,this._lastHoveredIndex=-1,this._dragCamera=!1,this._lastCoordNotDragging=As.vec2.create(),this._proxyHotspot=new As.Node,this._proxyHotspot.setName("Hotspot - Proxy"),this._proxyHotspot.setNodeMask(0),this._nodeHotspot.addChild(this._proxyHotspot),this.initHotspotProxy(),this._hotspots.each(this.onHotspotAdded.bind(this)),(e||Object(o.a)())&&k.a.getModelDisplayed().then(this.hotspotReady.bind(this))},onHotspotStarted:function(){this.model.get("proxyModel")&&this.model.get("proxyModel").set("annotationsVisible",!0),Oi.setHotspot(!0),this.hotspotReady()},getNodeHotspot:function(){return this._nodeHotspot},getNodeProxy:function(){return this._proxyHotspot},getScreenThresholdHover:function(){return 20*xe.a.getPixelRatio()[0]},onVisible:function(){this._proxyHotspot.setNodeMask(this.model.get("visible")?_e.a.NO_SHADOW:0),V.a.draw()},hotspotReady:function(){Te.a.initHotspot(this),this.onVisible();var e=this._viewer.getFeaturesManager().getTextureDepth();e&&this._proxyHotspot.getOrCreateStateSet().setTextureAttributeAndModes(0,e),V.a.draw()},onHotspotInserted:function(){for(var e=0;e<this._proxyHotspot.children.length;e++)this._proxyHotspot.children[e].initCard()},initHotspotProxy:function(){if(this.model.get("hotspots").length){this._proxyHotspot.setCullCallback(this);var e=this._proxyHotspot.getOrCreateStateSet();e.setRenderBinDetails(Se.a.HOTSPOT,"RenderBin"),e.setAttributeAndModes(we.a.DEPTH_DISABLE),e.setAttributeAndModes(we.a.BLEND_SUBSTRACTIVE),this.model.set("textureOptions",{url:ye.iconHotspot,colNumber:10,padding:2,iconSize:48}),this.setTextureHotspot(),e.addUniform(As.Uniform.createInt(0,"uTextureDepth")),e.addUniform(As.Uniform.createInt(1,"uTextureHotspot")),e.setAttributeAndModes(be.a.getOrCreateShader(ys.a,Cs.a,"hotspot","Hotspot")),e.setAttributeAndModes(we.a.CULL_DISABLE),_s.initLineShader(be.a.getOrCreateShader(Ts.a,Es.a,"hotspotline","VRHotspotLine")),this._proxyInitialized=!0}},setTextureHotspot:function(){var e=this.model.get("textureOptions"),t=this._proxyHotspot.getOrCreateStateSet();if(e.url){var n=s.default.instance.getOrCreateTexture(e.url,{internalFormat:As.Texture.RGBA});t.setTextureAttributeAndModes(1,n.texture),n.promise.then(function(e){this._textureSize?this._textureSize.setVec2(As.vec2.fromValues(e._textureWidth,e._textureHeight)):(this._textureSize=As.Uniform.createFloat2(As.vec2.fromValues(e._textureWidth,e._textureHeight),"uHotspotTextureSize"),t.addUniform(this._textureSize))}.bind(this))}e.colNumber&&(this._iconsCol?this._iconsCol.setFloat(e.colNumber):(this._iconsCol=As.Uniform.createFloat(e.colNumber,"uHotspotCol"),t.addUniform(this._iconsCol))),e.padding&&(this._iconPadding?this._iconPadding.setFloat(e.padding):(this._iconPadding=As.Uniform.createFloat(e.padding,"uHotspotPadding"),t.addUniform(this._iconPadding))),e.iconSize&&(this._iconSize?this._iconSize.setFloat(e.iconSize):(this._iconSize=As.Uniform.createFloat(e.iconSize,"uHotspotSize"),t.addUniform(this._iconSize)))},createHotspot:function(e){if("annotations"===this._viewer.getOptions().widgetAPI.getTabbedWidget().get()){var t=this.options.context.getModel().toJSON(),n=Object(Eo.o)(t),i=pt.a.maxHotspotsPerModel[n];if(this._hotspots.length>=i)this.model.trigger("hotspot-error",new bs.e(void 0,"hotspot",this._hotspots.length,i,Oo.a.me().toJSON().account));else if(this._viewer.getFeaturesManager()){var r=Ce.a.pickNearestSurface(e);r&&(this.model.createHotspot(r),Ao.a.annotationEditorCreateButtonClicked(this.options.context.getModel().get("uid")))}}},getColorHotspot:function(e){return this._proxyHotspot.getChildren()[e].getColor()},setHotspotHovered:function(e,t){t>=0&&As.vec3.copy(this.getColorHotspot(t),e?_s.COLOR_HOVERED:_s.COLOR_NORMAL)},updateCameraDragged:function(){var e=As.vec2.create();return function(t){this._dragCamera=this._dragCamera||As.vec2.dist(As.vec2.set(e,t.glX,t.glX),this._lastCoordNotDragging)>5}}(),hoverHotspot:function(e){var t=this.pickHotspot(e);this.setHotspotHovered(0,this._lastHoveredIndex),this.setHotspotHovered(1,t),-1===this._idDragging&&As.vec2.set(this._lastCoordNotDragging,e.glX,e.glY),this._lastHoveredIndex!==t&&(-1!==this._lastHoveredIndex&&this._viewer.trigger("annotationMouseLeave",this._lastHoveredIndex),-1!==t&&this._viewer.trigger("annotationMouseEnter",t),this._lastHoveredIndex=t,V.a.draw())},selectHotspot:function(e){var t=this.pickHotspot(e);this._hotspots.trigger("select",this._hotspots.at(t))},startDrag:function(e){this._idDragging=this.pickHotspot(e),this._dragCamera=!1,As.vec2.set(this._lastCoordNotDragging,e.glX,e.glY),this._idDragging>=0&&this._inputManager.setEnable(Os.MANIPULATORS,!1)},cancelDrag:function(){this._dragCamera=!0,this.stopDrag()},stopDrag:function(){if(this._dragCamera)this._idDragging>=0&&(this._lastSuccessHit&&Object(Co.b)(this._hotspots.at(this._idDragging),this._lastSuccessHit),As.vec3.copy(this.getColorHotspot(this._idDragging),_s.COLOR_NORMAL),V.a.draw(),Ao.a.annotationEditorPositionMoved(this.options.context.getModel().get("uid")));else if(this._hotspots.trigger("select",this._hotspots.at(this._idDragging)),this._idDragging>-1){var e=this.options.context.getModel().get("uid")+"_"+(this._idDragging+1);Ao.a.modelViewerAnnotationClicked(e)}this._idDragging>=0&&this._inputManager.setEnable(Os.MANIPULATORS,!0),this._dragHotspotStarted=!1,this._dragCamera=!1,this._idDragging=-1},dragHotspot:function(){var e=As.vec3.create();return function(t){if(!(this._idDragging<0)&&(this.updateCameraDragged(t),this._dragHotspotStarted=!0,Ce.a.isInitialized())){var n=Ce.a.pickNearestSurface(t),i=this._hotspots.at(this._idDragging);As.vec3.copy(this.getColorHotspot(this._idDragging),n?_s.COLOR_DRAG_OK:_s.COLOR_DRAG_FAIL),n?(this._lastSuccessHit=n,Object(Co.b)(i,n)):(As.vec2.set(e,t.glX,t.glY),e[2]=Ce.a.getScreenPositionFromScenePoint(i.get("position"),As.vec3.create())[2],Ce.a.getScenePositionFromScreenPoint(e,i.get("position")),i.set("geometryUid",-1)),V.a.draw()}}}(),onHotspotSelected:function(){var e=As.vec3.create(),t=As.vec3.create();return function(n){if(n){var i=this._viewer.getFeaturesManager();i&&(n.get("cameraPreventMove")||(As.vec3.copy(e,n.get("eye")),As.vec3.copy(t,n.get("target")),i.applyAutospinToCamera(e,t),i.focusOnTargetAndEye(t,e,n.get("cameraPreventAnimation")?0:1.5)),this._viewer.trigger("annotationSelect",this._hotspots.indexOf(n)),V.a.draw())}else this._viewer.trigger("annotationSelect",-1)}}(),onHotspotAdded:function(e){this._proxyInitialized||this.initHotspotProxy();var t=new _s(this._hotspots.indexOf(e),this._viewer);t.setCardVisibilityListener(this._onCardVisibilityChange.bind(this)),this._proxyHotspot.addChild(t),V.a.draw()},_onCardVisibilityChange:function(e,t){t?this._viewer.trigger("annotationFocus",e.getIndex()):this._viewer.trigger("annotationBlur",e.getIndex())},onHotspotRemoved:function(){this.setHotspotHovered(0,this._lastHoveredIndex),this._lastHoveredIndex=-1;var e=this._proxyHotspot.getChildren();this._proxyHotspot.removeChild(e[e.length-1]),V.a.draw()},screenDistanceToHotspot:function(){var e=As.vec3.create();return function(t,n){return Ce.a.getScreenPositionFromWorldPoint(t.get("lastComputedWorldPosition"),e),As.vec2.dist(e,n)}}(),pickHotspot:function(){var e=As.vec2.create();return function(t){if(!this._viewer.getFeaturesManager()||!this.model.get("visible"))return-1;As.vec2.set(e,t.glX,t.glY);for(var n=1/0,i=this._hotspots.length,r=-1,a=this.getScreenThresholdHover(),o=this._hotspots,s=0;s<i;++s){var u=o.at(s);if(u.get("visible")){var l=this.screenDistanceToHotspot(u,e);l<a&&l<n&&(n=l,r=s)}}return r}}(),cull:function(){var e=As.mat4.create(),t=As.quat.create(),n=As.vec3.create();return function(){this.model.callback&&this.model.callback();var i=this._viewer.getFeaturesManager();this._lastHoveredIndex>=0&&-1===this._idDragging&&(this.screenDistanceToHotspot(this._hotspots.at(this._lastHoveredIndex),this._lastCoordNotDragging)>=this.getScreenThresholdHover()&&this.setHotspotHovered(0,this._lastHoveredIndex));var r=this._hotspots,a=this._proxyHotspot.getChildren(),o=a.length,s=this._viewer.getFeatures().webVR.getModel().get("worldFactor"),u=this.model.get("webVR");this._manipulator.getEyePosition(n);var l=i.getIconScaleFov();if(!u){var c=this._viewer.getCamera();As.mat4.invert(e,c.getViewMatrix()),As.mat4.fromQuat(e,As.mat4.getRotation(t,e))}for(var h=0;h<o;++h){var d=a[h],f=r.at(h);if(f.get("visible")){d.setVisible(!0),Object(Co.e)(f);var p=f.get("lastComputedWorldPosition"),g=As.vec3.dist(p,n)/l;u?d.updatePositionVR(f,n,g,s):d.updatePosition(f,n,g,e)}else d.setVisible(!1)}return!0}}()})]},Ps=i.a.create(Rs);Ps.prototype.getNode=function(){return this._views[0].getNodeHotspot()},Ps.prototype.getWidgetNode=function(){return this._views[0].getNodeProxy()};var Is=Ps,Ns=d.a.osg,Ls=d.a.osgUtil,ks=a.a.extend({getModelOptionPath:function(){return"#.definitions.light"},defaults:function(){return{matrixPrev:Ns.mat4.create(),shadowNormalBias:Object(u.a)().shadowNormalOffset?.075:void 0}},initialize:function(){a.a.prototype.initialize.apply(this,arguments),rn.a.bind("change:mask",this.dirty,this),this.createNode(arguments[0])},createNode:function(e){this._mtLight=new Ns.MatrixTransform,this._mtLight.setName("Lighting - Mt");var t=Ba("Lighting",e);this._shadowMap=t.shadowMap,this._light=t.light,this._lightSource=t.lightSource,this._node=t.node,this._enableShadow=t.enableShadow,this._mtQuad=new Ns.MatrixTransform,this._mtQuad.setName("Lighting - TransformIcon "+e),this._quadGeom=Ea.createIconGeometry(),this._quadGeom.setName("Lighting -  GeomIcon "+e),this._pointGeom=new Ea.createPointGeometry,this._dirGeom=new Ea.createDirectionalGeometry(5),this._spotGeom=new Ea.createSpotGeometry(5),this._hemiGeom=new Ea.createHemiGeometry(4),this._hemiGeom.getOrCreateStateSet().addUniform(Ns.Uniform.createFloat4(Ns.vec4.fromValues(0,0,1,1),"uGround")),this._scale=new Ns.MatrixTransform,this._scale.setName("Lighting - ScaleIcon "+e),this._mtEditLight=new Ns.MatrixTransform,this._mtEditLight.getOrCreateStateSet().setTextureAttributeAndModes(0,ji.a.dummyTexture),this._mtEditLight.setName("Lighting - MtEditLight "+e);var n=this._mtEditLight.getOrCreateStateSet();n.addUniform(Ns.Uniform.createFloat4(Ns.vec4.fromValues(1,1,1,1),"uColor")),n.addUniform(Ns.Uniform.createInt(1,"uEnable")),n.addUniform(Ns.Uniform.createInt(0,"uAttachedToCamera")),n.addUniform(Ns.Uniform.createInt(0,"uTextureDepth")),this._node.addChild(this._mtLight),this._node.addChild(this._mtEditLight),this._mtLight.addChild(this._lightSource),this._mtEditLight.addChild(this._scale),this._mtEditLight.addChild(this._spotGeom),this._mtEditLight.addChild(this._pointGeom),this._scale.addChild(this._mtQuad),this._scale.addChild(this._dirGeom),this._scale.addChild(this._hemiGeom),this._mtQuad.addChild(this._quadGeom),this._dirty=!0,this._updateMatrixOnToggleCamera=!0,this._scene=null},setDepthTexture:function(e){e&&this._mtEditLight.getOrCreateStateSet().setTextureAttributeAndModes(0,e)},setScene:function(e){this._scene=e},getShadowMap:function(){return this._shadowMap},isCastingShadows:function(){var e=this.get("type");return this._enableShadow&&this.get("castShadows")&&("DIRECTION"===e||"SPOT"===e)},getLightSource:function(){return this._lightSource},getNodeScale:function(){return this._scale},getNodeQuad:function(){return this._mtQuad},getNode:function(){return this._node},getNodeLight:function(){return this._mtLight},getNodeEditLight:function(){return this._mtEditLight},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty},updateNode:function(){if(this._dirty){this._dirty=!1;var e=this._node,t=this._light,n=this.get("type");if("NONE"===n)return e.setNodeMask(0),t.setEnabled(!1),void(this._mtEditLight.editMask=0);e.setNodeMask(-1),this._mtEditLight.editMask="POINT"===n?Ls.NodeGizmo.PICK_ARROW|Ls.NodeGizmo.PICK_PLANE:Ls.NodeGizmo.PICK_GIZMO,"HEMI"===n&&rn.a.get("mask")&rn.a.PBR&&(n="DIRECTION");var i=this.get("enable"),r=this.get("falloff");t.setLightType(n),t.setSpotCutoff("SPOT"===n?this.get("angle"):180),t.setEnabled(i),t.setConstantAttenuation("DIRECTION"!==n?1:r),t.setQuadraticAttenuation("DIRECTION"!==n?r:0),t.setSpotBlend(this.get("hardness")),Ns.mat4.copy(this._mtLight.getMatrix(),this.get("matrix")),this._mtLight.dirtyBound(),this._mtEditLight.dirtyBound(),Ns.vec3.scale(t.getDiffuse(),this.get("color"),this.get("intensity")),Ns.vec3.copy(t.getSpecular(),t.getDiffuse()),Ns.vec3.scale(t.getGround(),this.get("ground"),this.get("intensityGround"));var a=this.getShadowMap();a&&(a.setTextureSize(Object(u.a)().shadowTextureSize),a.setBias(this.get("shadowBias")),Object(u.a)().shadowNormalOffset&&a.setNormalBias(this.get("shadowNormalBias"))),this.isAttachedToCamera()?(this._mtLight.setReferenceFrame(Ns.Transform.ABSOLUTE_RF),this._mtLight.setCullingActive(!1)):(this._mtLight.setReferenceFrame(Ns.Transform.RELATIVE_RF),this._mtLight.setCullingActive(!0));var o=this._scene.getMinimumBound(),s=o.radius(),l=this.multUI_?this.multUI_:o.radius2()/1e3,c=Math.pow(r*l,.125),h=.05*s*(c=Math.min(Math.max(c,0),1))+.8*s*(1-c);"SPOT"===n&&this._spotGeom.updateCone(t.getSpotCutoff()*Math.PI/180,h),"POINT"===n&&this._pointGeom.updateRadius(h),this._dirGeom.setNodeMask(i&&"DIRECTION"===n?_e.a.NO_PICK_NO_SHADOW:0),this._spotGeom.setNodeMask(i&&"SPOT"===n?_e.a.NO_PICK_NO_SHADOW:0),this._hemiGeom.setNodeMask(i&&"HEMI"===n?_e.a.NO_PICK_NO_SHADOW:0),this._pointGeom.setNodeMask(i&&"POINT"===n?_e.a.NO_PICK_NO_SHADOW:0),Ns.vec3.copy(this._hemiGeom.getOrCreateStateSet().getUniform("uGround").getInternalArray(),t.getGround()),Ns.vec3.copy(this._mtEditLight.getOrCreateStateSet().getUniform("uColor").getInternalArray(),this.get("color"));var d=this._mtEditLight.getOrCreateStateSet();d.getUniform("uEnable").setInt(0|i),d.getUniform("uAttachedToCamera").setInt(0|this.isAttachedToCamera()),this._quadGeom.setLightType(n)}},setLightUnit:function(e){this._light.getLightNumber()!==e&&(this._light.setLightNumber(e),this._light.setName("skfb"+this._light.getTypeMember()),this._shadowMap.dirty())},setIconVisibility:function(e){this._mtEditLight.setNodeMask(e?_e.a.PICK_GIZMO_LIGHT:0)},isAttachedToCamera:function(){var e=this.get("type");return("DIRECTION"===e||"HEMI"===e)&&this.get("attachedToCamera")},resetPosition:function(){Ns.mat4.identity(this._mtLight.getMatrix()),this._scene&&Ns.mat4.translate(this._mtLight.getMatrix(),this._mtLight.getMatrix(),this._scene.getMinimumBound().center()),V.a.draw()},updateAttachedToCamera:function(){var e=Ns.mat4.create(),t=Ns.vec3.create();return function(n){if(this._updateMatrixOnToggleCamera){var i=this.get("matrix");Ns.mat4.getTranslation(t,i),this.get("attachedToCamera")?Ns.mat4.copy(e,n.getViewMatrix()):Ns.mat4.invert(e,n.getViewMatrix()),Ns.mat4.multiply(i,e,i),Ns.mat4.setTranslation(i,t)}}}(),setUpdateMatrixOnToggleCamera:function(e){this._updateMatrixOnToggleCamera=e}}),Ds=d.a.osg,Fs={ThreePointLight:function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(-.9815804500275482,.1909922167095499,-.004668327333101102,0,.13548347102422797,.7131126062169096,.6878332937084056,0,.13469984856318096,.6745312327912614,-.7258536813891331,0,0,0,0,1),color:Ds.vec3.fromValues(.7806122448979592,.7985214493960848,1),intensity:.96},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.7755211495104662,-.0666602860002539,.6277924441503967,0,.2690483737361956,.9344846523281437,-.233133882464682,0,-.5711216326246741,.3497067926613838,.7426474533145686,0,0,0,0,1),color:Ds.vec3.fromValues(1,.8783319450229073,.7091836734693877),intensity:1},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.6903299131022926,-.7076363669144057,-.15064986988498263,0,-.011089698239978026,.19785137301620165,-.9801692980238416,0,.7234097246160907,.6783108479272498,.12873524736872857,0,0,0,0,1),color:Ds.vec3.fromValues(.423469387755102,.7352665556018328,1),intensity:.12,ground:Ds.vec3.fromValues(.9642857142857143,.6484128636877489,.2607507288629738),intensityGround:.06}]},FullMoonNight:function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.9997395789367833,.0037284998571004493,-.02251383121813605,0,-.003172416108909601,.9996902441347245,.024685047253076783,0,.02259889562202194,-.024607195505995896,.9994417320914686,0,0,0,0,1),color:Ds.vec3.fromValues(.14431486880466474,.20264621883738915,.3928571428571429),intensity:1.5400000000000005,ground:Ds.vec3.fromValues(.9744897959183674,.6276245973191442,.3331164098292378),intensityGround:.06},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.9321120105125691,.3015730438836578,-.2005514873067817,0,.11902736304545063,-.7780729183457072,-.6167941476566071,0,-.34205216956578893,.5510501183556175,-.7611465564236605,0,0,0,0,1),color:Ds.vec3.fromValues(1,.613390254060806,.19387755102040816),intensity:2.9799999999999995},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.5165535747993983,-.2459126458378022,-.8201825254045677,0,-.40819067915319995,.771302442076031,-.48833688402577136,0,.7526970000035951,.5870430252243886,.29803978378898704,0,0,0,0,1),color:Ds.vec3.fromValues(1,1,1),intensity:.38}]},LowKeyLight:function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.022621146436927503,-.2660807408393079,-.9636852821789301,0,-.18898982664775527,.9454138725983617,-.26547213586781604,0,.9817184571747294,.1881319984823789,-.02890020742997683,0,0,0,0,1),color:Ds.vec3.fromValues(1,1,1),intensity:1},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(-.9330760233019924,.058913139300351657,.35482161258401,0,.19787524547993016,.9078715652207372,.36961413432105955,0,-.30035732380815566,.4150885003001482,-.8587706416461712,0,0,0,0,1),color:Ds.vec3.fromValues(1,1,1),intensity:.22},{type:"NONE",enable:!0}]},EvilGenius:function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.9967621126545051,.025235816589958687,.07634424888336766,0,.000702423157861877,-.9521689363972996,.3055713061819492,0,.08040396369728874,-.3045282747481311,-.9491036468693457,0,0,0,0,1),color:Ds.vec3.fromValues(1,.3450645564348185,.056122448979591844),intensity:1.5400000000000005},{type:"DIRECTION",enable:!0,attachedToCamera:!0,castShadows:!1,matrix:Ds.mat4.fromValues(-.7932202797763206,.039941473670798935,.6076234577701727,0,.16089796285361985,.9761307284151629,.14587887644631273,0,-.5872933111326324,.21347945972549276,-.780713191238742,0,0,0,0,1),color:Ds.vec3.fromValues(.15368596418159094,.7346938775510203,.20111518159950362),intensity:1.9000000000000008},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.9998681367204546,.01574007797565349,.003994886292083951,0,0,.24600379421877677,-.9692688652948499,0,-.016239124704439348,.9691410543235108,.24597135535169048,0,0,0,0,1),color:Ds.vec3.fromValues(.9897959183673469,.674842115105101,.02524989587671801),intensity:.02,ground:Ds.vec3.fromValues(.3,.2,.2),intensityGround:.98}]},FairyCamp:function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.7285122591021403,-.5166704810444328,-.44980162555865727,0,.2899427624247639,.827461680647148,-.4808745798834604,0,.6206473095530125,.21990630067806594,.752620844826062,0,0,0,0,1),color:Ds.vec3.fromValues(.8476936693044566,.8957603762037927,.9948979591836735),intensity:.9},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.08433618912371937,-.8568665398386119,-.5085932953835439,0,-.8584235966554874,-.3216498975444721,.39956260099599905,0,-.5059608047162799,.40289089877364465,-.7626811835729392,0,0,0,0,1),color:Ds.vec3.fromValues(.37244897959183676,.538942107455227,1),intensity:1.7200000000000006},{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.9766324883850551,-.001534767629049323,.21491074221438983,0,.14494434684687327,-.7336231034872216,-.6639188793421307,0,.15868244688039193,.6795548443783637,-.7162577012039377,0,0,0,0,1),color:Ds.vec3.fromValues(.3389212827988338,.7142857142857143,.346581781400607),intensity:.5,ground:Ds.vec3.fromValues(.9947417742607245,.48469387755102045,1),intensityGround:.14}]},ThreePointLightV2:function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!0,castShadows:!1,matrix:Ds.mat4.fromValues(-.9815804500275482,.1909922167095499,-.004668327333101102,0,.13548347102422797,.7131126062169096,.6878332937084056,0,.13469984856318096,.6745312327912614,-.7258536813891331,0,0,0,0,1),color:Ds.vec3.fromValues(.7806122448979592,.7985214493960848,1),intensity:.96},{type:"DIRECTION",enable:!0,attachedToCamera:!0,castShadows:!1,matrix:Ds.mat4.fromValues(.7755211495104662,-.0666602860002539,.6277924441503967,0,.2690483737361956,.9344846523281437,-.233133882464682,0,-.5711216326246741,.3497067926613838,.7426474533145686,0,0,0,0,1),color:Ds.vec3.fromValues(1,.8783319450229073,.7091836734693877),intensity:1},{type:"HEMI",enable:!0,attachedToCamera:!1,castShadows:!1,matrix:Ds.mat4.fromValues(.6903299131022926,-.7076363669144057,-.15064986988498263,0,-.011089698239978026,.19785137301620165,-.9801692980238416,0,.7234097246160907,.6783108479272498,.12873524736872857,0,0,0,0,1),color:Ds.vec3.fromValues(.423469387755102,.7352665556018328,1),intensity:.12,ground:Ds.vec3.fromValues(.9642857142857143,.6484128636877489,.2607507288629738),intensityGround:.06}]},TwoHeadLightV1:function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!0,castShadows:!1,matrix:Ds.mat4.fromValues(Math.SQRT1_2,0,Math.SQRT1_2,0,-0,1,0,0,-Math.SQRT1_2,-0,Math.SQRT1_2,0,0,0,0,1),color:Ds.vec3.fromValues(.6,.48,.3),intensity:1},{enable:!0,attachedToCamera:!0,castShadows:!1,type:"DIRECTION",matrix:Ds.mat4.fromValues(Math.SQRT1_2,0,-Math.SQRT1_2,0,0,1,0,0,Math.SQRT1_2,0,Math.SQRT1_2,0,0,0,0,1),color:Ds.vec3.fromValues(.42,.42,.6),intensity:1},{type:"NONE",enable:!0}]},LightFromAbove:function(){return[{type:"DIRECTION",enable:!0,attachedToCamera:!1,castShadows:!0,matrix:Ds.mat4.fromValues(.9997395789367833,.0037284998571004493,-.02251383121813605,0,-.003172416108909601,.9996902441347245,.024685047253076783,0,.02259889562202194,-.024607195505995896,.9994417320914686,0,0,0,0,1),color:Ds.vec3.fromValues(1,1,1),intensity:.01},{type:"NONE",enable:!0},{type:"NONE",enable:!0}]}},Vs=Fs,Bs=d.a.osg,Us=a.a.extend({defaults:function(){return{select:-1,lights:[new ks(0),new ks(1),new ks(2)],webVR:!1,forceShadowRedraw:!1}},getName:function(){return"Lighting"},getDefaultFalloff:function(){var e=this._root.getMinimumBound().radius();return e<0?0:3.90625/(e*e)},setPreset:function(e){Vs[e]||console.error("Preset does not exist: "+e),this.setJSON({enable:this.get("enable"),lights:Vs[e]()},{resetFalloff:!0})},init:function(e){this._viewer=e.getViewer(),this._root=this._viewer.getRootModel(),this.set("enable",!Object(Qt.a)());var t=e.getModel().get("options").lighting;t&&t.lights&&(this._ignoreSceneLights=!0,this.setJSON(t)),k.a.getModelDisplayed().then(this.initDepthTexture.bind(this))},initDepthTexture:function(){for(var e=this._viewer.getFeaturesManager().getTextureDepth(),t=this.get("lights"),n=0;n<3;++n)t[n].setDepthTexture(e)},dirtyScene:function(){X.a.getModelBoxWithoutDisplacement()?this.recomputeLightsPositionAndFalloff():X.a.getBoxReady().then(this.recomputeLightsPositionAndFalloff.bind(this))},recomputeLightsPositionAndFalloff:function(){for(var e=X.a.getModelBoxWithoutDisplacement(),t=this.get("lights"),n=.8*e.radius(),i=this.getDefaultFalloff(),r=e.center(Bs.vec3.create()),a=Bs.vec3.fromValues(0,0,n),o=0;o<3;++o){var s=t[o],u=s.get("matrix");s.get("falloff")<0&&(s.set("falloff",i),u[12]=r[0],u[13]=r[1],u[14]=r[2],Bs.mat4.translate(u,u,a)),s.dirty()}},initLights:function(e){var t=0,n=this.get("lights");for(t=0;t<3;++t)n[t].setScene(this._root);if(this._ignoreSceneLights)return this.trigger("uiReady");var i=e.length;if(Object(Qt.a)()){if(0===i)return this.setPreset("ThreePointLight"),this.trigger("uiReady");this.set("enable",!0)}else{for(t=0;t<3;++t)n[t].set("castShadows",!1);if(0===i)return this.setPreset("TwoHeadLightV1"),this.trigger("uiReady");if(i>3)return this.setPreset("ThreePointLightV2"),this.trigger("uiReady")}e.sort(function(e,t){return Bs.vec3.len(e.getDiffuse())-Bs.vec3.len(t.getDiffuse())});var r=Bs.vec3.create();for(t=0;t<3;++t){var a=e[t],o=n[t];if(a){var s=a.getLightType();o.set("type",s),o.set("attachedToCamera",!1),"SPOT"===s&&(o.set("angle",Math.min(90,a.getSpotCutoff())),o.set("hardness",a.getSpotBlend()));var u=a.getDiffuse(),l=Math.max(u[0],u[1],u[2],1);o.set("intensity",l),Bs.vec3.scale(o.get("color"),u,1/l);var c=a.getGround(),h=Math.max(c[0],c[1],c[2],1);o.set("intensityGround",h),Bs.vec3.scale(o.get("ground"),c,1/h),o.set("falloff",a.getQuadraticAttenuation());var d=o.get("matrix");Bs.mat4.getScale(r,a._worldMatrix),Bs.mat4.fromScaling(d,r),Bs.mat4.invert(d,d),Bs.mat4.multiply(d,a._worldMatrix,d)}else o.set("falloff",this.getDefaultFalloff()),o.set("type","NONE")}return this.trigger("uiReady")},getJSON:function(){var e={},t=this.get("lights");return e.enable=this.get("enable"),e.lights=[t[0].getJSON(),t[1].getJSON(),t[2].getJSON()],e},setJSON:function(e,t){var n=t||{};n.ignore=["lights"],a.a.prototype.setJSON.call(this,e,n);var i=this.get("lights");void 0!==e.enable&&this.set("enable",e.enable);for(var r={validate:n.validate},o=0;o<3;++o){var s=e.lights[o];if(s){var u=i[o];u.setUpdateMatrixOnToggleCamera(!1),u.setJSON(s,r),u.setUpdateMatrixOnToggleCamera(!0),t&&t.resetFalloff&&u.set("falloff",-1),u.get("falloff")<0&&this.dirtyScene()}}},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0,resetFalloff:!0})}}),js=d.a.osg,Gs={FeatureName:"lighting",ModelType:Us,ViewListType:[D.a.extend({initialize:function(e){D.a.prototype.initialize.apply(this,arguments),this.model.bind("change:select",this.onSelectChanged,this),this.model.bind("change:enable",this.onEnableChanged,this),this.model.bind("change",V.a.draw),this._viewer=e.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._manipulator=this._viewerOSGJS.getManipulator(),this._isScreenshot=!1,this._nodeFeature=new js.Node,this._nodeFeature.setName("Feature - Lighting"),this._shadowNode=new d.a.osgShadow.ShadowedScene(Fa()),this._shadowNode.setName("Shadowed scene"),this._lightNode=new js.Camera,this._lightNode.setName("Lighting - Camera"),this._lightNode.setNearFarRatio(5e-5),this._lightNode.getOrCreateStateSet().setRenderBinDetails(Se.a.EDITOR_GIZMO,"RenderBin"),this._lightNode.setNodeMask(_e.a.NO_SHADOW),this.initLightNode(),this.onEnableChanged(),this._nodeFeature.addChild(this._lightNode),k.a.getMaterial().then(this.handleDirtyShadows.bind(this))},getNode:function(){return this._nodeFeature},getNodeLight:function(){return this._lightNode},getNodeShadow:function(){return this._shadowNode},isLightNone:function(e){return-1===e||"NONE"===this.model.get("lights")[e].get("type")},isTabLighting:function(){var e=this._viewer.getFeaturesManager();return e&&"lighting"===e.getCurrentTabName()},handleDirtyShadows:function(){var e=this._viewer.getFeatures().material;if(e){var t=e.getModel().attributes,n=this.model.get("lights"),i=n.length;for(var r in t)for(var a=t[r],o=a.getChannels().Opacity,s=a.getChannels().Displacement,u=0;u<i;++u){var l=n[u];o.bind("change",l.dirty,l),s.bind("change",l.dirty,l)}}},onEnableChanged:function(){var e=this.model.get("enable");if(this._lightNode.setNodeMask(e?_e.a.NO_SHADOW:0),!e){var t=this.getGizmo();t&&t.attachToNode(null)}for(var n=this.model.get("lights"),i=0,r=n.length;i<r;++i){var a=n[i],o=e&&a.get("enable");a.getLightSource().getLight().setEnabled(o),Object(u.a)().shadowAtlas&&!o&&ja(this._shadowNode,a.getShadowMap())}e&&this._updateLightsAndIcons()},initLightNode:function(){this._nodeFeature.addUpdateCallback(this);for(var e=this.model.get("lights"),t=0,n=e.length;t<n;++t){var i=e[t];i.setLightUnit(t),i.bind("change",i.dirty,i),i.bind("change:attachedToCamera",i.updateAttachedToCamera.bind(i,this._viewer.getCamera()),i),i.bind("change",V.a.draw),this._lightNode.addChild(i.getNode())}},getGizmo:function(){var e=this._viewer.getFeaturesManager();return e?e.getNodeGizmo():null},onSelectChanged:function(){var e=this.getGizmo();if(e){var t=this.model.get("select");this.isLightNone(t)?e.attachToNode(null):e.attachToNode(this.model.get("lights")[t].getNodeEditLight())}},updateSelection:function(){var e=this.getGizmo();if(e&&!e._isEditing){var t=e._attachedNode;if(!this.isLightNone(this.model.get("select"))||t)for(var n=this.model.get("lights"),i=0;i<3;++i)if(n[i].getNodeEditLight()===t){e.updateGizmoMask(),this.model.set("select",i);break}}},updateLightIcons:function(){var e=js.vec4.create(),t=js.vec3.create(),n=js.vec3.create(),i=js.quat.create();return function(){var r=this.model.get("lights"),a=this._viewer.getCamera(),o=this._viewer.getFeaturesManager().getIconScaleFov();this._manipulator.getEyePosition(n);for(var s=this.getGizmo(),u=0;u<3;++u){var l=r[u];if("NONE"!==l.get("type")){var c=l.getNodeEditLight(),h=l.getNodeLight(),d=l.getNodeQuad(),f=l.getNodeScale(),p=s._isEditing&&s._attachedNode===c,g=d.getMatrix(),m=c.getMatrix(),v=h.getMatrix();l.isAttachedToCamera()?p?(js.mat4.getTranslation(t,m),js.mat4.multiply(v,a.getViewMatrix(),m),js.mat4.setTranslation(v,t)):(js.mat4.getTranslation(t,v),js.mat4.invert(m,a.getViewMatrix()),js.mat4.multiply(m,m,v),js.mat4.setTranslation(m,t)):p?js.mat4.copy(v,m):js.mat4.copy(m,v),js.mat4.copy(l.get("matrix"),v),c.getWorldMatrix(void 0,g),js.mat4.getTranslation(t,g);var _=js.vec3.dist(n,t)/o;js.mat4.fromScaling(f.getMatrix(),js.vec3.set(e,_,_,_)),js.mat4.multiply(g,a.getViewMatrix(),g),js.mat4.invert(g,g),js.mat4.fromQuat(g,js.mat4.getRotation(i,g)),d.dirtyBound(),h.dirtyBound(),f.dirtyBound()}}}}(),setIsScreenshot:function(e){this._isScreenshot=e},_updateLightsAndIcons:function(){if(this._lightNode.getNodeMask()&&this._shadowNode.getChildren().length){for(var e=this._viewer.getFeatures().shadingStyle,t=this._viewer.getFeatures().ARKit.getModel().get("enable")||"lit"===e.getModel().get("type"),n=!this._isScreenshot&&t&&this.isTabLighting(),i=this._viewer.getFeaturesManager().getShadowForcedUpdate(),r=this.model.get("webVR"),a=this.model.get("lights"),o=0;o<3;++o){var s=a[o],u=i||s.isDirty();s.updateNode();var l=s.getShadowMap();if(l){var c=r&&s.isAttachedToCamera();if(!c&&t&&s.get("enable")&&s.isCastingShadows()){if(!(u=u||s.isAttachedToCamera()||i)){for(var h=s.get("matrix"),d=s.get("matrixPrev"),f=0;f<16;f++)if(h[f]!==d[f]){u=!0;break}js.mat4.copy(d,h)}u&&l.requestRedraw(),Ua(this._shadowNode,l)}else(u||c)&&ja(this._shadowNode,l);s.setIconVisibility(n)}}n&&(this.updateLightIcons(),this.updateSelection())}},update:function(e,t){return e.getNumChildrenRequiringUpdateTraversal()>0&&t.traverse(e),this._updateLightsAndIcons(),!1}})]},Hs=i.a.create(Gs);Hs.prototype.getNode=function(){return this._views[0].getNode()},Hs.prototype.getNodeShadow=function(){return this._views[0].getNodeShadow()},Hs.prototype.prepareForScreenShot=function(){this._views[0].setIsScreenshot(!0)},Hs.prototype.resetAfterScreenShot=function(){this._views[0].setIsScreenshot(!1)};var zs=Hs,Ws=d.a.osg,qs=a.a.extend({initialize:function(){a.a.prototype.initialize.apply(this,arguments),this._sssSchema=this.getSubSchema("scene.sssProfiles"),this.set("sssProfiles",this.getInstance(this._sssSchema))},getModelOptionPath:function(){return"scene.postProcess"},defaults:{postProcessReady:!1,rgbmDefault:7,rgbmBloom:1,sssCurrentProfile:0,webVR:!1,AR:!1,veilFactor:1,doDistortionVR:!1,distortion:Ws.vec2.fromValues(.441,.156),projectionLeft:Ws.vec4.fromValues(1,1,-.5,-.5),unprojectionLeft:Ws.vec4.fromValues(1,1,-.5,-.5),vrFadeLength:Object(u.a)().vrFade/1e3/2,vrStartFade:!1,vrFadeStartTime:0,vrFadeCallback:void 0,vrFading:!1},getName:function(){return"PostProcess"},getViewer:function(){return this._viewer},useSSSLookupFloat:function(){return Ws.WebGLCaps.instance().getWebGLExtension("OES_texture_float_linear")},getSSSWeightRange:function(){return 2*Object(u.a)().sssHalfKernel-1>20?3:2},setQuality:function(e){void 0!==Object(u.a)().quality&&(e=Object(u.a)().quality),Oa.a.uQuality.setFloat(e)},getQuality:function(){return Oa.a.uQuality.getInternalArray()[0]},_getBoundRadius:function(){return X.a.getModelBoxWithDisplacement().radius()},getMinimumSsaoRadius:function(){return.01*this._getBoundRadius()},getMaximumSsaoRadius:function(){return.1*this._getBoundRadius()},getMinimumSsaoBias:function(){return.002*this._getBoundRadius()},getMaximumSsaoBias:function(){return.01*this._getBoundRadius()},_makeValidOption:function(e,t,n,i){var r=this.get(e);r<t*X.a.BIAS_MIN||r>n*X.a.BIAS_MAX?this.set(e,i):this.set(e,Math.min(Math.max(r,t),n))},_makeValidSsaoRadius:function(){this._makeValidOption("ssaoRadius",this.getMinimumSsaoRadius(),this.getMaximumSsaoRadius(),.025*this._getBoundRadius())},_makeValidSsaoBias:function(){this._makeValidOption("ssaoBias",this.getMinimumSsaoBias(),this.getMaximumSsaoBias(),.005*this._getBoundRadius())},_isEffectivePP:function(){return this.get("enable")},isEffectiveGrain:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("grainEnable")&&this.get("grainFactor")>=5e-4},isEffectiveSharpen:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("sharpenEnable")&&this.get("sharpenFactor")>=5e-4},isEffectiveChromaticAberration:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("chromaticAberrationEnable")&&this.get("chromaticAberrationFactor")>=.001},isEffectiveVignette:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("vignetteEnable")&&this.get("vignetteHardness")-this.get("vignetteAmount")<=.5*Math.sqrt(2)},isEffectiveBloom:function(){return this._isEffectivePP()&&(!this.get("webVR")||!vr.a.any)&&this.get("bloomEnable")&&this.get("bloomFactor")>=.01},isEffectiveToneMapping:function(){return this._isEffectivePP()&&this.get("toneMappingEnable")},isEffectiveColorBalance:function(){return this._isEffectivePP()&&this.get("colorBalanceEnable")},isEffectiveDof:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("dofEnable")&&(this.get("dofBlurNear")>=.01||this.get("dofBlurFar")>=.01)},isEffectiveSsao:function(){return this._isEffectivePP()&&!this.get("webVR")&&this.get("ssaoEnable")&&this.get("ssaoIntensity")>=.01},isEffectiveSsr:function(){return this._isEffectivePP()&&rn.a.get("mask")&rn.a.LIT&&!this.get("webVR")&&this.get("ssrEnable")&&this.get("ssrFactor")>.01},hasAtLeastOneEffectiveEffect:function(){return!!this.isEffectiveSsr()||(!!this.isEffectiveGrain()||(!!this.isEffectiveSharpen()||(!!this.isEffectiveChromaticAberration()||(!!this.isEffectiveVignette()||(!!this.isEffectiveBloom()||(!!this.isEffectiveToneMapping()||(!!this.isEffectiveColorBalance()||(!!this.isEffectiveDof()||!!this.isEffectiveSsao()))))))))},initAfterFirstFrame:function(){this._makeValidSsaoRadius(),this._makeValidSsaoBias(),this.trigger("uiReady"),this.set("postProcessReady",!0)},init:function(e){this._viewer=e.getViewer();var t=e.getModel().get("options");if(t.scene&&t.scene.sssProfiles&&this.setProfilesJSON(t.scene.sssProfiles),t.scene&&t.scene.postProcess){var n=t.scene.postProcess;this.setJSON(n),void 0!==Object(u.a)().postProcess&&this.set("enable",Object(u.a)().postProcess),void 0!==Object(u.a)().ssr&&this.set("ssrEnable",Object(u.a)().ssr);var i=n.taa,r=Object(u.a)().taa;if(i){this.set("taaEnable",void 0!==r?r:i.enable);var a=Object(u.a)().taaTransparent;this.set("taaTransparent",void 0!==a?a:i.transparent),void 0===r&&X.a.getBoxReady().then(function(){X.a.getMaxDistanceFromOrigin()>1e6&&this.set("taaEnable",!1)}.bind(this))}else void 0!==r&&this.set("taaEnable",r)}Object(Qt.a)()&&k.a.getMaterial().then(function(){"Tilt Brush"===this._viewer.getRootUserData().authoringTool?(this.set("bloomEnable",!0),this.set("bloomThreshold",.6),this.set("bloomFactor",1.6),this.set("bloomRadius",.2),this.set("toneMappingEnable",!0),this.set("toneMappingMethod","filmic")):"minecraft"!==this._viewer.getRootUserData().source&&"mineways"!==this._viewer.getRootUserData().source||(this.set("ssaoEnable",!0),this.set("ssaoRadius",.05),this.set("ssaoIntensity",1),this.set("ssaoBias",.006))}.bind(this))},fadeForTeleportVR:function(e){this.set("vrStartFade",!0),this.set("vrFadeCallback",e)},setProfilesJSON:function(e,t){if(t&&t.validate){var n=this.validate(e,{schema:this._sssSchema});if(n.length)return console.error("Failed to validate sss profile json",e,n),n.join("\n")}return this.set("sssProfiles",e),[]},getProfilesJSON:function(){return this.get("sssProfiles")},editorGetJSON:function(){return this.getJSON()},editorSetJSON:function(e){return this.setJSON(e,{validate:!0})}}),Xs=n("GFHa"),Ys=d.a.osg,Ks=d.a.osgShader.shaderProcessor,Qs={pascalCache:[[1]],getOrCreatePascalCoefficients:function(e){e=void 0===e?5:Math.min(e,128);var t=Qs.pascalCache;if(t[e])return t[e];for(var n=t.length-1;n<e;n++){var i=t[n],r=i.length,a=new Array(r);a[0]=1,a[r]=1;for(var o=n===t.length-1?Math.pow(2,n):1,s=0;s<r-1;s++)a[s+1]=(i[s]+i[s+1])*o;o=Math.pow(2,n+1);for(var u=0;u<r+1;u++)a[u]/=o;t.push(a)}return t[e]}},Js=function(e){var t=e.toString();return-1===t.indexOf(".")?t+".0":t},Zs=function(e,t){var n=.005/e,i=e,r=Qs.getOrCreatePascalCoefficients(i),a=Math.floor(i/2),o=[],s=Js(r[a]);a+1>=e&&(s="1.0");var u,l=1;for(o.push("vec3 pixel = "+s+" * %fetch(gTexCoord.xy).rgb;"),o.push("vec2 offset;"),o.push("vec2 blurDir = uPixelRatio.xy * uBlurDir.xy / uTextureOutputSize.xy;"),t&&o.push("blurDir *= uGlobalTexSize.y * 0.00075;"),u=a+1;u<e;u+=2){var c=r[u],h=r[u+1],d=c+h;if(d<n)break;var f=(l*c+(l+1)*h)/d;o.push("offset = blurDir * "+Js(f)+";"),s=Js(d),o.push("pixel += "+s+" * %fetch(gTexCoord.xy + offset.xy).rgb;"),o.push("pixel += "+s+" * %fetch(gTexCoord.xy - offset.xy).rgb;"),l+=2}o.push("return vec4(pixel, 1.0);");for(u=0;u<o.length;++u)o[u]="    "+o[u].replace("%fetch","TEXTURE_2D_TextureBlurInput");return["uniform sampler2D TextureBlurInput;","uniform vec2 uTextureOutputSize;","uniform vec2 uPixelRatio;","uniform vec2 uBlurDir;",t?"uniform vec2 uGlobalTexSize;\n":"","vec4 gaussianBlur() {",o.join("\n"),"}"].join("\n")},$s=function(e,t,n,i,r){for(var a=2,o=Ys.Uniform.createFloat2(Ys.vec2.fromValues(0,1),"uBlurDir"),s=Ys.Uniform.createFloat2(Ys.vec2.fromValues(1,0),"uBlurDir"),u={},l=t,c=0;c<i.length;c++){var h=i[c]+1,d="gaussianBlur"+c;Ks.hasShader(d)||(u[d]=Zs(h,r)),e.push({func:{name:"gaussianBlur",file:d},uniforms:o,textures:{name:l,uniformName:"TextureBlurInput"},out:{name:"TextureBlurTemp"+c,divisor:a,filter:"linear"}}),l=n+(c+1),e.push({func:{name:"gaussianBlur",file:d},uniforms:s,textures:{name:"TextureBlurTemp"+c,uniformName:"TextureBlurInput"},out:{name:l,divisor:a,filter:"linear"}}),a*=2}Ks.addShaders(u)},eu=n("KK83"),tu=n("r6Wx"),nu=n.n(tu),iu=n("mHqZ"),ru=n.n(iu),au=n("x17P"),ou=n.n(au),su=n("QorK"),uu=n.n(su),lu=n("iXLb"),cu=n.n(lu),hu=n("pg5E"),du=n.n(hu),fu=n("RGp6"),pu=n.n(fu),gu=n("hgfR"),mu=n.n(gu),vu=n("bjo4"),_u=n.n(vu),bu=n("R/Z7"),Su=n.n(bu),yu=n("Ht5+"),xu=n.n(yu),Cu=n("Sru3"),wu=n.n(Cu),Tu=n("uCb/"),Mu=n.n(Tu),Eu=n("q+nQ"),Au=n.n(Eu),Ou=n("B0qL"),Ru=n.n(Ou),Pu=n("O+7P"),Iu=n.n(Pu),Nu=n("VThJ"),Lu=n.n(Nu),ku=n("HF1e"),Du=n.n(ku),Fu=n("1irs"),Vu=n.n(Fu),Bu=n("zE1p"),Uu=n.n(Bu),ju=n("LiSq"),Gu=n.n(ju),Hu=n("A6cf"),zu=n.n(Hu),Wu=n("ZE7+"),qu=n.n(Wu),Xu=n("Mg89"),Yu=n.n(Xu),Ku=n("E5qE"),Qu=n.n(Ku),Ju=n("/+vK"),Zu=n.n(Ju),$u=n("6LWN"),el=n.n($u),tl=n("13g6"),nl=n.n(tl),il=n("f4Fj"),rl=n.n(il),al=n("SzI9"),ol=n.n(al),sl=n("iffO"),ul=n.n(sl),ll=n("UKde"),cl=n.n(ll),hl=n("ME+G"),dl=n.n(hl),fl=n("UUlS"),pl=n.n(fl),gl=n("Q9ME"),ml=n.n(gl),vl=n("apoH"),_l=n.n(vl),bl=n("N4IH"),Sl=n.n(bl),yl=n("+5pB"),xl=n.n(yl),Cl=n("LnOO"),wl=n.n(Cl),Tl=d.a.osg,Ml=d.a.osgUtil,El=d.a.osgShader.shaderProcessor,Al=function(e){Tl.Node.call(this),this.setName("PostProcess - node In"),this._view3d=e,this._camera=e._camera,this._effectiveConfig=e._effectiveConfig,this._viewer=e._viewer,this._viewerOSGJS=e._viewerOSGJS,this._model=e.model,this._hasTriangles=this._viewer.getOrCreateScene().getJSON().faceCount>0,Aa.a.setHasTriangles(this._hasTriangles),this._viewer.getCamera().getRenderer().setRenderStage(new Aa.a),this._model.on("pingPongTexture0",this.onPingPongTexture0,this),k.a.getMaterial().then(function(){var e=this.getBackgroundModel();e.bind("backgroundUpdated",this.onBackgroundUpdated,this),e.bind("change:color",this.onBackgroundColor,this)}.bind(this)),this._composer=void 0,this._addShaders()};Tl.createPrototypeNode(Al,Tl.objectInherit(Tl.Node.prototype,{_addShaders:function(){var e={"passThrough.glsl":nu.a,"setDepthAlpha.glsl":ru.a,"combineOpacity.glsl":ou.a,"combineRefraction.glsl":uu.a,"packMipmapRefraction.glsl":cu.a,"sssCommon.glsl":du.a,"sssExtract.glsl":pu.a,"sssBlur.glsl":mu.a,"sssCombine.glsl":_u.a,"packMipmapDepth.glsl":Su.a,"depthMipmap.glsl":xu.a,"ssaoExtract.glsl":wu.a,"ssaoBlur.glsl":Mu.a,"dofCommon.glsl":Au.a,"dofCoC.glsl":Ru.a,"dofNearDilate.glsl":Iu.a,"dofDownsampleColor.glsl":Lu.a,"dofBlurCircular.glsl":Du.a,"dofCombine.glsl":Vu.a,"bloomExtract.glsl":Uu.a,"bloomCombine.glsl":Gu.a,"chromaticAberration.glsl":zu.a,"vignette.glsl":qu.a,"toneMapping.glsl":Yu.a,"colorBalance.glsl":Qu.a,"supersample.glsl":Zu.a,"supersampleTaa.glsl":el.a,"composeExtra.glsl":nl.a,"composeFixedBackground.glsl":rl.a,"fxaa.glsl":ol.a,"grain.glsl":ul.a,"sharpen.glsl":cl.a,"dofCross.glsl":dl.a,"distortion.glsl":pl.a,"ascii.glsl":ml.a,"fadeVr.glsl":_l.a,"veilVr.glsl":Sl.a,"outline.glsl":xl.a,"finalPremultAlpha.glsl":wl.a};El.addShaders(e)},getNodeBackground:function(){return this._viewer.getFeatures().environment.getNode().getBackground()},getBackgroundModel:function(){return this._viewer.getFeatures().background.getModel()},getBackgroundType:function(){return this.getBackgroundModel().getEnableType()},onPingPongTexture0:function(e){this._composer&&this._composer.swapFeedbackLoopTextures(e)},_replaceTexture:function(e,t,n){var i=this._composer.getStateSetPass(t);if(i){var r=i.getUniform(n);r&&i.setTextureAttributeAndModes(r.getInternalArray()[0],e)}},onBackgroundUpdated:function(e){void 0!==this._composer&&"fixed"===this._effectiveConfig.bgType&&(this._replaceTexture(e,"composeFixedBackground","TextureFixed"),this._replaceTexture(e,"composeFixedBackgroundRefraction","TextureFixed"))},onBackgroundColor:function(){var e=Aa.a.getClearColor();if("color"===this.getBackgroundType()){Tl.vec3.copy(e,this.getBackgroundModel().getColor()),e[3]=1,1===Oa.a.uOutputLinear.getInternalArray()[0]&&Xs.a.srgbToLinear(e,e);var t=Oa.a.uRGBMRange.getInternalArray()[0];t>0&&Xs.a.encodeRGBM(e,t,e)}else Tl.vec4.set(e,0,0,0,0)},_getSupportedFloatTexture:function(){var e=Tl.WebGLCaps.instance();return 0===Object(u.a)().floatRtt?Tl.Texture.UNSIGNED_BYTE:e.hasLinearHalfFloatRTT()?Tl.Texture.HALF_FLOAT:e.hasHalfFloatRTT()?Tl.Texture.HALF_FLOAT:vr.a.any&&this._model.get("webVR")&&2===Object(u.a)().floatRtt?Tl.Texture.UNSIGNED_BYTE:e.hasLinearFloatRTT()?Tl.Texture.FLOAT:e.hasFloatRTT()?Tl.Texture.FLOAT:Tl.Texture.UNSIGNED_BYTE},_updateEffectiveConfig:function(){var e=this._effectiveConfig,t=Oi.get("hasTransparency"),n=Oi.get("hasExtra"),i=Oi.get("hasRefraction"),r=Oi.get("hasScattering");e.webVR=this._model.get("webVR"),e.AR=this._model.get("AR");var a=this._model.get("doDistortionVR")&&Object(u.a)().vrStereo;e.useDistortionVR=e.webVR&&a,e.useSss=r,e.useSsao=this._model.isEffectiveSsao(),e.useDof=this._model.isEffectiveDof(),e.useBloom=this._model.isEffectiveBloom(),e.useChromaticAberration=this._model.isEffectiveChromaticAberration(),e.useToneMapping=this._model.isEffectiveToneMapping(),e.useColorBalance=this._model.isEffectiveColorBalance(),e.bgType=this.getBackgroundType(),e.hasBG="none"!==e.bgType,e.useTaa=!e.AR&&this._model.get("taaEnable"),e.useTaaTransparent=e.useTaa&&this._model.get("taaTransparent");var s=Object(u.a)().fxaa;return e.useFxaa=void 0===s?this._hasTriangles:s,e.useGrain=this._model.isEffectiveGrain(),e.useSharpen=this._model.isEffectiveSharpen(),e.useVignette=this._model.isEffectiveVignette(),e.useTransparency=t||e.webVR||Object(o.a)(),e.useSsr=this._model.isEffectiveSsr(),e.useRefraction=i,e.useDepth=this._needDepthTexture(),e.useExtra=n||e.webVR||e.AR,rn.a.set("hasSsr",e.useSsr),this._effectiveConfig},_needDepthTexture:function(){if(Object(o.a)())return!0;var e=this._effectiveConfig;if(e.useRefraction||e.useSsr||e.useDof||e.useBloom||e.useSharpen||e.useSsao||e.useSss||e.useTaa||!e.useFxaa)return!0;if(this._viewer.getFeatures().hotspot.getModel().get("hotspots").length>0)return!0;var t=this.getBackgroundType();return"none"===t||"fixed"===t||this._model.get("webVR")},_addInternalTextures:function(e,t,n){e.addInternalTexture({name:"TextureOpaque",immuable:!0,srgb:n,rgbm:!n}),e.setInputTexture("TextureOpaque"),(t.useRefraction||t.useSsr)&&e.addInternalTexture({name:"TextureToBeRefracted",divisor:Object(u.a)().refractionRes,immuable:!0,reusable:!1,srgb:!1,rgbm:!0}),t.useRefraction&&e.addInternalTexture({name:"TextureRefraction",immuable:!0,srgb:!1,rgbm:!0}),(t.useSsr||t.useSsao)&&e.addInternalTexture({name:"TextureMipmapDepth",immuable:!0,reusable:!1,srgb:!1,rgbm:!1}),t.useDepth&&e.addInternalTexture({name:"TextureDepth",filter:"nearest",immuable:!0,srgb:!1,rgbm:!1}),t.useTransparency&&e.addInternalTexture({name:"TextureTransparent",filter:"nearest",immuable:!0,type:this._getSupportedFloatTexture(),rgbm:!1,srgb:!1}),t.useExtra&&e.addInternalTexture({name:"TextureExtra",filter:"nearest",immuable:!0,srgb:!t.webVR,rgbm:!1})},_addSss:function(e,t){var n=this._getSupportedFloatTexture();t.addExternalTexture("TextureSSSKernel",this._view3d._sssTexKernel),e.push({func:"sssExtract",textures:[{name:"%last",uniformName:"TextureSSSColor"},"TextureDepth"],out:{name:"TextureSSSExtract",rgbm:!1,divisor:2,type:n,filter:"linear"}});var i=[];i.push("#define SSS_HALF_KERNEL_SIZE "+Object(u.a)().sssHalfKernel),i.push("#define SSS_PROFILE_COUNT "+this._model.get("sssProfiles").length),i.push("#define SSS_JITTER "+Object(u.a)().sssJitter.toExponential());var r=this._model.useSSSLookupFloat()?"1.0":this._model.getSSSWeightRange().toExponential();i.push("#define SSS_BYTE_RANGE "+r);var a=Tl.Uniform.createFloat2(Tl.vec2.fromValues(0,1),"uBlurDir");e.push({func:"sssBlur",header:i,textures:[{name:"TextureSSSExtract",uniformName:"TextureSSSBlur"},"TextureDepth","TextureSSSKernel"],uniforms:a,out:{name:"TextureSSSBlur1",divisor:2,type:n,rgbm:!1,filter:"linear"}});var o=Tl.Uniform.createFloat2(Tl.vec2.fromValues(1,0),"uBlurDir");e.push({func:"sssBlur",header:i,textures:[{name:"TextureSSSBlur1",uniformName:"TextureSSSBlur"},"TextureDepth","TextureSSSKernel"],uniforms:o,out:{name:"TextureSSSBlur2",divisor:2,rgbm:!0,filter:"linear"}}),e.push({func:"sssCombine",textures:[{name:"TextureSSSBlur2",uniformName:"TextureSSSBlur"},{name:"%last",uniformName:"TextureSSSColor"},"TextureDepth"],out:{name:"%next"}})},_packMipmapDepth:function(e){for(var t=Tl.Uniform.createInt(1,"uFirstDepth"),n=Tl.Uniform.createInt(0,"uFirstDepth"),i=1;i<=5;i++){var r=1<<i+1,a=1===i?"TextureDepth":"TextureDepth"+(i-1),o="TextureDepth"+i;e.push({func:"depthMipmap",textures:[{name:a,uniformName:"TextureDepth"}],uniforms:1===i?t:n,out:{name:o,divisor:r,filter:"linear"}})}e.push({func:"packMipmapDepth",textures:[{name:"TextureDepth",uniformName:"TextureDepth0"},"TextureDepth1","TextureDepth2","TextureDepth3","TextureDepth4","TextureDepth5"],out:{name:"TextureMipmapDepth",filter:"linear"}})},_addSsao:function(e){var t=[["#extension GL_OES_standard_derivatives : enable"]];Object(u.a)().ssaoNormal&&t.push("#define SSAO_NORMAL"),vr.a.any&&t.push("#define MOBILE"),e.push({func:"ssaoExtract",header:t,textures:"TextureMipmapDepth",out:{name:"TextureSsaoExtract",filter:"linear"}}),e.push({func:{name:"ssaoBlurH",file:"ssaoBlur.glsl"},header:"#define SSAO_BLUR_H",textures:{name:"TextureSsaoExtract",uniformName:"TextureBlurInput"},out:{name:"TextureSsaoBlurH",filter:"nearest"}}),e.push({func:{name:"ssaoBlurV",file:"ssaoBlur.glsl"},header:"#define SSAO_BLUR_V",textures:[{name:"%last",filter:"linear"},{name:"TextureSsaoBlurH",uniformName:"TextureBlurInput"}],out:{name:"%next"}})},_addCombineOpacity:function(e){e.push({func:"combineOpacity",textures:[{name:"%last",filter:"nearest"},"TextureTransparent"],out:{name:"%next"},collapsible:!0})},_packMipmapColor:function(e,t,n){var i=this._addFixedBackgroundRefraction(e,t,n);return $s(e,i,"TextureRefractionBlur",[3,5,7,9,11,13,15],!0),e.push({func:"packMipmapRefraction",textures:[{name:i,uniformName:"TextureRefractionBlur0"},"TextureRefractionBlur1","TextureRefractionBlur2","TextureRefractionBlur3","TextureRefractionBlur4","TextureRefractionBlur5","TextureRefractionBlur6","TextureRefractionBlur7"],out:{name:"TextureToBeRefracted",filter:"linear"}}),e.length},_addRefraction:function(e){e.push({func:"combineRefraction",textures:["%last","TextureRefraction"],out:{name:"%next"}})},_addDof:function(e){var t=Object(u.a)().dofRes;e.push({func:"dofCoC",textures:"TextureDepth",out:{name:"TextureDofCoC",divisor:t,filter:"nearest"}}),e.push({func:{name:"dofNearDilateH",file:"dofNearDilate.glsl"},textures:["TextureDofCoC","TextureDepth"],out:{name:"TextureDofNearDilateH",divisor:t,filter:"linear"}}),e.push({func:{name:"dofNearDilateV",file:"dofNearDilate.glsl"},textures:[{name:"TextureDofNearDilateH",uniformName:"TextureDofCoC"},"TextureDepth"],out:{name:"TextureDofNearDilateV",divisor:t,filter:"nearest"}});var n=this._getSupportedFloatTexture()===Tl.Texture.HALF_FLOAT,i=n?"#define COLOR_WITH_COC":"",r=["%last"];n&&r.push({name:"TextureDofNearDilateV",uniformName:"TextureDofCoC"}),e.push({func:"dofDownsampleColor",header:i,textures:r,out:{name:"TextureDofDownsampleColor",divisor:t,filter:"nearest",type:n?Tl.Texture.HALF_FLOAT:Tl.Texture.UNSIGNED_BYTE}});var a=[{name:"TextureDofDownsampleColor",uniformName:"TextureDofColor",rgbm:!n}];n||a.push({name:"TextureDofNearDilateV",uniformName:"TextureDofCoC"}),e.push({func:"dofBlurCircular",header:i,textures:a,out:{name:"TextureDofBlurCircular",divisor:t,filter:"linear",rgbm:!0}}),e.push({func:"dofCombine",textures:[{name:"%last",filter:"linear"},"TextureDofBlurCircular","TextureDofNearDilateV","TextureDepth"],out:{name:"%next"}})},_addBloom:function(e,t){var n,i=["%last"];t.hasBG&&(n="#define HAS_BACKGROUND",i.push("TextureDepth")),e.push({func:"bloomExtract",textures:i,header:n,out:{name:"TextureBloomExtract",filter:"linear"}});$s(e,"TextureBloomExtract","TextureBloomBlur",[3,5,7,9,11]),e.push({func:"bloomCombine",textures:[{name:"%last"},"TextureBloomBlur1","TextureBloomBlur2","TextureBloomBlur3","TextureBloomBlur4","TextureBloomBlur5"],out:{name:"%next"}})},_addMergeable:function(e,t){if(t.useChromaticAberration&&e.push({func:"chromaticAberration",textures:[{name:"%last",filter:"nearest"}],out:{name:"%next"}}),t.useColorBalance&&e.push({func:"colorBalance",textures:[{name:"%last",filter:"nearest"}],out:{name:"%next"},collapsible:!0}),t.useToneMapping){var n=[{name:"%last",filter:"nearest"}],i="";"fixed"!==t.bgType||t.useRefraction||t.useSsr||(i="#define HAS_FIXED_BACKGROUND",n.push("TextureDepth")),e.push({func:"toneMapping",header:i,textures:n,out:{name:"%next"},collapsible:!0})}t.webVR&&t.useExtra&&(e.push({func:"veilVr",textures:"%last",out:{name:"%next",filter:"nearest"},collapsible:!0}),e.push({func:"composeExtra",header:"#define LINEAR_EXTRA",textures:["%last","TextureExtra"],out:{name:"%next",filter:"nearest"},collapsible:!0}))},_addSuperSample:function(e,t){if(!t.hasBG){var n=["%last","TextureDepth"];if(t.useRefraction&&n.push("TextureRefraction"),e.push({func:"setDepthAlpha",header:t.useRefraction?"#define REFRACTION_FORCE_ALPHA_ONE":"",textures:n,out:{name:"%next"},collapsible:!0}),t.AR)return}if(t.useTaa){var i=[];t.useTaaTransparent&&i.push("#define TAA_TRANSPARENT"),i.push("#define FEEDBACK_MIN "+Object(u.a)().taaFeedbackMin),i.push("#define FEEDBACK_MAX "+Object(u.a)().taaFeedbackMax),io.a.vrConfig.doVR&&i.push("#define VR_ENABLED"),e.push({func:"supersampleTaa",textures:[{name:"%last",filter:"linear",rgbm:!1,srgb:!0},"%previous","TextureDepth"],header:i,out:{name:"%next",filter:"linear"}})}else e.push({func:"supersample",textures:[{name:"%last",filter:"linear",rgbm:!1,srgb:!0},"%previous"],out:{name:"%next",filter:"linear"}})},_addFinalPass:function(e,t){var n=[],i=[{name:"%last",filter:"linear",srgb:!0,rgbm:!1}];t.useDistortionVR&&n.push("#define VR_DISTORTION"),Object(u.a)().postProcessAscii&&n.push("#define ASCII_FOOL"),t.useFxaa?e.push({func:"fxaa",header:n,textures:i,out:{name:"%next"}}):e.push({func:"passThrough",header:n,textures:i,out:{name:"%next"}}),t.useSharpen&&(n=[],i=["%last"],t.hasBG&&(n.push("#define HAS_BACKGROUND"),i.push("TextureDepth")),e.push({func:"sharpen",header:n,textures:i,out:{name:"%next"},collapsible:!0})),t.useVignette&&e.push({func:"vignette",textures:[{name:"%last",filter:"nearest"}],out:{name:"%next"},collapsible:!0}),t.useGrain&&e.push({func:"grain",textures:"%last",out:{name:"%next"},collapsible:!0}),t.useDof&&e.push({func:"dofCross",textures:"%last",out:{name:"%next"},collapsible:!0}),t.webVR?e.push({func:"fadeVr",textures:"%last",out:{name:"%next"},collapsible:!0}):t.useExtra&&e.push({func:"composeExtra",textures:["%last","TextureExtra"],out:{name:"%next"},collapsible:!0}),t.hasBG||e.push({func:"finalPremultAlpha",textures:"%last",out:{name:"%next"},collapsible:!0})},_addFixedBackground:function(e,t,n){if("fixed"===t.bgType){var i=this.getNodeBackground().getBackground()||ji.a.dummyTexture;i.divisor=-1,n.addExternalTexture("TextureFixed",i);var r=["%last","TextureFixed","TextureDepth"],a=[];t.useRefraction&&(r.push("TextureRefraction"),a.push("#define REFRACTION_COMPOSITING_EXCLUSION")),e.push({func:"composeFixedBackground",header:a,textures:r,uniforms:[za.scale],out:{name:"%next"},collapsible:!0})}},_addFixedBackgroundRefraction:function(e,t,n){if(!t.useRefraction||"fixed"!==t.bgType)return"%last";var i=this.getNodeBackground().getBackground()||ji.a.dummyTexture;return i.divisor=-1,n.addExternalTexture("TextureFixed",i),e.push({func:{name:"composeFixedBackgroundRefraction",file:"composeFixedBackground.glsl"},textures:["%last","TextureFixed","TextureDepth"],uniforms:[za.scale],out:{name:"TextureWithBackground"}}),"TextureWithBackground"},_addPassThrough:function(e){e.push({func:"passThrough",textures:"%last",out:{name:"%next"}})},_createComposer:function(){var e=this._updateEffectiveConfig(),t=this._composer||new Ml.ComposerPostProcess;void 0===this._composer&&this._initComposer(t),t.clear();var n=[],i=e.useSsr&&Object(u.a)().depthMipmap||e.useSsao,r=e.useSsr||e.useRefraction,a=0;i&&this._packMipmapDepth(n),e.useSsao&&this._addSsao(n),e.useSss&&this._addSss(n,t),e.useTransparency&&this._addCombineOpacity(n),r&&(a=this._packMipmapColor(n,e,t)),e.useRefraction&&this._addRefraction(n,e,t),e.useDof&&this._addDof(n),e.useBloom&&this._addBloom(n,e),this._addMergeable(n,e),this._addFixedBackground(n,e,t),a>0&&n.length===a&&this._addPassThrough(n);var o=0===n.length;if(this._addSuperSample(n,e),this._addFinalPass(n,e),this._addInternalTextures(t,e,o),t.build(n),this._assignInternalTextureToCamera(),Oa.a.uOutputLinear.setInt(o?0:1),Oa.a.uRGBMRange.setFloat(o?-1:this._model.get("rgbmDefault")),this.onBackgroundColor(),e.useRefraction||e.useSsr){var s=this.getOrCreateStateSet(),l=t.getInternalTexture("TextureToBeRefracted");s.setTextureAttributeAndModes(5,l),s.addUniform(Tl.Uniform.createInt(5,"uTextureToBeRefracted")),l=Object(u.a)().depthMipmap?t.getInternalTexture("TextureMipmapDepth"):t.getInternalTexture("TextureDepth"),s.setTextureAttributeAndModes(4,l),s.addUniform(Tl.Uniform.createInt(4,"uTextureMipmapDepth"))}},_assignInternalTextureToCamera:function(){var e=this._composer,t=this._effectiveConfig,n=this._camera;n._textureOpaque=e.getInternalTexture("TextureOpaque"),t.useDepth&&(n._textureDepth=e.getInternalTexture("TextureDepth")),t.useTransparency&&(n._textureTransparent=e.getInternalTexture("TextureTransparent")),t.useRefraction&&(n._textureRefraction=e.getInternalTexture("TextureRefraction")),t.useExtra&&(n._textureExtra=e.getInternalTexture("TextureExtra"))},_resizeMipmapHeight:function(e,t,n){var i=e.getInternalTexture(t);if(i){var r=e._screenWidth,a=e._screenHeight,o=e._getTextureSize(r,i.divisor),s=e._getTextureSize(a,.5*i.divisor);i.setTextureSize(o,s);var u=e.getStateSetPass(n);if(u){u.getUniform("uTextureOutputSize").getInternalArray()[1]=s;for(var l=e.getCameras(),c=0;c<l.length;++c){var h=l[c];if(h.getName()===t)return void h.getViewport().setViewport(0,0,o,s)}}}},_hookComposerResize:function(e){var t=this,n=Ml.ComposerPostProcess.prototype;e.resizeRatio=function(i,r,a,o){n.resizeRatio.call(e,i,r,a,o),t._resizeMipmapHeight(e,"TextureToBeRefracted","packMipmapRefraction"),t._resizeMipmapHeight(e,"TextureMipmapDepth","packMipmapDepth")}},_initComposer:function(e){e.setScreenSize(this._viewerOSGJS.getCanvasWidth(),this._viewerOSGJS.getCanvasHeight()),e.setMethodWrapUV(1,1),this._hookComposerResize(e),this._viewer.bind("resizeCanvas",e.resize,e),this._viewer.bind("resizeRatio",e.resizeRatio,e),e.setNodeMask(_e.a.NO_PICK_NO_SHADOW),e.setName("PostProcess - Composer"),this.addChild(e),this._composer=e;var t=e.getOrCreateStateSet();for(var n in eu.a)t.addUniform(eu.a[n])},resetCameraAttachments:function(){var e=this._camera;e.resetAttachments(),e.fboOpaque&&(e.fboOpaque.reset(),e.fboOpaque=void 0),e.fboTransparent&&(e.fboTransparent.reset(),e.fboTransparent=void 0),e.fboRefraction&&(e.fboRefraction.reset(),e.fboRefraction=void 0),e.fboDepth&&(e.fboDepth.reset(),e.fboDepth=void 0),e.fboExtra&&(e.fboExtra.reset(),e.fboExtra=void 0),e.attachRenderBuffer(Tl.FrameBufferObject.DEPTH_ATTACHMENT,Tl.FrameBufferObject.DEPTH_COMPONENT16)},createPathStandard:function(){if(this._createComposer(),this.resetCameraAttachments(),Object(u.a)().stats){var e=this._composer.getCameras();e[e.length-1].setRenderOrder(Tl.Camera.POST_RENDER,0);var t,n=[];for(t=0;t<e.length;t++){var i=e[t].getName();-1===i.indexOf("FeedbackTexture")&&n.push(i)}this._viewer.setOptionStatsPostProcess(n);var r=Aa.a.getTimerGPU();for(t=0;t<e.length;++t){var a=e[t],o=a.getName();a.setInitialDrawCallback(r.start.bind(r,o)),a.setFinalDrawCallback(r.end.bind(r,o))}this._camera.setFinalDrawCallback(function(){r.start("PostProcess")});var s=this._viewerOSGJS.getCamera();s.setInitialDrawCallback(r.start.bind(r,"Total GL")),s.setFinalDrawCallback(function(){r.end("PostProcess"),r.end("Total GL")})}}}),"osgSketchfab","PostProcess");var Ol=Al,Rl=d.a.osg,Pl=d.a.osgUtil,Il=!1,Nl=!1,Ll=!1,kl=function(e){this._dirty=!0,this._view3d=e,this._effectiveConfig=e._effectiveConfig,this._viewer=e._viewer,this._viewerOSGJS=e._viewerOSGJS,this._model=e.model;var t=Object(u.a)().dofTransition;this._interpolatorDofFocusPoint=new Pl.DelayInterpolator(3,t?.15:1),this._interpolatorDofBlurNear=new Pl.DelayInterpolator(1,t?.15:1),this._interpolatorDofBlurFar=new Pl.DelayInterpolator(1,t?.15:1),this._interpolatorDofCross=new Pl.DelayInterpolator(1,t?.08:1),this._interpolatorDofCross._epsilon=-.01,this._dofInitialized=!1,this._dofAutoFocus=!1,this._currentEye=Rl.vec3.create(),this._lastEye=Rl.vec3.create(),this._currentRot=Rl.quat.create(),this._lastRot=Rl.quat.create(),this._dofLastPos=Rl.vec3.create(),this._dofLastFocal=0,this._firstFrame=!0,this._cullConfig=io.a.vrConfig,this._skipTaaFrames=0,this._lastUpdateTime=this._viewerOSGJS.getFrameStamp().getSimulationTime();var n=this.dirty.bind(this);Oi.bind("change:hasTransparency",n),Oi.bind("change:hasExtra",n),Oi.on("change:hasScattering",n),Oi.on("change:hasRefraction",n),k.a.getMaterial().then(function(){this.getBackgroundModel().bind("change:enable",n)}.bind(this)),this._hookViewerCheckNeedToDoFrame(),this._hookViewerFrame(),this._hookViewerComputeCanvasSize(),this._model.on("resetTaa",this.onResetTaa.bind(this)),Object(u.a)().dofCircle||(this.showDofCross=function(){})};Rl.createPrototypeObject(kl,{dirty:function(){this._dirty=!0,Ll=!0},onResetTaa:function(){this._skipTaaFrames=2},getMainCamera:function(){return this._view3d._camera},getNodeIn:function(){return this._view3d._nodeIn},getCurrentComposer:function(){return this._view3d._nodeIn._composer},getBackgroundModel:function(){return this._viewer.getFeatures().background.getModel()},updateTargetDofBlurNear:function(){this._interpolatorDofBlurNear.setTarget(this._model.get("dofBlurNear"))},updateTargetDofBlurFar:function(){this._interpolatorDofBlurFar.setTarget(this._model.get("dofBlurFar"))},getClampedProjectionMatrix:function(){var e=this.getMainCamera();return e.clampedProjectionMatrix||e.getProjectionMatrix()},onEffectChanged:function(){return V.a.draw(),this.getNodeIn().createPathStandard()},_toggleComposerCameras:function(e){this._viewer.getSuperSample().setSwitch(e);var t=e?-1:0;this.getMainCamera().setNodeMask(t);var n=this.getCurrentComposer(),i=n?n.getCameras():void 0;if(void 0!==i)for(var r=0;r<i.length-1;r++)i[r].setNodeMask(t)},_hookViewerCheckNeedToDoFrame:function(){var e=this._viewerOSGJS,t=e.checkNeedToDoFrame.bind(e),n=this;e.checkNeedToDoFrame=function(){this._requestContinousUpdate&&V.a.draw();var e=t(),i=Il;return Il=!1,e||!i?(n._toggleComposerCameras(!0),e):(n._toggleComposerCameras(!1),!0)}},_hookViewerFrame:function(){var e=this.getMainCamera(),t=this._viewerOSGJS,n=this._viewer.getSuperSample(),i=Object(u.a)().vrMirror,r=this,a=t.frame.bind(t);t.frame=function(t,o){a(t,o),V.a.setShadowForcedUpdate(!1),Nl&&(Nl=!1,r._skipTaaFrames=1,V.a.draw(),a(t,o),Ll=!0),Ll&&(Ll=!1,r._skipTaaFrames=1,V.a.draw(),a(t,o)),e.setNodeMask(-1),this._hmd&&this._hmd.isPresenting&&i&&(n.setSwitch(!1),e.setNodeMask(0),this.getCamera().getRenderer().draw())}},_hookViewerComputeCanvasSize:function(){this._resizeCanvasTimeout=-1,this._doResizeCanvas=!1,this._overrideCanvasWidth=-1,this._overrideCanvasHeight=-1,this._viewer.bind("resizeViewer",this._onResizeCanvas,this),this._viewer.bind("resizeViewerOnNextFrame",this._onForceResizeCanvas,this),this._cbEnableResizeCanvas=this._enableResizeCanvas.bind(this);var e=this._viewerOSGJS,t=this._viewer.getCanvas();this._originalCanvasResize=e.computeCanvasSize.bind(e,t),e.computeCanvasSize=this._computeCanvasSize.bind(e,t,this)},_onResizeCanvas:function(e,t){this._overrideCanvasWidth=e,this._overrideCanvasHeight=t,V.a.draw()},_onForceResizeCanvas:function(e,t){this._enableResizeCanvas(),this._onResizeCanvas(e,t)},_enableResizeCanvas:function(){this._doResizeCanvas=!0},_resetResizeCanvas:function(){this._doResizeCanvas=!1,window.clearTimeout(this._resizeCanvasTimeout)},_computeCanvasSize:function(){var e,t,n;return function(i,r){var a=r._overrideCanvasWidth,o=r._overrideCanvasHeight;if(a>0){var s=!1;return this._canvasWidth!==a&&(i.width=a,this._canvasWidth=a,s=!0),this._canvasHeight!==o&&(i.height=o,this._canvasHeight=o,s=!0),s}var l=r._viewer.getFeatures().inspector;if(!l)return!1;var c=l.getModel();if(r._doResizeCanvas)return c.set("viewerToCanvasRatio",1),r._resetResizeCanvas(),r._originalCanvasResize();window.ResizeObserver?e||((e=new window.ResizeObserver(function(){n=i.clientWidth,t=i.clientHeight})).observe(i),n=i.clientWidth,t=i.clientHeight):(n=i.clientWidth,t=i.clientHeight);var h=Math.max(1,Math.floor(n*this._devicePixelRatio))/Math.max(1,Math.floor(t*this._devicePixelRatio))/(this._canvasWidth/this._canvasHeight);if(h===c.get("viewerToCanvasRatio"))return!1;c.set("viewerToCanvasRatio",h),r._resetResizeCanvas();var d=Object(u.a)().resizeTimeout;return r._resizeCanvasTimeout=window.setTimeout(r._cbEnableResizeCanvas,d),!1}}(),showDofCross:function(){this._interpolatorDofCross.getCurrent()[0]=1,this._interpolatorDofCross.setTarget(0),Rl.vec3.copy(this._dofLastPos,this._model.get("dofFocusPoint")),this._dofLastFocal=this.computeFocalDistance(),V.a.draw()},hideDofCross:function(){this._interpolatorDofCross.getCurrent()[0]=0,V.a.draw()},computeFocalDistance:function(){var e=Rl.vec4.create();return function(){Rl.vec3.copy(e,this._interpolatorDofFocusPoint.getCurrent())[3]=1;var t=this._viewer.getCamera();Rl.vec4.transformMat4(e,e,t.getViewMatrix()),Rl.vec4.transformMat4(e,e,this.getClampedProjectionMatrix());var n=Oa.a.uNearFar.getInternalArray();return(e[3]-n[0])/(n[1]-n[0])}}(),_updateInterpolatorDofFocusPoint:function(){var e=this._model.get("dofFocusPoint");this._interpolatorDofFocusPoint.setTarget(e[0],e[1],e[2])},updateDofFocusPoint:function(){this._updateInterpolatorDofFocusPoint(),this.showDofCross(),this._dofAutoFocus=!1},updateGrain:function(e){if(this._effectiveConfig.useGrain&&this._model.get("grainAnimated")){Il=!0;var t=e.getSimulationTime(),n=Object(u.a)().grainSpeed/1e3;n>0&&t-this._lastUpdateTime>=n&&(eu.a.uTimeGrain.setFloat(t/1e3),this._lastUpdateTime=t)}},_callbackPicking:function(e,t,n,i){if(!(e<0)){if(e>=1){var r=this._viewer.getFeaturesManager().getViewport3d(),a=eu.a.uDofCross.getInternalArray();t=a[0]*r.width(),n=a[1]*r.height(),e=Ce.a.pickDepth(i,t,n)}if(e<1){var o=this._model.get("dofFocusPoint");Ce.a.getWorldPositionFromDepthXY(e,t,n,o),this._updateInterpolatorDofFocusPoint()}this.dofUpdateShowCross()}},dofPickFocusPoint:function(){var e=this._viewer.getFeaturesManager().getViewport3d(),t=this._callbackPicking.bind(this);Ce.a.getPixelDepth(.5*e.width(),.5*e.height(),t)},dofUpdateShowCross:function(e,t){if(this._dofAutoFocus)this._interpolatorDofCross.getCurrent()[0]=0;else{var n=Rl.vec3.dist(this._dofLastPos,this._model.get("dofFocusPoint")),i=this.computeFocalDistance();n>.1*e&&Math.abs(i-this._dofLastFocal)>.075&&t>.1&&this.showDofCross()}},dofUpdateInterpolators:function(e,t){this._interpolatorDofBlurNear.setTarget(this._model.get("dofBlurNear")*t),this._interpolatorDofBlurFar.setTarget(this._model.get("dofBlurFar")*t);var n=this._viewer.getFeaturesManager().getViewport3d(),i=eu.a.uDofCross.getInternalArray();Ce.a.getScreenPositionFromWorldPoint(this._model.get("dofFocusPoint"),i),i[0]/=n.width(),i[1]/=n.height();var r=e.getDeltaTime();this._interpolatorDofBlurNear.update(r),this._interpolatorDofBlurFar.update(r),this._interpolatorDofFocusPoint.update(r),this._interpolatorDofCross.update(r);var a=eu.a.uDofBlurNearFarFocal.getInternalArray();a[0]=this._interpolatorDofBlurNear.getCurrent()[0],a[1]=this._interpolatorDofBlurFar.getCurrent()[0],a[2]=this.computeFocalDistance(),eu.a.uDofCross.getInternalArray()[2]=this._interpolatorDofCross.getCurrent()[0],this._interpolatorDofCross.isDone()||(Il=!0)},_getAttenuationDof:function(e,t){var n=this._viewerOSGJS.getManipulator(),i=n.getHomeBoundingSphere(),r=t>=.01&&Object(u.a)().dofAttenuateSpeed?0:1,a=n.getHomeDistance(n.getHomeBoundingSphere());if(Object(u.a)().dofAttenuateDistance){var o=(Rl.vec3.dist(i.center(),this._currentEye)-e)/(a-e);r*=Math.max(0,Math.min(1,1-o))}return r},_getCameraMoveFactorSinceLastFocus:function(e){var t=this._viewerOSGJS.getManipulator().getInverseMatrix();Rl.mat4.getRotation(this._currentRot,t),Rl.quat.normalize(this._currentRot,this._currentRot);var n=Rl.quat.dot(this._lastRot,this._currentRot);n=Math.abs(1-n*n),this._viewerOSGJS.getManipulator().getEyePosition(this._currentEye);var i=Rl.vec3.dist(this._lastEye,this._currentEye);return Math.max(i/e,.1*n)},updateDof:function(e){if(this._model.isEffectiveDof()){var t=Oa.a.uNearFar.getInternalArray();if(!(t[0]>t[1])){this.updateDofScaleUniform();var n=this._viewerOSGJS.getManipulator().getHomeBoundingSphere().radius(),i=this._getCameraMoveFactorSinceLastFocus(n),r=this._getAttenuationDof(n,i),a=!0;!this._dofInitialized||Object(u.a)().dofSticky?(this._updateInterpolatorDofFocusPoint(),k.a.getFirstCameraAnimation().isFulfilled()&&(this._dofInitialized=!0)):this._dofAutoFocus||i>.01?(this._dofAutoFocus=i>1e-5,this.dofPickFocusPoint(),this.dofUpdateShowCross(n,r)):(this._updateInterpolatorDofFocusPoint(),a=!1),this.dofUpdateInterpolators(e,r),a&&(Rl.vec3.copy(this._lastEye,this._currentEye),Rl.quat.copy(this._lastRot,this._currentRot))}}},updateDofScaleUniform:function(){var e=this._viewer.getFeaturesManager().getViewport3d();eu.a.uDofScale.getInternalArray()[0]=.0015*e.height()/Object(u.a)().dofRes},updateDirtyEffect:function(){var e=this._viewerOSGJS.getCanvasWidth(),t=this._viewerOSGJS.getCanvasHeight();this._width&&this._height||(this._width=this._height=-1),this._dirty&&(this.onEffectChanged(),this._dirty=!1),e===this._width&&t===this._height||(this._viewer.trigger("resizeCanvas",e,t),this.getNodeIn().resetCameraAttachments(),this._width=e,this._height=t,Nl=!0,V.a.draw())},updateFade:function(e){var t=this._model.get("vrFading");if(this._model.get("vrStartFade")&&!t&&(this._model.set("vrStartFade",!1),t=!0,this._model.set("vrFading",!0),this._model.set("vrFadeStartTime",e.getSimulationTime())),t){var n=this._model.get("vrFadeStartTime"),i=this._model.get("vrFadeLength"),r=e.getSimulationTime(),a=(r-n)/i,o=this._model.get("vrFadeCallback");r>n+i&&(a=1-(a-1),o&&(o(),this._model.set("vrFadeCallback",void 0)));var s=eu.a.uVrFadeFactor.getInternalArray();a>=0?s[0]=a:(s[0]=0,this._model.set("vrFading",!1))}},updateVeil:function(){eu.a.uVrVeilFactor.getInternalArray()[0]=this._model.get("veilFactor")},_sssGaussian:function(e,t,n){var i=t/(.001+n);return Math.exp(-i*i/(2*e))/(2*Math.PI*e)},_sssProfile:function(e,t){return.1*this._sssGaussian(.0484,e,t)+.118*this._sssGaussian(.187,e,t)+.113*this._sssGaussian(.567,e,t)+.358*this._sssGaussian(1.99,e,t)+.078*this._sssGaussian(7.41,e,t)},_computeSSSKernel:function(e,t,n,i){var r=Object(u.a)().sssHalfKernel,a=2*r-1,o=0,s=e*r*4,l=s+0,c=s+1,h=s+2,d=s+3,f=this._model.getSSSWeightRange(),p=Math.pow(f,2),g=2*f/(a-1);for(o=0;o<r;o++){var m=f-o*g;t[4*o+d]=f*Math.pow(m,2)/p}for(o=0;o<r;o++){var v=t[4*o+d],_=o>0?Math.abs(v-t[4*(o-1)+d]):0,b=o<r-1?Math.abs(v-t[4*(o+1)+d]):b,S=(_+b)/2;t[4*o+l]=S*this._sssProfile(v,i[0]),t[4*o+c]=S*this._sssProfile(v,i[1]),t[4*o+h]=S*this._sssProfile(v,i[2])}for(var y=t[4*(o=r-1)+l],x=t[4*o+c],C=t[4*o+h],w=t[4*o+d];o>0;o--){var T=4*o,M=4*(o-1);t[T+l]=t[M+l],t[T+c]=t[M+c],t[T+h]=t[M+h],t[T+d]=t[M+d]}t[l]=y,t[c]=x,t[h]=C,t[d]=w;var E=t[l],A=t[c],O=t[h];for(o=1;o<r;o++)E+=2*t[4*o+l],A+=2*t[4*o+c],O+=2*t[4*o+h];for(o=0;o<r;o++)t[4*o+l]/=E,t[4*o+c]/=A,t[4*o+h]/=O;for(t[l]=1*(1-n[0])+n[0]*t[l],t[c]=1*(1-n[1])+n[1]*t[c],t[h]=1*(1-n[2])+n[2]*t[h],o=1;o<r;o++)t[4*o+l]*=n[0],t[4*o+c]*=n[1],t[4*o+h]*=n[2]},updateSSS:function(){eu.a.uProjFactor.getInternalArray()[0]=this.getClampedProjectionMatrix()[0];var e=X.a.getModelBoxWithoutDisplacement();if(e){var t=e.radius(),n=Oa.a.uScatteringFactorPacker.getInternalArray(),i=t*nn.a.getBoxFactor("SubsurfaceScattering");n[0]=1/i,Oa.a.uNormalizeFactorThickness.getInternalArray()[0]=.2*t*.25}if(!this._model.get("sssKernelDone")){this._model.set("sssKernelDone",!0);for(var r=this._model.get("sssProfiles"),a=r.length,o=Object(u.a)().sssHalfKernel,s=new Float32Array(4*a*o),l=0,c=r.length;l<c;l++){var h=r[l];this._computeSSSKernel(l,s,h.strength,h.falloff)}var d=this._view3d._sssTexKernel;if(d.setTextureSize(o,a),d.setMinFilter(Rl.Texture.LINEAR),d.setMagFilter(Rl.Texture.LINEAR),this._model.useSSSLookupFloat())return d.setImage(s,Rl.Texture.RGBA),void d.setInternalFormatType(Rl.Texture.FLOAT);var f=new Uint8Array(4*o*a),p=this._model.getSSSWeightRange();for(l=0;l<o*a;++l){var g=4*l;f[g]=Math.floor(255*s[g]),f[g+1]=Math.floor(255*s[g+1]),f[g+2]=Math.floor(255*s[g+2]),f[g+3]=Math.floor(s[g+3]/p*255)}d.setImage(f,Rl.Texture.RGBA),d.setInternalFormatType(Rl.Texture.UNSIGNED_BYTE)}},updateSsao:function(){if(this._model.isEffectiveSsao()){var e=Oa.a.uNearFar.getInternalArray();if(!(e[0]>e[1])){var t=this._viewer.getFeaturesManager().getViewport3d(),n=this.getClampedProjectionMatrix(),i=1===n[15]?1:2/n[5],r=-2*Math.tan(.5*i);eu.a.uSsaoProjectionScale.setFloat(t.height()/r);var a=eu.a.uSsaoProjectionInfo.getInternalArray();a[0]=-2/(t.width()*n[0]),a[1]=-2/(t.height()*n[5]),a[2]=(1-n[8])/n[0],a[3]=(1-n[9])/n[5]}}},updateViewSpaceCorners:function(){var e=[Rl.vec4.fromValues(-1,-1,0,1),Rl.vec4.fromValues(-1,1,0,1),Rl.vec4.fromValues(1,-1,0,1),Rl.vec4.fromValues(1,1,0,1)],t=Rl.mat4.create(),n=Rl.vec3.create();return function(i,r){Rl.mat4.invert(t,i);for(var a=0;a<4;a++)Rl.vec3.transformMat4(n,e[a],t),r[2*a]=n[0]/n[2],r[2*a+1]=n[1]/n[2]}}(),updateTaaMatrices:function(e,t,n){Rl.mat4.invert(n.invViewMatrix.getInternalArray(),e);var i=n.lastFrame.getInternalArray(),r=n.currentFrame.getInternalArray();Rl.mat4.copy(i,r),Rl.mat4.multiply(r,t,e),this._firstFrame&&Rl.mat4.copy(i,r),this.updateViewSpaceCorners(t,n.corners.getInternalArray())},updateTAA:function(){var e=Rl.mat4.create();return function(){var t=Oa.a.uNearFar.getInternalArray();if(t[0]>t[1]||!this._model.get("taaEnable"))eu.a.uTaaEnabled.setFloat(0);else{var n,i=this._viewer.getCamera().getViewMatrix(),r=this._cullConfig.doVR;r?(Rl.mat4.multiply(e,this._cullConfig.leftOffsetView,i),n=this._cullConfig.leftProjection):(e=i,n=this.getClampedProjectionMatrix());var a=eu.a;this.updateTaaMatrices(e,n,{invViewMatrix:a.uTaaInvViewMatrixLeft,lastFrame:a.uTaaLastFramePVLeft,currentFrame:a.uTaaCurrentFramePVLeft,corners:a.uTaaCornersCSLeft}),r&&(Rl.mat4.multiply(e,this._cullConfig.rightOffsetView,i),this.updateTaaMatrices(e,this._cullConfig.rightProjection,{invViewMatrix:a.uTaaInvViewMatrixRight,lastFrame:a.uTaaLastFramePVRight,currentFrame:a.uTaaCurrentFramePVRight,corners:a.uTaaCornersCSRight})),this._firstFrame&&(this._firstFrame=!1);var o=this._viewer.getFeatures().animation.getModel(),s=0===this._skipTaaFrames&&o.canActivateTAA();eu.a.uTaaEnabled.setFloat(s?1:0),this._skipTaaFrames>0&&--this._skipTaaFrames}}}(),updateNearFarRatio:function(){var e,t=this._viewer.getFeatures();if(this._model.get("webVR")){var n=X.a.getModelBoxWithDisplacement(),i=n?n.radius():1,r=t.webVR.getModel().get("worldFactor")/i;e=r>0?.005*Math.max(.1,r):.005}else e=t.camera.getModel().get("nearFarRatio");this.getMainCamera().setNearFarRatio(e)},updateGlobalTexUniforms:function(){var e=this._viewer.getFeaturesManager(),t=Oa.a.uGlobalTexSize.getInternalArray(),n=Oa.a.uGlobalTexRatio.getInternalArray(),i=Oa.a.uHalton.getInternalArray();Oa.a.uPreviousGlobalTexSize.setFloat2(t),Oa.a.uPreviousGlobalTexRatio.setFloat2(n),Oa.a.uPreviousHalton.setFloat4(i);var r=e.getViewport3d();t[0]=r.width(),t[1]=r.height();var a=this.getCurrentComposer();n[0]=a.getGlobalXRatio(),n[1]=a.getGlobalYRatio();var o=a.getInternalTexture("TextureToBeRefracted");if(o||this._model.isEffectiveSsr()){var s=Oa.a.uTextureToBeRefractedSize.getInternalArray();if(s[0]=o.getWidth(),s[1]=o.getHeight(),!this._model.get("taaEnable")){var u=this.getClampedProjectionMatrix(),l=eu.a.uTaaCornersCSLeft.getInternalArray();this.updateViewSpaceCorners(u,l)}}},_shadowJitterUpdate:function(e){if(rn.a.get("mask")&rn.a.LIT){var t=1+e;Oa.a.uStaticFrameNumShadow0.setFloat(t),Oa.a.uStaticFrameNumShadow1.setFloat(t),Oa.a.uStaticFrameNumShadow2.setFloat(t),Oa.a.uStaticFrameNumShadow3.setFloat(t)}},updateGlobalUniforms:function(e){this.updateNearFarRatio(),this.updateGlobalTexUniforms(),Oa.a.uTimeViewer.setFloat(e.getSimulationTime()/1e3);var t=X.a.getModelBoxWithDisplacement();Oa.a.uBoxRadius.setFloat(t?t.radius():1),Oa.a.uPixelRatio.setFloat2(xe.a.getPixelRatio());var n=this._viewer.getSuperSample(),i=(e.getFrameNumber()+n.getFrameNumber())%16;this._shadowJitterUpdate(i),Oa.a.uFrameMod.setFloat(i);var r=n.isEnabled()||eu.a.uTaaEnabled.getInternalArray()[0];Oa.a.uFrameModTaaSS.setFloat(r?i:0);var a=Oa.a.uReprojectViewProj.getInternalArray(),o=Oa.a.uPreviousProjection.getInternalArray(),s=Oa.a.uPreviousViewInvView.getInternalArray(),u=this._viewer.getCamera().getViewMatrix(),l=this._cullConfig.doVR?this._cullConfig.leftProjection:this.getClampedProjectionMatrix();this._tmpView?(Rl.mat4.invert(s,u),Rl.mat4.mul(s,this._tmpView,s),Rl.mat4.mul(a,this._tmpProjection,s),Rl.mat4.copy(o,this._tmpProjection),Rl.mat4.copy(this._tmpView,u),Rl.mat4.copy(this._tmpProjection,l)):(this._tmpView=Rl.mat4.clone(u),this._tmpProjection=Rl.mat4.clone(l),Rl.mat4.copy(a,l))},cull:function(e,t){if(t.traverse(e),!this._model.get("postProcessReady"))return!1;var n=t.getFrameStamp();return this.updateTAA(n),this.updateSSS(n),this.updateSsao(n),this.updateGrain(n),this.updateDof(n),this.updateFade(n),this.updateVeil(n),this.updateDirtyEffect(),this.updateGlobalUniforms(n),!1}});var Dl=kl,Fl=d.a.osg,Vl={FeatureName:"postProcess",ModelType:qs,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments);var e=this.model;e.bind("change:webVR",this.dirty,this),e.bind("change:distortVR",this.dirty,this),e.bind("change:enable",this.dirty,this),e.bind("change:grainEnable",this.checkGrainEnable,this),e.bind("change:sharpenEnable",this.checkSharpenEnable,this),e.bind("change:chromaticAberrationEnable",this.checkChromaticAberrationEnable,this),e.bind("change:vignetteEnable",this.checkVignetteEnable,this),e.bind("change:bloomEnable",this.checkBloomEnable,this),e.bind("change:dofEnable",this.checkDofEnable,this),e.bind("change:toneMappingEnable",this.dirty,this),e.bind("change:colorBalanceEnable",this.dirty,this),e.bind("change:ssaoEnable",this.checkSsaoEnable,this),e.bind("change:ssrEnable",this.checkSsrEnable,this),rn.a.bind("change:mask",this.checkSsrEnable,this),e.bind("change:taaEnable",this.checkTaaEnable,this),e.bind("change:taaTransparent",this.checkTaaTransparentEnable,this),e.bind("change:distortion",this.onDistortionChanged,this),e.bind("change:projectionLeft",this.onProjectionLeftChanged,this),e.bind("change:unprojectionLeft",this.onUnprojectionLeftChanged,this),e.bind("change:grainFactor",this.onGrainFactor,this),e.bind("change:sharpenFactor",this.onSharpenFactor,this),e.bind("change:chromaticAberrationFactor",this.onChromaticAberrationFactor,this),e.bind("change:vignetteAmount",this.onVignetteLensChanged,this),e.bind("change:vignetteHardness",this.onVignetteLensChanged,this),e.bind("change:bloomFactor",this.onBloomFactorChanged,this),e.bind("change:bloomThreshold",this.onBloomThresholdChanged,this),e.bind("change:bloomRadius",this.onBloomRadiusChanged,this),e.bind("change:toneMappingExposure",this.onToneMappingExposureChanged,this),e.bind("change:toneMappingBrightness",this.onToneMappingBrightnessChanged,this),e.bind("change:toneMappingContrast",this.onToneMappingContrastChanged,this),e.bind("change:toneMappingSaturation",this.onToneMappingSaturationChanged,this),e.bind("change:toneMappingMethod",this.onToneMappingMethodChanged,this),e.bind("change:colorBalanceLow",this.onColorBalanceShiftChanged,this),e.bind("change:colorBalanceMid",this.onColorBalanceShiftChanged,this),e.bind("change:colorBalanceHigh",this.onColorBalanceShiftChanged,this),e.bind("change:dofFocusPoint",this.onDofFocusPoint,this),e.bind("change:dofBlurNear",this.onDofBlurNear,this),e.bind("change:dofBlurFar",this.onDofBlurFar,this),e.bind("change:ssaoIntensity",this.onSsaoIntensity,this),e.bind("change:ssaoRadius",this.onSsaoRadius,this),e.bind("change:ssaoBias",this.onSsaoBias,this),e.bind("change:ssrFactor",this.onSsrFactor,this),e.bind("change",V.a.draw),this._effectiveConfig={},this._viewer=this.model._viewer,this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._sssTexKernel=new Fl.Texture,this._sssTexKernel.divisor=-1,this._camera=this._createMainCamera(),this._nodeIn=new Ol(this),this._nodeOut=this._createNodeOut(),this._nodeIn.addChild(this._camera),this._camera.addChild(this._nodeOut),this._callbackPostProcess=new Dl(this),this._nodeIn.setCullCallback(this._callbackPostProcess),this._initUniforms()},dirty:function(){this._callbackPostProcess.dirty()},_initUniforms:function(){var e=this.model.attributes;for(var t in e)this.model.trigger("change:"+t)},_createNodeOut:function(){var e=new Fl.Node;return e.setName("PostProcess - node Out"),io.a.nodePostProcessOut=e,e},_createMainCamera:function(){var e=new Fl.Camera,t=this._viewerOSGJS.getCanvasWidth(),n=this._viewerOSGJS.getCanvasHeight();return e.setViewport(new Fl.Viewport(0,0,t,n)),e.setName("PostProcess - MainCamera"),e.setRenderOrder(Fl.Camera.PRE_RENDER,0),e.attachRenderBuffer(Fl.FrameBufferObject.DEPTH_ATTACHMENT,Fl.FrameBufferObject.DEPTH_COMPONENT16),io.a.cameraMain=e,e},methodToInt:function(e){return"reinhard"===e?1:"filmic"===e?2:0},checkGrainEnable:function(){this._effectiveConfig.useGrain!==this.model.isEffectiveGrain()&&this.dirty()},checkSharpenEnable:function(){this._effectiveConfig.useSharpen!==this.model.isEffectiveSharpen()&&this.dirty()},checkChromaticAberrationEnable:function(){this._effectiveConfig.useChromaticAberration!==this.model.isEffectiveChromaticAberration()&&this.dirty()},checkVignetteEnable:function(){this._effectiveConfig.useVignette!==this.model.isEffectiveVignette()&&this.dirty()},checkBloomEnable:function(){this._effectiveConfig.useBloom!==this.model.isEffectiveBloom()&&this.dirty()},checkDofEnable:function(){this._effectiveConfig.useDof!==this.model.isEffectiveDof()&&this.dirty()},checkSsaoEnable:function(){this._effectiveConfig.useSsao!==this.model.isEffectiveSsao()&&this.dirty()},checkSsrEnable:function(){this._effectiveConfig.useSsr!==this.model.isEffectiveSsr()&&this.dirty()},checkTaaEnable:function(){this._effectiveConfig.useTaa!==this.model.get("taaEnable")&&this.dirty()},checkTaaTransparentEnable:function(){this._effectiveConfig.useTaaTransparent!==(this.model.get("taaEnable")&&this.model.get("taaTransparent"))&&this.dirty()},onDistortionChanged:function(){eu.a.uDistortion.setFloat2(this.model.get("distortion"))},onProjectionLeftChanged:function(){eu.a.uProjectionLeft.setFloat4(this.model.get("projectionLeft"))},onUnprojectionLeftChanged:function(){eu.a.uUnprojectionLeft.setFloat4(this.model.get("unprojectionLeft"))},onGrainFactor:function(){eu.a.uGrainFactor.setFloat(this.model.get("grainFactor")),this.checkGrainEnable()},onSharpenFactor:function(){eu.a.uSharpFactor.setFloat(this.model.get("sharpenFactor")),this.checkSharpenEnable()},onChromaticAberrationFactor:function(){eu.a.uChromaFactor.setFloat(this.model.get("chromaticAberrationFactor")),this.checkChromaticAberrationEnable()},onVignetteLensChanged:function(){var e=eu.a.uLensRadius.getInternalArray(),t=this.model.get("vignetteAmount"),n=this.model.get("vignetteHardness");e[0]=2-t-n,e[1]=n-t,this.checkVignetteEnable()},onBloomFactorChanged:function(){eu.a.uBloomFactor.setFloat(this.model.get("bloomFactor")),this.checkBloomEnable()},onBloomThresholdChanged:function(){eu.a.uBloomThreshold.setFloat(this.model.get("bloomThreshold")),this.checkBloomEnable()},onBloomRadiusChanged:function(){eu.a.uBloomRadius.setFloat(this.model.get("bloomRadius")),this.checkBloomEnable()},onColorBalanceShiftChanged:function(){eu.a.uColorBalanceLow.setFloat3(this.model.get("colorBalanceLow")),eu.a.uColorBalanceMid.setFloat3(this.model.get("colorBalanceMid")),eu.a.uColorBalanceHigh.setFloat3(this.model.get("colorBalanceHigh"))},onToneMappingExposureChanged:function(){eu.a.uToneExposure.setFloat(this.model.get("toneMappingExposure"))},onToneMappingBrightnessChanged:function(){eu.a.uToneBrightness.setFloat(this.model.get("toneMappingBrightness"))},onToneMappingContrastChanged:function(){eu.a.uToneContrast.setFloat(this.model.get("toneMappingContrast"))},onToneMappingSaturationChanged:function(){eu.a.uToneSaturation.setFloat(this.model.get("toneMappingSaturation"))},onToneMappingMethodChanged:function(){eu.a.uToneMethod.setInt(this.methodToInt(this.model.get("toneMappingMethod")))},onDofFocusPoint:function(){this._callbackPostProcess.updateDofFocusPoint()},onDofBlurNear:function(){this._callbackPostProcess.updateTargetDofBlurNear(),this.checkDofEnable()},onDofBlurFar:function(){this._callbackPostProcess.updateTargetDofBlurFar(),this.checkDofEnable()},hideDofCross:function(){this._callbackPostProcess.hideDofCross()},onSsaoRadius:function(){eu.a.uSsaoRadius.setFloat(this.model.get("ssaoRadius")),this.checkSsaoEnable()},onSsaoIntensity:function(){eu.a.uSsaoIntensity.setFloat(this.model.get("ssaoIntensity")),this.checkSsaoEnable()},onSsaoBias:function(){eu.a.uSsaoBias.setFloat(this.model.get("ssaoBias"))},onSsrFactor:function(){Oa.a.uSsrFactor.setFloat(this.model.get("ssrFactor")),this.checkSsrEnable()}})]},Bl=i.a.create(Vl);Bl.prototype.getNodeIn=function(){return this._views[0]._nodeIn},Bl.prototype.getNodeOut=function(){return this._views[0]._nodeOut},Bl.prototype.getCamera=function(){return this._views[0]._camera},Bl.prototype.getCurrentComposer=function(){return this._views[0]._nodeIn._composer},Bl.prototype.prepareForScreenShot=function(){Oa.a.uSSAARestart.setFloat(1),this._views[0].hideDofCross()},Bl.prototype.resetAfterScreenShot=function(){Oa.a.uSSAARestart.setFloat(0)};var Ul=Bl,jl=d.a.osg,Gl=Ni.a.Model.extend({defaults:{colorSelection:jl.vec3.fromValues(1,1,0),colorHover:jl.vec3.fromValues(1,.5,0),durationOutline:-1,durationHighlight:-1,outlineWidth:1},getName:function(){return"Outline"}}),Hl=n("1qke"),zl=n("+vFx"),Wl=d.a.osg,ql=d.a.osgUtil,Xl=Wl.StateAttribute.OVERRIDE_ON,Yl=function(e){Wl.Node.call(this),this._viewerWebGL=e,this._viewerOSGJS=e.getViewerOSGJS(),this._durationOutline=5e3,this._timerOutline=void 0,this._durationHighlight=5e3,this._timerHighlight=void 0,this._nodeProxy=new Wl.Node,this._outlineScene=new Wl.Node,this._paths=void 0,this._cbHideHighlight=this.hideHighlight.bind(this),this._cbHideOutline=this.hideOutline.bind(this);var t=we.a.DEPTH_DISABLE;this._stateSetSelection=new Wl.StateSet,this._uColorSelection=Wl.Uniform.createFloat3("uOutlineColor"),this._stateSetSelection.addUniform(this._uColorSelection),this._stateSetSelection.setAttributeAndModes(t,Xl),this._stateSetHover=new Wl.StateSet,this._uColorHover=Wl.Uniform.createFloat3("uOutlineColor"),this._stateSetHover.addUniform(this._uColorHover),this._stateSetHover.setAttributeAndModes(t,Xl),this._uOutlineFactor=Wl.Uniform.createFloat(.25,"uOutlineFactor"),this._uHighlightFactor=Wl.Uniform.createFloat(0,"uHighlightFactor"),this._uLineWidth=Wl.Uniform.createFloat(1,"uLineWidth"),this.init()};Wl.createPrototypeNode(Yl,Wl.objectInherit(Wl.Node.prototype,{getComposer:function(){return this._composer},setColorSelection:function(e){Wl.vec3.copy(this._uColorSelection.getInternalArray(),e)},setColorHover:function(e){Wl.vec3.copy(this._uColorHover.getInternalArray(),e)},setDurationHighlight:function(e){this._durationHighlight=e},setDurationOutline:function(e){this._durationOutline=e},setOutlineWidth:function(e){this._uLineWidth.getInternalArray()[0]=e},showOutline:function(){Oi.setOutline(!0),this._nodeProxy.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this._clearTimeoutOutline(),this._durationOutline>=0&&(this._timerOutline=setTimeout(this._cbHideOutline,this._durationOutline)),this._uHighlightFactor.setFloat(0!==this._durationHighlight?.15:0),this._clearTimeoutHighlight(),this._durationHighlight>=0&&this._durationHighlight<this._durationOutline&&(this._timerHighlight=setTimeout(this._cbHideHighlight,this._durationHighlight)),V.a.draw()},hideOutline:function(){this._nodeProxy.setNodeMask(0),this._clearTimeoutOutline(),this.hideHighlight(),V.a.draw()},hideHighlight:function(){this._uHighlightFactor.setFloat(0),this._clearTimeoutHighlight(),V.a.draw()},_clearTimeoutOutline:function(){void 0!==this._timerOutline&&(clearTimeout(this._timerOutline),this._timerOutline=void 0)},_clearTimeoutHighlight:function(){void 0!==this._timerHighlight&&(clearTimeout(this._timerHighlight),this._timerHighlight=void 0)},clearOutlineScene:function(){for(var e=this._outlineScene,t=e.getChildren(),n=0,i=t.length;n<i;++n){var r=t[n];r.getChildren()[0].removeChildren(),r.removeChildren()}e.removeChildren()},_getMaterialNode:function(e){var t=e.getStateSet();return t&&t.getAttribute("SketchfabMaterial")?t:void 0},_getLastMaterialPath:function(e,t){for(var n=t||0,i=e.length-1;i>=n;--i){var r=this._getMaterialNode(e[i]);if(r)return r}},addPaths:function(){var e=function(e){this._path=e};return Wl.createPrototypeObject(e,{update:function(t){return t.setMatrix(Wl.computeLocalToWorld(this._path)),e}}),function(t,n){for(var i=this._outlineScene,r=n?this._stateSetHover:this._stateSetSelection,a=0,o=t.length;a<o;++a){var s=t[a],u=new Wl.MatrixTransform,l=new Wl.Node;i.addChild(u),u.addChild(l);var c=s[s.length-1];l.addChild(c),u.setStateSet(r),this._getMaterialNode(c)||l.setStateSet(this._getLastMaterialPath(s)),Object(Hl.a)(s)?u.addUpdateCallback(new e(s)):u.setMatrix(Wl.computeLocalToWorld(s))}}}(),addPathsHover:function(e){this.addPaths(e,!0)},createSubSceneRtt:function(e){var t=new Wl.Camera;t.setName("Outline Camera"),t.setClearColor(Wl.vec4.create()),t.setRenderOrder(Wl.Camera.PRE_RENDER,0),t.attachTexture(Wl.FrameBufferObject.COLOR_ATTACHMENT0,e);var n=t.getOrCreateStateSet();return n.setShaderGeneratorName("outline",Xl),n.setAttribute(new zl.a),t},init:function(){var e=we.a.CULL_DISABLE;this._outlineScene.getOrCreateStateSet().setAttributeAndModes(e,Xl);var t=this._createComposer();this._composer=t;var n=t.getInternalTexture("TextureOutline"),i=this.createSubSceneRtt(n);this._cameraRtt=i,i.addChild(this._outlineScene),this._nodeProxy.addChild(i),this._nodeProxy.addChild(t),this.addChild(this._nodeProxy),this._nodeProxy.setNodeMask(0)},_createComposer:function(){var e=new ql.ComposerPostProcess,t=this._viewerOSGJS;e.setMethodWrapUV(1,1),e.setScreenSize(t.getCanvasWidth(),t.getCanvasHeight()),e.setFinalPassUpScaleToScreen(!1),e.addInternalTexture({name:"TextureOutline",immuable:!0,srgb:!0,rgbm:!1}),e.build({func:"outline",textures:["TextureOutline"],uniforms:[this._uOutlineFactor,this._uHighlightFactor,this._uLineWidth],out:{name:"%next"}});var n=e.getStateSetPass("outline"),i=we.a.BLEND_SUBSTRACTIVE;return n.setAttributeAndModes(i),n.setRenderBinDetails(Se.a.OUTLINE,"RenderBin"),this._viewerWebGL.bind("resizeCanvas",e.resize,e),this._viewerWebGL.bind("resizeRatio",e.resizeRatio,e),e}}),"osgSketchfab","Outline");var Kl=Yl,Ql=d.a.osg,Jl=d.a.osgAnimation,Zl=function(e){Ql.ComputeBoundsVisitor.call(this),this._paths=[],this.setStateSet(e)};Ql.createPrototypeObject(Zl,Ql.objectInherit(Ql.ComputeBoundsVisitor.prototype,{reset:function(){Ql.ComputeBoundsVisitor.prototype.reset.call(this),this._pushIfGeo=!1,this._paths.length=0,this._bonesBoxMatrix={},this._usedBones={}},setStateSet:function(e){this.reset(),this._stateSet=e},getBoundingBox:function(){var e=new Ql.BoundingBox;return function(){for(var t in this._usedBones){var n=this._bonesBoxMatrix[t];n&&(e.copy(n.box),e.transformMat4(e,n.matrix),this._bb.expandByBoundingBox(e))}return this._bb}}(),apply:function(e){var t=e.getStateSet(),n=this._pushIfGeo;if(t&&void 0!==t._materialID&&(this._pushIfGeo=t===this._stateSet),this._pushIfGeo&&e instanceof Ql.Geometry&&(this._paths.push(this.nodePath.slice(0)),e instanceof Jl.RigGeometry)){var i=e.getBoneNameID();for(var r in i)this._usedBones[r]=1}Ql.ComputeBoundsVisitor.prototype.apply.call(this,e),this._pushIfGeo=n},pushMatrix:function(e){var t=this.nodePath[this.nodePath.length-1];if(t instanceof Jl.Bone){var n=t.getBoneBoundingBox();n.valid()&&(this._bonesBoxMatrix[t.getName()]={matrix:Ql.mat4.clone(e),box:n})}Ql.ComputeBoundsVisitor.prototype.pushMatrix.call(this,e)},applyBoundingBox:function(e){this._pushIfGeo&&Ql.ComputeBoundsVisitor.prototype.applyBoundingBox.call(this,e)}}));var $l=Zl,ec=d.a.osg,tc={FeatureName:"outline",ModelType:Gl,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments),this._viewer=this.options.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS();var e=this.model;e.bind("change:colorSelection",this.onColorSelectionChanged,this),e.bind("change:colorHover",this.onColorHoverChanged,this),e.bind("change:outlineWidth",this.onOutlineWiddthChanged,this),e.bind("hideOutline",this.onHideOutline,this),e.bind("hideHighlight",this.onHideHighlight,this),e.bind("clearFocusTimeout",this.onClearFocusTimeout,this),this._nodeOutline=new Kl(this._viewer),this._nodeOutline.setName("Feature - Outline"),this.onColorSelectionChanged(),this.onColorHoverChanged(),this.onOutlineWiddthChanged(),this.model.bind("displayOutlineFocus",this._onMaterialChange.bind(this,!0)),this.model.bind("displayOutlineNoFocus",this._onMaterialChange.bind(this,!1))},getNodeOutline:function(){return this._nodeOutline},onColorSelectionChanged:function(){this._nodeOutline.setColorSelection(this.model.get("colorSelection"))},onColorHoverChanged:function(){this._nodeOutline.setColorHover(this.model.get("colorHover"))},onOutlineWiddthChanged:function(){this._nodeOutline.setOutlineWidth(this.model.get("outlineWidth"))},onHideOutline:function(){this._nodeOutline.hideOutline()},onHideHighlight:function(){this._nodeOutline.hideHighlight()},onClearFocusTimeout:function(){void 0!==this._timer&&(window.clearTimeout(this._timer),this._timer=void 0)},_focusOnBound:function(e){var t=this._viewer.getFeaturesManager(),n=e.getBoundingBox(),i=this._nodeOutline;this.onClearFocusTimeout(),this._timer=window.setTimeout(function(){t.focusOnBound(n,1)||t.focusOnHomePosition(1),i.showOutline()},200)},_onMaterialChange:function(){var e=new $l;return function(t,n,i){var r=this._viewer.getFeaturesManager();if(r){e.setStateSet(n||i),r.getWorldNode().accept(e);var a=e._paths;0!==a.length?(t&&this._focusOnBound(e),this._nodeOutline.clearOutlineScene(),n?(this._nodeOutline.addPaths(a),i&&(e.setStateSet(i),r.getWorldNode().accept(e),this._nodeOutline.addPathsHover(e._paths))):this._nodeOutline.addPathsHover(a),this._nodeOutline.setDurationOutline(1e3*this.model.get("durationOutline")),this._nodeOutline.setDurationHighlight(1e3*this.model.get("durationHighlight")),t||this._nodeOutline.showOutline()):ec.error("Cound not find nodes attached to the stateset.")}}}()})]},nc=i.a.create(tc);nc.prototype.getNode=function(){return this._views[0].getNodeOutline()},nc.prototype.prepareForScreenShot=function(){return this.getNode().hideOutline(),!1};var ic=nc,rc=function(e){this.coefficients=e};rc.prototype.distortInverse=function(e){for(var t=e/.9,n=.9*e,i=e-this.distort(t);Math.abs(n-t)>1e-4;){var r=e-this.distort(n),a=n-r*((n-t)/(r-i));t=n,n=a,i=r}return n},rc.prototype.distort=function(e){return e*this.distortionFactor_(e)},rc.prototype.distortionFactor_=function(e){for(var t=1,n=1,i=e*e,r=0;r<this.coefficients.length;r++){t+=this.coefficients[r]*(n*=i)}return t};var ac=rc,oc=d.a.osg,sc={base64:function(e,t){return"data:"+e+";base64,"+t},isMobile:function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},isFirefox:function(){return/firefox/i.test(navigator.userAgent)},isIOS:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},isIFrame:function(){try{return window.self!==window.top}catch(e){return!0}},appendQueryParameter:function(e,t,n){return e+=(e.indexOf("?")<0?"?":"&")+t+"="+n},getQueryParameter:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},isLandscapeMode:function(){return 90===window.orientation||-90===window.orientation},getScreenWidth:function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},getScreenHeight:function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},projectionMatrixToVector_:function(e,t){var n=t||{},i=n.xScale||1,r=n.yScale||1,a=n.xTrans||0,o=n.yTrans||0,s=oc.vec4.create();return s[0]=e[0]*i*.5,s[1]=e[5]*r*.5,s[2]=.5*(e[8]-1-a),s[3]=.5*(e[9]-1-o),s},leftProjectionVectorToRight_:function(e){return oc.vec4.fromValues(e[0],e[1],-e[2]-1,e[3])}},uc=sc,lc=d.a.osg,cc=180/Math.PI,hc=Math.PI/180,dc=function(e){this.id=e.id,this.label=e.label,this.fov=e.fov,this.interLensDistance=e.interLensDistance,this.baselineLensDistance=e.baselineLensDistance,this.screenLensDistance=e.screenLensDistance,this.distortionCoefficients=e.distortionCoefficients,this.inverseCoefficients=e.inverseCoefficients},fc=function(e){this.width=e.width||uc.getScreenWidth(),this.height=e.height||uc.getScreenHeight(),this.widthMeters=e.widthMeters,this.heightMeters=e.heightMeters,this.bevelMeters=e.bevelMeters},pc=new fc({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),gc=new fc({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),mc={CardboardV1:new dc({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new dc({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function vc(e){this.viewer=mc.CardboardV1,this.updateDeviceParams(e)}vc.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device},vc.prototype.getDevice=function(){return this.device},vc.prototype.setViewer=function(e){this.viewer=e},vc.prototype.determineDevice_=function(e){if(!e)return uc.isIOS()?gc:pc;var t=.0254/e.xdpi,n=.0254/e.ydpi,i=uc.getScreenWidth(),r=uc.getScreenHeight();return new fc({widthMeters:t*i,heightMeters:n*r,bevelMeters:.001*e.bevelMm})},vc.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer,t=this.device,n=new ac(e.distortionCoefficients),i=e.screenLensDistance,r=(t.widthMeters-e.interLensDistance)/2,a=e.interLensDistance/2,o=e.baselineLensDistance-t.bevelMeters,s=t.heightMeters-o,u=cc*Math.atan(n.distort(r/i)),l=cc*Math.atan(n.distort(a/i)),c=cc*Math.atan(n.distort(o/i)),h=cc*Math.atan(n.distort(s/i));return{leftDegrees:Math.min(u,e.fov),rightDegrees:Math.min(l,e.fov),downDegrees:Math.min(c,e.fov),upDegrees:Math.min(h,e.fov)}},vc.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},vc.prototype.getFieldOfViewRightEye=function(e){var t=this.getFieldOfViewLeftEye(e);return{leftDegrees:t.rightDegrees,rightDegrees:t.leftDegrees,upDegrees:t.upDegrees,downDegrees:t.downDegrees}},vc.prototype.getProjectionMatrixLeftEye=function(e){var t=this.getFieldOfViewLeftEye(e),n=lc.mat4.create(),i=.1*Math.tan(hc*t.leftDegrees),r=.1*Math.tan(hc*t.rightDegrees),a=.1*Math.tan(hc*t.downDegrees),o=.1*Math.tan(hc*t.upDegrees);return lc.mat4.frustum(n,-i,r,-a,o,.1,1e3),n},vc.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_(),t=this.viewer,n=this.device,i=t.screenLensDistance,r=n.widthMeters/i,a=n.heightMeters/i,o=n.width/r,s=n.height/a,u=Math.round((e.eyePosX-e.outerDist)*o),l=Math.round((e.eyePosY-e.bottomDist)*s);return{x:u,y:l,width:Math.round((e.eyePosX+e.innerDist)*o)-u,height:Math.round((e.eyePosY+e.topDist)*s)-l}},vc.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:cc*Math.atan(e.outerDist),rightDegrees:cc*Math.atan(e.innerDist),downDegrees:cc*Math.atan(e.bottomDist),upDegrees:cc*Math.atan(e.topDist)}},vc.prototype.getUndistortedParams_=function(){var e=this.viewer,t=this.device,n=new ac(e.distortionCoefficients),i=e.screenLensDistance,r=e.interLensDistance/2/i,a=t.widthMeters/i,o=t.heightMeters/i,s=a/2-r,u=(e.baselineLensDistance-t.bevelMeters)/i,l=e.fov,c=n.distortInverse(Math.tan(hc*l)),h=Math.min(s,c),d=Math.min(r,c),f=Math.min(u,c);return{outerDist:h,innerDist:d,topDist:Math.min(o-u,c),bottomDist:f,eyePosX:s,eyePosY:u}},vc.Viewers=mc;var _c=vc,bc={format:1,last_updated:"2019-02-19T20:27:12Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3}]},Sc=function(e){this.xdpi=e.xdpi,this.ydpi=e.ydpi,this.bevelMm=e.bevelMm},yc=function(e){0},xc=function(e){0},Cc=function(e){0},wc=function(e,t){if(this.dpdb=bc,this.recalculateDeviceParams_(),e){this.onDeviceParamsUpdated=t,yc();var n=new XMLHttpRequest,i=this;n.open("GET","https://dpdb.webvr.rocks/dpdb.json",!0),n.addEventListener("load",function(){i.loading=!1,n.status>=200&&n.status<=299?(yc(),i.dpdb=JSON.parse(n.response),i.recalculateDeviceParams_()):xc()}),n.send()}};wc.prototype.getDeviceParams=function(){return this.deviceParams},wc.prototype.recalculateDeviceParams_=function(){yc();var e=this.calcDeviceParams_();yc(),yc(),e?(this.deviceParams=e,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):xc()},wc.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e)return xc(),null;if(1!==e.format)return xc(),null;if(!e.devices||!e.devices.length)return xc(),null;var t=navigator.userAgent||navigator.vendor||window.opera,n=uc.getScreenWidth(),i=uc.getScreenHeight();if(yc(),yc(),yc(),!e.devices)return xc(),null;for(var r=0;r<e.devices.length;r++){var a=e.devices[r];if(a.rules)if("ios"===a.type||"android"===a.type){if(uc.isIOS()===("ios"===a.type)){for(var o=!1,s=0;s<a.rules.length;s++){var u=a.rules[s];if(this.matchRule_(u,t,n,i)){yc(),yc(),o=!0;break}}if(o){var l=a.dpi[0]||a.dpi,c=a.dpi[1]||a.dpi;return new Sc({xdpi:l,ydpi:c,bevelMm:a.bw})}}}else Cc();else Cc()}return Cc(),null},wc.prototype.matchRule_=function(e,t,n,i){if(!e.ua&&!e.res)return!1;if(e.ua&&t.indexOf(e.ua)<0)return!1;if(e.res){if(!e.res[0]||!e.res[1])return!1;var r=e.res[0],a=e.res[1];if(Math.min(n,i)!==Math.min(r,a)||Math.max(n,i)!==Math.max(r,a))return!1}return!0};var Tc=wc,Mc=d.a.osg;Object(u.a)().vrForceRaf&&(d.a.osgViewer.Viewer.prototype.setVRDisplay=function(e){this._hmd=e,this._requestAnimationFrame=e.requestAnimationFrame.bind(e)});var Ec=a.a.extend({getModelOptionPath:function(){return"vr"},defaults:{enable:!1,deviceInfo:void 0,hit:void 0,hasNativeHMD:!1,humanMatrix:Mc.mat4.create(),humanInAir:!1,displayFloor:!0},init:function(e){if(this._context=e,this._scene=e.getScene(),this._viewer=e.getViewer(),window.matchMedia&&window.matchMedia("(environment-blending: additive)").matches){var t=this._context.getFeatures().background.getModel();t.set("color",[0,0,0]),t.set("enable","color"),this.set("displayFloor",!1)}},initAfterFirstFrame:function(){this.set("deviceInfo",this._initDeviceInfo());var e=this._context.getModel().get("options").vr;e&&e.worldFactor>0&&this.setJSON(e),this.initBoundAndWorldFactor(),this.set("enable",Object(u.a)().cardboard>0)},onVrDisplayReady:function(e){k.a.getVrDisplayReady().isFulfilled()?e():k.a.getVrDisplayReady().then(function(){e()})},_getBoundRadius:function(){return X.a.getModelBoxWithDisplacement().radius()},isDiorama:function(){return this._getBoundRadius()<2*this.get("worldFactor")},getMinimumWorldFactor:function(){return.001*this._getBoundRadius()},getMaximumWorldFactor:function(){return 10*this._getBoundRadius()},getDefaultHumanHeight:function(){return 1.65},_makeValidWorldFactor:function(){var e=this.get("worldFactor"),t=this.getMinimumWorldFactor(),n=this.getMaximumWorldFactor();if(e<t*X.a.BIAS_MIN||e>n*X.a.BIAS_MAX){var i=X.a.getModelBoxWithDisplacement(),r=i.getMin()[2],a=i.radius();this.set("worldFactor",.5*a),this.set("floorHeight",r);var o=i.center(Mc.vec3.create());o[1]-=1.2*a,o[2]=r,Mc.mat4.fromTranslation(this.get("humanMatrix"),o)}else this.set("worldFactor",Math.min(Math.max(e,t),n))},initBoundAndWorldFactor:function(){this._makeValidWorldFactor(),this.trigger("uiReady")},_initDeviceInfo:function(){var e=new Tc(!1),t=new _c(e.getDeviceParams());return Object(u.a)().cardboard>1&&t.setViewer(_c.Viewers.CardboardV2),t},getName:function(){return"WebVR"},setJSON:function(e,t){var n=t||{};n.ignore=["initialCamera"];var i=a.a.prototype.setJSON.call(this,e,n),r=this.get("humanMatrix"),o=e.initialCamera;return Mc.mat4.fromQuat(r,o.rotation),Mc.mat4.setTranslation(r,o.position),i},getJSON:function(){var e=Mc.mat4.copy(Mc.mat4.create(),this.get("humanMatrix")),t=Mc.mat4.getScale(Mc.vec3.create(),e);Mc.vec3.set(t,1/t[0],1/t[1],1/t[2]);var n=Mc.mat4.scale(e,e,t),i=Mc.quat.create();Mc.quat.normalize(i,Mc.mat4.getRotation(i,n));var r=a.a.prototype.getJSON.call(this,{ignore:"initialCamera"});return r.initialCamera={position:Mc.mat4.getTranslation(Mc.vec3.create(),n),rotation:i},r}}),Ac=n("AwiE"),Oc=n("MdnG"),Rc=n.n(Oc),Pc=n("IOM8"),Ic=n.n(Pc),Nc=n("Onwk"),Lc=n.n(Nc),kc=n("FYHc"),Dc=n.n(kc),Fc=d.a.osg,Vc=d.a.osgUtil,Bc=Fc.vec3.fromValues(.1,.4,.8),Uc=Fc.vec3.fromValues(1,.7,.1),jc=Fc.vec3.fromValues(1,0,0),Gc=Fc.vec3.fromValues(0,0,.9),Hc=function(e){Fc.MatrixTransform.call(this),this._model=e,this.setMatrix(e.get("humanMatrix")),this.setName("WebVR - Human"),this.setNodeMask(0),this.editMask=Vc.NodeGizmo.NO_FULL_CIRCLE|Vc.NodeGizmo.PICK_PLANE_Z|Vc.NodeGizmo.PICK_ARROW|Vc.NodeGizmo.PICK_ARC_Z,this._humanMT=new Fc.MatrixTransform,Fc.mat4.fromZRotation(this._humanMT.getMatrix(),Math.PI),this._geoHuman=new Fc.Geometry,this._humanMT.addChild(this._geoHuman),this._uColorCylinder=Fc.Uniform.createFloat3(Fc.vec3.copy(Fc.vec3.create(),Bc),"uColor"),this._uColorHint=Fc.Uniform.createFloat3(Fc.vec3.copy(Fc.vec3.create(),Uc),"uColor"),this._hintToFloorMT=new Fc.MatrixTransform,this._geoHintToFloor=Fc.createTexturedBoxGeometry(0,0,-.5,.02,.02,1),this._hintToFloorMT.addChild(this._geoHintToFloor),this._hintToFloorMT.setNodeMask(_e.a.NO_PICK),this._geoCylinder=Vc.GizmoGeometry.createCylinderGeometry(1,1,1,50,1,!1,!1),this._geoCylinder.setNodeMask(_e.a.NO_PICK);for(var t=0,n=this._geoCylinder.getAttributes().Vertex.getElements(),i=n.length/3;t<i;++t)n[3*t+2]+=.5;this._cylinderMT=new Fc.MatrixTransform,Fc.mat4.fromScaling(this._cylinderMT.getMatrix(),Fc.vec3.fromValues(1,1,.5)),this._cylinderMT.addChild(this._geoCylinder),this.addChild(this._humanMT),this.addChild(this._cylinderMT),this.addChild(this._hintToFloorMT),this._boundingBoxComputed=!0,this._boundingSphereComputed=!0,this.init()};Fc.createPrototypeNode(Hc,Fc.objectInherit(Fc.MatrixTransform.prototype,{init:function(){this.getOrCreateStateSet().setAttributeAndModes(we.a.CULL_BACK);var e=this._humanMT.getOrCreateStateSet();e.setShaderGeneratorName("shadeless-pbr"),e.setName("vrHuman");var t=ur.createMaterialModel(e);t.set("name","NodeHuman"),t.set("hasVertexColor",!0),t.set("vertexColorEnable",!0),t.set("vertexColorColorSpace","linear"),t.trigger("apply"),e.setAttributeAndModes(e.getAttribute("SketchfabMaterial")),Object(o.a)()&&Vo(this.initHumanMesh.bind(this));var n=this._geoHintToFloor.getOrCreateStateSet();n.setAttributeAndModes(be.a.getOrCreateShader(Lc.a,Dc.a,"webVR-hintToFloor","VRHintToFloor")),n.addUniform(this._uColorHint),n.setRenderBinDetails(Se.a.TRANSPARENT_NO_EARLYZ_POST,"RenderBin");var i=this._geoCylinder.getOrCreateStateSet();i.setAttributeAndModes(be.a.getOrCreateShader(Rc.a,Ic.a,"webVR-humanCylinder","VRHumanCylinder")),i.addUniform(this._uColorCylinder),i.addUniform(Fc.Uniform.createFloat(1,"uAlpha")),i.setRenderBinDetails(Se.a.TRANSPARENT_NO_EARLYZ_POST,"RenderBin")},initHumanMesh:function(e){var t=this._geoHuman;t.getAttributes().Vertex=new Fc.BufferArray(Fc.BufferArray.ARRAY_BUFFER,e.VERTEX,3),t.getAttributes().Color=new Fc.BufferArray(Fc.BufferArray.ARRAY_BUFFER,e.COLOR,4),t.getPrimitives().push(new Fc.DrawElements(Fc.primitiveSet.TRIANGLES,new Fc.BufferArray(Fc.BufferArray.ELEMENT_ARRAY_BUFFER,e.TRIANGLES,1))),t.getPrimitives().push(new Fc.DrawElements(Fc.primitiveSet.TRIANGLE_STRIP,new Fc.BufferArray(Fc.BufferArray.ELEMENT_ARRAY_BUFFER,e.STRIP,1)))},setVisible:function(e){if(this._visible!==e){this._visible=e,this.setNodeMask(e?-1:0);var t=this._model._viewer.getFeaturesManager().getNodeGizmo();e?(t.attachToNode(this),this._initView()):this._restoreView()}},_initView:function(){var e=Fc.vec3.create(),t=Fc.vec3.create(),n=Fc.vec3.create(),i=Fc.quat.create(),r=Fc.vec3.create(),a=Fc.vec3.create(),o=Fc.vec3.fromValues(0,0,-1);return function(){var s=this._model._viewer.getFeaturesManager(),u=this._model.get("worldFactor"),l=this._model._viewer.getViewerOSGJS().getManipulator();this._eyePos||(this._eyePos=Fc.vec3.create(),this._eyeTarget=Fc.vec3.create()),l.getEyePosition(this._eyePos),l.getTarget(this._eyeTarget),Fc.mat4.getTranslation(e,this.getMatrix()),Fc.mat4.getRotation(i,this.getMatrix()),Fc.vec3.set(t,0,1,0),Fc.vec3.transformQuat(t,t,i),Fc.vec3.copy(r,Gc),Fc.vec3.scale(r,r,u),Fc.vec3.add(e,e,r),Fc.vec3.scale(r,t,-1),Fc.vec3.normalize(r,r),Fc.vec3.cross(a,r,o),Fc.vec3.copy(n,e),Fc.vec3.scale(r,r,3*u),Fc.vec3.scale(a,a,.5*u),Fc.vec3.add(r,r,a),Fc.vec3.add(n,n,r),s.focusOnTargetAndEye(e,n,1)}}(),_restoreView:function(){this._eyePos&&this._model._viewer.getFeaturesManager().focusOnTargetAndEye(this._eyeTarget,this._eyePos)},computeDistanceToFloor:function(){var e=Fc.vec3.create(),t=Fc.vec3.create();return function(){var n=this.getMatrix(),i=this._model,r=i.get("worldFactor"),a=i.get("floorHeight");Fc.mat4.getTranslation(e,n),Fc.vec3.copy(t,e);var o=.1*r;e[2]+=o,t[2]-=100*r,this.setNodeMask(_e.a.NO_PICK);var s=Ce.a.computeNearestIntersection3D(e,t,_e.a.PICK_GEOMETRY_SLOW);if(this.setNodeMask(-1),s)o=Fc.vec3.dist(Ce.a.getWorldPositionFromHit(s,t),e);else{if(!i.get("displayFloor"))return 0;o=e[2]-a}return Math.max(0,o-.1*r)}}(),updateNodeVR:function(){var e=Fc.vec3.create();return function(t,n){if(0!==this.getNodeMask()){var i=this.getMatrix(),r=this._model,a=r._viewer.getFeaturesManager(),o=r.get("worldFactor"),s=r.get("floorHeight");Fc.vec3.lerp(this._uColorHint.getInternalArray(),Uc,jc,.5*Math.sin(10*n)+.5),Fc.mat4.getScale(e,i),Fc.vec3.set(e,o/e[0],o/e[1],o/e[2]),Fc.mat4.scale(i,i,e),r.get("displayFloor")&&(i[14]=Math.max(i[14],s));var u=a.getNodeGizmo().getAttachedNode()===this||t&&-1!==t._nodePath.indexOf(this._humanMT);Fc.vec3.copy(this._uColorCylinder.getInternalArray(),u?Uc:Bc);var l=this.computeDistanceToFloor()/o,c=l>.05;Fc.mat4.fromScaling(this._hintToFloorMT.getMatrix(),Fc.vec3.set(e,1,1,c?l:1e-7)),this._model.set("humanInAir",c),this.dirtyBound()}}}()}),"osgSketchfab","Human");var zc=Hc,Wc=n("uCEv"),qc=n.n(Wc),Xc=n("pJ/q"),Yc=n.n(Xc),Kc=d.a.osg,Qc=d.a.osgUtil,Jc=function(){Kc.Node.call(this),this.setName("WebVR - Teleport"),this.setVisible(!0),this._interpolatorNormal=new Qc.DelayInterpolator(3),this._interpolatorNormal.setDelay(.08),this._geoCircle1=Kc.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),this._geoCircle2=Kc.createTexturedQuadGeometry(-.5,-.5,.15,1,0,0,0,1,0),this._geoCircle3=Kc.createTexturedQuadGeometry(-.5,-.5,.15,1,0,0,0,1,0),this._uAlpha1=Kc.Uniform.createFloat(1,"uAlpha"),this._uAlpha2=Kc.Uniform.createFloat(1,"uAlpha"),this._uAlpha3=Kc.Uniform.createFloat(1,"uAlpha"),this._uScale1=Kc.Uniform.createFloat(1,"uScale"),this._uScale2=Kc.Uniform.createFloat(.99,"uScale"),this._uScale3=Kc.Uniform.createFloat(.99,"uScale"),this._geoCylinder=Qc.GizmoGeometry.createCylinderGeometry(1,1,1,50,1,!1,!1);for(var e=0,t=this._geoCylinder.getAttributes().Vertex.getElements(),n=t.length/3;e<n;++e)t[3*e+2]+=.5;this._cylinderMT=new Kc.MatrixTransform,Kc.mat4.fromScaling(this._cylinderMT.getMatrix(),Kc.vec3.fromValues(.38,.38,.125)),this._cylinderMT.addChild(this._geoCylinder),this._hotspotHintMT=new Kc.MatrixTransform,this._hotspotHintMT.addChild(this._geoCylinder),this._hotspotHintMT.setNodeMask(0),this._teleportMT=new Kc.MatrixTransform,this._teleportMT.addChild(this._geoCircle1),this._teleportMT.addChild(this._geoCircle2),this._teleportMT.addChild(this._geoCircle3),this._teleportMT.addChild(this._cylinderMT),this.addChild(this._teleportMT),this.addChild(this._hotspotHintMT),this.init()};Kc.createPrototypeNode(Jc,Kc.objectInherit(Kc.Node.prototype,{init:function(){var e=this.getOrCreateStateSet();e.setAttributeAndModes(be.a.getOrCreateShader(qc.a,Yc.a,"webVR-teleportCircle","VRTeleportCircle")),e.addUniform(Kc.Uniform.createInt(0,"uTextureTeleportCircle")),e.setTextureAttributeAndModes(0,ji.a.dummyTexture),this._geoCircle1.getOrCreateStateSet().addUniform(this._uScale1),this._geoCircle2.getOrCreateStateSet().addUniform(this._uScale2),this._geoCircle3.getOrCreateStateSet().addUniform(this._uScale3),this._geoCircle1.getOrCreateStateSet().addUniform(this._uAlpha1),this._geoCircle2.getOrCreateStateSet().addUniform(this._uAlpha2),this._geoCircle3.getOrCreateStateSet().addUniform(this._uAlpha3);var t=this._cylinderMT.getOrCreateStateSet();t.addUniform(Kc.Uniform.createFloat3(Kc.vec3.fromValues(.7,.7,.3),"uColor")),t.addUniform(this._uAlpha1);var n=this._hotspotHintMT.getOrCreateStateSet();n.addUniform(Kc.Uniform.createFloat3(Kc.vec3.fromValues(.1,.66,.85),"uColor")),n.addUniform(this._uAlpha1),this._geoCylinder.getOrCreateStateSet().setAttributeAndModes(be.a.getOrCreateShader(Rc.a,Ic.a,"webVR-teleportCylinder","VRTeleportCylinder"))},initTextureTeleport:function(){Io(this.replaceTextureTeleport.bind(this))},replaceTextureTeleport:function(e){this.getOrCreateStateSet().setTextureAttributeAndModes(0,s.default.instance.getOrCreateTexture(e.TELEPORT_CIRCLE,{internalFormat:Kc.Texture.RGBA}).texture)},setVisible:function(e){this.setNodeMask(e?_e.a.NO_PICK:0)},setHotspotHint:function(){var e=Kc.vec3.create(),t=Kc.vec3.fromValues(0,0,1),n=Kc.quat.create();return function(i,r,a,o){if(this._hotspotHintMT.setNodeMask(i?-1:0),r){Kc.vec3.sub(e,a,r);var s=Kc.vec3.len(e);Kc.vec3.normalize(e,e),Kc.quat.rotationTo(n,t,e);var u=this._hotspotHintMT.getMatrix();Kc.mat4.fromQuat(u,n);Kc.mat4.scale(u,u,Kc.vec3.set(e,.02*o,.02*o,s)),Kc.mat4.setTranslation(u,r)}}}(),updateWorldNormal:function(e,t){this._interpolatorNormal.setTarget(t[0],t[1],t[2]),this._interpolatorNormal.update(e.getDeltaTime()),Kc.vec3.normalize(t,this._interpolatorNormal.getCurrent())},updateNodeVR:function(){var e=Kc.vec3.fromValues(0,0,1),t=Kc.vec3.create();return function(n,i,r,a,o,s,u){var l=this._teleportMT.getMatrix();if(this.getNodeMask()){var c=Math.acos(Kc.vec3.dot(e,u));Kc.vec3.cross(t,u,e),Kc.mat4.fromRotation(l,-c,t);var h=Math.min(Math.max(o,s),50*s);Kc.mat4.scale(l,l,Kc.vec3.set(t,h,h,h)),Kc.vec3.set(t,a[0],a[1],a[2]+.05*o),Kc.mat4.setTranslation(l,t),this.setNodeMask(_e.a.NO_PICK)}var d=r.getSimulationTime(),f=d%.99,p=(d+.2)%.99;this._uScale2.setFloat(f),this._uScale3.setFloat(p),this._uAlpha1.setFloat(n),this._uAlpha2.setFloat(n*(1-f*f)),this._uAlpha3.setFloat(n*(1-p*p)),this._teleportMT.dirtyBound()}}()}),"osgSketchfab","Teleport");var Zc=Jc,$c=n("xgxp"),eh=n.n($c),th=n("60rR"),nh=n.n(th),ih=d.a.osg,rh=function(){ih.MatrixTransform.call(this),this.setName("WebVR - Cursor"),this.setVisible(!0),this._geom=ih.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),this._uAlpha=ih.Uniform.createFloat(1,"uAlpha"),this._uColor=ih.Uniform.createFloat3(ih.vec3.fromValues(.7,.7,.7),"uCursorColor"),this.addChild(this._geom),this.init()};ih.createPrototypeNode(rh,ih.objectInherit(ih.MatrixTransform.prototype,{init:function(){var e=ih.StateAttribute.OVERRIDE_ON,t=this.getOrCreateStateSet();t.setAttributeAndModes(be.a.getOrCreateShader(eh.a,nh.a,"webVR-cursor","VRCursor"),e),t.setRenderBinDetails(Se.a.VR_CURSOR,"RenderBin"),t.setAttributeAndModes(we.a.BLEND_SUBSTRACTIVE),t.addUniform(this._uColor),t.addUniform(this._uAlpha)},setVisible:function(e){this.setNodeMask(e?_e.a.NO_PICK:0)},setColor:function(e){ih.vec3.copy(this._uColor.getInternalArray(),e)},updateNodeVR:function(){var e=ih.vec3.create(),t=ih.quat.create();return function(n,i,r,a){var o=this.getMatrix();ih.mat4.invert(o,i.getViewMatrix()),ih.mat4.fromQuat(o,ih.mat4.getRotation(t,o)),ih.mat4.scale(o,o,ih.vec3.set(e,a,a,a)),ih.mat4.setTranslation(o,r),this._uAlpha.setFloat(n),this.dirtyBound()}}()}),"osgSketchfab","Cursor");var ah=rh,oh=n("o0dJ"),sh=n.n(oh),uh=n("uymv"),lh=n.n(uh),ch=d.a.osg,hh=function(e){ch.MatrixTransform.call(this),this._model=e,this._postMultRotate=e._viewer.getViewerOSGJS().getManipulator().getFirstPersonManipulator().getPostMultRotate(),this.setName("WebVR - Floor"),this.setNodeMask(-1),this._cam=new ch.Camera,this._cam.setNearFarRatio(5e-5),this._geom=ch.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),this._uScaleToMeter=ch.Uniform.createFloat(1,"uScaleToMeter"),this._cam.addChild(this._geom),this.addChild(this._cam),this.init()};ch.createPrototypeNode(hh,ch.objectInherit(ch.MatrixTransform.prototype,{init:function(){var e=this.getOrCreateStateSet(),t=(this._model.get("displayFloor")?"#define DISPLAY_FLOOR\n":"")+lh.a;e.setAttributeAndModes(be.a.getOrCreateShader(sh.a,t,"webVR-floor","VRFloor")),e.addUniform(ch.Uniform.createInt(0,"uTextureFloor")),e.setTextureAttributeAndModes(0,ji.a.dummyTexture),e.addUniform(this._uScaleToMeter),e.addUniform(ch.Uniform.createInt(1,"uTextureDepth")),e.setTextureAttributeAndModes(1,ji.a.dummyTexture),e.setRenderBinDetails(Se.a.TRANSPARENT_NO_EARLYZ_PRE,"RenderBin"),e.setAttributeAndModes(we.a.DEPTH_DISABLE),e.setAttributeAndModes(we.a.CULL_BACK),Object(o.a)()&&this.initTextureFloor()},initTextureFloor:function(){Io(this.replaceTextureFloor.bind(this))},replaceTextureFloor:function(e){this.getOrCreateStateSet().setTextureAttributeAndModes(0,s.default.instance.getOrCreateTexture(e.FLOOR,{internalFormat:ch.Texture.RGBA}).texture)},setVisible:function(e){if(this.setNodeMask(e?-1:0),e&&!this._depthInitialized){var t=this._model._viewer.getFeaturesManager().getTextureDepth();t&&(this.getOrCreateStateSet().setTextureAttributeAndModes(1,t),this._depthInitialized=!0)}},updateNodeVR:function(){var e=ch.vec3.create(),t=ch.vec3.create();return function(){var n=this.getMatrix(),i=X.a.getModelBoxWithDisplacement();i.center(t);var r=i.radius(),a=Math.max(15*this._model.get("worldFactor"),5*r);ch.mat4.fromQuat(n,this._postMultRotate),ch.mat4.scale(n,n,ch.vec3.set(e,a,a,a)),n[12]=t[0],n[13]=t[1],this._uScaleToMeter.setFloat(a/this._model.get("worldFactor")),n[14]=this._model.get("floorHeight")-1e-4*r,this.dirtyBound()}}()}),"osgSketchfab","Floor");var dh=hh,fh=n("ND70"),ph=n.n(fh),gh=n("Ma4s"),mh=n.n(gh),vh=d.a.osg,_h=d.a.InputGroups,bh=vh.vec3.create(),Sh={TELEPORT:0,MENU:1,NAME:"DEFAULT"},yh={SCALE_THRESHOLD:.3,TELEPORT:0,MENU:1,SCALE_DIR_AXIS:0,NAME:"VIVE"},xh={SCALE_THRESHOLD:.7,TELEPORT:0,MENU:1,SCALE_DIR_AXIS:2,NAME:"Oculus touch"},Ch={SCALE_THRESHOLD:.3,TELEPORT:0,MENU:2,SCALE_DIR_AXIS:0,NAME:"Oculus go"},wh={SCALE_THRESHOLD:.3,TELEPORT:0,MENU:2,SCALE_DIR_AXIS:0,NAME:"Oculus remote"},Th={SCALE_THRESHOLD:.3,TELEPORT:0,MENU:1,SCALE_DIR_AXIS:2,NAME:"Windows mixed reality"},Mh={SCALE_THRESHOLD:.3,TELEPORT:0,MENU:1,SCALE_DIR_AXIS:0,NAME:"Magic leap"},Eh=vh.vec3.fromValues(.8481,.8481,.8481),Ah=vh.vec3.fromValues(.00237,.30699,.57048),Oh=function(e,t){vh.MatrixTransform.call(this),this.setName("VR - Controller"),this.setNodeMask(_e.a.NO_PICK),this._pointerMT=new vh.MatrixTransform,this._pointerMTScale=new vh.MatrixTransform,this._proxyControllerMT=new vh.MatrixTransform,this._geomPointer=vh.createTexturedQuadGeometry(-.5,0,0,1,0,0,0,1,0),this.addChild(this._proxyControllerMT),this.addChild(this._pointerMT),this._pointerMT.addChild(this._pointerMTScale),this._pointerMTScale.addChild(this._geomPointer);var n=new vh.createTexturedBoxGeometry(0,-.1,0,.1,.2,.1);this._proxyControllerMT.addChild(n),this._uNormalSign=vh.Uniform.createFloat(1,"uNormalSign"),this._activeController=void 0,this._model=e,this._viewerOSGJS=e._viewer.getViewerOSGJS(),this._postMultRotate=e._viewer.getViewerOSGJS().getManipulator().getFirstPersonManipulator().getPostMultRotate(),this._uPointerAlpha=vh.Uniform.createFloat1(1,"uAlpha"),this._hitScaleOffset=20,this._inputManager=t,this._controllerMeshDisplay=void 0,this._pressedButtons=[],this._gamepadType=void 0,this._pointerClicked=!1,this._timeSinceLastPointerClick=0,this._menuPressed=!1,this._clickPressed=!1,this._teleportPressed=!1,this._menuPressedFrame=!1,this._clickPressedFrame=!1,this._teleportPressedFrame=!1,this._scaleValueChange=0,this._cbClick=this.onClick.bind(this),this._canvasX=0,this._canvasY=0,this._preferLeftHand=!1,this.init()};vh.createPrototypeNode(Oh,vh.objectInherit(vh.MatrixTransform.prototype,{init:function(){var e=this._proxyControllerMT.getOrCreateStateSet();e.addUniform(vh.Uniform.createFloat3(Eh,"uAlbedo")),e.addUniform(this._uNormalSign),e.addUniform(vh.Uniform.createFloat(.4,"uRoughness")),e.addUniform(vh.Uniform.createFloat(0,"uMetalness")),e.setShaderGeneratorName("controller"),ur.createMaterialModel(e).trigger("apply");var t=this._geomPointer.getOrCreateStateSet();t.addUniform(this._uPointerAlpha),t.setRenderBinDetails(Se.a.VR_CURSOR,"RenderBin"),t.setAttributeAndModes(we.a.BLEND_SUBSTRACTIVE),t.setAttributeAndModes(be.a.getOrCreateShader(ph.a,mh.a,"webVR-laser","VRLaser")),Te.a.initWebVRNavigation(this),this._ctrlLeft=.32,this._ctrlFwrd=.55},setEventListeners:function(){this._model.get("hasNativeHMD")?window.addEventListener("click",this._cbClick):this._inputManager.setEnable(_h.WEBVR_NAVIGATION,!0)},removeEventListeners:function(){this._model.get("hasNativeHMD")?window.addEventListener("click",this._cbClick):this._inputManager.setEnable(_h.WEBVR_NAVIGATION,!1)},onClick:function(){this._teleportPressed=!0,this._clickPressed=!0},setListenToEvents:function(e){e?this.setEventListeners():this.removeEventListeners()},isPosedController:function(){var e=this._activeController;return!(!e||!e.targetRayMode||"tracked-pointer"!==e.targetRayMode)},_createGeometryFromJSON:function(e){var t=new vh.Geometry,n=t.getAttributes();n.Vertex=new vh.BufferArray(vh.BufferArray.ARRAY_BUFFER,e.VERTEX,3),n.Normal=new vh.BufferArray(vh.BufferArray.ARRAY_BUFFER,e.NORMAL,3),e.COLOR&&(n.Color=new vh.BufferArray(vh.BufferArray.ARRAY_BUFFER,e.COLOR,1));var i=t.getPrimitives(),r=new vh.BufferArray(vh.BufferArray.ELEMENT_ARRAY_BUFFER,e.TRIANGLES,1);i.push(new vh.DrawElements(vh.primitiveSet.TRIANGLES,r));var a=new vh.BufferArray(vh.BufferArray.ELEMENT_ARRAY_BUFFER,e.STRIP,1);return i.push(new vh.DrawElements(vh.primitiveSet.TRIANGLE_STRIP,a)),t},replaceControllerMesh:function(e){this._proxyControllerMT.removeChildren();var t=this._createGeometryFromJSON(e.BODY),n=this._createGeometryFromJSON(e.BUTTON);this._proxyControllerMT.addChild(t),this._proxyControllerMT.addChild(n),n.getOrCreateStateSet().addUniform(vh.Uniform.createFloat3(Ah,"uAlbedo")),this._updateCorrectionMatrix()},_checkControllerHand:function(e){this._activeController&&"left"===this._activeController.handedness?(vh.mat4.scale(e,e,vh.vec3.set(bh,-1,1,1)),this._uNormalSign.setFloat(-1)):this._uNormalSign.setFloat(1)},_updateCorrectionMatrix:function(){var e=this._proxyControllerMT.getMatrix();if(this._gamepadType===xh)vh.mat4.fromTranslation(e,vh.vec3.set(bh,0,.03262643,.031930979)),vh.mat4.rotateX(e,e,.22*Math.PI),this._checkControllerHand(e);else if(this._gamepadType===Th){var t=Object(u.a)().forceControllerOrientation;vh.mat4.fromXRotation(e,Math.PI*t),t=Object(u.a)().forceControllerRayOrientation,vh.mat4.rotateX(this._pointerMT.getMatrix(),this._pointerMT.getMatrix(),Math.PI*t),this._checkControllerHand(e)}else this._gamepadType===Mh?(vh.mat4.identity(e),vh.mat4.scale(e,e,[.01,.01,.01]),this._checkControllerHand(e)):vh.mat4.identity(e)},onPointerDown:function(){vr.a.any&&!this._activeController&&(this._pointerClicked=!0)},onPointerUp:function(e){this._pointerClicked=!1,vr.a.any||Math.abs(e.canvasX-this._canvasX)<5&&Math.abs(e.canvasY-this._canvasY)<5&&(this._clickPressed=!0,this._teleportPressed=!0)},displayMenu:function(){this._menuPressed=!0},onMouseDown:function(e){vr.a.any&&!this._activeController&&this._model.get("hasNativeHMD")&&(this._teleportPressed=!0),vr.a.any||(this._canvasX=e.canvasX,this._canvasY=e.canvasY)},updateButtonsPressed:function(){if(this._activeController)for(var e=this._pressedButtons.length,t=0;t<e;++t){var n=this._activeController.gamepad.buttons[t].pressed;n!==this._pressedButtons[t]&&(this._pressedButtons[t]=n,n?this.onButtonDown(t):this.onButtonUp(t))}},updateHoverAxes:function(){this._activeController&&(this._scaleValueChange=0,this.updateScaleChangeFromXAxis(this._gamepadType))},updateScaleChangeFromXAxis:function(e){if(this._activeController.gamepad){var t=this._activeController.gamepad.axes[e.SCALE_DIR_AXIS];t>e.SCALE_THRESHOLD?this._scaleValueChange=1:t<-e.SCALE_THRESHOLD&&(this._scaleValueChange=-1)}},updatePointerClick:function(e){if(this._pointerClicked){if(this._timeSinceLastPointerClick>1.2)return this._menuPressed=!0,this._pointerClicked=!1,void(this._timeSinceLastPointerClick=0);this._timeSinceLastPointerClick+=e}else this._timeSinceLastPointerClick>0&&this._timeSinceLastPointerClick<1.2&&(vr.a.any&&(this._clickPressed=!0,this._teleportPressed=!0),this._timeSinceLastPointerClick=0)},onButtonUp:function(e){switch(e){case this._gamepadType.TELEPORT:this._clickPressed=!0,this._teleportPressed=!0;break;case this._gamepadType.MENU:this._menuPressed=!0}},onButtonDown:function(e){},getAndSetActiveController:function(e){if(e.length){var t=this._activeController;if(this._activeController=this._getControllerWithPressedButtons(e),this._activeController||(this._isLastActiveControllerStillWorking(e,t)?this._activeController=t:this._activeController=this._getControllerWithOrientationAndPreferredHand(e)),!this._activeController)return this._pressedButtons.length=0,void(this._gamepadType=void 0);var n=this._activeController.profiles.length&&this._activeController.profiles[0];if(n!==this._lastProfile){this._lastProfile=n;for(var i=this._pressedButtons.length=this._activeController.gamepad&&this._activeController.gamepad.buttons.length,r=0;r<i;++r)this._pressedButtons[r]=!1;this._gamepadType=this._getGamepadType(this._activeController),console.log("Found a controller:",this._gamepadType.NAME),this._updateCorrectionMatrix()}}},_isLastActiveControllerStillWorking:function(e,t){if(!t)return!1;for(var n=0;n<e.profiles;n++)if(e[n].profiles.length==t.profiles.length&&e[n].profiles[0]==t.profiles[0])return!0;return!1},_getControllerWithPressedButtons:function(e){for(var t=0,n=e.length;t<n;++t){var i=e[t];if(i.gamepad)for(var r=i.gamepad.buttons.length,a=0;a<r;++a)if(i.gamepad.buttons[a].pressed)return i}},setPreferLeftHand:function(e){this._preferLeftHand!==e&&(this._preferLeftHand=e,this.getAndSetActiveController(),this._updateCorrectionMatrix())},_getControllerWithOrientationAndPreferredHand:function(e){for(var t,n=this._preferLeftHand?"left":"right",i=0,r=e.length;i<r;++i){var a=e[i];if(a){var o="tracked-pointer"===a.targetRayMode;if(o&&a.handedness===n)return a;!o&&t||(t=a)}}return t},_getGamepadType:function(e){for(var t=0;t<e.profiles.length;t++){var n=e.profiles[t];if(-1!==n.indexOf("oculus")){if(-1!==n.indexOf("touch")||-1!==n.indexOf("rift"))return xh;if(-1!==n.indexOf("go"))return Ch}if(-1!==n.indexOf("windows-mixed-reality"))return Th;if(-1!==n.indexOf("vive"))return yh;if(-1!==n.indexOf("magicleap-one"))return Mh;if(n.indexOf("generic-trigger-squeeze-touchpad"))return yh;if(n.indexOf("generic-trigger-squeeze-thumbstick"))return xh;if(n.indexOf("generic-trigger-squeeze-touchpad-thumbstick"))return xh;if(n.indexOf("generic-trigger-touchpad-thumbstick"))return xh;if(n.indexOf("generic-trigger-squeeze"))return xh;if(n.indexOf("generic-trigger-thumbstick"))return xh;if(n.indexOf("generic-trigger-touchpad"))return Ch;if(n.indexOf("generic-trigger"))return Ch;if(n.indexOf("generic-touchpad"))return Ch;if(n.indexOf("generic-button"))return wh}return Sh},applyPoseMatrix:function(){var e=vh.quat.create(),t=vh.vec3.create(),n=vh.mat4.create();return function(i,r){var a=this._viewerOSGJS.getXRPose(this._activeController.targetRaySpace);if(a){var o=a.transform,s=o.orientation;s&&(s=vh.quat.set(e,s.x,-s.z,s.y,s.w),vh.quat.multiply(s,this._postMultRotate,s),vh.mat4.multiply(i,i,vh.mat4.fromQuat(n,s)));var u=this._model.get("worldFactor"),l=o.position;l&&(l=vh.vec3.set(t,l.x*u,-l.z*u,l.y*u),vh.vec3.transformQuat(l,l,this._postMultRotate),vh.vec3.add(l,l,r),vh.mat4.setTranslation(i,l))}}}(),updatePointerScaleFromHit:function(e){var t=vh.mat4.getTranslation(vh.vec3.create(),this.getMatrix()),n=vh.vec3.dist(t,e);this._hitScaleOffset=n/this._model.get("worldFactor")},resetPointerScale:function(){this._hitScaleOffset=20},isMenuPressed:function(){return this._menuPressedFrame},isTeleportPressed:function(){return this._teleportPressedFrame},isClickPressed:function(){return this._clickPressedFrame},checkScaleChangeValue:function(){return this._scaleValueChange},checkDownloadController:function(){var e=Object(u.a)().forceController,t=this._gamepadType;if(e){switch(e){case"oculus":t=xh;break;case"go":t=Ch;break;case"windows":t=Th;break;case"magicleap":t=Mh;break;default:t=yh}this._gamepadType=t}else if(!this.isPosedController())return;t===xh?this._controllerMeshDisplay!==xh&&(this._controllerMeshDisplay=xh,Lo(this.replaceControllerMesh.bind(this))):t===Ch?this._controllerMeshDisplay!==Ch&&(this._controllerMeshDisplay=Ch,ko(this.replaceControllerMesh.bind(this))):t===Th?this._controllerMeshDisplay!==Th&&(this._controllerMeshDisplay=Th,Do(this.replaceControllerMesh.bind(this))):t===Mh?this._controllerMeshDisplay!==Mh&&(this._controllerMeshDisplay=Mh,Fo(this.replaceControllerMesh.bind(this))):this._controllerMeshDisplay!==yh&&(this._controllerMeshDisplay=yh,No(this.replaceControllerMesh.bind(this)))},updateNodeVR:function(){var e=vh.vec3.create();return function(t,n,i){var r=this._model.get("worldFactor");this.getAndSetActiveController(t),this.checkDownloadController(),this.updatePointerClick(n),this.updateButtonsPressed(),this.updateHoverAxes();var a=this.getMatrix();vh.mat4.fromScaling(this._pointerMTScale.getMatrix(),vh.vec3.set(e,.05,this._hitScaleOffset,1)),vh.mat4.fromScaling(a,vh.vec3.set(e,r,r,r)),Object(u.a)().forceController?(this.setNodeMask(_e.a.NO_PICK),vh.mat4.copy(a,this._model.get("humanMatrix")),a[14]+=2*r):this.isPosedController()?(this.setNodeMask(_e.a.NO_PICK),this.applyPoseMatrix(a,i)):this.setNodeMask(0),this._menuPressedFrame=this._menuPressed,this._clickPressedFrame=this._clickPressed,this._teleportPressedFrame=this._teleportPressed,this._clickPressed=!1,this._menuPressed=!1,this._teleportPressed=!1,this.dirtyBound()}}(),raycastFromController:function(){var e=vh.vec3.fromValues(0,20,0),t=vh.mat4.create();return function(n,i,r,a,o){var s=this.getMatrix();if(this._gamepadType===Th){var l=2*Object(u.a)().forceControllerRayOrientation;s=t,vh.mat4.rotateX(s,this.getMatrix(),Math.PI*l)}vh.mat4.getTranslation(a,s),vh.vec3.set(o,0,r/this._model.get("worldFactor"),0),vh.vec3.transformMat4(o,o,s);var c=Ce.a.computeNearestIntersection3DHotspotFirst(a,o,_e.a.PICK_GEOMETRY_FAST,n);return c||vh.vec3.transformMat4(o,e,s),c}}()}),"osgSketchfab","Controller");var Rh=Oh,Ph=d.a.osg,Ih=function(e,t,n,i,r){this._startPosOffset=e,this._startPos=Ph.vec3.create(),this._targetPos=Ph.vec3.create(),this._duration=t,this._easingFunc=n,this._result=Ph.vec3.create(),this._hasStarted=!1,this._reverse=!1,this._finished=!0,this._node=i,this._model=r};Ih.prototype={isFinished:function(){return this._finished},_reverseAnim:function(){this._reverse=!this._reverse},start:function(){var e=Ph.vec3.create();return function(t){this._started=.05*-t,this._hasStarted=!1,this._finished=!1,Ph.vec3.scale(e,this._startPosOffset,this._model.get("worldFactor")),this._reverse?(Ph.mat4.getTranslation(this._startPos,this._node.getMatrix()),Ph.vec3.add(this._targetPos,this._startPos,e),this._node.setOpacity(1)):(Ph.mat4.getTranslation(this._targetPos,this._node.getMatrix()),Ph.vec3.add(this._startPos,this._targetPos,e),this._node.setOpacity(0)),Ph.mat4.setTranslation(this._node.getMatrix(),this._startPos)}}(),update:function(e,t){if(!this._finished){var n=t.getFrameStamp().getSimulationTime();if(this._started<0)return this._started+=t.getFrameStamp().getDeltaTime(),!0;this._hasStarted||(this._started=n,this._hasStarted=!0);var i=(n-this._started)/this._duration;return i>1&&(this._finished=!0,i=1),this._easingFunc&&(i=this._easingFunc(i)),this.interpolate(i,e),this._finished&&(this._reverseAnim(),this._onFinishCallback&&this._onFinishCallback(),this._node.dirtyBound()),!0}},interpolate:function(e,t){Ph.vec3.lerp(this._result,this._startPos,this._targetPos,e),Ph.mat4.setTranslation(t.getMatrix(),this._result),this._reverse?this._node.setOpacity(1-e):this._node.setOpacity(e)},setOnFinishCallback:function(e){this._onFinishCallback=e}};var Nh=Ih,Lh=(n("0fc8"),d.a.osgAnimation),kh=d.a.osg,Dh=Lh.easeOutCubic,Fh=function(e){kh.Node.call(this),this._menuPanel=new us(.9,2.5,Qo.AXIS_BOTH,.2,10,10),this._menuPanel.setUseCache(!0),this._menuPanel.setClickAction("vrHelpButton",this.displayHelp.bind(this)),this._menuPanel.setClickAction("vrExitButton",this.hide.bind(this)),this._menuPanel.setVisible(!1);var t=new Nh(kh.vec3.fromValues(0,0,-.05),.15,Dh,this._menuPanel,e);this._menuPanel.setAnimation(t),this.addChild(this._menuPanel),this._helpPanel=new Qo(2,2,Qo.AXIS_BOTH,.2,10,10),this._helpPanel.setPanelClickAction(this.hideHelp.bind(this)),this._helpPanel.setVisible(!1);var n=new Nh(kh.vec3.fromValues(0,0,0),.3,Dh,this._helpPanel,e);this._helpPanel.setAnimation(n),this.addChild(this._helpPanel),this._model=e};kh.createPrototypeNode(Fh,kh.objectInherit(kh.Node.prototype,{initialize:function(e){var t=e.hotspot._views[0]._hotspots;this._menuPanel.initialize("skfb_front/macros/vr/vr-menu",{hasHotspotsNavigation:t.length&&t.length>1}),Io(function(e){var t=s.default.instance.getOrCreateTexture(e.MENU_HELP,{internalFormat:kh.Texture.RGBA}).texture;this._helpPanel.initialize(t,{width:1e3,height:500})}.bind(this))},display:function(e,t){this._menuPanel.displayInView(e,t,this._model.get("worldFactor"))},hide:function(){this._menuPanel.setVisible(!1),this._helpPanel.isVisible()&&this._helpPanel.setVisible(!1)},setHomeAction:function(e){this._menuPanel.setClickAction("vrHomeButton",e)},setNextAction:function(e){this._menuPanel.setClickAction("vrNextButton",e)},setPrevAction:function(e){this._menuPanel.setClickAction("vrPrevButton",e)},displayHelp:function(){kh.mat4.copy(this._helpPanel.getMatrix(),kh.mat4.create()),kh.mat4.setTranslation(this._helpPanel.getMatrix(),kh.vec3.fromValues(0,0,.2)),kh.mat4.multiply(this._helpPanel.getMatrix(),this._menuPanel.getMatrix(),this._helpPanel.getMatrix()),this._helpPanel.setVisible(!0)},hideHelp:function(){this._helpPanel.isVisible()&&this._helpPanel.setVisible(!1)},isVisible:function(){return this._menuPanel.isVisible()},isHelpVisible:function(){return this._helpPanel.isVisible()},updateHit:function(e){return this._helpPanel.isVisible()?this._helpPanel.updateHit(e):this._menuPanel.isVisible()?this._menuPanel.updateHit(e):void 0},click:function(){this._helpPanel.isVisible()?this._helpPanel.click():this._menuPanel.isVisible()&&this._menuPanel.click()}}),"osgSketchfab","Menu");var Vh=Fh,Bh=n("jiW3"),Uh=d.a.osg,jh=d.a.osgUtil,Gh=d.a.InputGroups,Hh=(new Zo.a({device:"VWR",listen:!0}),{FeatureName:"webVR",ModelType:Ec,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments);var e=this.model;e.bind("change:enable",this.onEnable,this),e.bind("change:worldFactor",this.onWorldFactor,this),e.bind("change:floorHeight",this.onFloorHeight,this),e.bind("doubleTap",this.onDoubleTap,this),e.bind("snapHumanOnFloor",this.snapHumanOnFloor,this),this._viewer=this.options.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._manipulator=this._viewerOSGJS.getManipulator(),this._cullConfig=io.a.vrConfig,this._lastSelectedHotspot=void 0,this._lastHoveredHotspot=void 0,this._lastFloorHeight=0,this._lastTime=0,this._lastWorldFactor=-1,this._lastMouse=Uh.vec2.create(),this._interpolatorAlpha=new jh.DelayInterpolator(1),this._interpolatorAlpha.setDelay(.1),this._webvrMaxHeight=this.getWebVRMaxHeight(),this._nodeWebVR=new Uh.Node,this._nodeWebVR.setName("Feature - WebVR"),this._proxyVR=new Uh.Node,this._proxyVR.setName("WebVR - Proxy"),this._proxyVR.setNodeMask(0),this._floorMT=new dh(e),this._humanMT=new zc(e),this._teleportNode=new Zc,this._cursorMT=new ah,this._controllerMT=new Rh(e,this._viewer.getInputManager()),this._nodeMenu=new Vh(e),this._nodeMenu.setHomeAction(this._onVrSessionEnd.bind(this)),this._nodeMenu.setNextAction(this.goToNextHotspot.bind(this)),this._nodeMenu.setPrevAction(this.goToPrevHotspot.bind(this)),this._dataDownloaded=!1,this._scaleControlEnabled=!0,this._frameData=void 0,this.onFloorHeight(),this.initGraphNodes(),this.hookComputeCanvasSize(),Te.a.initWebVR(this),this._onVrSessionEndBinded=this._onVrSessionEnd.bind(this),this._viewerOSGJS.getInputManager().getInputSource("WebVR").pollHeadset().catch(function(){}),k.a.getModelDisplayed().then(this.initWebVR.bind(this))},getNodeWebVR:function(){return this._nodeWebVR},getProxyWebVR:function(){return this._proxyVR},getWebVRMaxHeight:function(){return-1===Object(u.a)().maxDevicePixelRatio?-1:vr.a.any?Math.min(window.screen.width,window.screen.height)*Object(Bh.a)():-1},_onVrDisplayPointerRestricted:function(){this._viewer.getCanvas().requestPointerLock()},_onVrDisplayPointerUnrestricted:function(){document.exitPointerLock()},initWebVR:function(){this._nodeWebVR.addUpdateCallback(this)},setProxyVisible:function(e){this._proxyVR.setNodeMask(e?_e.a.NO_SHADOW:0)},onDoubleTap:function(e){if(!this.model.get("enable")&&-1===e._nodePath.indexOf(this._humanMT)){var t=Uh.vec3.create();Ce.a.getWorldPositionFromHit(e,t),Uh.mat4.setTranslation(this._humanMT.getMatrix(),t),V.a.draw()}},scaleUp:function(){var e=this.model.get("worldFactor");e<=0||this.model.set("worldFactor",1.2*e)},scaleDown:function(){var e=this.model.get("worldFactor");e<=0||this.model.set("worldFactor",e*(1/1.2))},savePosition:function(e){this._lastMouse[0]=e.canvasX,this._lastMouse[1]=e.canvasX},onFloorHeight:function(){var e=this.model.get("floorHeight"),t=.05*this.model.get("worldFactor");Math.abs(this._humanMT.getMatrix()[14]-this._lastFloorHeight)<=t&&(this._humanMT.getMatrix()[14]=e),this._floorMT.getMatrix()[14]=e,this._lastFloorHeight=e},initGraphNodes:function(){this._nodeWebVR.addChild(this._proxyVR),this._proxyVR.addChild(this._floorMT),this._proxyVR.addChild(this._humanMT),this._proxyVR.addChild(this._teleportNode),this._proxyVR.addChild(this._cursorMT),this._proxyVR.addChild(this._controllerMT),this._proxyVR.addChild(this._nodeMenu);var e=this._proxyVR.getOrCreateStateSet();e.setRenderBinDetails(Se.a.TRANSPARENT_NO_EARLYZ_POST,"RenderBin"),e.setAttributeAndModes(we.a.DEPTH_LESS_NO_WRITE),e.setAttributeAndModes(we.a.CULL_DISABLE)},resetCameraToHuman:function(){var e=Uh.vec3.create(),t=Uh.vec3.create(),n=Uh.mat4.create(),i=Uh.vec3.create();return function(){var r=Uh.mat4.copy(n,this._humanMT.getMatrix());Uh.mat4.getScale(e,r),Uh.vec3.set(e,1/e[0],1/e[1],1/e[2]),Uh.mat4.scale(r,r,e);var a=this._manipulator.getFirstPersonManipulator(),o=a.getPostMultRotate();Uh.quat.normalize(o,Uh.mat4.getRotation(o,r)),a.setResetInitialRotationVR(!0),Uh.mat4.getTranslation(t,r),t[2]+=this.getEyeLevel(),Uh.vec3.set(i,0,1,0),Uh.vec3.transformQuat(i,i,o),Uh.vec3.add(i,t,i),this._viewer.getFeaturesManager().focusOnTargetAndEye(i,t)}}(),requestData:function(e,t){e&&!this._dataDownloaded&&(this._dataDownloaded=!0,this._teleportNode.initTextureTeleport(),this._floorMT.initTextureFloor(),this._nodeMenu.initialize(t))},startEnable:function(e){var t=this._viewer.getFeatures();this.setProxyVisible(e),this.requestData(e,t),this.updateDistortion(),t.background.getModel().set("webVR",e&&!Object(u.a)().vrAr),t.camera.getModel().set("webVR",e),t.hotspot.getModel().set("webVR",e),t.shadingStyle.getModel().set("webVR",e),t.lighting.getModel().set("webVR",e),t.postProcess.getModel().set("webVR",e),Object(u.a)().vrStereo?(this._cullConfig.doVR=e,Oa.a.uIsVr.setFloat(e)):(this._cullConfig.doVR=!1,Oa.a.uIsVr.setFloat(0)),this._controllerMT.setListenToEvents(e),e?this._floorMT.updateNodeVR():this._viewer.getFeaturesManager().focusOnSavedCamera(2);var n=e&&!Object(u.a)().vrAr?1:0;this._viewer.getCamera().getClearColor()[3]=n,this._resetOnNextFrame=!0,Uh.log("Viewer StartEnable: enabled:"+e)},onEnable:function(){var e=this.model.get("enable");e?(this._viewer.getInputManager().setEnable(Gh.WEBVR,e),this._viewerOSGJS.setPresentVR(!0).then(function(t){console.log("starting VR"),this.model.set("hasNativeHMD",!0),this._registerVRCallbacks(e,t),this.startEnable(e)}.bind(this)).catch(function(){this.model.set({enable:!1},{silent:!0})}.bind(this))):(console.log("Shutting down VR"),this._registerVRCallbacks(!1,this._viewerOSGJS.getVRSession()),this._viewerOSGJS.setPresentVR(!1),this._viewer.getInputManager().setEnable(Gh.WEBVR,e),this.startEnable(e),this._nodeMenu.hide()),this._framePose=void 0},onPoseChange:function(e){this._framePose=e.pose},_registerVRCallbacks:function(e,t){e?t.addEventListener("end",this._onVrSessionEndBinded):t.onend=void 0},_onVrSessionEnd:function(){this.model.get("enable")&&this.model.set("enable",!1)},updateDistortion:function(){var e=this._viewer.getFeatures().postProcess.getModel(),t=!this.model.get("hasNativeHMD")&&!Object(u.a)().vrAr;if(e.set("doDistortionVR",t),t){var n=this.model.get("deviceInfo"),i=n.getProjectionMatrixLeftEye(),r=n.getProjectionMatrixLeftEye(!0),a=n.getUndistortedViewportLeftEye(),o=n.device,s={xScale:a.width/(o.width/2),yScale:a.height/o.height,xTrans:2*(a.x+a.width/2)/(o.width/2)-1,yTrans:2*(a.y+a.height/2)/o.height-1};e.set("distortion",n.viewer.distortionCoefficients),e.set("projectionLeft",uc.projectionMatrixToVector_(i)),e.set("unprojectionLeft",uc.projectionMatrixToVector_(r,s))}},snapHumanOnFloor:function(){this._humanMT.getMatrix()[14]-=this._humanMT.computeDistanceToFloor()},getEyeLevel:function(){var e=this.getPosVR()[2];return this._framePose&&e||(e=0),this.model.get("worldFactor")*this.model.getDefaultHumanHeight()+e},snapOnClosestSurface:function(){var e=this._manipulator.getEyePosition(Uh.vec3.create()),t=Uh.vec3.copy(Uh.vec3.create(),e);t[2]-=5*this.model.get("worldFactor");var n=this._viewer.getFeaturesManager(),i=Ce.a.computeNearestIntersection3D(e,t,_e.a.PICK_GEOMETRY_FAST,this._nodeWebVR);if(i){var r=Uh.vec3.create();Ce.a.getWorldPositionFromHit(i,r),r[2]+=this.getEyeLevel(),n.focusOnTargetAndEye(void 0,r)}},scaleMatrixTranslate:function(e,t){e[12]*=t,e[13]*=t,e[14]*=t},transformMatrixYuptoZup:function(){var e=Uh.vec3.create(),t=Uh.vec3.create();return function(n){var i=Uh.mat4.getScale(e,n),r=Math.abs(i[0]-1)>1e-7||Math.abs(i[1]-1)>1e-7||Math.abs(i[2]-1)>1e-7;r&&(t[0]=1/i[0],t[1]=1/i[1],t[2]=1/i[2],Uh.mat4.scale(n,n,t));var a=n,o=a[4],s=a[5],u=a[6],l=a[7];a[4]=-a[8],a[5]=a[9],a[6]=a[10],a[7]=a[11],a[8]=o,a[9]=s,a[10]=u,a[11]=l;var c=a[1];a[1]=-a[2],a[2]=c,c=a[5],a[5]=a[6],a[6]=-c,c=a[10],a[10]=a[9],a[9]=-c,c=a[13],a[13]=-a[14],a[14]=c,r&&Uh.mat4.scale(n,n,i)}}(),computeEyesOffsetViewMatrices:function(){var e=Uh.mat4.create();return function(t,n,i){var r=this._framePose;Uh.mat4.identity(e),r.transform.matrix&&(e=r.transform.inverse.matrix),Uh.mat4.multiply(t,e,t),Uh.mat4.multiply(n,e,n),Uh.mat4.invert(t,t),Uh.mat4.invert(n,n),this.transformMatrixYuptoZup(t),this.transformMatrixYuptoZup(n),this.scaleMatrixTranslate(t,i),this.scaleMatrixTranslate(n,i)}}(),onWorldFactor:function(){var e=this.model.get("worldFactor");if(this._lastWorldFactor>0&&this._lastWorldFactor!==e&&this.model.get("enable")&&this.snapOnClosestSurface(),this._lastWorldFactor=e,this._framePose){var t=this._viewerOSGJS.getVRSession().renderState.baseLayer,n=this._cullConfig;n.framebufferWidth=t.framebufferWidth,n.framebufferHeight=t.framebufferHeight;for(var i=0;i<this._framePose.views.length;i++){var r=this._framePose.views[i],a=t.getViewport(r),o=a.height-a.y,s=Math.floor(a.width-a.x)||512,u=Math.floor(o)||512;e=this.model.get("worldFactor");"left"===r.eye&&(n.leftRenderWidth=s,n.leftRenderHeight=u,Uh.mat4.copy(n.leftProjection,r.projectionMatrix),Uh.mat4.copy(n.leftOffsetView,r.transform.matrix)),"right"===r.eye&&(n.rightRenderWidth=s,n.rightRenderHeight=u,Uh.mat4.copy(n.rightProjection,r.projectionMatrix),Uh.mat4.copy(n.rightOffsetView,r.transform.matrix))}this.computeEyesOffsetViewMatrices(n.leftOffsetView,n.rightOffsetView,e),this._viewer.getInputManager().setParam("worldFactor",e),V.a.draw()}},perspectiveMatrixFromVRFieldOfView:function(e,t,n,i){var r=i||Uh.mat4.create(),a=Math.PI/180,o=Math.tan(e.upDegrees*a)*t,s=Math.tan(e.downDegrees*a)*t,u=Math.tan(e.leftDegrees*a)*t,l=Math.tan(e.rightDegrees*a)*t;return Uh.mat4.frustum(r,-u,l,-s,o,t,n),r},hookComputeCanvasSize:function(){var e=this._viewerOSGJS,t=e.computeCanvasSize,n=this,i=this._cullConfig;e.computeCanvasSize=function(r){if(!(n.model.get("enable")&&n._framePose))return t.call(e,r);n.onWorldFactor();var a=Math.min(vr.a.any?4096:16384,Ac.a.instance().getWebGLParameter("MAX_RENDERBUFFER_SIZE")),o=Object(u.a)().vrMaxRttSize;o&&(a=o);var s=i.framebufferWidth,l=i.framebufferHeight;if(s>a){var c=a/s;s=Math.floor(s*c)}if(l>a){var h=a/l;l=Math.floor(l*h)}var d=!1;return this._canvasWidth!==s&&(r.width=s,this._canvasWidth=s,d=!0),this._canvasHeight!==l&&(r.height=l,this._canvasHeight=l,d=!0),d}},getPosVR:function(){var e=Uh.vec3.create();return function(){return this._manipulator.getCurrentManipulator()._vrPos||Uh.vec3.set(e,0,0,0)}}(),getTeleportPosFromHotspot:function(){var e=Uh.vec3.create(),t=Uh.vec3.create(),n=Uh.vec3.create(),i=Uh.vec3.create();return function(r,a,o,s){var u=this.model.get("worldFactor");Ce.a.getWorldPositionFromScenePoint(Uh.mat4.getTranslation(e,r.getHotspotMatrix()),t);var l=2.5*u;Uh.vec3.sub(e,t,a);var c=Uh.vec3.length(e);e[2]=0,Uh.vec3.normalize(e,e),Uh.vec3.scale(e,e,l),Uh.vec3.sub(n,t,e),n[2]=t[2]+u,c<l+.1*l&&Uh.vec3.copy(n,a),Uh.vec3.copy(i,n),i[2]-=3.5*u;var h=Ce.a.computeNearestIntersection3D(n,i,_e.a.PICK_GEOMETRY_FAST,this._nodeWebVR);h?(Ce.a.getWorldPositionFromHit(h,o,s),h.backface&&Uh.vec3.negate(s,s)):(Uh.vec3.copy(o,n),o[2]-=this.getEyeLevel(),Uh.vec3.set(s,0,0,1)),this._teleportNode.setHotspotHint(r.canTeleport(),o,t,u),r.setWorldTeleportPosition(t,o,u)}}(),updateHitHotspot:function(){var e=function(e){return e instanceof _s};return function(t,n,i,r,a){var o=this._viewer.getFeatures().hotspot.getWidgetNode(),s=t&&-1!==t._nodePath.indexOf(o);if(this._lastHoveredHotspot&&this._lastHoveredHotspot.setHovered(!1),!s)return this._lastHoveredHotspot&&this._lastHoveredHotspot.updateCardHit(),this._lastHoveredHotspot=void 0,void this._teleportNode.setHotspotHint(!1);var u=this._lastHoveredHotspot=Object(Li.a)(t._nodePath,e);return u.updateCardHit(t),u.setHovered(!0),u.isFullyVisibleCard()?u:(this.getTeleportPosFromHotspot(u,n,r,a),this._viewer.getFeatures().hotspot.getModel().set("currentHotspotIndex",u.getIndex()),u)}}(),handleHitPicking:function(e,t,n,i,r,a,o){var s,u=this._viewer.getFeaturesManager(),l=this.model.get("worldFactor"),c=this._floorMT.getBoundingSphere(),h=Uh.vec3.dist(c.center(),t)+c.radius();return e?s=Ce.a.computeNearestIntersection2D(this._lastMouse[0],this._lastMouse[1],_e.a.PICK_GEOMETRY_FAST):this._controllerMT.isPosedController()?(s=this._controllerMT.raycastFromController(this._nodeWebVR,u,h,a,o))?(Ce.a.getWorldPositionFromHit(s,i,r),s._backface&&Uh.vec3.negate(r,r),this._controllerMT.updatePointerScaleFromHit(i),this._cursorMT.setColor(Uh.vec3.fromValues(.1,.66,.85))):(this._controllerMT.resetPointerScale(),Uh.vec3.copy(i,o)):(Uh.vec3.copy(a,t),Uh.vec3.copy(o,n),Uh.vec3.scale(o,n,h),Uh.vec3.add(o,a,o),(s=Ce.a.computeNearestIntersection3DHotspotFirst(a,o,_e.a.PICK_GEOMETRY_FAST,this._nodeWebVR))?(Ce.a.getWorldPositionFromHit(s,i,r),s._backface&&Uh.vec3.negate(r,r)):(Uh.vec3.scale(i,n,3*l),Uh.vec3.add(i,t,i))),s},goToNextHotspot:function(){this._viewer.getFeatures().postProcess.getModel().fadeForTeleportVR(this.doTeleportToHotspot.bind(this,1))},doTeleportToHotspot:function(e){this._nodeMenu&&this._nodeMenu.isVisible()&&this._nodeMenu.hide();var t=this.computeHotspotIndex(e);-1!==t&&(this.moveToHotspotWithIndex(t),this.displayHotspotCardForIndex(t))},goToPrevHotspot:function(){this._viewer.getFeatures().postProcess.getModel().fadeForTeleportVR(this.doTeleportToHotspot.bind(this,-1))},displayHotspotCardForIndex:function(e){var t=this._viewer.getFeatures().hotspot.getWidgetNode().children[e];this.toggleHotspotCard(t)},computeHotspotIndex:function(e){var t=this._viewer.getFeatures().hotspot.getModel(),n=t.get("hotspots");if(0===n.length)return-1;if(1!==e&&-1!==e)return console.log("computeHotspotIndex was called with an invalid direction argument. Valid values are 1 for foward -1 for backward."),0;var i=t.get("currentHotspotIndex"),r=n.length;return(i+=e)<0&&(i=-1),i=(i%r+r)%r,t.set("currentHotspotIndex",i),i},moveToHotspotWithIndex:function(){var e=Uh.vec3.create(),t=Uh.vec3.create(),n=Uh.vec3.create();return function(i){var r=this._viewer.getFeatures().hotspot.getWidgetNode().children[i],a=this._viewer.getFeatures().hotspot.getModel().get("hotspots").at(i);Ce.a.getWorldPositionFromScenePoint(a.get("eye"),t),Ce.a.getWorldPositionFromScenePoint(a.get("position"),e),this.getTeleportPosFromHotspot(r,t,t,n),t[2]+=this.getEyeLevel(),this._manipulator.getFirstPersonManipulator().setInitialPoseVR(t,e)}}(),doTeleport:function(e,t,n){var i=this._viewer.getFeaturesManager();e[2]+=this.getEyeLevel(),t[2]+=this.getEyeLevel(),i.focusOnTargetAndEye(t,e),this.toggleHotspotCard(n)},toggleHotspotCard:function(e){e&&(e.isFullyVisibleCard()?e.onCardHit(this):(this._lastSelectedHotspot&&this._lastSelectedHotspot.setVisibleCard(!1),this._lastSelectedHotspot=e,e&&e.setVisibleCard(!0)))},setPauseUpdate:function(e){this._pauseUpdate=e},update:function(){var e=Uh.vec3.create(),t=Uh.vec3.create(),n=Uh.vec3.create(),i=Uh.vec3.create(),r=Uh.vec3.create(),a=Uh.vec3.create(),o=Uh.vec3.create(),s=Uh.vec3.create(),l=Uh.vec3.create(),c=Uh.vec3.create();return function(h,d){var f=this._viewer.getFeatures(),p=this.model.get("enable"),g=this._viewer.getOptions().widgetAPI,m=!!g&&"virtual reality and augmented reality"===g.getTabbedWidget().get()&&!this._pauseUpdate,v=p||m;this.setProxyVisible(v);var _=f.background.getModel();_.get("webVR")!==v&&_.set("webVR",v);var b=f.postProcess.getModel();if(b.get("webVR")!==v&&b.set("webVR",v),this._humanMT.setVisible(m),!p&&!m)return!0;var S=this.model.get("worldFactor"),y=d.getFrameStamp(),x=y.getSimulationTime(),C=y.getDeltaTime();this._resetOnNextFrame&&this._framePose&&(this._resetOnNextFrame=!1,this.resetCameraToHuman()),this._manipulator.getEyePosition(n),this._manipulator.getTarget(i),Uh.vec3.sub(i,i,n),Uh.vec3.normalize(i,i);var w=this._viewer.getCamera(),T=this._viewerOSGJS.getVRSession();if(T){var M=T.inputSources;this._controllerMT.updateNodeVR(M,C,Uh.vec3.sub(s,n,this.getPosVR()))}var E=this.handleHitPicking(!p&&m,n,i,t,e,r,a);Uh.vec3.copy(o,t);var A,O,R=p&&this._controllerMT.isTeleportPressed(),P=this._controllerMT.isClickPressed(),I=this._nodeMenu&&this._controllerMT.isMenuPressed(this._nodeMenu.isVisible()),N=E&&-1===E._nodePath.indexOf(this._nodeMenu)&&(R||P)&&this._nodeMenu.isVisible(),L=p&&(I||N);if(L&&(this._manipulator.getTarget(s),this._nodeMenu.isVisible()?this._nodeMenu.hide():this._nodeMenu.display(n,s)),p){O=this._nodeMenu.updateHit(E),A=this.updateHitHotspot(E,r,a,o,e),this._teleportNode.updateWorldNormal(y,e);var k=E&&e[2]>.5,D=A?A.canTeleport():k,F=E&&-1!==E._nodePath.indexOf(this._floorMT),B=A?A.canTeleport():k&&(!this.model.isDiorama()||F);if(R&&x-this._lastTime>.5){if(D)Uh.vec3.add(c,o,i),Uh.vec3.copy(l,o),this._viewer.getFeatures().postProcess.getModel().fadeForTeleportVR(this.doTeleport.bind(this,l,c,A)),this._lastTime=x;D||this.toggleHotspotCard(A),O&&O.click()}this._interpolatorAlpha.setTarget(B?1:0),this._interpolatorAlpha.update(y.getDeltaTime())}var U=this._viewer.getFeaturesManager().getIconScaleFov(this._cullConfig.leftProjection),j=Uh.vec3.dist(t,n)/U,G=L?0:this._interpolatorAlpha.getCurrent()[0];this._cursorMT.setVisible(p),this._teleportNode.setVisible(E&&p&&!I);var H=!Object(u.a)().vrAr&&this.model.get("displayFloor");this._floorMT.setVisible(H),this._floorMT.updateNodeVR(),this._humanMT.updateNodeVR(E,x),this._teleportNode.updateNodeVR(G,E,y,o,S,j,e),this._cursorMT.updateNodeVR(A?1:1-G,w,t,j),this._nodeMenu&&this._lastSelectedHotspot&&this._nodeMenu.isVisible()&&this._lastSelectedHotspot.isFullyVisibleCard()&&this._lastSelectedHotspot.setVisibleCard(!1);var z=this._controllerMT.checkScaleChangeValue();return this._scaleControlEnabled&&0!==z&&(z=S*Math.abs(z)*(z>0?1.02:1/1.02),this.model.set("worldFactor",z,{silent:!!this._framePose})),V.a.draw(),!0}}()})]}),zh=i.a.create(Hh);zh.prototype.getNode=function(){return this._views[0].getNodeWebVR()},zh.prototype.getWidgetNode=function(){return this._views[0].getProxyWebVR()},zh.prototype.prepareForScreenShot=function(){var e=i.a.prototype.prepareForScreenShot.call(this);return e&&this._views[0].setPauseUpdate(!0),e},zh.prototype.resetAfterScreenShot=function(){i.a.prototype.resetAfterScreenShot.call(this),this._views[0].setPauseUpdate(!1)};var Wh,qh,Xh=zh,Yh=n("bud1"),Kh=n("IKww"),Qh=a.a.extend({getModelOptionPath:function(){return"sound"},defaults:function(){return{currentSoundIndex:-1,visible:Object(u.a)().uiSound,autoplay:!0,playing:!1,volume:void 0,select:void 0,enable:!0}},getName:function(){return"Sound"},init:function(e){this._viewer=e.getViewer(),this.set("volume",Kh.a.getVolume());var t=e.getModel().get("options").sound;this.set("soundtracks",s.default.instance.getSoundCollection()),this.setJSON(t)},setJSON:function(e,t){var n=e&&e.soundtracks;if(n&&n.length)for(var i=this.get("soundtracks"),r=0;r<n.length;++r){var a=n[r],o=i.findWhere({uid:a.uid}),s=!0;o?o.get("isInit")?o=o.duplicate():s=!1:o=new Yh.a,o.setJSON(a,t),o.set("isInit",!0),s&&i.add(o)}},getJSON:function(){var e=[];return this.get("soundtracks").each(function(t){e.push(t.getJSON())}),{soundtracks:e}}}),Jh=n("gzuT"),Zh=d.a.osg,$h=d.a.osgUtil,ed=d.a.InputGroups,td=we.a.BLEND_SUBSTRACTIVE,nd=we.a.DEPTH_DISABLE,id=Zh.StateAttribute.ON,rd=Zh.vec4.fromValues(.109375,.6640625,.84765625,1),ad=Zh.vec4.fromValues(1,1,0,1),od=Zh.vec4.fromValues(.8,.8,.8,1),sd=Zh.vec4.fromValues(1,1,0,1),ud=function(){return qh||(qh=Zh.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0)),qh},ld={init:function(e,t,n){this.model=e,this._context=t,this._viewer=this._context.getViewer(),this._nodeFeature=n,this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._manipulator=this._viewerOSGJS.getManipulator(),this._icons=[],this._nodeCamera=new Zh.Camera,this._nodeCamera.setNearFarRatio(5e-4),this._nodeCamera.setName("Sound - Camera"),this._nodeCamera.getOrCreateStateSet().setRenderBinDetails(Se.a.EDITOR_GIZMO,"RenderBin"),this._nodeCamera.setNodeMask(0),this._nodeIcons=new Zh.MatrixTransform,this._nodeFeature.addChild(this._nodeCamera),this._nodeCamera.addChild(this._nodeIcons),this._nodeGizmos=new Zh.MatrixTransform,this._nodeGizmos.setNodeMask(0),this._nodeGizmos._forceEnterIntersection=!0,this._nodeCamera.addChild(this._nodeGizmos),this._prepareGeometriesGizmo(),this._gizmoRefDistance=this._makeGizmo(this._geomHandleDistance),this._nodeGizmos.addChild(this._gizmoRefDistance._nodeGizmo),this._gizmoFalloff=this._makeGizmo(this._geomHandleFalloff),this._nodeGizmos.addChild(this._gizmoFalloff._nodeGizmo),Te.a.initSound(this),this.initStateset()},_prepareGeometriesGizmo:function(){this._geomHandleFalloff=new Zh.createTexturedBoxGeometry(0,0,0,.5,.5,.5),this._geomHandleDistance=new Zh.createTexturedBoxGeometry(0,0,0,.5,.5,.5),this._arc=$h.GizmoGeometry.createCircleGeometry(64,1,3.2*Math.PI),this.setGizmoStateset(this._arc,rd),this.setGizmoStateset(this._geomHandleDistance,rd),this.setGizmoStateset(this._geomHandleFalloff,rd)},_makeGizmo:function(e){var t={};return t._nodeGizmo=new Zh.MatrixTransform,t._arcScale=new Zh.MatrixTransform,this._arcScale=new Zh.MatrixTransform,t._arcX=this._makeArc(t._arcScale,"arcX"),t._arcY=this._makeArc(t._arcScale,"arcY",.5*-Math.PI,Zh.vec3.fromValues(1,0,0)),t._arcZ=this._makeArc(t._arcScale,"arcZ",.5*Math.PI,Zh.vec3.fromValues(0,1,0)),t._handleX=this._makeHandle(t._nodeGizmo,"handleX",Zh.vec3.fromValues(1,0,0),e),t._handleY=this._makeHandle(t._nodeGizmo,"handleY",Zh.vec3.fromValues(0,1,0),e),t._handleZ=this._makeHandle(t._nodeGizmo,"handleZ",Zh.vec3.fromValues(0,0,1),e),t._handleXNeg=this._makeHandle(t._nodeGizmo,"handleXNeg",Zh.vec3.fromValues(-1,0,0),e),t._handleYNeg=this._makeHandle(t._nodeGizmo,"handleYNeg",Zh.vec3.fromValues(0,-1,0),e),t._handleZNeg=this._makeHandle(t._nodeGizmo,"handleZNeg",Zh.vec3.fromValues(0,0,-1),e),t._nodeGizmo.editMask=$h.NodeGizmo.PICK_ARROW|$h.NodeGizmo.PICK_PLANE,t._nodeGizmo.setCullingActive(!1),t._nodeGizmo.addChild(t._arcScale),t},_makeHandle:function(e,t,n,i){var r=new Zh.MatrixTransform;return r.setName(t),e.addChild(r),r.addChild(i),Zh.mat4.fromTranslation(r.getMatrix(),n),r},_makeArc:function(e,t,n,i){var r=new Zh.MatrixTransform;return r.setName(t),e.addChild(r),r.addChild(this._arc),n&&i&&Zh.mat4.fromRotation(r.getMatrix(),n,i),r},initStateset:function(){this._nodeCamera.getOrCreateStateSet().setTextureAttributeAndModes(0,ji.a.dummyTexture,id),this._nodeCamera.getOrCreateStateSet().addUniform(Zh.Uniform.createInt(0,"uTextureDepth"))},setGizmoStateset:function(e,t){var n=e.getOrCreateStateSet();n.setAttributeAndModes(be.a.getOrCreateShader(ga.a,va.a,"line","Handle3D","LINE"),id),n.setAttributeAndModes(td,id),n.setAttributeAndModes(nd,id),n.addUniform(Zh.Uniform.createFloat4(t,"uColor"))},updateDragHandle:function(e,t){var n=e.getMatrix();Zh.mat4.fromTranslation(n,t);var i=e.getWorldMatrices()[0];Zh.mat4.getTranslation(t,i);var r=this.getIconSize(t);Zh.mat4.scale(n,n,r),e.dirtyBound()},updateArcScale:function(){var e=Zh.vec3.create();return function(t,n){var i=t._arcScale.getMatrix();Zh.mat4.scale(i,Zh.mat4.IDENTITY,Zh.vec3.set(e,n,n,n)),t._arcScale.dirtyBound(),this.updateDragHandle(t._handleX,Zh.vec3.set(e,n,0,0)),this.updateDragHandle(t._handleY,Zh.vec3.set(e,0,n,0)),this.updateDragHandle(t._handleZ,Zh.vec3.set(e,0,0,n)),this.updateDragHandle(t._handleXNeg,Zh.vec3.set(e,-n,0,0)),this.updateDragHandle(t._handleYNeg,Zh.vec3.set(e,0,-n,0)),this.updateDragHandle(t._handleZNeg,Zh.vec3.set(e,0,0,-n))}}(),_checkSelectNodeChanged:function(){var e=this.model.get("select");if(e!==this._select){this._select=e;var t=this.getGizmo();if(!e||e.get("ambient"))return t.attachToNode(null),void this.hideIcon(e);this.addIcon(e),Object(Co.e)(e),this._setGizmoPositionFromSound()}},_updateFalloffGizmo:function(){var e=this.model.get("select");this.updateArcScale(this._gizmoRefDistance,e.get("distance")),"linear"===e.get("distanceModel")?(this._gizmoFalloff._nodeGizmo.setNodeMask(_e.a.NO_SHADOW),this.updateArcScale(this._gizmoFalloff,e.get("distanceMax"))):this._gizmoFalloff._nodeGizmo.setNodeMask(0)},_setGizmoPositionFromSound:function(){var e=this.model.get("select").get("lastComputedWorldPosition");Zh.mat4.setTranslation(this._nodeGizmos.getMatrix(),e)},_setSoundPositionFromGizmo:function(){var e=this.model.get("select"),t=e.get("lastComputedWorldPosition");Zh.mat4.getTranslation(t,this._nodeGizmos.getMatrix()),Object(Co.d)(e,t)},updateGizmo:function(){var e=this.getGizmo();if(e){this._checkSelectNodeChanged();var t=this.model.get("select");if(!t||t.get("ambient"))return this._nodeGizmos.setNodeMask(0),void e.setNodeMask(0);e.attachToNode(this._nodeGizmos),this._nodeGizmos.setNodeMask(-1),e.setNodeMask(-1);var n=t.get("snap");n?this._nodeGizmos.editMask=$h.NodeGizmo.NO_PICK:(this._nodeGizmos.editMask=$h.NodeGizmo.PICK_ARROW|$h.NodeGizmo.PICK_PLANE,t.set("geometryUid",-1)),this._dragging&&V.a.draw(),this._updateFalloffGizmo(),this._nodeGizmos.dirtyBound();var i=t.get("lastComputedWorldPosition"),r=t.get("snapChanged");r&&t.set("snapChanged",!1),e.isEditing()||r?n?(this.snapCheck(t,i),this._displaySnapHelp()):this._setSoundPositionFromGizmo():this._setGizmoPositionFromSound()}},_updateSoundObjectPosition:function(e){Object(Co.e)(e),e.get("soundObject").setPositionNormalized(e.get("lastComputedWorldPosition"))},getNodeCamera:function(){return this._nodeCamera},getGizmo:function(){var e=this._viewer.getFeaturesManager();return e?e.getNodeGizmo():null},_displaySnapHelp:function(){new Jh.a({content:"Double-click to snap the sound on the object surface.",class:"info",delay:2e3})},initDepthTexture:function(){var e=this._viewer.getFeaturesManager().getTextureDepth();this._nodeCamera.getStateSet().setTextureAttributeAndModes(0,e,id);for(var t=0,n=this._icons.length;t<n;t++)this._icons[t].getStateSet().setTextureAttributeAndModes(0,e,id)},getIconSize:function(){var e=Zh.vec3.create(),t=Zh.vec3.create();return function(n){var i=this._viewer.getFeaturesManager(),r=i?i.getIconScaleFov():1;this._manipulator.getEyePosition(e);var a=Zh.vec3.dist(e,n||Zh.vec3.ZERO)/r;return Zh.vec3.set(t,a,a,a)}}(),updateIcons:function(){var e=Zh.quat.create(),t=Zh.mat4.create(),n=Zh.vec3.create(),i=Zh.vec3.create();return function(){var r=this.model.get("select"),a=this._viewer.getCamera(),o=Zh.mat4.getScale(n,a.getProjectionMatrix())[0],s=.02*this._viewerOSGJS.getCanvasClientWidth()*o;this._manipulator.getEyePosition(i),Zh.mat4.invert(t,a.getViewMatrix()),Zh.mat4.getRotation(e,t);for(var u=0,l=this._icons.length;u<l;u++){var c=this._icons[u],h=c.getUserData();c!==this._hovered&&this.setIconSelected(c,r===h);var d=c.getMatrix();this._updateSoundObjectPosition(h);var f=h.get("lastComputedWorldPosition"),p=Zh.vec3.dist(i,f)/s;Zh.vec3.set(n,p,p,p),Zh.mat4.fromRotationTranslationScale(d,e,f,n),c.dirtyBound()}}}(),addIcon:function(e){var t,n;if(n=this._findIcon(e))return n.setNodeMask(-1),n;t=ud(),(n=new Zh.MatrixTransform).addChild(t);var i=s.default.instance.getOrCreateTexture(ye.iconSound,{internalFormat:Zh.Texture.RGBA});this.setGizmoStateset(n,od);var r=n.getOrCreateStateSet();r.setTextureAttributeAndModes(1,i.texture,id),r.addUniform(Zh.Uniform.createInt(1,"uTextureIcon")),r.addUniform(Zh.Uniform.createInt(0,"uAttachedToCamera")),r.addUniform(Zh.Uniform.createInt(1,"uEnable")),Wh||(Wh=be.a.getOrCreateShader(ga.a,va.a,"icon","LightingIcon","ICON")),r.setAttributeAndModes(Wh);var a=this._icons.length;n.setName("SOUNDIconMT_"+a);var o=n.getMatrix();Zh.mat4.fromTranslation(o,e.get("lastComputedWorldPosition")),Zh.mat4.scale(o,o,this.getIconSize()),this._icons.push(n),this._nodeIcons.addChild(n),n.setUserData(e),n.dirtyBound()},hideIcon:function(e){var t=this._findIcon(e);t&&t.setNodeMask(0)},_findIcon:function(e){for(var t=0;t<this._icons.length;t++)if(this._icons[t].getUserData()===e)return this._icons[t];return null},snapCheck:function(){var e=new $h.SphereIntersector,t=new $h.IntersectionVisitor,n=Zh.vec3.create();return function(i,r){t.setTraversalMask(_e.a.PICK_GEOMETRY_SLOW);var a=10*X.a.getModelBoxWithDisplacement().radius();Ce.a.getScenePositionFromWorldPoint(r,n),e.set(n,a),t.setIntersector(e),this._viewer.getRootModel().accept(t);var o=e.getIntersections(),s=o.length;if(s){for(var u=o[0],l=1;l<s;++l){var c=o[l];c._ratio<u._ratio&&(u=c)}Object(Co.b)(i,u)}}}(),onDragStart:function(e){if(this.isSoundTabOpen()&&Ce.a.isInitialized()){var t=Ce.a.computeNearestIntersection2D(e.canvasX,e.canvasY,_e.a.PICK_GEOMETRY,this._nodeCamera);if(this._dragging=!1,t){var n=t._nodePath[t._nodePath.length-1];if(n===ud()){var i=t._nodePath[t._nodePath.length-2].getUserData();i&&this.model.get("soundtracks").trigger("select",i)}else if(n===this._geomHandleDistance||n===this._geomHandleFalloff){var r=this.model.get("select");if(void 0===r)return;var a=this.getGizmo();if(!a||a.isEditing())return;this._manipulator.getInputManager().setEnable(ed.MANIPULATORS,!1),this._dragging=!0,this.model.set("dragging",!0);var o=a.getWorldMatrices()[0],s=Zh.vec3.create();Zh.vec3.transformMat4(s,s,o),a.getCanvasPositionFromWorldPoint(s,s),this._draggingStartGizmoCenterX=s[0],this._draggingStartGizmoCenterY=s[1],this._draggingStartX=e.canvasX,this._draggingStartY=e.canvasY;var u=(this._draggingStartX-this._draggingStartGizmoCenterX)/this._viewer.getWidth(),l=(this._draggingStartY-this._draggingStartGizmoCenterY)/this._viewer.getHeight();this._draggingStartScreenDistance=Math.sqrt(u*u+l*l),t._nodePath[t._nodePath.length-3]===this._gizmoFalloff._nodeGizmo?(this.draggingFallofGizmo=!0,this._draggingStartDistance=r.get("distanceMax")):(this.draggingRefDistanceGizmo=!0,this._draggingStartDistance=r.get("distance"))}}}},onHover:function(e,t,n){if(Ce.a.isInitialized()){var i,r=Ce.a.computeNearestIntersection2D(e,t,_e.a.PICK_GEOMETRY,this._nodeCamera);if(r){var a=r._nodePath[r._nodePath.length-1];if(a===this._hovered||r._nodePath.length>2&&r._nodePath[r._nodePath.length-2]===this._hovered)return;a===ud()?(this._hovered=r._nodePath[r._nodePath.length-2],this.setIconSelected(this._hovered,!0),V.a.draw()):a!==this._geomHandleDistance&&a!==this._geomHandleFalloff||(this._hovered=a,i=a.getStateSet().getUniform("uColor").getInternalArray(),Zh.vec4.copy(i,ad),V.a.draw())}else this._hovered&&(this._hovered===this._geomHandleDistance||this._hovered===this._geomHandleFalloff?(i=this._hovered.getStateSet().getUniform("uColor").getInternalArray(),Zh.vec4.copy(i,rd)):this._hovered.getUserData()!==n&&this.setIconSelected(this._hovered,!1),V.a.draw(),this._hovered=!1)}},setIconSelected:function(e,t){var n=e.getStateSet().getUniformList().uColor.getAttribute().getInternalArray();t?Zh.vec4.copy(n,sd):Zh.vec4.copy(n,od)},onDragMove:function(e){if(this.isSoundTabOpen()){var t=this.model.get("select");if(this._dragging){if(void 0!==t){var n=this.getGizmo();if(n)if(n.isEditing())this.onDragEnd();else{var i=(e.canvasX-this._draggingStartGizmoCenterX)/this._viewer.getWidth(),r=(e.canvasY-this._draggingStartGizmoCenterY)/this._viewer.getHeight(),a=Math.sqrt(i*i+r*r);a=a*this._draggingStartDistance/this._draggingStartScreenDistance,this.draggingRefDistanceGizmo?(t.set("distance",a),a>t.get("distanceMax")&&t.set("distanceMax",a)):(t.set("distanceMax",a),a<t.get("distance")&&t.set("distance",a)),V.a.draw()}}}else this.onHover(e.canvasX,e.canvasY,t)}},onDragEnd:function(){this._dragging&&this.isSoundTabOpen()&&(void 0!==this.model.get("select")&&(this._manipulator.getInputManager().setEnable(ed.MANIPULATORS,!0),this.draggingFallofGizmo=!1,this.draggingRefDistanceGizmo=!1,this._dragging=!1,this.model.set("dragging",!1),V.a.draw()))},onDoubleClick:function(e){if(this.isSoundTabOpen()){var t=this.model.get("select");if(void 0!==t&&!t.get("ambient"))if(this._viewer.getFeaturesManager()){var n=Ce.a.pickNearestSurface(e);n&&(Object(Co.b)(t,n),Object(Co.e)(t),t.get("snap")||t.set("geometryUid",-1),this._updateSoundObjectPosition(t))}}},isSoundTabOpen:function(){var e=this._viewer.getOptions().widgetAPI;return e&&"sound"===e.getTabbedWidget().get()},removeIcon:function(e){for(var t=0,n=this._icons.length;t<n;t++){var i=this._icons[t];if(i.getUserData()===e){i.getParents()[0].removeChild(i);break}}},updateVisibility:function(){this.isSoundTabOpen()?(0===this._nodeCamera.getNodeMask()&&this._manipulator.getInputManager().setEnable(ed.SOUND_GIZMO,!0),this._nodeCamera.setNodeMask(_e.a.NO_SHADOW),this.updateGizmo(),this.updateIcons()):(0!==this._nodeCamera.getNodeMask()&&this._manipulator.getInputManager().setEnable(ed.SOUND_GIZMO,!0),this._nodeCamera.setNodeMask(0))}},cd=n("R+tb"),hd=d.a.osg,dd={FeatureName:"sound",ModelType:Qh,ViewListType:[D.a.extend({initialize:function(e){D.a.prototype.initialize.apply(this,arguments),this._currentFrame=0,this._currentSimulationTime=0,this._soundPromises=[],this._soundObjects=[],this._context=e.context,this._viewer=this._context.getViewer();var t=Object(u.a)().soundEnable;this.model.set("enable",t),Object(u.a)().soundMute&&(this.model.set("mute",!0),this.model.set("volume",0),Kh.a.setMute(!0)),this._nodeFeature=new hd.Node,this._nodeFeature.setName("Feature - Sound"),Object(o.a)()&&ld.init(this.model,this._context,this._nodeFeature),this.listenTo(this.model,"change:playing",this.onPlayingChange.bind(this)),this.listenTo(this.model,"change:enable",this.onEnableChange.bind(this)),this.listenTo(this.model,"change:volume",this.updateVolume.bind(this)),this.listenTo(this.model,"change:mute",this.updateMute.bind(this));var n=this.model.get("soundtracks");Object(ze.a)()||t&&Kh.a.checkWillHaveSounds(this._viewer.model)||n.reset();var i=n.length>0;if(i||(k.a.resolveHasSound(i),Object(o.a)())){if(this._nodeFeature.setCullCallback(this),Object(o.a)()||i){var r=Object(cd.a)();r&&document.addEventListener(r,this.tabChange.bind(this))}if(vr.a.apple.device){var a,s,l=!1,c=[];for(a=0,s=n.length;a<s;a++){var d=n.at(a);!l&&d.get("ambient")?l=d:c.push(d)}for(a=0,s=c.length;a<s;a++)n.remove(c[a]);if(!l)return void k.a.resolveHasSound(!1)}this.listenTo(n,"add",this.onAdd.bind(this)),this.listenTo(n,"remove",this.onRemove.bind(this)),this.listenTo(n,"select",this.onSelectChanged.bind(this)),Kh.a.setWaiting(!Object(o.a)()),n.each(this.onAdd.bind(this)),k.a.resolveHasSound(i);var f=[];f.push(k.a.getHasAnimation()),Object(u.a)().soundPreload&&f.push(h.a.all(this._soundPromises).then(function(){k.a.resolveSoundsCanPlayTrough(!0)})),h.a.all(f).then(function(e){this._hasAnim=e[0],Kh.a.setHasAnim(this._hasAnim),k.a.resolveSoundsCanPlayTrough(!0),this._hasAnim||(Kh.a.setWaiting(!1),this.play()),k.a.getFirstAnimation().then(function(){Object(o.a)()&&ld.initDepthTexture(),this.updatePositionAndTime(this.model.get("playing"));var e=this._viewer.getFeatures().animation.getModel();this._featureAnimationModel=e,this._hasAnim&&(Kh.a.setWaiting(!1),e.bind("change:playing",this.onAnimationPlaying,this),e.bind("change:speed",this.onAnimationSpeedChange,this),e.bind("seek",this.onAnimationTimeSeek,this),e.bind("change:currentUID",this.onUidChange,this),this.onAnimationPlaying(e))}.bind(this))}.bind(this))}else this.model.set("enable",!1)},isTabHidden:function(){return document[this._hidden]},tabChange:function(){this.model.get("enable")&&(Object(cd.b)()?Kh.a.hide():(Kh.a.show(),this._hasAnim&&this._featureAnimationModel?this.onAnimationPlaying(this._featureAnimationModel):Kh.a.forcePlay(!0),this.updatePositionAndTime(this.model.get("playing")),Kh.a.update()))},animationTimeSync:function(){if(Kh.a.canPlay()&&this._featureAnimationModel){var e=this.getTimeFromAnimationProgress();e!==this._currentSimulationTime&&(this._currentSimulationTime=e,this.updatePositionAndTime(this._featureAnimationModel.get("playing")))}},updatePositionAndTime:function(e){if(Kh.a.canPlay())for(var t=this._viewer.getFeaturesManager&&this._viewer.getFeaturesManager(),n=0,i=this._soundObjects.length;n<i;n++){var r=this._soundObjects[n];t&&this.onSoundPositionChange(r.getModel()),r.setTime(this._currentSimulationTime,e)}},onAnimationPlaying:function(e){if(1===this._featureAnimationModel.get("speed")){var t=e.get("playing");this.model.set("playing",t),t?this.play():this.pause()}else Kh.a.setWaiting(!0)},onUidChange:function(e){"-1"===e.get("currentUID")?this.pause():e.get("playing")&&this.play()},getTimeFromAnimationProgress:function(){var e=this._featureAnimationModel.getCurrentAnimation();if(!e)return 0;var t=e.get("duration");return this._featureAnimationModel.get("progress")*t/100},onAnimationTimeSeek:function(){this._currentSimulationTime=this.getTimeFromAnimationProgress()},displayAnimationSpeedWarning:function(){Kh.a.getProxyModel().trigger("sound-show","Warning. Changing the animation speed will not change the sound speed. This can lead to unexpected sound playback issues",{position:"top",duration:5e3})},onAnimationSpeedChange:function(e){if(1!==e.get("speed")){if(this.pause(),Kh.a.setWaiting(!0),!Object(o.a)())return;this.displayAnimationSpeedWarning()}else Kh.a.setWaiting(!1),this.play()},onSoundChange:function(e){e.get("soundObject").updateFromModel(e),V.a.draw()},onSoundPositionChange:function(e){e.get("soundObject").setPositionNormalized(Object(Co.e)(e))},onSoundDistanceChange:function(e){e.get("soundObject").setRefDistanceNormalized(e.get("distance"))},onSoundDistanceMaxPositionChange:function(e){e.get("soundObject").setMaxDistanceNormalized(e.get("distanceMax"))},onSoundTimeChange:function(e){var t=e.get("soundObject"),n=this.getTimeFromAnimationProgress();t.setTime(n,!1)},onSoundVolumeChange:function(e){e.get("soundObject").updateVolume()},onSoundSnapChange:function(e){e.set("snapChanged",!0)},cull:function(){return this._hasAnim&&this._featureAnimationModel&&this.animationTimeSync(),Object(o.a)()&&!this._pauseUpdate&&ld.updateVisibility(),!0},setPauseUpdate:function(e){this._pauseUpdate=e},getNode:function(){return this._nodeFeature},getNodeEditor:function(){return ld.getNodeCamera()},onSelectChanged:function(e){this.model.get("select")!==e&&(this.model.set("select",e),this.model.get("soundtracks").trigger("select",e),V.a.draw())},onAdd:function(e){var t=Kh.a.createSound(e,this.model.get("playing")),n=e.get("distance")<0,i=e.get("distanceMax")<0;(n||i)&&(n&&e.set("distance",0),i&&e.set("distanceMax",0),X.a.getBoxReady().then(function(){var t=X.a.getModelBoxWithDisplacement();n&&e.set("distance",t.radius()),i&&e.set("distanceMax",2*t.radius()),t.center(e.get("position"))}),Object(o.a)()&&(this.onSelectChanged(e),this._hasAnim&&(e.set("sync",!0),1!==this._featureAnimationModel.get("speed")&&this.displayAnimationSpeedWarning()))),e.set("soundObject",t),e.on("change:enable change:ambient change:distanceModel",this.onSoundChange.bind(this)),e.on("change:position ",this.onSoundPositionChange.bind(this)),e.on("change:distance",this.onSoundDistanceChange.bind(this)),e.on("change:distanceMax",this.onSoundDistanceMaxPositionChange.bind(this)),e.on("change:startTime change:loop change:sync",this.onSoundTimeChange.bind(this)),e.on("change:volume",this.onSoundVolumeChange.bind(this)),e.on("change:snap",this.onSoundSnapChange.bind(this)),this._soundObjects.push(t);var r=new h.a(function(e){Object(u.a)().soundPreload?t.whenReady().then(function(){e(t)}):e(t)});if(this._soundPromises.push(r),Object(o.a)()){e.get("ambient")||ld.addIcon(e);var a=this._viewer.getFeatures().animation;if(a){var s=a.getModel();if(s&&1!==s.get("speed")){Kh.a.setWaiting(!0);Kh.a.getProxyModel().trigger("sound-show","Warning. The animation speed is not x1 but sound will play at normal speed. This can lead to unexpected sound playback issues.",{position:"top",duration:5e3})}}}},onRemove:function(e){e===this.model.get("select")&&this.onSelectChanged(),o.a&&ld.removeIcon(e);var t=e.get("soundObject");Kh.a.removeSound(t),this._soundObjects.splice(this._soundObjects.indexOf(t),1)},onEnableChange:function(){this.model.set("playing",this.model.get("enable"))},onPlayingChange:function(){this.model.get("enable")&&(this.model.get("playing")?this.onPlay():this.onPause())},onPlay:function(){if(!Object(cd.b)()){if(!this.model.get("enable"))return this.model.set("playing",!1),void this.pause();Kh.a.setPlaying(!0),Kh.a.canPlay()?Kh.a.forcePlay(!0):Kh.a.featureDetectSoundAuthGestureNeeded()?Kh.a.enableTapRequestPopup():Kh.a.forcePlay(!0),this.updatePositionAndTime(!0)}},onPause:function(){Kh.a.pause(),this.updatePositionAndTime()},play:function(){this.model.get("enable")&&(this.model.set("playing",!0),this.onPlay())},pause:function(){this.model.get("enable")&&(this.model.set("playing",!1),this.onPause())},updateMute:function(e){var t=e.get("mute");Kh.a.setMute(t)},updateVolume:function(e){var t=e.get("volume");t>=0&&(e.set("mute",!1),Kh.a.setMute(!1)),Kh.a.setVolume(t)}})]},fd=i.a.create(dd);fd.prototype.getNode=function(){return this._views[0].getNode()},fd.prototype.getWidgetNode=function(){return this._views[0].getNodeEditor()},fd.prototype.prepareForScreenShot=function(){var e=i.a.prototype.prepareForScreenShot.call(this);return e&&this._views[0].setPauseUpdate(!0),e},fd.prototype.resetAfterScreenShot=function(){i.a.prototype.resetAfterScreenShot.call(this),this._views[0].setPauseUpdate(!1)};var pd=fd,gd=Ni.a.Model.extend({defaults:{availableDisplayView:["Default"],forceSingleSided:!1,materialList:[],materialByUid:{},displayView:"Default",material:void 0,hoverMaterial:void 0,splitType:"3d",texCoord:0,focusMaterial:!Object(o.a)(),highlightOnHover:!Object(o.a)(),autoSelectHoverMaterial:Object(u.a)().autoMaterial,viewerToCanvasRatio:1,referenceShadingType:"lit",uiVisible:!1},init:function(e){this._viewer=e.getViewer(),k.a.getMaterial().then(this.initAvailableView.bind(this))},getMaterialModel:function(){return this._viewer.getFeatures().material.getModel()},getShadingStyleModel:function(){return this._viewer.getFeatures().shadingStyle.getModel()},getPostProcessModel:function(){return this._viewer.getFeatures().postProcess.getModel()},getGroundModel:function(){return this._viewer.getFeatures().ground.getModel()},getCurrentMaterial:function(){return this.getMaterialByUid(this.get("material"))},getCurrentUVs:function(){return this.get("materialList").find(function(e){return e.uid===this.get("material")}.bind(this)).texCoordUnitList},getMaterialByUid:function(e){var t=this.getMaterialModel().getMaterials(),n=t[e],i=n.get("uidUniqueMerged");return i?t[i]:n},initAvailableView:function(){var e=this.get("displayView"),t=this.get("availableDisplayView"),n=this.get("materialList"),i=this.get("materialByUid");this.set("displayView","Default"),t.length=0,t.push("Default"),n.length=0;var r=nn.a.length,a={},o=!1,s=this.getMaterialModel().attributes;for(var u in s){var l=s[u];if(!l.get("uidUniqueMerged")){for(var c={},h=l.getChannels(),d=0;d<r;++d){var p=nn.a[d],g=h[p],m=g.isEffective();g.set("backupJSON",void 0),c[p]=m,a[p]||g.isEnableEffective()&&("DiffuseIntensity"!==p||m)&&(a[p]=!0)}var v=l.get("texCoordUnitList");o=o||v.length>0,void 0===this.get("material")&&this.set("material",u);var _=!1;h.MetalnessPBR.isEnableEffective()?_=h.GlossinessPBR.isEnableEffective():h.SpecularPBR.isEnableEffective()&&(_=h.RoughnessPBR.isEnableEffective());var b={uid:u,name:l.get("name"),texCoordUnitList:v,uidUniqueMerged:l.get("uidUniqueMerged"),uidListUnusedDuplicates:l.get("uidListUnusedDuplicates"),effectiveChannels:c,swapMicrosurface:_};n.push(b),i[u]=b}}a.MetalnessPBR?(delete a.GlossinessPBR,a.RoughnessPBR=!0):a.SpecularPBR&&(delete a.RoughnessPBR,a.GlossinessPBR=!0);for(var S=0;S<r;++S){var y=nn.a[S];a[y]&&t.push(y)}t.push("MatcapFlat"),-1===t.indexOf("NormalMap")&&-1===t.indexOf("BumpMap")||t.push("MatcapDetail");var x=this.getShadingStyleModel();x.get("hasWireframe")&&t.push("Wireframe"),x.get("hasVertexColor")&&x.get("vertexColorEnable")&&(t.push("VertexColor"),x.get("hasVertexAlpha")&&x.get("vertexColorUseAlpha")&&-1!==t.indexOf("Opacity")&&t.push("VertexAlpha")),f.a.hasVertexNormals&&t.push("VertexNormal"),o&&t.push("UVChecker"),this.getPostProcessModel().hasAtLeastOneEffectiveEffect()&&t.push("DefaultNoPostProcess"),this.getGroundModel().get("enable")&&t.push("DefaultNoGround"),f.a.hasBones&&(t.push("Bones"),t.push("BoneWeights")),this.set("referenceShadingType",x.get("type")),this.trigger("change:availableDisplayView"),this.set("displayView",e)},_getCorrectedDisplayView:function(e){var t=this.get("displayView");return!this.get("materialByUid")[e].swapMicrosurface||"RoughnessPBR"!==t&&"GlossinessPBR"!==t?t:"RoughnessPBR"===t?"GlossinessPBR":"RoughnessPBR"},materialHasContentInView2d:function(e){var t=this.getMaterialByUid(e),n=this._getCorrectedDisplayView(e);return t.getChannels()[n]?this.get("materialByUid")[e].effectiveChannels[n]:"Wireframe"===n?t.get("geometryList").length>0:"VertexColor"===n?t.get("hasVertexColor"):"VertexAlpha"===n?t.get("hasVertexAlpha"):!("UVChecker"!==n||!t.get("texCoordUnitList").length)},materialHasTextureInView2d:function(e){var t=this.getMaterialByUid(e),n=this._getCorrectedDisplayView(e),i=t.getChannels()[n];return i?this.get("materialByUid")[e].effectiveChannels[n]&&!!i.getTextureModel():"Wireframe"===n?t.get("geometryList").length>0:"VertexColor"===n?t.get("hasVertexColor"):"VertexAlpha"===n&&t.get("hasVertexAlpha")},hasContentInView2d:function(){return this.materialHasContentInView2d(this.get("material"))},getName:function(){return"Inspector"}}),md=n("GWRS"),vd=n("PNlk"),_d=n.n(vd),bd=n("LTW4"),Sd=n.n(bd),yd=d.a.osg,xd=d.a.osgUtil,Cd=function(e,t){yd.Camera.call(this),this._model=t,this._viewer=e,this._viewerOSGJS=e.getViewerOSGJS(),this.setNodeMask(0),this.setName("Camera 2D"),this.setReferenceFrame(yd.Transform.ABSOLUTE_RF),this.setViewport(new yd.Viewport),yd.vec4.set(this.getClearColor(),.5,.5,1,1),this._manipulatorEnable=!1,this._scale=1,this._zoomCoord=yd.vec2.create();var n=this.getCameraEasing();this._panInterpolator=new xd.DelayInterpolator(2,n),this._zoomInterpolator=new xd.DelayInterpolator(1,n),this.addUpdateCallback(this),this.initGraph()};Cd.prototype=yd.objectInherit(yd.Camera.prototype,{initGraph:function(){var e=yd.StateAttribute.OVERRIDE_ON,t=this.getOrCreateStateSet();t.addUniform(yd.Uniform.createFloat(1,"uDisplay2D")),t.addUniform(yd.Uniform.createInt(0,"uOutputLinear"),e),t.setAttributeAndModes(we.a.DEPTH_DISABLE,e),t.setRenderBinDetails(Se.a.OPAQUE_NO_EARLYZ,"RenderBin"),this._projectedGeometry=new yd.Node,this._projectedGeometry.setName("Projected Geometry");var n=this._projectedGeometry.getOrCreateStateSet();n.addUniform(yd.Uniform.createFloat4(yd.vec4.ONE,"uColor")),n.addUniform(yd.Uniform.createInt(0,"uProjectedWireframe")),this._projectedWireframe=new yd.Node,this._projectedWireframe.setName("Projected Wireframe"),this._projectedWireframe.getOrCreateStateSet().addUniform(yd.Uniform.createInt(1,"uProjectedWireframe")),this._projectedPolygon=new yd.Node,this._projectedPolygon.setName("Projected Polygon"),this._projectedGeometry.addChild(this._projectedPolygon),this._projectedGeometry.addChild(this._projectedWireframe),this._displayTexture=new yd.Node,this._displayTexture.setName("Display Texture"),this._displayTexture.getOrCreateStateSet().setShaderGeneratorName("inspector",e),this._quadTexture=yd.createTexturedQuadGeometry(-.5,-.5,0,1,0,0,0,1,0),this._quadTexture.setName("Texture display 2D"),this._displayTexture.addChild(this._quadTexture),this.addChild(this._displayTexture),this.addChild(this._projectedGeometry),k.a.getModelDisplayed().then(function(){var e=this._viewer.getFeatures(),t=e.environment.getNode();this._quadTexture.setStateSet(t.getStateSet()),e.postProcess.getNodeIn().addChild(this)}.bind(this))},getCameraEasing:function(){return void 0===Object(u.a)().cameraEasing?.8:1-Object(u.a)().cameraEasing},getViewportWidth:function(){return this.getViewport().width()},getViewportHeight:function(){return this.getViewport().height()},_replaceProjectedGeometry:function(e,t,n){e.removeChildren();for(var i=0;i<t.length;++i){var r=t[i],a=new yd.Geometry;a._attributes=r.getAttributes(),a._primitives=r.getPrimitives(),a._QVT=r._QVT,a._QVS=r._QVS,a._listQuantUV=r._listQuantUV,a.setBound(this._quadTexture.getBoundingBox()),a.setStateSet(n),e.addChild(a)}},_updateProjectedGeometry:function(e,t,n,i){if(i.isFulfilled())return this._replaceProjectedGeometry(e,t,n,i);var r=this,a=this._material;i.then(function(){a===r._material&&r._replaceProjectedGeometry(e,t,n,i)})},_updateProjectedPolygon:function(e){this._updateProjectedGeometry(this._projectedPolygon,e.get("geometryList"),e.get("stateSet"),k.a.getModelDisplayed())},_updateProjectedWireframe:function(e){this._updateProjectedGeometry(this._projectedWireframe,e.get("wireframeList"),e.get("stateSetWireframe"),k.a.getWireframeOptimizedSplitCompressed())},setMaterial:function(e,t){this._material=e;var n=e.get("stateSet");this._displayTexture.setStateSet(n);var i="TexCoord"+t,r=i,a=_d.a;if(Object(u.a)().zz){var o="uQUV"+t;r=i+".xy * "+o+".zw + "+o+".xy",a="uniform vec4 "+o+";\n"+a}a=a.replace(/%UV%/g,i).replace(/%UV_UNPACK%/g,r);var s=be.a.getOrCreateShader(a,Sd.a,"inspector-projectedTexCoord"+t,"projectedTexCoord"+t);if(this._projectedGeometry.getOrCreateStateSet().setAttributeAndModes(s),!e.get("texCoordUnitList").length)return this._projectedPolygon.removeChildren(),void this._projectedWireframe.removeChildren();var l=this._quadTexture.getVertexAttributeList(),c="TexCoord"+t;l[c]||(l[c]=l.TexCoord0),this._updateProjectedWireframe(e),this._updateProjectedPolygon(e)},setManipulatorEnable:function(e){this._manipulatorEnable=e},setVisible:function(e){this.setNodeMask(e?_e.a.NO_PICK_NO_SHADOW_CAST:0)},updateOrtho:function(){var e=.5*this._scale,t=e*this.getViewportHeight()/this.getViewportWidth();yd.mat4.ortho(this.getProjectionMatrix(),-e,e,-t,t,-10,10)},onEventStart:function(e){this._lastScale=e.scale||1,this._zoomInterpolator.reset(),this._panInterpolator.reset(),this._isPanning=!0},onEventEnd:function(){this._zoomInterpolator.reset(),this._panInterpolator.reset(),this._isPanning=!1},_registerHoverUV:function(){var e=yd.mat4.create();return function(t){var n=Oa.a.uHoverUV.getInternalArray();"split"===this._model.get("splitType")?(yd.mat4.identity(e),this.getViewport().computeWindowMatrix(e),yd.mat4.multiply(e,e,this.getProjectionMatrix()),yd.mat4.multiply(e,e,this.getViewMatrix()),yd.mat4.invert(e,e),n[0]=t.glX,n[1]=t.glY,yd.vec2.transformMat4(n,n,e),n[0]+=.5,n[1]+=.5,V.a.draw()):n[0]=n[1]=1e6}}(),onEventUpdate:function(e){if(this._registerHoverUV(e),this._isPanning){if(this._panInterpolator.setTarget(e.glX,-e.glY),e.scale){var t=e.scale>this._lastScale?5:10,n=(e.scale-this._lastScale)*t,i=this._zoomInterpolator.getTarget()[0]-n;this._zoomInterpolator.setTarget(i),this._lastScale=e.scale}this.registerFocusZoom(e),V.a.draw()}},onMouseWheel:function(e){this._zoomInterpolator.setTarget(this._zoomInterpolator.getTarget()[0]-Math.sign(e.deltaY)),this.registerFocusZoom(e),V.a.draw()},registerFocusZoom:function(e){var t=this._viewerOSGJS.getCanvasPixelRatio(),n=this.getViewportWidth(),i=this.getViewportHeight(),r=yd.vec2.set(this._zoomCoord,e.canvasX,e.canvasY),a="2d"===this._model.get("splitType")?.5:-.5;r[0]=a+(r[0]*t-n)/n,r[1]=r[1]*t/i-.5},_updateWireframeNodeMask:function(){var e=this._viewer.getOrCreateScene().getWireframeNodes();e.length&&this._projectedWireframe.setNodeMask(e[0].getNodeMask())},update:function(e,t){var n=t.getFrameStamp().getDeltaTime(),i=this.getViewMatrix(),r=this.getViewportWidth(),a=this.getViewportHeight(),o=this._panInterpolator.update(n),s=.1*this._zoomInterpolator.update(n)[0],u=this._scale*(1+s),l=u*this._viewerOSGJS.getCanvasPixelRatio()/r,c=u-this._scale;i[12]+=o[0]*l+this._zoomCoord[0]*c,i[13]-=o[1]*l+this._zoomCoord[1]*c*a/r,this._scale=u,this.updateOrtho(),this._updateWireframeNodeMask();var h=this._model.get("displayView"),d="VertexColor"===h||"VertexAlpha"===h?-1:0;return this._projectedPolygon.setNodeMask(d),!0}});var wd,Td,Md=Cd,Ed=n("a3nb"),Ad=n("R7V+"),Od=n.n(Ad),Rd=n("pBOM"),Pd=n.n(Rd),Id=n("Vq6u"),Nd=n.n(Id),Ld=n("ovGl"),kd=n.n(Ld),Dd=d.a.osg,Fd=d.a.osgAnimation,Vd=Dd.vec3.create(),Bd=function(){};Ed.a.createPrototypeObject(Bd,{enable:!0,linkGeoms:[],cull:function(){var e=Dd.vec3.create();return function(){if(!this.enable)return!0;for(var t=0;t<this.linkGeoms.length;t++){var n=this.linkGeoms[t];Dd.mat4.getTranslation(e,n.userDataMap.startBoneMatrix);var i=n.userDataMap.startUniform.getInternalArray();Dd.vec3.copy(i,e),Dd.mat4.getTranslation(e,n.userDataMap.endBoneMatrix),i=n.userDataMap.endUniform.getInternalArray(),Dd.vec3.copy(i,e)}return!0}}()},"osgShadow","LinkCullCallback");var Ud=function(){Dd.NodeVisitor.call(this),this._visitedNodes={},this._geoStateSet=new Dd.StateSet,this._geoStateSet.setAttributeAndModes(wd||(wd=be.a.getOrCreateShader(Od.a,Pd.a,"debug/skeleton","debugSkeleton"))),this._geoStateSet.setRenderBinDetails(Se.a.DEBUG_2,"RenderBin"),this._linkCullCallback=new Bd};Dd.createPrototypeObject(Ud,Dd.objectInherit(Dd.NodeVisitor.prototype,{setEnable:function(e,t){e?(this._geoStateSet.setAttributeAndModes(we.a.DEPTH_LESS_WRITE,Dd.StateAttribute.OVERRIDE_ON),this._alreadyRun||(this._alreadyRun=!0,this.apply(t)),this._linkCullCallback.enable=e):this._geoStateSet.setAttributeAndModes(we.a.DEPTH_NEVER,Dd.StateAttribute.OVERRIDE_ON)},_setBoneStateSet:function(e){e.setStateSet(this._geoStateSet),e._isSkeleton=!0},_getOrCreateBoneGeometry:function(){return this._geomBone?this._geomBone:(this._geomBone=Dd.createTexturedSphere(),this._setBoneStateSet(this._geomBone),this._geomBone.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this._geomBone)},_getOrCreateBoneBodyGeometry:function(){if(this._geomBoneBody)return this._geomBoneBody;for(var e=new Float32Array(72),t=new Float32Array(72),n=0;n<4;++n){var i=3*n*3*2,r=0===n||1===n?.05:-.05,a=0===n||3===n?.05:-.05,o=0===n||3===n?.05:-.05,s=2===n||3===n?.05:-.05;e[i+3+0]=r,e[i+3+1]=a,e[i+3+2]=.3,e[i+6+0]=o,e[i+6+1]=s,e[i+6+2]=.3;var u=.3;t[i+0]=t[i+3+0]=t[i+6+0]=a*u-u*s,t[i+1]=t[i+3+1]=t[i+6+1]=u*o-r*u,t[i+2]=t[i+3+2]=t[i+6+2]=r*s-a*o,e[i+9+0]=0,e[i+9+1]=0,e[i+9+2]=1,e[i+12+0]=o,e[i+12+1]=s,e[i+12+2]=.3,e[i+15+0]=r,e[i+15+1]=a,e[i+15+2]=.3,u=-.7,t[i+9+0]=t[i+12+0]=t[i+15+0]=a*u-u*s,t[i+9+1]=t[i+12+1]=t[i+15+1]=u*o-r*u,t[i+9+2]=t[i+12+2]=t[i+15+2]=r*s-a*o}this._geomBoneBody=new Dd.Geometry;var l=this._geomBoneBody.getAttributes();l.Vertex=new Dd.BufferArray(Dd.BufferArray.ARRAY_BUFFER,e,3),l.Normal=new Dd.BufferArray(Dd.BufferArray.ARRAY_BUFFER,t,3);var c=new Dd.DrawArrays(Dd.primitiveSet.TRIANGLES,0,e.length/3);return this._geomBoneBody.getPrimitives().push(c),this._setBoneStateSet(this._geomBoneBody),this._geomBoneBody.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this._geomBoneBody},_createBoneLinkGeometry:function(){var e=Dd.vec3.create(),t=Dd.vec3.create();return function(n,i){Dd.mat4.getTranslation(e,n.getMatrixInSkeletonSpace()),Dd.mat4.getTranslation(t,i.getMatrixInSkeletonSpace());var r=new Float32Array(6);r[0]=1;var a=new Float32Array(2);a[0]=0,a[1]=1;var o=new Dd.Geometry,s=o.getAttributes();s.Vertex=new Dd.BufferArray(Dd.BufferArray.ARRAY_BUFFER,r,3),s.BoneIndex=new Dd.BufferArray(Dd.BufferArray.ARRAY_BUFFER,a,1);var u=new Dd.DrawArrays(Dd.primitiveSet.LINES,0,r.length/3);o.getPrimitives().push(u);var l=o.getOrCreateStateSet(),c=Dd.Uniform.createFloat3("uStartPos"),h=Dd.Uniform.createFloat3("uEndPos");return l.addUniform(c),l.addUniform(h),o.userDataMap={},o.userDataMap.startBoneMatrix=n.getMatrixInSkeletonSpace(),o.userDataMap.endBoneMatrix=i.getMatrixInSkeletonSpace(),o.userDataMap.startUniform=c,o.userDataMap.endUniform=h,this._linkCullCallback.linkGeoms.push(o),o}}(),_addBone:function(e,t){var n=new Dd.MatrixTransform,i=e.getMinimumBound().radius()/40;Dd.vec3.set(Vd,i,i,i),Dd.mat4.fromScaling(n.getMatrix(),Vd),n.getOrCreateStateSet().addUniform(Dd.Uniform.createFloat3(e.getOrCreateDebugColor(),"uBoneColor")),n.setName("Debug joint ("+e.getName()+")"),e.addChild(n),n._isControlBone=t,n.addChild(this._getOrCreateBoneGeometry())},_addBoneBody:function(){var e=Dd.vec3.create(),t=Dd.vec3.fromValues(0,0,1),n=Dd.quat.create(),i=Dd.Uniform.createFloat3(Dd.vec3.fromValues(-1,-1,-1),"uBoneColor");return function(r,a,o){var s=new Dd.MatrixTransform,u=Dd.vec3.len(a);Dd.quat.rotationTo(n,t,Dd.vec3.normalize(e,a));var l=s.getMatrix();Dd.vec3.set(e,u,u,u),Dd.mat4.fromRotationTranslationScale(l,n,Dd.vec3.ZERO,e),s.getOrCreateStateSet().addUniform(i);var c="Debug bone ("+r.getName()+", "+o+")";s.setName(c),r.addChild(s),s.addChild(this._getOrCreateBoneBodyGeometry())}}(),_addBoneLink:function(e,t){if(!this._boneLinksNode){this._boneLinksNode=new Dd.MatrixTransform,Dd.mat4.invert(this._boneLinksNode,this._rootBone.getMatrix()),this._rootBone._parents[0].addChild(this._boneLinksNode);var n=this._boneLinksNode.getOrCreateStateSet();n.setAttributeAndModes(Td||(Td=be.a.getOrCreateShader(Nd.a,kd.a,"debug/skeletonWire","debugSkeletonWire"))),n.setRenderBinDetails(Se.a.DEBUG_2,"RenderBin"),this._boneLinksNode.setCullCallback(this._linkCullCallback),this._boneLinksNode._isControlBone=!0}this._boneLinksNode.addChild(this._createBoneLinkGeometry(e,t))},_extractBoneData:function(e){for(var t,n=[],i=e.getChildren(),r=0;r<i.length;++r)if(i[r]instanceof Fd.Bone){var a=i[r],o=a.isSkinning();a.getName().indexOf("_correct")>=0&&(o=a.getChildren()[0].isSkinning()),o?n.push(a):t||(t=a)}return 0===n.length&&t&&n.push(a),n},_epsEqual:function(e,t,n){for(var i=0;i<e.length;i++){var r=e[i],a=t[i];if(Math.abs(r-a)>n)return!1}return!0},_approximateTail:function(){var e=Dd.vec3.create(),t=Dd.vec3.create(),n=Dd.vec3.create(),i=Dd.vec3.create(),r=Dd.vec3.create(),a=Dd.vec3.create();return function(o,s){if(1===s.length)return Dd.mat4.getTranslation(o.userDataMap.tail,s[0].getMatrix()),void(o.userDataMap.tailChild=s[0]);if(s.length>1){var u=.001*o.getMinimumBound().radius();Dd.mat4.getTranslation(o.userDataMap.tail,s[0].getMatrix());for(var l=!0,c=1;c<s.length;c++){var h=s[c];if(Dd.mat4.getTranslation(e,h.getMatrix()),!this._epsEqual(e,o.userDataMap.tail,u)){l=!1;break}}if(l)return void(o.userDataMap.tailChild=s[0])}for(var d,f=o.userDataMap.apexes,p=0,g=0;g<f.length;g++){var m=Dd.vec3.sqrLen(f[g]);m>p&&(d=g,p=m)}if(s.length){var v=o.getBoneParent(),_=o.getMatrixInSkeletonSpace();if(v&&v.userDataMap.tail){var b=v.getMatrixInSkeletonSpace();Dd.vec3.transformMat4(a,v.userDataMap.tail,b),Dd.mat4.getTranslation(e,b),Dd.vec3.sub(a,a,e),Dd.vec3.normalize(a,a)}if(s.length>=1){Dd.vec3.normalize(n,f[d]);for(var S=.95,y=.95,x=void 0,C=void 0,w=0;w<s.length;w++){var T=s[w];Dd.mat4.getTranslation(t,T.getMatrix()),Dd.vec3.normalize(r,t);var M=Dd.vec3.dot(r,n);if(M>S&&(x=T,S=M),v&&v.userDataMap.tail){Dd.vec3.transformMat4(i,t,_),Dd.mat4.getTranslation(e,_),Dd.vec3.sub(i,i,e),Dd.vec3.normalize(i,i);var E=Dd.vec3.dot(i,a);E>y&&(C=T,y=E)}}x?(Dd.mat4.getTranslation(t,x.getMatrix()),Dd.vec3.copy(o.userDataMap.tail,t),o.userDataMap.tailChild=x):C?(Dd.mat4.getTranslation(t,C.getMatrix()),Dd.vec3.copy(o.userDataMap.tail,t),o.userDataMap.tailChild=C):Dd.vec3.copy(o.userDataMap.tail,f[d])}}else Dd.vec3.copy(o.userDataMap.tail,f[d])}}(),_drawBone:function(e){this._addBone(e,!e.isSkinning());var t=e.getChildren();if(t.length){var n=this._extractBoneData(e);e.isSkinning()&&e.userDataMap.apexes&&(e.userDataMap.tail=Dd.vec3.create(),this._approximateTail(e,n),e.userDataMap.tail&&this._addBoneBody(e,e.userDataMap.tail,e.getName()+"_tail"));for(var i=0;i<t.length;i++){var r=t[i];r!==e.userDataMap.tailChild&&t[i]instanceof Fd.Bone&&this._addBoneLink(e,r)}}},apply:function(e){var t=e.getInstanceID();if(!this._visitedNodes[t]){if(this._visitedNodes[t]=!0,e instanceof Fd.Bone){this._rootBone||(this._rootBone=e);var n=e.getName();n&&-1!==n.indexOf("_correct")||this._drawBone(e)}this.traverse(e)}}}),"osgSketchfab","DrawBoneVisitor");var jd=Ud,Gd=d.a.osg,Hd=function(){Gd.NodeVisitor.call(this),this._visible=!0};Gd.createPrototypeObject(Hd,Gd.objectInherit(Gd.NodeVisitor.prototype,{setEnable:function(e,t){this._visible=e,this._visitedNodes={},this._alreadyRun=!0,this.apply(t)},validNodeMask:function(){return!0},apply:function(e){var t=e.getInstanceID();this._visitedNodes[t]||(this._visitedNodes[t]=!0,e._isControlBone&&e.setNodeMask(this._visible?_e.a.NO_PICK_NO_SHADOW:0),this.traverse(e))}}),"osgSketchfab","ShowControlBonesVisitor");var zd=Hd,Wd=d.a.osg,qd=d.a.osgUtil,Xd=d.a.InputGroups,Yd=Wd.vec3.fromValues(.7,.75,.75),Kd={Opacity:!0,AOPBR:!0,CavityPBR:!0},Qd={FeatureName:"inspector",ModelType:gd,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments);var e=this.model;e.bind("change:displayView",this.onDisplayView,this),e.bind("change:material",this.onMaterial,this),e.bind("change:texCoord",this.onTexCoord,this),e.bind("change:splitType",this.onSplitType,this),e.bind("change:viewerToCanvasRatio",this._onViewerToCanvasRatio,this),e.bind("change:forceSingleSided",this.onForceSingleSided,this),e.bind("change:uiVisible",this.onToggle,this),this._viewer=this.options.context.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._inputManager=this._viewer.getInputManager(),this._viewer.bind("resizeCanvas",this._updateSplitView,this),this._nodeInspector=new Wd.Node,this._nodeInspector.setName("Feature - Inspector"),this._normalVisitor=new qd.DisplayNormalVisitor,this._geoColorVisitor=new qd.DisplayGeometryVisitor,this._drawBonesVisitor=new jd,this._showControlBonesVisitor=new zd,this._camera2D=new Md(this._viewer,this.model),Te.a.initInspector(this),Te.a.initInspectorCamera2D(this._camera2D),Te.a.setInspectorInputsEnable(!1),this._matcapJSON={factor:1,color:Wd.vec3.ONE,texture:{uid:"43a40dd3e9c34fc0b7da9cbf07b82ac8"}},k.a.getMaterial().then(this.initAfterMaterials.bind(this)),X.a.getBoxReady().then(this.initNormalVisitor.bind(this))},onToggle:function(){Te.a.setInspectorInputsEnable(this.model.get("uiVisible"))},onForceSingleSided:function(){for(var e=this.model.get("forceSingleSided"),t=this.model.get("materialList"),n=this.getMaterialModel().getMaterials(),i=0;i<t.length;++i){var r=n[t[i].uid],a=r.get("backupCullFace");(void 0!==a||(r.set("backupCullFace",r.get("cullFace")),e))&&(e?r.set("cullFace",Wd.CullFace.BACK):r.set("cullFace",a))}},initAfterMaterials:function(){this._viewer.getFeatures().quality.getModel().bind("updateDynamicResolutionScaling",this._updateSplitView,this)},initNormalVisitor:function(){this._normalVisitor.setScale(.01*X.a.getModelBoxWithDisplacement().radius())},hasDisplayView:function(e){return-1!==this.model.get("availableDisplayView").indexOf(e)},getMaterialModel:function(){return this._viewer.getFeatures().material.getModel()},getOutlineModel:function(){return this._viewer.getFeatures().outline.getModel()},getQualityModel:function(){return this._viewer.getFeatures().quality.getModel()},getShadingStyleModel:function(){return this._viewer.getFeatures().shadingStyle.getModel()},getPostProcessModel:function(){return this._viewer.getFeatures().postProcess.getModel()},getGroundModel:function(){return this._viewer.getFeatures().ground.getModel()},getImageCollection:function(){return this.getMaterialModel().getImageCollection()},getCurrentMaterial:function(){return this.model.getCurrentMaterial()},isOnView2D:function(e){var t=this.model.get("splitType");return"3d"!==t&&("2d"===t||"split"===t&&e.canvasX>.5*this._viewerOSGJS.getCanvasClientWidth())},isTabMaterial:function(){var e=this._viewer.getFeaturesManager();return e&&"materials"===e.getCurrentTabName()},canDisplayOutline:function(){return this.isTabMaterial()||"split"===this.model.get("splitType")},focusCheck:function(e){var t=this.isOnView2D(e);t===this._isView2DEnabled||this._cursorPressed||(this._inputManager.setEnable(Xd.UI_INSPECTOR,t),Object(u.a)().scrollwheel&&(this._inputManager.setEnable(Xd.UI_INSPECTOR_ZOOM,t),this._inputManager.setEnable(Xd.SCENE_INSPECTOR_ZOOM,!t)),this._inputManager.setEnable(Xd.SCENE,!t),this._isView2DEnabled=t)},onMouseMove:function(e){var t,n="split"===this.model.get("splitType")&&this.hitMaterial(e);this._cursorPressed?this.getOutlineModel().trigger("hideOutline"):this.model.get("highlightOnHover")&&this.canDisplayOutline()&&!this._freezeHoverOutline&&(this.isOnView2D(e)||(t=n),this.model.set("hoverMaterial",t),t?this.displayOutline("displayOutlineNoFocus",t):this.getOutlineModel().trigger("hideOutline"))},_freezeOutline:function(e){void 0!==this._timerFreezer&&(window.clearTimeout(this._timerFreezer),this._timerFreezer=void 0),this._freezeHoverOutline=!0;var t=1e3*e,n=this._enableOutline.bind(this);this._timerFreezer=window.setTimeout(n,t)},_enableOutline:function(){this._freezeHoverOutline=!1},_registerHoverUV:function(e,t){var n=Oa.a.uHoverUV.getInternalArray();if("split"===this.model.get("splitType"))if(V.a.draw(),e&&void 0!==e._i3&&t===this.getCurrentMaterial()){var i=e._nodePath[e._nodePath.length-1].getVertexAttributeList()["TexCoord"+this.model.get("texCoord")];if(i){var r=i.getElements(),a=2*e._i1,o=2*e._i2,s=2*e._i3;n[0]=r[a]*e._r1+r[o]*e._r2+r[s]*e._r3,n[1]=r[a+1]*e._r1+r[o+1]*e._r2+r[s+1]*e._r3}else n[0]=n[1]=1e6}else n[0]=n[1]=1e6;else n[0]=n[1]=1e6},hitMaterial:function(e){if(Ce.a.isInitialized()){var t=_e.a.PICK_GEOMETRY_SLOW,n=Ce.a.computeNearestIntersection2D(e.canvasX,e.canvasY,t),i=n&&Ce.a.getMaterialFromHit(n);return this._registerHoverUV(n,i),i&&this.model.get("autoSelectHoverMaterial")&&this.model.set("material",i.get("id")),i}},displayOutline:function(e,t){this.isTabMaterial();var n=this.getOutlineModel();n.set("durationOutline",2),n.set("durationHighlight",2),n.trigger(e,t.get("stateSet"))},onMouseWheel:function(){this.getOutlineModel().trigger("hideOutline"),this._freezeOutline(.25)},onCursorDown:function(){this._cursorPressed=!0},onCursorUp:function(){this._cursorPressed=!1,this._freezeOutline(.25)},autoSelectUV:function(){var e=this.getCurrentMaterial(),t=e.getChannels(),n=this.model.get("displayView");if(t[n]){var i=t[n].getTextureModel();i&&this.model.set("texCoord",i.get("texCoordUnit"))}else{var r=e.get("texCoordUnitList");r.length&&-1===r.indexOf(this.model.get("texCoord"))&&this.model.set("texCoord",r[0])}},onTexCoord:function(){this.updateMaterial(),this.getCurrentMaterial().getChannels().Inspector.set("selectUV",this.model.get("texCoord"))},onMaterial:function(){var e=this.model.previous("material");if(e&&this.model.getMaterialByUid(e).getChannels().Inspector.set("isSelected",!1),this.getCurrentMaterial().getChannels().Inspector.set("isSelected",!0),this.autoSelectUV(),this.updateMaterial(),this.updateVisible2D(),this.canDisplayOutline()){var t=this.model.get("focusMaterial")&&!this.model.get("autoSelectHoverMaterial")?"Focus":"NoFocus";this.displayOutline("displayOutline"+t,this.getCurrentMaterial()),this._freezeOutline(.25)}},updateVisible2D:function(){var e=this.model.get("splitType");this._camera2D.setVisible("3d"!==e&&this.model.hasContentInView2d())},updateMaterial:function(){var e=this.getCurrentMaterial(),t=this.model.get("texCoord");this._camera2D.setMaterial(e,t),"UVChecker"===this.model.get("displayView")&&e.getChannels().Inspector.setTexCoordUnit(t),V.a.draw()},onSplitType:function(){var e=this.model.get("splitType");Oa.a.uSplitView.setFloat("split"===e?1:0),"split"!==e&&this.getOutlineModel().trigger("hideOutline"),this._updateSplitView(),this.updateVisible2D(),V.a.draw()},setupCheckerTexture:function(e){if(!this._checkerImageProxy){var t=this.getImageCollection();this._checkerImageProxy=t.addNewImage({url:n("eAaX"),width:1024,height:1024,id:"skfbUVChecker",name:"UVChecker",internal:!0})}var i=e.setupTextureModel({image:this._checkerImageProxy});return i.updateMultiresTexture(),i},_getDisplayedChannel:function(e,t,n){return!n.swapMicrosurface||"RoughnessPBR"!==t&&"GlossinessPBR"!==t?("Opacity"===t&&e.Opacity.get("invert")&&e.Inspector.set("invert",!0),e[t]):(e.Inspector.set("invert",!0),"RoughnessPBR"===t?e.GlossinessPBR:e.RoughnessPBR)},_getColorProfile:function(e){var t=this.getPostProcessModel().get("sssProfiles")[e.get("profile")-1],n=Wd.vec3.create();return Wd.vec3.add(n,t.strength,t.falloff),Wd.vec3.scale(n,n,.5),n},_updateTextureTransform:function(){this.inspect.set("UVTransforms",this.channel.get("UVTransforms")),this.inspect.set("UVOffset",this.channel.get("UVOffset"))},_setDisplayChannel:function(e,t){e.setInspectorSRGB(t.getSRGB());var n=t.getName();if(t.isEffective()){var i=t.getTextureModel();if(!i){var r=1;if("SubsurfaceScattering"===n)r=1/(nn.a.getBoxFactor("SubsurfaceScattering")*X.a.getModelBoxWithoutDisplacement().radius());"Opacity"===n&&"additive"===t.get("type")&&(r=.5),e.setFactor(t.getFactor()*r)}if("SubsurfaceScattering"===n)e.setColor(this._getColorProfile(t));else if("ClearCoat"===n)e.setColor(t.get("tint"));else{var a=t.getColor&&t.getColor();e.setColor(a||Wd.vec3.ONE)}i&&(e.setTextureModel(t.getTextureModel()),"Opacity"===n&&"alphaMask"===t.get("type")&&e.set("maskThreshold",t.get("factor"))),this._prevChannel&&this._prevChannel.off(null,this._updateTextureTransform),e.set("UVTransforms",t.get("UVTransforms")),e.set("UVOffset",t.get("UVOffset")),t.on("change:UVTransforms",this._updateTextureTransform,{inspect:e,channel:t}),t.on("change:UVOffset",this._updateTextureTransform,{inspect:e,channel:t}),this._prevChannel=t}else Kd[n]||e.setFactor(0)},_setUVChecker:function(e,t){this.setupCheckerTexture(e);var n=this.getCurrentMaterial()===t?this.model.get("texCoord"):t.get("texCoordUnitList")[0];e.setTexCoordUnit(n||0)},_resetChannel:function(e){return e.get("backupJSON")?e.setChannelJSON(e.get("backupJSON"),this.getImageCollection()):e.set("backupJSON",Object(md.a)(e.getJSON())),e},_resetState:function(){var e=this.getShadingStyleModel();e.set("type",this.model.get("referenceShadingType")),this.hasDisplayView("VertexColor")&&e.set("vertexColorEnable",!0),this.hasDisplayView("VertexAlpha")&&e.set("vertexColorUseAlpha",!0);for(var t=this.model.get("materialList"),n=this.getMaterialModel().getMaterials(),i=0;i<t.length;++i){var r=n[t[i].uid].getChannels();this._resetChannel(r.Inspector),this._resetChannel(r.Displacement),this._resetChannel(r.Opacity),this._resetChannel(r.Matcap),this._resetChannel(r.BumpMap),this._resetChannel(r.NormalMap),r.Opacity.isEffective()||r.Opacity.set("enable",!1)}},onDisplayView:function(){var e=this.model.get("displayView");if(-1!==this.model.get("availableDisplayView").indexOf(e)){this._resetState();for(var t=this.getShadingStyleModel(),n="Default"===e||"DefaultNoPostProcess"===e,i="UVChecker"===e,r="Wireframe"===e,a="VertexColor"===e,o="VertexAlpha"===e,s="VertexNormal"===e,u="Opacity"===e,l="MatcapFlat"===e,c="MatcapDetail"===e,h="Bones"===e,d="BoneWeights"===e,f=this.getMaterialModel().getMaterials(),p=this.model.get("materialList"),g=0;g<p.length;++g)if(!n&&!s){var m=p[g],v=f[m.uid],_=v.getChannels(),b=_.Inspector;b.setTextureModel(void 0);var S=_.Opacity;if(S.isEffective()&&"refraction"===S.get("type")&&S.set("type","alphaBlend"),i)this._setUVChecker(b,v);else if(r)b.setColor(Yd);else if(o)S.set("enable",!1);else if(!a)if(l||c||h||d)l&&(_.BumpMap.set("enable",!1),_.NormalMap.set("enable",!1)),(h||d)&&(_.Opacity.set("enable",!0),_.Opacity.set("factor",.1),_.Opacity.set("type","additive")),_.Matcap.setChannelJSON(this._matcapJSON);else{var y=this._getDisplayedChannel(_,e,m);this._setDisplayChannel(b,y),y===_.Displacement?_.Displacement.set("enable",!1):y===S&&S.set("enable",!1)}}o?Oa.a.uInspectorView.setInt(1):h||d?Oa.a.uInspectorView.setInt(2):Oa.a.uInspectorView.setInt(0),this.updateVisible2D(),this.autoSelectUV();var x=this._viewer.getRootModel();this._normalVisitor.setNormalVisibility(s,x),Oi.setDebugNormal(s),this._drawBonesVisitor.setEnable(h||d,x),this._showControlBonesVisitor.setEnable(h&&!d,x),Oi.setDebugSkeleton(h||d),d?this._geoColorVisitor.setSkinningDebug(x):this._geoColorVisitor.disableDebug(x),this.hasDisplayView("VertexColor")&&t.set("vertexColorEnable",a||o||n),this.hasDisplayView("VertexAlpha")&&t.set("vertexColorUseAlpha",!o&&!u),r?(this._backupWireframeEnable=t.get("wireframeEnable"),this._backupWireframeColor=t.get("wireframeColor"),t.set("wireframeColor","000000FF"),t.set("wireframeEnable",!0)):this._backupWireframeColor&&(t.set("wireframeColor",this._backupWireframeColor),t.set("wireframeEnable",this._backupWireframeEnable),this._backupWireframeColor=void 0),l||c||h||d?t.set("type","matcap"):n||s||t.set("type","inspector"),this.hasDisplayView("DefaultNoPostProcess")&&this.getPostProcessModel().set("enable","Default"===e),this.hasDisplayView("DefaultNoGround")&&this.getGroundModel().set("enable","Default"===e),V.a.draw()}else console.error("Unknown display view : "+e)},_onViewerToCanvasRatio:function(){this._updateViewports(),V.a.draw()},_updateViewports:function(){var e=this._viewer.getFeatures(),t=this._viewer.getCamera(),n=e.postProcess.getCamera().getViewport(),i=this._camera2D.getViewport(),r=t.getViewport(),a=r.width(),o=r.height(),s=this.getQualityModel().get("dynamicResolutionScaling"),u=Math.round(a*s[0]),l=Math.round(o*s[1]),c=this.model.get("splitType"),h="split"===c;h?(n.setViewport(0,0,u>>1,l),i.setViewport(a>>1,0,a>>1,o)):"2d"===c?(n.setViewport(0,0,1,1),i.setViewport(0,0,a,o)):(n.setViewport(0,0,u,l),i.setViewport(0,0,0,0));var d=h?.5:1;d*=this.model.get("viewerToCanvasRatio");var f=t.getProjectionMatrix();f[0]=f[5]*l/(u*d)},_updateSplitView:function(){var e=this.getQualityModel(),t=this.model.get("splitType"),n=1,i=1;"split"===t?n=.5:"2d"===t&&(n=0,i=0);var r=e.get("dynamicResolutionScaling");this._updateViewports(),this._viewer.trigger("resizeRatio",n,i,r[0],r[1])}})]},Jd=i.a.create(Qd);Jd.prototype.getNode=function(){return this._views[0]._nodeInspector};var Zd=Jd,$d=Ni.a.Model.extend({defaults:{enable:Object(u.a)().arkit}}),ef=d.a.osg,tf=ef.mat4.fromRotation(ef.mat4.create(),.5*Math.PI,ef.vec3.fromValues(1,0,0)),nf=ef.mat4.fromRotation(ef.mat4.create(),.5*-Math.PI,ef.vec3.fromValues(1,0,0)),rf=function(){window.updateARKit=this._onARKitEvent.bind(this),this._cameraListeners=[],this._planeListeners=[]};rf.prototype={update:function(){if(!this._lastARKitData)return!0;for(var e=0;e<this._cameraListeners.length;e++)this._cameraListeners[e].onCameraChange(this._lastARKitData.camera,this._lastARKitData.projection);if(this._lastARKitData.planes.length)for(var t=0;t<this._planeListeners.length;t++)this._planeListeners[t].onPlanesChange(this._lastARKitData.planes);return!0},_onARKitEvent:function(e){this._lastARKitData=e},getCameraMatrix:function(e,t){ef.mat4.multiply(e,t,nf)},getMatrixTransformFromARPlane:function(){var e=ef.vec3.create(),t=ef.mat4.create();return function(n,i){ef.vec3.set(e,i.center[0],i.center[1],i.center[2]),ef.mat4.fromTranslation(n,e),ef.mat4.multiply(n,i.transform,n);var r=ef.vec3.set(e,i.extent[0],1,i.extent[2]);ef.mat4.multiply(n,n,ef.mat4.fromScaling(t,r)),ef.mat4.multiply(n,tf,n)}}(),addCameraListener:function(e){this._cameraListeners.push(e)},addPlaneListener:function(e){this._planeListeners.push(e)}};var af=new rf,of=d.a.osg,sf=function(e){this._camera=e,this._prevFrame={valid:!1,position:of.mat4.create(),direction:of.mat4.create(),speed:-1,at:-1}};sf.prototype={onCameraChange:function(e,t){return!e||!t||(af.getCameraMatrix(this._camera.getViewMatrix(),e),of.mat4.copy(this._camera.getProjectionMatrix(),t),!0)}};var uf=sf,lf=function(e){n.e(166).then(function(){e(n("pwm4").default)}.bind(null,n)).catch(n.oe)},cf=d.a.osg,hf=cf.createTexturedQuadGeometry(-.5,0,0,1,0,0,0,1,0),df=cf.vec3.fromValues(0,0,1),ff=cf.vec3.create(),pf=cf.vec3.create(),gf=cf.mat4.create(),mf=function(e){cf.MatrixTransform.call(this),this._camera=e;var t=cf.Uniform.createFloat1(.7,"uAlpha");this._uAlpha=t.getInternalArray();var n=hf.getOrCreateStateSet();n.setRenderBinDetails(Se.a.EDITOR_GIZMO,"RenderBin"),n.setAttributeAndModes(we.a.DEPTH_LESS_NO_WRITE),n.addUniform(t),n.setAttributeAndModes(be.a.getOrCreateShader(ph.a,mh.a,"AR-Elevation-Widget","ARElevation")),this.addChild(hf),this.addUpdateCallback(this),this.setNodeMask(0)};cf.createPrototypeNode(mf,cf.objectInherit(cf.MatrixTransform.prototype,{setVisible:function(e,t){e!==this._visible&&(t||(t=.01),this._delay=t,this._visible=e,e&&this.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this._isFading=!0)},update:function(e,t){var n=t.getFrameStamp();if(this._time=n.getSimulationTime(),this._updateTransforms(),this._isFading)return this._updateFading(),!0},_updateTransforms:function(){if(this._anchorPoint){var e=this.getMatrix();cf.mat4.invert(gf,this._camera.getViewMatrix()),cf.mat4.getTranslation(ff,gf),ff[2]=this._anchorPoint[2],cf.mat4.lookAt(e,this._anchorPoint,ff,df),cf.mat4.invert(e,e),cf.mat4.setTranslation(e,this._anchorPoint);var t=cf.vec3.length(cf.vec3.subtract(ff,ff,this._anchorPoint));cf.mat4.scale(e,e,cf.vec3.set(pf,.01*t,this._elevation,1))}},_updateFading:function(){this._startTime||(this._startTime=this._time);var e=this._time-this._startTime;e<this._delay?this._visible?this._uAlpha[0]=e/this._delay*.7:this._uAlpha[0]=.7*(1-e/this._delay):(this._visible||this.setNodeMask(0),this._startTime=0,this._isFading=!1)},setAnchorAndElevation:function(e,t){this._anchorPoint=e,this._elevation=t}}),"osgSketchfab","ElevationWidget");var vf=mf,_f=n("4ANv"),bf=n("Xr/U"),Sf=n.n(bf),yf=n("MCYI"),xf=n.n(yf),Cf=new Zo.a({device:"VWR",listen:!0}),wf=d.a.osg,Tf=1.5,Mf=Tf+.5;Object(u.a)().arkitDebug&&(Tf=200);var Ef=wf.vec3.create(),Af=wf.vec3.create(),Of=wf.vec3.create(),Rf=wf.vec3.create(),Pf=wf.vec3.create(),If=wf.vec3.create(),Nf=wf.vec3.create(),Lf={FeatureName:"ARKit",ModelType:$d,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments),this._viewer=this.options.context.getViewer(),this._featureNode=new wf.MatrixTransform,this._featureNode.setName("Feature - ARKit"),this._arSceneNode=new wf.MatrixTransform,this._arSceneNode.setName("ARKit - Scene"),this._featureNode.addChild(this._arSceneNode),k.a.getModelDisplayed().then(this.onEnable.bind(this))},initGraphNode:function(){this._elevationWidget=new vf(this._viewer.getCamera()),this._proxyNode=new wf.Node,this._proxyNode.setName("ARKit - Widget-Shadows"),this._proxyNode.setNodeMask(_e.a.NO_SHADOW),this._widgetNode=new wf.Node,this._widgetNode.setName("ARKit - Widget");var e=this._widgetNode.getOrCreateStateSet();this._createWidgetStateSet(e);var t=wf.Uniform.createFloat(.35,"uAlpha");e.addUniform(t),this._uAlpha=t.getInternalArray(),e.setTextureAttributeAndModes(0,ji.a.dummyTexture,wf.StateAttribute.OVERRIDE),this._featureNode.addChild(this._proxyNode),this._proxyNode.addChild(this._widgetNode),this._shadowPlaneNode=new wf.MatrixTransform,this._shadowPlaneNode.setName("ARKit - ShadowPlane"),(e=this._proxyNode.getOrCreateStateSet()).setShaderGeneratorName("shadow-ar"),this._setCommonStateSet(e)},_setCommonStateSet:function(e){e.setRenderBinDetails(Se.a.EXTRA,"RenderBin"),e.setAttributeAndModes(we.a.CULL_DISABLE),e.setAttributeAndModes(we.a.BLEND_SUBSTRACTIVE),e.setAttributeAndModes(we.a.DEPTH_LESS_NO_WRITE)},_createWidgetStateSet:function(e){var t=be.a.getOrCreateShader(Sf.a,xf.a,"plane","ArPlane");return e.setAttributeAndModes(t),this._setCommonStateSet(e),e.addUniform(wf.Uniform.createInt(0,"uTextureIcon")),e.addUniform(wf.Uniform.createFloat(0,"uDisplay2D")),e.addUniform(wf.Uniform.createFloat2(wf.vec2.fromValues(1,1),"uScale")),e},enableARShadows:function(e){e?(this._proxyNode.addChild(this._shadowPlaneNode),this._proxyNode.dirtyBound()):(this._proxyNode.removeChild(this._shadowPlaneNode),this._proxyNode.dirtyBound())},_setPlaneTexture:function(e){var t=s.default.instance.getOrCreateTexture(e.SKFB_LOGO,{internalFormat:wf.Texture.RGBA});this._widgetNode.getOrCreateStateSet().setTextureAttributeAndModes(0,t.texture)},_getOrCreatePlaneGeometry:function(){return this._planeGeom||(this._planeGeom=wf.createTexturedQuadGeometry(-.5,0,-.5,1,0,0,0,0,1),this._planeGeom.setName("PlaneGeometry")),this._planeGeom},initEvents:function(){this.model.bind("change:enable",this.onEnable,this),this.model.bind("pick",this.onPick,this),Te.a.initAR(this)},onEnable:function(){if(this.model.get("enable")){this._planeNodes={},this._globalTranslation=wf.vec3.create(),this._globalScale=wf.vec3.fromValues(1,1,1),this._globalRotation=wf.mat4.create(),this._startMat=wf.mat4.create(),this._startPos=wf.vec2.create(),this._curPos=wf.vec2.create(),this._elevation=0,this.initGraphNode(),Cf.on("message:arShadows",function(e){this.enableARShadows(parseInt(e.data.arShadows,10)),e.removeFromHash()}.bind(this)),k.a.getFirstAnimation().then(function(){var e=this._viewer.getFeatures(),t=e.lighting;t.getModel().setPreset("LightFromAbove"),t.getModel().set("enable",!0);var n=e.environment;if(n.getModel().get("enable"))n.getModel().set("shadowEnable",!1);else{var i=s.default.instance.getEnvironmentCollection();if(i.length){var r=i.at(0).get("uid");n.getModel().set("uid",r)}else n.getModel().set("uid","2fa15e0b1cee45a5b02605a288934e1b");n.getModel().set("shadowEnable",!1),n.getModel().set("enable",!0)}e.ground.getModel().set("enable",!1),this.enableARShadows(!0)}.bind(this)),Te.a.setInspectorInputsEnable(!0),this.initEvents(),this._viewer.getViewerOSGJS().requestContinuousUpdate(!0),lf(this._setPlaneTexture.bind(this));var e=this._viewer.getFeatures();e.background.getModel().set("enable","none"),e.postProcess.getModel().set("enable",!1),e.postProcess.getModel().set("AR",!0),e.hotspot.getWidgetNode().setNodeMask(0),e.autospin.getModel().set("enable",!1),this._featureNode.addUpdateCallback(af),this._widgetNode.addUpdateCallback(this),this._widgetNode.addChild(this._elevationWidget),af.addPlaneListener(this),af.addCameraListener(new uf(this._viewer.getCamera())),this._viewer.getViewerOSGJS().requestContinuousUpdate(!0),this._inputManager=this._viewer.getInputManager(),Object(u.a)().arkitDebug?(es()(".viewer").css("background","rgba(125,125,125,255)"),e.camera.getModel().set("indexManipulator",ve.FPS)):(es()(".viewer").css("background","rgba(0,0,0,0)"),this._inputManager.setEnable(_f.a.SCENE,!1)),this._arSceneNode.setNodeMask(0),this._viewer.getCamera().getClearColor()[3]=0,X.a.getBoxReady().then(function(){var e=X.a.getModelBoxWithDisplacement(),t=e.getMin()[2];this._bBoxHeight=e.getMax()[2]-t;var n=1/this._bBoxHeight;wf.vec3.set(this._globalScale,n,n,n),this._invAnchorPoint=e.center(wf.vec3.create()),this._invAnchorPoint[2]=t,wf.vec3.negate(this._invAnchorPoint,this._invAnchorPoint),Object(u.a)().arkitDebug&&(this._viewer.getFeaturesManager().focusOnTargetAndEye(wf.vec3.fromValues(0,0,0),wf.vec3.fromValues(5,5,2),.1),this.onPlanesChange([{uid:"123",transform:wf.mat4.IDENTITY,center:wf.vec3.ZERO,extent:wf.vec3.fromValues(10,1,10)}]));var i=e.radius()*n;this._shadowPlaneGeom=wf.createTexturedQuadGeometry(-i,-i,0,2*i,0,0,0,2*i,0),this._shadowPlaneNode.addChild(this._shadowPlaneGeom),this._shadowPlaneNode.dirtyBound()}.bind(this))}},getFeatureNode:function(){return this._featureNode},getWidgetNode:function(){return this._widgetNode},getArSceneNode:function(){return this._arSceneNode},update:function(e,t){var n=t.getFrameStamp();if(this._time=n.getSimulationTime(),this._modelPlaced){var i=this._time-this._hitTime;return i<.5&&(this._uAlpha[0]=i/.5*.35),i>Tf&&i<Mf&&(this._uAlpha[0]=.35*(1-(i-Tf)/.5)),!0}},onPick:function(e){var t=Ce.a.computeNearestIntersection2D(e[0],e[1],_e.a.PICK_GEOMETRY_FAST,this._widgetNode);this._hitTime=this._time,t&&(this._modelPlaced=!0,wf.vec3.transformMat4(this._globalTranslation,t._localIntersectionPoint,wf.computeLocalToWorld(t._nodePath.slice(1))),this._arSceneNode.setNodeMask(-1),this._updateSceneTransforms(),window.location.hash="buzz",window.setTimeout(function(){window.location.hash=""},200))},_updateSceneTransforms:function(){var e=this._arSceneNode.getMatrix();wf.mat4.fromTranslation(e,this._globalTranslation),wf.mat4.multiply(e,e,this._globalRotation),wf.mat4.scale(e,e,this._globalScale),wf.mat4.translate(e,e,this._invAnchorPoint),wf.mat4.translate(e,e,wf.vec3.set(Ef,0,0,this._elevation));var t=this._elevation>=0?this._bBoxHeight:0;this._elevationWidget.setAnchorAndElevation(this._globalTranslation,(this._elevation+t)*this._globalScale[0]);var n=this._shadowPlaneNode.getMatrix();wf.mat4.fromTranslation(n,this._globalTranslation);for(var i=this._viewer.getFeatures().lighting.getModel().get("lights"),r=0;r<i.length;r++){var a=i[r];a.isCastingShadows()&&a.dirty()}this._arSceneNode.dirtyBound(),this._shadowPlaneNode.dirtyBound()},_getPlaneNode:function(e){var t=this._planeNodes[e];if(!t){this._hitTime=this._time,(t=new wf.MatrixTransform).addChild(this._getOrCreatePlaneGeometry());var n=t.getOrCreateStateSet(),i=wf.Uniform.createFloat2(wf.vec2.fromValues(1,1),"uScale");n.addUniform(i),t._uScale=i.getInternalArray(),this._planeNodes[e]=t}return t},onPlanesChange:function(e){for(var t in this._planeNodes){var n=this._planeNodes[t];n.updated=!1}for(var i,r=0;r<e.length;r++){var a=e[r];i=this._getPlaneNode(a.uid),af.getMatrixTransformFromARPlane(i.getMatrix(),a),i._uScale[0]=a.extent[0],i._uScale[1]=a.extent[2],0===i.getParents().length&&this._widgetNode.addChild(i),i.updated=!0,i.dirtyBound()}for(t in this._planeNodes)!(n=this._planeNodes[t]).updated&&i.getParents().length&&this._widgetNode.removeChild(n);this._widgetNode.dirtyBound()},startMotion:function(e){this._inputManager.setEnable(_f.a.MANIPULATORS,!1),wf.vec2.set(this._startPos,e.canvasX,e.canvasY)},endMotion:function(){this._inputManager.setEnable(_f.a.MANIPULATORS,!0),this.endElevate(),this.endRotate(),this.endScale()},motion:function(e){if(this._rotating)this.rotate(e);else if(this._scaling){wf.vec2.set(this._curPos,e.canvasX,e.canvasY);var t=this._viewer.getCanvas().height,n=1-(this._curPos[1]-this._startPos[1])/t;e.scale=n,this.scale(e)}else this._elevating&&this.elevate(e)},startRotate:function(e){this._rotating=!0,wf.vec2.set(this._startPos,e.canvasX,e.canvasY),wf.mat4.copy(this._startMat,this._globalRotation)},endRotate:function(){this._rotating=!1},rotate:function(e){this._rotating||this.startRotate(e),wf.vec2.set(this._curPos,e.canvasX,e.canvasY);var t=this._viewer.getCanvas().width,n=(this._curPos[0]-this._startPos[0])/t*Math.PI*2;wf.mat4.rotateZ(this._globalRotation,this._startMat,n),this._updateSceneTransforms()},startScale:function(){this._scaling=!0,this._initScale=this._globalScale[0]},endScale:function(){this._scaling=!1},scale:function(e){var t=Math.max(e.scale*this._initScale,1e-8);wf.vec3.set(this._globalScale,t,t,t),this._updateSceneTransforms()},startElevate:function(e){this._elevating=!0,this._initElevation=this._elevation,wf.vec2.set(this._startPos,e.glX,e.glY),this._startWorldElevation=this._getElevationFromScreenCoord(this._startPos),this._elevationWidget.setVisible(!0,.5),this._hitTime=this._time},endElevate:function(){this._elevating=!1,this._elevationWidget.setVisible(!1,.5)},elevate:function(e){this._elevating||this.startElevate(e),wf.vec2.set(this._curPos,e.glX,e.glY);var t=this._getElevationFromScreenCoord(this._curPos)-this._startWorldElevation;this._elevation=this._initElevation+t,this._elevation<0&&(this._elevation=0),this._updateSceneTransforms()},_getElevationFromScreenCoord:function(e){wf.vec2.copy(Of,e),Of[2]=0,Ce.a.getWorldPositionFromScreenPoint(Of,Rf),Of[2]=1,Ce.a.getWorldPositionFromScreenPoint(Of,Pf),wf.vec3.sub(Nf,Pf,Rf),wf.vec3.normalize(Nf,Nf),wf.mat4.getLookAt(If,Ef,Af,this._viewer.getCamera().getViewMatrix()),wf.vec3.subtract(If,If,Ef),If[2]=0,wf.vec3.normalize(If,If),wf.mat4.getTranslation(Ef,this._featureNode.getMatrix());var t=wf.vec3.length(this._globalTranslation),n=wf.vec3.dot(If,Nf),i=-(wf.vec3.dot(If,Rf)+t)/n;return 0===n&&(i=0),wf.vec3.scaleAndAdd(Ef,Rf,Nf,i),Ef[2]/this._globalScale[0]}})]},kf=i.a.create(Lf);kf.prototype.getNodeIn=function(){return this._views[0].getFeatureNode()},kf.prototype.getNodeOut=function(){return this._views[0].getArSceneNode()},kf.prototype.getWidgetNode=function(){return this._views[0].getWidgetNode()};var Df=kf,Ff=n("8eYQ"),Vf=a.a.extend({_trashbin:[],defaults:{progress:0},getModelOptionPath:function(){return"ground"},getName:function(){return"Ground"},init:function(e){var t=e.getModel().get("options");this._globalModel=e.getModel(),this.setJSON(t.ground);var n=this.get("aoTextureUid"),i=!1;if(n){var r=s.default.instance.getTextureCollection().get(n);r&&(r.set("internal",!0),i=!0)}"BakedAO"!==this.get("shadowMode")||i||(this.set("enable",!1),n?(console.log("Ground: Couldn't load texture "+n+" for model "+e._model.id),Ff.a.client.captureMessage("Ground: Couldn't load texture "+n+" for model "+e._model.id)):Ff.a.client.captureMessage("Ground: Model "+e._model.id+" is in BakedAO mode but doesn't have an aoTextureUid"))},_adaptJSON:function(e){if(void 0===e.scale){e.scale=0,e.position=[0,0,0];var t=1.5,n=0;void 0!==e.size&&(t=e.size,n=e.height),X.a.getBoxReady().then(this._updateTransforms.bind(this,n,t,!0))}},_updateTransforms:function(e,t,n){var i=X.a.getModelBoxWithDisplacement();"BakedAO"===this.get("shadowMode")&&(t=1.5);var r=i.radius()*t;this.set("scale",r),0===e&&(e=1e-4);var a=this.get("position");i.center(a);var o=i.getMax()[2]-i.getMin()[2];a[2]=i.getMin()[2]+o*e,n?this.trigger("transformInit"):this.trigger("transformChanged")},startRender:function(){this._globalModel.trigger("status:pending")},stopRender:function(){this._globalModel.trigger("status:loaded")}}),Bf=n("NNol"),Uf=n("EJ86"),jf=n.n(Uf),Gf=n("OT+x"),Hf=n.n(Gf),zf=n("Q7lG"),Wf=n.n(zf),qf=d.a.osgShader.shaderProcessor,Xf=d.a.osgUtil,Yf=d.a.osg,Kf=function(e,t,n,i,r){this._textureSize=e,this._nodeFeature=t,this._viewer=n,this._nbFrames=0,this._targetNode=i,this._nbSamples=r||300,this._progress=0,this._samplingRange=1,this._validRender=!1,this._renderedCanvas=document.createElement("canvas"),this._init()};Kf.prototype={_init:function(){this.initComposer(),this.initShadowCamera(),this.initLightMapCamera(),this._nodeFeature.addChild(this._shadowCamera),this._nodeFeature.addChild(this._lightMapCamera),this._nodeFeature.addChild(this._composer),this._nodeFeature.addUpdateCallback(this)},getFinalTexture:function(){return this._render?this._currentlightMap:this._composer.getInternalTexture("FinalTexture1")},requestRender:function(){this._render&&this.stopRender(),this._shadowCamera.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this._lightMapCamera.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this._render=!0,V.a.draw()},onFrameRendered:function(e){this._frameCallback=e},stopRender:function(){this._render&&(this._nbFrames=0,this._render=!1,this._progress=0,this._shadowCamera.setNodeMask(0),this._lightMapCamera.setNodeMask(0),this._composer.setNodeMask(0))},update:function(e,t){if(!this._render||!k.a.getModelDisplayed().isFulfilled())return!0;var n=t.getFrameStamp();return this._estimatedTime=n.getDeltaTime()*this._nbSamples,this._nbFrames>this._nbSamples&&(this._shadowCamera.setNodeMask(0),this._lightMapCamera.setNodeMask(0),this._composer.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this._getLastComposerCamera().setFinalDrawCallback(function(e){this._renderedCanvas=Object(Bf.b)(e,this._textureSize,this._textureSize,this._renderedCanvas)}.bind(this))),this._nbFrames>this._nbSamples+1?(this._validRender=!0,this.stopRender(),this._progress=100,this._frameCallback&&this._frameCallback(!0),this._getLastComposerCamera().setFinalDrawCallback(void 0),!0):(this._nbFrames++,this._uNumFrames.getInternalArray()[0]=this._nbFrames,this.updateCameras(),V.a.draw(),this.swapLightMaps(),this._frameCallback&&this._frameCallback(),this._progress=this._nbFrames/this._nbSamples*100,!0)},getRenderedCanvas:function(){return this._renderedCanvas},isValidRender:function(){return this._validRender},getProgress:function(){return this._progress},getEstimatedTime:function(){return this._estimatedTime},setNbSamples:function(e){this._nbSamples=e},initComposer:function(){this._composer=new Xf.ComposerPostProcess,this._composer.setOffscreen(!0),this._composer.setScreenSize(this._textureSize,this._textureSize),this._composer.setNodeMask(0),this._composer.addInternalTexture({name:"LightMap1",immuable:!0,srgb:!1,reusable:!1}),this._composer.addInternalTexture({name:"FinalTexture1",immuable:!0,srgb:!1,reusable:!1}),this._composer.setInputTexture("LightMap1"),qf.addShaders({"blurBakedAo.glsl":jf.a});var e=[],t=Yf.Uniform.createFloat(1/this._textureSize,"uInvTextureSize");e.push({func:{name:"adaptativeBoxBlur",file:"blurBakedAo.glsl"},uniforms:[t],textures:{name:"LightMap1",uniformName:"TextureBlur"},out:{name:"FinalTexture1",filter:"linear"}}),this._composer.build(e);for(var n=0;n<this._composer.getCameras().length;n++){this._composer.getCameras()[n].setRenderOrder(Yf.Camera.PRE_RENDER,1)}},_getLastComposerCamera:function(){var e=this._composer.getCameras();return e[e.length-1]},initShadowCamera:function(){this._shadowCamera=new Yf.Camera,this._shadowCamera.setName("ShadowCam"),this._shadowCamera.setClearColor(Yf.vec4.fromValues(1,1,1,1)),this._shadowCamera.setRenderOrder(Yf.Camera.PRE_RENDER,0),this._shadowCamera.setReferenceFrame(Yf.Transform.ABSOLUTE_RF),this._shadowCamera.setViewport(new Yf.Viewport(0,0,this._textureSize,this._textureSize)),this._shadowCamera.setNodeMask(0),this._shadowCamera.setComputeNearFar(!1);var e=new Yf.Texture;e.setTextureSize(this._textureSize,this._textureSize),e.setMinFilter("LINEAR"),e.setMagFilter("LINEAR"),this._shadowCamera.attachTexture(Yf.FrameBufferObject.COLOR_ATTACHMENT0,e),this._shadowCamera.attachRenderBuffer(Yf.FrameBufferObject.DEPTH_ATTACHMENT,Yf.FrameBufferObject.DEPTH_COMPONENT16);var t=new Yf.MatrixTransform;t.setMatrix(this._viewer.getFeatures().orientation.getModel().get("matrix")),t.addChild(this._viewer.getRootModel()),this._shadowCamera.addChild(t);var n=this._shadowCamera.getOrCreateStateSet();n.setTextureAttributeAndModes(0,e,Yf.StateAttribute.ON),n.setShaderGeneratorName("shadow-ao-bake"),n.setAttributeAndModes(we.a.DEPTH_LESS_WRITE,Yf.StateAttribute.ON|Yf.StateAttribute.OVERRIDE|Yf.StateAttribute.PROTECTED),this._shadowMap=e},initLightMapCamera:function(){this._lightMapCamera=new Yf.Camera,this._lightMapCamera.setName("LightMapCam"),this._lightMapCamera.setClearColor(Yf.vec4.fromValues(1,1,1,1)),this._lightMapCamera.setRenderOrder(Yf.Camera.PRE_RENDER,1),this._lightMapCamera.setReferenceFrame(Yf.Transform.ABSOLUTE_RF),this._lightMapCamera.setViewport(new Yf.Viewport(0,0,this._textureSize,this._textureSize)),this._lightMapCamera.setNodeMask(0),this._lightMapCamera.setComputeNearFar(!1),this._lightMap1=this._composer.getInternalTexture("LightMap1"),this._lightMap1.setMinFilter("LINEAR"),this._lightMap1.setMagFilter("LINEAR"),this._lightMapCamera.attachTexture(Yf.FrameBufferObject.COLOR_ATTACHMENT0,this._lightMap1),this._lightMap2=new Yf.Texture,this._lightMap2.setTextureSize(this._textureSize,this._textureSize),this._lightMap2.setMinFilter("LINEAR"),this._lightMap2.setMagFilter("LINEAR"),this._lightMapCamera.addChild(this._targetNode);var e=this._lightMapCamera.getOrCreateStateSet();e.setAttributeAndModes(be.a.getOrCreateShader(Hf.a,Wf.a,"ground-bakeao","GroundBakeAo"),Yf.StateAttribute.ON|Yf.StateAttribute.OVERRIDE|Yf.StateAttribute.PROTECTED),e.setTextureAttributeAndModes(1,this._shadowMap,Yf.StateAttribute.ON),e.addUniform(Yf.Uniform.createInt(1,"uShadowMap")),e.setTextureAttributeAndModes(2,ji.a.dummyTexture,Yf.StateAttribute.ON),e.addUniform(Yf.Uniform.createInt(2,"uPrevLightMap")),this._uNumFrames=Yf.Uniform.createFloat(0,"uNumFrames"),e.addUniform(this._uNumFrames),this._uTextureSize=Yf.Uniform.createFloat(this._textureSize,"uTextureSize"),e.addUniform(this._uTextureSize),this._currentlightMap=this._lightMap2},swapLightMaps:function(){var e=this._lightMapCamera.getOrCreateStateSet();this._currentlightMap&&e.setTextureAttributeAndModes(2,this._currentlightMap,Yf.StateAttribute.ON),this._currentlightMap===this._lightMap1?this._currentlightMap=this._lightMap2:this._currentlightMap=this._lightMap1,e.setTextureAttributeAndModes(0,this._currentlightMap,Yf.StateAttribute.ON),this._lightMapCamera.attachTexture(Yf.FrameBufferObject.COLOR_ATTACHMENT0,this._currentlightMap)},setSceneData:function(e,t){this._bounds=e,this._transform=t},updateCameras:function(){var e=Yf.mat4.create(),t=Yf.vec3.create(),n=Yf.vec3.create();return function(){var i=this._bounds.radius();Yf.mat4.getTranslation(t,this._transform.getMatrix()),Yf.mat4.copy(e,Yf.mat4.IDENTITY),this.getRandomPoint(n),Yf.vec3.scale(n,n,i),Yf.vec3.add(n,t,n),Yf.mat4.lookAt(e,n,t,[0,0,1]);var r=2*i,a=r/1e3;Yf.mat4.ortho(this._shadowCamera.getProjectionMatrix(),-i,i,-i,i,a,r),Yf.mat4.copy(this._shadowCamera.getViewMatrix(),e),Yf.mat4.copy(this._lightMapCamera.getViewMatrix(),this._shadowCamera.getViewMatrix()),Yf.mat4.copy(this._lightMapCamera.getProjectionMatrix(),this._shadowCamera.getProjectionMatrix())}}(),getRandomPoint:function(e){var t=yr.a.hemisphereSampleUniform(this._nbFrames,this._nbSamples*(1/this._samplingRange));Yf.vec3.set(e,t[0],t[1],t[2])}};var Qf=Kf,Jf=d.a.osg,Zf=function(e,t){Jf.StateAttribute.call(this),this._enable=t||!1,this._useBakedAo="BakedAO"===e,this._displayPlane=!1};Zf.prototype=Jf.objectLibraryClass(Jf.objectInherit(Jf.StateAttribute.prototype,{attributeType:"GroundStateAttribute",cloneType:function(){return new Zf(!0)},setEnabled:function(e){this._enable=e},isEnabled:function(){return this._enable},isUseBakedAo:function(){return this._useBakedAo},setDisplayPlane:function(e){this._displayPlane=e},isDisplayPlane:function(){return this._displayPlane},getHash:function(){return"Ground"+this._useBakedAo+this._displayPlane}}),"osgSketchfab","GroundStateAttribute"),Jf.setTypeID(Zf);var $f={FeatureName:"ground",ModelType:Vf,ViewListType:[D.a.extend({initialize:function(){D.a.prototype.initialize.apply(this,arguments);var e=this.model;this.listenTo(e,"change:enable",this.onEnableChanged),this._resourceDefer=new it.a,this.options.context.getScene().addResourcePromise(this._resourceDefer.promise),this._nodeFeature=new Jf.Node,this._nodeFeature.setName("Feature - Ground"),this._transform=new Jf.MatrixTransform,this._transform.setName("Ground - Transform"),this._transform.setNodeMask(_e.a.NO_PICK_NO_SHADOW),this._geometry=Jf.createTexturedQuadGeometry(-1,-1,0,2,0,0,0,2,0),this._geometry.setName("Ground - Geometry"),this._geometry.setNodeMask(0),this._transform.addChild(this._geometry),this._viewer=this.options.context.getViewer(),this._needBake=!1;var t=this._transform.getOrCreateStateSet();this._uFade=Jf.Uniform.createFloat("uGroundFade"),this._uOpacity=Jf.Uniform.createFloat("uGroundOpacity");var n=Jf.Uniform.createFloat(1,"uWidgetFade");t.addUniform(this._uFade),t.addUniform(this._uOpacity),t.addUniform(n),this._uWidgetFade=n.getInternalArray(),this._widgetFadeDirection=1,e.get("enable")&&this.onEnableChanged(),this.model.set("lastRenderHeight",this.model.get("height")),this.model.set("lastRenderSamplingRange",this.model.get("samplingRange")),this._nodeFeature.addUpdateCallback(this),e.get("enable")&&"BakedAO"===e.get("shadowMode")||this._resourceDefer.resolve()},registerEvents:function(){this.listenTo(this.model,"change:opacity",this.onOpacityChanged),this.listenTo(this.model,"change:fade",this.onFadeChanged),this.listenTo(this.model,"transformChanged",this._onTransformChanged),this.listenTo(this.model,"transformInit",this._onPositionOrScaleChange),this.listenTo(this.model,"change:shadowMode",this.onShadowModeChanged),this.listenTo(this.model,"change:samplingRange",this.onSamplingRangeChanged),this.listenTo(this.model,"cancelRequested",this.cancelRender)},unRegisterEvents:function(){this.stopListening(this.model),this.listenTo(this.model,"change:enable",this.onEnableChanged)},initStateSet:function(){var e=this._geometry.getOrCreateStateSet();e.setName("Ground"),e.setShaderGeneratorName("ground"),e.setRenderBinDetails(Se.a.TRANSPARENT_CUSTOM_EARLYZ,"RenderBin"),e.setAttribute(we.a.CULL_BACK),this._initialized=!0},onShadowModeChanged:function(){var e=this._geometry.getOrCreateStateSet(),t=this.model.get("shadowMode"),n="BakedAO"===t;if(this._geometry.setNodeMask(0),this._groundStateAttrib=new Zf(t,!0),e.setAttributeAndModes(this._groundStateAttrib),this.cleanUpTexture(this._lightMapper,e),n){var i=this.model.get("aoTextureUid");i&&!this._needBake?this._setupBakedAoTexture(i):this._setupLightMapper()}else this._geometry.setNodeMask(-1),V.a.draw();this._onPositionOrScaleChange()},_setupBakedAoTexture:function(e){var t=s.default.instance.getOrCreateMultiresTexture(e,{minFilter:Jf.Texture.LINEAR,magFilter:Jf.Texture.LINEAR,wrapS:Jf.Texture.CLAMP_TO_EDGE,wrapT:Jf.Texture.CLAMP_TO_EDGE,internalFormat:Jf.Texture.RGBA}).resource;t.setForceUpload(!0),t.isTextureNull()&&(t.setTextureSize(1,1),t.setImage(new Uint8Array([255,255,255,255])));var n=this._geometry.getOrCreateStateSet();n.setTextureAttributeAndModes(0,t,Jf.StateAttribute.ON|Jf.StateAttribute.OVERRIDE|Jf.StateAttribute.PROTECTED),n.addUniform(Jf.Uniform.createInt(0,"uTexture")),this._geometry.setNodeMask(-1),Object(u.a)().preload?t.getImageMaxSupported().promise.then(function(){t.setImageMaxSupported(),this._resourceDefer.resolve()}.bind(this)):t.setImageSmallest().promise.then(function(){this._resourceDefer.resolve(),t.setImageMaxSupported()}.bind(this)),this.model.set("lastRenderHeight",this.model.get("height")),this.model.set("lastRenderSamplingRange",this.model.get("samplingRange"))},_setupLightMapper:function(){var e=this._geometry.getOrCreateStateSet();if(this._lightMapper)return this._lightMapper.isValidRender()?this._restoreTexture():this._needBake=!0,void(this._needBake&&this._bake());this._lightMapper=new Qf(512,this._nodeFeature,this._viewer,this._transform,600),e.addUniform(Jf.Uniform.createInt(0,"uTexture")),this._lightMapper.onFrameRendered(function(t){if(e.setTextureAttributeAndModes(0,this._lightMapper.getFinalTexture(),Jf.StateAttribute.ON),this._geometry.setNodeMask(-1),this.model.set("progress",this._lightMapper.getProgress()),this.model.set("estimatedTime",this._lightMapper.getEstimatedTime()),t){if(this.model.stopRender(),!this.model.get("dirty")){this.model.set("dirty",!0);var n=this.model.get("aoTextureUid");n&&this.model._trashbin.push(new so.a({uid:n})),this.model.set("aoTextureUid",void 0)}this.model.set("imageCanvas",this._lightMapper.getRenderedCanvas()),this.model.set("lastRenderHeight",this.model.get("height")),this.model.set("lastRenderSamplingRange",this.model.get("samplingRange"))}}.bind(this)),X.a.getBoxReady().then(function(){var e=X.a.getModelBoxWithDisplacement();this._lightMapper.setSceneData(e,this._transform),this._lightMapper._samplingRange=this.model.get("samplingRange"),this._bake(100)}.bind(this))},_restoreTexture:function(){var e=new Jf.Texture;e.setImage(this.model.get("imageCanvas")),this._geometry.getOrCreateStateSet().setTextureAttributeAndModes(0,e,Jf.StateAttribute.ON),this._geometry.setNodeMask(-1),V.a.draw()},cancelRender:function(){if(this._lightMapper)if(this._lightMapper.stopRender(),this.model.stopRender(),this._holdBake=!0,this.model.set("height",this.model.get("lastRenderHeight")),this.model.set("samplingRange",this.model.get("lastRenderSamplingRange")),this._holdBake=!1,this.model.set("progress",100),this.model.set("estimatedTime",0),this._lightMapper.isValidRender())this._restoreTexture();else{var e=this.model.get("aoTextureUid");e?(this._setupBakedAoTexture(e),this.model.set("dirty",!1),this.model._trashbin.length=0):rn.a.get("mask")&rn.a.LIT?this.model.set("shadowMode","ShadowCatcher"):this.model.set("enable",!1)}},onSamplingRangeChanged:function(){this._lightMapper||this._setupLightMapper(),this._lightMapper._samplingRange=this.model.get("samplingRange"),this._bake()},cleanUpTexture:function(e,t){e&&t.setTextureAttributeAndModes(0,e.getFinalTexture(),Jf.StateAttribute.OFF)},getNodeGround:function(){return this._nodeFeature},onOpacityChanged:function(){this._uOpacity.setFloat(Math.max(0,this.model.get("opacity"))),V.a.draw()},onFadeChanged:function(){this._uFade.setFloat(this.model.get("fade")),V.a.draw()},onEnableChanged:function(){var e=this._geometry.getOrCreateStateSet();this._nodeFeature.removeChild(this._transform),Oi.registerStateSetIsTransparent(e,!1),this.model.get("enable")?(this.registerEvents(),this._onPositionOrScaleChange(),this._nodeFeature.addChild(this._transform),this._initialized||this.initStateSet(),this.onShadowModeChanged(),this.onFadeChanged(),this.onOpacityChanged(),Oi.registerStateSetIsTransparent(e,!0),this._lightMapper&&!this._lightMapper.isValidRender()&&this._bake(1)):this.unRegisterEvents(),V.a.draw()},_onTransformChanged:function(){this._lightMapper||"BakedAO"!==this.model.get("shadowMode")||this._setupLightMapper(),this._onPositionOrScaleChange(),this._needBake=!0,"BakedAO"===this.model.get("shadowMode")&&this._bake(),this._displayPlane(),V.a.draw()},_displayPlane:function(){this.model.get("enable")&&Object(o.a)()&&(this._groundStateAttrib.setDisplayPlane(!0),this._geometry.getOrCreateStateSet().setAttribute(we.a.CULL_DISABLE),this._widgetFadeDirection=-1,this._schedulePlane&&clearTimeout(this._schedulePlane),this._schedulePlane=setTimeout(function(){this._widgetFadeDirection=1,V.a.draw()}.bind(this),1e3))},update:function(e,t){if(!this._groundStateAttrib||!this._groundStateAttrib.isDisplayPlane())return!0;var n=t.getFrameStamp();(this._uWidgetFade[0]+=n.getDeltaTime()*this._widgetFadeDirection,this._uWidgetFade[0]>1)&&(this._uWidgetFade[0]=1,this._groundStateAttrib.setDisplayPlane(!1),this._geometry.getOrCreateStateSet().setAttribute(we.a.CULL_BACK));return this._uWidgetFade[0]<.8&&(this._uWidgetFade[0]=.8),V.a.draw(),!0},_onPositionOrScaleChange:function(){var e=Jf.vec3.create();return function(){var t=this.model,n=this._transform.getMatrix(),i=t.get("scale");Jf.vec3.set(e,i,i,i),Jf.mat4.fromScaling(n,e);var r=this.model.get("position");n[12]=r[0],n[13]=r[1],n[14]=r[2],this._transform.dirtyBound()}}(),_bake:function(e){e=e||1e3,this._holdBake||(this.model.startRender(),this._schedule&&clearTimeout(this._schedule),this._schedule=setTimeout(this._lightMapper.requestRender.bind(this._lightMapper),e),this._needBake=!1)}})]},ep=i.a.create($f);ep.prototype.getNode=function(){return this._views[0].getNodeGround()};var tp=ep;t.a=[q,tt,hr,gr,Ar,Fr,oa,fo,_o,Is,zs,Ul,ic,Xh,pd,Zd,Df,tp]},"/kmq":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n("YfG3"),r=n("QYQF");function a(e){return r.a.extend({displayName:e.name||e.displayName||"StatelessComponent",optionTypes:e.optionTypes,initialize:function(){r.a.prototype.initialize.apply(this,arguments),this.createChildrenComponents=this.createChildrenComponents.bind(this),this.createChildComponent=this.createChildComponent.bind(this)},template:function(){return e(Object(i.a)({},this.options,{createChildComponent:this.createChildComponent,createChildrenComponents:this.createChildrenComponents}))}})}},"/pUn":function(e,t,n){"use strict";var i=n("a3nb"),r=n("GhR1"),a=n("1MxV"),o=n("r7P/"),s=n("JLE6"),u=n("gHdx"),l=function(){o.a.call(this,o.a.TRAVERSE_ALL_CHILDREN)};i.a.createPrototypeObject(l,i.a.objectInherit(o.a.prototype,{apply:function(e){if(e.getTypeID()===u.a.getTypeID()){var t=e.getUpdateCallback();if(t instanceof s.a){for(var n=t._stackedTransforms,i=0,r=n.length;i<r;i++){n[i].resetToDefaultValue()}t.computeChannels()}}this.traverse(e)}}),"osgAnimation","ResetRestPoseVisitor");var c=new l,h=function(){r.a.call(this)};i.a.createPrototypeNode(h,i.a.objectInherit(r.a.prototype,{setDefaultUpdateCallback:function(){this.addUpdateCallback(new a.a)},setRestPose:function(){this.accept(c)}}),"osgAnimation","Skeleton"),t.a=h},"/s5t":function(e,t,n){"use strict";var i=n("QLQS"),r=n("par7"),a=function(e){this._duration=void 0===e?1:e,this.reset()};i.a.osg.createPrototypeObject(a,{getDuration:function(){return this._duration},setDuration:function(e){this._duration=e},reset:function(){this._startTime=-1,this._finished=!1,this._ratio=0,r.a.draw()},finished:function(){},interpolate:function(e,t,n){if(this._finished)return 1;this._startTime<0&&(this._startTime=e);var i=Math.min(this._duration,e-this._startTime),r=0===this._duration?1:i/this._duration;return this._ratio=r,(r>=1||0===this._duration)&&(this._finished=!0,this.finished(t,n)),r},update:function(e,t){return this.interpolate(t.getFrameStamp().getSimulationTime(),e,t),!0}}),t.a=a},0:function(e,t){},"05ve":function(e,t,n){"use strict";var i=n("a3nb"),r=n("YVF9"),a=n("W8Lp"),o=n("icjm"),s=n("jYW0"),u=n("czSk"),l=function(){s.a.call(this),this._clearColor=u.g.create(),this._clearDepth=void 0,this._clearMask=void 0,this._camera=void 0,this._viewport=void 0,this._scissor=void 0,this._preRenderList=[],this._postRenderList=[],l.prototype.init.call(this)},c=new(n("EnLC").a)(function(){return{renderStage:null,order:null}});i.a.createPrototypeObject(l,i.a.objectInherit(s.a.prototype,{init:function(){return s.a.prototype.init.call(this),this._clearDepth=1,u.g.set(this._clearColor,0,0,0,1),this._clearMask=r.a.COLOR_BUFFER_BIT|r.a.DEPTH_BUFFER_BIT,this._camera=void 0,this._viewport=void 0,this._scissor=void 0,this._renderStage=this,l.prototype._initInternal.call(this),this},_initInternal:function(){this._preRenderList.length=0,this._postRenderList.length=0},reset:function(){c.reset(),s.a.prototype.reset.call(this),l.prototype._initInternal.call(this)},setClearDepth:function(e){this._clearDepth=e},getClearDepth:function(){return this._clearDepth},setClearColor:function(e){u.g.copy(this._clearColor,e)},getClearColor:function(){return this._clearColor},setClearMask:function(e){this._clearMask=e},getClearMask:function(){return this._clearMask},setViewport:function(e){this._viewport=e},getViewport:function(){return this._viewport},setScissor:function(e){this._scissor=e},getScissor:function(){return this._scissor},setCamera:function(e){this._camera=e},getCamera:function(){return this._camera},getPreRenderStageList:function(){return this._preRenderList},getPostRenderStageList:function(){return this._postRenderList},addPreRenderStage:function(e,t){for(var n=0,i=this._preRenderList.length;n<i;n++){if(t<this._preRenderList[n].order)break}var r=c.getOrCreateObject();r.order=t,r.renderStage=e,n<this._preRenderList.length?this._preRenderList.splice(n,0,r):this._preRenderList.push(r)},addPostRenderStage:function(e,t){for(var n=0,i=this._postRenderList.length;n<i;n++){if(t<this._postRenderList[n].order)break}var r=c.getOrCreateObject();r.order=t,r.renderStage=e,n<this._postRenderList.length?this._postRenderList.splice(n,0,r):this._postRenderList.push(r)},drawPreRenderStages:function(e,t){for(var n=t,i=0,r=this._preRenderList.length;i<r;++i){n=this._preRenderList[i].renderStage.draw(e,n)}return n},draw:function(e,t){this._camera&&this._camera.getInitialDrawCallback()&&this._camera.getInitialDrawCallback()(e);var n=this.drawPreRenderStages(e,t);return n=this.drawImplementation(e,n),n=this.drawPostRenderStages(e,n),this._camera&&this._camera.getFinalDrawCallback()&&this._camera.getFinalDrawCallback()(e),n},sort:function(){for(var e=0,t=this._preRenderList.length;e<t;++e)this._preRenderList[e].renderStage.sort();s.a.prototype.sort.call(this);for(var n=0,i=this._postRenderList.length;n<i;++n)this._postRenderList[n].renderStage.sort()},drawPostRenderStages:function(e,t){for(var n=t,i=0,r=this._postRenderList.length;i<r;++i){n=this._postRenderList[i].renderStage.draw(e,n)}return n},applyCamera:function(e){var t=e.getGraphicContext();if(void 0!==this._camera){var n=this._camera.getViewport(),i=this._camera.frameBufferObject;if(i||(i=new a.a,this._camera.frameBufferObject=i),i.isDirty()){var r,o,s=this._camera.getAttachments(),u=s[a.a.COLOR_ATTACHMENT0];for(var l in u&&u.texture&&(r=u.texture.getWidth(),o=u.texture.getHeight()),s){u=s[l];var c={};c.attachment=u.attachment,void 0===u.texture?(c.format=u.format,c.width=void 0!==r?r:n.width(),c.height=void 0!==o?o:n.height()):(c.texture=u.texture,c.textureTarget=u.textureTarget,u.format&&(c.format=u.format)),i.setAttachment(c)}}i.apply(e)}else t.bindFramebuffer(t.FRAMEBUFFER,null)},drawImplementation:function(e,t){var n=e.getGraphicContext();return this.applyCamera(e),void 0===this._viewport&&o.a.log("RenderStage does not have a valid viewport"),e.applyAttribute(this._viewport),this._scissor&&e.applyAttribute(this._scissor),0!==this._clearMask&&(this._clearMask&n.COLOR_BUFFER_BIT&&e.clearColor(this._clearColor),this._clearMask&n.DEPTH_BUFFER_BIT&&(e.depthMask(!0),e.clearDepth(this._clearDepth)),e.clear(this._clearMask)),0!==this._positionedAttribute.getLength()&&this.applyPositionedAttribute(e,this._positionedAttribute),s.a.prototype.drawImplementation.call(this,e,t)}}),"osg","RenderStage"),l.clean=function(){c.clean()},t.a=l},"0IOc":function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),a=n("J4zp"),o=n.n(a),s=n("q1tI"),u=n("wHZf"),l=n("rC6e");t.a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=Object(s.useState)(t),a=o()(i,2),c=a[0],h=a[1],d=Object(s.useRef)(c);Object(s.useEffect)(function(){d.current=c});var f=Object(s.useContext)(u.EffectContext),p=Object(s.useMemo)(function(){return[Object(u.createEffectMiddleware)(f)].concat(r()(n))},[f]);return Object(l.a)(function(){return c},h,e,p)}},"0fc8":function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/vr/vr-menu.jinja"]={root:function(e,t,n,i,r){var a="";try{var o=i.makeMacro([],["options"],function(e){var r=n;n=new i.Frame,(e=e||{}).hasOwnProperty("caller")&&n.set("caller",e.caller),n.set("options",e.hasOwnProperty("options")?e.options:{});var a="";return a+='\n\n<div style="width:700px;">',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"hasHotspotsNavigation")&&(a+='<div class="vr-menu-row">\n            <button  id="vrPrevButton" class="vr-button vr-button-small">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-arrow-left-white"></div>\n            </button>\n            <span class="vr-localize-icon">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-map-marker-white"></div>\n            </span>\n            <button id="vrNextButton" class="vr-button vr-button-small">\n                <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-arrow-right-white"></div>\n            </button>\n        </div>'),a+='<button id="vrHomeButton" class="vr-button">Home</button>\n    <button id="vrHelpButton" class="vr-button">Help</button>\n    <button id="vrExitButton" class="vr-button vr-round-button">\n        <div style="width:100px;height:100px;margin:auto" class="vr-icon vr-icon-times-white"></div>\n    </button>\n</div>\n',n=r,new i.SafeString(a)});t.addExport("panel"),t.setVariable("panel",o),r(null,a+="\n")}catch(e){r(i.handleError(e,null,null))}}}},"0iCP":function(e,t,n){"use strict";var i=n("QLQS"),r=n("fgaA"),a=i.a.osg;t.a=function(e){var t=a.WebGLCaps.instance(),n=t.getWebGLParameter("MAX_TEXTURE_SIZE"),i=t.getWebGLParameter("MAX_RENDERBUFFER_SIZE"),o=Object(r.a)().maxTextureSize,s=void 0===e?1/0:e;return Math.min(n,i,o,s)}},"12sq":function(e,t,n){"use strict";var i=n("MVZn"),r=n.n(i),a=n("oaNE"),o=n("+lWh"),s=n("Ui7z");window.webpackPublicPath=Object(o.o)("webpack-public-path");var u=Object(o.o)("sketchfab-runtime","json"),l=r()({},u,{__webpack_public_path__:window.webpackPublicPath}),c={buildMode:"dist",routes:{"categories:detail":"categories/<slug:category>","categories:list":"categories","collections:collection_display":"<username:username>/collections/<slug:collection_slug>","collections:explore_collections":"collections","collections:popular":"collections/popular","feeds:activity":"feed/activity","feeds:following":"feed","feeds:suggestions":"feed/suggestions","models:edit":"models/<uid:model_id>/edit","models:embed":"models/<uid:model_id>/embed","models:explore":"3d-models","models:explore_by_category":"3d-models/categories/<slug:category>","models:playlists_embed":"playlists/embed","models:popular":"3d-models/popular","models:properties":"3d-models/<slug:slug>-<uid:model_id>/properties","models:properties_without_slug":"3d-models/<uid:model_id>/properties","models:review":"models/<uid:model_id>/review","models:staffpicks":"3d-models/staffpicks","models:view":"3d-models/<slug:slug>-<uid:model_id>","models:view_without_slug":"3d-models/<uid:model_id>","orgs:all_models":"orgs/<username:username>/3d-models","orgs:home":"orgs/<username:username>","orgs:invite":"orgs/<username:username>/invite","orgs:members":"orgs/<username:username>/members","orgs:model":"orgs/<username:username>/3d-models/<slug:slug>-<uid:uid>","orgs:model_edit":"orgs/<username:username>/models/<uid:uid>/edit","orgs:model_properties":"orgs/<username:username>/3d-models/<slug:slug>-<uid:uid>/properties","orgs:model_properties_without_slug":"orgs/<username:username>/3d-models/<uid:uid>/properties","orgs:model_without_slug":"orgs/<username:username>/3d-models/<uid:uid>","orgs:profile":"orgs/<username:username>/profile","orgs:project":"orgs/<username:username>/projects/<slug:slug>-<uid:uid>","orgs:project_manage":"orgs/<username:username>/projects/<slug:slug>-<uid:uid>/manage","orgs:project_manage_without_slug":"orgs/<username:username>/projects/<uid:uid>/manage","orgs:project_members":"orgs/<username:username>/projects/<slug:slug>-<uid:uid>/members","orgs:project_members_without_slug":"orgs/<username:username>/projects/<uid:uid>/members","orgs:project_without_slug":"orgs/<username:username>/projects/<uid:uid>","pages:1million":"1million","pages:3dprintshow_redirect":"3dprintshow","pages:about":"about","pages:advertising":"3d-advertising","pages:animation_redirect":"animation","pages:careers":"careers","pages:configurator":"3d-configurators","pages:developers":"developers","pages:developers_data":"developers/data-api","pages:developers_download_downloading_models":"developers/download-api/downloading-models","pages:developers_download_downloading_models_javascript":"developers/download-api/downloading-models/javascript","pages:developers_download_guidelines":"developers/download-api/guidelines","pages:developers_download_libraries":"developers/download-api/libraries","pages:developers_exporters":"developers/exporters","pages:developers_page":"developers/<str:section>/<str:page>","pages:developers_section":"developers/<str:section>","pages:developers_support":"developers/support","pages:developers_v1_api_redirect":"developers/data-api/v1","pages:developers_v2_api":"developers/data-api/v2/<str:language>","pages:developers_v3_api":"developers/data-api/v3/<str:language>","pages:download_redirect":"download","pages:ecommerce":"3d-ecommerce","pages:education":"education","pages:enterprise":"enterprise","pages:exporters":"exporters","pages:exporters_detail":"exporters/<slug:exporter>","pages:faq_labs":"faq/labs","pages:features":"features","pages:features_animation":"features/animation","pages:features_download":"features/download","pages:features_gltf":"features/gltf","pages:features_massive":"features/massive","pages:features_pbr":"features/pbr","pages:features_teams":"features/teams","pages:gltf_redirect":"gltf","pages:html_sitemap_index":"sitemap","pages:html_sitemap_section":"sitemap/<str:section>","pages:html_sitemap_section_detail":"sitemap/<str:section>/<str:cursor>","pages:importers":"importers","pages:index":"","pages:invite_redirect":"invite","pages:labs":"labs","pages:licenses":"licenses","pages:massive_redirect":"massive","pages:mobile":"mobile","pages:museums":"museums","pages:oauth2_success":"oauth2/success","pages:offline":"offline","pages:pbr_redirect":"pbr","pages:plans":"plans","pages:plans_by_usecase":"plans/<slug:usecase>","pages:press":"press","pages:privacy":"privacy","pages:render_test_viewer":"tests/models/<uid:model_id>/render-test","pages:teams_redirect":"teams","pages:terms":"terms","pages:tests_grid_playground":"tests/playground/grid","pages:viewer":"3d-viewer","pages:virtual_reality":"virtual-reality","pages:vr":"vr","pages:vr_browser":"vr-browser","pages:vr_launcher":"vr-launcher","search:search":"search","store:cart":"store/cart","store:categories_list":"store/categories","store:checkout":"store/checkout","store:home":"store","store:invoice":"<username:username>/invoices/<uid:uid>","store:invoice_redirect":"<username:username>/invoices","store:search":"store/3d-models","store:search_by_keyword":"store/3d-models/<slug:keyword>","store:user":"<username:username>/store","tags:tag_detail_view":"tags/<slug:tag>","users:explore_users":"members","users:explore_users_pro":"members/pros","users:farewell":"farewell","users:onboarding":"signup/onboarding","users:onboarding_step":"signup/onboarding/<slug:usage>/<slug:step>","users:profile_collections":"<username:username>/collections","users:profile_followers":"<username:username>/followers","users:profile_following":"<username:username>/followings","users:profile_likes":"<username:username>/likes","users:profile_models":"<username:username>/models","users:profile_purchases":"<username:username>/purchases","users:profile_sales":"<username:username>/sales","users:profile_subscriptions":"<username:username>/subscriptions","users:profile_summary":"<username:username>","users:profile_uploads":"<username:username>/uploads","users:reset_password":"login/reset-password","users:reset_password_confirm":"login/reset-password-confirm","users:settings_account":"settings/account","users:settings_apps":"settings/apps","users:settings_avatar":"settings/avatar","users:settings_dotme":"settings/dotme","users:settings_email":"settings/email","users:settings_notifications":"settings/notifications","users:settings_password":"settings/password","users:settings_profile":"settings/profile","users:settings_unsubscribe":"settings/unsubscribe","users:signin":"login","users:signin_hololens":"login/hololens","users:signin_schneider":"login/schneider","users:signout":"logout","users:signup":"signup","users:signup_connect":"signup/connect","users:signup_email_confirmation":"signup/email-confirmation","users:signup_finalize":"signup/finalize","users:upgrade_welcome":"upgrade/<str:account>/<str:cycle>/welcome"},modelFiletypes:["wrl","obj","3ds","dae","ply","osg2","osgt","osgb","osgx","osgs","gem","rgb","dxf","tgz","osgterrain","zae","stl","osga","osgtgz","3dc","asc","lw","gdal","osg","iv","blend","blend1","fbx","dwf","zip","7z","rar","gz","kmz","wrz","q3d","gltf","glb","iges","igs","abc","las","vox"],environmentFiletypes:["hdr","exr"],exportersFiletypes:{"3dslash":"3dslash",blend:"blender",c4d:"cinema4d",craft:"kerbalspaceprogram",fmz:"formz",gh:"grasshopper",ghx:"grasshopper",ic3d:"ironcad",ipt:"inventor",lws:"lightwave",lxo:"modo",ma:"maya",mat:"unity",max:"3dsmax",mb:"maya",prefab:"unity",psd:"photoshop",qb:"qubicle",qef:"qubicle",qmo:"qubicle",s3d:"strata",sbs:"substance",skp:"sketchup",sldprt:"solidworks",spp:"substance",unity:"unity",ztl:"zbrush"},textureFileTypes:["jpg","jpeg","png","tga"],avatarFiletypes:["jpg","jpeg","png"],backgroundFiletypes:["jpg","jpeg","png"],matcapFiletypes:["jpg","jpeg","png","tga"],additionalUploadableFileTypes:["mtl","psd","bin"],soundFiletypes:["mp3"],maxBackgroundFilesize:4194304,maxMatcapFilesize:4194304,maxEnvironmentFilesize:52428800,maxAvatarFilesizes:{basic:1048576,biz:1048576,ent:1048576,plus:1048576,prem:1048576,pro:1048576},maxModelFilesizes:{basic:52428800,biz:524288e3,ent:524288e3,plus:104857600,prem:524288e3,pro:209715200},maxHotspotsPerModel:{basic:5,biz:75,ent:100,plus:10,prem:50,pro:20},maxSoundFilesize:5242880,maxSoundtracksPerModel:{basic:1,biz:15,ent:15,plus:3,prem:10,pro:5},plansPrivateModelLimit:"{{ PLAN_PRIVATE_MODEL_LIMIT }}",plansViewOnlyLimit:{basic:1,biz:500,ent:-1,plus:10,prem:200,pro:30},textureMaxFileSize:78643200,cameraConstraintsEditing:{basic:0,biz:1,ent:1,plus:0,prem:1,pro:1},analyticsReferrerOverrides:["facebook.com/.*?/?dialog/oauth.*?","facebook.com/login$","facebook.com/l.php$"],oauthRedirectUris:{},usernameMaxLength:30,usernameValidatorTitle:"Letters, numbers, -, _ and . only",userUsageTypeChoices:{buyer:"buyer",uploader:"uploader",visitor:"visitor"},userTrackingCookie:"sb_t_us",campaignTrackingCookie:"sb_t_camp",proPlanTypes:["plus","pro","prem","biz","ent"],planLabels:{basic:"basic",biz:"business",ent:"enterprise",plus:"plus",prem:"premium",pro:"pro"},deflatableModelFiletypes:["stl","ply","obj","dae"],minDeflatableFilesize:524288,maxLevenshteinDistance:2,prodHookDomainsBlacklist:["sketchfab.com"],inspectorBlacklist:["3dexport.com","3docean.net","3dsquirrel.co.uk","artstation.com","blendermarket.com","cgtrader.com","creativemarket.com","crytek.com","cubebrush.co","daz3d.com","evermotion.org","flippednormals.com","gumroad.com","pond5.com","renderosity.com","stock.adobe.com","turbosquid.com","unity3d.com","unrealengine.com"],maxExtraArchiveSize:1073741824,apiPageSize:24,internalDomains:[{domain:"2mdn.net",allowSubdomains:!0},{domain:"3dtotal.com",allowSubdomains:!0},{domain:"80.lv",allowSubdomains:!0},{domain:"artstation.com",allowSubdomains:!0},{domain:"blendernation.com",allowSubdomains:!0},{domain:"cgsociety.org",allowSubdomains:!0},{domain:"fatvoxel.com",allowSubdomains:!0},{domain:"guidigo.com",allowSubdomains:!0},{domain:"moddb.com",allowSubdomains:!0},{domain:"nearpod.com",allowSubdomains:!0},{domain:"serving-sys.com",allowSubdomains:!0},{domain:"sketchfab.com",allowSubdomains:!0},{domain:"skfb-local.com",allowSubdomains:!0},{domain:"syncsketch.com",allowSubdomains:!0},{domain:"therookies.co",allowSubdomains:!0},{domain:"yeggi.com",allowSubdomains:!0},{domain:"yobi3d.com",allowSubdomains:!0}],hosts:{faq:"https://help.sketchfab.com/hc/en-us",discourse:"https://forum.sketchfab.com"},optionsVersion:9,channelNames:{Matcap:["matcap"],Displacement:["displacement"],Opacity:["transparency","transparent","opacity","mask","alpha"],SubsurfaceScattering:["scattering","subsurface"],SubsurfaceTranslucency:["translucency","thickness"],DiffuseColor:["diffuse","albedo","basecolor"],DiffusePBR:["diffuse","albedo","basecolor"],AlbedoPBR:["diffuse","albedo","basecolor"],ClearCoat:["clearcoat"],ClearCoatRoughness:["clearcoat roughness"],ClearCoatNormalMap:["clearcoat normal map"],SpecularColor:["specular","spec","s"],DiffuseIntensity:["ambient occlusion","ao","occlusion","lightmap","diffuseintensity"],SpecularPBR:["specular","spec","s"],MetalnessPBR:["metalness","metallic","metal","m"],GlossinessPBR:["glossiness","glossness","gloss","g","glossy"],RoughnessPBR:["roughness","rough","r"],NormalMap:["normal","nrm","normalmap"],BumpMap:["bump","bumpmap","heightmap"],AOPBR:["ambient occlusion","ao","occlusion","lightmap","diffuseintensity"],EmitColor:["emission","emit","emissive"],CavityPBR:["cavity"],SpecularHardness:["glossiness","glossness","gloss","g","glossy"],SpecularF0:["specularf0","f0"],Inspector:[]},shortcuts:{viewerRendering:{name:"Rendering",shortcuts:[{id:"defaultRenderingMode",name:"Lit: ",description:"Shows default rendering mode",keyCombinations:["1"]},{id:"shadelessRenderingMode",name:"Shadeless: ",description:"Shows shadeless rendering mode",keyCombinations:"2"},{id:"matcapRenderingMode",name:"MatCap: ",description:"Shows matcap rendering mode",keyCombinations:"3"},{id:"toggleWireframe",name:"Wireframe: ",description:"Toggles wireframe visibility",keyCombinations:"5"},{id:"inspector",name:"Inspector: ",keyCombinations:["i"]}]},generalControls:{name:"General",shortcuts:[{id:"fullscreen",name:"Fullscreen: ",keyCombinations:["f"]}]},animationControl:{name:"Animations",shortcuts:[{id:"prevFrame",name:"Previous frame: ",keyCombinations:["b","ctrl+b","shift+b"]},{id:"nextFrame",name:"Next frame: ",keyCombinations:["n","ctrl+n","shift+n"]},{id:"toggleTextEdition",name:"Go to time/frame : ",keyCombinations:["enter"]}]},annotationControl:{name:"Annotations",shortcuts:[{id:"prevAnnotation",name:"Previous: ",keyCombinations:["j","pageup"]},{id:"nextAnnotation",name:"Next: ",keyCombinations:["k","pagedown"]}]},inspectorControl:{name:"Inspector",shortcuts:[{id:"render",name:"Render: ",keyCombinations:["1"]},{id:"materials",name:"Materials: ",keyCombinations:["2"]},{id:"geometry",name:"Geometry: ",keyCombinations:["3"]},{id:"uv",name:"UV: ",keyCombinations:["4"]},{id:"animation",name:"Animation: ",keyCombinations:["6"]}]},sound:{name:"Sound",shortcuts:[{id:"mute",name:"Mute: ",keyCombinations:["m"]}]}},defaultMatcapUid:"35c4d334eded44d8a657f390954a32dd",facebookApiVersion:"v2.10",modelMinPrice:399,modelNameMaxLength:48,reviewsUsageOptions:[{title:"Game development",value:"game"},{title:"Real-Time Rendering",value:"rtr"},{title:"Rendering & Visual FX",value:"vfx"},{title:"Animation/Motion Design",value:"anim"},{title:"VR",value:"vr"},{title:"3D Printing, Maker Projects & DIY",value:"print"},{title:"Architecture / Interior Design",value:"archi"},{title:"Education",value:"edu"},{title:"AR",value:"ar"},{title:"Art",value:"art"},{title:"Other",value:"other"}],fileFormatOptions:[{title:".fbx (Autodesk FBX)",value:"fbx"},{title:".3ds (3ds Max)",value:"3ds"},{title:".max (3ds Max)",value:"max"},{title:".blend (Blender)",value:"blend"},{title:".obj (OBJ wavefront)",value:"obj"},{title:".c4d (Cinema 4D)",value:"c4d"},{title:".mb (Maya)",value:"mb"},{title:".ma (Maya)",value:"ma"},{title:".lwo (LightWave)",value:"lwo"},{title:".lxo (Modo)",value:"lxo"},{title:".skp (SketchUp)",value:"skp"},{title:".stl (Stereolithography)",value:"stl"},{title:".unitypackage (Unity)",value:"unitypackage"},{title:".uasset (Unreal)",value:"uasset"},{title:".dae (Collada)",value:"dae"},{title:".ply (Polygon File Format)",value:"ply"}],storeCartMaxSize:50,countries:[{title:"Afghanistan",value:"AF"},{title:"land Islands",value:"AX"},{title:"Albania",value:"AL"},{title:"Algeria",value:"DZ"},{title:"American Samoa",value:"AS"},{title:"Andorra",value:"AD"},{title:"Angola",value:"AO"},{title:"Anguilla",value:"AI"},{title:"Antarctica",value:"AQ"},{title:"Antigua and Barbuda",value:"AG"},{title:"Argentina",value:"AR"},{title:"Armenia",value:"AM"},{title:"Aruba",value:"AW"},{title:"Australia",value:"AU"},{title:"Austria",value:"AT"},{title:"Azerbaijan",value:"AZ"},{title:"Bahamas",value:"BS"},{title:"Bahrain",value:"BH"},{title:"Bangladesh",value:"BD"},{title:"Barbados",value:"BB"},{title:"Belarus",value:"BY"},{title:"Belgium",value:"BE"},{title:"Belize",value:"BZ"},{title:"Benin",value:"BJ"},{title:"Bermuda",value:"BM"},{title:"Bhutan",value:"BT"},{title:"Bolivia, Plurinational State of",value:"BO"},{title:"Bonaire, Sint Eustatius and Saba",value:"BQ"},{title:"Bosnia and Herzegovina",value:"BA"},{title:"Botswana",value:"BW"},{title:"Bouvet Island",value:"BV"},{title:"Brazil",value:"BR"},{title:"British Indian Ocean Territory",value:"IO"},{title:"Brunei Darussalam",value:"BN"},{title:"Bulgaria",value:"BG"},{title:"Burkina Faso",value:"BF"},{title:"Burundi",value:"BI"},{title:"Cambodia",value:"KH"},{title:"Cameroon",value:"CM"},{title:"Canada",value:"CA"},{title:"Cabo Verde",value:"CV"},{title:"Cayman Islands",value:"KY"},{title:"Central African Republic",value:"CF"},{title:"Chad",value:"TD"},{title:"Chile",value:"CL"},{title:"China",value:"CN"},{title:"Christmas Island",value:"CX"},{title:"Cocos (Keeling) Islands",value:"CC"},{title:"Colombia",value:"CO"},{title:"Comoros",value:"KM"},{title:"Congo",value:"CG"},{title:"Congo, Democratic Republic of the",value:"CD"},{title:"Cook Islands",value:"CK"},{title:"Costa Rica",value:"CR"},{title:"Cte d'Ivoire",value:"CI"},{title:"Croatia",value:"HR"},{title:"Cuba",value:"CU"},{title:"Curaao",value:"CW"},{title:"Cyprus",value:"CY"},{title:"Czechia",value:"CZ"},{title:"Denmark",value:"DK"},{title:"Djibouti",value:"DJ"},{title:"Dominica",value:"DM"},{title:"Dominican Republic",value:"DO"},{title:"Ecuador",value:"EC"},{title:"Egypt",value:"EG"},{title:"El Salvador",value:"SV"},{title:"Equatorial Guinea",value:"GQ"},{title:"Eritrea",value:"ER"},{title:"Estonia",value:"EE"},{title:"Ethiopia",value:"ET"},{title:"Falkland Islands (Malvinas)",value:"FK"},{title:"Faroe Islands",value:"FO"},{title:"Fiji",value:"FJ"},{title:"Finland",value:"FI"},{title:"France",value:"FR"},{title:"French Guiana",value:"GF"},{title:"French Polynesia",value:"PF"},{title:"French Southern Territories",value:"TF"},{title:"Gabon",value:"GA"},{title:"Gambia",value:"GM"},{title:"Georgia",value:"GE"},{title:"Germany",value:"DE"},{title:"Ghana",value:"GH"},{title:"Gibraltar",value:"GI"},{title:"Greece",value:"GR"},{title:"Greenland",value:"GL"},{title:"Grenada",value:"GD"},{title:"Guadeloupe",value:"GP"},{title:"Guam",value:"GU"},{title:"Guatemala",value:"GT"},{title:"Guernsey",value:"GG"},{title:"Guinea",value:"GN"},{title:"Guinea-Bissau",value:"GW"},{title:"Guyana",value:"GY"},{title:"Haiti",value:"HT"},{title:"Heard Island and McDonald Islands",value:"HM"},{title:"Holy See",value:"VA"},{title:"Honduras",value:"HN"},{title:"Hong Kong",value:"HK"},{title:"Hungary",value:"HU"},{title:"Iceland",value:"IS"},{title:"India",value:"IN"},{title:"Indonesia",value:"ID"},{title:"Iran, Islamic Republic of",value:"IR"},{title:"Iraq",value:"IQ"},{title:"Ireland",value:"IE"},{title:"Isle of Man",value:"IM"},{title:"Israel",value:"IL"},{title:"Italy",value:"IT"},{title:"Jamaica",value:"JM"},{title:"Japan",value:"JP"},{title:"Jersey",value:"JE"},{title:"Jordan",value:"JO"},{title:"Kazakhstan",value:"KZ"},{title:"Kenya",value:"KE"},{title:"Kiribati",value:"KI"},{title:"Korea, Democratic People's Republic of",value:"KP"},{title:"Korea, Republic of",value:"KR"},{title:"Kosovo",value:"XK"},{title:"Kuwait",value:"KW"},{title:"Kyrgyzstan",value:"KG"},{title:"Lao People's Democratic Republic",value:"LA"},{title:"Latvia",value:"LV"},{title:"Lebanon",value:"LB"},{title:"Lesotho",value:"LS"},{title:"Liberia",value:"LR"},{title:"Libya",value:"LY"},{title:"Liechtenstein",value:"LI"},{title:"Lithuania",value:"LT"},{title:"Luxembourg",value:"LU"},{title:"Macao",value:"MO"},{title:"Macedonia, the former Yugoslav Republic of",value:"MK"},{title:"Madagascar",value:"MG"},{title:"Malawi",value:"MW"},{title:"Malaysia",value:"MY"},{title:"Maldives",value:"MV"},{title:"Mali",value:"ML"},{title:"Malta",value:"MT"},{title:"Marshall Islands",value:"MH"},{title:"Martinique",value:"MQ"},{title:"Mauritania",value:"MR"},{title:"Mauritius",value:"MU"},{title:"Mayotte",value:"YT"},{title:"Mexico",value:"MX"},{title:"Micronesia, Federated States of",value:"FM"},{title:"Moldova, Republic of",value:"MD"},{title:"Monaco",value:"MC"},{title:"Mongolia",value:"MN"},{title:"Montenegro",value:"ME"},{title:"Montserrat",value:"MS"},{title:"Morocco",value:"MA"},{title:"Mozambique",value:"MZ"},{title:"Myanmar",value:"MM"},{title:"Namibia",value:"NA"},{title:"Nauru",value:"NR"},{title:"Nepal",value:"NP"},{title:"Netherlands",value:"NL"},{title:"New Caledonia",value:"NC"},{title:"New Zealand",value:"NZ"},{title:"Nicaragua",value:"NI"},{title:"Niger",value:"NE"},{title:"Nigeria",value:"NG"},{title:"Niue",value:"NU"},{title:"Norfolk Island",value:"NF"},{title:"Northern Mariana Islands",value:"MP"},{title:"Norway",value:"NO"},{title:"Oman",value:"OM"},{title:"Pakistan",value:"PK"},{title:"Palau",value:"PW"},{title:"Palestine, State of",value:"PS"},{title:"Panama",value:"PA"},{title:"Papua New Guinea",value:"PG"},{title:"Paraguay",value:"PY"},{title:"Peru",value:"PE"},{title:"Philippines",value:"PH"},{title:"Pitcairn",value:"PN"},{title:"Poland",value:"PL"},{title:"Portugal",value:"PT"},{title:"Puerto Rico",value:"PR"},{title:"Qatar",value:"QA"},{title:"Runion",value:"RE"},{title:"Romania",value:"RO"},{title:"Russian Federation",value:"RU"},{title:"Rwanda",value:"RW"},{title:"Saint Barthlemy",value:"BL"},{title:"Saint Helena, Ascension and Tristan da Cunha",value:"SH"},{title:"Saint Kitts and Nevis",value:"KN"},{title:"Saint Lucia",value:"LC"},{title:"Saint Martin (French part)",value:"MF"},{title:"Saint Pierre and Miquelon",value:"PM"},{title:"Saint Vincent and the Grenadines",value:"VC"},{title:"Samoa",value:"WS"},{title:"San Marino",value:"SM"},{title:"Sao Tome and Principe",value:"ST"},{title:"Saudi Arabia",value:"SA"},{title:"Senegal",value:"SN"},{title:"Serbia",value:"RS"},{title:"Seychelles",value:"SC"},{title:"Sierra Leone",value:"SL"},{title:"Singapore",value:"SG"},{title:"Sint Maarten (Dutch part)",value:"SX"},{title:"Slovakia",value:"SK"},{title:"Slovenia",value:"SI"},{title:"Solomon Islands",value:"SB"},{title:"Somalia",value:"SO"},{title:"South Africa",value:"ZA"},{title:"South Georgia and the South Sandwich Islands",value:"GS"},{title:"South Sudan",value:"SS"},{title:"Spain",value:"ES"},{title:"Sri Lanka",value:"LK"},{title:"Sudan",value:"SD"},{title:"Suriname",value:"SR"},{title:"Svalbard and Jan Mayen",value:"SJ"},{title:"Eswatini",value:"SZ"},{title:"Sweden",value:"SE"},{title:"Switzerland",value:"CH"},{title:"Syrian Arab Republic",value:"SY"},{title:"Taiwan, Province of China",value:"TW"},{title:"Tajikistan",value:"TJ"},{title:"Tanzania, United Republic of",value:"TZ"},{title:"Thailand",value:"TH"},{title:"Timor-Leste",value:"TL"},{title:"Togo",value:"TG"},{title:"Tokelau",value:"TK"},{title:"Tonga",value:"TO"},{title:"Trinidad and Tobago",value:"TT"},{title:"Tunisia",value:"TN"},{title:"Turkey",value:"TR"},{title:"Turkmenistan",value:"TM"},{title:"Turks and Caicos Islands",value:"TC"},{title:"Tuvalu",value:"TV"},{title:"Uganda",value:"UG"},{title:"Ukraine",value:"UA"},{title:"United Arab Emirates",value:"AE"},{title:"United Kingdom of Great Britain and Northern Ireland",value:"GB"},{title:"United States of America",value:"US"},{title:"United States Minor Outlying Islands",value:"UM"},{title:"Uruguay",value:"UY"},{title:"Uzbekistan",value:"UZ"},{title:"Vanuatu",value:"VU"},{title:"Venezuela, Bolivarian Republic of",value:"VE"},{title:"Viet Nam",value:"VN"},{title:"Virgin Islands, British",value:"VG"},{title:"Virgin Islands, U.S.",value:"VI"},{title:"Wallis and Futuna",value:"WF"},{title:"Western Sahara",value:"EH"},{title:"Yemen",value:"YE"},{title:"Zambia",value:"ZM"},{title:"Zimbabwe",value:"ZW"}],usStates:[{title:"Alabama",value:"AL"},{title:"Alaska",value:"AK"},{title:"Arizona",value:"AZ"},{title:"Arkansas",value:"AR"},{title:"California",value:"CA"},{title:"Colorado",value:"CO"},{title:"Connecticut",value:"CT"},{title:"Delaware",value:"DE"},{title:"District of Columbia",value:"DC"},{title:"Florida",value:"FL"},{title:"Georgia",value:"GA"},{title:"Hawaii",value:"HI"},{title:"Idaho",value:"ID"},{title:"Illinois",value:"IL"},{title:"Indiana",value:"IN"},{title:"Iowa",value:"IA"},{title:"Kansas",value:"KS"},{title:"Kentucky",value:"KY"},{title:"Louisiana",value:"LA"},{title:"Maine",value:"ME"},{title:"Maryland",value:"MD"},{title:"Massachusetts",value:"MA"},{title:"Michigan",value:"MI"},{title:"Minnesota",value:"MN"},{title:"Mississippi",value:"MS"},{title:"Missouri",value:"MO"},{title:"Montana",value:"MT"},{title:"Nebraska",value:"NE"},{title:"Nevada",value:"NV"},{title:"New Hampshire",value:"NH"},{title:"New Jersey",value:"NJ"},{title:"New Mexico",value:"NM"},{title:"New York",value:"NY"},{title:"North Carolina",value:"NC"},{title:"North Dakota",value:"ND"},{title:"Ohio",value:"OH"},{title:"Oklahoma",value:"OK"},{title:"Oregon",value:"OR"},{title:"Pennsylvania",value:"PA"},{title:"Rhode Island",value:"RI"},{title:"South Carolina",value:"SC"},{title:"South Dakota",value:"SD"},{title:"Tennessee",value:"TN"},{title:"Texas",value:"TX"},{title:"Utah",value:"UT"},{title:"Vermont",value:"VT"},{title:"Virginia",value:"VA"},{title:"Washington",value:"WA"},{title:"West Virginia",value:"WV"},{title:"Wisconsin",value:"WI"},{title:"Wyoming",value:"WY"}]};t.a=Object(o.j)()?new Proxy({},{get:function(e,t){return global.__runtimeSettings||(global.__runtimeSettings={}),Object(s.f)(global.__runtimeSettings[t])&&Object(s.f)(c[t])?r()({},c[t],global.__runtimeSettings[t]):global.__runtimeSettings[t]||c[t]}}):Object(a.a)(c,l)},"13g6":function(e,t){e.exports="uniform sampler2D TextureExtra;\r\n\r\n// LINEAR should be deduce from TEXTURE_2D_TextureExtra with user data\r\nvec4 composeExtra(const in vec4 color) {\r\n#ifdef LINEAR_EXTRA\r\n\tvec4 extra = sRGBToLinear(TEXTURE_2D_TextureExtra(gTexCoord));\r\n#else\r\n\tvec4 extra = TEXTURE_2D_TextureExtra(gTexCoord);\r\n#endif\r\n\treturn extra + vec4(color) * (1.0 - extra.a);\r\n}"},"1D44":function(e,t,n){"use strict";var i=n("a3nb"),r=n("Qavt"),a=function(e,t,n,i){r.a.call(this),this._func=a.LESS,this._near=0,this._far=1,this._writeMask=!0,void 0!==e&&(this._func="string"==typeof e?a[e]:e),void 0!==t&&(this._near=t),void 0!==n&&(this._far=n),void 0!==i&&(this._writeMask=i)};a.DISABLE=0,a.NEVER=512,a.LESS=513,a.EQUAL=514,a.LEQUAL=515,a.GREATER=516,a.NOTEQUAL=517,a.GEQUAL=518,a.ALWAYS=519,i.a.createPrototypeStateAttribute(a,i.a.objectInherit(r.a.prototype,{attributeType:"Depth",cloneType:function(){return new a},setRange:function(e,t){this._near=e,this._far=t},setWriteMask:function(e){this._writeMask=e},getWriteMask:function(){return this._writeMask},getFunc:function(){return this._func},apply:function(e){e.applyDepth(this)}}),"osg","Depth"),t.a=a},"1HiF":function(e,t,n){"use strict";!function(){if(void 0===window.performance&&(window.performance={}),!window.performance.now){var e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}}window.performance.mark||(window.performance.mark=function(){}),window.performance.measure||(window.performance.measure=function(){})}(),window.rStats=function(e){function t(e,t){for(var n=Object.keys(e),i=0,r=n.length;i<r;i++)t(n[i])}var n=e||{},i=n.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],r=(n.CSSPath?n.CSSPath:"")+"rStats.css";(n.css||["https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",r]).forEach(function(e){!function(e){var t=document.createElement("link");t.href=e,t.rel="stylesheet",t.type="text/css",document.getElementsByTagName("head")[0].appendChild(t)}(e)}),n.values||(n.values={});var a,o,s=10,u=200,l={};function c(e,t){var i,r=e,a=0,l=0,c=0,h=0,d=performance.now(),f=0,p=document.createElement("div"),g=document.createElement("span"),m=document.createElement("div"),v=document.createTextNode(""),_=n?n.values[r.toLowerCase()]:null,b=new function(e,t,n){var i=n||{},r=document.createElement("canvas"),a=r.getContext("2d"),o=0,l=0,c=i.color?i.color:"#666666",h=document.createElement("canvas"),d=h.getContext("2d");h.width=1,h.height=2*s,d.fillStyle="#444444",d.fillRect(0,0,1,2*s),d.fillStyle=c,d.fillRect(0,s,1,s),d.fillStyle="#ffffff",d.globalAlpha=.5,d.fillRect(0,s,1,1),d.globalAlpha=1;var f=document.createElement("canvas"),p=f.getContext("2d");return f.width=1,f.height=2*s,p.fillStyle="#444444",p.fillRect(0,0,1,2*s),p.fillStyle="#b70000",p.fillRect(0,s,1,s),p.globalAlpha=.5,p.fillStyle="#ffffff",p.fillRect(0,s,1,1),p.globalAlpha=1,r.width=u,r.height=s,r.style.width=r.width+"px",r.style.height=r.height+"px",r.className="rs-canvas",e.appendChild(r),a.fillStyle="#444444",a.fillRect(0,0,r.width,r.height),{draw:function(e,t){(l+=.1*(e-l))>(o*=.99)&&(o=l),a.drawImage(r,1,0,r.width-1,r.height,0,0,r.width-1,r.height),t?a.drawImage(f,r.width-1,r.height-l*r.height/o-s):a.drawImage(h,r.width-1,r.height-l*r.height/o-s)}}}(p,r,_),S=!1;function y(e){if(_&&_.average){h+=e,f++;var t=performance.now();t-d>=(_.avgMs||1e3)&&(c=h/f,h=0,d=t,f=0)}}function x(){i=performance.now(),n.userTimingAPI&&performance.mark(r+"-start"),S=!0}function C(){a=performance.now()-i,n.userTimingAPI&&(performance.mark(r+"-end"),S&&performance.measure(r,r+"-start",r+"-end")),y(a)}return p.className="rs-counter-base",g.className="rs-counter-id",g.textContent=_&&_.caption?_.caption:r,m.className="rs-counter-value",m.appendChild(v),p.appendChild(g),p.appendChild(m),t?t.div.appendChild(p):o.appendChild(p),i=performance.now(),{set:function(e){y(a=e)},start:x,tick:function(){C(),x()},end:C,frame:function(){var e=performance.now(),t=e-i;l++,t>1e3&&(a=_&&!1===_.interpolate?l:1e3*l/t,l=0,i=e,y(a))},value:function(){return a},draw:function(){var e=_&&_.average?c:a;v.nodeValue=Math.round(100*e)/100;var t=_&&(_.below&&a<_.below||_.over&&a>_.over);b.draw(a,t),p.style.color=t?"#b70000":"#ffffff"}}}function h(e){var i=e.toLowerCase();if(void 0===i&&(i="default"),l[i])return l[i];var r=null;n&&n.groups&&t(n.groups,function(e){var t=n.groups[parseInt(e,10)];r||-1===t.values.indexOf(i.toLowerCase())||(r=t)});var a=new c(i,r);return l[i]=a,a}function d(){t(n.plugins,function(e){n.plugins[e].update()}),t(l,function(e){l[e].draw()}),n&&n.fractions&&t(n.fractions,function(e){var i=n.fractions[parseInt(e,10)],r=[],a=l[i.base.toLowerCase()];a&&(a=a.value(),t(n.fractions[e].steps,function(t){var i=n.fractions[e].steps[parseInt(t,10)].toLowerCase(),o=l[i];o&&r.push(o.value()/a)})),i.graph.draw(r)})}return function(){if(n.plugins){n.values||(n.values={}),n.groups||(n.groups=[]),n.fractions||(n.fractions=[]);for(var e=0;e<n.plugins.length;e++)n.plugins[e].attach(h),t(n.plugins[e].values,function(t){n.values[t]=n.plugins[e].values[t]}),n.groups=n.groups.concat(n.plugins[e].groups),n.fractions=n.fractions.concat(n.plugins[e].fractions)}else n.plugins={};(a=document.createElement("div")).className="rs-base",(o=document.createElement("div")).className="rs-container",o.style.height="auto",a.appendChild(o),document.body.appendChild(a),n&&(n.groups&&t(n.groups,function(e){var t=n.groups[parseInt(e,10)],i=document.createElement("div");i.className="rs-group",t.div=i;var r=document.createElement("h1");r.textContent=t.caption,r.addEventListener("click",function(e){this.classList.toggle("hidden"),e.preventDefault()}.bind(i)),o.appendChild(r),o.appendChild(i)}),n.fractions&&t(n.fractions,function(e){var r=n.fractions[parseInt(e,10)],a=document.createElement("div");a.className="rs-fraction";var l=document.createElement("div");l.className="rs-legend";var c=0;t(n.fractions[e].steps,function(t){var r=document.createElement("p");r.textContent=n.fractions[e].steps[t],r.style.color=i[c],l.appendChild(r),c++}),a.appendChild(l),a.style.height=c*s+"px",r.div=a;var h=new function(e,n){var r=document.createElement("canvas"),a=r.getContext("2d");return r.width=u,r.height=s*n,r.style.width=r.width+"px",r.style.height=r.height+"px",r.className="rs-canvas",e.appendChild(r),a.fillStyle="#444444",a.fillRect(0,0,r.width,r.height),{draw:function(e){a.drawImage(r,1,0,r.width-1,r.height,0,0,r.width-1,r.height);var n=0;t(e,function(t){var o=e[t]*r.height;a.fillStyle=i[t],a.fillRect(r.width-1,n,1,o),n+=o})}}}(a,c);r.graph=h,o.appendChild(a)}))}(),function(e){return e?h(e):{element:a,update:d}}},e.exports=window.rStats},"1MxV":function(e,t,n){"use strict";var i=n("a3nb"),r=n("gHdx"),a=n("r7P/"),o=n("icjm"),s=n("qRO0"),u=function(){a.a.call(this)};i.a.createPrototypeObject(u,i.a.objectInherit(a.a.prototype,{apply:function(e){if(e.getTypeID()===r.a.getTypeID()){for(var t=!1,n=e.getChildren(),i=0,a=e.getChildren().length;i<a;i++){if(n[i].getTypeID()===r.a.getTypeID()){if(t)return void o.a.warn("Warning: a Bone was found after a non-Bone child within a Skeleton. Children of a Bone must be ordered with all child Bones first for correct update order.")}else t=!0}this.traverse(e)}}}),"osgAnimation","ValidateSkeletonVisitor");var l=function(e,t){return(e instanceof r.a?0:1)-(t instanceof r.a?0:1)},c=function(){this._needValidate=!0};i.a.createPrototypeObject(c,i.a.objectInherit(s.a.prototype,{needToValidate:function(){return this._needValidate},update:function(e,t){if(this._needValidate&&t.getVisitorType()===a.a.UPDATE_VISITOR&&e.className&&"Skeleton"===e.className()){for(var n=new u,i=e.getChildren(),r=0,o=i.length;r<o;r++){i[r].accept(n)}i.sort(l),this._needValidate=!1}return!0}}),"osgAnimation","UpdateSkeleton"),t.a=c},"1Of8":function(e,t,n){"use strict";var i=n("cDf5"),r=n.n(i);t.a=function e(t,n){var i,a,o=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,s=/(^[ ]*|[ ]*$)/g,u=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,c=/^0/,h=function(t){return e.insensitive&&(""+t).toLowerCase()||""+t},d=h(t).slice(0,50).replace(s,"")||"",f=h(n).slice(0,50).replace(s,"")||"",p=d.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=f.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(d.match(l))||1!==p.length&&d.match(u)&&Date.parse(d),v=parseInt(f.match(l))||m&&f.match(u)&&Date.parse(f)||null;if(v){if(m<v)return-1;if(m>v)return 1}for(var _=0,b=Math.max(p.length,g.length);_<b;_++){if(i=!(p[_]||"").match(c)&&parseFloat(p[_])||p[_]||0,a=!(g[_]||"").match(c)&&parseFloat(g[_])||g[_]||0,isNaN(i)!==isNaN(a))return isNaN(i)?1:-1;if(r()(i)!==r()(a)&&(i+="",a+=""),i<a)return-1;if(i>a)return 1}return 0}},"1bMp":function(e,t){e.exports='uniform vec2 uShadowMapSize;\n#define SHADOW_CAST\n#define HAS_VIEW_VERTEX\n#pragma include "base.vert"\n'},"1f5D":function(e,t,n){"use strict";var i=n("QLQS"),r=n("KK83"),a=i.a.osg,o={uDrawOpaque:a.Uniform.createInt(-1,"uDrawOpaque"),uEarlyZ:a.Uniform.createInt(0,"uEarlyZ"),uQVT:a.Uniform.createFloat3("uQVT"),uQVS:a.Uniform.createFloat3("uQVS"),uQW:a.Uniform.createFloat2("uQW"),uQUV0:a.Uniform.createFloat4("uQUV0"),uNearFar:a.Uniform.createFloat2("uNearFar"),uBoxRadius:a.Uniform.createFloat("uBoxRadius"),uOutputLinear:a.Uniform.createInt(1,"uOutputLinear"),uRGBMRange:a.Uniform.createFloat("uRGBMRange"),uGlobalTexSize:a.Uniform.createFloat2("uGlobalTexSize"),uGlobalTexRatio:a.Uniform.createFloat2("uGlobalTexRatio"),uPixelRatio:a.Uniform.createFloat2("uPixelRatio"),uPreviousGlobalTexSize:a.Uniform.createFloat2("uPreviousGlobalTexSize"),uPreviousGlobalTexRatio:a.Uniform.createFloat2("uPreviousGlobalTexRatio"),uPreviousHalton:a.Uniform.createFloat4("uPreviousHalton"),uReprojectViewProj:a.Uniform.createMatrix4("uReprojectViewProj"),uTaaCornersCSLeft:r.a.uTaaCornersCSLeft,uPreviousProjection:a.Uniform.createMatrix4("uPreviousProjection"),uPreviousViewInvView:a.Uniform.createMatrix4("uPreviousViewInvView"),uTextureToBeRefractedSize:a.Uniform.createFloat2("uTextureToBeRefractedSize"),uHoverUV:a.Uniform.createFloat2(a.vec2.fromValues(1e6,1e6),"uHoverUV"),uDisplay2D:a.Uniform.createFloat(0,"uDisplay2D"),uSplitView:a.Uniform.createFloat(0,"uSplitView"),uInspectorView:a.Uniform.createInt(0,"uInspectorView"),uTimeViewer:a.Uniform.createFloat("uTimeViewer"),uHalton:a.Uniform.createFloat4("uHalton"),uSSAARestart:a.Uniform.createFloat(0,"uSSAARestart"),uScatteringFactorPacker:a.Uniform.createFloat("uScatteringFactorPacker"),uNormalizeFactorThickness:a.Uniform.createFloat("uNormalizeFactorThickness"),uStaticFrameNumShadow0:a.Uniform.createFloat("uStaticFrameNumShadow0"),uStaticFrameNumShadow1:a.Uniform.createFloat("uStaticFrameNumShadow1"),uStaticFrameNumShadow2:a.Uniform.createFloat("uStaticFrameNumShadow2"),uStaticFrameNumShadow3:a.Uniform.createFloat("uStaticFrameNumShadow3"),uShadowMapSize:a.Uniform.createFloat2("uShadowMapSize"),uIsVr:a.Uniform.createInt("uIsVr"),uFrameMod:a.Uniform.createFloat(0,"uFrameMod"),uFrameModTaaSS:a.Uniform.createFloat(0,"uFrameModTaaSS"),uSsrFactor:a.Uniform.createFloat(1,"uSsrFactor"),uQuality:a.Uniform.createFloat(0,"uQuality")};t.a=o},"1irs":function(e,t){e.exports='uniform vec3 uDofBlurNearFarFocal;\n\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureInput;\nuniform sampler2D TextureDofBlurCircular;\nuniform sampler2D TextureDofNearDilateV;\nuniform sampler2D TextureDepth;\n\nuniform vec2 uTextureDofNearDilateVSize;\nuniform vec2 uTextureDofBlurCircularSize;\n\nuniform float uDofScale;\n\nvec4 dofCombine() {\n    vec2 uv = gTexCoord;\n    vec3 color = TEXTURE_2D_TextureInput(uv).rgb;\n\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT){\n        return vec4(color, 1.0);\n    }\n\n    vec4 depthPacked = TEXTURE_2D_TextureDepth(uv);\n\n    // half res color\n    vec3 blur;\n    // no bilinear for background pixels because it can displays artefacts on low frequency due to rgbm bilinear fetching\n    if (depthPacked.x == 1.0) {\n        blur = TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv).rgb;\n        vec2 off = vec2(1.0, -1.0) * uDofScale;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.xx / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.yy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.xy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_NEAREST_TextureDofBlurCircular(uv + off.yx / uTextureDofBlurCircularSize).rgb;\n        blur /= 5.0;\n    } else {\n        blur = TEXTURE_2D_TextureDofBlurCircular(uv).rgb;\n        vec2 off = vec2(1.0, -1.0) * uDofScale;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.xx / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.yy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.xy / uTextureDofBlurCircularSize).rgb;\n        blur += TEXTURE_2D_TextureDofBlurCircular(uv + off.yx / uTextureDofBlurCircularSize).rgb;\n        blur /= 5.0;\n    }\n\n    // merge full res and half res coc\n    vec2 uvNearest = (floor(uv * uTextureDofNearDilateVSize) + 0.5) / uTextureDofNearDilateVSize;\n    float coc = abs(min(TEXTURE_2D_TextureDofNearDilateV(uvNearest).a * 2.0 - 1.0, texDepthToCoC(depthPacked)));\n\n    // merge half res blurred color and full res pixels\n    float cocLower = 0.05;\n    float cocHigher = 0.3;\n\n    return vec4(mix(color, blur, smoothstep(cocLower, cocHigher, coc)), 1.0);\n}\n\n'},"1kUg":function(e,t,n){e.exports=n.p+"static/assets/images/editor/Spot-7484bdcd407b8b2416471e8e6cd23770.png"},"1lVO":function(e,t,n){"use strict";var i=n("o0o1"),r=n.n(i),a=n("yXPU"),o=n.n(a),s=n("a5AJ"),u=n("G9Ht"),l=n.n(u),c=Symbol("WithRouteLinks"),h=function(e){return e.replace(window.location.origin,"").replace(/^\//,"")};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"WithRouteLinks",constructor:function(){var t=o()(r.a.mark(function t(){var i=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this[c]={commonRoutes:[],onRouteLinkClick:function(t){var n=t.currentTarget.getAttribute("href"),r=t.ctrlKey||t.metaKey,a=h(n),o=i[c].commonRoutes.find(function(e){return(0,e.test)(a)});if(!r&&!l.a.any&&o)if(t.preventDefault(),t.stopPropagation(),e[o.name]){var u=o.test(a);s.a.push(a,e[o.name](i,u))}else s.a.push(a,{})},addListener:function(){i.$el.on("click","[data-route]",i[c].onRouteLinkClick)},resetListener:function(){i[c].removeListener(),i[c].addListener()},removeListener:function(){i.$el.off("click","[data-route]",i[c].onRouteLinkClick)},loadRoutes:function(){var e=o()(r.a.mark(function e(){var t,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(1),n.e(2),n.e(39),n.e(3),n.e(143)]).then(n.bind(null,"t0bZ"));case 2:t=e.sent,a=t.default,i[c].commonRoutes=a;case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()};case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),initialize:function(){this[c].loadRoutes(),this[c].addListener()},afterViewDidMount:function(){this[c].resetListener()},afterViewDidUpdate:function(){this[c].resetListener()},beforeViewWillUnmount:function(){this[c].removeListener()}}}},"1nG6":function(e,t,n){"use strict";var i=n("9oTK"),r=n.n(i);t.a=function(e,t){return"string"==typeof e?function(e,t){return new r.a(function(n,i){var r=new XMLHttpRequest;r.open("GET",e,!0);var a=t&&t.responseType?t.responseType.toLowerCase():void 0;a&&(r.responseType=a),t&&t.progress&&r.addEventListener("progress",t.progress,!1),r.addEventListener("error",i,!1),r.addEventListener("load",function(){"arraybuffer"===r.responseType||"blob"===r.responseType?n(r.response):n(r.responseText)}),r.send(null)})}(e,t):function(e,t){return new r.a(function(n){var i=t&&t.responseType?t.responseType.toLowerCase():void 0,r=new window.FileReader;r.onload=function(e){n(e.target.result)},i?"arraybuffer"===i?r.readAsArrayBuffer(e):"blob"===i?n(e):"string"===i?r.readAsText(e):r.readAsDataURL(e):r.readAsText(e)})}(e,t)}},"1oLb":function(e,t){e.exports={websiteTopHeight:"60px",websiteBigTopHeight:"86px",websiteBannerHeight:"50px",websiteResponsiveTopHeight:"40px",websiteResponsiveNavigationWidth:"250px",websiteFullscreenPadding:"30px",editorHeaderHeight:"55px",editorPanelWidth:"320px",editorScrollbarWidth:"10px",editorGroupWidgetHeaderHeight:"30px",editorGroupWidgetSwitchWidth:"50px",editorGroupWidgetSwitchHeight:"24px",editorGroupWidgetSwitchMargin:"2px",editorGroupWidgetSwitchCursorWidth:"12px",editorNestedGroupWidgetSwitchMargin:"3px",editorImageWidgetWidth:"30px",editorImageWidgetHeight:"30px",viewerControlSize:"30px",viewerResponsiveHeight:"calc(100vh - 40px - 130px)",websiteMaxWidth:"2000px",responsiveBreakpointXXLarge:"1910px",responsiveBreakpointXLarge:"1400px",responsiveBreakpointLarge:"1280px",responsiveBreakpointMedium:"1100px",responsiveBreakpointSmall:"950px",responsiveBreakpointXSmall:"800px",responsiveBreakpointXXSmall:"480px",responsiveGridOneColumn:"700px",responsiveGridTwoColumn:"1015px",responsiveGridThreeColumn:"1910px",breakpointXSmall:"576px",breakpointSmall:"768px",breakpointMediumSmall:"960px",breakpointMedium:"1024px",breakpointMediumLarge:"1280px",breakpointLarge:"1440px",breakpointXLarge:"1920px"}},"1qke":function(e,t,n){"use strict";var i=n("QLQS"),r=i.a.osg,a=i.a.osgAnimation;t.a=function(e){for(var t=0,n=e.length;t<n;++t){var i,o=e[t];if(o instanceof a.Bone)i=a.UpdateBone;else{if(!(o instanceof r.MatrixTransform))continue;i=a.UpdateMatrixTransform}for(var s=o.getUpdateCallbackList(),u=0,l=s.length;u<l;++u)if(s[u]instanceof i)return!0}return!1}},"22T1":function(e,t,n){"use strict";n.r(t);var i=!1;t.default=function(e){return void 0!==e&&(i=e),i}},"2UZc":function(e,t,n){"use strict";var i;function r(e){return void 0!==e.type}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r}),function(e){e[e.PENDING=0]="PENDING",e[e.PROCESSING=1]="PROCESSING",e[e.SUCCEEDED=2]="SUCCEEDED",e[e.FAILED=3]="FAILED"}(i||(i={}))},"2lLB":function(e,t){e.exports="/*jshint worker: true */\n\nself.onmessage = function(event) {\n    var data = event.data;\n\n    var opt = {\n        imageOrientation: 'flipY',\n        premultiplyAlpha: 'none',\n        colorSpaceConversion: 'none'\n    };\n\n    self.fetch(data.url).then(function(response) {\n        response.blob().then(function(blob) {\n            self.createImageBitmap(blob, opt).then(function(bitmap) {\n                postMessage(\n                    {\n                        bitmap: bitmap,\n                        url: data.url,\n                        uid: data.uid\n                    },\n                    [bitmap]\n                );\n            });\n        });\n    });\n};\n\n/*jshint worker: false */\n"},"2rs+":function(e,t){e.exports="// version for vertex shader\nvec3 bumpMap(const in vec4 tangent, const in vec3 normal, const in vec2 gradient) {\n    vec3 tang =  normalize(tangent.xyz);\n    vec3 binormal = tangent.w * normalize(cross(normal, tang));\n    return normalize(normal + gradient.x * tang + gradient.y * binormal);\n}\n\n// #define transformNormal(f, tn, tex, b, n) n = f * n.xy; n = normalize(tex.x * t.xyz + tex.y * b + tex.z * n)\nvec3 transformNormal(const in float factor, in vec3 normal, const in vec3 t, const in vec3 b, in vec3 n) {\n    normal.xy = factor * normal.xy;\n    return normalize(normal.x * t + normal.y * b + normal.z * n);\n}\n\n// anisotropy transform\nvec3 transformTangent(in vec2 tangent, const in vec3 t, const in vec3 b) {\n    return normalize(tangent.x * t + tangent.y * b);\n}\n\n// #define transformBump(tex, t, b, n) n = normalize(tex.x * t.xyz + tex.y * b + n)\nvec3 transformBump(in vec2 bump, const in vec3 t, const in vec3 b, in vec3 n) {\n    return normalize(bump.x * t + bump.y * b + n);\n}\n"},"3CjY":function(e,t){e.exports="attribute vec3 Vertex;\n\n#ifdef ICON\n attribute vec2 TexCoord0;\n varying vec2 vTexCoord0;\n#else\n varying vec3 pos;\n#endif\n\n\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  #ifdef ICON\n    vTexCoord0 = TexCoord0;\n  #else\n    pos = Vertex.xyz;\n  #endif\n\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},"3CzM":function(e,t,n){"use strict";var i=n("YfG3");n("f5KD");function r(e,t){var n=e.__withChildren.childrenConfigs[t];return"function"==typeof n.selector?n.selector.call(e):n.selector}function a(e,t){var n=e.__withChildren.childrenConfigs[t];return"function"==typeof n.options?n.options.call(e):n.options}function o(e,t){var n=e.__withChildren.childrenConfigs[t];return n.viewClass.isView?n.viewClass:n.viewClass.call(e)}var s={options:function(){return{}}};t.a={name:"WithChildren",dependencies:["WithOptionTypes"],children:{},constructor:function(){this.__withChildren={childrenConfigs:{}},Object.keys(this.children).forEach(function(e){this.updateChildConfig(e,this.children[e])}.bind(this)),this.children={}},setElement:function(){return this.setChildrenElements(),this},beforeRemove:function(){this.removeChildren()},createChild:function(e){var t=r(this,e),n=a(this,e),s=new(o(this,e))(Object(i.a)({},n,t?{el:this.$(t)}:{}));return this.children[e]=s,this},removeChild:function(e){return this.hasChild(e)&&this.getChild(e).remove(),delete this.children[e],this},removeChildren:function(){return Object.keys(this.__withChildren.childrenConfigs).forEach(this.removeChild.bind(this)),this},refreshChild:function(e){var t=function(e,t){var n=e.__withChildren.childrenConfigs[t];return!n.shouldCreateChild||n.shouldCreateChild.call(e)}(this,e),n=this.hasChild(e);return t?n?this.refreshChildViewClass(e).setChildElement(e):this.createChild(e):this.removeChild(e),this},refreshChildren:function(){Object.keys(this.__withChildren.childrenConfigs).forEach(this.refreshChild.bind(this))},initializeChild:function(e){this.refreshChild(e)},initializeChildren:function(){this.refreshChildren()},setChildElement:function(e){var t=r(this,e);return t&&this.getChild(e).setElement(this.$(t)),this},setChildrenElements:function(){return Object.keys(this.__withChildren.childrenConfigs).filter(this.hasChild.bind(this)).forEach(this.setChildElement.bind(this)),this},setChildOptions:function(e){return this.getChild(e).setOptions(a(this,e)),this},setChildrenOptions:function(){return Object.keys(this.__withChildren.childrenConfigs).filter(this.hasChild.bind(this)).forEach(this.setChildOptions.bind(this)),this},refreshChildViewClass:function(e){var t=o(this,e);return this.getChild(e)instanceof t||(this.removeChild(e),this.createChild(e)),this},renderChild:function(e){if(this.refreshChild(e),this.hasChild(e)){var t=this.getChild(e);t.isMounted?this.setChildOptions(e):t.render()}},renderChildren:function(){Object.keys(this.__withChildren.childrenConfigs).forEach(this.renderChild.bind(this))},getChildrenConfigs:function(){return this.__withChildren.childrenConfigs},updateChildConfig:function(e,t){var n=Object(i.a)({},s,t);return this.__withChildren.childrenConfigs[e]=n,this},getChild:function(e){return this.children[e]},hasChild:function(e){return!!this.children[e]}}},"3Pif":function(e,t,n){"use strict";var i=n("QtKT"),r=function(){this._intersections=[],this._primitiveMask=i.a.ALL_PRIMITIVES,this._intersectionLimit=i.a.NO_LIMIT};r.prototype={reset:function(){this._intersections.length=0},enter:function(e){return!this.reachedLimit()&&(!e.isCullingActive()||this.intersectNode(e))},intersectNode:function(e){return this.intersectBoundingSphere(e.getBoundingSphere())||this.intersectBoundingBox(e.getBoundingBox())},intersectBoundingSphere:function(){return!1},intersectBoundingBox:function(){return!1},getIntersections:function(){return this._intersections},setIntersectionLimit:function(e){this._intersectionLimit=e},getIntersectionLimit:function(){return this._intersectionLimit},setPrimitiveMask:function(e){this._primitiveMask=e},getPrimitiveMask:function(){return this._primitiveMask},reachedLimit:function(){return this._intersectionLimit===i.a.LIMIT_ONE&&this._intersections.length>0},setCurrentTransformation:function(){},intersect:function(){}},t.a=r},"3rl3":function(e,t,n){"use strict";var i=n("QLQS"),r=n("fgaA"),a=i.a.osg,o=i.a.osgShader.shaderProcessor,s={"utils/common.glsl":n("K0P0"),"utils/functions.glsl":n("ceKg"),"shadowing/shadowReceive.glsl":n("j6Sw"),"shadowing/shadowLinearSoft.glsl":n("HMIp"),"shadowing/tapPCF.glsl":n("4don"),"utils/lightCommon.glsl":n("QCSq"),"utils/lights.glsl":n("Bkbh"),"utils/lightsPBR.glsl":n("cXxc"),"utils/lightsSSS.glsl":n("MCB2"),"utils/skinning.glsl":n("F2PT"),"utils/morphing.glsl":n("P40d"),"utils/environment.glsl":n("FiKZ"),"utils/panoramaLod.glsl":n("orCE"),"utils/cubemapLod.glsl":n("SyQS"),"utils/cubemap.glsl":n("HNW4"),"utils/rand.glsl":n("aabx"),"utils/curvature.glsl":n("g8iT"),"utils/refraction.glsl":n("7VuN"),"utils/clearCoat.glsl":n("9D4N"),"utils/ssr.glsl":n("TObL"),"utils/material.glsl":n("ndRg"),"utils/normalBump.glsl":n("2rs+"),"utils/checkerboard.glsl":n("vKVh"),"utils/decodeDepth.glsl":n("I6qS"),"utils/encodeDepth.glsl":n("M+L8"),"utils/encodeDecode.glsl":n("mSVJ"),"utils/getLuminance.glsl":n("cRML"),"base.vert":n("cVj4"),"earlyz.vert":n("hZRv"),"earlyz.frag":n("5isI"),"pbr.vert":n("EjV6"),"pbr.frag":n("xcv8"),"outline.vert":n("OVPj"),"outline.frag":n("m5qG"),"matcap.vert":n("CR0n"),"matcap.frag":n("DVv7"),"shadeless.vert":n("LB4S"),"shadeless.frag":n("BzYw"),"wireframe.vert":n("cvIH"),"wireframe.frag":n("m/Zu"),"inspector/inspector.vert":n("gBF6"),"inspector/inspector.frag":n("WJzN"),"shadowing/shadowCast.vert":n("1bMp"),"shadowing/shadowCast.frag":n("mAxk"),"ARKit/shadowAr.vert":n("PxxW"),"ARKit/shadowAr.frag":n("Og9V"),"webVR/controller.vert":n("Ws5y"),"webVR/controller.frag":n("I9Ql"),"debug/boneBox.vert":n("EVpl"),"debug/boneBox.frag":n("611C"),"debug/normal.vert":n("yYum"),"debug/normal.frag":n("W3fT"),"debug/tangent.vert":n("alNo"),"debug/tangent.frag":n("BuKJ"),"debug/skinning.vert":n("N68w"),"debug/skinning.frag":n("QwJF"),"debug/geometry.vert":n("wMJb"),"debug/geometry.frag":n("JPvX"),"ground/ground.vert":n("PJYv"),"ground/ground.frag":n("mN8o"),"ground/bakeShadowMap.vert":n("DRy3"),"ground/bakeShadowMap.frag":n("PhaV")};if(o.addShaders(s),!Object(r.a)().rgbm){var u=o.getShaderTextPure("utils/functions.glsl");u=(u=u.replace(/encodeRGBM.*\{/,"$&\nreturn vec4(color, 1.0);")).replace(/decodeRGBM.*\{/,"$&\nreturn color.rgb;"),o.addShaders({"utils/functions.glsl":u})}var l=function(){this._shaderCache={}};l.prototype={getOrCreateShader:function(e,t,n,i,r){var a="";r&&(a=r.toString());var o=n+a,s=this._shaderCache[o];return s||(s=this._createShader(e,t,n,i,r),this._shaderCache[o]=s),s},_createShader:function(e,t,n,i,r){var s="#define SHADER_NAME "+i+"\n";if(r)if(Array.isArray(r))for(var u=0;u<r.length;u++)s+="#define "+r[u]+"\n";else s+="#define "+r+"\n";var l={};return l[n+"-vert"]=s+e,l[n+"-frag"]=s+t,o.addShaders(l),new a.Program(new a.Shader(a.Shader.VERTEX_SHADER,o.getShader(n+"-vert")),new a.Shader(a.Shader.FRAGMENT_SHADER,o.getShader(n+"-frag")))}},t.a=new l},"4//o":function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return s});var i=n("8eYQ"),r=n("uGjJ"),a=!0,o=0,s=function(e){a=e},u=function(e){var t,s,u,l,c,h,d,f,p;e.osg.Program.registerErrorCallback(function(g,m,v){if(a&&(!(!v||0===v.length)&&-1===v.indexOf("Internal linking error"))){t||(t=e.osg.WebGLCaps.instance(),s=t.getWebGLParameter("UNMASKED_RENDERER_WEBGL"),u=t.getWebGLParameter("UNMASKED_VENDOR_WEBGL"),l=t.getWebGLParameter("MAX_VARYING_VECTORS"),c=t.getWebGLParameter("MAX_VERTEX_ATTRIBS"),h=t.getWebGLParameter("MAX_FRAGMENT_UNIFORM_VECTORS"),d=t.getWebGLParameter("MAX_VERTEX_UNIFORM_VECTORS"),f=n("G9Ht"),p=f.apple.device);var _="Shader Error: ";if(_+=v,!p)if(s&&(_+="\n"+s),u&&(_+="\n"+u),30!==l&&(_+="\nVarying: "+l),g&&(16!==c&&(_+="\nAttributes:"+c),4096!==d&&(_+="\nVertUnif:"+d)),1024!==h&&(_+="\nFragUnif:"+h),t.isWebGL2())_+="\nWebGL2";else{var b,S=t.getWebGLExtensions(),y=["EXT_shader_texture_lod","OES_standard_derivatives","OES_vertex_array_object","EXT_texture_filter_anisotropic"];for(b=0;b<y.length;b++){var x=y[b];S[x]&&(_+="\n"+x.substring(x.indexOf("_")+1))}for(var C=["hasLinearFloatRTT","hasLinearHalfFloatRTT","hasHalfFloatRTT","hasFloatRTT"];b<C.length;b++){var w=C[b];t[w]()&&(_+="\n"+w.substring(3))}}g&&(_+="\nVS\n"+g),m&&(_+="\nFS\n "+m);var T="errorLogs ";h<64&&(T="ultraLowGPU");var M={tags:{shaderErrors:T}};if(i.a.client.captureMessage(_,M),++o>2&&(a=!1),o>1){var E=new r.default({title:"3D/WebGL context error",text:"An error occurred while rendering the model. It might not look as expected.",safe:!0,buttons:{continue:!0,continueLabel:"OK",cancel:!1}});E.open().then(function(){E.close()}.bind(this))}}})}},"47H3":function(e,t){e.exports="uniform sampler2D uTexture0;\nuniform sampler2D uTexture1;\nuniform sampler2D uTexture2;\nuniform sampler2D uTexture3;\n\n// vec4 (up to 4 textures input)\n// int meaning :\n// 0 -> read R\n// 1 -> read A\n// 2 -> read RGB\n// 3 -> read AAA\n// 4 -> read RG\nuniform ivec4 uReadPacking;\n\nvarying vec2 vTexCoord0;\n\nvoid main(void) {\n    if (uReadPacking.x == 4) {\n        gl_FragColor.rg = texture2D(uTexture0, vTexCoord0).rg;\n        if (uReadPacking.y == 4) {\n            gl_FragColor.ba = texture2D(uTexture1, vTexCoord0).rg;\n        } else {\n            gl_FragColor.b = uReadPacking.y == 0 ? texture2D(uTexture1, vTexCoord0).r : texture2D(uTexture1, vTexCoord0).a;\n            gl_FragColor.a = uReadPacking.z == 0 ? texture2D(uTexture2, vTexCoord0).r : texture2D(uTexture2, vTexCoord0).a;\n        }\n\n    } else if (uReadPacking.x == 3) {\n        // 1 rgb, 1 greyscale\n        gl_FragColor.rgb = texture2D(uTexture0, vTexCoord0).aaa;\n        gl_FragColor.a = uReadPacking.y == 0 ? texture2D(uTexture1, vTexCoord0).r : texture2D(uTexture1, vTexCoord0).a;\n\n    } else if (uReadPacking.x == 2) {\n        // 3 aaa, 1 greyscale\n        gl_FragColor.rgb = texture2D(uTexture0, vTexCoord0).rgb;\n        gl_FragColor.a = uReadPacking.y == 0 ? texture2D(uTexture1, vTexCoord0).r : texture2D(uTexture1, vTexCoord0).a;\n\n    } else {\n        // 4 greyscales\n        gl_FragColor.r = uReadPacking.x == 0 ? texture2D(uTexture0, vTexCoord0).r : texture2D(uTexture0, vTexCoord0).a;\n        gl_FragColor.g = uReadPacking.y == 0 ? texture2D(uTexture1, vTexCoord0).r : texture2D(uTexture1, vTexCoord0).a;\n        gl_FragColor.b = uReadPacking.z == 0 ? texture2D(uTexture2, vTexCoord0).r : texture2D(uTexture2, vTexCoord0).a;\n        gl_FragColor.a = uReadPacking.w == 0 ? texture2D(uTexture3, vTexCoord0).r : texture2D(uTexture3, vTexCoord0).a;\n    }\n}"},"48vN":function(e,t,n){"use strict";var i=n("dZz+"),r=n("gBaA"),a=n("AoCp"),o=n("f5KD");t.a=a.a.extend({displayName:"FollowButton",optionTypes:{size:o.b.oneOf(["small","medium","large","huge"]).isRequired,afterFollowAction:o.b.func.isRequired,userUid:o.b.string,trackerEvent:o.b.string},defaultOptions:{userUid:null,trackerEvent:null,size:"medium",afterFollowAction:function(){}},events:{click:"followAction"},initialize:function(){a.a.prototype.initialize.apply(this,arguments),this.options.userUid=this.$el.attr("data-user");var e=i.a.me();e.isAuthenticated()&&e.uid===this.options.userUid||(e.on("change:followings",this.render,this),void 0!==e.get("followings")[this.options.userUid]&&this.render(),this.populate())},setElement:function(){return a.a.prototype.setElement.apply(this,arguments),this.setOptions({userUid:this.$el.attr("data-user")}),this.$el.find(".button").addClass("btn-"+this.options.size),this},populate:function(){var e=this;i.a.me().getDoesFollow(this.options.userUid).then(function(){return e.render()})},followAction:function(e){e.stopPropagation(),this.isReady&&!this.isLoading&&(this.setIsLoading(),i.a.authenticate(function(e){var t=e.doesFollow(this.options.userUid),n=t?"unfollow":"follow";return this.toggle(!t,!0),null!==this.options.trackerEvent&&r.a[this.options.trackerEvent](this.options.userUid,"follow"===n),e[n](this.options.userUid).then(function(){this.options.afterFollowAction(n),this.setIsReady()}.bind(this))}.bind(this)).catch(function(){this.setIsReady()}.bind(this)))},toggle:function(e,t){var n=this.$el;n.toggleClass("toggled",e),void 0!==t&&t&&n.addClass("just-clicked").mouseleave(function(){n.removeClass("just-clicked")})},render:function(){this.toggle(i.a.me().doesFollow(this.options.userUid)),this.isLoading||this.setIsReady()}})},"4ANv":function(e,t,n){"use strict";var i={SCENE:"scene",MANIPULATORS:"scene.manipulators",ORBIT_MANIPULATOR:"scene.manipulators.orbit",ORBIT_MANIPULATOR_MOUSEKEYBOARD:"scene.manipulators.orbit.mousekeyboard",ORBIT_MANIPULATOR_RESETTOHOME:"scene.manipulators.orbit.mousekeyboard.home",ORBIT_MANIPULATOR_TOUCH:"scene.manipulators.orbit.touch",ORBIT_MANIPULATOR_WEBVR:"scene.manipulators.orbit.webvr",ORBIT_MANIPULATOR_DEVICEORIENTATION:"scene.manipulators.orbit.deviceorientation",ORBIT_MANIPULATOR_GAMEPAD:"scene.manipulators.orbit.gamepad",FPS_MANIPULATOR:"scene.manipulators.fps",FPS_MANIPULATOR_MOUSEKEYBOARD:"scene.manipulators.fps.mousekeyboard",FPS_MANIPULATOR_RESETTOHOME:"scene.manipulators.fps.mousekeyboard.home",FPS_MANIPULATOR_TOUCH:"scene.manipulators.fps.touch",FPS_MANIPULATOR_WEBVR:"scene.manipulators.fps.webvr",FPS_MANIPULATOR_DEVICEORIENTATION:"scene.manipulators.fps.deviceorientation",FPS_MANIPULATOR_GAMEPAD:"scene.manipulators.fps.gamepad",CAD_MANIPULATOR:"scene.manipulators.cad",CAD_MANIPULATOR_MOUSEKEYBOARD:"scene.manipulators.cad.mousekeyboard",CAD_MANIPULATOR_RESETTOHOME:"scene.manipulators.cad.mousekeyboard.home",CAD_MANIPULATOR_TOUCH:"scene.manipulators.cad.touch",NODE_GIZMO:"scene.nodegizmo",UI:"ui",STATS:"ui.stats"};t.a=i},"4E7f":function(e,t,n){"use strict";n.r(t);var i=n("YfG3"),r=n("QLQS"),a=n("xjMu"),o=n("q1z7"),s=n.n(o),u=n("12sq"),l=n("6xPH"),c=n("JBIC"),h=n("kZIE"),d=n("xszh"),f=n("par7"),p=n("JQdh"),g=n("joy8"),m=n("t8Ru"),v=r.a.osg,_=s.a.View,b=s.a.Model,S={CavityPBR:!0,AOPBR:!0,NormalMap:!0,Displacement:!0,BumpMap:!0,ClearCoatNormalMap:!0},y={DiffuseIntensity:!0,DiffusePBR:!0,AlbedoPBR:!0,SpecularPBR:!0,GlossinessPBR:!0,RoughnessPBR:!0,MetalnessPBR:!0,SpecularF0:!0},x={},C=x.view=_.extend({initialize:function(){_.prototype.initialize.apply(this,arguments),this.model.on("change:enable",this.updateChannel,this),this.model.on("change:texCoordUnit",this.changeTexCoord,this),this.model.on("setFactor",this.updateChannel,this),this.model.on("setColor",this.updateChannel,this),this.model.on("setTextureModel",this.updateChannel,this),this.model.on("updateChannel",this.updateChannel,this),this.model.on("all",f.a.draw)},getStateSetContext:function(){return this.stateSetContext},updateChannel:function(){if(this.model.getTextureModel()){var e=this.model.get("material").get("texCoordUnitList"),t=this.model.getTexCoordUnit();e.length&&-1===e.indexOf(t)&&this.model.setTexCoordUnit(e[0])}this.getStateSetContext().updateChannel(this.model)},changeTexCoord:function(){this.getStateSetContext().dirtyMaterial()}}),w=x.model=a.a.extend({getModelOptionPath:function(){return"materials:0.channels."+this.get("name")},_initFactorFromBox:function(e,t){var n=this;n.get(e)>=0||p.a.getBoxReady().then(function(){if(!(n.get(e)>=0)){var i=p.a.getModelBoxWithoutDisplacement().radius();n.set(e,i*t)}})},setupTextureModel:function(e){var t=new d.a(e);return-1===t.get("internalFormat")&&t.set("internalFormat",c.a.getDefaultFormatEnum(this.get("name"))),t.updateMultiresTexture(),this.setTextureModel(t),t},_createTextureModel:function(e,t){var n=t.get(e.uid);if(n)return this.setupTextureModel(Object(i.a)({},e,{image:n}));(this.isEffective()||Object(l.a)())&&v.error("can't find imageModel "+e.uid)},setChannelJSON:function(e,t,n){var i=this.setJSON(e,{ignore:["texture"],context:this.get("name"),imageCollection:t,validate:n&&n.validate,warnOnError:n&&n.warnOnError});return i.length?i:(e.texture?this._createTextureModel(e.texture,t):null===e.texture&&this.setTextureModel(void 0),i)},getJSON:function(){var e=a.a.prototype.getJSON.call(this,{ignore:["texture"],context:this.get("name")}),t=this.get("textureModel");return t&&(e.texture=t.getJSON()),e},validate:function(e,t){var n=a.a.prototype.validate.call(this,e,t);return t&&t.imageCollection&&e.texture&&e.enable&&e.factor&&!t.warnOnError?(t.imageCollection.get(e.texture.uid)||n.push(this.get("name")+" texture uid does not exist"),n):n},getName:function(){return this.get("name")},getEnable:function(){return this.get("enable")},getFactor:function(){return this.get("factor")},getTextureModel:function(){return this.get("textureModel")},getTexCoordUnit:function(){var e=this.get("textureModel");return e&&e.get("texCoordUnit")},setEnable:function(e){return this.set("enable",e)},setFactor:function(e){return this.set("factor",e),this.trigger("setFactor")},setTextureModel:function(e){return this.set("textureModel",e),this.trigger("setTextureModel")},setTexCoordUnit:function(e){var t=this.get("textureModel");void 0!==t&&(t.set("texCoordUnit",e),this.trigger("change:texCoordUnit"))},changeTexCoordTransform:function(){this.trigger("change:texCoordUnit")},removeTexture:function(){this.setColor(v.vec3.ONE)},reset:function(){return this.removeTexture(),this.set("factor",1),this.trigger("updateChannel")},resetTextureFormat:function(){var e=this.get("textureModel");e&&(e.set("internalFormat",c.a.getDefaultFormatEnum(this.get("name"))),e.updateMultiresTexture())},isEffective:function(){if(!this.isActivated())return!1;var e=this.get("name"),t=this.get("factor");if(0===t){if("RoughnessPBR"!==e&&"GlossinessPBR"!==e)return!1;var n=this.get("material").getChannels().Opacity;return n.isEffective()&&"refraction"===n.get("type")&&n.get("useMicrosurfaceTexture")}if(S[e]&&!this.get("textureModel"))return!1;if("Displacement"===e&&!v.WebGLCaps.instance().getWebGLParameter("MAX_VERTEX_TEXTURE_IMAGE_UNITS"))return!1;var i=this.get("color");return!(!y[e]&&i&&function(e){return 0===e[0]&&0===e[1]&&0===e[2]}(i)&&"SubsurfaceTranslucency"!==e)&&("DiffuseIntensity"!==e||1!==t||!i||!function(e){return 1===e[0]&&1===e[1]&&1===e[2]}(i))},isEnableEffective:function(){return!!this.isActivated()&&(!!y[this.get("name")]||this.isEffective())},isEnableEffectiveHardware:function(e){if(!this.isEnableEffective())return!1;if(!S[this.get("name")])return!0;var t=e.getChannelMapping(this.get("name"));return void 0!==t&&t>=0},isActivated:function(){return!!(c.a.getShadingMask(this.get("name"))&this.getCurrentShading())&&this.get("enable")},getCurrentShading:function(){var e=this.get("material").get("stateSet"),t=e&&e.getShaderGeneratorName();return t?h.a.nameMatch[t]:h.a.get("mask")},shouldDisplayGUIWarningOnDeletion:function(){if(!this.getEnable())return!1;var e=h.a.get("mask")&h.a.CLASSIC?h.a.CLASSIC:h.a.PBR;return!!(c.a.getShadingMask(this.getName())&e)},addUniforms:function(e,t){var n="u"+(t||this.get("name"))+"Factor";e[n]=v.Uniform.createFloat(n),e[n="u"+(t||this.get("name"))+"UVTransforms"]=v.Uniform.createFloat4(n),e[n="u"+(t||this.get("name"))+"UVOffset"]=v.Uniform.createFloat2(n)},cacheUniforms:function(e){this._uniformFactor=e["u"+this.get("name")+"Factor"].getInternalArray(),this._valueFactor=this.isEnableEffective()?this.get("factor"):0,this.get("UVTransforms")&&(this._uniformUVTransform=e["u"+this.get("name")+"UVTransforms"].getInternalArray(),this._valueUVTransform=this.get("UVTransforms"),this._uniformUVOffset=e["u"+this.get("name")+"UVOffset"].getInternalArray(),this._valueUVOffset=this.get("UVOffset"))},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._valueUVTransform&&(v.vec4.copy(this._uniformUVTransform,this._valueUVTransform),v.vec2.copy(this._uniformUVOffset,this._valueUVOffset))},getSRGB:function(){var e=this.get("textureModel");if(!e)return!1;if(!e.getImageModel())return c.a.isSRGB(this.get("name"));var t=e.getImageModel().get("colorSpace");return"srgb"===t||"linear"!==t&&c.a.isSRGB(this.get("name"))},getShaderHash:function(){var e=this.isEffective()&&this.get("textureModel"),t=this.getSRGB()?"1":"0";return t+=e?e.get("texCoordUnit"):"x",t+=this._valueUVTransform?"x":"t"}}),T={};T.view=C,T.model=w.extend({_adaptJSON:function(e){e.texture?delete e.color:delete e.texture},getColor:function(){return this.get("color")},setColor:function(e){return this.set("textureModel",void 0),this.set("color",v.vec3.copy(this.get("color")||v.vec3.create(),e)),this.trigger("setColor")},setTextureModel:function(e){e&&this.set("color",void 0),w.prototype.setTextureModel.call(this,e)},getJSON:function(){var e=w.prototype.getJSON.call(this);return this.get("textureModel")&&e.color&&delete e.color,e},setChannelJSON:function(e,t,n){var i=w.prototype.setChannelJSON.call(this,e,t,n);return i.length?i:(e.color&&this.setColor(e.color),i)}});var M=w.prototype.addUniforms,E=w.prototype.cacheUniforms,A={};A.view=C.extend({initialize:function(){C.prototype.initialize.apply(this,arguments),this.model.on("change:type",this.changeType,this),this.model.on("change:invert",this.updateChannel,this),this.model.on("change:ior",this.updateChannel,this),this.model.on("change:roughnessFactor",this.updateChannel,this),this.model.on("change:useMicrosurfaceTexture",this.updateChannel,this),this.model.on("change:useAlbedoTint",this.updateChannel,this),this.model.on("change:useNormalOffset",this.updateChannel,this),this.model.on("change:refractionColor",this.updateChannel,this),this.model.on("change:thinLayer",this.updateChannel,this),this.model.get("material").on("change:vertexAlphaEnable",this.updateChannel,this),this._isMasking="alphaMask"===this.model.getTransparency()},_checkForceLuminance:function(){var e=this.model.getTextureModel(),t=e&&e.getMultiresTexture();if(t){var n=e.getImageModel();if(!(!1===n.get("alpha"))){var i=n.get("name")||t.getImageModel().getURL();if(-1===(i=i.toLowerCase()).indexOf("jpg")&&-1===i.indexOf("jpeg"))return}e.set("internalFormat",v.Texture.LUMINANCE),e.updateMultiresTexture()}},updateChannel:function(){var e=this.model.get("material").getChannels();e.RoughnessPBR.isEnableEffective()?e.RoughnessPBR.trigger("updateChannel"):e.GlossinessPBR.isEnableEffective()&&e.GlossinessPBR.trigger("updateChannel"),this._checkForceLuminance(),C.prototype.updateChannel.call(this),f.a.redrawShadow()},_updateMaskingFiltering:function(){var e="alphaMask"===this.model.getTransparency();if(e!==this._isMasking){this._isMasking=e;var t=this.model.getTextureModel();if(t&&t.get("magFilter")!==v.Texture.NEAREST){var n=t.get("minFilter"),i=n===v.Texture.LINEAR_MIPMAP_LINEAR,r=n;e&&n===i?r=v.Texture.LINEAR:e||n!==v.Texture.LINEAR||(r=this._blendFilter),r&&(t.set("minFilter",n),t.set("magFilter",i?v.Texture.LINEAR:n),t.updateMultiresTexture())}}},changeType:function(){this._updateMaskingFiltering(),this.updateChannel()}}),A.model=w.extend({_modelOptionPath:"materials:0.channels.Opacity",getTransparency:function(){return this.get("type")},setTransparency:function(e){this.setJSON({type:e})},isEffective:function(){if(!this.isActivated())return!1;var e=this.get("type"),t=this.get("factor"),n=this.get("textureModel")||this.get("material").get("vertexAlphaEnable");if("alphaMask"===e)return n&&0!==t;if(("alphaBlend"===e||"refraction"===e||"additive"===e)&&this.get("material").getChannels().SubsurfaceScattering.isEffective())return!1;return"alphaBlend"!==e&&"refraction"!==e&&"dithering"!==e||(n||1!==t)},addUniforms:function(e,t){M.call(this,e,t),e.uOpacityInvert=v.Uniform.createInt("uOpacityInvert"),e.uOpacityDithering=v.Uniform.createInt("uOpacityDithering"),e.uOpacityAdditive=v.Uniform.createInt("uOpacityAdditive"),e.uOpacityIOR=v.Uniform.createFloat("uOpacityIOR"),e.uOpacityRoughnessFactor=v.Uniform.createFloat("uOpacityRoughnessFactor"),e.uOpacityRefractionColor=v.Uniform.createFloat3("uOpacityRefractionColor"),e.uOpacityThinLayer=v.Uniform.createFloat("uOpacityThinLayer")},cacheUniforms:function(e){E.call(this,e),this._uniformInvert=e.uOpacityInvert.getInternalArray(),this._uniformDithering=e.uOpacityDithering.getInternalArray(),this._uniformAdditive=e.uOpacityAdditive.getInternalArray(),this._uniformIOR=e.uOpacityIOR.getInternalArray(),this._uniformRoughnessFactor=e.uOpacityRoughnessFactor.getInternalArray(),this._uniformRefractionColor=e.uOpacityRefractionColor.getInternalArray();var t=this.isEnableEffective();this._valueInvert=t&&this.get("textureModel")&&this.get("invert")?1:0,this._valueDithering=t&&"dithering"===this.get("type")?1:0,this._valueAdditive=t&&"additive"===this.get("type")?1:0;var n=t&&"refraction"===this.get("type");this._valueIOR=n?this.get("ior"):0,this._valueRoughness=n?this.get("roughnessFactor"):0,this._valueRefractionColor=n?this.get("refractionColor"):v.vec3.ONE,this._uniformThinLayer=e.uOpacityThinLayer.getInternalArray(),this._valueThinLayer=this.get("thinLayer")?1:0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformInvert[0]=this._valueInvert,this._uniformDithering[0]=this._valueDithering,this._uniformAdditive[0]=this._valueAdditive,this._uniformIOR[0]=this._valueIOR,this._uniformRoughnessFactor[0]=this._valueRoughness,v.vec3.copy(this._uniformRefractionColor,this._valueRefractionColor),this._uniformThinLayer[0]=this._valueThinLayer},_hasTextureAlpha:function(){var e=this.get("textureModel");if(!e)return!1;var t=e.getMultiresTexture();return!(!t||!t.getOriginalFormat)&&t.getOriginalFormat()===v.Texture.ALPHA},getSRGB:function(){return!this._hasTextureAlpha()&&w.prototype.getSRGB.call(this)},_isReadingMicrosurface:function(){if("refraction"!==this.get("type"))return!1;if(!this.get("useMicrosurfaceTexture"))return!1;if(0==(h.a.get("mask")&h.a.PBR))return!1;var e=this.get("material").getChannels();return e.RoughnessPBR.isEnableEffective()?e.RoughnessPBR.getTextureModel():e.GlossinessPBR.getTextureModel()},getShaderHash:function(){var e=w.prototype.getShaderHash.call(this),t=this.get("type"),n="alphaBlend"===t||"additive"===t,i=this.get("textureModel")&&this.get("textureModel").isLuminance(),r="refraction"===t,a=this._isReadingMicrosurface(),o=r&&this.get("useAlbedoTint"),s=r&&this.get("useNormalOffset");return m.a.CURRENT_COMPILER===m.a.SHADOWCAST_COMPILER||m.a.CURRENT_COMPILER===m.a.EARLYZ_COMPILER?(e+=n||r?"1":"0",e+=i?"1":"0",e+="0000"):(e+=n?"1":"0",e+=i?"1":"0",e+=r?"1":"0",e+=a?"1":"0",e+=o?"1":"0",e+=s?"1":"0"),e}});var O={};O.view=C.extend({initialize:function(){C.prototype.initialize.apply(this,arguments),this.model.on("change:occludeSpecular",this.updateChannel,this)}}),O.model=w.extend({getModelOptionPath:function(){return"materials:0.channels.AOPBR"},addUniforms:function(e,t){M.call(this,e,t),e.uAOPBROccludeSpecular=v.Uniform.createInt("uAOPBROccludeSpecular")},cacheUniforms:function(e){E.call(this,e),this._uniformOcclude=e.uAOPBROccludeSpecular.getInternalArray(),this._valueOcclude=this.isEnableEffective()&&this.get("occludeSpecular")?1:0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformOcclude[0]=this._valueOcclude}});var R={};R.view=C.extend({}),R.model=w.extend({_modelOptionPath:"materials:0.channels.BumpMap",addUniforms:function(e,t){M.call(this,e,t);var n="u"+t+"Size";e[n]=v.Uniform.createFloat2(v.vec2.create(),n)},cacheUniforms:function(e){E.call(this,e),this._uniformSize=e["u"+this.get("name")+"Size"].getInternalArray(),this._mrTexture=this.get("textureModel")&&this.get("textureModel").getMultiresTexture()},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformSize[0]=this._mrTexture?this._mrTexture.getWidth():0,this._uniformSize[1]=this._mrTexture?this._mrTexture.getHeight():0}});var P={};P.view=C.extend({initialize:function(){C.prototype.initialize.apply(this,arguments),this.model.on("change:thickness",this.updateChannel,this),this.model.on("change:tint",this.updateChannel,this),this.model.on("change:reflectivity",this.updateChannel,this),this.model.on("change:useBaseNormalMap",this.updateChannel,this)}}),P.model=w.extend({addUniforms:function(e,t){M.call(this,e,t);var n="uClearCoatThickness";e[n]=v.Uniform.createFloat(0,n),e[n="uClearCoatIor"]=v.Uniform.createFloat(0,n),e[n="uClearCoatF0"]=v.Uniform.createFloat(0,n),e[n="uClearCoatTint"]=v.Uniform.createFloat3(v.vec3.create(),n)},cacheUniforms:function(e){E.call(this,e),this._uThickness=e.uClearCoatThickness.getInternalArray(),this._uIor=e.uClearCoatIor.getInternalArray(),this._uF0=e.uClearCoatF0.getInternalArray(),this._uTint=e.uClearCoatTint.getInternalArray(),this._valueRoughness=this.get("roughness"),this._valueThickness=this.get("thickness");var t=this.get("reflectivity");this._valueIOR=1.4*(1-t)+1*t,this._valueF0=.04*(1+t),this.updateTintUniform()},updateTintUniform:function(){var e=this.get("thickness"),t=Math.max(20-e,.01);this._valueTint||(this._valueTint=v.vec3.create()),v.vec3.copy(this._valueTint,this.get("tint")),this._valueTint[0]=-Math.log(v.clamp(this._valueTint[0],.01,.99))/t,this._valueTint[1]=-Math.log(v.clamp(this._valueTint[1],.01,.99))/t,this._valueTint[2]=-Math.log(v.clamp(this._valueTint[2],.01,.99))/t},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uThickness[0]=this._valueThickness,v.vec3.copy(this._uTint,this._valueTint),this._uIor[0]=this._valueIOR,this._uF0[0]=this._valueF0}}),P.model.validateJSON=function(e,t,n){return w.validateJSON(e,t,n)};var I={};I.view=C.extend({}),I.model=w.extend({isEnableEffective:function(){return this.get("material").getChannels().ClearCoat.isEnableEffective()}});var N={};N.view=C.extend({initialize:function(){C.prototype.initialize.apply(this,arguments),this.model.on("change:flipY",this.updateChannel,this)}}),N.model=w.extend({addUniforms:function(e,t){M.call(this,e,t),e.uClearCoatNormalMapFlipY=v.Uniform.createInt("uClearCoatNormalMapFlipY")},cacheUniforms:function(e){E.call(this,e),this._uniformFlip=e.uClearCoatNormalMapFlipY.getInternalArray(),this._valueFlip=this.isEnableEffective()&&this.get("flipY")?1:0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformFlip[0]=this._valueFlip},isEffective:function(){return this.get("material").getChannels().ClearCoat.isEffective()&&void 0!==this.getTextureModel()}});var L={};L.view=C.extend({updateChannel:function(){C.prototype.updateChannel.call(this),this.model.updateGeometryOffsets(),f.a.redrawShadow()}}),L.model=w.extend({_modelOptionPath:"materials:0.channels.Displacement",updateGeometryOffsets:function(){var e=v.vec3.create();return function(){var t=this.isEffective()?this.getFactor():0;if(p.a.updateMaxWorldDisplacement(t),0!==t)for(var n=this.get("material").get("geometryList"),i=0,r=n.length;i<r;++i){var a=n[i];if(!a._maxScale){for(var o=a.getWorldMatrices(),s=0,u=0,l=o.length;u<l;++u)v.mat4.getScale(e,o[u]),s=Math.max(s,e[0],e[1],e[2]);a._maxScale=s}var c=t/(a._maxScale||1);a._displacementFactor=Math.max(a._displacementFactor||0,c),a.dirtyBound()}}}(),setTextureModel:function(e){return e&&e.get("minFilter")===v.Texture.LINEAR_MIPMAP_LINEAR&&(e.set("minFilter",v.Texture.LINEAR),e.updateMultiresTexture()),w.prototype.setTextureModel.call(this,e)},addUniforms:function(e,t){R.model.prototype.addUniforms.call(this,e,t),e.uDisplacementNormal=v.Uniform.createFloat(1,"uDisplacementNormal")},cacheUniforms:function(e){if(R.model.prototype.cacheUniforms.call(this,e),this._uniformNormal=e.uDisplacementNormal.getInternalArray(),this.isEnableEffective()){var t=p.a.getModelBoxWithoutDisplacement();t?this._valueNormal=250*this.get("factor")/t.radius():p.a.getBoxReady().then(this.cacheUniforms.bind(this,e))}else this._valueNormal=0},updateUniforms:function(){R.model.prototype.updateUniforms.call(this),this._uniformNormal[0]=this._valueNormal}});var k={};k.view=C.extend({initialize:function(){C.prototype.initialize.apply(this,arguments),this.model.on("change:flipY",this.updateChannel,this)}}),k.model=w.extend({_modelOptionPath:"materials:0.channels.NormalMap",addUniforms:function(e,t){M.call(this,e,t),e.uNormalMapFlipY=v.Uniform.createInt("uNormalMapFlipY")},cacheUniforms:function(e){E.call(this,e),this._uniformFlip=e.uNormalMapFlipY.getInternalArray(),this._valueFlip=this.isEnableEffective()&&this.get("flipY")?1:0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformFlip[0]=this._valueFlip}});var D,F={};F.view=C.extend({initialize:function(){C.prototype.initialize.apply(this,arguments),this.model.on("change:type",this.updateChannel,this)}}),F.model=T.model.extend({_modelOptionPath:"materials:0.channels.EmitColor",addUniforms:function(e,t){M.call(this,e,t),e.uEmitMultiplicative=v.Uniform.createInt("uEmitMultiplicative")},cacheUniforms:function(e){E.call(this,e),this._uniformMultiply=e.uEmitMultiplicative.getInternalArray();var t=this.isEnableEffective()&&"multiplicative"===this.get("type");this._valueMultiply=t?1:0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformMultiply[0]=this._valueMultiply},isEffective:function(){return!!this.isActivated()&&(0!==this.get("factor")||"additive"!==this.get("type"))}});var V=function(){if(D)return D;0===(D=g.default.instance.getMatcapCollection()).length&&D.addNewImage({url:u.a.defaultMatcapUid,name:u.a.defaultMatcapUid,width:1,height:1}).set("uid",u.a.defaultMatcapUid);return D},B={};B.view=C.extend({initialize:function(){C.prototype.initialize.apply(this,arguments),this.model.on("change:curvature",this.updateChannel,this)}}),B.model=T.model.extend({_modelOptionPath:"materials:0.channels.Matcap",_adaptJSON:function(){},initialize:function(){if(w.prototype.initialize.apply(this,arguments),!this.get("textureModel")){var e=V(),t=e.get(u.a.defaultMatcapUid);t||(t=e.at(0)),this.setChannelJSON({texture:{uid:t.getUID()}})}},setTextureModel:function(e){return this.set("textureModel",e),this.trigger("setTextureModel")},setColor:function(e){return this.set("color",v.vec3.copy(this.get("color")||v.vec3.create(),e)),this.trigger("setColor")},isEffective:function(){return!!this.isActivated()},addUniforms:function(e,t){M.call(this,e,t),e.uMatcapCurvature=v.Uniform.createFloat("uMatcapCurvature"),e.uMatcapColor=v.Uniform.createFloat3("uMatcapColor")},cacheUniforms:function(e){E.call(this,e),this._uniformCurvature=e.uMatcapCurvature.getInternalArray(),this._valueCurvature=this.isEnableEffective()?this.get("curvature"):0,this._uniformColor=e.uMatcapColor.getInternalArray(),this._valueColor=this.isEnableEffective()?this.get("color"):v.vec3.ONE},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformCurvature[0]=this._valueCurvature,v.vec3.copy(this._uniformColor,this._valueColor)},getJSON:function(){return w.prototype.getJSON.call(this)},setChannelJSON:function(e,t,n){return!1===e.enable&&(e.enable=!0),w.prototype.setChannelJSON.call(this,e,V(),n)},resetToDefaultMatcap:function(){this.setChannelJSON({texture:{uid:u.a.defaultMatcapUid}})}});var U={};U.view=C.extend({initialize:function(){C.prototype.initialize.apply(this,arguments),this.model.on("change:profile",this.updateChannel,this)}}),U.model=w.extend({_modelOptionPath:"materials:0.channels.SubsurfaceScattering",initialize:function(){w.prototype.initialize.apply(this,arguments),this._initFactorFromBox("factor",.05)},addUniforms:function(e,t){M.call(this,e,t),e.uSubsurfaceScatteringProfile=v.Uniform.createFloat("uSubsurfaceScatteringProfile")},cacheUniforms:function(e){E.call(this,e),this._uniformProfile=e.uSubsurfaceScatteringProfile.getInternalArray(),this._valueProfile=this.isEnableEffective()?this.get("profile"):1},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformProfile[0]=this._valueProfile}});var j={};j.view=C.extend({initialize:function(){C.prototype.initialize.apply(this,arguments),this.model.on("change:thicknessFactor",this.updateChannel,this)}}),j.model=T.model.extend({_modelOptionPath:"materials:0.channels.SubsurfaceTranslucency",initialize:function(){w.prototype.initialize.apply(this,arguments),this._initFactorFromBox("thicknessFactor",.05)},setTextureModel:B.model.prototype.setTextureModel,setColor:B.model.prototype.setColor,getJSON:B.model.prototype.getJSON,setJSON:B.model.prototype.setJSON,_adaptJSON:B.model.prototype._adaptJSON,addUniforms:function(e,t){M.call(this,e,t),e.uSubsurfaceTranslucencyColor=v.Uniform.createFloat3("uSubsurfaceTranslucencyColor"),e.uSubsurfaceTranslucencyThicknessFactor=v.Uniform.createFloat("uSubsurfaceTranslucencyThicknessFactor")},cacheUniforms:function(e){E.call(this,e),this._uniformThicknessFactor=e.uSubsurfaceTranslucencyThicknessFactor.getInternalArray(),this._uniformColor=e.uSubsurfaceTranslucencyColor.getInternalArray(),this._valueColor=this.isEnableEffective()?this.get("color"):v.vec3.ONE,this._valueThicknessFactor=this.isEnableEffective()?this.get("thicknessFactor"):0},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformThicknessFactor[0]=this._valueThicknessFactor,v.vec3.copy(this._uniformColor,this._valueColor)}});var G={};G.view=C.extend({initialize:function(){C.prototype.initialize.apply(this,arguments),this.model.on("change:direction",this.updateChannel,this),this.model.on("change:flipXY",this.updateChannel,this)}}),G.model=w.extend({isEnableEffective:function(){return w.prototype.isEnableEffective.call(this)&&!this.get("material").get("missingUvs")},addUniforms:function(e,t){M.call(this,e,t),e.uAnisotropyDirection=v.Uniform.createFloat("uAnisotropyDirection"),e.uAnisotropyFlipXY=v.Uniform.createInt("uAnisotropyFlipXY")},cacheUniforms:function(e){E.call(this,e),this._uniformDirection=e.uAnisotropyDirection.getInternalArray(),this._valueDirection=this.isEnableEffective()?this.get("direction"):0,this._uniformFlipXY=e.uAnisotropyFlipXY.getInternalArray(),this._valueXY=this.get("flipXY")?1:0},updateUniforms:function(){var e=!!this.getTextureModel()?-1:Math.sign(this._valueDirection)||1;this._uniformFactor[0]=this._valueFactor*e,this._uniformDirection[0]=this._valueDirection<0?1+this._valueDirection:this._valueDirection,this._uniformFlipXY[0]=this._valueXY}});var H={};H.view=C.extend({}),H.model=T.model.extend({transient:!0,initialize:function(){b.prototype.initialize.apply(this,arguments),this.set("selectUV",0)},setInspectorSRGB:function(e){this._srgb=e},getSRGB:function(){return!!this._srgb},setTextureModel:B.model.prototype.setTextureModel,setColor:B.model.prototype.setColor,addUniforms:function(e,t){M.call(this,e,t),e.uInspectorInvert=v.Uniform.createInt("uInspectorInvert"),e.uInspectorMaskThreshold=v.Uniform.createFloat("uInspectorMaskThreshold"),e.uInspectorColor=v.Uniform.createFloat3("uInspectorColor"),e.uInspectorSelected=v.Uniform.createInt("uInspectorSelected")},cacheUniforms:function(e){E.call(this,e),this._uniformInvert=e.uInspectorInvert.getInternalArray(),this._uniformMaskThreshold=e.uInspectorMaskThreshold.getInternalArray(),this._uniformColor=e.uInspectorColor.getInternalArray(),this._uniformSelected=e.uInspectorSelected.getInternalArray()},updateUniforms:function(){this._uniformFactor[0]=this._valueFactor,this._uniformInvert[0]=this.get("invert")?1:0,this._uniformMaskThreshold[0]=this.get("maskThreshold"),v.vec3.copy(this._uniformColor,this.getColor()),this._uniformSelected[0]=this.get("isSelected")?1:0,this._valueUVTransform&&(v.vec4.copy(this._uniformUVTransform,this._valueUVTransform),v.vec2.copy(this._uniformUVOffset,this._valueUVOffset))},setChannelJSON:function(e,t){(void 0!==e.enable&&this.setEnable(e.enable),void 0!==e.factor&&this.setFactor(e.factor),e.color&&this.setColor(e.color),e.texture)&&(this._createTextureModel(e.texture,t)||this.setColor(e.color||v.vec3.fromValues(1,1,1)));return void 0!==e.invert&&this.set("invert",e.invert),void 0!==e.maskThreshold&&this.set("maskThreshold",e.maskThreshold),[]},setTexCoordUnit:function(e){w.prototype.setTexCoordUnit.call(this,e),this.set("fallbackUV",e)},getShaderHash:function(){var e=w.prototype.getShaderHash.call(this);return e+=this.isEffective()&&!this.get("textureModel")?this.get("selectUV"):0},getJSON:function(){var e={},t=this.get("textureModel");t&&(e.texture=t.getJSON());var n=this.get("color");return n&&(e.color=n),e.factor=this.get("factor"),e.enable=this.get("enable"),e.invert=this.get("invert"),e.maskThreshold=this.get("maskThreshold"),e}});var z={DiffusePBR:T,AlbedoPBR:T,SpecularPBR:T,GlossinessPBR:x,RoughnessPBR:x,MetalnessPBR:x,SpecularF0:x,CavityPBR:x,Matcap:B,SubsurfaceTranslucency:j,DiffuseColor:T,SpecularColor:T,DiffuseIntensity:T,SpecularHardness:x,SubsurfaceScattering:U,Displacement:L,NormalMap:k,AOPBR:O,BumpMap:R,EmitColor:F,Opacity:A,ClearCoat:P,ClearCoatRoughness:I,ClearCoatNormalMap:N,Anisotropy:G,Inspector:H};t.default=z},"4HDP":function(e,t){e.exports="attribute vec3 Vertex;\nattribute vec4 Color;\nvarying vec4 vColor;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n    vColor = Color;\n    gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);\n}\n"},"4KCM":function(e,t,n){"use strict";var i=n("a3nb"),r=n("Vx0a"),a=n("LTZp"),o=n("czSk"),s=function(){r.a.call(this),this.setCullingActive(!1),this._light=void 0,this._referenceFrame=a.a.RELATIVE_RF};i.a.createPrototypeNode(s,i.a.objectInherit(r.a.prototype,{getLight:function(){return this._light},setLight:function(e){this._light=e},setReferenceFrame:function(e){this._referenceFrame=e},getReferenceFrame:function(){return this._referenceFrame},computeBoundingSphere:function(){var e=o.f.create();return function(t){if(r.a.prototype.computeBoundingSphere.call(this,t),void 0!==this._light&&this._referenceFrame===a.a.RELATIVE_RF){var n=this._light.getPosition();0!==n[3]&&t.expandByVec3(o.f.scale(e,n,1/n[3]))}return t}}()}),"osg","LightSource"),t.a=s},"4WAW":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"h",function(){return a}),n.d(t,"c",function(){return p}),n.d(t,"f",function(){return g}),n.d(t,"g",function(){return m}),n.d(t,"b",function(){return v}),n.d(t,"e",function(){return _}),n.d(t,"d",function(){return b});var i,r,a,o=n("lSNA"),s=n.n(o),u=n("RIqP"),l=n.n(u),c=n("MVZn"),h=n.n(c),d=n("NpZ0"),f=n("wHZf");!function(e){e.None="none",e.Refresh="refresh",e.Next="next",e.Previous="previous"}(r||(r={})),function(e){e.PREPEND="pagination.PREPEND",e.RESET="pagination.RESET",e.MAP="pagination.MAP",e.FIRST="pagination.FIRST",e.NEXT="pagination.NEXT",e.PREVIOUS="pagination.PREVIOUS"}(a||(a={}));var p={list:[],cursors:{next:null,previous:null},loading:r.None},g=Object(d.b)(p,(i={},s()(i,a.FIRST,function(e,t){return t.effect.caseOf({Pending:function(){return h()({},e,{loading:r.Refresh})},Rejected:function(){return h()({},e,{loading:r.None})},Resolved:function(t){var n=t.list,i=t.cursors;return h()({},e,{cursors:i,list:n,loading:r.None})}})}),s()(i,a.NEXT,function(e,t){return t.effect.caseOf({Pending:function(){return h()({},e,{loading:r.Next})},Rejected:function(){return h()({},e,{loading:r.None})},Resolved:function(t){var n=t.list,i=t.cursors;return h()({},e,{cursors:h()({},e.cursors,{next:i.next}),list:[].concat(l()(e.list),l()(n)),loading:r.None})}})}),s()(i,a.PREVIOUS,function(e,t){return t.effect.caseOf({Pending:function(){return h()({},e,{loading:r.Previous})},Rejected:function(){return h()({},e,{loading:r.None})},Resolved:function(t){var n=t.list,i=t.cursors;return h()({},e,{cursors:h()({},e.cursors,{previous:i.previous}),list:[].concat(l()(n),l()(e.list)),loading:r.None})}})}),s()(i,a.PREPEND,function(e,t){return h()({},e,{list:[t.item].concat(l()(e.list))})}),s()(i,a.RESET,function(){return p}),s()(i,a.MAP,function(e,t){return h()({},e,{list:e.list.map(t.mapper)})}),i)),m={list:function(e){return e.list},cursors:function(e){return e.cursors},loading:function(e){return e.loading},isLoading:function(e){return e.loading!==r.None},hasNextPage:function(e){return!!e.cursors.next},hasPreviousPage:function(e){return!!e.cursors.previous}},v={first:function(e){return{type:a.FIRST,payload:{effect:e}}},next:function(e){return{type:a.NEXT,payload:{effect:function(t){return e(t,m.cursors(t.getState()).next)}}}},previous:function(e){return{type:a.PREVIOUS,payload:{effect:function(t){return e(t,m.cursors(t.getState()).previous)}}}},firstPending:function(){return{type:a.FIRST,payload:{effect:new f.Pending},meta:{effectId:"",isEffect:!0}}},firstRejected:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Error;return{type:a.FIRST,payload:{effect:new f.Rejected(e)},meta:{effectId:"",isEffect:!0}}},firstResolved:function(e){var t=e.list,n=e.cursors;return{type:a.FIRST,payload:{effect:new f.Resolved({list:t,cursors:n})},meta:{effectId:"",isEffect:!0}}},nextPending:function(){return{type:a.NEXT,payload:{effect:new f.Pending},meta:{effectId:"",isEffect:!0}}},nextRejected:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Error;return{type:a.NEXT,payload:{effect:new f.Rejected(e)},meta:{effectId:"",isEffect:!0}}},nextResolved:function(e){var t=e.list,n=e.cursors;return{type:a.NEXT,payload:{effect:new f.Resolved({list:t,cursors:n})},meta:{effectId:"",isEffect:!0}}},previousPending:function(){return{type:a.PREVIOUS,payload:{effect:new f.Pending},meta:{effectId:"",isEffect:!0}}},previousRejected:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Error;return{type:a.PREVIOUS,payload:{effect:new f.Rejected(e)},meta:{effectId:"",isEffect:!0}}},previousResolved:function(e){var t=e.list,n=e.cursors;return{type:a.PREVIOUS,payload:{effect:new f.Resolved({list:t,cursors:n})},meta:{effectId:"",isEffect:!0}}},prepend:function(e){return{type:a.PREPEND,payload:{item:e}}},reset:function(){return{type:a.RESET,payload:{}}},map:function(e){return{type:a.MAP,payload:{mapper:e}}}},_=function(e,t,n){switch(e){case a.FIRST:return g(t,n.caseOf({Pending:function(){return v.firstPending()},Rejected:function(e){return v.firstRejected(e)},Resolved:function(e){return v.firstResolved(e)}}));case a.NEXT:return g(t,n.caseOf({Pending:function(){return v.nextPending()},Rejected:function(e){return v.nextRejected(e)},Resolved:function(e){return v.nextResolved(e)}}));case a.PREVIOUS:return g(t,n.caseOf({Pending:function(){return v.previousPending()},Rejected:function(e){return v.previousRejected(e)},Resolved:function(e){return v.previousResolved(e)}}))}},b=function(e,t){return g(e,v.map(t))}},"4don":function(e,t){e.exports='#pragma include "shadowing/shadowLinearSoft.glsl"\n\nfloat getShadowPCF(\n    const in sampler2D depths,\n    const in vec2 size,\n    const in vec2 uv,\n    const in float compare,\n    const in vec2 biasPCF,\n    const in vec4 clampDimension\n    OPT_ARG_outDistance\n    OPT_ARG_jitter) {\n\n     float res = 0.0;\n\n     res += texture2DShadowLerp(depths, size, uv + biasPCF, compare, clampDimension OPT_INSTANCE_ARG_outDistance OPT_INSTANCE_ARG_jitter);\n\n\n#if defined(_PCFx1)\n\n#else\n\n    float dx0 = -size.x;\n    float dy0 = -size.y;\n    float dx1 = size.x;\n    float dy1 = size.y;\n\n#define TSF(o1,o2) texture2DShadowLerp(depths, size, uv + vec2(o1, o2) + biasPCF, compare, clampDimension OPT_INSTANCE_ARG_outDistance OPT_INSTANCE_ARG_jitter)\n\n    res += TSF(dx0, dx0);\n    res += TSF(dx0, .0);\n    res += TSF(dx0, dx1);\n\n#if defined(_PCFx4)\n\n    res /=4.0;\n\n#elif defined(_PCFx9)\n    res += TSF(.0, dx0);\n    res += TSF(.0, dx1);\n\n    res += TSF(dx1, dx0);\n    res += TSF(dx1, .0);\n    res += TSF(dx1, dx1);\n\n\n    res /=9.0;\n\n#elif defined(_PCFx25)\n\n    float dx02 = 2.0*dx0;\n    float dy02 = 2.0*dy0;\n    float dx2 = 2.0*dx1;\n    float dy2 = 2.0*dy1;\n\n    // complete row above\n    res += TSF(dx0, dx02);\n    res += TSF(dx0, dx2);\n\n    res += TSF(.0, dx02);\n    res += TSF(.0, dx2);\n\n    res += TSF(dx1, dx02);\n    res += TSF(dx1, dx2);\n\n    // two new col\n    res += TSF(dx02, dx02);\n    res += TSF(dx02, dx0);\n    res += TSF(dx02, .0);\n    res += TSF(dx02, dx1);\n    res += TSF(dx02, dx2);\n\n    res += TSF(dx2, dx02);\n    res += TSF(dx2, dx0);\n    res += TSF(dx2, .0);\n    res += TSF(dx2, dx1);\n    res += TSF(dx2, dx2);\n\n\n    res/=25.0;\n\n#endif\n\n#undef TSF\n\n#endif\n    return res;\n}\n/////// end Tap\n'},"51YE":function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("q1tI"),o=n("kjuc"),s=r()("i",{className:"model-name__icon fa fa-lock --protected"}),u=r()("i",{className:"model-name__icon custom-icons icon-private --private"});t.a=a.memo(function(e){var t=e.model,n=e.target,i=void 0===n?"":n,a=e.clickable,l=void 0===a||a;return r()("div",{className:"model-name c-model-name"},void 0,t.visibility?"protected"===t.visibility?s:"private"===t.visibility?u:null:null,l?r()(o.b,{className:"model-name__label",model:t,target:i,title:t.name},void 0,t.name):r()("span",{className:"model-name__label"},void 0,t.name))})},"5CbO":function(e,t,n){"use strict";var i=n("J4zp"),r=n.n(i),a=n("FFzg"),o=n("q1tI"),s=n.n(o);t.a=function(){var e=s.a.useState(0),t=r()(e,2),n=t[0],i=t[1];return s.a.useEffect(function(){var e=a.a.getSingleton(),t=function(){return i(e.get("activitiesCount"))};return e.on("change:activitiesCount",t),function(){return e.off("change:activitiesCount",t)}},[]),n}},"5bbf":function(e,t,n){"use strict";var i=n("q1tI"),r=i.createContext("light");t.a=r},"5cdn":function(e,t,n){"use strict";var i=n("lSNA"),r=n.n(i),a=n("oTSI"),o=n("IzLi"),s=n("u3oV"),u=n("UXvI"),l=n("89mf"),c=n("M4AY"),h=Object(a.a)(function(e){return Object(l.a)(function(t){c.b.store.dispatch(c.a.entities.update(r()({},e,t)))})});t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"".concat(e,"s");return{name:"WithEntityUpdate",initialize:function(){var n=this,i=function(){var i=n.get("uid");if(i){var r=Object(s.a)(n.toJSON(),function(e){return!function(e){return e&&Object(o.a)(e)&&e.cid}(e)});c.c.entities[e](i,c.b.store.getState())||h(t)([r])}};setTimeout(function(){return i()},16),this.on("change",Object(u.a)(i,250))}}}},"5isI":function(e,t){e.exports='// opacity\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\nvarying vec4 vViewVertex;\n\n#pragma include "utils/encodeDepth.glsl"\n\n#pragma include "utils/material.glsl"\n\n#ifdef HAS_OPACITY\n#pragma include "utils/rand.glsl"\n#endif\n\nvoid main() {\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n    float alpha = 1.0;\n#if defined(HAS_OPACITY_BLEND_OR_ADDITIVE) || defined(HAS_OPACITY_REFRACTION)\n    alpha = getMaterialOpacity();\n    if (uDrawOpaque == 1 && alpha < EPSILON_ALPHA) discard;\n    alpha = uDrawOpaque == 1 ? 1.0 : alpha;\n#endif\n\n    float depth = (-vViewVertex.z - uNearFar.x) / (uNearFar.y - uNearFar.x);\n    float scatter = 0.0;\n    float profile = 0.0;\n\n#ifdef HAS_SUBSURFACESCATTERING\n    scatter = getMaterialScattering();\n    profile = uSubsurfaceScatteringProfile;\n#endif\n\n    gl_FragColor = encodeDepthAlphaProfileScatter(depth, alpha, profile, scatter);\n}\n'},"5mbm":function(e,t,n){"use strict";n.r(t);var i=n("6ZYx"),r=n("a3nb"),a=n("Qavt"),o=function(){a.a.call(this),this._attributeEnable=!1};r.a.createPrototypeStateAttribute(o,r.a.objectInherit(a.a.prototype,{attributeType:"Billboard",cloneType:function(){return new o},setEnabled:function(e){this._attributeEnable=e},isEnabled:function(){return this._attributeEnable},apply:function(){}}),"osg","Billboard");var s=o,u=n("czSk"),l=function(e){a.a.call(this),this._constantColor=u.g.create(),u.g.set(this._constantColor,1,1,1,1),void 0!==e&&this.setConstantColor(e)};r.a.createPrototypeStateAttribute(l,r.a.objectInherit(a.a.prototype,{attributeType:"BlendColor",cloneType:function(){return new l},setConstantColor:function(e){u.g.copy(this._constantColor,e)},getConstantColor:function(){return this._constantColor},apply:function(e){e.getGraphicContext().blendColor(this._constantColor[0],this._constantColor[1],this._constantColor[2],this._constantColor[3])}}),"osg","BlendColor");var c=l,h=n("v+9t"),d=n("XKim"),f=n("6JLc"),p=n("D1Qd"),g=n("Q7Tl"),m=n("YVF9"),v=function(e,t,n,i){a.a.call(this),this._red=!0,this._green=!0,this._blue=!0,this._alpha=!0,void 0!==e&&void 0!==t&&void 0!==n&&this.setMask(e,t,n,i)};r.a.createPrototypeStateAttribute(v,r.a.objectInherit(a.a.prototype,{attributeType:"ColorMask",cloneType:function(){return new v},setMask:function(e,t,n,i){this._red=!!e,this._green=!!t,this._blue=!!n,this._alpha=!!i},apply:function(e){e.applyColorMask(this)}}),"osg","ColorMask");var _=v,b=n("oDhZ"),S=n("zWCM"),y=n("jTTs"),x=n("7cZc"),C=n("62xh"),w=n("R3Hf"),T=n("zB1R"),M=n("1D44"),E=n("qxX9"),A=n("SoBM"),O=n("OZCL"),R=function(){this._radiusEquator=R.WGS_84_RADIUS_EQUATOR,this._radiusPolar=R.WGS_84_RADIUS_POLAR,this.computeCoefficients()};R.WGS_84_RADIUS_EQUATOR=6378137,R.WGS_84_RADIUS_POLAR=6356752.3142,R.prototype={setRadiusEquator:function(e){this._radiusEquator=e,this.computeCoefficients()},getRadiusEquator:function(){return this._radiusEquator},setRadiusPolar:function(e){this._radiusPolar=e,this.computeCoefficients()},getRadiusPolar:function(){return this._radiusPolar},convertLatLongHeightToXYZ:function(e,t,n,i){var r=Math.sin(e),a=Math.cos(e),o=this._radiusEquator/Math.sqrt(1-this._eccentricitySquared*r*r),s=(o+n)*a*Math.cos(t),u=(o+n)*a*Math.sin(t),l=(o*(1-this._eccentricitySquared)+n)*r;return i[0]=s,i[1]=u,i[2]=l,i},convertXYZToLatLongHeight:function(e,t,n,i){var r=Math.sqrt(e*e+t*t),a=Math.atan2(n*this._radiusEquator,r*this._radiusPolar),o=(this._radiusEquator*this._radiusEquator-this._radiusPolar*this._radiusPolar)/(this._radiusPolar*this._radiusPolar),s=Math.sin(a),u=Math.cos(a),l=Math.atan((n+o*this._radiusPolar*s*s*s)/(r-this._eccentricitySquared*this._radiusEquator*u*u*u)),c=Math.atan2(t,e),h=Math.sin(l),d=this._radiusEquator/Math.sqrt(1-this._eccentricitySquared*h*h),f=Math.cos(l);0===f&&(f=1);var p=r/f-d;return i[0]=l,i[1]=c,i[2]=p,i},computeLocalUpVector:function(e,t,n){var i,r,a=this.convertXYZToLatLongHeight(e,t,n,u.f.create());return i=a[0],r=a[1],[Math.cos(r)*Math.cos(i),Math.sin(r)*Math.cos(i),Math.sin(i)]},isWGS84:function(){return this._radiusEquator===R.WGS_84_RADIUS_EQUATOR&&this._radiusPolar===R.WGS_84_RADIUS_POLAR},computeCoefficients:function(){var e=(this._radiusEquator-this._radiusPolar)/this._radiusEquator;this._eccentricitySquared=2*e-e*e},computeLocalToWorldTransformFromLatLongHeight:function(e,t,n,i){var r=this.convertLatLongHeightToXYZ(e,t,n,i);return u.c.fromTranslation(i,r),this.computeCoordinateFrame(e,t,i),i},computeLocalToWorldTransformFromXYZ:function(e,t,n){var i=this.convertXYZToLatLongHeight(e,t,n,u.f.create()),r=u.c.fromTranslation(u.c.create(),u.f.fromValues(e,t,n));return this.computeCoordinateFrame(i[0],i[1],r),r},computeCoordinateFrame:function(){var e=u.f.create(),t=u.f.create(),n=u.f.create();return function(i,r,a){e[0]=Math.cos(r)*Math.cos(i),e[1]=Math.sin(r)*Math.cos(i),e[2]=Math.sin(i),t[0]=-Math.sin(r),t[1]=-Math.cos(r),u.f.cross(n,e,t),u.c.set(a,t[0],t[1],t[2],0,n[0],n[1],n[2],0,e[0],e[1],e[2],0,0,0,0,1)}}()};var P=R,I=n("W8Lp"),N=n("uvJm"),L=n("wwkN"),k=n("RwmW"),D=n("HORL"),F=n("9oTK"),V=n.n(F),B=function(e){D.a.call(this,e),this._canPlayDefered=void 0};B.PAUSE=0,B.PLAYING=1,r.a.createPrototypeObject(B,r.a.objectInherit(D.a.prototype,{isDirty:function(){return this._status===B.PLAYING},setImage:function(e){D.a.prototype.setImage.call(this,e),this._status=B.STOP,e.addEventListener("ended",function(){this._imageObject.loop||this.stop()}.bind(this),!0),this.dirty()},setLooping:function(e){this._imageObject.loop=e},play:function(){this._imageObject.play(),this._status=B.PLAYING},stop:function(){this._imageObject.pause(),this._status=B.PAUSE},whenReady:function(){if(!this._imageObject)return V.a.reject();var e=this;return new V.a(function(t){e._canPlayDefered||(e._canPlayDefered=t,e._imageObject.readyState>3?e._canPlayDefered(e):e._imageObject.addEventListener("canplaythrough",e._canPlayDefered.bind(e._canPlayDefered,e),!0))})}}),"osg","ImageStream");var U=B,j=n("R8W4"),G=n("QVk6"),H=n("icjm"),z=function(e,t){this._bb=new d.a,this._first=e,this._second=t,this._nodeRayStart=u.f.create(),this._nodeRayEnd=u.f.create()},W=function(){this._numVertexIndices=0};W.prototype={apply:function(e){e.getAttributes().Vertex&&Object(j.a)(e,this)},operatorPoint:function(){this._numVertexIndices+=2},operatorLine:function(){this._numVertexIndices+=3},operatorTriangle:function(){this._numVertexIndices+=4}};var q=function(e){this._buildKdTree=e,this._numIndices=0};q.prototype={apply:function(e){e.getAttributes().Vertex&&Object(j.a)(e,this)},operatorPoint:function(e){var t=this._buildKdTree._kdTree.getVertices(),n=3*e;this._buildKdTree._kdTree.addPoint(e),this._buildKdTree._primitiveIndices[this._numIndices]=this._numIndices;var i=this._buildKdTree._centers,r=3*this._numIndices;i[r]=t[n],i[r+1]=t[n+1],i[r+2]=t[n+2],this._numIndices++},operatorLine:function(e,t){if(e!==t){var n=this._buildKdTree._kdTree.getVertices(),i=3*e,r=3*t;this._buildKdTree._kdTree.addLine(e,t);var a=this._numIndices;this._buildKdTree._primitiveIndices[a]=a;var o=3*a,s=n[i],u=n[i+1],l=n[i+2],c=n[r],h=n[r+1],d=n[r+2],f=s<c?s:c,p=u<h?u:h,g=l<d?l:d,m=s>c?s:c,v=u>h?u:h,_=l>d?l:d,b=this._buildKdTree._centers;b[o]=.5*(f+m),b[o+1]=.5*(p+v),b[o+2]=.5*(g+_),this._numIndices++}},operatorTriangle:function(e,t,n){if(e!==t&&e!==n&&t!==n){var i=this._buildKdTree._kdTree.getVertices(),r=3*e,a=3*t,o=3*n;this._buildKdTree._kdTree.addTriangle(e,t,n);var s=this._numIndices;this._buildKdTree._primitiveIndices[s]=s;var u=3*s,l=i[r],c=i[r+1],h=i[r+2],d=i[a],f=i[a+1],p=i[a+2],g=i[o],m=i[o+1],v=i[o+2],_=l<d?l<g?l:g:d<g?d:g,b=c<f?c<m?c:m:f<m?f:m,S=h<p?h<v?h:v:p<v?p:v,y=l>d?l>g?l:g:d>g?d:g,x=c>f?c>m?c:m:f>m?f:m,C=h>p?h>v?h:v:p>v?p:v,w=this._buildKdTree._centers;w[u]=.5*(_+y),w[u+1]=.5*(b+x),w[u+2]=.5*(S+C),this._numIndices++}}};var X=function(e){this._kdTree=e,this._bb=new d.a,this._primitiveIndices=void 0,this._centers=void 0,this._axisOrder=u.f.create(),this._stackLength=0};X.prototype={build:function(e,t){var n=e._targetNumTrianglesPerLeaf,i=t.getVertexAttributeList().Vertex;if(!i)return!1;var r=i.getElements();if(!r)return!1;var a=r.length/3;if(a<n)return!1;this._bb.copy(t.getBoundingBox()),this._kdTree.setVertices(r),this.computeDivisions(e),e._numVerticesProcessed+=a;for(var o=0,s=t.getPrimitiveSetList(),u=s.length,l=0;l<u;l++){var c=s[l],h=c.getMode();h===G.a.TRIANGLE_STRIP||h===G.a.TRIANGLE_FAN?o+=3*Math.abs(c.getCount()-2):o+=3*c.getCount()}var f=new W(this);f.apply(t);var p=f._numVertexIndices;this._primitiveIndices=new Uint32Array(o/3),this._centers=new Float32Array(o),this._kdTree.setPrimitiveIndices(new Uint32Array(o));var g=a>65535?new Uint32Array(p):new Uint16Array(p);this._kdTree.setVertexIndices(g);var m=new q(this);m.apply(t);var v=this._kdTree.getPrimitiveIndices().slice(0,this._kdTree.getNumPrimitiveIndices());this._kdTree.setPrimitiveIndices(v);var _=this._kdTree.getVertexIndices().slice(0,this._kdTree.getNumVertexIndices());this._kdTree.setVertexIndices(_),this._primitiveIndices=this._primitiveIndices.slice(0,m._numIndices),this._centers=this._centers.slice(0,3*m._numIndices);var b=new z(-1,this._primitiveIndices.length);b._bb.copy(this._bb);var S=this._kdTree.addNode(b),y=new d.a;y.copy(this._bb),this.divide(e,y,S,0);var x=this._kdTree.getPrimitiveIndices();for(u=this._primitiveIndices.length,l=0;l<u;++l)this._primitiveIndices[l]=x[this._primitiveIndices[l]];return this._kdTree.setPrimitiveIndices(this._primitiveIndices),this._kdTree.getNodes().length>0},computeDivisions:function(e){this._stackLength=e._maxNumLevels;var t=this._bb._max,n=this._bb._min,i=t[0]-n[0],r=t[1]-n[1],a=t[2]-n[2],o=this._axisOrder;o[0]=i>=r&&i>=a?0:r>=a?1:2,o[2]=i<r&&i<a?0:r<a?1:2;var s=o[0]+o[2];o[1]=3===s?0:2===s?1:2},divide:function(e,t,n,i){var r=this._kdTree,a=this._primitiveIndices,o=r.getNodes(),s=o[n],u=s._first,l=s._second,c=-u-1,h=c+l-1;if(!(i<this._stackLength&&u<0&&l>e._targetNumTrianglesPerLeaf))return u<0&&this.computeNodeBox(s,c,h),n;if(u>=0)return n;for(var d=this._axisOrder[i%3],f=.5*(t._min[d]+t._max[d]),p=0,g=0,m=!1,v=c,_=h,b=this._centers;v<_;){for(;v<_&&b[3*a[v]+d]<=f;)++v;for(;v<_&&b[3*a[_]+d]>f;)--_;if(v<_){var S=a[v];a[v]=a[_],a[_]=S,++v,--_}}v===_&&(b[3*a[v]+d]<=f?++v:--_),_-c<=-1?(p=0,g=n,m=!0):h-v<=-1?(p=n,g=0,m=!0):(p=r.addNode(new z(-c-1,_-c+1)),g=r.addNode(new z(-v-1,h-v+1)));var y=t._max[d];t._max[d]=f;var x=0!==p?this.divide(e,t,p,i+1):0;t._max[d]=y,y=t._min[d],t._min[d]=f;var C=0!==g?this.divide(e,t,g,i+1):0;if(t._min[d]=y,!m){s._first=x,s._second=C,m=!0;var w=s._bb;w.init(),0!==x&&w.expandByBoundingBox(o[x]._bb),0!==C&&w.expandByBoundingBox(o[C]._bb)}return n},computeNodeBox:function(e,t,n){for(var i=1/0,r=1/0,a=1/0,o=-1/0,s=-1/0,u=-1/0,l=this._kdTree.getVertexIndices(),c=this._kdTree.getPrimitiveIndices(),h=this._kdTree.getVertices(),d=t;d<=n;++d)for(var f=c[this._primitiveIndices[d]],p=l[f++],g=0;g<p;++g){var m=3*l[f++],v=h[m],_=h[m+1],b=h[m+2];v<i&&(i=v),_<r&&(r=_),b<a&&(a=b),v>o&&(o=v),_>s&&(s=_),b>u&&(u=b)}var S=e._bb,y=S._min,x=S._max;y[0]=i-1e-6,y[1]=r-1e-6,y[2]=a-1e-6,x[0]=o+1e-6,x[1]=s+1e-6,x[2]=u+1e-6}};var Y=function(){this._vertices=null,this._kdNodes=[],this._primitiveIndices=void 0,this._vertexIndices=void 0,this._numVertexIndices=0,this._numPrimitiveIndices=0};r.a.createPrototypeObject(Y,{getVertices:function(){return this._vertices},setVertices:function(e){this._vertices=e},getNumPrimitiveIndices:function(){return this._numPrimitiveIndices},getNumVertexIndices:function(){return this._numVertexIndices},setPrimitiveIndices:function(e){this._primitiveIndices=e},getPrimitiveIndices:function(){return this._primitiveIndices},setVertexIndices:function(e){this._vertexIndices=e},getVertexIndices:function(){return this._vertexIndices},getNodes:function(){return this._kdNodes},addPoint:function(e){var t=this._numVertexIndices;this._primitiveIndices[this._numPrimitiveIndices++]=t,this._vertexIndices[this._numVertexIndices++]=1,this._vertexIndices[this._numVertexIndices++]=e},addLine:function(e,t){var n=this._numVertexIndices;this._primitiveIndices[this._numPrimitiveIndices++]=n,this._vertexIndices[this._numVertexIndices++]=2,this._vertexIndices[this._numVertexIndices++]=e,this._vertexIndices[this._numVertexIndices++]=t},addTriangle:function(e,t,n){var i=this._numVertexIndices;this._primitiveIndices[this._numPrimitiveIndices++]=i,this._vertexIndices[this._numVertexIndices++]=3,this._vertexIndices[this._numVertexIndices++]=e,this._vertexIndices[this._numVertexIndices++]=t,this._vertexIndices[this._numVertexIndices++]=n},addNode:function(e){return this._kdNodes.push(e),this._kdNodes.length-1},build:function(e,t){return new X(this).build(e,t)},_intersectFunctor:function(e,t){var n=-t._first-1,i=n+t._second,r=this._vertexIndices;e.setVertices(this._vertices),e.setPrimitiveIndex(n);for(var a=n;a<i;++a){var o=this._primitiveIndices[a],s=r[o++];3===s?e.operatorTriangle(r[o],r[o+1],r[o+2]):2===s?e.operatorLine(r[o],r[o+1]):1===s?e.operatorPoint(r[o]):H.a.error("KdTree::intersect() unsupported vertices count :"+s)}},intersect:function(e,t){t._first<0?this._intersectFunctor(e,t):e.enter(t._bb)&&(t._first>0&&this.intersect(e,this._kdNodes[t._first]),t._second>0&&this.intersect(e,this._kdNodes[t._second]),e.leave())},intersectLineSegment:function(e,t,n,i){if(t._first<0)this._intersectFunctor(e,t);else{var r=t._nodeRayStart,a=t._nodeRayEnd;u.f.copy(r,n),u.f.copy(a,i);var o,s=this._kdNodes;t._first>0&&(o=s[t._first],e.enter(o._bb,r,a)&&this.intersectLineSegment(e,o,r,a)),t._second>0&&(u.f.copy(r,n),u.f.copy(a,i),o=s[t._second],e.enter(o._bb,r,a)&&this.intersectLineSegment(e,o,r,a))}}},"osg","KdTree");var K=Y,Q=n("r7P/"),J=function(e){if(Q.a.call(this),this._buildOptions={_numVerticesProcessed:0,_targetNumTrianglesPerLeaf:50,_maxNumLevels:20},e){var t=e._targetNumTrianglesPerLeaf,n=e._maxNumLevels;void 0!==t&&(this._buildOptions._targetNumTrianglesPerLeaf=t),void 0!==n&&(this._buildOptions._maxNumLevels=n)}};r.a.createPrototypeObject(J,r.a.objectInherit(Q.a.prototype,{apply:function(e){if(e.getShape&&void 0===e.getShape()){var t=new K;t.build(this._buildOptions,e)&&e.setShape(t)}this.traverse(e)}}),"osg","KdTreeBuilder");var Z=J,$=n("vcgX"),ee=n("4KCM"),te=function(e){a.a.call(this),this.lineWidth=1,void 0!==e&&(this.lineWidth=e)};r.a.createPrototypeStateAttribute(te,r.a.objectInherit(a.a.prototype,{attributeType:"LineWidth",cloneType:function(){return new te},apply:function(e){e.getGraphicContext().lineWidth(this.lineWidth)}}),"osg","LineWidth");var ne=te,ie=n("JNWj"),re=n("wDbS"),ae=n("KL/6"),oe=n("GhR1"),se=n("EnLC"),ue=n("b/No"),le=n("eBAO"),ce=n("Vx0a"),he=n("qRO0"),de=n("WDex"),fe=n("Wx9w"),pe=n("ZLu7"),ge=n("/QLk"),me=function(e){a.a.call(this),this._enable=!e,this._pointSize=1,this._circleShape=!1,this._dirtyHash=!0,this._hash=""};r.a.createPrototypeStateAttribute(me,r.a.objectInherit(a.a.prototype,{attributeType:"PointSize",cloneType:function(){return new me(!0)},setCircleShape:function(e){this._circleShape=e,this._dirtyHash=!0},isCircleShape:function(){return this._circleShape},setEnabled:function(e){this._enable=e,this._dirtyHash=!0},isEnabled:function(){return this._enable},setPointSize:function(e){this._pointSize=e},getOrCreateUniforms:function(){var e=me;return e.uniforms?e.uniforms:(e.uniforms={pointSize:ge.a.createFloat(1,"uPointSize")},e.uniforms)},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+(this.isEnabled()?"1":"0")+(this._circleShape?"1":"0")},apply:function(){this._enable&&this.getOrCreateUniforms().pointSize.setFloat(this._pointSize)}}),"osg","PointSizeAttribute");var ve=me,_e=n("jq0H"),be=[],Se=[];be[G.a.POINTS]=function(){var e=u.f.create();return function(t,n,i,r,a){for(var o=t+n,s=t;s<o;++s){var u=3*i[s];e[0]=a[u],e[1]=a[u+1],e[2]=a[u+2],r.operatorPoint(e)}}}(),be[G.a.LINES]=function(){var e=u.f.create(),t=u.f.create();return function(n,i,r,a,o){for(var s=n+i,u=n;u<s-1;u+=2){var l=3*r[u];e[0]=o[l],e[1]=o[l+1],e[2]=o[l+2],l=3*r[u+1],t[0]=o[l],t[1]=o[l+1],t[2]=o[l+2],a.operatorLine(e,t)}}}(),be[G.a.LINE_STRIP]=function(){var e=u.f.create(),t=u.f.create();return function(n,i,r,a,o){for(var s=n+i,u=n;u<s-1;++u){var l=3*r[u];e[0]=o[l],e[1]=o[l+1],e[2]=o[l+2],l=3*r[u+1],t[0]=o[l],t[1]=o[l+1],t[2]=o[l+2],a.operatorLine(e,t)}}}(),be[G.a.LINE_LOOP]=function(){var e=u.f.create(),t=u.f.create();return function(n,i,r,a,o){for(var s=n+i-1,u=n;u<s;++u){var l=3*r[u];e[0]=o[l],e[1]=o[l+1],e[2]=o[l+2],l=3*r[u+1],t[0]=o[l],t[1]=o[l+1],t[2]=o[l+2],a.operatorLine(e,t)}s=3*r[s],e[0]=o[s],e[1]=o[s+1],e[2]=o[s+2];var c=3*r[0];t[0]=o[c],t[1]=o[c+1],t[2]=o[c+2],a.operatorLine(e,t)}}(),be[G.a.TRIANGLES]=function(){var e=u.f.create(),t=u.f.create(),n=u.f.create();return function(i,r,a,o,s){for(var u=i+r,l=i;l<u;l+=3){var c=3*a[l];e[0]=s[c],e[1]=s[c+1],e[2]=s[c+2],c=3*a[l+1],t[0]=s[c],t[1]=s[c+1],t[2]=s[c+2],c=3*a[l+2],n[0]=s[c],n[1]=s[c+1],n[2]=s[c+2],o.operatorTriangle(e,t,n)}}}(),be[G.a.TRIANGLE_STRIP]=function(){var e=u.f.create(),t=u.f.create(),n=u.f.create();return function(i,r,a,o,s){for(var u=2,l=i;u<r;++u,++l){var c=3*a[l];e[0]=s[c],e[1]=s[c+1],e[2]=s[c+2],c=3*a[l+1],t[0]=s[c],t[1]=s[c+1],t[2]=s[c+2],c=3*a[l+2],n[0]=s[c],n[1]=s[c+1],n[2]=s[c+2],u%2?o.operatorTriangle(e,n,t):o.operatorTriangle(e,t,n)}}}(),be[G.a.TRIANGLE_FAN]=function(){var e=u.f.create(),t=u.f.create(),n=u.f.create();return function(i,r,a,o,s){for(var u=a[i],l=2,c=i+1;l<r;++l,++c){e[0]=s[u],e[1]=s[u+1],e[2]=s[u+2];var h=3*a[c];t[0]=s[h],t[1]=s[h+1],t[2]=s[h+2],h=3*a[c+1],n[0]=s[h],n[1]=s[h+1],n[2]=s[h+2],o.operatorTriangle(e,t,n)}}}(),Se[G.a.POINTS]=function(){var e=u.f.create();return function(t,n,i,r){for(var a=t;a<t+n;++a){var o=3*a;e[0]=r[o],e[1]=r[o+1],e[2]=r[o+2],i.operatorPoint(e)}}}(),Se[G.a.LINES]=function(){var e=u.f.create(),t=u.f.create();return function(n,i,r,a){for(var o=n;o<n+i-1;o+=2){var s=3*o;e[0]=a[s],e[1]=a[s+1],e[2]=a[s+2],s=3*(o+1),t[0]=a[s],t[1]=a[s+1],t[2]=a[s+2],r.operatorLine(e,t)}}}(),Se[G.a.LINE_STRIP]=function(){var e=u.f.create(),t=u.f.create();return function(n,i,r,a){for(var o=n;o<n+i-1;++o){var s=3*o;e[0]=a[s],e[1]=a[s+1],e[2]=a[s+2],s=3*(o+1),t[0]=a[s],t[1]=a[s+1],t[2]=a[s+2],r.operatorLine(e,t)}}}(),Se[G.a.LINE_LOOP]=function(){var e=u.f.create(),t=u.f.create();return function(n,i,r,a){for(var o=n+i-1,s=n;s<o;++s){var u=3*s;e[0]=a[u],e[1]=a[u+1],e[2]=a[u+2],u=3*(s+1),t[0]=a[u],t[1]=a[u+1],t[2]=a[u+2],r.operatorLine(e,t)}o*=3,e[0]=a[o],e[1]=a[o+1],e[2]=a[o+2],n*=3,t[0]=a[n],t[1]=a[n+1],t[2]=a[n+2],r.operatorLine(e,t)}}(),Se[G.a.TRIANGLES]=function(){var e=u.f.create(),t=u.f.create(),n=u.f.create();return function(i,r,a,o){for(var s=i;s<i+r;s+=3){var u=3*s;e[0]=o[u],e[1]=o[u+1],e[2]=o[u+2],u=3*(s+1),t[0]=o[u],t[1]=o[u+1],t[2]=o[u+2],u=3*(s+2),n[0]=o[u],n[1]=o[u+1],n[2]=o[u+2],a.operatorTriangle(e,t,n)}}}(),Se[G.a.TRIANGLE_STRIP]=function(){var e=u.f.create(),t=u.f.create(),n=u.f.create();return function(i,r,a,o){for(var s=2,u=i;s<r;++s,++u){var l=3*u;e[0]=o[l],e[1]=o[l+1],e[2]=o[l+2],l=3*(u+1),t[0]=o[l],t[1]=o[l+1],t[2]=o[l+2],l=3*(u+2),n[0]=o[l],n[1]=o[l+1],n[2]=o[l+2],s%2?a.operatorTriangle(e,n,t):a.operatorTriangle(e,t,n)}}}(),Se[G.a.TRIANGLE_FAN]=function(){var e=u.f.create(),t=u.f.create(),n=u.f.create();return function(i,r,a,o){for(var s=2,u=i+1;s<r;++s,++u){e[0]=o[i],e[1]=o[i+1],e[2]=o[i+2];var l=3*u;t[0]=o[l],t[1]=o[l+1],t[2]=o[l+2],l=3*(u+1),n[0]=o[l],n[1]=o[l+1],n[2]=o[l+2],a.operatorTriangle(e,t,n)}}}();var ye=function(e,t,n){var i=e.getPrimitiveSetList();if(i)for(var r,a=i.length,o=0;o<a;o++){var s=i[o];if(s instanceof O.a){if(r=be[s.getMode()]){var u=s.indices.getElements();r(s.getFirst()/u.BYTES_PER_ELEMENT,s.getCount(),u,t,n)}}else s instanceof A.a&&(r=Se[s.getMode()])&&r(s.getFirst(),s.getCount(),t,n)}},xe=n("ip6O"),Ce=n("QD80"),we=n("jYW0"),Te=n("Usex"),Me=n("05ve"),Ee=n("H9HN"),Ae=n("GfGl"),Oe=n("N3k8"),Re=n("xVfI"),Pe=n("Y6Ma"),Ie=n("vQSd"),Ne=n("CPsH"),Le=n("ULzY"),ke=function(){Le.default.call(this),this._images={};for(var e=0;e<6;e++)this._images[Le.default.TEXTURE_CUBE_MAP_POSITIVE_X+e]=new D.a};r.a.createPrototypeStateAttribute(ke,r.a.objectInherit(Le.default.prototype,{setDefaultParameters:function(){Le.default.prototype.setDefaultParameters.call(this),this._textureTarget=Le.default.TEXTURE_CUBE_MAP,this._flipY=!1},invalidate:function(){Le.default.prototype.invalidate.call(this);for(var e=Le.default.TEXTURE_CUBE_MAP_POSITIVE_X;e<Le.default.TEXTURE_CUBE_MAP_POSITIVE_X+6;e++){var t=this._images[e];this._images[Le.default.TEXTURE_CUBE_MAP_POSITIVE_X].getImage()&&t.dirty()}this.dirty()},cloneType:function(){return new ke},setImage:function(e,t,n){var i=e;"string"==typeof i&&(i=Le.default[i]),this._images[i].setImage(t,n),this.setImageFormat(n),this.setTextureSize(this._images[i].getWidth(),this._images[i].getHeight()),this._textureNull=!1,this.dirty()},getImage:function(e){return this._images[e].getImage()},initCubemapContent:function(e){var t=this._internalFormat;return this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_X,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_NEGATIVE_X,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_Y,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_Z,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,t,this._textureWidth,this._textureHeight,0,t,this._type,null),!0},generateMipmap:function(e,t){if(this.hasMipmapFilter()){if(this._images[Le.default.TEXTURE_CUBE_MAP_POSITIVE_X].hasMipmap())for(var n=0;n<6;n++){var i=this._images[Le.default.TEXTURE_CUBE_MAP_POSITIVE_X+n];i.hasMipmap()||H.a.error("mipmap not set correctly for TextureCubemap");for(var r=this._internalFormat,a=1;a<i.getMipmap().length;a++){var o=i.getMipmap()[a].getWidth();this.applyTexImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,a,r,o,o,0,r,this._type,i.getMipmap()[a].getImage())}}else e.generateMipmap(t);this._dirtyMipmap=!1}},applyImageTarget:function(e,t,n){var i=this._images[n];return i.getImage()&&i.isReady()?i.isDirty()?(this.setTextureSize(i.getWidth(),i.getHeight()),i.setDirty(!1),i.isTypedArray()?this.applyTexImage2D(e,n,0,t,this._textureWidth,this._textureHeight,0,t,this._type,i.getImage()):this.applyTexImage2D(e,n,0,t,t,this._type,i.getImage()),!this._unrefImageDataAfterApply||this.hasMipmap()&&i.hasMipmap()||i.release(),1):1:0},initCubemapContentImage:function(e){var t=this._internalFormat,n=0;return n+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_POSITIVE_X),n+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_NEGATIVE_X),n+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_POSITIVE_Y),n+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_NEGATIVE_Y),n+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_POSITIVE_Z),6===(n+=this.applyImageTarget(e,t,e.TEXTURE_CUBE_MAP_NEGATIVE_Z))},apply:function(e){var t=e.getGraphicContext();if(this._dirtyTextureObject&&(this.releaseGLObjects(),this.setGraphicContext(t)),void 0===this._textureObject||this.isDirty())if(this._textureNull)t.bindTexture(this._textureTarget,null);else{this._textureObject||(this.computeTextureFormat(),this.init(e)),this._textureObject.bind(t),(this._images[Le.default.TEXTURE_CUBE_MAP_POSITIVE_X].getImage()?this.initCubemapContentImage(t):this.initCubemapContent(t))&&(this._dirty=!1,this.applyFilterParameter(t,this._textureTarget),this.generateMipmap(t,this._textureTarget))}else this._textureObject.bind(t),this.isDirtyMipmap()&&this.generateMipmap(t,this._textureTarget)}}),"osg","TextureCubeMap");var De=ke,Fe=n("Ep1f"),Ve=function(){},Be=Ve.functorDrawElements=[],Ue=Ve.functorDrawArrays=[];Be[G.a.TRIANGLES]=function(e,t,n,i){for(var r=e+t,a=e;a<r;a+=3)i(n[a],n[a+1],n[a+2])},Be[G.a.TRIANGLE_STRIP]=function(e,t,n,i){for(var r=2,a=e;r<t;++r,++a)r%2?i(n[a],n[a+2],n[a+1]):i(n[a],n[a+1],n[a+2])},Be[G.a.TRIANGLE_FAN]=function(e,t,n,i){for(var r=n[e],a=2,o=e+1;a<t;++a,++o)i(r,n[o],n[o+1])},Ue[G.a.TRIANGLES]=function(e,t,n){for(var i=2,r=e;i<t;i+=3,r+=3)n(r,r+1,r+2)},Ue[G.a.TRIANGLE_STRIP]=function(e,t,n){for(var i=2,r=e;i<t;++i,++r)i%2?n(r,r+2,r+1):n(r,r+1,r+2)},Ue[G.a.TRIANGLE_FAN]=function(e,t,n){for(var i=2,r=e+1;i<t;++i,++r)n(e,r,r+1)},Ve.prototype={init:function(e,t){this._geom=e,this._cb=t},apply:function(){var e=this._geom.getPrimitiveSetList();if(e)for(var t,n=this._cb,i=e.length,r=0;r<i;r++){var a=e[r];if(a instanceof O.a){if(t=Be[a.getMode()]){var o=a.indices.getElements();t(a.getFirst()/o.BYTES_PER_ELEMENT,a.getCount(),o,n)}}else a instanceof A.a&&(t=Ue[a.getMode()])&&t(a.getFirst(),a.getCount(),n)}}};var je=Ve,Ge=n("GRG7"),He=n("DNxV"),ze=n("oCbj"),We=n("LTZp"),qe=n("zP/P"),Xe=n("FPi9"),Ye=n("kKFa"),Ke=n("AwiE"),Qe={};Qe.AutoTransform=i.a,Qe.BillboardAttribute=s,Qe.BlendColor=c,Qe.BlendFunc=h.a,Qe.BoundingBox=d.a,Qe.BoundingSphere=f.a,Qe.BufferArray=p.a,Qe.BufferArrayProxy=g.a,Qe.ColorMask=_,Qe.Camera=m.a,Qe.ColorMask=_,Qe.ComputeBoundsVisitor=b.default,r.a.objectMix(Qe,S.a),Qe.CullFace=y.a,Qe.CullingSet=x.a,Qe.CullSettings=C.a,Qe.CullStack=w.a,Qe.CullVisitor=T.a,Qe.Depth=M.a,Qe.DrawArrayLengths=E.a,Qe.DrawArrays=A.a,Qe.DrawElements=O.a,Qe.EllipsoidModel=P,Qe.WGS_84_RADIUS_EQUATOR=P.WGS_84_RADIUS_EQUATOR,Qe.WGS_84_RADIUS_POLAR=P.WGS_84_RADIUS_POLAR,Qe.FrameBufferObject=I.a,Qe.FrameStamp=N.a,Qe.Geometry=L.a,Qe.GLObject=k.a,Qe.Image=D.a,Qe.ImageStream=U,Qe.KdTree=K,Qe.KdTreeBuilder=Z,Qe.Light=$.a,Qe.LightSource=ee.a,Qe.LineWidth=ne,Qe.Lod=ie.a,Qe.Material=re.default,r.a.objectMix(Qe,ae.a),Qe.MatrixTransform=oe.a,Qe.PooledResource=se.a,Qe.PooledArray=ue.a,Qe.PooledMap=le.a,Qe.Node=ce.a,Qe.NodeVisitor=Q.a,r.a.objectMix(Qe,H.a),Qe.Object=he.a,Qe.Options=de.a,Qe.PagedLOD=fe.a,Qe.Plane=_e.a,Qe.PointSizeAttribute=ve,Qe.Polytope=pe.a,Qe.primitiveSet=G.a,Qe.primitiveFunctor=ye,Qe.primitiveIndexFunctor=j.a,Qe.Program=xe.a,Qe.Projection=Ce.a,Qe.RenderBin=we.a,Qe.RenderLeaf=Te.a,Qe.RenderStage=Me.a,Qe.Shader=Ee.a,r.a.objectMix(Qe,Ae.a),Qe.StackObjectPairPool=Oe.a,Qe.State=Re.a,Qe.StateAttribute=a.a,Qe.StateGraph=Pe.a,Qe.StateSet=Ie.a,Qe.Scissor=ze.a,Qe.Switch=Ne.a,Qe.Texture=Le.default,Qe.TextureCubeMap=De,Qe.Transform=Fe.a,Qe.TriangleIndexFunctor=je,Qe.Uniform=ge.a,Qe.UpdateVisitor=Ge.a,r.a.objectMix(Qe,r.a),Qe.Viewport=He.a,Qe.VertexArrayObject=Ye.a,Qe.vec2=u.a.vec2,Qe.vec3=u.a.vec3,Qe.vec4=u.a.vec4,Qe.quat=u.a.quat,Qe.mat3=u.a.mat3,Qe.mat4=u.a.mat4,Qe.Transform.RELATIVE_RF=We.a.RELATIVE_RF,Qe.Transform.ABSOLUTE_RF=We.a.ABSOLUTE_RF,Qe.Timer=qe.a,Qe.TimerGPU=Xe.a,Qe.WebGLCaps=Ke.a;t.default=Qe},"60rR":function(e,t){e.exports='varying vec2 vLocalVertex;\n\nuniform float uAlpha;\nuniform int uOutputLinear;\nuniform vec3 uCursorColor;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n  vec4 color = vec4(uCursorColor, 1.0) * uAlpha * smoothstep(0.0, 1.0, 1.0 - 2.0 * length(vLocalVertex));\n\n  gl_FragColor = linearTosRGB(color);\n}\n'},"611C":function(e,t){e.exports='uniform float uRGBMRange;\n\nvarying vec3 vViewNormal;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n   gl_FragColor = encodeRGBM(0.5 * vec3(abs(dot(vViewNormal.xyz, vec3(0.3, 0.6, 0.9)))), uRGBMRange);\n}\n'},"62xh":function(e,t,n){"use strict";var i=function(){i.prototype.reset.call(this)};i.prototype={reset:function(){this._computeNearFar=!0,this._nearFarRatio=.005,this._enableFrustumCulling=!1,this._settingsSourceOverrider=this,this._LODScale=1,this._clampProjectionMatrixCallback=void 0},setCullSettings:function(e){this._computeNearFar=e._computeNearFar,this._nearFarRatio=e._nearFarRatio,this._enableFrustumCulling=e._enableFrustumCulling,this._settingsSourceOverrider=e._settingsSourceOverrider,this._clampProjectionMatrixCallback=e._clampProjectionMatrixCallback},setNearFarRatio:function(e){this._nearFarRatio=e},getNearFarRatio:function(){return this._nearFarRatio},setComputeNearFar:function(e){this._computeNearFar=e},getComputeNearFar:function(){return this._computeNearFar},setEnableFrustumCulling:function(e){this._enableFrustumCulling=e},getEnableFrustumCulling:function(){return this._enableFrustumCulling},getSettingSourceOverrider:function(){return this._settingsSourceOverrider},setClampProjectionMatrixCallback:function(e){this._clampProjectionMatrixCallback=e},getClampProjectionMatrixCallback:function(){return this._clampProjectionMatrixCallback},setLODScale:function(e){this._LODScale=e},getLODScale:function(){return this._LODScale}},t.a=i},"6JLc":function(e,t,n){"use strict";var i=n("icjm"),r=n("a3nb"),a=n("XKim"),o=n("czSk"),s=function(){this._center=o.f.create(),this._radius=-1};r.a.createPrototypeObject(s,{init:function(){o.f.init(this._center),this._radius=-1},valid:function(){return this._radius>=0},set:function(e,t){this._center=e,this._radius=t},center:function(){return this._center},radius:function(){return this._radius},radius2:function(){return this._radius*this._radius},volume:function(){var e=this._radius;return e*e*e*Math.PI*4/3},copy:function(e){this._radius=e._radius,o.f.copy(this._center,e._center)},copyBoundingBox:function(e){e.center(this._center),this._radius=e.radius()},expandByBoundingBox:function(){var e=o.f.create(),t=new a.a;return function(n){if(n.valid())if(this.valid()){o.f.copy(t._min,n._min),o.f.copy(t._max,n._max);for(var i=0;i<8;i++)o.f.sub(e,n.corner(i,e),this._center),o.f.normalize(e,e),o.f.scaleAndAdd(e,this._center,e,-this._radius),t.expandByVec3(e);t.center(this._center),this._radius=t.radius()}else this.copyBoundingBox(n)}}(),expandByvec3:function(e){i.a.warn("deprecated, use expandByVec3"),this.expandByVec3(e)},expandByVec3:function(){var e=o.f.create();return function(t){if(this.valid()){o.f.sub(e,t,this.center(e));var n=o.f.length(e);if(n>this.radius()){var i=.5*(n-this.radius());this._center[0]+=e[0]*(i/n),this._center[1]+=e[1]*(i/n),this._center[2]+=e[2]*(i/n),this._radius+=i}}else this._center[0]=t[0],this._center[1]=t[1],this._center[2]=t[2],this._radius=0}}(),expandRadiusBySphere:function(e){if(e.valid())if(this.valid()){var t=o.f.distance(this._center,e._center)+e._radius;t>this._radius&&(this._radius=t)}else o.f.copy(this._center,e._center),this._radius=e._radius},expandByBoundingSphere:function(e){if(e.valid()){if(!this.valid())return this._center[0]=e._center[0],this._center[1]=e._center[1],this._center[2]=e._center[2],void(this._radius=e.radius());var t=o.f.distance(e.center(),this.center());if(!(t+e.radius()<=this.radius())){if(t+this.radius()<=e.radius())return this._center[0]=e._center[0],this._center[1]=e._center[1],this._center[2]=e._center[2],void(this._radius=e._radius);var n=.5*(this.radius()+t+e.radius()),i=(n-this.radius())/t;this._center[0]+=(e._center[0]-this._center[0])*i,this._center[1]+=(e._center[1]-this._center[1])*i,this._center[2]+=(e._center[2]-this._center[2])*i,this._radius=n}}},contains:function(e){return!!this.valid()&&o.f.sqrDist(this.center(),e)<=this.radius2()},intersects:function(e){if(!this.valid()||!e.valid())return!1;var t=this.radius()+e.radius();return o.f.sqrDist(e.center(),this.center())<=t*t},transformMat4:function(){var e=o.f.create();return function(t,n){if(!this.valid())return t;t._center!==this._center&&(o.f.copy(t._center,this._center),t._radius=this._radius);var i=t._center,r=t._radius;return o.c.getSqrScale(e,n),r*=Math.sqrt(Math.max(Math.max(e[0],e[1]),e[2])),t._radius=r,o.f.transformMat4(i,i,n),t}}()},"osg","BoundingSphere"),t.a=s},"6LWN":function(e,t){e.exports='#pragma include "utils/getLuminance.glsl"\n#pragma include "utils/decodeDepth.glsl"\n#pragma include "supersample.glsl"\n\nuniform sampler2D TextureInput;\nuniform vec2 uTextureInputSize;\nuniform sampler2D TexturePrevious;\nuniform vec2 uTexturePreviousSize;\nuniform sampler2D TextureDepth;\n\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\n\nuniform float uTaaEnabled;\nuniform mat4 uTaaInvViewMatrixLeft;\nuniform mat4 uTaaCurrentFramePVLeft;\nuniform mat4 uTaaLastFramePVLeft;\nuniform vec4 uTaaCornersCSLeft[2];\n\n#ifdef VR_ENABLED\nuniform mat4 uTaaInvViewMatrixRight;\nuniform mat4 uTaaCurrentFramePVRight;\nuniform mat4 uTaaLastFramePVRight;\nuniform vec4 uTaaCornersCSRight[2];\n#endif\n\nvec3 reconstructWSPosition(const in vec2 uv, const in vec4 corners0, const in vec4 corners1, const in mat4 invView, const in float depth) {\n    vec2 finalUv = uv;\n#ifdef VR_ENABLED\n    float xViewportOffset = uv.x >= 0.5 ? -0.5 : 0.0;\n    finalUv.x = ( uv.x + xViewportOffset ) * 2.0;\n#endif\n\n    // the corners are in view space, it means if we interpolate between them we can retrieve the view space direction of the fragment\n    vec4 AB = mix(corners0, corners1, vec4(finalUv.x));\n\n    // multiply this view space direction by the depth gives us the view space position\n    vec3 vsPos = vec3(mix(AB.xy, AB.zw, vec2(finalUv.y)), 1.0) * depth;\n\n    // multiply by the inverse of the view matrix gives us the world space position\n    return (invView * vec4(vsPos, 1.0)).xyz;\n}\n\n#define NEIGHBOUR_SET_IF_DMIN_Z_GREATER(d, x, y) if(d < dmin.z) dmin = vec3(x, y, d);\n#define NEIGHBOUR_CREATE_FROM_OFFSET(d, x, y) d = decodeDepth(TEXTURE_2D_TextureDepth(uv + vec2(x,y)));\n#define FIND_NEIGHBOUR_MIN(d, x, y) NEIGHBOUR_CREATE_FROM_OFFSET(d, x, y); NEIGHBOUR_SET_IF_DMIN_Z_GREATER(d, x, y)\n\n\n// Neighborhood clamping from Tiago Sousa\n// 4tap(decent) comment t, ml, mr, b\n// https://github.com/playdeadgames/temporal/blob/9e6a7704e69bb73f29fe393390e545b21ddfd42d/Assets/Shaders/IncDepth.cginc#L111\n// 9Tap(good) slower but nicer\n// https://github.com/playdeadgames/temporal/blob/9e6a7704e69bb73f29fe393390e545b21ddfd42d/Assets/Shaders/IncDepth.cginc#L37\n//#define CLOSEST_9TAP\nvec3 closestFragment(const in vec2 uv, const in vec2 texelSize) {\n\n    float d;\n    vec2 size = 2.0 * texelSize;\n    vec3 dmin = vec3(0.0, 0.0, 0.0);\n\n    // 5Tap\n    NEIGHBOUR_CREATE_FROM_OFFSET(dmin.z, 0.0, 0.0);\n    FIND_NEIGHBOUR_MIN(d, -size.x, size.y);\n    FIND_NEIGHBOUR_MIN(d, size.x, size.y);\n    FIND_NEIGHBOUR_MIN(d, -size.x, -size.y);\n    FIND_NEIGHBOUR_MIN(d, size.x, -size.y);\n\n#ifdef CLOSEST_9TAP\n    FIND_NEIGHBOUR_MIN(d, 0.0, size.y);\n    FIND_NEIGHBOUR_MIN(d, -size.x, 0.0);\n    FIND_NEIGHBOUR_MIN(d, size.x, 0.0);\n    FIND_NEIGHBOUR_MIN(d, 0.0, -size.y);\n#endif\n\n    return vec3(uv + dmin.xy, dmin.z);\n}\n\n// note: only clips towards aabb center (but fast!)\n// same as https://github.com/gokselgoktas/temporal-anti-aliasing/blob/master/Assets/Resources/Shaders/TemporalAntiAliasing.cginc#L199\n// which is adapted from https://github.com/playdeadgames/temporal\n// using the mathematical similar version of https://twitter.com/Stubbesaurus/status/890154773726580736\n// exhibits numerical issue (in a consistent way on intel/nvidia at least)\nvec4 clip_aabb_opti(const in vec4 minimum, const in vec4 maximum, const in vec4 color) {\n    const float eps = 0.00000001;\n\n    vec4 center = 0.5 * (maximum + minimum);\n    vec4 extents = 0.5 * (maximum - minimum) + eps;\n    vec4 offset = color - center;\n\n    vec4 ts = abs(offset / extents);\n    float t = max(max(ts.r, ts.g), max(ts.b, ts.a));\n    return center + offset / max(1.0, t);\n    // return t > 1.0 : center + offset / t : color;\n}\n\nvec4 taa(const in vec2 ssVel, const in vec2 texelSize) {\n    vec2 uv = gTexCoord;\n\n    vec4 tl = TEXTURE_2D_TextureInput(uv + vec2(-texelSize.x, texelSize.y));\n    vec4 t  = TEXTURE_2D_TextureInput(uv + vec2(0.0, texelSize.y));\n    vec4 tr = TEXTURE_2D_TextureInput(uv + vec2(texelSize.x, texelSize.y));\n\n    vec4 ml = TEXTURE_2D_TextureInput(uv + vec2(-texelSize.x, 0.0));\n    vec4 m  = TEXTURE_2D_TextureInput(uv);\n    vec4 mr = TEXTURE_2D_TextureInput(uv + vec2(texelSize.x, 0.0));\n\n    vec4 bl = TEXTURE_2D_TextureInput(uv + vec2(-texelSize.x, -texelSize.y));\n    vec4 b  = TEXTURE_2D_TextureInput(uv + vec2(0.0, -texelSize.y));\n    vec4 br = TEXTURE_2D_TextureInput(uv + vec2(texelSize.x, -texelSize.y));\n\n    // sharpen\n    // https://github.com/Unity-Technologies/PostProcessing/blob/v1/PostProcessing/Resources/Shaders/TAA.cginc#L143\n    // reduces blurring, but increases flickering with dense geometry\n    vec4 corners = 2.0 * (tr + bl + br + tl) - 2.0 * m;\n    m += (m - (corners * 0.166667)) * 2.718282 * 0.3;\n    m = max(vec4(0.0), m);\n\n    // Brian Karis neighbourhood rounding: http://advances.realtimerendering.com/s2014/epic/TemporalAA.pptx\n    // average of rounded pattern with cross pattern\n    vec4 cmin5 = min(mr, min(m, min(ml, min(t, b))));\n    vec4 cmin = min(cmin5, min(tl, min(tr, min(bl, br))));\n\n    vec4 cmax5 = max(mr, max(m, max(ml, max(t, b))));\n    vec4 cmax = max(cmax5, max(tl, max(tr, max(bl, br))));\n\n    cmin = 0.5 * (cmin + cmin5);\n    cmax = 0.5 * (cmax + cmax5);\n\n    vec4 previousColor = TEXTURE_2D_TexturePrevious(uv - ssVel);\n    previousColor = clip_aabb_opti(cmin, cmax, previousColor);\n\n    float lum0 = getLuminance(m.rgb);\n    float lum1 = getLuminance(previousColor.rgb);\n    float diff = abs(lum0 - lum1) / max(lum0, max(lum1, 0.2));\n    float unbiased_weight = 1.0 - diff;\n    float feedback = mix(FEEDBACK_MIN, FEEDBACK_MAX, unbiased_weight * unbiased_weight);\n\n    return mix(m, previousColor, feedback);\n}\n\nvec2 computeSSVelocity(const in vec3 wsPos, const in mat4 currentFrameProjView, const in mat4 lastFrameProjView, const in bool rightEye)\n{\n    vec4 ssCurrentPos = currentFrameProjView * vec4(wsPos, 1.0);\n    vec4 ssPrevPos = lastFrameProjView * vec4(wsPos, 1.0);\n\n    vec2 ndcCurrent = ssCurrentPos.xy / ssCurrentPos.w;\n    vec2 ndcPrev = ssPrevPos.xy / ssPrevPos.w;\n\n    //ndcPrev = clamp(ndcPrev, vec2(-1.0), vec2(1.0));\n    if(ndcPrev.x >= 1.0 || ndcPrev.x <= -1.0 || ndcPrev.x >= 1.0 || ndcPrev.y <= -1.0)\n        return vec2(0.0);\n\n#ifdef VR_ENABLED\n    ndcCurrent.x /= 2.0;\n    ndcPrev.x /= 2.0;\n\n    if (rightEye) {\n        ndcCurrent.x += 0.5;\n        ndcPrev.x += 0.5;\n    }\n#endif\n\n    return 0.5 * (ndcCurrent - ndcPrev);\n}\n\n\nvec4 computeTaa(const in mat4 invView, const in mat4 currentFrameProjView, const in mat4 lastFrameProjView, const in vec4 corners0, const in vec4 corners1) {\n    vec2 uv = gTexCoord;\n    float haltz = abs(uHalton.z);\n    if (haltz == 1.0) {\n        vec2 texelSize = vec2(1.0) / uTextureInputSize;\n        vec3 closest = closestFragment(uv, texelSize);\n\n        // discard background fragments to save fillrate\n        // make sure the mesh isn\'t transparent\n        if (closest.z >= 1.0\n#ifdef TAA_TRANSPARENT\n            && decodeAlpha(TEXTURE_2D_TextureDepth(closest.xy)) == 0.0\n#endif\n        ) {\n            // unjitter for fixed background with highres pattern or text\n            return TEXTURE_2D_TextureInput(uv - 0.5 * uHalton.xy * texelSize);\n        }\n\n        float depth = -(uNearFar.x + (uNearFar.y - uNearFar.x) * closest.z);\n        vec3 ws = reconstructWSPosition(closest.xy, corners0, corners1, invView, depth);\n\n        vec2 ssVel = computeSSVelocity(ws, currentFrameProjView, lastFrameProjView, uv.x >= 0.5);\n        return taa(ssVel, texelSize);\n    }\n\n    return supersample();\n}\n\n// temporal anti-aliasing from Playdead\'s Inside\n// slides: http://www.gdcvault.com/play/1022970/Temporal-Reprojection-Anti-Aliasing-in\n// sources: https://github.com/playdeadgames/temporal\nvec4 supersampleTaa() {\n    if (uTaaEnabled == 0.0) {\n        return supersample();\n    }\n\n#ifdef VR_ENABLED\n    // left and right eyes have different matrices\n    if (gTexCoord.x >= 0.5) {\n        return computeTaa(uTaaInvViewMatrixRight, uTaaCurrentFramePVRight, uTaaLastFramePVRight, uTaaCornersCSRight[0], uTaaCornersCSRight[1]);\n    }\n#endif\n\n    return computeTaa(uTaaInvViewMatrixLeft, uTaaCurrentFramePVLeft, uTaaLastFramePVLeft, uTaaCornersCSLeft[0], uTaaCornersCSLeft[1]);\n}'},"6ZYx":function(e,t,n){"use strict";var i=n("icjm"),r=n("a3nb"),a=n("Ep1f"),o=n("czSk"),s=n("r7P/"),u=n("LTZp"),l=n("Vx0a"),c=function(){a.a.call(this),this._matrix=o.c.create(),this._position=o.f.create(),this._matrixDirty=!0,this._scale=o.f.fromValues(1,1,1),this._minimumScale=0,this._maximumScale=Number.MAX_VALUE,this._rotation=o.d.create(),this._pivotPoint=o.f.create(),this._autoScaleToScreen=!1,this._autoRotateToScreen=!1,this._cachedMatrix=o.c.create(),this._firstTimeToInitEyePoint=!0,this._autoScaleTransitionWidthRatio=.25,this._billboardAttribute=void 0,this._previousWidth=0,this._previousHeight=0,this._previousProjection=o.c.create(),this._previousModelView=o.c.create(),this._previousPosition=o.f.create()};r.a.createPrototypeNode(c,r.a.objectInherit(a.a.prototype,{getMatrix:function(){return this._matrix},setMatrix:function(e){this._matrix=e,this.dirtyBound()},setPosition:function(e){this._position=e,this._matrixDirty=!0,this.dirtyBound()},getPosition:function(){return this._position},setRotation:function(e){this._rotation=e,this._matrixDirty=!0,this.dirtyBound()},getRotation:function(){return this._rotation},setScale:function(e){this.setScaleFromVec3(o.f.fromValues(e,e,e))},setScaleFromvec3:function(e){i.a.warn("deprecated, use setScaleFromVec3"),this.setScaleFromVec3(e)},setScaleFromVec3:function(e){this._scale=e,this._matrixDirty=!0,this.dirtyBound()},getScale:function(){return this._scale},setMinimumScale:function(e){this._minimumScale=e},getMinimumScale:function(){return this._minimumScale},setMaximumScale:function(e){this._maximumScale=e},getMaximumScale:function(){return this._maximumScale},setAutoScaleToScreen:function(e){this._autoScaleToScreen=e,this._matrixDirty=!0},getAutoScaleToScreen:function(){return this._autoScaleToScreen},setAutoRotateToScreen:function(e){this._autoRotateToScreen=e},getAutoRotateToScreen:function(){return this._autoRotateToScreen},setAutoScaleTransitionWidthRatio:function(e){this._autoScaleTransitionWidthRatio=e},getAutoScaleTransitionWidthRatio:function(){return this._autoScaleTransitionWidthRatio},computeLocalToWorldMatrix:function(e){this._matrixDirty&&this.computeMatrix(),this.referenceFrame===u.a.RELATIVE_RF?o.c.mul(e,e,this._matrix):o.c.copy(e,this._matrix)},computeMatrix:function(){var e=o.f.create(),t=o.c.create();return function(){this._matrixDirty&&(o.c.fromQuat(this._matrix,this._rotation),o.c.fromTranslation(t,this._position),o.c.mul(this._matrix,t,this._matrix),o.c.scale(this._matrix,this._matrix,this._scale),o.c.translate(this._matrix,this._matrix,o.f.neg(e,this._pivotPoint)),this._matrixDirty=!1)}}(),computeWorldToLocalMatrix:function(){var e=o.f.create(),t=o.d.create(),n=o.f.create(),i=o.c.create();return function(r){return(0!==this.scale[0]||0!==this.scale[1]||0!==this.scale[2])&&(n[0]=1/this._scale[0],n[1]=1/this._scale[1],n[2]=1/this._scale[2],this.referenceFrame===u.a.RELATIVE_RF?(o.c.fromTranslation(i,o.f.neg(e,this._position)),o.c.mul(r,i,r),o.d.zeroRotation(this._rotation)||(o.c.fromQuat(i,o.d.invert(t,this._rotation)),o.c.mul(r,i,r)),o.c.fromScaling(i,n),o.c.mul(r,i,r),o.c.fromTranslation(i,this._pivotPoint),o.c.mul(r,i,r)):(o.c.fromQuat(this._matrix,o.d.invert(t,this._rotation)),o.c.translate(r,r,o.f.neg(e,this._position)),o.c.fromScaling(i,n),o.c.mul(r,i,r),o.c.fromTranslation(i,this._pivotPoint),o.c.mul(r,i,r)),!0)}}(),computeBound:function(){var e=o.c.create();return function(t){return this._autoScaleToScreen&&this._firstTimeToInitEyePoint?t:(l.a.prototype.computeBound.call(this,t),t.valid()?(o.c.identity(e),this.computeLocalToWorldMatrix(e),t.transformMat4(t,e),t):t)}}(),accept:function(e){if(e.getVisitorType()===s.a.CULL_VISITOR){var t=e.getViewport().width(),n=e.getViewport().height(),i=e.getCurrentProjectionMatrix(),r=e.getCurrentModelViewMatrix(),a=this._position,u=this._firstTimeToInitEyePoint;if(this._firstTimeToInitEyePoint||(t!==this._previousWidth||n!==this._previousHeight?u=!0:o.c.exactEquals(i,this._previousProjection)&&o.c.exactEquals(r,this._previousModelView)&&o.f.exactEquals(a,this._previousPosition)||(u=!0)),this._firstTimeToInitEyePoint=!1,u){if(this._autoScaleToScreen){var c=e.getViewport(),h=this.computePixelSizeVector(c,i,r),d=o.g.fromValues(this._position[0],this._position[1],this._position[2],1),f=o.g.dot(d,h),p=1/(f=.48/f);if(this._autoScaleTransitionWidthRatio>0){var g,m,v;if(this._minimumScale>0){var _=this._minimumScale,b=this._maximumScale<Number.MAX_VALUE?this._minimumScale+(this._maximumScale-this._minimumScale)*this._autoScaleTransitionWidthRatio:this._minimumScale*(1+this._autoScaleTransitionWidthRatio);v=_+(m=1-2*(g=1/(4*(b-_)))*b)*m/(4*g),p<-m/(2*g)?p=this._minimumScale:p<b&&(p=v+m*p+g*(p*p))}if(this._maximumScale<Number.MAX_VALUE){var S=this._maximumScale,y=this._minimumScale>0?this._maximumScale+(this._minimumScale-this._maximumScale)*this._autoScaleTransitionWidthRatio:this._maximumScale*(1-this._autoScaleTransitionWidthRatio);v=S+(m=1-2*(g=1/(4*(y-S)))*y)*m/(4*g),p>-m/(2*g)?p=this._maximumScale:p>y&&(p=v+m*p+g*(p*p))}}this.setScale(p)}if(this._autoRotateToScreen){var x=o.d.create();o.c.getRotation(x,r),this.setRotation(o.d.invert(x,x))}this._previousWidth=t,this._previousHeight=n,o.f.copy(this._previousPosition,a),o.c.copy(this._previousProjection,i),o.c.copy(this._previousModelView,r)}}l.a.prototype.accept.call(this,e)},computePixelSizeVector:function(){var e=o.f.create(),t=o.f.create();return function(n,i,r){var a=i[0]*n.width()*.5,s=i[8]*n.width()*.5+i[11]*n.width()*.5;o.f.set(e,r[0]*a+r[2]*s,r[4]*a+r[6]*s,r[8]*a+r[10]*s);var u=i[5]*n.height()*.5,l=i[9]*n.height()*.5+i[11]*n.height()*.5;o.f.set(t,r[1]*u+r[2]*l,r[5]*u+r[6]*l,r[9]*u+r[10]*l);var c=i[11],h=i[15],d=o.g.fromValues(r[2]*c,r[6]*c,r[10]*c,r[14]*c+r[15]*h),f=.7071067811/Math.sqrt(o.f.sqrLen(e)+o.f.sqrLen(t));return o.g.scale(d,d,f),d}}()}),"osg","AutoTransform"),t.a=c},"6c2W":function(e,t,n){"use strict";n.r(t);var i=n("RIqP"),r=n.n(i),a=n("22T1");Object(a.default)(!0);n("fv4G");var o=n("EVdn"),s=n.n(o),u=(n("1HiF"),n("qk7X"),n("qCPs")),l=n("9mpE"),c=n("UpVh"),h=n("MXQz"),d=n("O67m"),f=n("DTPh"),p=n("dZz+"),g=n("vBtE");var m=n("gBaA"),v=n("/fpw"),_=n("fgaA"),b=n("+L90"),S=n("tSPY"),y=n("9hCi"),x=S.a.extend({events:{"click .share-link button":"copyToClipboard",'click [data-action="share-on-facebook"]':"shareOnFacebook",'click [data-action="share-on-linkedin"]':"shareOnLinkedin",'click [data-action="share-on-pinterest"]':"shareOnPinterest",'click [data-action="share-on-reddit"]':"shareOnReddit",'click [data-action="share-on-tumblr"]':"shareOnTumblr",'click [data-action="share-on-twitter"]':"shareOnTwitter"},constructor:function(){this.handleKeyboardEvents=this.handleKeyboardEvents.bind(this),S.a.prototype.constructor.apply(this,arguments)},show:function(){var e=this;this.model||(this.model=this.viewer._currentModel),this.model.sharing(),this.model.on("change:sharing",this.render.bind(this)),S.a.prototype.show.apply(this,arguments),this.clipboard||Promise.all([n.e(47),n.e(48),n.e(56),n.e(57),n.e(64)]).then(n.t.bind(null,"Ddwv",7)).then(function(t){e.clipboard=new t.default(e.$(".share-link button")[0]),e.listenClipboard.call(e),"function"==typeof e.callAfterClipboardLoaded&&e.callAfterClipboardLoaded()})},delegateEvents:function(){S.a.prototype.delegateEvents.apply(this,arguments),s()(document).on("keyup",this.handleKeyboardEvents)},undelegateEvents:function(){S.a.prototype.undelegateEvents.apply(this,arguments),s()(document).off("keyup",this.handleKeyboardEvents)},handleKeyboardEvents:function(e){27===e.keyCode&&this.hide()},render:function(){this.$(".share-link .text").val(this.model.get("sharing").shortUrl),this.$(".share-social").attr("href",this.model.get("viewerUrl")+"#email"),this.$(".share-embed .button").attr("href",this.model.get("viewerUrl")+"#embed"),this.$(".share-mail").attr("href",y.a.getMailTo({modelName:this.model.get("name"),userName:this.model.get("user").displayName,url:this.model.get("viewerUrl"),isCollectionMode:!1}))},listenClipboard:function(){this.clipboard.on("success",function(){var e=this.viewer?this.viewer:this.options.embedPage.viewer;e&&e.subviews.osd.show("Copied to clipboard.",{duration:5e3,position:"top"})}.bind(this)),this.clipboard.on("error",function(){this.viewer.subviews.osd.show("Could not copy to clipboard.",{duration:5e3,position:"top"})}.bind(this))},copyToClipboard:function(){this.clipboard||(this.callAfterClipboardLoaded=this.copyToClipboard)},getShareModel:function(){return n.e(167).then(n.bind(null,"R2FZ")).then(function(e){return e.default})},shareOnFacebook:function(e){var t=this;e.preventDefault(),this.getShareModel().then(function(e){m.a.shareButtonClicked("embedShareOverlay","facebookShareButtonClicked",t.model.get("uid")),e.shareOnFacebook(t.model.get("sharing").shortUrl)})},shareOnTwitter:function(e){var t=this;e.preventDefault(),this.getShareModel().then(function(e){m.a.shareButtonClicked("embedShareOverlay","twitterShareButtonClicked",t.model.get("uid")),e.shareOnTwitter(t.model.toJSON(),t.model.get("sharing"))})},shareOnPinterest:function(e){var t=this;e.preventDefault(),this.getShareModel().then(function(e){m.a.shareButtonClicked("embedShareOverlay","pinterestShareButtonClicked",t.model.get("uid")),e.shareOnPinterest(t.model.toJSON(),t.model.get("sharing"))})},shareOnReddit:function(e){var t=this;e.preventDefault(),this.getShareModel().then(function(e){m.a.shareButtonClicked("embedShareOverlay","redditShareButtonClicked",t.model.get("uid")),e.shareOnReddit(t.model.toJSON(),t.model.get("sharing"))})},shareOnTumblr:function(e){var t=this;e.preventDefault(),this.getShareModel().then(function(e){m.a.shareButtonClicked("embedShareOverlay","tumblrShareButtonClicked",t.model.get("uid")),e.shareOnTumblr(t.model.toJSON(),t.model.get("sharing"))})},shareOnLinkedin:function(e){var t=this;e.preventDefault(),this.getShareModel().then(function(e){m.a.shareButtonClicked("embedShareOverlay","linkedinShareButtonClicked",t.model.get("uid")),e.shareOnLinkedin(t.model.toJSON(),t.model.get("sharing"))})}}),C=g.a.extend({mixins:[f.a,d.a],events:{'click [data-action="start"]':"start",'click [data-action="allowRestricted"]':"allowRestricted"},initialize:function(){if(this.options.model.get("hasEnterpriseTracking")&&m.a.initializeEnterprise(),function(){var e=!0,t=!1;try{t=window.self!==window.top}catch(e){t=!0}try{document.cookie}catch(t){e=!1}return t&&!e}())this.$el.addClass("embed-sandboxed");else if(g.a.prototype.initialize.apply(this,arguments),!0!==this.model.get("isDeleted")){var e=!!Object(_.a)().autostart;(e||Object(_.a)().apiId)&&this.start(e);var t=Object(_.a)().uiInfos;if(void 0===t){var n=Object(_.a)().descButton;t=void 0===n||n}this.initializeSharingOverlay(),this.afterRender()}},start:Object(h.a)(function(e){this.initializeViewer(e)}),allowRestricted:function(){p.a.me().setAllowsRestricted(!0),this.$(".overlay.restricted").addClass("hidden")},initializeSharingOverlay:function(){this.shareOverlay=new x({el:this.$(".share.overlay"),model:this.model,embedPage:this}),this.onShareClick=this.onShareClick.bind(this),this.$(".titlebar .actions .share").on("click",this.onShareClick)},onShareClick:function(){this.shareOverlay.show(),m.a.modelEmbedShareButtonClicked(this.model.get("uid"))},onViewerStart:function(){this.$(".titlebar .actions .share").off("click",this.onShareClick)},onViewerStop:function(){},initializeViewer:function(e){var t=this.$(".viewer");this.$(".play-button").addClass("loading"),e&&t.addClass("started");var n=new b.a({el:t});this.viewer=n;var i=Object(_.a)().apiVersion,r=c.a.create(Object(_.a)().apiId,i,n,this.model.get("uid"));n.on("start",this.onViewerStart),n.on("stop",this.onViewerStop),n.setScene({uid:this.model.get("uid"),features:v.a,viewerAPI:r.getViewerAPI()}),this.$(".play-button").removeClass("loading"),r?(this.api=r,r.ready(),r.clientReady().then(function(){e&&n.start(e)})):e&&n.start(e)},toggleUserSummary:function(){var e=!(!this.inAvatar&&!this.inUserSummary);this.userSummary[e?"show":"hide"]()},enterAvatar:function(e){var t=s()(e.currentTarget).data("user");this.inAvatar=!0,this.userSummary.setUser(t),this.userSummary.anchor(e.currentTarget),this.toggleUserSummary()},leaveAvatar:function(){this.inAvatar=!1,this.toggleUserSummary()},enterUserSummary:function(){this.inUserSummary=!0,this.toggleUserSummary()},leaveUserSummary:function(){this.inUserSummary=!1,this.toggleUserSummary()}}),w=n("bx6R"),T=n("kxvO"),M=[Object(w.c)("models:embed",function(e){var t=e.model_id;return u.a.get(l.c.string("model",t)).then(function(e){return"ok"===e.get("displayStatus")?new C({model:e,el:"body"}):new T.a({el:"body"})})})],E=n("UWrD"),A=n("Z+Lw"),O=n("bd6H"),R=n("nZll");Object(R.b)(function(){if(Object(E.a)(),Object(A.a)()){!function(){var e=["Float32Array","Uint32Array","Int32Array","Uint16Array","Int16Array","Uint8Array","Int8Array"];for(var t in e)window[e[t]]=function(){return[]}}();var e=document.location.pathname.match(/models\/(.*?)\/embed/);if(e){var t=e[1];u.a.get(t).then(function(e){new C({model:e,el:"body"})})}}else{var n=new O.a;n.add.apply(n,r()(M)),n.start()}})},"6uKY":function(e,t,n){"use strict";n.r(t),n.d(t,"underscorify",function(){return f}),n.d(t,"slugify",function(){return p}),n.d(t,"escapeHTML",function(){return S}),n.d(t,"decodeHTMLEntities",function(){return y}),n.d(t,"urlize",function(){return x}),n.d(t,"stripTags",function(){return C}),n.d(t,"sanitize",function(){return w}),n.d(t,"paragraphy",function(){return T}),n.d(t,"pluralize",function(){return M}),n.d(t,"findWithDelimiters",function(){return E}),n.d(t,"kebabToCamelCase",function(){return A}),n.d(t,"camelToKebabCase",function(){return O}),n.d(t,"escapeRegExp",function(){return R}),n.d(t,"snakeToCamelCase",function(){return P}),n.d(t,"camelToSnakeCase",function(){return I}),n.d(t,"rangeToString",function(){return N}),n.d(t,"stringToRange",function(){return L}),n.d(t,"normalizePath",function(){return k}),n.d(t,"formatOrderUid",function(){return D});var i=n("EVdn"),r=n.n(i),a=n("ZjUL"),o=n.n(a),s=n("+Z1G"),u=n("qAkX"),l=/(\s|^)\S+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+(\s|$)/g,c=/(\s|^)(https?:\/\/)?(?:(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?(?=(\s|$))/g,h=/(\s|^)(@[a-zA-Z0-9._-]{2,30})/g,d=/sketchfab\.com/;function f(e){return e.replace(/([A-Z])/g,"_$1").toLowerCase()}function p(e){return e.replace(/[^\w\s-]+/g,"").trim().toLowerCase().replace(/[-\s]+/g,"-")}var g=function(e,t){var n=t.replace(/^(https?:\/\/)?(www\.)?/,"");return e&&n.length<=e?n.substr(0,e)+"...":n},m=function(e){return e.match(/^(@[a-zA-Z0-9._-]{2,30})/)[0]},v=function(e){var t=e.split(/^(@[a-zA-Z0-9._-]{2,30})/);return t.length>3?t.join(""):t[1]+"</a>"+t[2]},_=function(e){return e.match(/^https?:\/\//)?e:"http://"+e},b=function(e,t){var n=e.match(/^\s/),i=e.match(/\s$/);return(n?n[0]:"")+t+(i?i[0]:"")};function S(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\\/g,"")}function y(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.trimUrlLimit,i=void 0===n?0:n,r=t.target,a=void 0===r?"":r,o=t.noFollow,s=["noopener","noreferrer"].concat(void 0===o||o?["nofollow"]:[]),u=a?' target="'+a+'"':"";return e.replace(c,function(e){var t=S(e.trim()),n=d.test(t)?s.slice(0,-1).join(" "):s.join(" ");return b(e,'<a href="'.concat(_(t),'" rel="').concat(n,'"').concat(u,">").concat(g(i,t),"</a>"))}).replace(l,function(e){var t=e.trim();return b(e,'<a href="mailto:'+t+'">'+t+"</a>")}).replace(h,function(e){var t=e.trim();return(e.match(/^\s/)?" ":"")+'<a href="'+window.location.origin+"/"+m(t).substring(1)+'" rel="'+s.join(" ")+'">'+v(t)})}function C(e){return o.a.sanitize(e,{ALLOWED_TAGS:[]})}function w(e){return r()("<div/>").html(o.a.sanitize(e,{ALLOWED_TAGS:[]}).trim()).text()}function T(e){var t=e.match(/.+/g);return t?t.map(function(e){return"<p>".concat(e,"</p>")}).join(""):e}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return 1===e?t:n}function E(e,t,n){return e.split(t).pop().split(n)[0]}function A(e){return e.replace(/-./g,function(e){return e.toUpperCase().replace("-","")})}function O(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}function R(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function P(e){return e.replace(/_./g,function(e){return e.toUpperCase().replace("_","")})}function I(e){return e.replace(/[A-Z]/g,function(e){return"_"+e.toLowerCase()})}function N(e){return e.start+".."+e.end}function L(e){var t=e.split("..");return{start:parseFloat(t[0]||0),end:parseFloat(t[1]||0)}}function k(e){return e.split("/").reduce(function(e,t){return t?"."===t?e:".."===t&&e.length?Object(s.a)(e,1):e.concat(t):e},[]).join("/")+("/"===Object(u.a)(e)?"/":"")}var D=function(e){return"#".concat(e.substring(0,6))}},"6xPH":function(e,t,n){"use strict";var i=!1;t.a=function(e){return void 0!==e&&(i=e),i}},"6xf5":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("pVnL"),r=n.n(i),a=n("QILm"),o=n.n(a),s=n("q1tI"),u=n("wsGC");function l(e){var t=e.children,n=e.className,i=e.type,a=e.center,l=o()(e,["children","className","type","center"]);return s.createElement("div",r()({},l,{className:Object(u.a)("c-message",n,{"--center":a,"--error":"error"===i,"--warning":"warning"===i,"--info":"info"===i})}),t)}},"77vZ":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("MVZn"),r=n.n(i),a=n("nzRv"),o=n("gCTM"),s=n("V5OH"),u=n("X2EN");function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.a.extend({displayName:"Popup",mixins:[u.a],defaultOptions:r()({},e.prototype.defaultOptions,t),children:{componentWrapper:{selector:".js-popup-content",viewClass:a.a.extend({displayName:"PopupWrapper(".concat(e.prototype.displayName,")"),template:function(){return o.default.getFromString("{{ components.child | component }}",{components:this.createChildrenComponents({child:{viewClass:e,options:this.options}})})}}),options:function(){return r()({},this.options,{popup:{continue:this.continue.bind(this),cancel:this.cancel.bind(this),open:this.open.bind(this),close:this.close.bind(this),remove:this.remove.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),center:this.center.bind(this),resize:this.resize.bind(this),autofocus:this.autofocus.bind(this)}})}}},template:function(){return o.default.getFromString('\n                <div class="popup-container">\n                    <div class="popup-overlay"></div>\n                    <div class="js-popup js-popup-content c-popup__container"></div>\n                </div>\n                ',{})}})}},"7E8H":function(e,t,n){"use strict";var i=n("a3nb"),r=n("qRO0"),a=n("GhR1"),o=function(){r.a.call(this)};o.checkPathIsAnimated=function(e){for(var t=0,n=e.length;t<n;++t){var i=e[t];if(i instanceof a.a)for(var r=i.getUpdateCallbackList(),s=0,u=r.length;s<u;++s)if(r[s]instanceof o)return!0}return!1},i.a.createPrototypeObject(o,i.a.objectInherit(r.a.prototype,{computeChannels:function(){},reset:function(){}}),"osgAnimation","AnimationUpdateCallback"),t.a=o},"7VuN":function(e,t){e.exports='#pragma include "utils/encodeDecode.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\n// manual refract mostly to re-use dot(I, N)\nvec3 batchRefract(const in vec3 I, const in vec3 N , const in float eta, const in float dotNI) {\n    float k = 1.0 - eta * eta * (1.0 - dotNI * dotNI);\n    return (k < 0.0) ? vec3(0.0) :  eta * I - (eta * dotNI + sqrt(k)) * N;\n}\n\nuniform float uOpacityIOR;\nuniform vec3 uOpacityRefractionColor;\n\nuniform float uBoxRadius;\nuniform int uIsVr;\nuniform sampler2D uTextureToBeRefracted;\nuniform vec2 uTextureToBeRefractedSize;\nuniform mat4 uProjectionMatrix;\nuniform vec4 uPreviousHalton;\nuniform vec2 uPreviousGlobalTexRatio;\nuniform vec2 uPreviousGlobalTexSize;\nuniform vec2 uGlobalTexSize;\n\n#ifndef HAS_REFRACTION_NORMAL_OFFSET\n    uniform sampler2D uTextureMipmapDepth;\n    uniform vec2 uNearFar;\n    uniform vec2 uGlobalTexRatio;\n    uniform mat4 uPreviousProjection;\n    uniform vec4 uTaaCornersCSLeft[2];\n#endif\n\nvec3 refraction(\n    const in float roughness,\n    const in vec3 normalSurface,\n\n#ifdef HAS_REFRACTION_NORMAL_OFFSET\n    const in vec3 normalVertex\n#else\n    const in vec3 eyeVector\n#endif\n)\n\n{\n\n#ifdef HAS_REFRACTION_NORMAL_OFFSET\n    // no reprojection and no depth compare for the normal offset version (not worth it as for the moment)\n    vec2 uv = gl_FragCoord.xy / uGlobalTexSize.xy + (normalVertex.xy - normalSurface.xy) * (uOpacityIOR - 1.0);\n#else\n    float dotNI = -dot(eyeVector, normalSurface);\n\n    // compute UV at distortion point\n    // https://en.wikibooks.org/wiki/GLSL_Programming/Unity/Curved_Glass\n    vec3 pos = vViewVertex.xyz + uBoxRadius * batchRefract(-eyeVector, normalSurface, 1.0 / uOpacityIOR, dotNI);\n    pos = (uProjectionMatrix * vec4(pos, 1.0)).xyw; // we discard z and only keep the perspective divide\n    vec2 uv = 0.5 + 0.5 * pos.xy / pos.z;\n\n    if (uIsVr == 1) {\n        // no reprojection in vr (would require another uTaaCornersCSRight uniform)\n        uv.x *= 0.5;\n        if (gl_FragCoord.x > uGlobalTexSize.x * 0.5) uv.x += 0.5;\n    } else {\n        // we discard refraction on pixels that are in front of refracted surface by\n        // comparing current pixel depth with depth at refraction point\n        // if we are on the background we take the depth of the current position\n        #ifdef DEPTH_MIPMAP\n            vec3 pack = texture2D(uTextureMipmapDepth, uPreviousGlobalTexRatio * vec2(uv.x, (1.0 - uv.y) * 0.5)).xyz;\n            float depthRefracted = pack.x == 1.0 ? (-vViewVertex.z - uNearFar.x) / (uNearFar.y - uNearFar.x) : decode24(pack);\n        #else\n            vec4 pack = texture2D(uTextureMipmapDepth, uGlobalTexRatio * uv);\n            float depthRefracted = pack.x == 1.0 ? (-vViewVertex.z - uNearFar.x) / (uNearFar.y - uNearFar.x) : decodeDepth(pack);\n        #endif\n\n        // compute view space refracted position from depth\n        vec4 AB = mix(uTaaCornersCSLeft[0], uTaaCornersCSLeft[1], uv.x);\n        pos = vec3(mix(AB.xy, AB.zw, uv.y), 1.0) * -(uNearFar.x + (uNearFar.y - uNearFar.x) * depthRefracted);\n\n        // pos is computed with last frame projection which is not entirely correct\n        if (dot(pos.xyz - vViewVertex.xyz, normalSurface) > 0.00001) {\n            uv = gl_FragCoord.xy / uGlobalTexSize.xy;\n        } else {\n            // reproject view vector\n            pos = (uPreviousProjection * vec4(pos, 1.0)).xyw;\n            uv.xy = 0.5 + 0.5 * pos.xy / pos.z;\n        }\n    }\n#endif\n\n    // unjitter (so that the refraction is stable when doing supersampling)\n    uv -= 0.5 * uPreviousHalton.xy / uPreviousGlobalTexSize.xy;\n\n    // repeat mirror for out of screen fetches (it\'s better than a sudden cut)\n    // we can\'t simply use MIRRORED_REPEAT because of manual mipmap\n    uv = abs(uv); \n    if (uv.x > 1.0) uv.x -= 2.0 * (uv.x - 1.0);\n    if (uv.y > 1.0) uv.y -= 2.0 * (uv.y - 1.0);\n\n    // adjusts roughness-to-mipmap depending of distance from surface (aka: consistent blurring even when we unzoom)\n    float adjustRoughness = clamp(uProjectionMatrix[1][1] / 12.0 * uBoxRadius / -vViewVertex.z, 0.0, 1.0);\n    float adjustFactor = 0.05; // the higher it is, the sharper it will be when we are far away\n    adjustRoughness = (1.0 + adjustFactor) * adjustRoughness / (adjustFactor + adjustRoughness);\n\n    // roughness support\n    float maxLod = 7.0;\n    float lodLevel = maxLod * min(0.99, roughness * adjustRoughness); // same as in pbr\n\n    float lowerLevel = floor(lodLevel);\n    float higherLevel = min(maxLod, lowerLevel + 1.0);\n    float lerpFactor = lodLevel - lowerLevel; // [0,1]\n\n    // see packMipmapRefraction.glsl\n    // mipmap packing of refracted texture (the packing is not optimal and is a bit naive):\n    // level0: (1-uv)/2\n    // level1: (3-uv)/4\n    // level2: (7-uv)/8\n    // level3: (15-uv)/16\n    // level4: (31-uv)/32\n    // etc...\n\n    float powLevel = pow(2.0, higherLevel);\n\n    // border pixel issue with bilinear...\n    vec2 pixelSize = 2.0 * powLevel / uTextureToBeRefractedSize;\n    uv = max(pixelSize, min(1.0 - pixelSize, uv));\n\n    // lower uv\n    vec2 uvLower = vec2(2.0 * uv.x, powLevel - 1.0 - uv.y) * uPreviousGlobalTexRatio.xy / powLevel;\n\n    // higher uv\n    powLevel *= 2.0;\n    vec2 uvHigher = vec2(2.0 * uv.x, powLevel - 1.0 - uv.y) * uPreviousGlobalTexRatio.xy / powLevel;\n\n    // manual lerp, mixing rgbm colors exhibits visible seams\n    vec3 fetch = mix(decodeRGBM(texture2D(uTextureToBeRefracted, uvLower), 7.0), decodeRGBM(texture2D(uTextureToBeRefracted, uvHigher), 7.0), lerpFactor);\n\n#ifndef HAS_REFRACTION_NORMAL_OFFSET\n    // reduce bright fresnel effect, it darkens/accentuates the edges in some cases (very rough surface)\n    fetch.rgb -= fetch.rgb * pow(clamp(1.0 + dotNI, 0.0, 1.0), 4.0);\n#endif\n\n    return uOpacityRefractionColor * fetch.rgb;\n}\n'},"7cZc":function(e,t,n){"use strict";var i=n("ZLu7"),r=function(){this._mask=r.DEFAULT_CULLING,this._frustum=new i.a};r.prototype={reset:function(){this._mask=r.DEFAULT_CULLING,this._frustum.clear()},setCullingMask:function(e){this._mask=e},getCullingMask:function(){return this._mask},setFrustum:function(e){this._frustum=e},getFrustum:function(){return this._frustum},getCurrentResultMask:function(){return this._frustum.getCurrentMask()},pushCurrentMask:function(){this._frustum.pushCurrentMask()},popCurrentMask:function(){this._frustum.popCurrentMask()},resetCullingMask:function(){this._frustum.setResultMask(this._frustum.getCurrentMask())},isBoundingBoxCulled:function(e){return!(!(this._mask&r.VIEW_FRUSTUM_CULLING)||this._frustum.containsBoundingBox(e))},isBoundingSphereCulled:function(e){return!(!(this._mask&r.VIEW_FRUSTUM_CULLING)||this._frustum.containsBoundingSphere(e))},isVerticesCulled:function(e){return!(!(this._mask&r.VIEW_FRUSTUM_CULLING)||this._frustum.containsVertices(e))}},r.NO_CULLING=0,r.VIEW_FRUSTUM_LEFT_CULLING=1,r.VIEW_FRUSTUM_RIGHT_CULLING=2,r.VIEW_FRUSTUM_TOP_CULLING=3,r.VIEW_FRUSTUM_BOTTOM_CULLING=4,r.NEAR_PLANE_CULLING=5,r.FAR_PLANE_CULLING=6,r.VIEW_FRUSTUM_SIDES_CULLING=r.VIEW_FRUSTUM_LEFT_CULLING|r.VIEW_FRUSTUM_RIGHT_CULLING|r.VIEW_FRUSTUM_BOTTOM_CULLING|r.VIEW_FRUSTUM_TOP_CULLING,r.VIEW_FRUSTUM_CULLING=r.VIEW_FRUSTUM_SIDES_CULLING|r.NEAR_PLANE_CULLING|r.FAR_PLANE_CULLING,r.DEFAULT_CULLING=r.VIEW_FRUSTUM_SIDES_CULLING,r.ENABLE_ALL_CULLING=r.VIEW_FRUSTUM_CULLING,t.a=r},"8/dv":function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("q1tI"),o=n("/MKj"),s=n("M4AY"),u=n("wsGC"),l=n("gPpI"),c=n("M+Bz"),h=n("J4zp"),d=n.n(h),f=a.createContext({isOpen:!1,setIsOpen:function(){}}),p=function(e){var t=e.children,n=a.useState(!1),i=d()(n,2),o=i[0],s=i[1];return r()(f.Provider,{value:{isOpen:o,setIsOpen:s}},void 0,t)},g=r()("a",{className:"c-page-header__action__icon-container","aria-label":"Navigation menu"},void 0,r()("i",{className:"c-page-header__action__icon fa fa-bars"})),m=function(e){var t=e.className,n=a.useContext(f).setIsOpen;return r()("div",{className:Object(u.a)("c-page-header__action",t),onClick:function(){return n(function(e){return!e})}},void 0,g)},v=n("P1HB"),_=n("TCxt"),b=n("/f4T"),S=n("KbKu");function y(e){var t=e.className,n=e.children,i=e.header,o=a.useRef(null),s=a.useState(!1),l=d()(s,2),c=l[0],h=l[1];return r()("section",{className:Object(u.a)("c-navigation-accordion",t,{"--active":c})},void 0,r()("header",{onClick:function(){h(function(e){return!e}),o.current&&(o.current.style.maxHeight?o.current.style.maxHeight="":o.current.style.maxHeight=o.current.scrollHeight+"px")},className:"c-navigation-accordion__header"},void 0,i),a.createElement("div",{ref:o,className:"c-navigation-accordion__panel"},n))}function x(e){var t=e.href,n=e.target,i=e.SEOTitle,a=e.title,o=e.icon,s=e.anchor,l=void 0===s?"":s;return r()("a",{href:t+l,title:i||a,target:n},void 0,r()("li",{className:"responsive-navigation__link"},void 0,o?r()("i",{className:Object(u.a)("icon","--translucent",o)}):null,r()("span",{},void 0,a)))}var C=r()("li",{className:"responsive-navigation__link"},void 0,"Upgrade"),w=function(e){var t=e.authUser,n=e.onLogout,i=a.useContext(f).isOpen;return r()(y,{header:r()("div",{className:"responsive-navigation__username"},void 0,r()(_.a,{user:t,withAvatar:!0,noLink:!0}))},void 0,r()("ul",{className:"section"},void 0,r()(x,{title:"Newsfeed",href:Object(l.e)("feeds:following")}),r()(x,{title:"Models",href:t.modelsUrl}),r()(x,{title:"Collections",href:t.collectionsUrl}),r()(S.a,{authUser:t,className:"responsive-navigation__link",isDisplayed:i}),r()(x,{title:"Likes",href:t.likesUrl}),r()(x,{title:"Purchases",href:Object(l.e)("users:profile_purchases",{username:t.username})}),r()(x,{title:"Sales",href:Object(l.e)("users:profile_sales",{username:t.username})}),Object(v.l)(t)?r()("a",{id:"hover-menu__upgrade-account",className:"--show",href:Object(l.e)("pages:plans")},void 0,C):null,r()(x,{title:"Settings",href:Object(l.e)("users:settings_profile")}),r()("li",{},void 0,r()(b.a,{className:"responsive-navigation__link",type:"textified",href:Object(l.e)("users:signout"),text:"Logout",onClick:n}))))},T=n("pVnL"),M=n.n(T),E=n("12sq"),A=r()("h3",{className:"title"},void 0,"Explore"),O=r()("i",{className:"icon --translucent fa fa-download"}),R=r()("span",{},void 0,"Downloadable"),P=r()("li",{className:"responsive-navigation__separator"}),I=a.memo(function(e){var t=e.anchor,n=void 0===t?"":t,i=e.subdomainAnchor,o=void 0===i?"":i;return r()(y,{className:"section navigation responsive-navigation__section",header:A},void 0,r()("ul",{},void 0,[{title:"All categories",href:Object(l.e)("categories:list"),icon:"custom-icons icon-model-icon"},{title:"Popular",href:Object(l.e)("models:popular"),SEOTitle:"Popular 3D models",icon:"custom-icons icon-popular"},{title:"Staff picks",href:Object(l.e)("models:staffpicks"),SEOTitle:"Staff picks 3D models",icon:"custom-icons icon-staffpicks-icon"}].map(function(e){return a.createElement(x,M()({key:e.title},e))}),r()("li",{className:"responsive-navigation__link"},void 0,r()("a",{title:"Downloadable 3D models",href:Object(l.e)("models:explore",{},{features:"downloadable",date:"week",sort_by:"-likeCount"})},void 0,O,R)),r()(x,{title:"Collections",SEOTitle:"3D models collections",href:Object(l.e)("collections:popular"),icon:"custom-icons icon-collection"}),P,[{title:"Blog",href:E.a.hosts.communityBlog,target:"_blank",anchor:n},{title:"Forum",href:E.a.hosts.discourse,target:"_blank",anchor:o},{title:"Community members",href:Object(l.e)("users:explore_users"),target:"_blank"}].map(function(e){return a.createElement(x,M()({key:e.title},e))})))}),N=r()("h3",{className:"title"},void 0,"Buy 3D models"),L=r()("li",{className:"responsive-navigation__link"},void 0,r()("i",{className:"icon --translucent custom-icons icon-model-icon"}),r()("span",{},void 0,"All categories")),k=r()("li",{className:"responsive-navigation__link"},void 0,r()("i",{className:"icon --translucent custom-icons icon-best-selling"}),r()("span",{},void 0,"Best selling")),D=r()("li",{className:"responsive-navigation__link"},void 0,r()("i",{className:"icon --translucent fa fa-film"}),r()("span",{},void 0,"Animated")),F=r()("li",{className:"responsive-navigation__link"},void 0,r()("i",{className:"icon --translucent custom-icons icon-pbr"}),r()("span",{},void 0,"PBR")),V=r()("li",{className:"responsive-navigation__link"},void 0,r()("i",{className:"icon --translucent custom-icons icon-low-poly"}),r()("span",{},void 0,"Low poly")),B=r()("li",{className:"responsive-navigation__link"},void 0,r()("i",{className:"icon --translucent custom-icons icon-high-poly"}),r()("span",{},void 0,"High poly")),U=r()("li",{className:"responsive-navigation__link"},void 0,r()("i",{className:"icon --translucent custom-icons icon-d-printing"}),r()("span",{},void 0,"3D Printable")),j=r()("li",{className:"responsive-navigation__link"},void 0,r()("i",{className:"icon --translucent custom-icons icon-D-Scan"}),r()("span",{},void 0,"3D Scan")),G=a.memo(function(){return r()(y,{className:"section navigation responsive-navigation__section",header:N},void 0,r()("ul",{},void 0,r()("a",{href:Object(l.e)("store:categories_list")},void 0,L),r()("a",{title:"Best selling 3D models",href:Object(l.e)("store:search",{},{sort_by:"-orderCount"})},void 0,k),r()("a",{title:"Animated 3D models",href:Object(l.e)("store:search",{},{animated:!0})},void 0,D),r()("a",{title:"PBR 3D models",href:Object(l.e)("store:search",{},{pbr:!0})},void 0,F),r()("a",{title:"Low poly 3D models",href:Object(l.e)("store:search",{},{min_face_count:"0",max_face_count:"10000"})},void 0,V),r()("a",{title:"High poly 3D models",href:Object(l.e)("store:search",{},{min_face_count:"100000",ref:"header"})},void 0,B),r()("a",{title:"3D Printable 3D models",href:Object(l.e)("store:search",{},{file_formats:["stl"],ref:"header"})},void 0,U),r()("a",{title:"3D Scan 3D models",href:Object(l.e)("store:search",{},{q:["scan"],sort_by:"-orderCount",ref:"header"})},void 0,j)))}),H=r()("h3",{className:"title"},void 0,"For business"),z=a.memo(function(e){var t=e.anchor,n=void 0===t?"":t,i=[{title:"Enterprise Solutions",href:Object(l.e)("pages:enterprise"),anchor:n},{title:"Sketchfab for Teams",href:Object(l.e)("pages:features_teams"),anchor:n},{title:"3D Viewer",href:Object(l.e)("pages:viewer"),anchor:n},{title:"3D eCommerce",href:Object(l.e)("pages:ecommerce"),anchor:n},{title:"3D Configurators",href:Object(l.e)("pages:configurator"),anchor:n},{title:"Developers & API",href:Object(l.e)("pages:developers"),anchor:n},{title:"Pricing",href:Object(l.e)("pages:plans"),anchor:n},{title:"Customer Stories",href:E.a.hosts.enterpriseBlog,anchor:n}];return r()(y,{className:"section navigation responsive-navigation__section",header:H},void 0,r()("ul",{},void 0,i.map(function(e){return a.createElement(x,M()({key:e.title},e))})))}),W=n("dvlG");n.d(t,"a",function(){return J}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return p});var q=Object(o.c)(function(e){return{authUser:s.c.authUser.user(e)}},{logout:s.a.authUser.logout}),X=r()("li",{className:"section navigation responsive-navigation__section"},void 0,r()("a",{className:"title",href:"/"},void 0,"Home")),Y=r()(I,{anchor:"?ref=header",subdomainAnchor:"?utm_source=website&utm_campaign=responsive_navigation"}),K=r()(G,{}),Q=r()(z,{anchor:"?ref=header"}),J=a.memo(q(function(e){var t=e.logout,n=e.authUser,i=a.useRef(null),o=a.useContext(f),s=o.isOpen,h=o.setIsOpen,d=Object(c.a)(function(e){return e.preventDefault(),t()});return a.useEffect(function(){var e=document.querySelectorAll(".content, .responsive-navigation-slidable"),t=!0,n=!1,i=void 0;try{for(var r,a=e[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){r.value.classList.toggle("slided",s)}}catch(e){n=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}document.querySelector("html").classList.toggle("noscroll",s)},[s]),Object(W.a)(i,function(){h(!1)}),a.createElement(a.Fragment,null,a.createElement("div",{ref:i,className:Object(u.a)("responsive-navigation",{slided:s})},r()("ul",{className:"inner"},void 0,r()("li",{className:"section navigation responsive-navigation__section --primary"},void 0,r()("ul",{},void 0,n.isAnonymous?r()("li",{className:"responsive-navigation__connection-actions"},void 0,r()("a",{href:Object(l.e)("users:signin"),className:"button btn-medium btn-primary title responsive-navigation__login"},void 0,"Login"),r()("a",{href:Object(l.e)("users:signup"),className:"button btn-medium btn-important responsive-navigation__signup"},void 0,"Sign up")):r()(w,{authUser:n,onLogout:d}))),n.isAnonymous?X:null,Y,K,Q)),r()("div",{className:Object(u.a)("responsive-navigation-bind-out",{slided:s})}))}))},"82Lz":function(e,t){e.exports="#ifdef ICON\nattribute vec2 TexCoord0;\nvarying vec2 vTexCoord0;\n#endif\n\n#ifdef HEMI\nvarying vec3 vLocalVertex;\n#endif\n\nattribute vec3 Vertex;\n\nvarying vec4 vViewPos;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n#ifdef ICON\n  vTexCoord0 = TexCoord0;\n#endif\n\n#ifdef HEMI\n  vLocalVertex = Vertex;\n#endif\n\n  vViewPos = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  gl_Position = uProjectionMatrix * vViewPos;\n}\n"},8348:function(e,t,n){"use strict";(function(e){var i=n("QILm"),r=n.n(i),a=n("MVZn"),o=n.n(a),s=n("fp5s"),u=n("RzKY"),l=n("wWmz");t.a=function(t){return function(n){var i=n.getState,a=n.dispatch,c=o()({getState:i,dispatch:a},t);return function(t){return function(n){if(!n.payload||"function"!=typeof n.payload.effect)return t(n);var i=n.payload,h=i.effect,d=r()(i,["effect"]),f={isEffect:!0,effectId:Object(s.a)()},p=function(e){a({type:n.type,payload:o()({},d,{effect:new l.c(e)}),meta:f}),console.error("Effect error:",e)},g=function(e){a({type:n.type,payload:o()({},d,{effect:new l.d(e)}),meta:f})};a({type:n.type,payload:o()({},d,{effect:new l.b}),meta:f});try{var m=h(c);return Object(u.e)(m)?m.catch(function(e){throw p(e),e}).then(function(e){return g(e),e}):(g(m),e.resolve(m))}catch(t){return p(t),e.reject(t)}}}}}}).call(this,n("CSL1"))},"89mf":function(e,t,n){"use strict";n.d(t,"c",function(){return h}),n.d(t,"g",function(){return d}),n.d(t,"d",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"f",function(){return g}),n.d(t,"a",function(){return m});var i=n("RIqP"),r=n.n(i),a=n("ANjH");n.d(t,"b",function(){return a.d});var o=n("vJtL"),s=n("cGwl"),u=n("0Uag"),l=n("BeL+"),c=n("RzKY");function h(e){return e}function d(e){return Object(o.a)(e)?e:Object(s.a)(e)}function f(){}var p=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).leading,n=void 0===t||t,i=!0,a=!0,o=[];return function(){for(var t=arguments.length,s=new Array(t),u=0;u<t;u++)s[u]=arguments[u];if(o=s,i&&n)i=!1,e.apply(void 0,r()(o));else{if(!a)return;a=!1,window.requestAnimationFrame(function(){a=!0,e.apply(void 0,r()(o))})}}},g=Object(u.a)(function(e,t,n){var i=t;return function(t){return i=e(i,t),n(i)}}),m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=[],i=Object(c.c)(function(){var t=r()(n);return n=[],e(t)},t);return function(e){return n=Object(l.a)(n.concat(e)),i()}}},"8eYQ":function(e,t,n){"use strict";var i=n("WSEr"),r=n("3CEA"),a=n("gtzJ"),o=n("dZz+"),s=n("12sq"),u=n("QKgc"),l={exactMatch:["plugin.setSuspendState is not a function","undefined","can't find property for object ","null is not an object (evaluating 'ext.MAX_TEXTURE_MAX_ANISOTROPY_EXT')","undefined is not an object (evaluating 'window.__pad.performLoop')","Non-Error promise rejection captured with keys: _dirty, _height, _imageObject","Non-Error promise rejection captured with keys: currentTarget, detail, isTrusted, target","Cannot read property '_avast_submit' of undefined","DataCloneError","Timeout","The play method is not allowed by the user agent or the platform in the current context, possibly because the user denied permission."],partialMatch:["NS_ERROR","Error when downloading url"]};t.a={client:i,debounceMap:{},install:function(){if(s.a.useSentry){var e=o.a.me();r.e({beforeSend:this.onBeforeSend.bind(this),release:s.a.version,blacklistUrls:[/extensions\//i,/^chrome:\/\//i,/^moz-extension:\/\//i,/webtoolbar\//i],dsn:s.a.sentryDSN}),e.isAuthenticated()&&a.e(function(t){t.setUser({id:e.get("uid"),username:e.get("username"),email:e.get("email")})})}else console.warn("Sentry was not installed ; it is manually disabled.");return i},onBeforeSend:function(e,t){var i,r;if(void 0===e.exception||void 0===e.exception.values||!e.exception.values.length||!e.exception.values[0])return null;var a=e.exception.values[0];if(Object(u.n)(a))return null;if("UnhandledRejection"===a.type&&(null===t||void 0===t?void 0:null===(i=t.data)||void 0===i?void 0:i.stack)&&(!t.data.stack.message||!t.data.stack.name))return null;if("ChunkLoadError"===a.type)return null;var o=null===t||void 0===t?void 0:t.originalException;if(o&&Object(u.n)(o))return null;var s=(o&&("string"==typeof o?o:o.message)||a.value||"No Error Message").replace("Error: ","");if(l.exactMatch.includes(s))return null;if(l.partialMatch.some(function(e){return s.includes(e)}))return null;if(s.indexOf("undefined")&&(-1!==s.indexOf("osgjs/osg/GLObject")||-1!==s.indexOf("window.Map")))return null;var c=Date.now(),h="";if(null===(r=a.stacktrace)||void 0===r?void 0:r.frames)try{h=a.stacktrace.frames.reduce(function(e,t){return t?e+t.filename+t.lineno+";":e},"")}catch(e){}var d=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(s+h),f="No Error Message"!==s&&c-this.debounceMap[d]<500;if(this.debounceMap[d]=Date.now(),f)return null;if((0,n("22T1").default)()&&window.MSInputMethodContext&&document.documentMode)return null;var p=navigator.userAgent.toLowerCase();return-1!==p.indexOf("msie")&&9===parseInt(p.split("msie")[1])?null:e}}},"8jpW":function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("q1tI"),o=n.n(a),s=n("oTSI"),u=n("gPpI"),l=n("wsGC"),c=n("12sq"),h=n("FcGm"),d=n("pVnL"),f=n.n(d),p=r()("g",{fill:"none",fillRule:"evenodd"},void 0,r()("path",{d:"M0 0h18v18H0z"}),r()("path",{className:"prefix__social-link-path",d:"M.234 18H4.1V5.848H.234V18zM4.35 2.101C4.34 1.494 4.138.992 3.747.595 3.357.198 2.838 0 2.191 0 1.545 0 1.018.198.611.595.204.992 0 1.495 0 2.101c0 .595.198 1.095.594 1.497.396.403.912.604 1.547.604h.017c.658 0 1.188-.201 1.59-.604.4-.402.601-.902.601-1.497zM14.136 18H18v-6.969c0-1.798-.407-3.157-1.221-4.08-.814-.922-1.89-1.383-3.229-1.383-1.517 0-2.682.683-3.496 2.049h.033V5.848H6.223c.034.77.034 4.821 0 12.152h3.864v-6.794c0-.443.04-.77.117-.98.168-.409.419-.756.753-1.042.335-.286.747-.43 1.238-.43 1.294 0 1.94.917 1.94 2.75V18z",fill:"#999",fillRule:"nonzero"})),g=function(e){return o.a.createElement("svg",f()({width:18,height:18},e),p)},m=r()("g",{fill:"none",fillRule:"evenodd"},void 0,r()("path",{d:"M0 0h18v18H0z"}),r()("path",{className:"prefix__social-link-path",d:"M9.318 0C4.453 0 2 3.522 2 6.459c0 1.778.667 3.36 2.097 3.95.234.096.444.003.512-.26.048-.18.16-.638.21-.829.068-.26.041-.35-.148-.576-.412-.491-.676-1.127-.676-2.028 0-2.613 1.937-4.952 5.042-4.952 2.75 0 4.26 1.697 4.26 3.963 0 2.98-1.306 5.497-3.246 5.497-1.071 0-1.873-.895-1.616-1.992.308-1.31.904-2.723.904-3.669 0-.846-.45-1.552-1.381-1.552-1.095 0-1.975 1.144-1.975 2.676 0 .976.327 1.636.327 1.636l-1.317 5.634c-.392 1.672-.06 3.722-.031 3.93.017.122.173.151.243.058.101-.133 1.406-1.758 1.849-3.383.125-.46.72-2.842.72-2.842.356.685 1.396 1.289 2.501 1.289 3.292 0 5.525-3.03 5.525-7.086C15.8 2.856 13.227 0 9.318 0",fill:"#999"})),v=function(e){return o.a.createElement("svg",f()({width:18,height:18},e),m)},_=r()("g",{fill:"none",fillRule:"evenodd"},void 0,r()("path",{d:"M0 0h18v18H0z"}),r()("path",{className:"prefix__social-link-path",d:"M10.074 18V9.787h2.747l.414-3.203h-3.161V4.541c0-.515.108-.901.324-1.16.216-.257.637-.386 1.263-.386l1.684-.013V.124C12.765.041 11.946 0 10.888 0 9.637 0 8.636.368 7.886 1.104c-.75.736-1.125 1.776-1.125 3.12v2.36H4v3.203h2.76V18h3.314z",fill:"#999",fillRule:"nonzero"})),b=function(e){return o.a.createElement("svg",f()({width:18,height:18},e),_)},S=r()("g",{fill:"none",fillRule:"evenodd"},void 0,r()("path",{d:"M0 0h18v18H0z"}),r()("path",{className:"prefix__social-link-path",d:"M9 0C6.556 0 6.25.01 5.29.054S3.676.25 3.104.473A4.411 4.411 0 001.51 1.51c-.5.5-.809 1.002-1.039 1.594C.25 3.677.098 4.33.054 5.289.01 6.25 0 6.556 0 9s.01 2.75.054 3.71c.044.959.196 1.613.418 2.185.23.592.538 1.094 1.039 1.594.5.5 1.002.808 1.594 1.039.572.222 1.226.374 2.184.418C6.25 17.99 6.556 18 9 18s2.75-.01 3.71-.054c.959-.044 1.613-.196 2.185-.418a4.412 4.412 0 001.594-1.039c.5-.5.809-1.002 1.039-1.594.222-.572.374-1.226.418-2.184C17.99 11.75 18 11.444 18 9s-.01-2.75-.054-3.71c-.044-.959-.196-1.613-.418-2.185a4.412 4.412 0 00-1.039-1.594c-.5-.5-1.002-.809-1.594-1.038C14.323.25 13.67.098 12.711.054 11.75.01 11.444 0 9 0m0 1.622c2.403 0 2.688.009 3.637.052.877.04 1.354.187 1.67.31.421.163.72.358 1.036.673.315.315.51.615.673 1.035.123.317.27.794.31 1.671.043.95.052 1.234.052 3.637s-.009 2.688-.052 3.637c-.04.877-.187 1.354-.31 1.67a2.79 2.79 0 01-.673 1.036c-.315.315-.615.51-1.035.673-.317.123-.794.27-1.671.31-.95.043-1.234.052-3.637.052s-2.688-.009-3.637-.052c-.877-.04-1.354-.187-1.671-.31a2.788 2.788 0 01-1.035-.673 2.789 2.789 0 01-.673-1.035c-.123-.317-.27-.794-.31-1.671-.043-.95-.052-1.234-.052-3.637s.009-2.688.052-3.637c.04-.877.187-1.354.31-1.67a2.79 2.79 0 01.673-1.036c.315-.315.615-.51 1.035-.673.317-.123.794-.27 1.671-.31.95-.043 1.234-.052 3.637-.052M9 12a3 3 0 110-6 3 3 0 010 6m0-7.622a4.622 4.622 0 110 9.244 4.622 4.622 0 010-9.244zm5.884-.182a1.08 1.08 0 11-2.16 0 1.08 1.08 0 012.16 0z",fill:"#999"})),y=function(e){return o.a.createElement("svg",f()({width:18,height:18},e),S)},x=r()("g",{fill:"none",fillRule:"evenodd"},void 0,r()("path",{d:"M0 0h18v18H0z"}),r()("path",{className:"prefix__social-link-path",d:"M18 3.723a7.82 7.82 0 01-2.127.597c.797-.468 1.342-1.154 1.635-2.056a7.341 7.341 0 01-2.356.896C14.438 2.387 13.541 2 12.462 2c-1.019 0-1.889.36-2.61 1.081a3.557 3.557 0 00-1.08 2.61c0 .34.029.622.087.844a10.45 10.45 0 01-4.254-1.142A10.464 10.464 0 011.23 2.668a3.656 3.656 0 00-.51 1.863c0 1.336.534 2.362 1.6 3.076-.55-.011-1.136-.164-1.757-.457v.036c0 .878.292 1.66.878 2.346.586.686 1.307 1.11 2.163 1.275-.34.093-.64.14-.897.14-.152 0-.38-.023-.686-.07a3.753 3.753 0 001.31 1.828c.627.48 1.339.727 2.136.738-1.36 1.055-2.889 1.582-4.588 1.582-.305 0-.598-.017-.879-.052a10.355 10.355 0 005.66 1.652 10.76 10.76 0 003.692-.624c1.148-.416 2.132-.973 2.953-1.67.82-.697 1.526-1.5 2.118-2.408a10.612 10.612 0 001.318-2.848c.287-.99.43-1.977.43-2.962 0-.21-.005-.369-.017-.474A7.175 7.175 0 0018 3.723z",fill:"#999",fillRule:"nonzero"})),C=function(e){return o.a.createElement("svg",f()({width:18,height:18},e),x)},w=Object(s.a)(function(e){return[{title:"enterprise",links:[{href:Object(u.e)("pages:enterprise",{},{ref:"footer"}),text:"Enterprise Solutions"},{href:Object(u.e)("pages:configurator",{},{ref:"footer"}),text:"3D Configurators"},{href:Object(u.e)("pages:ecommerce",{},{ref:"footer"}),text:"3D eCommerce"},{href:Object(u.e)("pages:viewer",{},{ref:"footer"}),text:"3D Viewer"},{href:Object(u.e)("pages:advertising",{},{ref:"footer"}),text:"3D Advertising"},{href:Object(u.e)("pages:features_teams",{},{ref:"footer"}),text:"Sketchfab for Teams"},{href:c.a.hosts.enterpriseBlog+"?ref=footer",text:"Customer Stories"},{href:Object(u.e)("pages:plans",{},{ref:"footer"}),text:"Pricing"}]},{title:"ecosystem",links:[{href:Object(u.e)("pages:exporters"),text:"Exporters"},{href:Object(u.e)("pages:importers"),text:"Importers"},{href:Object(u.e)("pages:developers"),text:"Developers & API"},{href:c.a.hosts.faq+"/articles/360040824252-Augmented-Reality-AR-"+e,text:"Augmented Reality"},{href:Object(u.e)("pages:virtual_reality"),text:"Virtual Reality"},{href:Object(u.e)("pages:mobile"),text:"Mobile App"}]},{title:"store",links:[{href:Object(u.e)("store:home",{},{ref:"footer"}),text:"Buy 3D models"},{href:Object(u.e)("store:search",{},{sort_by:"-orderCount",ref:"footer"}),text:"Best Selling"},{href:Object(u.e)("store:categories_list",{},{ref:"footer"}),text:"Categories"},{href:c.a.hosts.faq+"/articles/115004259063-Selling-your-3D-Models"+e,text:"Become a Seller"},{href:Object(u.e)("pages:features_download",{},{ref:"footer"}),text:"Free 3D Models"}]},{title:"community",links:[{href:Object(u.e)("models:popular"),text:"Explore"},{href:c.a.hosts.faq+e,text:"Help Center"},{href:Object(u.e)("pages:education"),text:"Education"},{href:Object(u.e)("pages:museums"),text:"Museums"},{href:c.a.hosts.communityBlog+"?ref=footer",text:"Blog"},{href:c.a.hosts.discourse+e,text:"Forum"}]},{title:"about",links:[{href:Object(u.e)("pages:about"),text:"Company"},{href:Object(u.e)("pages:careers"),text:"Careers"},{href:Object(u.e)("pages:press"),text:"Press Kit"},{href:Object(u.e)("pages:features"),text:"Features"},{href:Object(u.e)("pages:about")+"#contact",text:"Contact us",className:"button btn-large btn-primary main-footer__button"}]}]}),T=r()("div",{className:"main-footer__copyrights"},void 0,r()(h.a,{className:"main-footer__logo",brand:!1}),r()("span",{},void 0,"2020 Sketchfab - All Rights reserved")),M=r()("span",{className:"main-footer__social-links"},void 0,r()("a",{href:"https://twitter.com/Sketchfab",rel:"noopener noreferrer",target:"_blank",className:"skfb-link","aria-label":"Follow us on Twitter"},void 0,r()(C,{})),r()("a",{href:"https://www.instagram.com/sketchfab",rel:"noopener noreferrer",target:"_blank",className:"skfb-link","aria-label":"Follow us on Instagram"},void 0,r()(y,{})),r()("a",{href:"https://www.facebook.com/Sketchfab",rel:"noopener noreferrer",target:"_blank",className:"skfb-link","aria-label":"Follow us on Facebook"},void 0,r()(b,{})),r()("a",{href:"https://www.pinterest.com/sketchfab",rel:"noopener noreferrer",target:"_blank",className:"skfb-link","aria-label":"Follow us on Pinterest"},void 0,r()(v,{})),r()("a",{href:"https://www.linkedin.com/company/sketchfab",rel:"noopener noreferrer",target:"_blank",className:"skfb-link","aria-label":"Follow us on Linkedin"},void 0,r()(g,{})));t.a=o.a.memo(function(e){var t=e.hideNavigation,n="?utm_source=website&utm_campaign=footer",i=w(n);return r()("footer",{className:"main-footer"},void 0,r()("div",{className:"container"},void 0,t?null:r()("nav",{className:"main-footer__navigation"},void 0,i.map(function(e){return r()("div",{className:"main-footer__col"},e.title,r()("h3",{className:"main-footer__title"},void 0,e.title),r()("ul",{className:"main-footer__links"},void 0,e.links.map(function(e){return r()("li",{className:"main-footer__link"},e.text,r()("a",{className:Object(l.a)("skfb-link",e.className),href:e.href},void 0,e.text))})))})),r()("div",{className:"main-footer__copyrights-container"},void 0,T,r()("span",{className:"main-footer__copyrights-links"},void 0,r()("a",{href:Object(u.e)("pages:terms"),className:"skfb-link"},void 0,"Terms of service"),r()("a",{href:"".concat(c.a.hosts.faq,"/articles/115004259123-Refund-Policy").concat(n),className:"skfb-link",rel:"noopener noreferrer",target:"_blank"},void 0,"Refund policy"),r()("a",{href:Object(u.e)("pages:privacy"),className:"skfb-link"},void 0,"Privacy policy"),r()("a",{href:Object(u.e)("pages:html_sitemap_index"),className:"skfb-link"},void 0,"Sitemap")),M)))})},"8tOx":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),a=n("RIqP"),o=n.n(a),s=n("gcR/"),u=n.n(s),l=n("J4zp"),c=n.n(l),h=n("G9Ht"),d=n.n(h),f=n("XhtD"),p=n("FFzg"),g=n("q1tI"),m=n.n(g),v=n("/MKj"),_=n("M4AY"),b=n("wsGC"),S=n("oR1v"),y=n("gPpI"),x=n("IOyo"),C=n("iMQx"),w=n("yOYh"),T=n("TCxt"),M=n("51YE"),E=n("MVZn"),A=n.n(E),O=n("QILm"),R=n.n(O),P=n("eEbW"),I=function(e){var t=e.notificationUid,n=e.to,i=e.as,r=void 0===i?"a":i,a=R()(e,["notificationUid","to","as"]);return m.a.createElement(r,A()({},a,{onClick:function(e){var i;e.stopPropagation(),e.preventDefault(),(e.ctrlKey||e.metaKey)&&(i=window.open(n,"_blank")).focus(),P.b.readActivities([t]).then(function(){i?i.location.href=n:window.location.assign(n)})}}))},N=u()("div",{className:"activity__icon --collect"}),L=u()("span",{},void 0," to the collection "),k=function(e){var t=e.activity,n=e.isRead,i=void 0!==n&&n,r=t.extraContext.count+1;return u()(I,{notificationUid:t.uid,to:t.target.collectionUrl,as:"article",className:Object(b.a)("activity --notification",{"--not-read":!i})},void 0,N,u()("div",{className:"activity__main"},void 0,u()("div",{className:"activity__main__left"},void 0,u()("div",{className:"avatar"},void 0,u()(w.a,{alt:"Avatar of ".concat(t.actor.username," "),avatars:t.actor.avatars,size:30}))),u()("div",{className:"activity__main__middle"},void 0,u()("div",{className:"activity__title"},void 0,u()(T.a,{user:t.actor,withoutBadge:!0}),u()("span",{},void 0," added your model ",u()(C.a,{totalCount:r,names:function(e){return e.extraContext.activities?e.extraContext.activities.reduce(function(e,t){return[].concat(o()(e),[t.obj])},[e.obj]):[e.obj]}(t).map(function(e){return u()(M.a,{model:e},e.uid)})})),L,u()("span",{className:"collection-name"},void 0,u()("a",{className:"label",href:t.target.collectionUrl,title:t.target.name},void 0,u()("data",{itemProp:"name"},void 0,t.target.name)))),u()("time",{className:"activity__time"},void 0,Object(x.c)(t.timestamp)))))},D=u()("div",{className:"activity__icon --comment"}),F=u()("span",{},void 0," commented on ");function V(e){var t=e.activity,n=e.isRead,i=void 0!==n&&n;return u()(I,{notificationUid:t.uid,to:"".concat(t.target.viewerUrl,"#comments"),as:"article",className:Object(b.a)("activity --notification",{"--not-read":!i})},void 0,D,u()("div",{className:"activity__main"},void 0,u()("div",{className:"activity__main__left"},void 0,u()("div",{className:"avatar"},void 0,u()(w.a,{alt:"Avatar of ".concat(t.actor.username," "),avatars:t.actor.avatars,size:30}))),u()("div",{className:"activity__main__middle"},void 0,u()("div",{className:"activity__title"},void 0,u()(T.a,{user:t.actor,withoutBadge:!0}),F,u()(M.a,{model:t.target})),u()("time",{className:"activity__time"},void 0,Object(x.c)(t.timestamp)))))}var B=u()("div",{className:"activity__icon --follow"}),U=u()("span",{},void 0," followed you"),j=function(e){var t=e.activity,n=e.isRead,i=void 0!==n&&n;return u()(I,{notificationUid:t.uid,to:t.actor.profileUrl,as:"article",className:Object(b.a)("activity --notification",{"--not-read":!i})},void 0,B,u()("div",{className:"activity__main"},void 0,u()("div",{className:"activity__main__left"},void 0,u()("div",{className:"avatar"},void 0,u()(w.a,{alt:"Avatar of ".concat(t.actor.username," "),avatars:t.actor.avatars,size:30}))),u()("div",{className:"activity__main__middle"},void 0,u()("div",{className:"activity__title"},void 0,u()(T.a,{user:t.actor,withoutBadge:!0}),U),u()("time",{className:"activity__time"},void 0,Object(x.c)(t.timestamp)))))},G=u()("div",{className:"activity__icon --like"}),H=u()("span",{},void 0," liked "),z=function(e){var t=e.activity,n=e.isRead,i=void 0!==n&&n,r=t.extraContext.count+1;return u()(I,{notificationUid:t.uid,to:t.target.viewerUrl,as:"article",className:Object(b.a)("activity --notification",{"--not-read":!i})},void 0,G,u()("div",{className:"activity__main"},void 0,u()("div",{className:"activity__main__left"},void 0,u()("div",{className:"avatar"},void 0,u()(w.a,{alt:"Avatar of ".concat(t.actor.username," "),avatars:t.actor.avatars,size:30}))),u()("div",{className:"activity__main__middle"},void 0,u()("div",{className:"activity__title"},void 0,u()(C.a,{totalCount:r,names:function(e){return e.extraContext.count>0?e.extraContext.activities.reduce(function(e,t){return[].concat(o()(e),[t.actor])},[e.actor]):[e.actor]}(t).map(function(e){return u()(T.a,{user:e},e.uid)})}),H,u()(M.a,{model:t.target})),u()("time",{className:"activity__time"},void 0,Object(x.c)(t.timestamp)))))},W=u()("div",{className:"activity__icon --comment"}),q=u()("span",{},void 0," mentioned you on "),X=function(e){var t=e.activity,n=e.isRead,i=void 0!==n&&n;return u()(I,{notificationUid:t.uid,to:"".concat(t.target.viewerUrl,"#comments"),as:"article",className:Object(b.a)("activity --notification",{"--not-read":!i})},void 0,W,u()("div",{className:"activity__main"},void 0,u()("div",{className:"activity__main__left"},void 0,u()("div",{className:"avatar"},void 0,u()(w.a,{alt:"Avatar of ".concat(t.actor.username," "),avatars:t.actor.avatars,size:30}))),u()("div",{className:"activity__main__middle"},void 0,u()("div",{className:"activity__title"},void 0,u()(T.a,{user:t.actor,withoutBadge:!0}),q,u()(M.a,{model:t.target})),u()("time",{className:"activity__time"},void 0,Object(x.c)(t.timestamp)))))},Y=u()("div",{className:"activity__icon --review"}),K=u()("span",{},void 0," has published a review on "),Q=function(e){var t=e.activity,n=e.isRead,i=void 0!==n&&n;return u()(I,{notificationUid:t.uid,to:"".concat(t.target.viewerUrl,"#comments"),as:"article",className:Object(b.a)("activity --notification",{"--not-read":!i})},void 0,Y,u()("div",{className:"activity__main"},void 0,u()("div",{className:"activity__main__left"},void 0,u()("div",{className:"avatar"},void 0,u()(w.a,{alt:"Avatar of ".concat(t.actor.username," "),avatars:t.actor.avatars,size:30}))),u()("div",{className:"activity__main__middle"},void 0,u()("div",{className:"activity__title"},void 0,u()(T.a,{user:t.actor,withoutBadge:!0}),K,u()(M.a,{model:t.target})),u()("time",{className:"activity__time"},void 0,Object(x.c)(t.timestamp)))))},J=u()("div",{className:"activity__icon -review"}),Z=u()("span",{},void 0," has replied to your review on "),$=function(e){var t=e.activity,n=e.isRead,i=void 0!==n&&n;return u()(I,{notificationUid:t.uid,to:"".concat(t.target.viewerUrl,"#comments"),as:"article",className:Object(b.a)("activity --notification",{"--not-read":!i})},void 0,J,u()("div",{className:"activity__main"},void 0,u()("div",{className:"activity__main__left"},void 0,u()("div",{className:"avatar"},void 0,u()(w.a,{alt:"Avatar of ".concat(t.actor.username," "),avatars:t.actor.avatars,size:30}))),u()("div",{className:"activity__main__middle"},void 0,u()("div",{className:"activity__title"},void 0,u()(T.a,{user:t.actor,withoutBadge:!0}),Z,u()(M.a,{model:t.target})),u()("time",{className:"activity__time"},void 0,Object(x.c)(t.timestamp)))))},ee=u()("div",{className:"activity__icon --staffpick"}),te=u()("span",{},void 0,"Your model "),ne=u()("span",{},void 0," has been staff picked! Congrats!"),ie=u()("span",{},void 0," has been staff picked!"),re=function(e){var t=e.authUser,n=e.activity,i=e.isRead,r=void 0!==i&&i;return u()(I,{notificationUid:n.uid,to:n.obj.viewerUrl,as:"article",className:Object(b.a)("activity --notification",{"--not-read":!r})},void 0,ee,u()("div",{className:"activity__main"},void 0,u()("div",{className:"activity__main__left"},void 0,u()("div",{className:"avatar","data-action":"show-user-summary","data-user":t.uid},void 0,u()(w.a,{alt:"Avatar of ".concat(t.username," "),avatars:t.avatars,size:30}))),u()("div",{className:"activity__main__middle"},void 0,u()("div",{className:"activity__title"},void 0,t.uid===n.actor.uid?g.createElement(g.Fragment,null,te,u()(M.a,{model:n.obj}),ne):g.createElement(g.Fragment,null,u()(T.a,{user:n.actor,withoutBadge:!0}),"'s model ",u()(M.a,{model:n.obj}),ie,u()("a",{href:"".concat(n.obj.viewerUrl,"#comments")},void 0," Say Congrats!"))),u()("time",{className:"activity__time"},void 0,Object(x.c)(n.timestamp)))))},ae=n("PtOh"),oe=u()("div",{className:"activity__icon --subscribe"}),se=u()("span",{},void 0," subscribed to "),ue=function(e){var t=e.activity,n=e.isRead,i=void 0!==n&&n,r=t.extraContext.count+1;return u()(I,{notificationUid:t.uid,to:t.actor.profileUrl,as:"article",className:Object(b.a)("activity --notification",{"--not-read":!i})},void 0,oe,u()("div",{className:"activity__main"},void 0,u()("div",{className:"activity__main__left"},void 0,u()("div",{className:"avatar"},void 0,u()(w.a,{alt:"Avatar of ".concat(t.actor.username," "),avatars:t.actor.avatars,size:30}))),u()("div",{className:"activity__main__middle"},void 0,u()("div",{className:"activity__title"},void 0,u()(C.a,{totalCount:r,names:function(e){return e.extraContext.count>0?e.extraContext.activities.reduce(function(e,t){return[].concat(o()(e),[t.actor])},[e.actor]):[e.actor]}(t).map(function(e){return u()(T.a,{user:e},e.uid)})}),se,u()(ae.a,{collection:t.target})),u()("time",{className:"activity__time"},void 0,Object(x.c)(t.timestamp)))))},le=n("gSZ1"),ce=u()("path",{d:"M1.046 14.84c.095.232.326.39.579.39H6.21a2.82 2.82 0 002.778 2.404 2.82 2.82 0 002.777-2.404h4.597c.032 0 .064 0 .095-.01a.64.64 0 00.505-.402.62.62 0 00-.158-.664l-.031-.032c-.063-.063-.316-.348-.558-.949-.263-.643-.589-1.793-.589-3.575 0-3.523-1.326-5.38-2.43-6.318a5.577 5.577 0 00-1.957-1.076c-.021-.432-.126-1.023-.526-1.497C10.441.38 9.925 0 9.01 0c-.905 0-1.42.39-1.694.707-.41.485-.526 1.086-.536 1.529A5.634 5.634 0 004.823 3.29c-2.03 1.666-2.451 4.345-2.451 6.286 0 1.73-.327 2.879-.6 3.543-.295.707-.579 1.023-.579 1.023a.635.635 0 00-.147.696zm7.953 1.529a1.569 1.569 0 01-1.494-1.14h2.988A1.569 1.569 0 019 16.37zM3.634 9.577c0-5.675 3.703-6.213 3.85-6.234a.643.643 0 00.432-.242.656.656 0 00.126-.485c-.032-.2-.053-.791.231-1.118.053-.064.221-.264.737-.264.515 0 .684.2.747.264.263.306.252.886.22 1.075a.617.617 0 00.116.486.633.633 0 00.432.253c.01 0 .947.137 1.883.928 1.315 1.107 1.978 2.91 1.978 5.358 0 2.151.41 3.533.82 4.377H2.792c.4-.876.842-2.289.842-4.398z",fillRule:"evenodd"}),he=function(e){return m.a.createElement("svg",r()({viewBox:"0 0 18 18"},e),ce)},de=u()("div",{className:"placeholder__card"},void 0,u()("div",{className:"placeholder c-list-item-placeholder --small-activity"},void 0,u()("div",{className:"placeholder__image --rounded-corners --x-s"}),u()("div",{className:"placeholder__image --rounded-corners --small"}),u()("div",{className:"placeholder__container"},void 0,u()("div",{className:"placeholder__text --small --w-80"}),u()("div",{className:"placeholder__text --small --w-50"})))),fe=function(){return de},pe=n("dvlG"),ge=n("sgO5"),me=n("NdcT"),ve=n("5CbO"),_e=Object(v.c)(function(e){return{canAccessNewsfeed:_.c.authUser.canAccessFeature("ff_newsfeed_v2",e)}}),be=u()("div",{className:"header-notifications__empty-state"},void 0,u()("div",{className:"header-notifications__empty-state__icon"}),u()("p",{className:"--grey"},void 0,"No notifications"));var Se=u()(he,{className:"c-page-header__action__icon"}),ye=u()(function(){return be},{}),xe=u()("div",{className:"header-notifications__see-all"},void 0,u()("a",{href:"/feed/activity?feed=activities"},void 0,"See all notifications"));t.a=_e(function(e){var t=e.authUser,n=e.canAccessNewsfeed,i=e.className,a=g.useRef(null),s=g.useRef(null),l=g.useState(!1),h=c()(l,2),m=h[0],v=h[1];Object(pe.a)(a,function(){v(!1)}),Object(me.a)(s);var _=Object(ve.a)(),x=Object(ge.a)(function(e,t){return e.Api.getNewsfeed({cursor:t,count:10,feed:"notifications"},{allowPrefetching:!0})},[]);return g.useEffect(function(){m&&x.onLoadFirst()},[m]),g.useEffect(function(){p.a.getSingleton().hasNewActivities()&&p.a.seeActivities()},[x.list]),n?g.createElement("div",{ref:a,className:Object(b.a)("c-page-header__action",i)},u()("a",{className:"c-page-header__action__icon-container",href:Object(y.e)("feeds:activity"),onClick:function(e){d.a.any||(e.preventDefault(),v(function(e){return!e}))}},void 0,Se,u()("div",{className:Object(b.a)("c-page-header__action__count",{"--hidden":!_})},void 0,_>99?"99+":_)),u()("div",{className:"c-page-header__action__popin-container"},void 0,m?u()("div",{className:"c-page-header__action__popin --open",onClick:S.g},void 0,g.createElement("div",{ref:s,className:"c-page-header__action__list"},u()("div",{className:"c-activity-list"},void 0,g.createElement(le.a,r()({},x,{className:"activity-list__grid",cards:[].concat(o()(x.list.map(function(e){return"comment"===e.verb?e.mentions.includes(t.uid)?u()(X,{activity:e},e.uid):u()(V,{activity:e},e.uid):"follow"===e.verb?u()(j,{activity:e},e.uid):"subscribe"===e.verb?u()(ue,{activity:e},e.uid):"like"===e.verb?u()(z,{activity:e},e.uid):"collect"===e.verb?u()(k,{activity:e},e.uid):"staffpick"===e.verb?u()(re,{authUser:t,activity:e},e.uid):"review"===e.verb?u()(Q,{activity:e},e.uid):"reviewReply"===e.verb?u()($,{activity:e},e.uid):null})),o()(Object(f.a)(0,x.isLoading?5:0).map(function(e){return u()(fe,{},e)}))),hasNextPage:!1,emptyState:ye})))),xe):null)):null})},"8v7q":function(e,t,n){"use strict";var i=n("12sq"),r=n("uGjJ"),a=n("M4AY");t.a={showPopup:function(){var e=a.b.store.getState(),t=a.c.authUser.canAccessFeature("ff_read_only_mode",e),n="?utm_source=website&utm_campaign=maintenance_error",o=new r.default({title:t?"Maintenance":"Error",text:t?'Sketchfab is undergoing maintenance.<br>See: <a href="https://forum.sketchfab.com/t/sketchfab-operations/6678'.concat(n," target=_blank>Operations forum post</a>"):'An unknown error occurred. Please try again later or <a href="'.concat(i.a.hosts.faq,"/requests/new").concat(n,'&type=website" target="_blank">contact our support team</a> if the problem persists.'),buttons:{ok:!0},safe:!0});return o.open().then(function(){o.close()}),o}}},"93PM":function(e,t,n){"use strict";var i=n("QLQS"),r=n("w3fr"),a=n("Hi2/"),o=n("PnIl"),s=n("+cEC"),u=n("1f5D"),l=i.a.osg,c={DEFAULT:1,EARLYZ_OPAQUE:2,EARLYZ_TRANSPARENT:4,OPAQUE_SHADING:8,TRANSPARENT_SHADING:16,REFRACTION:32,EXTRA:64,SHADOWMAP:128};c.ANY_OPAQUE=c.EARLYZ_OPAQUE|c.OPAQUE_SHADING,c.ANY_TRANSPARENT=c.REFRACTION|c.EARLYZ_TRANSPARENT|c.TRANSPARENT_SHADING;var h={depth:void 0,blend:void 0,colorMask:void 0},d={LAST_LEAF:void 0,passTypes:c,forceAttribute:h,currentPass:c.DEFAULT},f=s.a.vrConfig,p={},g=l.RenderLeaf.prototype.drawGeometry,m=l.getOrCreateStateAttributeTypeMemberIndexFromName("SketchfabMaterial"),v=function(e,t,n){if(!n)return t.applyAttribute(o.a.CULL_DISABLE),void g.call(e,t);var i=!1;if(d.currentPass===c.TRANSPARENT_SHADING){var r=t._attributeArray[m],a=r?r._lastApplied:void 0;if(a)i=!a.getAdditive()&&a.getCullFace()===l.CullFace.DISABLE}i&&t.applyAttribute(o.a.CULL_FRONT),g.call(e,t),i&&(t.applyAttribute(o.a.CULL_BACK),e._geometry.drawImplementation(t))};l.RenderLeaf.prototype.drawGeometry=function(e){if(function(e){var t=e._attributeArray[m],n=t?t._lastApplied:void 0;if(!n)return!0;var i=d.currentPass;if(!n.getDepthWrite()&&i&c.ANY_OPAQUE)return!1;if(!n.getCastShadows()&&i&c.SHADOWMAP)return!1;if(i!==c.EARLYZ_TRANSPARENT)return!0;var r=n.getAdditive()?o.a.BLEND_ADDITIVE:o.a.BLEND_SUBSTRACTIVE;return e.applyAttribute(r),!0}(e)){h.depth&&e.applyAttribute(h.depth),h.blend&&e.applyAttribute(h.blend),h.colorMask&&e.applyAttribute(h.colorMask);var t=e.getGraphicContext(),n=e.getLastProgramApplied(),i=n.getUniformsCache();!function(e,t,n){var i=t.uDrawOpaque;if(void 0!==i){var r=d.currentPass,a=u.a.uDrawOpaque,o=a.getInternalArray(),s=r&c.ANY_TRANSPARENT?0:1;o[0]=s;var l=n.getInstanceID();p[l]!==s&&(p[l]=s,a.apply(e,i))}}(t,i,n),function(e,t,n){n._QVT&&void 0!==t.uQVT&&(u.a.uQVT.setFloat3(n._QVT),u.a.uQVT.apply(e,t.uQVT),u.a.uQVS.setFloat3(n._QVS),u.a.uQVS.apply(e,t.uQVS));var i=n._listQuantUV;if(i)for(var r=0,a=i.length;r<a;++r){var o=i[r],s=o.uniformName,l=t[s];void 0!==l&&(u.a[s].setFloat4(o._QUV),u.a[s].apply(e,l))}}(t,i,this._geometry);var r=function(e){for(var t=e.getPrimitiveSetList(),n=0,i=t.length;n<i;++n)if(t[n].getMode()>=l.primitiveSet.TRIANGLES)return!0;return!1}(this._geometry),a=d.LAST_LEAF;if(a.isVR){var s=f.leftRenderWidth;e.viewport(0,0,s,f.leftRenderHeight),this._projection=a.leftProjection,this._modelView=a.leftModelView,this._view=a.leftView,v(this,e,r),e.viewport(s,0,s,f.rightRenderHeight),this._projection=a.rightProjection,this._modelView=a.rightModelView,this._view=a.rightView,v(this,e,r)}else v(this,e,r)}};var _,b=d,S=i.a.osg,y=S.vec4.fromValues(1,1,1,0),x=function(e,t){return e._binNum-t._binNum},C=b.passTypes,w=b.forceAttribute,T=S.StateAttribute.OVERRIDE_ON,M=function(){var e=new S.StateSet;e.setShaderGeneratorName("earlyz",T);for(var t=Object(r.a)(),n=0;n<t;n++)e.setTextureAttributeAndModes(n,S.Texture.textureNull,T);return e}(),E=function(){S.RenderStage.apply(this,arguments),this._binArraySorted=[],E.prototype.init.call(this)},A=!0;E.setHasTriangles=function(e){A=e},E.setTimerGPU=function(e){_=e},E.getTimerGPU=function(){return _};var O,R=S.vec4.create();E.getClearColor=function(){return R},E.setCallbackDepth=function(e){O=e},S.createPrototypeObject(E,S.objectInherit(S.RenderStage.prototype,{constructor:E,init:function(){return S.RenderStage.prototype.init.call(this),this._binArraySorted.length=0,this._renderBufferDepthAttachment=void 0,this},isMainCamera:function(){var e=this.getCamera();return!(!e||e!==s.a.cameraMain)},isShadowCasterCamera:function(){var e=this.getCamera(),t=e&&e.getName();return!(!t||!t.startsWith("light_shadow_camera"))},sortBinArray:function(){var e=this._binArraySorted;e.length=0;for(var t=this._bins.getKeys(),n=t.getLength(),i=t.getArray(),r=this._bins.getMap(),a=0;a<n;a++){var o=i[a];e.push(r[o])}e.sort(x)},drawTransparentBin:function(e,t){for(var n,i=t,r=this._binArraySorted,o=0,s=r.length,u=b.currentPass===C.EARLYZ_TRANSPARENT;o<s;o++){var l=(n=r[o]).getBinNumber();if(l!==a.a.TRANSPARENT){if(!u&&(l===a.a.TRANSPARENT_NO_EARLYZ_POST||l===a.a.TRANSPARENT_NO_EARLYZ_PRE)){var c=w.depth;w.depth=void 0,i=n.draw(e,i),w.depth=c}}else i=n.draw(e,i)}return i},drawGroundBin:function(e,t){for(var n,i=t,r=this._binArraySorted,o=0,s=r.length;o<s;o++){(n=r[o]).getBinNumber()===a.a.TRANSPARENT_CUSTOM_EARLYZ&&(i=n.draw(e,i))}return i},drawOpaqueBin:function(e,t){for(var n,i=this.getDoEarlyZ(),r=t,o=this._binArraySorted,s=0,u=o.length;s<u&&!((n=o[s]).getBinNumber()>0);s++)r=n.draw(e,r);r=this.drawLeafs(e,r);for(var l=b.currentPass===C.OPAQUE_SHADING;s<u;s++){var c=(n=o[s]).getBinNumber();if(c===a.a.OPAQUE||c===a.a.REFRACTION||i&&c===a.a.TRANSPARENT)r=n.draw(e,r);else if(l&&c===a.a.OPAQUE_NO_EARLYZ){var h=w.depth;w.depth=void 0,b.currentPass=C.DEFAULT,r=n.draw(e,r),b.currentPass=C.OPAQUE_SHADING,w.depth=h}}return r},drawRefractionBin:function(e,t){for(var n,i=t,r=this._binArraySorted,o=0,s=r.length;o<s;o++){(n=r[o]).getBinNumber()===a.a.REFRACTION&&(i=n.draw(e,i))}return i},drawExtraBin:function(e,t){for(var n,i=t,r=this._binArraySorted,o=0,s=r.length;o<s;o++){(n=r[o]).getBinNumber()>=a.a.EXTRA&&(i=n.draw(e,i))}return i},bindDepthRTT:function(e){this.getCamera().fboDepth.apply(e)},bindTransparencyRTT:function(e){this.getCamera().fboTransparent.apply(e)},bindRefractionRTT:function(e){this.getCamera().fboRefraction.apply(e)},bindOpaqueRTT:function(e){this.getCamera().fboOpaque.apply(e)},bindExtraRTT:function(e){this.getCamera().fboExtra.apply(e)},createFBO:function(e,t){if(t){var n=new S.FrameBufferObject,i=this._renderBufferDepthAttachment;i||(i={attachment:S.FrameBufferObject.DEPTH_ATTACHMENT,format:S.FrameBufferObject.DEPTH_COMPONENT16,width:t.getWidth(),height:t.getHeight()},this._renderBufferDepthAttachment=i),n.setAttachment(i);var r={attachment:S.FrameBufferObject.COLOR_ATTACHMENT0,textureTarget:S.Texture.TEXTURE_2D,texture:t};return n.setAttachment(r),n.apply(e),n}},drawOpaqueShading:function(e,t){b.currentPass=C.OPAQUE_SHADING,w.depth=this.getDoEarlyZ()?o.a.DEPTH_EQUAL_NO_WRITE:o.a.DEPTH_LESS_WRITE,w.blend=o.a.BLEND_DISABLE;var n=this.drawOpaqueBin(e,t);return w.blend=void 0,w.depth=void 0,b.currentPass=C.DEFAULT,n},drawEarlyOpaque:function(e,t){b.currentPass=C.EARLYZ_OPAQUE,w.depth=o.a.DEPTH_LESS_WRITE,w.blend=o.a.BLEND_DISABLE,w.colorMask=this.isWritingDepth()?o.a.COLOR_MASK_RGBA:o.a.COLOR_MASK_NONE;var n=this.drawOpaqueBin(e,t);return w.colorMask=void 0,w.blend=void 0,w.depth=void 0,b.currentPass=C.DEFAULT,n},drawEarlyAlpha:function(e,t){b.currentPass=C.EARLYZ_TRANSPARENT,w.depth=o.a.DEPTH_LESS_NO_WRITE,w.colorMask=o.a.COLOR_MASK_ALPHA;var n=this.drawTransparentBin(e,t);return w.colorMask=void 0,w.depth=void 0,b.currentPass=C.DEFAULT,n},drawEarlyGround:function(e,t){b.currentPass=C.EARLYZ_TRANSPARENT,w.depth=o.a.DEPTH_LESS_NO_WRITE,w.colorMask=o.a.COLOR_MASK_ALPHA;var n=this.drawGroundBin(e,t);return w.colorMask=void 0,w.depth=void 0,b.currentPass=C.DEFAULT,n},drawTransparentShading:function(e,t){b.currentPass=C.TRANSPARENT_SHADING,w.depth=o.a.DEPTH_LEQUAL_NO_WRITE,w.blend=o.a.BLEND_SUBSTRACTIVE;var n=this.drawTransparentBin(e,t);return w.blend=void 0,w.depth=void 0,b.currentPass=C.DEFAULT,n},drawGroundShading:function(e,t){b.currentPass=C.TRANSPARENT_SHADING,w.depth=o.a.DEPTH_LEQUAL_NO_WRITE,w.blend=o.a.BLEND_SUBSTRACTIVE;var n=this.drawGroundBin(e,t);return w.blend=void 0,w.depth=void 0,b.currentPass=C.DEFAULT,n},drawRefractionShading:function(e,t){b.currentPass=C.REFRACTION,w.depth=o.a.DEPTH_LESS_WRITE,w.blend=o.a.BLEND_DISABLE;var n=this.drawRefractionBin(e,t);return w.blend=void 0,w.depth=void 0,b.currentPass=C.DEFAULT,n},drawExtra:function(e,t){b.currentPass=C.EXTRA;var n=this.drawExtraBin(e,t);return b.currentPass=C.DEFAULT,n},isWritingDepth:function(){return!!this.getCamera()._textureDepth},getDoEarlyZ:function(){return A||this.isWritingDepth()},drawImplementationSketchfab:function(e,t){var n=e.getGraphicContext(),i=t,r=this.getCamera(),a=!!r._textureDepth;if(a?(this.bindDepthRTT(e),e.clearColor(y)):(this.bindOpaqueRTT(e),e.clearColor(R)),e.depthMask(!0),e.clearDepth(this.getClearDepth()),e.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),this.getDoEarlyZ()){var s=function(e,t){for(var n=t?t._parent:void 0,i=0;n;)n._stateset&&i++,n=n._parent;return i>1&&i--,e.getStateSetStackSize()-i}(e,i);e.insertStateSet(s,M),_.start("EarlyOpaque"),i=this.drawEarlyOpaque(e,i),_.end("EarlyOpaque");var u=a&&r._textureTransparent;u&&(_.start("EarlyTransparency"),i=this.drawEarlyAlpha(e,i),_.end("EarlyTransparency")),O&&O(e),e.removeStateSet(s),u&&(_.start("EarlyTransparencyCustom"),i=this.drawEarlyGround(e,i),_.end("EarlyTransparencyCustom")),e.applyAttribute(o.a.COLOR_MASK_RGBA)}return a&&(this.bindOpaqueRTT(e),e.clearColor(R),e.clear(n.COLOR_BUFFER_BIT)),_.start("ShadingOpaque"),i=this.drawOpaqueShading(e,i),_.end("ShadingOpaque"),e.clearColor(S.vec4.ZERO),r._textureTransparent&&(this.bindTransparencyRTT(e),e.clear(n.COLOR_BUFFER_BIT),_.start("ShadingTransparency"),i=this.drawGroundShading(e,i),i=this.drawTransparentShading(e,i),_.end("ShadingTransparency")),r._textureRefraction&&(this.bindRefractionRTT(e),e.clear(n.COLOR_BUFFER_BIT),_.start("ShadingRefraction"),i=this.drawRefractionShading(e,i),_.end("ShadingRefraction")),r._textureExtra&&(this.bindExtraRTT(e),e.clear(n.COLOR_BUFFER_BIT),_.start("Extra"),i=this.drawExtra(e,i),_.end("Extra")),i},drawImplementation:function(e,t){if(!this.isMainCamera()){this.isShadowCasterCamera()&&(b.currentPass=C.SHADOWMAP);var n=S.RenderStage.prototype.drawImplementation.call(this,e,t);return b.currentPass=C.DEFAULT,n}var i=this.getCamera();if(!i._textureOpaque)return t;i.fboOpaque||(i.fboOpaque=this.createFBO(e,i._textureOpaque)),i.fboTransparent||(i.fboTransparent=this.createFBO(e,i._textureTransparent)),i.fboDepth||(i.fboDepth=this.createFBO(e,i._textureDepth)),i.fboRefraction||(i.fboRefraction=this.createFBO(e,i._textureRefraction)),i.fboExtra||(i.fboExtra=this.createFBO(e,i._textureExtra));var r=this.getViewport();void 0===r&&S.log("RenderStage does not have a valid viewport"),e.applyAttribute(r),this._scissor&&e.applyAttribute(this._scissor),0!==this._positionedAttribute.getLength()&&this.applyPositionedAttribute(e,this._positionedAttribute),this.sortBinArray();var a=t;return _.start("Shading"),a=this.drawImplementationSketchfab(e,a),_.end("Shading"),a}}),"osgSketchfab","RenderStageSketchfab"),S.RenderBin.prototype.drawLeafs=function(e,t){for(var n,i=this.getStateGraphList(),r=i.getArray(),a=this._leafs,o=t,s=this.getStage().getViewport(),u=0;u<a.length;u++)n=a[u],b.LAST_LEAF=n,!n.isVR&&o&&o.isVR&&e.applyViewport(s),n.render(e,o),o=n;for(var l=i.getLength(),c=0;c<l;c++)for(var h=r[c],d=h._leafs.getArray(),f=h._leafs.getLength(),p=0;p<f;p++)n=d[p],b.LAST_LEAF=n,!n.isVR&&o&&o.isVR&&e.applyViewport(s),n.render(e,o),o=n;return o};t.a=E},"99M6":function(e,t,n){e.exports=n.p+"static/assets/images/editor/eye-slash-ff805f0fec76820991335845a87896c4.png"},"9D1Z":function(e,t,n){"use strict";var i=n("QLQS"),r=n("UpON"),a=n("AhqU"),o=n("fgaA"),s=i.a.osg,u=i.a.osgUtil,l=i.a.osgAnimation,c=a.a.SHADOW|a.a.PICK_GEOMETRY_ANIMATED;l.MorphGeometry.MAX_MORPH_GPU=Math.min(4,Object(o.a)().morphGpu);var h=u.IntersectionVisitor.prototype.enter;u.IntersectionVisitor.prototype.enter=function(e){return!!e._forceEnterIntersection||h.call(this,e)};var d=function(){};s.createPrototypeObject(d,{cull:function(){return!1}},"osgSketchfab","HideCullCallback");var f=new d,p=s.vec3.create(),g=s.vec3.create(),m=function(e,t){s.NodeVisitor.call(this),this._wirePromise=r.a.getWireframeOptimized(),this._wireNodes=t.getOrCreateScene().getWireframeNodes(),this.nodeMaskOverride=-1,this._visitedNodes={},this._rigIndexed=[],this._boneGeomIndexed=[],this._skls=e;var n=t.getFeatures().material.getModel(),i=s.WebGLCaps.instance();this._maxVA=i.getWebGLParameter("MAX_VERTEX_ATTRIBS");var a=0;a+=1,a+=1,a+=1,a+=3,a+=3,a+=4,a+=4,a+=4,a+=4,a+=1,a+=1,a+=1,a+=1,a+=1,a+=1,a+=1,a+=1,a+=1,a+=1,a+=1*n.getMaxUvCount(),a=Math.ceil(a);var u=i.getWebGLParameter("MAX_VERTEX_UNIFORM_VECTORS");u=Math.min(u,Object(o.a)().maxVertexUniforms),this._maxBones=Math.floor((u-a)/3),l.SkinningAttribute.maxBoneUniformAllowed=3*this._maxBones,this._minUniformsRequired=a+39};s.createPrototypeObject(m,s.objectInherit(s.NodeVisitor.prototype,{createSplitRigGeometry:function(e){var t=new l.RigGeometry;t.setName("Split ("+e.getInstanceID()+")"),t.setStateSet(e.getStateSet()),t.setUserData(e.getUserData()),t.userDataMap=e.userDataMap,t.setSourceGeometry(e.getSourceGeometry()),t._forceEnterIntersection=!0,t.setNodeMask(e.getNodeMask());var n=e.getVertexAttributeList(),i=t.getVertexAttributeList();for(var r in n)i[r]=n[r];var a=n.Bones.getElements(),o=new a.constructor(a.length);i.Bones=new s.BufferArray(s.BufferArray.ARRAY_BUFFER,o,n.Bones.getItemSize(),!0),t.userDataMap.wireframe&&this._wireNodes.push(t);var u=t.userDataMap.rigIndex;return void 0!==u&&(this._rigIndexed[u]=t),t._boundingSphereComputed=!0,t._boundingBoxComputed=!0,t},checkVertex:function(e,t){var n=t.baseBones,i=t.baseWeights,r=t.mappedUsedBones,a=0;return i[e]&&!r[n[e]]&&a++,i[e+1]&&!r[n[e+1]]&&a++,i[e+2]&&!r[n[e+2]]&&a++,i[e+3]&&!r[n[e+3]]&&a++,a},tagBoneVertex:function(e,t){var n=t.baseBones,i=t.baseWeights,r=t.mappedUsedBones,a=t.boneNameID,o=t.boneToName,s=n[e];i[e]&&!r[s]&&(a[o[s]]=t.nbUsedBones,r[s]=++t.nbUsedBones),t.newBones[e]=r[s]-1,s=n[e+1],i[e+1]&&!r[s]&&(a[o[s]]=t.nbUsedBones,r[s]=++t.nbUsedBones),t.newBones[e+1]=r[s]-1,s=n[e+2],i[e+2]&&!r[s]&&(a[o[s]]=t.nbUsedBones,r[s]=++t.nbUsedBones),t.newBones[e+2]=r[s]-1,s=n[e+3],i[e+3]&&!r[s]&&(a[o[s]]=t.nbUsedBones,r[s]=++t.nbUsedBones),t.newBones[e+3]=r[s]-1},splitTriangle:function(e,t,n,i){if(i.currentIdPrimitive++,e===t||e===n||t===n||i.processedPrimitive[i.currentIdPrimitive-1])return!0;var r=i.nbUsedBones,a=this.checkVertex(4*e,i);if(r+a<this._maxBones&&(a+=this.checkVertex(4*t,i)),r+a<this._maxBones&&(a+=this.checkVertex(4*n,i)),r+a>=this._maxBones)i.finished=!1;else{this.tagBoneVertex(4*e,i),this.tagBoneVertex(4*t,i),this.tagBoneVertex(4*n,i);var o=i.first+i.countIdPrimitive;i.countIdPrimitive+=3,i.newIndexesElements[o]=e,i.newIndexesElements[o+1]=t,i.newIndexesElements[o+2]=n,i.processedPrimitive[i.currentIdPrimitive-1]=1}},splitLine:function(e,t,n){if(n.currentIdPrimitive++,e===t||n.processedPrimitive[n.currentIdPrimitive-1])return!0;var i=n.nbUsedBones,r=this.checkVertex(4*e,n);if(i+r<this._maxBones&&(r+=this.checkVertex(4*t,n)),i+r>=this._maxBones)n.finished=!1;else{this.tagBoneVertex(4*e,n),this.tagBoneVertex(4*t,n);var a=n.first+n.countIdPrimitive;n.countIdPrimitive+=2,n.newIndexesElements[a]=e,n.newIndexesElements[a+1]=t,n.processedPrimitive[n.currentIdPrimitive-1]=1}},callbackDrawElementsTriangles:function(e,t,n){for(var i=0;i<e;i+=3)this.splitTriangle(t[i],t[i+1],t[i+2],n)},callbackDrawElementsTriangleStrip:function(e,t,n){for(var i=2,r=0;i<e;++i,++r)i%2?this.splitTriangle(t[r],t[r+2],t[r+1],n):this.splitTriangle(t[r],t[r+1],t[r+2],n)},callbackDrawElementsLines:function(e,t,n){for(var i=0;i<e;i+=2)this.splitLine(t[i],t[i+1],n)},splitPrimitive:function(e,t){e.finished=!0;var n=e.baseRig,i=e.primitive,r=this.createSplitRigGeometry(n);e.boneNameID=r._boneNameID,e.newBones=r.getVertexAttributeList().Bones.getElements(),e.mappedUsedBones=new Uint32Array(t),e.nbUsedBones=0,e.currentIdPrimitive=0,e.countIdPrimitive=0;var a=i.getIndices().getElements(),o=i.getCount(),u=i.getMode();if(u===s.primitiveSet.TRIANGLE_STRIP?this.callbackDrawElementsTriangleStrip(o,a,e):u===s.primitiveSet.TRIANGLES?this.callbackDrawElementsTriangles(o,a,e):this.callbackDrawElementsLines(o,a,e),0===e.countIdPrimitive){var l="Only "+this._maxBones+" bones supported per draw call (min is 13)";return l+="\nMinium uniforms count should be "+this._minUniformsRequired,console.warn(l),!1}var c=new s.DrawElements(u===s.primitiveSet.LINES?s.primitiveSet.LINES:s.primitiveSet.TRIANGLES,e.newIndexesBuffer);c.setFirst(e.first*e.newIndexesElements.BYTES_PER_ELEMENT),c.setCount(e.countIdPrimitive),e.first+=e.countIdPrimitive,r.getPrimitives().push(c);for(var h=n.getParents(),d=h.length,f=0;f<d;++f)h[f].addChild(r);return!e.finished},getBoneToNames:function(e,t){for(var n=t.length,i=new Array(n),r=0;r<n;++r){var a=t[r];i[e[a]]=a}return i},splitRigGeometry:function(e){for(var t=e._boneNameID,n=Object.keys(t),i=n.length,r=e.getPrimitives(),a=r.length,o={baseRig:e,baseWeights:e.getVertexAttributeList().Weights.getElements(),baseBones:e.getVertexAttributeList().Bones.getElements(),boneToName:this.getBoneToNames(e._boneNameID,n)},u=0;u<a;++u){var l=r[u],c=l.getMode();if(0!==l.getCount())if(l instanceof s.DrawElements!=!1)if(c===s.primitiveSet.TRIANGLE_STRIP||c===s.primitiveSet.TRIANGLES||c===s.primitiveSet.LINES){var h=l.getIndices(),d=h.getElements(),f=c===s.primitiveSet.TRIANGLE_STRIP?3:1;for(o.newIndexesElements=new d.constructor(l.getCount()*f),o.newIndexesBuffer=new s.BufferArray(s.BufferArray.ELEMENT_ARRAY_BUFFER,o.newIndexesElements,h.getItemSize(),!0),o.first=l.getFirst(),o.processedPrimitive=new Uint8Array(l.getCount()),o.primitive=l;this.splitPrimitive(o,i););o.newIndexesBuffer.setElements(o.newIndexesElements.subarray(0,o.first))}else s.error("Split rigged primitives mode not yet handled : ",c);else s.error("Split rigged primitives type not yet handled",l)}},handleRigGeometry:function(e){var t=e._boneNameID,n=e.userDataMap.wireframe,i=e.userDataMap.rigIndex;void 0!==i&&(this._rigIndexed[i]=e),this._maxBones<Object.keys(t).length&&(n?(e._boundingBoxComputed=!0,e._boundingSphereComputed=!0,this._wirePromise.then(this.splitRigGeometry.bind(this,e))):this.splitRigGeometry(e),e.setCullCallback(f)),this.tagForceIntersection()},tagForceIntersection:function(){for(var e=this._skls[this._skls.length-1],t=1+this.nodePath.indexOf(e);t<this.nodePath.length;++t)this.nodePath[t]._forceEnterIntersection=!0},popTargetAttribute:function(e,t,n){for(var i=t.getMorphTargets(),r=i.length,a=e.getVertexAttributeList(),o=t.getVertexAttributeList(),s=0;s<r;++s){delete i[s].getVertexAttributeList()[n];var u=n+"_"+s;delete a[u],a!==o&&delete o[u]}},computeUsedVA:function(e,t,n,i){var r=Object.keys(e).length-Object.keys(t).length*(n.length-Math.min(i,n.length));return e.Color||r++,r},handleMorphGeometry:function(e,t){var n=t.getMaximumPossibleMorphGPU(),i=t.getMorphTargets(),r=i[0].getVertexAttributeList(),a=e.getVertexAttributeList(),o=this.computeUsedVA(a,r,i,n),s=this._maxVA;if(!(o<=s||a.Tangent_1&&(this.popTargetAttribute(e,t,"Tangent"),(o=this.computeUsedVA(a,r,i,n))<=s)||a.Normal_1&&(this.popTargetAttribute(e,t,"Normal"),(o=this.computeUsedVA(a,r,i,n))<=s))){for(;n>0;)if(n--,t.setMaximumPossibleMorphGPU(n),(o=this.computeUsedVA(a,r,i,n))<=s)return;console.warn("Too much vertex attributes!")}},apply:function(e){var t=e.getInstanceID();if(!this._visitedNodes[t]){this._visitedNodes[t]=!0;var n=e instanceof l.RigGeometry,i=n?e.getSourceGeometry():e,r=i instanceof l.MorphGeometry;if(n&&e.separateStaticBoxInGeometry(),!r&&!n||e.userDataMap.wireframe||e.setNodeMask(c),r&&this.handleMorphGeometry(e,i),n)this.handleRigGeometry(e);else if(e instanceof l.Bone){var o=e.getBoneBoundingBox();if(o.valid()){o.center(p),s.vec3.sub(g,o.getMax(),o.getMin());var u=function(e,t){var n=s.createTexturedBoxGeometry(e[0],e[1],e[2],t[0],t[1],t[2]);return n.setName("BoneBox"),n.getOrCreateStateSet().setShaderGeneratorName("debugBoneBox"),n.setCullCallback(f),n._isBoneBox=!0,n.setNodeMask(a.a.PICK_GEOMETRY_RIG_BOX|a.a.SHADOW_BOUNDS),n}(p,g);e.addChild(u),e.userDataMap.apexes=function(e,t){return[[e[0]+.5*t[0],e[1],e[2]],[e[0]-.5*t[0],e[1],e[2]],[e[0],e[1]+.5*t[1],e[2]],[e[0],e[1]-.5*t[1],e[2]],[e[0],e[1],e[2]+.5*t[2]],[e[0],e[1],e[2]-.5*t[2]]]}(p,g),void 0!==e.userDataMap.rigIndex&&this._boneGeomIndexed.push(u)}}else e instanceof l.Skeleton&&this._skls.push(e);this.traverse(e)}}}),"osgSketchfab","InitVisitor");var v={};v.hideCullCallback=f,v.init=function(e,t){var n=new m(e,t),i=t.getRootModel();s.time("InitGraphAnimation"),i.accept(n),s.timeEnd("InitGraphAnimation");for(var r=n._boneGeomIndexed,a=n._rigIndexed,o=r.length,u=0;u<o;++u){var l=r[u];l._mostInfluencedRig=a[l.getParents()[0].userDataMap.rigIndex]}},t.a=v},"9D4N":function(e,t){e.exports='#pragma include "utils/lightsPBR.glsl"\n\n//https://en.wikipedia.org/wiki/Beer%E2%80%93Lambert_law for translucent material absorbtion\nvec3 beerLambert(const float NoV, const float NoL, const vec3 tint, const float d) {\n    // exp(tint * -distance * density)\n    return exp(tint * -(d * ((NoL + NoV) / max(NoL * NoV, 1e-3))));\n}\n\nvec3 getClearCoatAbsorbtion(const in float NoV, const in float NoL, const in float clearCoatFactor) {\n    return mix(vec3(1.0), beerLambert(NoV, NoL, uClearCoatTint, uClearCoatThickness), clearCoatFactor);\n}\n\n// compute Light PBR for clearCoat layer\nvoid computeLightLambertGGXClearCoat(\n    const in float ccNoV,\n    const in vec3 normal,\n    const in vec3 eyeVector,\n    const in float dotNL,\n    const in vec4 precomputeGGX,\n\n    const in float attenuation,\n    const in vec3 lightColor,\n    const in vec3 eyeLightDir,\n\n    const in float clearCoatFactor,\n\n    out vec3 clearCoatSpecular,\n    out vec3 clearCoatAttenuation) {\n\n    if (dotNL <= 0.0) {\n        clearCoatSpecular = vec3(0.0);\n        clearCoatAttenuation = vec3(0.0);\n        return;\n    }\n\n    float ccNoL = saturate(dot(normal, -refract(eyeLightDir, normal, 1.0 / uClearCoatIor)));\n    vec3 clearCoatAbsorption = getClearCoatAbsorbtion(ccNoV, ccNoL, clearCoatFactor);\n\n    vec3 H = normalize(eyeVector + eyeLightDir);\n    float NoH = saturate(dot(normal, H));\n    float VoH = saturate(dot(eyeLightDir, H));\n\n    // distribution / visibility / fresnel\n    float D = D_GGX(precomputeGGX, NoH);\n    float V = V_SmithCorrelated(precomputeGGX, ccNoL);\n    float F = F_Schlick(uClearCoatF0, 1.0, VoH);\n\n    clearCoatSpecular = (attenuation * dotNL * clearCoatFactor * D * V * PI * F) * lightColor;\n    clearCoatAttenuation = (1.0 - F * clearCoatFactor) * clearCoatAbsorption;\n}\n'},"9HIO":function(e){e.exports=JSON.parse('{"allow_swift_shader":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Allow swift shader software rendering."},"animation_autoplay":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"Automatically play animations when the viewer starts."},"anisotropy":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"If we activate anisotropy when trilinear is chosen."},"annotation":{"type":"number","defaultValue":0,"values":"[1, 50]","share":"public","help":"Setting to [1, 50] will automatically load that annotation when the viewer starts."},"annotation_cycle":{"type":"number","defaultValue":null,"values":"+X","share":"public","help":"Setting to any number will start the Autopilot cycle with that duration, in seconds, at each annotation."},"annotations_visible":{"type":"bool","defaultValue":null,"values":"0, 1","share":"public","help":"Setting to 0 will hide annotations by default."},"annotation_tooltip_visible":{"type":"number","defaultValue":null,"values":"0, 1","share":"public","help":"Setting to 0 will hide annotations tooltip by default."},"api_hook_env":{"type":"string","defaultValue":null,"values":"prod, dev, staging, local","share":"private","help":"Viewer Api Debug."},"api_log":{"type":"bool","defaultValue":null,"values":"0, 1","share":"public","help":"Viewer Api helper for user."},"api_version":{"type":"string","defaultValue":null,"values":"string","share":"private","help":"The version of the viewer API."},"arkit":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Initialize the viewer in ARKit mode"},"arkit_debug":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Enter in debug mode for ar to debug in a desktop browser"},"async_image":{"type":"bool","defaultValue":false,"values":"0, 1","share":"shared","help":"Loads png and jpg in asynchronous (memory overhead for now so disabled by default)."},"async_shader":{"type":"number","defaultValue":0,"values":"+X","share":"shared","help":"Compile Shaders asynchronously, specify number of frame waiting for compilation, 0 to disable, 3 to enable at minimum"},"auto_material":{"type":"bool","defaultValue":0,"values":"0, 1","share":"private","help":"Select material on hover in inspector split."},"autospin":{"type":"number","defaultValue":0,"values":"+/-X","share":"public","help":"Setting to any number will cause the model to automatically spin around the z-axis after loading. The greater the number, the faster the spin. A negative number will reverse the spin direction."},"autostart":{"type":"bool","defaultValue":false,"values":"0, 1","share":"public","help":"Setting to 1 will make the model load immediately once the page is ready, rather than waiting for a user to click the Play button."},"camera":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","help":"Setting to 0 will skip the initial animation that occurs when a model is loaded, and immediately show the model in its default position."},"camera_constraints":{"type":"bool","defaultValue":true,"values":"0, 1","share":"shared","help":"Enable / Disable camera limits"},"camera_easing":{"type":"number","defaultValue":null,"values":"0..1","share":"private","help":"0 means no easing."},"camera_eye":{"type":"vec3","defaultValue":null,"values":"X,Y,Z","share":"private","help":"Forces position of the camera."},"camera_follow_bones":{"type":"number","defaultValue":0,"values":"0, 1, 2","share":"private","help":"1: translate eye 2: focus eye. You need to double-click the model on an animated part first."},"camera_target":{"type":"vec3","defaultValue":null,"values":"0, 1","share":"private","help":"Forces the target of the camera."},"cardboard":{"type":"number","defaultValue":0,"values":"0, 1, 2","share":"public","help":"Start in VR Mode automatically."},"carmel":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"If we are in the carmel context."},"clean_shader":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Pre-process the shader to resolve the define statement."},"ui_color":{"type":"string","defaultValue":"","values":"","share":"private","limited_to":"ent","help":"The primary color of the ui."},"continuous_render":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Redraw continuously."},"convert_vertex_color_8bit":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"Converts vertex color in 8bit."},"debug3d":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Open a dat.gui panel to debug 3d stuffs."},"depth_mipmap":{"type":"bool","defaultValue":0,"values":"+X","share":"private","help":"Uses depth mipmap."},"dof_attenuate_distance":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"Attenuates dof effect when we unzoom."},"dof_attenuate_speed":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Attenuates dof effect when we move the camera."},"dof_circle":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","help":"Shows dof focus point as cirle."},"dof_res":{"type":"number","defaultValue":2,"values":"+X","share":"private","help":"Resolution divider of dof postprocess (2 means half resolution)."},"dof_sticky":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"If the dof focus point sticks on the same place."},"dof_transition":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"If there is a transition when changing the dof focus point."},"double_click":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"pro","help":"If we allow double-click (focus constraint)."},"download_picture":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Download the thumbnail on Save View."},"drs":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"Enables dynamic resolution scaling."},"drs_ratio":{"type":"number","defaultValue":1,"values":"+X","share":"private","help":"Speeds at which we reduce the resolution."},"drs_fps":{"type":"number","defaultValue":15,"values":"0..1","share":"private","help":"Minimum before reducing the resolution."},"drs_min":{"type":"number","defaultValue":null,"values":"0..1","share":"private","help":"Minimum resoluton rate allowed, by default value is (1.0 / canvasPixelRatio)."},"drs_test":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Alternates between 2 drs values (for debugging purpose)."},"epsilon_alpha":{"type":"number","defaultValue":0.00001,"values":"0..1","share":"private","help":"GPU workaround bug with epsilon alpha discard threshold."},"float_rtt":{"type":"number","defaultValue":2,"values":"0, 1, 2","share":"private","help":"0 : force 8bit, 1 force float if supported, 2 : depends (dynamic)."},"force_controller":{"type":"string","defaultValue":"","values":"vive, daydream, oculus, windows, magicleap","share":"private","help":"Force display of controller (debug)."},"force_controller_orientation":{"type":"number","defaultValue":-0.5,"values":"-2..2","share":"private","help":"Rotates the controller when set: -2 is -2PI, 2 is 2PI"},"force_controller_ray_orientation":{"type":"number","defaultValue":-0.075,"values":"-2..2","share":"private","help":"Rotates the teleport ray when set: -2 is -2PI, 2 is 2PI"},"force_ms":{"type":"number","defaultValue":0,"values":"+X","share":"private","help":"Forces framerate with a setTimeout (in ms, 0 means requestAnimationFrame)."},"force_triangles":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"Forces merge of TRIANGLE and TRIANGLE_STRIP."},"fps_speed":{"type":"number","defaultValue":5,"values":"+X","share":"public","help":"Set the default walk speed in First-Person."},"fxaa":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"Uses fxaa."},"grain_speed":{"type":"number","defaultValue":64,"values":"+X","share":"private","help":"Grain animation speed, in ms."},"graph_optimizer":{"type":"bool","defaultValue":null,"values":"+X","share":"private","help":"Optimizes mesh (merge and bake geometries, etc), disabled by default in some cases (editor, api, processing)."},"image_compression":{"type":"bool","defaultValue":null,"values":"0, 1","share":"shared","help":"Use the full resolution, original textures (false in editor, true in viewer)."},"internal":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Allows us to use limited parameters on whitelisted domains (e.g. hide the watermark on sketchfab.com)."},"is_app":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"If we are in the mobile app context."},"keep_empty_geometries":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"If we want to keep the empty geometries in the scene graph instead of removing them."},"material_ao":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override ao channel for material given by material_names option."},"material_cavity":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override cavity channel for material given by material_names option."},"material_diffuse":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override diffuse channel for material given by material_names option."},"material_displacement":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override displacement channel for material given by material_names option."},"material_displacement_factor":{"type":"number","defaultValue":null,"values":"+X","share":"private","help":"override displacement factor channel for material given by material_names option."},"material_emissive":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override emissive channel for material given by material_names option."},"material_f0":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override f0 channel for material given by material_names option."},"material_glossiness":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override glossiness channel for material given by material_names option."},"material_metalness":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override metalness channel for material given by material_names option."},"material_names":{"type":"string","defaultValue":"main_material","values":"0, 1","share":"private","help":"Multiple names are separated with ; For example material_names=mat1;mat2."},"material_normal":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override normal channel for material given by material_names option."},"material_packing":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"Pack texture materials."},"material_roughness":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override roughness channel for material given by material_names option."},"material_showcase":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Enables material showcase."},"material_specular":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override specular channel for material given by material_names option."},"material_transparency":{"type":"string","defaultValue":null,"values":"0, 1","share":"private","help":"override opacity channel for material given by material_names option."},"max_texture_units":{"type":"number","defaultValue":32,"values":"+X","share":"private","help":"Sets maximum count of texture units."},"max_device_pixel_ratio":{"type":"number","defaultValue":1.5,"values":"+X","share":"public","help":"Sets maximum device pixel ratio we do allow, -1 to remove any limit"},"max_texture_size":{"type":"number","defaultValue":8192,"values":"+X","share":"private","help":"All texture capped at that texture size."},"max_vertex_uniforms":{"type":"number","defaultValue":8192,"values":"+X","share":"private","help":"Sets max vertex uniform."},"merge_materials":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"Merge similar materials."},"messaging":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private"},"model":{"type":"string","defaultValue":null,"values":"uid","share":"UID of model to hook."},"model_optimization":{"defaultValue":null,"help":"Use the unoptimized editor build.","share":"private","type":"bool","values":"0, 1"},"morph_epsilon":{"defaultValue":0.05,"help":"Epsilon to limit the number of interpolated morph targets per frame.","share":"private","type":"number","values":"+X"},"morph_gpu":{"defaultValue":4,"help":"Maximum morph gpu allowed (rest is done on the cpu), minimum value is 1.","share":"private","type":"number","values":"[1, +X]"},"navigation":{"type":"string","defaultValue":"orbit","values":"orbit, fps","share":"public","help":"Choose between fps and orbit mode."},"orbit_constraint_pan":{"type":"bool","defaultValue":null,"values":"0, 1","share":"public","limited_to":"pro","help":"Disable panning"},"orbit_constraint_pitch_down":{"type":"number","defaultValue":null,"values":"[-PI/2, PI/2]","share":"public","limited_to":"pro","help":"Pitch down limit."},"orbit_constraint_pitch_up":{"type":"number","defaultValue":null,"values":"[-PI/2, PI/2]","share":"public","limited_to":"pro","help":"Pitch up limit."},"orbit_constraint_yaw_left":{"type":"number","defaultValue":null,"values":"[-PI, PI]","share":"public","limited_to":"pro","help":"Yaw left limit."},"orbit_constraint_yaw_right":{"type":"number","defaultValue":null,"values":"[-PI, PI]","share":"public","limited_to":"pro","help":"Yaw right limit."},"orbit_constraint_zoom_in":{"type":"number","defaultValue":null,"values":"+X","share":"public","limited_to":"pro","help":"Zoom in limit."},"orbit_constraint_zoom_out":{"type":"number","defaultValue":null,"values":"+X","share":"public","limited_to":"pro","help":"Zoom out limit."},"orbit_pan_factor":{"type":"number","defaultValue":1,"values":"+X","share":"public","help":"A factor to control the camera pan speed."},"orbit_rotation_factor":{"type":"number","defaultValue":1,"values":"+X","share":"public","help":"A factor to control the camera rotation speed."},"orbit_zoom_factor":{"type":"number","defaultValue":1,"values":"+X","share":"public","help":"A factor to control the camera zoom speed."},"panorama":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Uses panorama hdr instead of cubemap."},"pixel_budget":{"type":"number","defaultValue":null,"values":"+X","share":"private","help":"x is nb of pixel (e.g 4096)."},"pratio":{"type":"number","defaultValue":null,"values":"+X","share":"private","help":"For debugging, same as osgjs overrideDevicePixelRatio (but shorter)."},"post_process":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"If postprocess filters are enabled."},"post_process_ascii":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"If postprocess ascii filter is enabled."},"power_preference":{"type":"string","defaultValue":"high-performance","values":"default|low-power|high-performance","share":"private","help":"Hint for gpu (power battery vs performance). Setting high-performance might be unsafe (context lost), so be wary."},"preload":{"type":"bool","defaultValue":false,"values":"0, 1","share":"public","help":"Download all textures before displaying the model."},"preserve_drawing_buffer":{"type":"bool","defaultValue":false,"values":"0, 1","share":"public","help":"WebGL canvas option."},"process_material":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Reprocess materials."},"process_options":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Reprocess all the options (same as a reupload without backend reprocessing)."},"quality":{"type":"number","defaultValue":null,"values":"+X","share":"private","help":"Quality of viewer (null means it depends of the fps), for now it only impacts a few postprocesses."},"refraction_res":{"type":"number","defaultValue":1,"values":"+X","share":"private","help":"Resolution divider of refraction texture (2 means half resolution)."},"resize_timeout":{"type":"number","defaultValue":1000,"values":"+X","share":"shared","help":"Resize timeout when the size is stable (in ms)."},"rgbm":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"For quick visual framebuffer debugging (spectorjs)."},"scale":{"type":"number","defaultValue":1,"values":"+X","share":"private","help":"Scale the scene (DEBUG only)."},"scale_epsilon":{"type":"number","defaultValue":0.00001,"values":"+X","share":"private","help":"Epsilon used to drop rendering of small matrixTransform/geometries (DEBUG only)."},"scrollwheel":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","help":"Disable zooming with scrollwheel (Ctrl+Click/drag still zooms)."},"shadow":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"enable shadow"},"shadow_atlas":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"enable shadow atlas."},"shadow_jitter_offset":{"type":"string","defaultValue":"default","values":"default, none","share":"private","help":"If we use jitter offset shadow."},"shadow_normal_offset":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"If we use normal offset shadow bias."},"shadow_PCF":{"type":"string","defaultValue":"1Tap(4texFetch)","values":"1Tap(4texFetch), 4Tap(16texFetch), 9Tap(36texFetch), 16Tap(64texFetch)","share":"private","help":"Shadow attempt to fight aliasing complex settings."},"shadow_texture_size":{"type":"number","defaultValue":1024,"values":"+X","share":"private","help":"Size of shadowmaps."},"share":{"type":"bool","defaultValue":false},"single_sided":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"Force single sided (or double sided) on all material"},"snap_keyframe":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Snap on keyframes."},"sound_enable":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"Enables the sound feature"},"sound_mute":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Mute any sound"},"sound_preload":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Preloads the sounds"},"split_limit":{"type":"number","defaultValue":65535,"values":"+X","share":"private","help":"Graph optimizer split limit"},"ssao_normal":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"DEBUG ONLY! otherwise needs mrt."},"ssr":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"Forces screen space reflection."},"ssr_transparent":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Enables SSR on transparent material (additive/blending/refraction)."},"sss_jitter":{"type":"number","defaultValue":1,"values":"[0, 1]","share":"private","help":"SSS jitter force ."},"sss_kernel":{"type":"number","defaultValue":17,"values":"11, 17, 25","share":"private","help":"Kernel size for diffuse kernel scattering."},"stats":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"OSGJS option to display stats"},"svg_size":{"type":"number","defaultValue":2048,"values":"+X","share":"private","help":"Default svg size."},"substance_displacement":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Moves vertices in y dimension only (displacement map)."},"supersample":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"If accumulation supersample is enabled or not."},"tracking":{"type":"bool","defaultValue":true,"limited_to":"staff"},"taa":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"Forces disabling/enabling of Temporal Anti-Aliasing."},"taa_animation":{"type":"bool","defaultValue":false,"values":"[0, 1]","share":"private","help":"If we allow taa while an animation is playing."},"taa_feedback_max":{"type":"number","defaultValue":0.97,"values":"[0, 1]","share":"private","help":"Feedback controls how much the current and the previous frames are blended together. The blending is done within the [min,max] range."},"taa_feedback_min":{"type":"number","defaultValue":0.88,"values":"[0, 1]","share":"private","help":"Feedback controls how much the current and the previous frames are blended together. The blending is done within the [min,max] range."},"taa_jitter":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"Enable/Disable jittering when not supersampling."},"taa_transparent":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"Enables taa on transparent objects."},"tab":{"type":"string","defaultValue":null,"values":"scene, lighting, materials, post processing filters, annotations, animation, virtual reality, sound","share":"private","help":"Default tab opening in the editor (note: the web is not using getOptions, the entry is here for documentation only)."},"texture_frame_budget":{"type":"number","defaultValue":512,"values":"+X","share":"private","help":"x is nb of pixel, Frame texture budget upload/allocation per frame."},"transparent":{"type":"bool","defaultValue":false,"values":"0, 1","share":"public","limited_to":"pro","help":"Makes the background transparent."},"ui_animations":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"prem","help":"Hide Animation menu / timeline."},"ui_annotations":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"prem","help":"Hide Annotation menu / controls."},"ui_ar":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"ent","help":"Hide View in AR button."},"ui_controls":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"prem","help":"Hide help, Settings, VR, Fullscreen."},"ui_fadeout":{"type":"bool","defaultValue":true,"limited_to":"prem"},"ui_fullscreen":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"prem","help":"Hide Fullscreen button."},"ui_general_controls":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"prem","help":"Hide all viewer controls."},"ui_help":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"prem","help":"Hide help button."},"ui_hint":{"type":"number","defaultValue":1,"values":"0, 1, 2","share":"public","limited_to":"prem","help":"Hide or force viewer hint."},"ui_infos":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"prem","alias":["desc_button"],"help":"Hide top info bar."},"ui_inspector":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","limited_to":"prem","help":"Show model inspector."},"ui_inspector_open":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Show model inspector open on start."},"ui_settings":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"prem","help":"Hide Settings button."},"ui_snapshots":{"type":"bool","defaultValue":false,"values":"0, 1","share":"public","help":"Show Save View button."},"ui_sound":{"type":"bool","defaultValue":true,"limited_to":"prem"},"ui_stop":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","alias":["stop_button"],"help":"Hide Stop Viewer button. "},"ui_theatre":{"type":"bool","defaultValue":false,"limited_to":"prem"},"ui_vr":{"type":"bool","defaultValue":true,"values":"0, 1","share":"public","limited_to":"prem","help":"Hide View in VR button."},"ui_watermark":{"type":"bool","defaultValue":true,"alias":["watermark"],"limited_to":"ent","help":"Disable watermark when false."},"ui_watermark_link":{"type":"bool","defaultValue":true,"limited_to":"biz","help":"Disable link in watermark when false."},"unit_render_local":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Uses for unit render test."},"unit_render_reporter":{"type":"string","defaultValue":"html","values":"console, html","share":"private","help":"To run 1 uid in /tests/screenshot"},"unit_render_task":{"type":"number","defaultValue":null,"values":"index","share":"private","help":"To run only one test in /tests/screenshot"},"use_vao":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"If we use the VAO gl extension."},"varying_sorting":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"Hack because of earlyz (bug gpu)."},"vr_ar":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"transparent background and no floor (to test)"},"vr_browser_env":{"type":"string","defaultValue":"c0022acc4f3242e2bcae8043e08df8cc","values":"uid","share":"private","help":"Model UID of the environment model for the vr browse."},"vr_fade":{"type":"number","defaultValue":200,"values":"+X","share":"private","help":"Fade time of the black transition in vr."},"vr_launcher_alpha_card_factor":{"type":"number","defaultValue":1,"values":"+X","share":"private","help":"Alpha card factor."},"vr_mirror":{"type":"bool","defaultValue":false,"values":"0, 1","share":"public","help":"Copy VR headset view on desktop screen."},"vr_mobile_max_faces":{"type":"number","defaultValue":50000,"values":"+X","share":"public","help":"Filter the fetched models in vr on mobile to those with a face count below the value"},"vr_quality":{"type":"number","defaultValue":null,"values":"+X","share":"public","help":"Sets vr quality ratio, shortcut for &vr_scale_rtt=1&max_device_pixel_ratio=X&pratio=X, 1.5 medium, 2.5 high, 3.5 very high (need good gpu)"},"vr_generate_ui_textures":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"Set to false to disable the UI texture generation in VR (fallback for ios app)"},"vr_force_raf":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"Debug only (force replacement of native raf with hmd raf)."},"vr_link_navigation":{"type":"bool","defaultValue":0,"values":"0, 1","share":"private","help":"1 means the vr launcher use standards link navigation to navigate in VR."},"vr_in_navigation":{"type":"bool","defaultValue":0,"values":"0, 1","share":"private","help":"1 means browser is in vr."},"vr_scale_rtt":{"type":"number","defaultValue":0,"values":"+X","share":"private","help":"If not 0, it will scale the size of te recommended vr renderTarget."},"vr_max_rtt_size":{"type":"number","defaultValue":null,"values":"+X","share":"public","help":"If not null, it will limit the rtt size"},"vr_stereo":{"type":"bool","defaultValue":true,"values":"0, 1","share":"private","help":"Mostly for debugging vr on desktop: disable stereo view in vr context."},"webgl2":{"type":"bool","defaultValue":null,"values":"0, 1","share":"shared","help":"Uses webgl2 instead of webgl1 if provided."},"webgl_ext":{"type":"bool","defaultValue":true,"share":"private","help":"when false, disables any webgl extensions."},"webgl_render_texture":{"type":"string","defaultValue":null,"values":"none, float, float_linear, half_float,half_float_linear","share":"private","help":"only allow up to the format"},"webgl_restore":{"type":"number","defaultValue":3,"values":"+X","share":"private","help":"when 0, enables webgl restore on other browser than Edge."},"webgl_timer_gpu":{"type":"bool","defaultValue":false,"values":"0, 1","share":"private","help":"when false, disables gpu timer queries for cleaner gl traces."},"webgl_uniforms":{"type":"bool","defaultValue":false,"share":"private","help":"artificially limits to 64 uniform."},"wireframe_preload":{"type":"bool","defaultValue":null,"values":"0, 1","share":"private","help":"Forces wireframe preload."},"zoct":{"type":"bool","defaultValue":false,"staff_only":true,"help":"octahedral encoding"},"zq":{"type":"bool","defaultValue":true,"staff_only":true,"help":"16 bit quantization for *vertex* (false means float)"},"zw":{"type":"bool","defaultValue":true,"staff_only":true,"help":"use 4th component for lossless antirip"},"zratio":{"type":"number","defaultValue":50,"staff_only":true,"help":"ratio test when we merge 2 geoms that have 2 very different boxes (far apart / different size). smaller value = more chance to disable quantiz"},"zz":{"type":"bool","defaultValue":null,"staff_only":true,"help":"use compression"}}')},"9MMX":function(e,t,n){"use strict";var i,r=n("tNdj").a.extend({});i=n("eycI").a.extend({model:r,url:"/i/skills"});t.a=i},"9PC4":function(e,t,n){"use strict";t.a=function(e,t,n,i,r){for(var a=e.length/r,o=0;o<a;++o)for(var s=o*r,u=0;u<r;++u)t[s+u]=n[u]+e[s+u]*i[u];return t}},"9U7P":function(e,t,n){"use strict";var i=n("cDf5"),r=n.n(i),a=n("EVdn"),o=n.n(a),s=n("YfG3"),u=n("dZz+");t.a={name:"DragAndDrop",dependencies:["WithOptionTypes"],_dragAndDropEnabled:!1,initializeDragAndDrop:function(e){var t="boolean"==typeof this.options.dragAndDrop?{enabled:this.options.dragAndDrop}:this.options.dragAndDrop||{};this.options.dragAndDrop=Object(s.a)({},t,e),this._dragAndDropEnabled=void 0===this.options.dragAndDrop.enabled||this.options.dragAndDrop.enabled,this.onDragEnter=this.onDragEnter.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this._dragAndDropInitialized=!0,this.delegateDragAndDrop()},getDragAndDropEnabled:function(){return this._dragAndDropEnabled},setDragAndDropElements:function(){this.setDragAndDropTargetElement(),this.setDragAndDropDropboxElement()},setDragAndDropTargetElement:function(){this.options.dragAndDrop.target?"object"===r()(this.options.dragAndDrop.target)||this.options.dragAndDrop.external?this._$dragAndDropTarget=o()(this.options.dragAndDrop.target):this.options.dragAndDrop.external||(this._$dragAndDropTarget=this.$(this.options.dragAndDrop.target)):this._$dragAndDropTarget=this.$el},getDragAndDropTarget:function(){return this._$dragAndDropTarget},getDragAndDropDropbox:function(){return this._$dropbox},setDragAndDropDropboxElement:function(){if(this.options.dragAndDrop.dropbox){var e=this.options.dragAndDrop.dropbox,t=r()(e);this._$dropbox="string"===t?this.$(e):"function"===t?o()(e.call(this)):o()(e)}else this._$dropbox=this._$dragAndDropTarget},delegateDragAndDrop:function(){this._dragAndDropInitialized&&(this.setDragAndDropElements(),this._$dragAndDropTarget&&u.a.me().isAuthenticated()&&this.getDragAndDropEnabled()&&(this._$dragAndDropTarget.on("dragenter",this.onDragEnter),this._$dragAndDropTarget.on("dragover",this.onDragOver),this._$dragAndDropTarget.on("drop",this.onDrop),this._$dragAndDropTarget.on("dragend",this.onDragEnd),this._$dragAndDropTarget.on("dragleave",this.onDragLeave)))},undelegateDragAndDrop:function(){this._$dragAndDropTarget&&(this._$dragAndDropTarget.off("dragenter",this.onDragEnter),this._$dragAndDropTarget.off("dragover",this.onDragOver),this._$dragAndDropTarget.off("drop",this.onDrop),this._$dragAndDropTarget.off("dragend",this.onDragEnd),this._$dragAndDropTarget.off("dragleave",this.onDragLeave))},isNotDraggingFile:function(e){var t=(e.originalEvent?e.originalEvent:e).dataTransfer;return t&&t.types&&t.types.concat&&-1===t.types.indexOf("Files")},isDropPending:function(){return!1},onDragEnter:function(e){if(!this.isNotDraggingFile(e)&&!this.isDropPending()){e.preventDefault();var t=this.getDragAndDropDropbox();t.addClass("file-upload-drag"),e.target===t[0]&&t.addClass("accepting")}},onDragEnd:function(e){var t=this.getDragAndDropDropbox(),n=this.getDragAndDropTarget();e.target===t[0]&&t.removeClass("accepting"),e.target===n[0]&&t.removeClass("file-upload-drag"),e.preventDefault()},onDragOver:function(e){e.preventDefault()},onDragLeave:function(e){e.preventDefault(),this.onDragEnd(e)},onDrop:function(e){e.preventDefault();var t=(e=e.originalEvent?e.originalEvent:e).dataTransfer.files,n=this.getDragAndDropDropbox();n.removeClass("file-upload-drag accepting"),t&&t.length&&e.target===n[0]&&this.onFilesDrop(t)},onFilesDrop:function(e){console.info(e.length+" files were dropped on the following element : ",this._$dropbox," nothing has been done with them.")}}},"9hCi":function(e,t,n){"use strict";var i=n("I2mH"),r=n("gCTM");n("NYmz");t.a={shareOnFacebook:function(e,t){i.a.getSDK().then(function(n){n.ui({method:"share",href:e,quote:t})})},shareOnTwitter:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{via:"sketchfab"},i=window.screen.width/2-400,r=window.screen.height/2-200,a="https://twitter.com/intent/tweet?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(t);n.hasOwnProperty("via")&&null!==n.via&&(a+="&via="+n.via);var o=window.open(a,"_blank","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=800, height=400");o&&o.moveTo(i,r)},shareOnPinterest:function(e,t,n){var i=window.screen.width/2-390,r=window.screen.height/2-200,a="http://pinterest.com/pin/create/button/?url="+encodeURIComponent(e)+"&description="+encodeURIComponent(t)+"&media="+encodeURIComponent(n),o=window.open(a,"_blank","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=780, height=400");o&&o.moveTo(i,r)},shareOnReddit:function(e,t){var n="https://www.reddit.com/submit?url="+encodeURIComponent(e)+"&title="+encodeURIComponent(t);window.open(n,"_blank")},shareOnTumblr:function(e,t){var n=window.screen.width/2-270,i=window.screen.height/2-300,a=r.default.get("skfb_front/partials/embed/iframe",{model:e,parameters:{flags:[]}}),o="https://www.tumblr.com/widgets/share/tool?posttype=video&content="+encodeURIComponent(a.replace(/(\r\n|\n|\r)/gm,""))+"&canonicalUrl="+encodeURIComponent(t),s=window.open(o,"_blank","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, copyhistory=no, width=540, height=600");s&&s.moveTo(n,i)},shareOnLinkedin:function(e){var t=window.screen.width/2-300,n=window.screen.height/2-235,i="https://www.linkedin.com/cws/share?url="+encodeURIComponent(e),r=window.open(i,"_blank","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=600, height=470");r&&r.moveTo(t,n)},getMailTo:function(e){var t=e.modelName,n=e.userName,i=e.isCollectionMode,r=e.url,a=t+" by "+n,o=i?["Check out this collection of 3D/VR models on Sketchfab:","\n",a,"\n",r+"?utm_source=email&utm_medium=email&utm_campaign=collection-shared"].join(""):["Check out this model in 3D and virtual reality on Sketchfab:","\n",a,"\n",r+"?utm_source=email&utm_medium=email&utm_campaign=model-shared"].join("");return"mailto:?subject="+encodeURIComponent(a)+"&body="+encodeURIComponent(o)}}},"9mpE":function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"f",function(){return l}),n.d(t,"e",function(){return c}),n.d(t,"a",function(){return h}),n.d(t,"d",function(){return d});var i=n("J4zp"),r=n.n(i),a=n("HA5h"),o=n("dAuA");function s(e){return"cursor"===e||"page"===e}function u(){var e=arguments.length<2?["",arguments.length<=0?void 0:arguments[0]]:[arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1]],t=r()(e,2),n=t[0],i=t[1];i=Object(o.b)(i);var a=Object.keys(i).sort(function(e,t){return s(e)?1:s(t)?-1:e===t?0:e<t?-1:1}).map(function(e){return i[e].filter(function(e){return null!==e&&void 0!==e&&""!==e}).map(function(t){return!0!==t&&!1!==t||(t=Number(t)),[e,t].map(function(e){return encodeURIComponent(e).replace(/%20/g,"+").replace(/%25/g,"%").replace(/%2C/g,",")}).join("=")}).join("&")}).filter(function(e){return e.length>0}).join("&");return a?n+a:""}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.location.search.substr(1);return Object(o.b)(n)[e]||t}function c(e,t){var n=l(e,void 0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.location.search.substr(1));return n.length?n.pop():void 0!==t?t.toString():void 0}function h(e,t){var n=c(e,void 0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.location.search.substr(1));return void 0===n?void 0!==t?Boolean(t):void 0:"0"!==n}function d(e,t){var n=c(e,void 0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.location.search.substr(1));return void 0===n?void 0!==t?Number(t):void 0:Number(n)}t.c={craft:u,reset:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.prototype.slice.call(t).map(o.b).reduce(function(e,t){return Object(a.a)(e,t)},{})},strings:l,string:c,bool:h,number:d,vec3:function(e,t){var n=c(e,void 0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.location.search.substr(1));if(!n)return t;if((n=n.split(",")).length<3)return t;n.length=3;for(var i=0;i<3;++i)n[i]=parseFloat(n[i]);return n}}},"9x6x":function(e,t,n){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&function(e){return function(t){return function(n,i){var r={key:n,value:t[n]},a={key:i,value:t[i]};return e(r,a)}}}(t.cmp),r=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var a,o;if(Array.isArray(t)){for(o="[",a=0;a<t.length;a++)a&&(o+=","),o+=e(t[a])||"null";return o+"]"}if(null===t)return"null";if(-1!==r.indexOf(t)){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=r.push(t)-1,u=Object.keys(t).sort(i&&i(t));for(o="",a=0;a<u.length;a++){var l=u[a],c=e(t[l]);c&&(o&&(o+=","),o+=JSON.stringify(l)+":"+c)}return r.splice(s,1),"{"+o+"}"}}(e)}},A35o:function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/components/molecules/label-switch-button.jinja"]={root:function(e,t,n,i,r){var a="";try{var o=i.makeMacro([],["options"],function(r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var o="";return o+='\n    <span class="c-label-switch-button">\n        ',o+=i.suppressValue(e.getFilter("component").call(t,i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"components"),"switchButton")),e.opts.autoescape),o+="\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"label")&&(o+='\n            <label class="c-label-switch-button__label">',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"label"),e.opts.autoescape),o+="</label>\n        "),o+="\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"error")&&(o+='\n            <p class="form-error c-label-switch-button__error">\n                ',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"error"),e.opts.autoescape),o+="\n            </p>\n        "),o+="\n    </span>\n",n=a,new i.SafeString(o)});t.addExport("label_switch_button"),t.setVariable("label_switch_button",o),r(null,a+="\n")}catch(e){r(i.handleError(e,null,null))}}}},A6cf:function(e,t){e.exports="uniform sampler2D TextureInput;\n\nuniform float uChromaFactor;\n\nvec4 chromaticAberration() {\n    vec2 uv = gTexCoord;\n\n    vec2 dist = uv - 0.5;\n    vec2 offset = uChromaFactor * dist * length(dist);\n    vec3 col;\n    col.r = TEXTURE_2D_TextureInput(uv - offset).r;\n    col.g = TEXTURE_2D_TextureInput(uv).g;\n    col.b = TEXTURE_2D_TextureInput(uv + offset).b;\n\n    return vec4(col, 1.0);\n}"},AGoD:function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("J4zp"),o=n.n(a),s=n("q1tI"),u=n("gPpI"),l=n("wsGC"),c=n("FcGm"),h=n("5bbf");t.a=s.memo(function(e){var t=e.className,n=s.useContext(h.a),i=s.useState(!1),a=o()(i,2),d=a[0],f=a[1];return r()("a",{"aria-label":"Go to the mainpage",className:t,href:Object(u.e)("pages:index"),onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)}},void 0,r()(c.a,{color:"transparent"===n?"white":l.b.skfbGrey0,logoColor:"transparent"===n&&d?"white":"transparent",circleColor:"transparent"!==n||d?l.b.skfbBlue:"white"}))})},AhqU:function(e,t,n){"use strict";var i={PICK_GEOMETRY_FIXED:1,PICK_GEOMETRY_ANIMATED:2,PICK_GEOMETRY_RIG_BOX:4,PICK_GIZMO_LIGHT:8,SHADOW_CAST:16,SHADOW_BOUNDS:32};i.PICK_GEOMETRY_SLOW=i.PICK_GEOMETRY_FIXED|i.PICK_GEOMETRY_ANIMATED,i.PICK_GEOMETRY_FAST=i.PICK_GEOMETRY_FIXED|i.PICK_GEOMETRY_RIG_BOX,i.PICK_GEOMETRY=i.PICK_GEOMETRY_FIXED|i.PICK_GEOMETRY_ANIMATED|i.PICK_GEOMETRY_RIG_BOX,i.PICK=i.PICK_GEOMETRY|i.PICK_GIZMO_LIGHT,i.SHADOW=i.SHADOW_BOUNDS|i.SHADOW_CAST,i.PICK_GEOMETRY_SHADOW=i.PICK_GEOMETRY|i.SHADOW,i.NO_SHADOW=~i.SHADOW,i.NO_PICK=~i.PICK,i.NO_PICK_NO_SHADOW_CAST=~(i.PICK|i.SHADOW_CAST),i.NO_PICK_NO_SHADOW_BOUNDS=~(i.PICK|i.SHADOW_BOUNDS),i.NO_PICK_NO_SHADOW=~(i.PICK|i.SHADOW),t.a=i},AoCp:function(e,t,n){"use strict";var i=n("vBtE"),r=n("dZz+");t.a=i.a.extend({isReady:!1,initialize:function(){i.a.prototype.initialize.apply(this,arguments),this.$el.addClass("btn-loading btn-disabled"),this.$el.find(".button").addClass("btn-disabled"),r.a.me().isAuthenticated()||this.setIsReady()},setIsReady:function(){this.isReady=!0,this.isLoading=!1,this.$el.removeClass("btn-loading btn-disabled"),this.$el.find(".button").removeClass("btn-disabled")},setIsLoading:function(){this.isReady=!1,this.isLoading=!0}})},Auie:function(e,t,n){"use strict";var i=n("QLQS"),r=n("AhqU"),a=n("JQdh"),o=n("kUJ5"),s=n("93PM"),u=n("1f5D"),l=n("par7"),c=n("fgaA"),h=i.a.osg,d=i.a.osgUtil,f=function(){h.NodeVisitor.call(this),this.setNodeMaskOverride(-1)};f.prototype=h.objectInherit(h.NodeVisitor.prototype,{apply:function(e){e.setShape&&e.setShape(null),this.traverse(e)}});var p={init:function(e,t){this._context=e,this._viewer=e.getViewer(),this._viewerOSGJS=this._viewer.getViewerOSGJS(),this._features=this._context.getFeatures(),this._rootModel=t,h.time("compute KdTree"),this.computeKdTree(t),h.timeEnd("compute KdTree"),this._initialized=!0},isInitialized:function(){return this._initialized},getViewport3d:function(){return this._features.postProcess.getCamera().getViewport()},getMaterialFromHit:function(e){return this._features.material.getModel().findFirstMaterial(e._nodePath)},decodeDepth:function(e){if(255===e[0])return 1;var t=e[0]+e[1]/255;return 3&e&&(t+=e[2]/65025),t/255},pickDepth:function(){var e=new Uint8Array(4);return function(t,n,i){return t.readPixels(n,i,1,1,t.RGBA,t.UNSIGNED_BYTE,e),this.decodeDepth(e)}}(),getWorldPositionFromDepthXY:function(){var e=h.vec4.create(),t=h.mat4.create();return function(n,i,r,a){var o=this._viewerOSGJS.getCamera(),s=this._viewer.getFeaturesManager().getViewport3d(),l=u.a.uNearFar.getInternalArray(),c=l[0]+(l[1]-l[0])*n;return e[0]=(i/s.width()*2-1)*c,e[1]=(r/s.height()*2-1)*c,e[2]=1,e[3]=c,h.mat4.invert(t,o.getProjectionMatrix()),h.vec4.transformMat4(e,e,t),h.mat4.invert(t,o.getViewMatrix()),h.vec3.transformMat4(a||h.vec3.create(),e,t)}}(),getPixelDepth:function(e,t,n){l.a.draw();var i=this._features.quality.getModel(),r=i.get("dynamicResolutionScaling")[0],a=Object(c.a)().stats&&this._viewerOSGJS.getViewerStats();s.a.setCallbackDepth(function(o){s.a.setCallbackDepth(void 0),a&&a.getCounter("readpixels").start();var u=o.getGraphicContext();if(u.checkFramebufferStatus(u.FRAMEBUFFER)!==u.FRAMEBUFFER_COMPLETE)return n(-1);u.flush(),u.finish();var l=i.get("dynamicResolutionScaling")[0];r!==l&&(e=e*l/r,t=t*l/r);var c=this.pickDepth(u,e,t,n);a&&a.getCounter("readpixels").end(),n(c,e,t,u)}.bind(this))},_computeIntersections3D:function(){var e=new d.IntersectionVisitor,t=new d.LineSegmentIntersector;return function(n,i,o,s){s||(s=this._features.webVR.getNode()),void 0===o&&(o=r.a.PICK_GEOMETRY_SLOW),e.reset(),t.reset();var u=this._features.shadingStyle,l=u&&u.getModel().get("hasLines"),c=u&&u.getModel().get("hasPoints"),h=.005*a.a.getModelBoxWithoutDisplacement().radius(),d=c||l?h:0;return e.setTraversalMask(o),e.setIntersector(t),t.set(n,i,d),s.accept(e),t.getIntersections()}}(),computeNearestIntersection3D:function(e,t,n,i){var r=this._computeIntersections3D(e,t,n,i);return this._sortIntersections(r)},computeNearestIntersection3DHotspotFirst:function(e,t,n,i){var r=this._computeIntersections3D(e,t,n,i);if(0!==r.length){r.sort(function(e,t){return e._ratio-t._ratio});var a=0,o=r.length,s=this._features.hotspot.getWidgetNode();for(a=0;a<o;++a)if(-1!==r[a]._nodePath.indexOf(s))return r[a];return this._getFirstVisibleHit(r)}},pickNearestSurface:function(e){return this.computeNearestIntersection2D(e.canvasX,e.canvasY,r.a.PICK_GEOMETRY_SLOW,this._rootModel)},_computeIntersections2D:function(){var e=h.vec3.create(),t=h.vec3.create(),n=h.mat4.create();return function(i,r,a,s){return s||(s=this._features.webVR.getNode()),o.a.canvasCoordToGL(i,r,e),o.a.canvasCoordToGL(i,r,t),e[2]=0,t[2]=1,this.getWorldPositionFromScreenPoint(e,e),this.getWorldPositionFromScreenPoint(t,t),s.getWorldMatrix(void 0,n),h.mat4.invert(n,n),h.vec3.transformMat4(e,e,n),h.vec3.transformMat4(t,t,n),this._computeIntersections3D(e,t,a,s)}}(),computeNearestIntersection2D:function(e,t,n,i){var r=this._computeIntersections2D(e,t,n,i);return this._sortIntersections(r)},_sortIntersections:function(e){if(0!==e.length)return e.sort(function(e,t){return e._ratio-t._ratio}),this._getFirstVisibleHit(e)},_getFirstVisibleHit:function(e){for(var t=0,n=e.length;t<n;++t){var i=e[t];if(!i._backface)return i;for(var r=i._nodePath,a=r.length-1;a>=0;--a){var o=r[a].getStateSet(),s=o&&o.getAttribute("CullFace");if(void 0!==s){if(s.getMode()===h.CullFace.DISABLE)return i;break}}}},getRelativePositionFromHit:function(){var e=h.mat4.create(),t=h.mat3.create();return function(n,i,r,a){for(var o=n._nodePath,s=!1,u=0,l=o.length;u<l;++u)if(o[u]===a){o=o.slice(u),s=!0;break}return h.mat4.identity(e),!1===s&&o[0].getWorldMatrix(a,e),h.computeLocalToWorld(o,!0,e),h.vec3.transformMat4(i,n._localIntersectionPoint,e),r&&(h.mat3.normalFromMat4(t,e),h.vec3.transformMat3(r,n._localIntersectionNormal,t),h.vec3.normalize(r,r)),i}}(),getWorldPositionFromHit:function(e,t,n){return this.getRelativePositionFromHit(e,t,n,this._viewerOSGJS.getSceneData())},getScenePositionFromHit:function(e,t,n){return this.getRelativePositionFromHit(e,t,n,this._rootModel)},getWorldPositionFromScenePoint:function(e,t){var n=t||h.vec3.create(),i=this._features.orientation,r=this._features.autospin;return i&&h.vec3.transformMat4(n,e,i.getNode().getMatrix()),r&&h.vec3.transformMat4(n,n,r.getNode().getMatrix()),n},getScenePositionFromWorldPoint:function(){var e=h.mat4.create();return function(t,n){var i=n||h.vec3.create(),r=this._features.orientation,a=this._features.autospin;return h.mat4.identity(e),r&&h.mat4.multiply(e,e,r.getNode().getMatrix()),a&&h.mat4.multiply(e,e,a.getNode().getMatrix()),h.mat4.invert(e,e),h.vec3.transformMat4(i,t,e)}}(),getScreenPositionFromScenePoint:function(e,t){var n=this.getWorldPositionFromScenePoint(e,t);return this.getScreenPositionFromWorldPoint(n,n)},getScreenPositionFromWorldPoint:function(){var e=h.mat4.create();return function(t,n){if(this._viewerOSGJS){var i=this._viewerOSGJS.getCamera();h.mat4.identity(e),this.getViewport3d().computeWindowMatrix(e),h.mat4.multiply(e,e,i.getProjectionMatrix()),h.mat4.multiply(e,e,i.getViewMatrix());var r=n||h.vec3.create();return h.vec3.transformMat4(r,t,e)}}}(),getWorldPositionFromScreenPoint:function(){var e=h.mat4.create();return function(t,n){var i=this._viewerOSGJS.getCamera();h.mat4.identity(e),this.getViewport3d().computeWindowMatrix(e),h.mat4.multiply(e,e,i.getProjectionMatrix()),h.mat4.multiply(e,e,i.getViewMatrix()),h.mat4.invert(e,e);var r=n||h.vec3.create();return h.vec3.transformMat4(r,t,e)}}(),getScenePositionFromScreenPoint:function(e,t){var n=this.getWorldPositionFromScreenPoint(e,t);return this.getScenePositionFromWorldPoint(n,n)},computeKdTree:function(e){for(var t=this._context.getScene().getWireframeNodes(),n=new f,i=t.length,r=0;r<i;++r)t[r].accept(n);new h.KdTreeBuilder({_numVerticesProcessed:0,_targetNumTrianglesPerLeaf:50,_maxNumLevels:50}).apply(e)}};t.a=p},AwiE:function(e,t,n){"use strict";var i,r=n("icjm"),a=n("NuLH"),o=n("WDex"),s=n("fgaA"),u=function(){i||(i=n("ULzY").default),this._checkRTT={},this._webGLExtensions={},this._webGLParameters={},this._webGLShaderMaxInt="NONE",this._webGLShaderMaxFloat="NONE",this._bugsDB={},this._webGLPlatforms={},this._webGLParameters.MAX_COMBINED_TEXTURE_IMAGE_UNITS=8,this._webGLParameters.MAX_CUBE_MAP_TEXTURE_SIZE=16,this._webGLParameters.MAX_FRAGMENT_UNIFORM_VECTORS=16,this._webGLParameters.MAX_RENDERBUFFER_SIZE=1,this._webGLParameters.MAX_TEXTURE_IMAGE_UNITS=8,this._webGLParameters.MAX_TEXTURE_SIZE=64,this._webGLParameters.MAX_VARYING_VECTORS=8,this._webGLParameters.MAX_VERTEX_ATTRIBS=8,this._webGLParameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS=0,this._webGLParameters.MAX_VERTEX_UNIFORM_VECTORS=128,this._webGLParameters.MAX_VIEWPORT_DIMS=[1,1],this._webGLParameters.NUM_COMPRESSED_TEXTURE_FORMATS=0,this._webGLParameters.MAX_SHADER_PRECISION_FLOAT="none",this._webGLParameters.MAX_SHADER_PRECISION_INT="none",this._gl=void 0};u.instance=function(e,t){if(!u._instance){var n,i=e;if(!i){"undefined"!=typeof window&&window.gli&&(n=window.gli.host.inspectContext,window.gli.host.inspectContext=!1);var s=document.createElement("canvas");s.width=32,s.height=32;var l=new o.a;l.extend({antialias:!1}),l.extendWithOptionsURL(),i=a.a.setupWebGL(s,l,function(){}),this._webglTemporary=i}u._instance=new u,i?u._instance.init(i):r.a.warn("no support for webgl context detected."),n&&(window.gli.host.inspectContext=n)}if(e){if(this._webglTemporary&&this._webglTemporary!==e){var c=i&&i.getExtension("WEBGL_lose_context");c&&c.loseContext(),this._webglTemporary=null}(t||e!==this._webglTemporary)&&(u._instance.initContextDependant(e),this._webglTemporary=e)}return u._instance},u.prototype={getContext:function(){return this._gl},initContextDependant:function(e){this._gl=e,this._isGL2=void 0!==window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext,this.initWebGLExtensions(e),Object(s.a)().webglUniforms&&(this._webGLParameters.MAX_FRAGMENT_UNIFORM_VECTORS=64),this.hasLinearHalfFloatRTT(e),this.hasLinearFloatRTT(e),this.hasHalfFloatRTT(e),this.hasFloatRTT(e)},init:function(e){if(this.initWebGLParameters(e),this.initPlatformSupport(),this.initBugDB(e),this.initContextDependant(e),this._isGL2)for(var t=["OES_element_index_uint","EXT_sRGB","EXT_blend_minmax","EXT_frag_depth","WEBGL_depth_texture","EXT_shader_texture_lod","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_texture_half_float_linear","OES_texture_float_linear","OES_vertex_array_object","WEBGL_draw_buffers","OES_fbo_render_mipmap","ANGLE_instanced_arrays"],n=u._instance.getWebGLExtensions(),i=function(){},r=0,a=t.length;r<a;r++)n[t[r]]=i},isWebGL2:function(){return this._isGL2},initBugDB:function(e){var t=this._webGLPlatforms,n=this._webGLParameters;if(t.Apple&&(n.UNMASKED_VENDOR_WEBGL&&-1===n.UNMASKED_VENDOR_WEBGL.indexOf("Intel")||(this._bugsDB.OES_standard_derivatives=!0)),e.getExtension("EXT_shader_texture_lod")){var i={type:"FRAGMENT_SHADER",text:["#version 100","#extension GL_EXT_shader_texture_lod : require","#ifdef GL_FRAGMENT_PRECISION_HIGH","  precision highp float;","#else"," precision mediump float;","#endif","uniform samplerCube uT0;","varying vec3 vC;","void main(void) {","  gl_FragColor = textureCubeLodEXT(uT0, vC, 1.0);","}"].join("\n")};this.checkShader(e,i.type,i.text)||(this._bugsDB.EXT_shader_texture_lod=!0)}},checkShader:function(e,t,n){var i=t;"string"==typeof i&&(i=e[t]);var a=e.createShader(i);return e.shaderSource(a,n),e.compileShader(a),!(!e.getShaderParameter(a,e.COMPILE_STATUS)&&!e.isContextLost())||(r.a.warn(e.getShaderInfoLog(a)),!1)},initPlatformSupport:function(){var e=this._webGLPlatforms;e.Apple=-1!==navigator.vendor.indexOf("Apple")||-1!==navigator.vendor.indexOf("OS X"),e.Mobile=/Mobi/.test(navigator.userAgent)||/ablet/.test(navigator.userAgent)},getWebGLPlatform:function(e){return this._webGLPlatforms[e]},getWebGLPlatforms:function(){return this._webGLPlatforms},getWebGLParameter:function(e){return this._webGLParameters[e]},getWebGLParameters:function(){return this._webGLParameters},getShaderMaxPrecisionFloat:function(){return this._webGLParameters.MAX_SHADER_PRECISION_FLOAT},getShaderMaxPrecisionInt:function(){return this._webGLParameters.MAX_SHADER_PRECISION_INT},checkSupportRTT:function(e,t,n){var r=t+","+n;if(this._isGL2)return!!this._webGLExtensions.EXT_color_buffer_float;if(void 0!==this._checkRTT[r])return this._checkRTT[r];if(!e)return!1;switch(Object(s.a)().webglRenderTexture){case"none":return!1;case"float":if(t===i.FLOAT&&n===i.LINEAR)return!1;break;case"half_float":if(t===i.FLOAT)return!1;if(n===i.LINEAR)return!1;break;case"half_float_linear":if(t===i.FLOAT)return!1}var a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,2,2,0,e.RGBA,t,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0);var u=this._checkRTT[r]=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.deleteTexture(a),e.deleteFramebuffer(o),e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),u},hasLinearHalfFloatRTT:function(e){return this._webGLExtensions.OES_texture_half_float_linear&&this.checkSupportRTT(e,i.HALF_FLOAT_OES,i.LINEAR)},hasLinearFloatRTT:function(e){return this._webGLExtensions.OES_texture_float_linear&&this.checkSupportRTT(e,i.FLOAT,i.LINEAR)},hasHalfFloatRTT:function(e){return this._webGLExtensions.OES_texture_half_float&&this.checkSupportRTT(e,i.HALF_FLOAT_OES,i.NEAREST)},hasFloatRTT:function(e){return this._webGLExtensions.OES_texture_float&&this.checkSupportRTT(e,i.FLOAT,i.NEAREST)},queryPrecision:function(e,t,n){var i=e.getShaderPrecisionFormat(t,n);return!!i&&0!==i.precision},hasVAO:function(){return!!this._webGLExtensions.OES_vertex_array_object},getDisjointTimerQuery:function(){return this._webGLExtensions.EXT_disjoint_timer_query_webgl2||this._webGLExtensions.EXT_disjoint_timer_query},initWebGLParameters:function(e){if(e){for(var t=["MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_RENDERBUFFER_SIZE","MAX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_VARYING_VECTORS","MAX_VERTEX_ATTRIBS","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_VERTEX_UNIFORM_VECTORS","MAX_VIEWPORT_DIMS","SHADING_LANGUAGE_VERSION","VERSION","VENDOR","RENDERER","ALIASED_LINE_WIDTH_RANGE","ALIASED_POINT_SIZE_RANGE","RED_BITS","GREEN_BITS","BLUE_BITS","ALPHA_BITS","DEPTH_BITS","STENCIL_BITS"],n=this._webGLParameters,i=0,r=t.length;i<r;++i){var a=t[i];n[a]=e.getParameter(e[a])}this.queryPrecision(e,e.FRAGMENT_SHADER,e.HIGH_FLOAT)?n.MAX_SHADER_PRECISION_FLOAT="high":this.queryPrecision(e,e.FRAGMENT_SHADER,e.MEDIUM_FLOAT)?n.MAX_SHADER_PRECISION_FLOAT="medium":this.queryPrecision(e,e.FRAGMENT_SHADER,e.LOW_FLOAT)&&(n.MAX_SHADER_PRECISION_FLOAT="low"),this.queryPrecision(e,e.FRAGMENT_SHADER,e.HIGH_INT)?n.MAX_SHADER_PRECISION_INT="high":this.queryPrecision(e,e.FRAGMENT_SHADER,e.MEDIUM_INT)?n.MAX_SHADER_PRECISION_INT="medium":this.queryPrecision(e,e.FRAGMENT_SHADER,e.LOW_INT)&&(n.MAX_SHADER_PRECISION_INT="low");var o=e.getExtension("WEBGL_debug_renderer_info");o&&(n.UNMASKED_RENDERER_WEBGL=e.getParameter(o.UNMASKED_RENDERER_WEBGL),n.UNMASKED_VENDOR_WEBGL=e.getParameter(o.UNMASKED_VENDOR_WEBGL))}},applyExtension:function(e,t){var n=e.getExtension(t),i=t.split("_")[0],r="_"+i,a=new RegExp(i+"$"),o=new RegExp(r);for(var s in n){if("function"==typeof n[s]){var u=s.replace(a,"");void 0===e[u]&&(e[u]=n[s].bind(n))}else{var l=s.replace(o,"");void 0===e[l]&&(e[l]=n[s])}}},getWebGLExtension:function(e){return this._webGLExtensions[e]},getWebGLExtensions:function(){return this._webGLExtensions},_checkShader:function(e,t,n){var i=t;"string"==typeof i&&(i=e[t]);var r=e.createShader(i);return e.shaderSource(r,n),e.compileShader(r),!(!e.getShaderParameter(r,e.COMPILE_STATUS)&&!e.isContextLost())},_doubleCheckExtension:function(e,t){var n=["#version 100","#extension GL_%ext% : require","precision mediump float;","varying vec3 vColor;","void main() {","gl_FragColor = vec4(vColor, 1.0);","}"].join("\n");return this._checkShader(e,"FRAGMENT_SHADER",n.replace(/\%ext\%/g,t))},initWebGLExtensions:function(e,t){if(e){var n=t;if(void 0===n&&(n=!0),Object(s.a)().webglExt){var r=e.getSupportedExtensions();if(r){for(var a=this._webGLExtensions,o=0,u=r.length;o<u;++o){var l=r[o];n&&this._bugsDB[l]||(a[l]=e.getExtension(l),this._isGL2||this.applyExtension(e,l))}if(!this._isGL2){var c="EXT_shader_texture_lod";a[c]&&!this._doubleCheckExtension(e,c)&&delete a[c]}var h=this.getWebGLExtension("EXT_texture_filter_anisotropic");h&&(i.ANISOTROPIC_SUPPORT_EXT=!0,i.ANISOTROPIC_SUPPORT_MAX=e.getParameter(h.MAX_TEXTURE_MAX_ANISOTROPY_EXT))}}else this._webGLExtensions={}}}},t.a=u},AwvW:function(e,t,n){"use strict";var i=n("dERi"),r=n("j3Bp"),a=n("f5KD"),o=n("grIK");t.a=r.a.extend({optionTypes:{modelUid:a.b.string},comparator:"order",model:i.a,url:function(){return Object(o.a)("hotspots",this.options.modelUid,this.options.checkPrefetch)}})},B0qL:function(e,t){e.exports='uniform vec3 uDofBlurNearFarFocal;\n\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureDepth;\n\nvec4 dofCoC() {\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT){\n        return vec4(0.0);\n    }\n\n    return vec4(vec3(0.0), texDepthToCoC(TEXTURE_2D_TextureDepth(gTexCoord)) * 0.5 + 0.5);\n}'},B306:function(e,t,n){"use strict";var i=n("QLQS"),r=n("fgaA"),a=i.a.osg,o=["magFilter","minFilter","wrapS","wrapT","textureWidth","textureHeight","textureTarget","internalFormat"],s={getValidOptions:function(){return o},getOptions:function(e){var t={};return t.minFilter=e.getMinFilter(),t.magFilter=e.getMagFilter(),t.wrapT=e.getWrapT(),t.wrapS=e.getWrapS(),t.textureWidth=e.getWidth(),t.textureHeight=e.getHeight(),t.textureTarget=e.getTextureTarget(),t.internalFormat=e._internalFormat,t.imageFormat=e._imageFormat,t},setOptions:function(e,t){t.setMinFilter(e.minFilter),t.setMagFilter(e.magFilter),t.setWrapT(e.wrapT),t.setWrapS(e.wrapS),e.minFilter===a.Texture.LINEAR_MIPMAP_LINEAR&&Object(r.a)().anisotropy&&t.setMaxAnisotropy(16),t.setInternalFormat(e.internalFormat)},createValidOptionsForMaterial:function(e){var t=s.createValidOptions(e),n=t.minFilter,i=t.magFilter;return n===a.Texture.LINEAR_MIPMAP_LINEAR||n===a.Texture.LINEAR?(t.magFilter=a.Texture.LINEAR,t):i===a.Texture.LINEAR?(t.minFilter=a.Texture.LINEAR_MIPMAP_LINEAR,t):n===a.Texture.NEAREST_MIPMAP_LINEAR||n===a.Texture.NEAREST?(t.magFilter=a.Texture.NEAREST,t):(t.magFilter=a.Texture.LINEAR,t.minFilter=a.Texture.LINEAR_MIPMAP_LINEAR,t)},createValidOptions:function(e){e||(e={});for(var t=o.length,n=0;n<t;++n){var i=o[n];"string"==typeof e[i]&&(e[i]=a.Texture[e[i]])}return e.magFilter||(e.magFilter=a.Texture.LINEAR),e.minFilter||(e.minFilter=a.Texture.LINEAR_MIPMAP_LINEAR),e.wrapS||(e.wrapS=a.Texture.REPEAT),e.wrapT||(e.wrapT=a.Texture.REPEAT),e.textureWidth||(e.textureWidth=0),e.textureHeight||(e.textureHeight=0),e.textureTarget||(e.textureTarget=a.Texture.TEXTURE_2D),e.internalFormat||(e.internalFormat=-1),e}};t.a=s},"BB+9":function(e,t,n){"use strict";var i=n("MVZn"),r=n.n(i),a=n("dAuA"),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(a.b)(e.split("?")[1]||"").cursor},s=function(){var e={};return{get:function(t){return e[t]},update:function(t){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(n){e[n.uid]=t})}}};t.a=function(e,t){var n=function(){return{previousCursor:e.previous||null,currentCursor:e.current,nextCursor:e.next||null}},i=s(),a=n(),u=function(e,t){return function(n){return i.update(e,n.results),a.currentCursor=e,t.setNext&&(a.nextCursor=n.next?o(n.next):null),t.setPrevious&&(a.previousCursor=n.previous?o(n.previous):null),n}};return{type:"cursor",loadPrevious:function(e){return t(a.previousCursor,e).then(u(a.previousCursor,r()({},e,{setPrevious:!0})))},loadNext:function(e){return t(a.nextCursor,e).then(u(a.nextCursor,r()({},e,{setNext:!0})))},loadFirst:function(e){return a=n(),i=s(),t(a.currentCursor,e).then(u(a.current,r()({},e,{setNext:!0,setPrevious:!0})))},reset:function(){a=n()},hasPrevious:function(){return null!==a.previousCursor},hasNext:function(){return null!==a.nextCursor},isFirst:function(){return a.currentCursor===e.current},getQueryParamsForElementUid:function(e){return{cursor:i.get(e)}},getQueryParams:function(){return{cursor:a.currentCursor}},setInitialQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o(e);i.update(n,t.results)}}}},Bkbh:function(e,t){e.exports='#pragma include "utils/lightCommon.glsl"\n\n////////////////\n// COOK TORRANCE\n////////////////\nvec3 specularCookTorrance(\n        const in vec3 normal,\n        const in vec3 lightDir,\n        const in vec3 eyeVector,\n        const in float materialShininess,\n        const in vec3 materialSpecular,\n        const in vec3 lightSpecular) {\n  \n    vec3 h = normalize(eyeVector + lightDir);\n    float nh = dot(normal, h);\n    float specfac = 0.0;\n\n    if(nh > 0.0) {\n        float nv = max( dot(normal, eyeVector), 0.0 );\n        float i = pow(nh, materialShininess);\n        i = i / (0.1 + nv);\n        specfac = i;\n    }\n    // ugly way to fake an energy conservation (mainly to avoid super bright stuffs with low glossiness)\n    float att = materialShininess > 100.0 ? 1.0 : smoothstep(0.0, 1.0, materialShininess * 0.01);\n    return specfac * materialSpecular * lightSpecular * att;\n}\n\nvec3 lambert(const in float dotNL,  const in vec3 materialDiffuse, const in vec3 lightDiffuse) {\n    return dotNL * materialDiffuse * lightDiffuse;\n}\n\nvoid computeLightLambertCookTorrance(\n        const in vec3 normal,\n        const in vec3 eyeVector,\n        const in float dotNL,\n        const in float attenuation,\n\n        const in vec3 materialDiffuse,\n        const in vec3 materialSpecular,\n        const in float materialShininess,\n\n        const in vec3 lightDiffuse,\n        const in vec3 lightSpecular,\n        const in vec3 eyeLightDir,\n\n        out vec3 diffuseOut,\n        out vec3 specularOut,\n        out bool lighted) {\n\n    lighted = dotNL > 0.0;\n    if (lighted == false) {\n        specularOut = diffuseOut = vec3(0.0);\n        return;\n    }\n\n    specularOut = attenuation * specularCookTorrance(normal, eyeLightDir, eyeVector, materialShininess, materialSpecular, lightSpecular);\n    diffuseOut = attenuation * lambert(dotNL, materialDiffuse, lightDiffuse);\n}\n\n///////\n// HEMI\n///////\nvoid hemiLight(\n        const in vec3 normal,\n        const in vec3 eyeVector,\n        const in float dotNL,\n        const in vec3 eyeLightDir,\n\n        const in vec3 materialDiffuse,\n        const in vec3 materialSpecular,\n        const in float materialShininess,\n\n        const in vec3 lightDiffuse,\n        const in vec3 lightGround,\n\n        out vec3 diffuseOut,\n        out vec3 specularOut,\n        out bool lighted) {\n\n    lighted = false;\n    float weight = 0.5 * dotNL + 0.5;\n    diffuseOut = materialDiffuse * mix(lightGround, lightDiffuse, weight);\n\n    // same cook-torrance as above for sky/ground\n    float skyWeight = 0.5 * dot(normal, normalize(eyeVector + eyeLightDir)) + 0.5;\n    float gndWeight = 0.5 * dot(normal, normalize(eyeVector - eyeLightDir)) + 0.5;\n    float skySpec = pow(skyWeight, materialShininess);\n    float skyGround = pow(gndWeight, materialShininess);\n    float divisor = (0.1 + max( dot(normal, eyeVector), 0.0 ));\n    float att = materialShininess > 100.0 ? 1.0 : smoothstep(0.0, 1.0, materialShininess * 0.01);\n    \n    specularOut = lightDiffuse * materialSpecular * weight * att * (skySpec + skyGround) / divisor;\n}\n'},Bozv:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-04/schema#","id":"http://sketchfab.com/schema/modeloptions","title":"Camera settings","description":"Camera position and direction","type":"object","definitions":{"vec2":{"type":"array","minItems":2,"maxItems":2,"items":{"type":"number"}},"vec3":{"type":"array","minItems":3,"maxItems":3,"items":{"type":"number"}},"intVec3":{"type":"array","minItems":3,"maxItems":3,"items":{"type":"integer"}},"vec4":{"type":"array","minItems":4,"maxItems":4,"items":{"type":"number"}},"matrix":{"type":"array","minItems":16,"maxItems":16,"items":{"type":"number"}},"quaternion":{"type":"array","minItems":4,"maxItems":4,"items":{"type":"number"}},"unitVec3":{"type":"array","minItems":3,"maximum":3,"items":{"$ref":"#/definitions/unitNumber"}},"unitVec3Neg":{"type":"array","minItems":3,"maximum":3,"items":{"$ref":"#/definitions/unitNumberNeg"}},"unitVec2Neg":{"type":"array","minItems":2,"maximum":2,"items":{"$ref":"#/definitions/unitNumberNeg"}},"unitVec4":{"type":"array","minItems":4,"maximum":4,"items":{"$ref":"#/definitions/unitNumber"}},"unitNumber":{"type":"number","minimum":0,"maximum":1},"unitNumberNeg":{"type":"number","minimum":-1,"maximum":1},"uid":{"type":"string","pattern":"^[A-Fa-f0-9]{32}$"},"uuid":{"type":"string","pattern":"^[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}$"},"hotspotData":{"type":"object","properties":{"geometryUid":{"type":"integer"},"uid":{"$ref":"#/definitions/uid"},"indices":{"$ref":"#/definitions/intVec3"},"barycentricWeights":{"$ref":"#/definitions/vec3"},"localPosition":{"$ref":"#/definitions/vec3"}},"additionalProperties":false,"required":["uid","geometryUid","indices","barycentricWeights","localPosition"]},"soundtrack":{"type":"object","properties":{"uid":{"$ref":"#/definitions/uid"},"name":{"type":"string","default":""},"enable":{"type":"boolean","default":true},"position":{"$ref":"#/definitions/vec3","default":[0,0,0]},"distance":{"type":"number","minimum":0,"default":-1},"distanceMax":{"type":"number","minimum":0,"default":-1},"distanceModel":{"type":"string","default":"exponential"},"startTime":{"type":"number","minimum":0,"default":0},"volume":{"type":"number","minimum":0,"default":1},"ambient":{"type":"boolean","default":true},"loop":{"type":"boolean","default":false},"snap":{"type":"boolean","default":false},"sync":{"type":"boolean","default":false},"geometryUid":{"type":"integer","default":-1},"indices":{"$ref":"#/definitions/intVec3","default":[-1,-1,-1]},"barycentricWeights":{"$ref":"#/definitions/vec3","default":[0,0,0]},"localPosition":{"$ref":"#/definitions/vec3","default":[0,0,0]}},"required":["uid","name","enable","position","distance","distanceMax","distanceModel","startTime","volume","ambient","loop","snap","sync","geometryUid","indices","barycentricWeights","localPosition"],"additionalProperties":false},"light":{"type":"object","properties":{"type":{"type":"string","enum":["NONE","DIRECTION","POINT","SPOT","HEMI"],"default":"NONE"},"enable":{"type":"boolean","default":true},"color":{"$ref":"#/definitions/unitVec3","default":[1,1,1]},"intensity":{"type":"number","minimum":0,"default":1},"ground":{"$ref":"#/definitions/unitVec3","default":[0.3,0.2,0.2]},"intensityGround":{"type":"number","minimum":0,"default":1},"matrix":{"$ref":"#/definitions/matrix"},"falloff":{"type":"number","minimum":0,"default":-1},"attachedToCamera":{"type":"boolean","default":false},"angle":{"type":"number","minimum":0,"maximum":90,"default":45},"hardness":{"$ref":"#/definitions/unitNumber","default":0.5},"castShadows":{"type":"boolean","default":true},"shadowBias":{"$ref":"#/definitions/unitNumber","default":0.005}},"required":["type","enable","color","intensity","ground","intensityGround","matrix","falloff","attachedToCamera","angle","hardness","castShadows","shadowBias"],"additionalProperties":false},"texture":{"type":"object","properties":{"internalFormat":{"type":"string","enum":["RGB","ALPHA","LUMINANCE"]},"magFilter":{"type":"string","enum":["LINEAR","NEAREST"]},"minFilter":{"type":"string","enum":["LINEAR","NEAREST","LINEAR_MIPMAP_LINEAR","NEAREST_MIPMAP_LINEAR"]},"textureTarget":{"type":"string","enum":["TEXTURE_2D"]},"uid":{"$ref":"#/definitions/uid"},"wrapS":{"type":"string","enum":["CLAMP_TO_EDGE","REPEAT","MIRRORED_REPEAT"]},"wrapT":{"type":"string","enum":["CLAMP_TO_EDGE","REPEAT","MIRRORED_REPEAT"]},"texCoordUnit":{"type":"integer","minimum":0}},"required":["internalFormat","magFilter","minFilter","texCoordUnit","textureTarget","uid","wrapS","wrapT"],"additionalProperties":false},"materialChannel":{"type":"object","properties":{"enable":{"type":"boolean"},"factor":{"$ref":"#/definitions/unitNumber"},"color":{"$ref":"#/definitions/unitVec3"},"texture":{"$ref":"#/definitions/texture"}},"oneOf":[{"required":["color"]},{"required":["texture"]}],"required":["enable","factor"],"additionalProperties":false},"materialChannelGrayScale":{"type":"object","properties":{"enable":{"type":"boolean"},"factor":{"$ref":"#/definitions/unitNumber"},"texture":{"$ref":"#/definitions/texture"}},"required":["enable","factor"],"additionalProperties":false},"cullFace":{"type":"string","enum":["DISABLE","BACK"]}},"properties":{"version":{"type":"integer","minimum":0},"background":{"type":"object","properties":{"enable":{"type":"string","enum":["fixed","environment","color","ambient","none"],"default":"color"},"uid":{"$ref":"#/definitions/uid","default":"51af6a870cce449eb75b0345feebaebb"},"color":{"$ref":"#/definitions/unitVec3","default":[0.86667,0.86667,0.86667]}},"additionalProperties":false,"required":["enable","uid","color"]},"lighting":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"lights":{"type":"array","minItems":3,"maxItems":3,"items":{"$ref":"#/definitions/light"},"additionalItems":false}},"additionalProperties":false,"required":["lights","enable"]},"camera":{"type":"object","properties":{"position":{"$ref":"#/definitions/vec3"},"target":{"$ref":"#/definitions/vec3"},"fov":{"type":"number","minimum":0,"maximum":180,"default":45},"nearFarRatio":{"type":"number","minimum":0.0001,"maximum":0.005,"default":0.005},"useCameraConstraints":{"type":"boolean","default":false},"usePanConstraints":{"type":"boolean","default":true},"useZoomConstraints":{"type":"boolean","default":false},"usePitchConstraints":{"type":"boolean","default":false},"useYawConstraints":{"type":"boolean","default":false},"zoomIn":{"type":"number","minimum":0,"default":0},"zoomOut":{"type":"number","minimum":0,"default":-1},"left":{"type":"number","minimum":-3.141593,"maximum":3.141593,"default":-3.141593},"right":{"type":"number","minimum":-3.141593,"maximum":3.141593,"default":3.141593},"up":{"type":"number","minimum":-1.570797,"maximum":1.570797,"default":1.555089},"down":{"type":"number","minimum":-1.570797,"maximum":1.570797,"default":-1.555089}},"additionalProperties":false,"required":["position","target","fov","nearFarRatio","useCameraConstraints","usePanConstraints","useZoomConstraints","usePitchConstraints","useYawConstraints","zoomIn","zoomOut","left","right","up","down"]},"environment":{"type":"object","properties":{"enable":{"type":"boolean"},"backgroundExposure":{"type":"number","minimum":0,"maximum":2,"default":1},"exposure":{"type":"number","minimum":0,"maximum":35},"rotation":{"type":"number","minimum":0,"maximum":6.2831853072,"default":0},"uid":{"$ref":"#/definitions/uid"},"blur":{"type":"number","minimum":0,"maximum":1,"default":0.1},"shadowEnable":{"type":"boolean"},"lightIntensity":{"type":"number","minimum":0,"default":1},"shadowBias":{"type":"number","minimum":0,"default":0.005}},"additionalProperties":false,"required":["enable","backgroundExposure","exposure","rotation","uid","blur","shadowEnable","lightIntensity","shadowBias"]},"materials":{"type":"object","patternProperties":{"^[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}$":{"type":"object","properties":{"channels":{"type":"object","properties":{"Opacity":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"type":{"type":"string","enum":["alphaBlend","alphaMask","additive","dithering","refraction"],"default":"alphaBlend"},"invert":{"type":"boolean","default":false},"texture":{"$ref":"#/definitions/texture"},"ior":{"type":"number","minimum":1,"maximum":2,"default":1.05},"roughnessFactor":{"$ref":"#/definitions/unitNumber","default":0},"useMicrosurfaceTexture":{"type":"boolean","default":true},"useNormalOffset":{"type":"boolean","default":false},"useAlbedoTint":{"type":"boolean"},"thinLayer":{"type":"boolean","default":false},"refractionColor":{"$ref":"#/definitions/unitVec3","default":[1,1,1]}},"required":["enable","factor","type","invert","ior","roughnessFactor","useMicrosurfaceTexture","useAlbedoTint","useNormalOffset","refractionColor","thinLayer"],"additionalProperties":false},"SpecularHardness":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"factor":{"type":"number","minimum":0,"maximum":10000,"default":12.5},"texture":{"$ref":"#/definitions/texture"}},"required":["enable","factor"],"additionalProperties":false},"BumpMap":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":10,"default":1},"texture":{"$ref":"#/definitions/texture"}},"required":["enable","factor"],"additionalProperties":false},"Displacement":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"default":0},"texture":{"$ref":"#/definitions/texture"}},"required":["enable","factor"],"additionalProperties":false},"SubsurfaceTranslucency":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"thicknessFactor":{"type":"number","minimum":0,"default":-1},"color":{"$ref":"#/definitions/unitVec3","default":[1,0.37,0.3]},"texture":{"$ref":"#/definitions/texture"}},"required":["enable","factor","thicknessFactor","color"],"additionalProperties":false},"EmitColor":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":10,"default":0},"color":{"$ref":"#/definitions/unitVec3","default":[1,1,1]},"texture":{"$ref":"#/definitions/texture"},"type":{"type":"string","enum":["additive","multiplicative"],"default":"additive"}},"oneOf":[{"required":["color"]},{"required":["texture"]}],"required":["enable","factor","type"],"additionalProperties":false},"SubsurfaceScattering":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"default":-1},"texture":{"$ref":"#/definitions/texture"},"profile":{"type":"integer","minimum":1,"maximum":3,"default":1}},"required":["enable","factor","profile"],"additionalProperties":false},"NormalMap":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"texture":{"$ref":"#/definitions/texture"},"flipY":{"type":"boolean","default":true}},"required":["enable","factor","flipY"],"additionalProperties":false},"AOPBR":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"texture":{"$ref":"#/definitions/texture"},"occludeSpecular":{"type":"boolean","default":false}},"required":["enable","factor","occludeSpecular"],"additionalProperties":false},"Matcap":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"factor":{"$ref":"#/definitions/unitNumber","default":1},"curvature":{"type":"number","minimum":0,"default":0},"color":{"$ref":"#/definitions/unitVec3","default":[1,1,1]},"texture":{"$ref":"#/definitions/texture"}},"required":["texture","color","curvature","enable","factor"],"additionalProperties":false},"ClearCoat":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"tint":{"$ref":"#/definitions/unitVec3","default":[0.914,0.914,0.914]},"thickness":{"type":"number","minimum":0,"maximum":20,"default":5},"reflectivity":{"$ref":"#/definitions/unitNumber","default":0},"texture":{"$ref":"#/definitions/texture"}},"required":["enable","factor","tint","thickness","reflectivity"],"additionalProperties":false},"ClearCoatNormalMap":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"factor":{"$ref":"#/definitions/unitNumber","default":1},"texture":{"$ref":"#/definitions/texture"},"flipY":{"type":"boolean","default":true}},"required":["enable","factor","flipY"],"additionalProperties":false},"ClearCoatRoughness":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":0.04,"enable":true}},"DiffuseColor":{"$ref":"#/definitions/materialChannel","default":{"color":[1,1,1],"factor":1,"enable":true}},"DiffuseIntensity":{"$ref":"#/definitions/materialChannel","default":{"color":[1,1,1],"factor":1,"enable":true}},"SpecularColor":{"$ref":"#/definitions/materialChannel","default":{"color":[0.5,0.5,0.5],"factor":0,"enable":true}},"DiffusePBR":{"$ref":"#/definitions/materialChannel","default":{"color":[1,1,1],"factor":1,"enable":false}},"AlbedoPBR":{"$ref":"#/definitions/materialChannel","default":{"color":[1,1,1],"factor":1,"enable":true}},"SpecularPBR":{"$ref":"#/definitions/materialChannel","default":{"color":[1,1,1],"factor":0.05,"enable":false}},"GlossinessPBR":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":0.4,"enable":false}},"RoughnessPBR":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":0.6,"enable":true}},"MetalnessPBR":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":0,"enable":true}},"SpecularF0":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":0.5,"enable":true}},"CavityPBR":{"$ref":"#/definitions/materialChannelGrayScale","default":{"factor":1,"enable":false}},"Anisotropy":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1},"direction":{"$ref":"#/definitions/unitNumberNeg","default":0},"texture":{"$ref":"#/definitions/texture"},"flipXY":{"type":"boolean","default":true}},"additionalProperties":false,"required":["enable","factor","direction","flipXY"]}},"required":["DiffuseColor","DiffuseIntensity","EmitColor","NormalMap","BumpMap","Displacement","Opacity","SpecularColor","SpecularHardness","DiffusePBR","AlbedoPBR","SpecularPBR","GlossinessPBR","RoughnessPBR","MetalnessPBR","SpecularF0","AOPBR","CavityPBR","Matcap","SubsurfaceScattering","SubsurfaceTranslucency","ClearCoat","ClearCoatRoughness","ClearCoatNormalMap","Anisotropy"],"additionalProperties":false},"cullFace":{"$ref":"#/definitions/cullFace","default":"DISABLE"},"id":{"$ref":"#/definitions/uuid","default":"0"},"name":{"type":"string","default":"noname"},"reflection":{"$ref":"#/definitions/unitNumber","defaults":0.3},"shadeless":{"type":"boolean","default":false},"stateSetID":{"type":"integer","default":0},"version":{"type":"integer","minimum":2}},"required":["channels","cullFace","id","name","reflection","shadeless","stateSetID","version"],"additionalProperties":false}},"properties":{"updatedAt":{"type":"integer"}},"additionalProperties":false},"orientation":{"type":"object","properties":{"matrix":{"$ref":"#/definitions/matrix","default":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},"additionalProperties":false,"required":["matrix"]},"scene":{"type":"object","properties":{"sssProfiles":{"type":"array","minItems":3,"maxItems":3,"additionalItems":false,"items":[{"type":"object","properties":{"strength":{"$ref":"#/definitions/unitVec3","default":[0.48,0.41,0.28]},"falloff":{"$ref":"#/definitions/unitVec3","default":[1,0.37,0.3]}},"additionalProperties":false,"required":["strength","falloff"]},{"type":"object","properties":{"strength":{"$ref":"#/definitions/unitVec3","default":[0.38,0.61,0.68]},"falloff":{"$ref":"#/definitions/unitVec3","default":[0.5,0.67,0.6]}},"additionalProperties":false,"required":["strength","falloff"]},{"type":"object","properties":{"strength":{"$ref":"#/definitions/unitVec3","default":[0.88,0.61,0.28]},"falloff":{"$ref":"#/definitions/unitVec3","default":[0.7,0.77,0.3]}},"additionalProperties":false,"required":["strength","falloff"]}]},"postProcess":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"grain":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"animated":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":0.5,"default":0.15}},"additionalProperties":false,"required":["enable","animated","factor"]},"sharpen":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":5,"default":0.2}},"additionalProperties":false,"required":["enable","factor"]},"chromaticAberration":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":0.1,"default":0.05}},"additionalProperties":false,"required":["enable","factor"]},"vignette":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"amount":{"$ref":"#/definitions/unitNumber","default":0.475},"hardness":{"$ref":"#/definitions/unitNumber","default":0.725}},"additionalProperties":false,"required":["enable","amount","hardness"]},"bloom":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"type":"number","minimum":0,"maximum":2,"default":0.5},"threshold":{"$ref":"#/definitions/unitNumber","default":0},"radius":{"$ref":"#/definitions/unitNumber","default":0.7}},"additionalProperties":false,"required":["enable","factor","threshold","radius"]},"toneMapping":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"method":{"type":"string","enum":["default","reinhard","filmic"],"default":"default"},"exposure":{"type":"number","minimum":0,"maximum":2,"default":1},"brightness":{"type":"number","minimum":-1,"maximum":1,"default":0},"contrast":{"type":"number","minimum":-1,"maximum":1,"default":0},"saturation":{"type":"number","minimum":0,"maximum":2,"default":1}},"additionalProperties":false,"required":["enable","method","exposure","brightness","contrast","saturation"]},"colorBalance":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"low":{"$ref":"#/definitions/unitVec3Neg"},"mid":{"$ref":"#/definitions/unitVec3Neg"},"high":{"$ref":"#/definitions/unitVec3Neg"}},"additionalProperties":false,"required":["enable","low","mid","high"]},"dof":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"blurNear":{"$ref":"#/definitions/unitNumber","default":0.5},"blurFar":{"$ref":"#/definitions/unitNumber","default":0.5},"focusPoint":{"$ref":"#/definitions/vec3"}},"additionalProperties":false,"required":["enable","blurNear","blurFar","focusPoint"]},"ssr":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"factor":{"$ref":"#/definitions/unitNumber","default":1}},"additionalProperties":false,"required":["enable","factor"]},"ssao":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"radius":{"type":"number","minimum":0,"default":-1},"intensity":{"type":"number","minimum":0,"maximum":1,"default":0.5},"bias":{"type":"number","minimum":0,"default":-1}},"additionalProperties":false,"required":["enable","radius","intensity","bias"]},"taa":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"transparent":{"type":"boolean","default":true}},"additionalProperties":false,"required":["enable","transparent"]}},"additionalProperties":false,"required":["enable","grain","sharpen","chromaticAberration","vignette","bloom","toneMapping","colorBalance","dof","ssr","ssao","taa"]}},"additionalProperties":false,"required":["sssProfiles","postProcess"]},"shading":{"type":"object","properties":{"renderer":{"type":"string","enum":["classic","pbr"],"default":"classic"},"type":{"type":"string","enum":["lit","shadeless","matcap"],"default":"lit"},"vertexColor":{"type":"object","properties":{"enable":{"type":"boolean","default":true},"useAlpha":{"type":"boolean","default":true},"colorSpace":{"type":"string","enum":["linear","srgb"],"defaul":"srgb"}},"additionalProperties":false,"required":["enable","useAlpha","colorSpace"]},"pointSize":{"type":"number","minimum":0,"maximum":10,"default":0}},"additionalProperties":false,"required":["renderer","type","vertexColor","pointSize"]},"wireframe":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"color":{"type":"string","pattern":"^[A-Fa-f0-9]{8}$","default":"000000FF"}},"additionalProperties":false,"required":["enable","color"]},"animation":{"type":"object","properties":{"order":{"type":"array","items":{"type":"string"}},"speed":{"type":"number","minimum":0,"default":1},"cycleMode":{"type":"string","enum":["one","all","none"],"default":"one"},"initializeWithRestPose":{"type":"boolean","default":false}},"additionalProperties":false,"required":["order","speed","cycleMode","initializeWithRestPose"]},"hotspot":{"type":"object","properties":{"hotspots":{"type":"array","items":{"$ref":"#/definitions/hotspotData"}},"visible":{"type":"boolean"}},"additionalProperties":false,"required":["hotspots","visible"]},"vr":{"type":"object","properties":{"worldFactor":{"type":"number","minimum":0,"default":-1},"floorHeight":{"type":"number","default":0},"displayFloor":{"type":"boolean","default":true},"initialCamera":{"type":"object","properties":{"position":{"$ref":"#/definitions/vec3","default":[0,0,0]},"rotation":{"$ref":"#/definitions/vec4","default":[0,0,0,1]}},"additionalProperties":false,"required":["position","rotation"]}},"additionalProperties":false,"required":["worldFactor","initialCamera","floorHeight","displayFloor"]},"sound":{"type":"object","properties":{"soundtracks":{"type":"array","minItems":0,"maxItems":32,"items":{"$ref":"#/definitions/soundtrack"},"additionalItems":false}},"additionalProperties":false,"required":["soundtracks"]},"ground":{"type":"object","properties":{"enable":{"type":"boolean","default":false},"opacity":{"type":"number","default":1},"fade":{"type":"number","default":0.25},"position":{"$ref":"#/definitions/vec3"},"scale":{"type":"number","default":-1,"minimum":0},"shadowMode":{"type":"string","enum":["ShadowCatcher","BakedAO"],"default":"ShadowCatcher"},"samplingRange":{"type":"number","default":0.6},"aoTextureUid":{"$ref":"#/definitions/uid"}},"additionalProperties":false,"required":["enable","opacity","fade","position","scale","shadowMode","samplingRange"]}}}')},"Bp/7":function(e,t,n){"use strict";var i=n("YfG3"),r=n("CXDX"),a=n("j3Bp"),o=n("f5KD"),s=n("1Of8"),u=n("n3DM"),l=n("grIK");t.a=a.a.extend(Object(i.a)({optionTypes:{modelUid:o.b.string},model:r.a,url:function(){return Object(l.a)("textures",this.options.modelUid,this.options.checkPrefetch)},comparator:function(e,t){return"None"===e.get("label")?-1:"None"===t.get("label")?1:Object(s.a)(e.get("label"),t.get("label"))},isValid:function(){this.each(function(e){e.isValid()})},getImageFromURL:function(e){var t=e.split("/").pop();return this.find(function(e){var n=!1;return e.get("images").forEach(function(e){n||-1!==e.url.indexOf(t)&&(n=!0)}),n})}},u.a))},BuKJ:function(e,t){e.exports="uniform vec3 uColorDebug;\n\nvoid main(void) {\n   gl_FragColor = vec4(uColorDebug, 1.0);\n}\n"},BzYw:function(e,t){e.exports='uniform float uRGBMRange;\nuniform int uOutputLinear;\n\n// stuffs (ssr, opacity, scattering)\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\n//////////\n// VARYING\n//////////\n\n#ifdef HAS_OPACITY_REFRACTION\n    varying vec3 vViewNormal;\n    varying vec4 vViewVertex;\n#endif\n\n#pragma include "utils/common.glsl"\n#pragma include "utils/functions.glsl"\n#pragma include "utils/material.glsl"\n#pragma include "utils/decodeDepth.glsl"\n#pragma include "utils/rand.glsl"\n\n#ifdef HAS_OPACITY_REFRACTION\n    #pragma include "utils/refraction.glsl"\n#endif\n\nvoid main() {\n    //////////////////\n    // OPACITY DISCARD\n    //////////////////\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    float alpha = getMaterialOpacity();\n    float alphaFinal = alpha * float(1 - uOpacityAdditive);\n    if (alpha == 0.0 || (uDrawOpaque == 1 && alphaFinal < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaFinal >= EPSILON_ALPHA)) discard;\n#endif\n\n    // /!\\ because of refraction roughness, this part should be done before the call to getMetalness/getSpecular\n#ifdef HAS_OPACITY_REFRACTION\n    gRefractionRoughness = uOpacityRoughnessFactor;\n    float alphaRefraction = getMaterialOpacity();\n    if ((uDrawOpaque == 1 && alphaRefraction < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaRefraction >= EPSILON_ALPHA)) discard;\n#endif\n\n    ///////////\n    // GEOMETRY\n    ///////////\n#ifdef HAS_OPACITY_REFRACTION\n    vec3 eyeVector = -normalize(vViewVertex.xyz);\n    vec3 frontNormal = normalize(gl_FrontFacing ? vViewNormal : -vViewNormal);\n#endif\n\n    ///////////\n    // MATERIAL\n    ///////////\n#if defined(HAS_LEGACY_CLASSIC)\n    vec3 materialDiffuse = getMaterialLegacyDiffuse();\n#elif defined(HAS_ALBEDOPBR)\n    vec3 materialDiffuse = getMaterialAlbedo();\n#else\n    vec3 materialDiffuse = getMaterialDiffuse();\n#endif\n\n#ifdef HAS_AOPBR\n    float materialAO = getMaterialAO();\n#endif\n\n#ifdef HAS_EMITCOLOR\n    vec3 materialEmit = getMaterialEmitColor();\n#endif\n\n#ifdef HAS_CAVITYPBR\n    float materialCavity = getMaterialCavity();\n#endif\n\n    vec3 diffuse = materialDiffuse;\n\n#ifdef HAS_AOPBR\n    diffuse *= materialAO;\n#endif\n\n    /////////////\n    // REFRACTION\n    /////////////\n#ifdef HAS_OPACITY_REFRACTION\n    #ifdef HAS_REFRACTION_NORMAL_OFFSET\n        vec3 refractLight = refraction(uOpacityRoughnessFactor, frontNormal, frontNormal);\n    #else\n        vec3 refractLight = refraction(uOpacityRoughnessFactor, frontNormal, eyeVector);\n    #endif\n\n    #ifdef HAS_REFRACTION_ALBEDO_TINT\n        refractLight *= materialDiffuse;\n    #endif\n\n    diffuse = mix(refractLight, diffuse, alphaRefraction);\n#endif // HAS_OPACITY_REFRACTION\n\n    vec3 frag = diffuse;\n\n#ifdef HAS_EMITCOLOR\n    frag = uEmitMultiplicative == 1 ? frag * materialEmit : frag + materialEmit;\n#endif\n\n#ifdef HAS_CAVITYPBR\n    frag *= materialCavity;\n#endif\n\n    // premult\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    frag *= alpha;\n#endif\n\n    if (uOutputLinear != 1) frag = linearTosRGB(frag);\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    gl_FragColor = uDrawOpaque == 1 ? encodeRGBM(frag, uRGBMRange) : vec4(frag, alphaFinal);\n#else\n    gl_FragColor = encodeRGBM(frag, uRGBMRange);\n#endif\n}\n'},CAIV:function(e,t,n){"use strict";var i=3.14159265359,r={};t.a=function(e,t,n,a,o,s){a=a||.25,o=o||720;var u=Math.cos(.01745329251*a),l=0,c=r.table;if(void 0===c)for(c=r.table=new Float32Array(1801779),r.nphi=o,r.epsilon=a,l=0;l<1801779;++l)c[l]=1/0;var h=i/(o-1),d=1.57079632679/(o-1),f=s?3:2,p=o!==r.nphi||a!==r.epsilon,g=e.length/f;for(l=0;l<g;++l){var m=l*n,v=l*f,_=e[v],b=e[v+1];4!==n||s||(t[m+3]=1024&_?-1:1,_&=-1025);var S,y,x,C=3*(_+o*b),w=C>=1801779;if(p||w||c[C]===1/0){var T=_*h,M=Math.cos(T),E=Math.sin(T);T+=d;var A=(u-M*Math.cos(T))/Math.max(1e-5,E*Math.sin(T));A>1?A=1:A<-1&&(A=-1);var O=6.28318530718*b/Math.ceil(i/Math.max(1e-5,Math.acos(A)));S=E*Math.cos(O),y=E*Math.sin(O),x=M,w||p||(c[C]=S,c[C+1]=y,c[C+2]=x)}else S=c[C],y=c[C+1],x=c[C+2];if(s){var R=47938362584151635e-21*e[v+2],P=Math.sin(R);t[m]=P*S,t[m+1]=P*y,t[m+2]=P*x,t[m+3]=Math.cos(R)}else t[m]=S,t[m+1]=y,t[m+2]=x}return t}},CPsH:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Vx0a"),a=n("r7P/"),o=function(){r.a.call(this),this._values=[]};i.a.createPrototypeNode(o,i.a.objectInherit(r.a.prototype,{addChild:function(e,t){return r.a.prototype.addChild.call(this,e),void 0===t&&(t=!0),this.children.length>this._values.length?this._values.push(t):this._values[this.children.length-1]=t,!0},setValue:function(e,t){e<this._values.length&&(this._values[e]=t)},getValue:function(e){if(e<this._values.length)return this._values[e]},setAllChildrenOff:function(){for(var e=0;e<this._values.length;++e)this._values[e]=!1},setAllChildrenOn:function(){for(var e=0;e<this._values.length;++e)this._values[e]=!0},traverse:function(e){switch(e.traversalMode){case a.a.TRAVERSE_ALL_CHILDREN:for(var t=0;t<this.children.length;++t)this.children[t].accept(e);break;case a.a.TRAVERSE_ACTIVE_CHILDREN:var n=this.children.length;for(this._values.length<n&&(n=this._values.length),t=0;t<n;++t)!0===this._values[t]&&this.children[t].accept(e)}}}),"osg","Switch"),t.a=o},CR0n:function(e,t){e.exports='#define HAS_VIEW_NORMAL\n#define HAS_VIEW_VERTEX\n#pragma include "base.vert"\n'},CXDX:function(e,t,n){"use strict";(function(e){var i=n("cDf5"),r=n.n(i),a=n("EVdn"),o=n.n(a),s=n("tNdj"),u=n("vIRb");t.a=s.a.extend({defaults:{colorSpace:"unknown"},endpoint:function(){return"/textures".concat(this.isNew()?"":"/".concat(this.get("uid")))},isValid:function(){var e=this.get("name");return void 0===e&&console.warn("no name for Texture "+this.id),e=e||this.id,void 0===this.get("images")&&console.warn("no images for Texture "+e),void 0===this.get("uid")&&console.warn("no uid for Texture "+e),!0},save:function(t,n){null!=t&&"object"!==r()(t)||(n=t);var i=new FormData;return i.append("imageFile",this.get("imageFile"),this.get("name")),i.append("colorSpace",this.get("colorSpace")),i.append("modelUid",n.modelUID),e.resolve(o.a.ajax({url:this.url(),data:i,processData:!1,contentType:!1,type:"POST"}))},saveColorspace:function(){return e.resolve(o.a.ajax({url:this.url(),data:{colorSpace:this.get("colorSpace")},type:"PATCH"}))}}).extend(u.a)}).call(this,n("CSL1"))},D1Qd:function(e,t,n){"use strict";var i=n("icjm"),r=n("a3nb"),a=n("qRO0"),o=n("RwmW"),s=n("zP/P"),u=n("czSk"),l=n("fgaA"),c=function(e){n("a5Z4").default.logMessage(e)},h=function(e,t,n){o.a.call(this),this._instanceID=a.a.getInstanceID(),this.dirty(),this._itemSize=n,this._target="string"==typeof e?h[e]:e,this._type=void 0,this._normalize=!1,t&&(void 0===t.byteLength&&(i.a.warn("BufferArray with non typedArray elements is deprecated"),t=this._target===h.ELEMENT_ARRAY_BUFFER?new r.a.Uint16Array(t):new r.a.Float32Array(t)),this.setElements(t)),this._usage=h.STATIC_DRAW},d=function(e,t){return e+Math.random()*(t-e)},f=u.f.fromValues(d(.1,10),d(4.2,7.5),d(.7,1.5));h.randa=f,h.ELEMENT_ARRAY_BUFFER=34963,h.ARRAY_BUFFER=34962,h.STATIC_DRAW=35044,h.DYNAMIC_DRAW=35048,h.STREAM_DRAW=35040,h._sDeletedGLBufferArrayCache=new window.Map,h.deleteGLBufferArray=function(e,t){h._sDeletedGLBufferArrayCache.has(e)||h._sDeletedGLBufferArrayCache.set(e,[]),h._sDeletedGLBufferArrayCache.get(e).push(t)},h.flushDeletedGLBufferArrays=function(e,t){if(t<=0)return t;if(!h._sDeletedGLBufferArrayCache.has(e))return t;for(var n=0,i=s.a.instance().tick(),r=h._sDeletedGLBufferArrayCache.get(e),a=r.length-1;a>=0&&n<t;a--)e.deleteBuffer(r[a]),r.splice(a,1),n=s.a.instance().deltaS(i,s.a.instance().tick());return t-n},h.flushAllDeletedGLBufferArrays=function(e){if(h._sDeletedGLBufferArrayCache.has(e))for(var t=h._sDeletedGLBufferArrayCache.get(e),n=t.length-1;n>=0;n--)e.deleteBuffer(t[n]),t.splice(n,1)},h.onLostContext=function(e){h._sDeletedGLBufferArrayCache.has(e)&&(h._sDeletedGLBufferArrayCache.get(e).length=0)},r.a.createPrototypeObject(h,r.a.objectInherit(o.a.prototype,{setUsage:function(e){this._usage=e},getUsage:function(){return this._usage},getInstanceID:function(){return this._instanceID},setItemSize:function(e){this._itemSize=e},isValid:function(){return!!this._buffer||!(!this._elements||!this._elements.length)},invalidate:function(){this._buffer=void 0,this.dirty()},releaseGLObjects:function(){void 0!==this._buffer&&null!==this._buffer&&void 0!==this._gl&&(h.deleteGLBufferArray(this._gl,this._buffer),o.a.removeObject(this._gl,this)),this.invalidate()},setNormalize:function(e){this._normalize=e},getNormalize:function(){return this._normalize},bind:function(e){this._gl||this.setGraphicContext(e);var t=this._target,n=this._buffer;n?e.bindBuffer(t,n):!n&&this._elements.length>0&&(this._buffer=e.createBuffer(),this._numItems=this._elements.length/this._itemSize,e.bindBuffer(t,this._buffer))},getItemSize:function(){return this._itemSize},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty},setElements:function(e){this._elements=e,this._type=function(e){var t;return e instanceof r.a.Float32Array&&(t=5126),e instanceof r.a.Int16Array&&(t=5122),e instanceof r.a.Uint16Array&&(t=5123),e instanceof r.a.Int8Array&&(t=5120),e instanceof r.a.Uint8Array&&(t=5121),e instanceof r.a.Uint8ClampedArray&&(t=5121),e instanceof r.a.Int32Array&&(t=5124),e instanceof r.a.Uint32Array&&(t=5125),t}(e),this._dirty=!0},getType:function(){return this._type},compile:function(e){if(this._dirty)return this._QTAN||this._QNOR?this._encodeDirection(e):this._QVS?this._encodeVertex(e):this._QUV?this._encodeUV(e):void this.compileGl(e)},compileGl:function(e){this._dirty&&(e.bufferData(this._target,this._elements,this._usage),this._dirty=!1)},getGlItemSize:function(){return this._glItemSize||this._itemSize},getGlType:function(){return this._glType||this._type},getGlNormalize:function(){return this._glNormalize||this._normalize},getElements:function(){return this._elements},computeMinMaxVertex:function(e,t,n){return this._minMaxVertex(e,t,n)},computeMinMaxUV:function(e,t,n){return this._minMaxUV(e,t,n)},_minMaxVertex:function(e,t,n){for(var i=1/0,r=1/0,a=1/0,o=-1/0,s=-1/0,u=-1/0,l=this.getElements(),c=void 0===n?l.length:n,h=t||0;h<c;h+=3){var d=l[h],f=l[h+1],p=l[h+2];d<i&&(i=d),f<r&&(r=f),p<a&&(a=p),d>o&&(o=d),f>s&&(s=f),p>u&&(u=p)}return o<=i&&(o=.001),s<=r&&(s=.001),u<=a&&(u=.001),e.xmin=i,e.xmax=o,e.ymin=r,e.ymax=s,e.zmin=a,e.zmax=u,e},_minMaxUV:function(e,t,n){for(var i=1/0,r=1/0,a=-1/0,o=-1/0,s=this.getElements(),u=void 0===n?s.length:n,l=t||0;l<u;l+=2){var c=s[l],h=s[l+1];c<i&&(i=c),h<r&&(r=h),c>a&&(a=c),h>o&&(o=h)}return a<=i&&(a=.001),o<=r&&(o=.001),e.xmin=i,e.ymin=r,e.xmax=a,e.ymax=o,e},_compileHook:function(e,t,n,i){var r=this.getElements(),a=this.getItemSize(),o=this.getNormalize();this.setNormalize(n),this.setItemSize(t),this.setElements(e),this._glType=this.getType(),this._glItemSize=t,this._glNormalize=n,this.compileGl(i),this.setElements(r),this.setItemSize(a),this.setNormalize(o),this._dirty=!1},_encodeDirection:function(e){for(var t=this.getElements(),n=t.length,i=this.getItemSize(),r=i-1,a=0,o=new Int16Array(r*n/i),s=Object(l.a)().zoct,u=0;u<n;u+=i){var c=t[u],h=t[u+1],d=t[u+2],f=1/Math.sqrt(c*c+h*h+d*d);if(c*=f,h*=f,d*=f,s){var p=1/(Math.abs(c)+Math.abs(h)+Math.abs(d)),g=c*p,m=h*p,v=d*p,_=v>=0?g:(1-Math.abs(m))*(Math.sign(g)||1),b=v>=0?m:(1-Math.abs(g))*(Math.sign(m)||1);o[a]=32767*_,o[a+1]=32767*b}else if(d<=-.99999)o[a]=32767*Math.sqrt(.5),o[a+1]=32767*Math.sqrt(.5);else{var S=1/Math.sqrt(2*d+2);o[a]=32767*c*S,o[a+1]=32767*h*S}3===r&&(o[a+2]=32767*t[u+3]),a+=r}this._compileHook(o,r,!0,e)},_encodeVertex:function(e){var t=this._QVS,n=this._QVT,i=this.getElements(),r=this._FQU||this._minMax&&this._minMax._FQU;r&&c("vFQU - "+this.getInstanceID());for(var a=Object(l.a)().zq&&!r,o=a?65535:1,s=a?Uint16Array:Float32Array,u=1/(f[0]*t[0]),h=1/(f[1]*t[1]),d=1/(f[2]*t[2]),p=n[0],g=n[1],m=n[2],v=Object(l.a)().zw,_=this.getItemSize(),b=v?4:3,S=i.length,y=new s(b*S/_),x=0,C=0;C<S;C+=_){var w=u*(i[C]-p),T=h*(i[C+1]-g),M=d*(i[C+2]-m);if(y[x]=o*w,y[x+1]=o*T,y[x+2]=o*M,v){var E=Math.min(y[x],y[x+1],y[x+2]);y[x]-=E,y[x+1]-=E,y[x+2]-=E,y[x+3]=E}x+=b}this._compileHook(y,b,a,e)},_encodeUV:function(e){var t=this._QUV,n=t[0],i=t[1],r=1/t[2],a=1/t[3],o=this.getElements(),s=o.length,l=0;if(Math.max(t[2],t[3])/65535>1/2048)return c("NoQUV - "+this.getInstanceID()),this.compileGl(e),void u.g.set(t,0,0,1,1);var h=65535*r,d=65535*a,f=new Uint16Array(s);for(l=0;l<s;l+=2)f[l]=h*(o[l]-n),f[l+1]=d*(o[l+1]-i);this._compileHook(f,2,!0,e)}}),"osg","BufferArray"),t.a=h},DNxV:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Qavt"),a=n("czSk"),o=function(e,t,n,i){r.a.call(this),this._x=void 0!==e?e:0,this._y=void 0!==t?t:0,this._width=void 0!==n?n:800,this._height=void 0!==i?i:600};i.a.createPrototypeStateAttribute(o,i.a.objectInherit(r.a.prototype,{attributeType:"Viewport",cloneType:function(){return new o},setViewport:function(e,t,n,i){this._x=e,this._y=t,this._width=n,this._height=i},x:function(){return this._x},y:function(){return this._y},width:function(){return this._width},height:function(){return this._height},computeWindowMatrix:function(){var e=a.c.create(),t=a.c.create(),n=a.f.create();return function(i){a.c.fromTranslation(e,a.f.ONE),a.c.fromScaling(t,[.5*this._width,.5*this._height,.5]);var r=a.c.fromTranslation(i,a.f.set(n,this._x,this._y,0));return a.c.mul(r,r,a.c.mul(t,t,e))}}(),apply:function(e){e.applyViewport(this)}}),"osg","Viewport"),t.a=o},DRy3:function(e,t){e.exports='#pragma include "base.vert"\n'},DTOf:function(e,t,n){"use strict";var i=n("YfG3"),r=n("nzRv"),a=n("gCTM"),o=n("f5KD");n("oY7F");t.a=r.a.extend({displayName:"Button",optionTypes:{text:o.b.string.isRequired,subtext:o.b.string,onClick:o.b.func,size:o.b.oneOf(["small","medium","input","large","huge"]),type:o.b.oneOf(["ninja","important","danger","primary","secondary","tertiary","primary-inverted","store","plan-pro","plan-prem","plan-biz","plan-ent"]),className:o.b.string,style:o.b.object,attrs:o.b.object,disabled:o.b.bool,loading:o.b.bool,iconClassName:o.b.string,iconAttrs:o.b.object},defaultOptions:{onClick:function(){},size:"medium",type:"primary",className:"",style:{},attrs:{},iconClassName:"",iconAttrs:{},disabled:!1,loading:!1},events:{click:function(e){this.isDisabled()||this.options.onClick(e)}},isDisabled:function(){return this.options.disabled||this.options.loading},template:function(){var e=Object(i.a)({},this.options.attrs,{classNames:Object(i.a)({"btn-loading":this.options.loading},this.options.attrs.classNames,["button","btn-"+this.options.type,"btn-"+this.options.size,this.options.className].reduce(function(e,t){return e[t]=!0,e},{})),style:Object(i.a)({},this.options.attrs.style,this.options.style),disabled:this.isDisabled()});return a.default.getFromMacro("skfb_front/macros/components/atoms/button","button",[{text:this.options.text,subtext:this.options.subtext,loading:this.options.loading,hasIcon:!!this.options.iconClassName||!!Object.keys(this.options.iconAttrs).length,iconAttrs:Object(i.a)({},this.options.iconAttrs,{className:"icon "+(this.options.iconAttrs.className||this.options.iconClassName)}),attrs:e}])}})},DTPh:function(e,t,n){"use strict";(function(e){var i=n("J4zp"),r=n.n(i),a=n("RIqP"),o=n.n(a),s=n("+lWh");function u(t){var n=o()(t.find(".image-container"));return new e(function(e){window.requestAnimationFrame(function(){n.forEach(function(e){return e.classList.remove("--loading")}),e()})})}t.a={name:"WithImageContainers",afterRender:function(){(function(t){var n=o()(t.find(".image-container .image-container__image")).map(function(e){return[e.getAttribute("data-background"),e]}).filter(function(e){return!!r()(e,1)[0]});return e.all(n.map(function(e){var t=r()(e,2),n=t[0],i=t[1];return Object(s.k)(n).then(function(){i.style.backgroundImage="url(".concat(n,")")})})).then(function(){return t})})(this.$el).then(u)}}}).call(this,n("CSL1"))},DVv7:function(e,t){e.exports='uniform float uRGBMRange;\nuniform int uOutputLinear;\n\n// stuffs (ssr, opacity, scattering)\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\nuniform vec3 uMatcapColor;\n\nuniform int uInspectorView; // see globalUniforms\n\n//////////\n// VARYING\n//////////\nvarying vec4 vViewVertex;\nvarying vec3 vViewNormal;\n\n#ifdef HAS_VIEW_TANGENT\nvarying vec4 vViewTangent;\n#endif\n\n#pragma include "utils/common.glsl"\n\n#pragma include "utils/functions.glsl"\n\n#pragma include "utils/material.glsl"\n\n#pragma include "utils/curvature.glsl"\n\n// TODO ifdef around pragma include can result in error (files being included multiple times can be ignored)\n#pragma include "utils/decodeDepth.glsl"\n\n#pragma include "utils/rand.glsl"\n\n#ifdef HAS_VIEW_TANGENT\n#pragma include "utils/normalBump.glsl"\n#endif\n\n#ifdef HAS_OPACITY_REFRACTION\n#pragma include "utils/refraction.glsl"\n#endif\n\nvoid main() {\n    //////////////////\n    // OPACITY DISCARD\n    //////////////////\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    float alpha = getMaterialOpacity();\n    float alphaFinal = alpha * float(1 - uOpacityAdditive);\n    if (alpha == 0.0 || (uDrawOpaque == 1 && alphaFinal < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaFinal >= EPSILON_ALPHA)) discard;\n#endif\n\n// /!\\ because of refraction roughness, this part should be done before the call to getMetalness/getSpecular\n#ifdef HAS_OPACITY_REFRACTION\n    gRefractionRoughness = uOpacityRoughnessFactor;\n    float alphaRefraction = getMaterialOpacity();\n    if ((uDrawOpaque == 1 && alphaRefraction < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaRefraction >= EPSILON_ALPHA)) discard;\n#endif\n\n    ///////////\n    // GEOMETRY\n    ///////////\n    vec3 eyeVector = -normalize(vViewVertex.xyz);\n    vec3 frontNormal = normalize(gl_FrontFacing ? vViewNormal : -vViewNormal);\n\n#ifdef HAS_VIEW_TANGENT\n    vec4 tangent = gl_FrontFacing ? vViewTangent : -vViewTangent;\n    tangent.xyz = normalize(tangent.xyz);\n    vec3 binormal = normalize(cross(frontNormal, tangent.xyz)) * tangent.w;\n#endif\n\n    ///////////\n    // MATERIAL\n    ///////////\n    vec3 materialNormal = frontNormal;\n#ifdef HAS_NORMALMAP\n    materialNormal = getMaterialNormalMap();\n    materialNormal = transformNormal(uNormalMapFactor, materialNormal, tangent.xyz, binormal, frontNormal);\n#endif\n\n#ifdef HAS_BUMPMAP\n    materialNormal = transformBump(getMaterialBumpMap(), tangent.xyz, binormal, frontNormal);\n#endif\n\n    vec3 materialDiffuse = uMatcapColor;\n#ifdef HAS_VERTEX_COLOR\n    materialDiffuse *= getVertexColor();\n#endif\n\n    vec3 nm_x = vec3(-eyeVector.z, 0.0, eyeVector.x);\n    vec3 nm_y = cross(nm_x, eyeVector);\n    vec2 uvMatcap = vec2(dot(materialNormal.xz, -nm_x.xz), dot(materialNormal, nm_y)) * 0.5 + 0.5;\n    vec3 diffuse = materialDiffuse * sRGBToLinear(texture2D(SAMPLER_MATCAP, uvMatcap).rgb) * getCurvature(materialNormal);\n\n    /////////////\n    // REFRACTION\n    /////////////\n#ifdef HAS_OPACITY_REFRACTION\n\n#ifdef HAS_REFRACTION_NORMAL_OFFSET\n    vec3 refractLight = refraction(uOpacityRoughnessFactor, materialNormal, frontNormal);\n#else\n    vec3 refractLight = refraction(uOpacityRoughnessFactor, materialNormal, eyeVector);\n#endif\n\n#ifdef HAS_REFRACTION_ALBEDO_TINT\n    refractLight *= materialDiffuse;\n#endif\n\n    diffuse = mix(refractLight, diffuse, alphaRefraction);\n#endif // HAS_OPACITY_REFRACTION\n\n    vec3 frag = diffuse;\n\n    if (uInspectorView == 2) {\n        frag = vec3(0.9, 0.75, 0.5) * max(0.25, dot(materialNormal.xyz, vec3(0.15, 0.3, 0.9)));\n    }\n\n// premult\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    frag *= alpha;\n#endif\n\n    if (uOutputLinear != 1) frag = linearTosRGB(frag);\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    gl_FragColor = uDrawOpaque == 1 ? encodeRGBM(frag, uRGBMRange) : vec4(frag, alphaFinal);\n#else\n    gl_FragColor = encodeRGBM(frag, uRGBMRange);\n#endif\n}\n'},DWkk:function(e,t,n){"use strict";var i=n("QLQS").a.osg,r=function(){i.TextureCubeMap.call(this),this._imageProxy=void 0};i.createPrototypeStateAttribute(r,i.objectInherit(i.TextureCubeMap.prototype,{getHash:function(){return"osgSketchfabTexture"}}),"osgSketchfab","TextureCubeMap"),(r.dummyTexture=new r).setTextureSize(1,1),t.a=r},DWw0:function(e,t,n){"use strict";n.d(t,"r",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"u",function(){return l}),n.d(t,"q",function(){return c}),n.d(t,"a",function(){return h}),n.d(t,"b",function(){return d}),n.d(t,"f",function(){return v}),n.d(t,"k",function(){return _}),n.d(t,"j",function(){return b}),n.d(t,"i",function(){return y}),n.d(t,"g",function(){return x}),n.d(t,"e",function(){return C}),n.d(t,"s",function(){return w}),n.d(t,"t",function(){return T}),n.d(t,"h",function(){return M}),n.d(t,"v",function(){return E}),n.d(t,"x",function(){return A}),n.d(t,"y",function(){return O}),n.d(t,"l",function(){return R}),n.d(t,"o",function(){return P}),n.d(t,"w",function(){return I}),n.d(t,"n",function(){return N}),n.d(t,"p",function(){return L}),n.d(t,"m",function(){return k});var i=n("12sq"),r=n("XsDm"),a=n("P1HB"),o=function(e){var t=e.isDeleted,n=e.downloadType,i=void 0===n?"store":n,r=e.isOwned,a=e.hasPendingOrder;return!t&&"store"===i&&!r&&!a},s=function(e,t){return!e.isAnonymous&&(e.isStaff||e.uid===t.user.uid)},u=function(e,t){return"no"!==t.downloadType||t.management&&"ok"===t.management.downloadStatus&&s(e,t)},l=function(e){return["private","protected"].includes(e)},c=function(e){return e.filter(o).reduce(function(e,t){return e+t.price},0)},h=function(e,t){return t-t*(e/100)},d=function(e,t){return t+t*(e/100)},f=function(e,t){return i.a.maxHotspotsPerModel[t]>=e.hotspot.hotspots.length},p=function(e,t){return i.a.maxSoundtracksPerModel[t]>=e.sound.soundtracks.length},g=function(e,t){return!!i.a.proPlanTypes.includes(t)||!e.camera.useCameraConstraints},m=function(e,t){return!!i.a.proPlanTypes.includes(t)||!l(e.visibility)},v=function(e){return{background:function(e){return function(t,n){return!!i.a.proPlanTypes.includes(n)||"none"===t.background.enable||e.instance.getBackgroundCollection().find(function(e){return e.get("uid")===t.background.uid}).get("isDefault")}}(e),environment:function(e){return function(t,n){return!!i.a.proPlanTypes.includes(n)||e.instance.getEnvironmentCollection().find(function(e){return e.get("uid")===t.environment.uid}).get("isDefault")}}(e),matcap:function(e){return function(t,n){if(i.a.proPlanTypes.includes(n))return!0;var r=t.materials,a=Object.keys(r).map(function(e){return r[e].channels.Matcap.texture.uid}),o=e.instance.getMatcapCollection();return!a.some(function(e){return!1===o.find(function(t){return t.get("uid")===e}).get("isDefault")})}}(e),camera:g,hotspot:f,sound:p,private:m}},_=function(e,t,n){var i=[];return Object.keys(n).forEach(function(r){n[r](e,t)||i.push(r)}),i},b=function(e){return null!=e.price&&null!=e.license?e.price&&e.price>0&&e.license?"store":e.license?"free":"no":e.downloadType||"no"},S=function(e){return e.isPublished&&function(e){return"no"===b(e)||l(e.visibility)}(e)?1:0},y=function(e,t){return S(e)-S(t)},x=function(e,t){return!e.org&&!t.org&&y(e,t)<0},C=function(e,t,n){return!x(e,t)||Object(a.f)(n)},w=function(e){return"string"==typeof e.htmlDescription},T=function(e){return void 0!==e.visibility},M=function(e){return e.replace(/\.[\w+]*$/,"").replace(/[._]/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z][a-z])/g," $1").replace(/(^| )[a-z]/g,function(e){return e.toUpperCase()}).replace(/ {2,}/g," ").replace(/([[(]) +/g,"$1").replace(/ +([\])])/g,"$1").trim()},E=function(e){return!["SUCCEEDED","FAILED"].includes(e.status.processing.toUpperCase())},A=function(e){return"SUCCEEDED"!==e.status.processing||e.versions&&e.versions.every(E)},O=function(e){return e.versions&&e.versions.some(function(e){return["PENDING","PROCESSING"].includes(e.status.processing)})},R=function(e){return e.reduce(function(e,t){return e.caseOf({None:function(){return Object(r.b)(t)},Some:function(e){return Object(r.b)(new Date(t.createdAt).getTime()>new Date(e.createdAt).getTime()?t:e)}})},r.a)},P=function(e){return function(e){return e.org?"ent":void 0}(e)||e.user.account},I=function(e,t){return Object(a.j)(P(t),e)},N=function(e,t){return e.slug?["orgs:model",{username:e.org.username,slug:e.slug,uid:e.uid},t]:["orgs:model_without_slug",{username:e.org.username,uid:e.uid},t]},L=function(e,t){return e.slug?["models:view",{slug:e.slug,model_id:e.uid},t]:["models:view_without_slug",{model_id:e.uid},t]},k=function(e,t){return e.org?e.slug?["orgs:model_properties",{username:e.org.username,slug:e.slug,uid:e.uid},t]:["orgs:model_properties_without_slug",{username:e.org.username,uid:e.uid},t]:e.slug?["models:properties",{slug:e.slug,model_id:e.uid},t]:["models:properties_without_slug",{model_id:e.uid},t]}},DkmK:function(e,t,n){"use strict";var i=n("9oTK"),r=n.n(i),a=n("a3nb"),o=n("r7P/"),s=n("Wx9w"),u=n("zP/P"),l=function(){o.a.call(this,o.a.TRAVERSE_ALL_CHILDREN),this._activePagedLODList=void 0,this._frameNumber=0};a.a.createPrototypeObject(l,a.a.objectInherit(o.a.prototype,{apply:function(e){e.getTypeID()===s.a.getTypeID()&&(e.setFrameNumberOfLastTraversal(this._frameNumber),this._activePagedLODList.add(e)),this.traverse(e)},set:function(e,t){this._activePagedLODList=e,this._frameNumber=t}}),"osgDB","FindPagedLODsVisitor");var c=function(){o.a.call(this,o.a.TRAVERSE_ALL_CHILDREN)};a.a.createPrototypeObject(c,a.a.objectInherit(o.a.prototype,{apply:function(e){e.releaseGLObjects(),this.traverse(e)}}),"osgDB","ReleaseVisitor");var h=function(){o.a.call(this,o.a.TRAVERSE_ALL_CHILDREN),this._childrenList=[]};a.a.createPrototypeObject(h,a.a.objectInherit(o.a.prototype,{apply:function(e){e.getTypeID()===s.a.getTypeID()&&(this._childrenList.push(e),this._markRequestsExpired(e)),this.traverse(e)},removeExpiredChildrenAndFindPagedLODs:function(e,t,n,i){if(!e.children.length)return!1;var r=i.length;e.removeExpiredChildren(t,n,i);for(var a=r;a<i.length;a++)i[a].accept(this);return r!==i.length},_markRequestsExpired:function(e){for(var t,n=e._perRangeDataList.length,i=0;i<n;i++)void 0!==(t=e.getDatabaseRequest(i))&&(t._groupExpired=!0,t._loadedModel=null)},reset:function(){this._childrenList.length=0}}),"osgDB","ExpiredPagedLODVisitor");var d=function(e,t){return t._timeStamp-e._timeStamp},f=function(e,t){var n=e._timeStamp-t._timeStamp;return 0===n&&(n=e._priority-t._priority),n},p=function(){this._pendingRequests=[],this._pendingNodes=[],this._loading=!1,this._progressCallback=void 0,this._lastCB=!0,this._activePagedLODList=new Set,this._childrenToRemoveList=new Set,this._downloadingRequestsNumber=0,this._maxRequestsPerFrame=10,this._acceptNewRequests=!0,this._releaseVisitor=new c,this._expiredPagedLODVisitor=new h,this._findPagedLODsVisitor=new l,this._targetMaximumNumberOfPagedLOD=75,this._elapsedTime=0,this._beginTime=0,this._availableTime=0};a.a.createPrototypeObject(p,{setTargetMaximumNumberOfPageLOD:function(e){this._targetMaximumNumberOfPagedLOD=e},getTargetMaximumNumberOfPageLOD:function(){return this._targetMaximumNumberOfPagedLOD},setAcceptNewDatabaseRequests:function(e){this._acceptNewRequests=e},getAcceptNewDatabaseRequests:function(){return this._acceptNewRequests},reset:function(){this._pendingRequests=[],this._pendingNodes=[],this._loading=!1,this._lastCB=!0,this._activePagedLODList.clear(),this._childrenToRemoveList.clear(),this._downloadingRequestsNumber=0,this._maxRequestsPerFrame=10,this._acceptNewRequests=!0,this._targetMaximumNumberOfPagedLOD=75},updateSceneGraph:function(e){void 0!==this._progressCallback&&this.executeProgressCallback(),this.removeExpiredSubgraphs(e,.0025),this.takeRequests(),this.addLoadedDataToSceneGraph(e,.005)},executeProgressCallback:function(){this._pendingRequests.length>0||this._pendingNodes.length>0?(this._progressCallback(this._pendingRequests.length+this._downloadingRequestsNumber,this._pendingNodes.length),this._lastCB=!1):this._lastCB||(this._progressCallback(this._pendingRequests.length+this._downloadingRequestsNumber,this._pendingNodes.length),this._lastCB=!0)},setMaxRequestsPerFrame:function(e){this._maxRequestsPerFrame=e},getMaxRequestsPerFrame:function(){return this._maxRequestsPerFrame},getRequestListSize:function(){return this._pendingRequests.length+this._downloadingRequestsNumber},setProgressCallback:function(e){this._progressCallback=e},addLoadedDataToSceneGraph:function(e,t){if(!this._pendingNodes.length||t<=0)return 0;var n=0,i=u.a.instance().tick();this._pendingNodes.sort(d);for(var r=0;r<this._pendingNodes.length;r++){if(n>t)return 0;var a=this._pendingNodes.shift(),o=e.getFrameNumber(),s=e.getSimulationTime();if(!1===a._groupExpired){var l=a._group;l.setTimeStamp(l.children.length,s),l.setFrameNumber(l.children.length,o),l.addChildNode(a._loadedModel),this._activePagedLODList.has(l)?this.registerPagedLODs(a._loadedModel,o):this.registerPagedLODs(l,o)}else a._loadedModel=void 0,a=void 0;n=u.a.instance().deltaS(i,u.a.instance().tick())}return t-=n},isLoading:function(){return this._loading},registerPagedLODs:function(e,t){e&&(this._findPagedLODsVisitor.set(this._activePagedLODList,t),e.accept(this._findPagedLODsVisitor))},requestNodeFile:function(e,t,n,i,r){if(this._acceptNewRequests){var a=new function(){this._loadedModel=void 0,this._group=void 0,this._url=void 0,this._function=void 0,this._timeStamp=0,this._groupExpired=!1,this._priority=0};return a._group=n,a._function=e,a._url=t,a._timeStamp=i,a._priority=r,this._pendingRequests.push(a),a}},takeRequests:function(){if(this._pendingRequests.length){var e=Math.min(this._maxRequestsPerFrame,this._pendingRequests.length);this._pendingRequests.sort(f);for(var t=0;t<e;t++)this._downloadingRequestsNumber++,this.processRequest(this._pendingRequests.shift())}},processRequest:function(e){this._loading=!0;var t=this;if(e._groupExpired)return t._downloadingRequestsNumber--,void(this._loading=!1);void 0!==e._function?this.loadNodeFromFunction(e._function,e._group).then(function(n){t._downloadingRequestsNumber--,e._loadedModel=n,t._pendingNodes.push(e),t._loading=!1}):""!==e._url&&this.loadNodeFromURL(e._url).then(function(n){t._downloadingRequestsNumber--,e._loadedModel=n,t._pendingNodes.push(e),t._loading=!1})},loadNodeFromFunction:function(e,t){var n=e(t);return n?n&&n.then?n:r.a.resolve(n):r.a.reject()},loadNodeFromURL:function(e){return n("RTFJ").default.readNodeURL(e)},releaseGLExpiredSubgraphs:function(e){return this._availableTime=e,!this._childrenToRemoveList.size||e<=0?0:(this._elapsedTime=0,this._beginTime=u.a.instance().tick(),this._childrenToRemoveList.forEach(this._releaseExpiredSubgraphs,this),this._availableTime-=this._elapsedTime,this._availableTime)},_releaseExpiredSubgraphs:function(e){this._elapsedTime>this._availableTime||(this._childrenToRemoveList.delete(e),e.accept(this._releaseVisitor),e.removeChildren(),e=null,this._elapsedTime=u.a.instance().deltaS(this._beginTime,u.a.instance().tick()))},removeExpiredSubgraphs:function(e,t){if(0===e.getFrameNumber())return 0;var n=this._activePagedLODList.size-this._targetMaximumNumberOfPagedLOD,i=e.getSimulationTime()-.1,r=e.getFrameNumber()-1;return n>0&&(t=this.removeExpiredChildren(n,i,r,t)),t},removeExpiredChildren:function(e,t,n,i){var r=0,a=u.a.instance().tick(),o=this,s=[],l=this._expiredPagedLODVisitor;return l.reset(),this._activePagedLODList.forEach(function(c){if(r>i)return 0;if(e<0)return i;if(n<c.getFrameNumberOfLastTraversal())return i;l.removeExpiredChildrenAndFindPagedLODs(c,t,n,s);for(var h=0;h<l._childrenList.length;h++)o._activePagedLODList.delete(l._childrenList[h]),e--;for(h=0;h<s.length;h++)o._childrenToRemoveList.add(s[h]);l._childrenList.length=0,s.length=0,r=u.a.instance().deltaS(a,u.a.instance().tick())}),i-=r}},"osgDB","DatabasePager"),t.a=p},Dnzz:function(e,t,n){"use strict";(function(e){var i=n("tNdj"),r=n("eEbW");t.a=i.a.extend({defaults:{name:"",uid:"",duration:0,isLoop:!1,isEnabled:!0},endpoint:function(){return"/animations/".concat(this.get("uid"))},registerOptions:function(){this._lastOptions={name:this.get("name"),isLoop:this.get("isLoop"),isEnabled:this.get("isEnabled")}},hasChangedOptions:function(){if(!this._lastOptions)return!0;var e=this._lastOptions;for(var t in e)if(e[t]!==this.get(t))return!0;return!1},save:function(){return this.hasChangedOptions()?(this.registerOptions(),r.b.patchAnimation(this.get("uid"),{name:this.get("name"),isLoop:this.get("isLoop"),isEnabled:this.get("isEnabled")})):e.resolve()}})}).call(this,n("CSL1"))},E5qE:function(e,t){e.exports="uniform vec3 uColorBalanceLow;\nuniform vec3 uColorBalanceMid;\nuniform vec3 uColorBalanceHigh;\n\nfloat RGBToL(const in vec3 color) {\n    float fmin = min(min(color.r, color.g), color.b);\n    float fmax = max(max(color.r, color.g), color.b);\n    return (fmax + fmin) / 2.0;\n}\n\nvec3 colorBalance(const in vec3 color) {\n    vec3 lrgb = uColorBalanceLow;\n    vec3 mrgb = uColorBalanceMid;\n    vec3 hrgb = uColorBalanceHigh;\n\n    float cLen = length(color);\n    if(cLen < 1e-5)\n        return color;\n\n    // TODO : I have no idea what I am doing, we should use a curve widge\n    float lightness = RGBToL(color);\n    // '  lightness=(lightness*0.9-1.0)/(lightness*2.0+1.0) +1.0;\n    lightness = (1.5 * lightness) / (lightness + 0.5);\n    // https://github.com/liovch/GPUImage/blob/master/framework/Source/GPUImageColorBalanceFilter\n    float a = 0.25;\n    float b = 0.333;\n    float scale = 0.7;\n    vec3 low = lrgb * clamp((lightness - b) / -a + 0.5, 0.0, 1.0);\n    vec3 mid = mrgb * clamp((lightness - b) / a + 0.5, 0.0, 1.0) * clamp((lightness + b - 1.0) / -a + 0.5, 0.0, 1.0);\n    vec3 high = hrgb * clamp((lightness + b - 1.0) / a + 0.5, 0.0, 1.0);\n    vec3 newColor = max(color + (low + mid + high) * scale, vec3(0.0));\n    // newColor can be negative\n    float len = length(newColor);\n    return len < 1e-5 ? newColor * cLen : newColor * cLen / len;\n}\n\nvec4 colorBalance(const in vec4 color) {\n    return vec4(colorBalance(color.rgb), 1.0);\n}"},EJ86:function(e,t){e.exports='#pragma include "utils/encodeDecode.glsl"\n\nuniform float uInvTextureSize;\n\nvec4 adaptativeBoxBlur(){\n    float ao = decode24(TEXTURE_2D_TextureBlur(gTexCoord).rgb);\n    float kernel = 3.0;\n\n    if (ao < 0.2 ){\n        float o = 0.2;\n        ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(-o, o) * uInvTextureSize).rgb);\n        ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(o, o) * uInvTextureSize).rgb);\n        ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(o, -o) * uInvTextureSize).rgb);\n        ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(-o, -o) * uInvTextureSize).rgb);\n        ao *= 0.2;\n        return vec4(ao, ao, ao, 1.0);\n    }\n\n    ao = 0.0;\n\n    // webgl 1.0 goodness, only constant bounds for for loops iteration.\n    if (ao < 0.4 ){\n        kernel = 3.0;\n        for (float i = -1.0; i <= 1.0; i++){\n            for (float j = -1.0; j <= 1.0; j++){\n                ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(i, j) * uInvTextureSize).rgb);\n            }\n        }\n    } else if (ao < 0.6 ){\n        kernel = 7.0;\n        for (float i = -3.0; i <= 3.0; i++){\n            for (float j = -3.0; j <= 3.0; j++){\n                ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(i, j) * uInvTextureSize).rgb);\n            }\n        }\n    } else if (ao < 0.8 ){\n        kernel = 9.0;\n        for (float i = -4.0; i <= 4.0; i++){\n            for (float j = -4.0; j <= 4.0; j++){\n                ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(i, j) * uInvTextureSize).rgb);\n            }\n        }\n    } else if(ao < 1.0 ){\n        kernel = 11.0;\n        for (float i = -5.0; i <= 5.0; i++){\n            for (float j = -5.0; j <= 5.0; j++){\n                ao += decode24(TEXTURE_2D_TextureBlur(gTexCoord + vec2(i, j) * uInvTextureSize).rgb);\n            }\n        }\n    }\n\n    ao /= kernel * kernel;\n\n    return vec4(ao, ao, ao, 1.0);\n}\n'},EVpl:function(e,t){e.exports='#define HAS_VIEW_NORMAL\n#pragma include "base.vert"\n'},EhLm:function(e,t,n){"use strict";var i=n("a3nb"),r=n("czSk"),a=n("3Pif"),o=n("F/aS"),s=function(){a.a.call(this),this._start=r.f.create(),this._iStart=r.f.create(),this._end=r.f.create(),this._iEnd=r.f.create(),this._threshold=0,this._iThreshold=0};i.a.createPrototypeObject(s,i.a.objectInherit(a.a.prototype,{set:function(e,t,n){r.f.copy(this._start,e),r.f.copy(this._iStart,e),r.f.copy(this._end,t),r.f.copy(this._iEnd,t),void 0!==n&&(this._threshold=this._iThreshold=n)},setStart:function(e){r.f.copy(this._start,e),r.f.copy(this._iStart,e)},setEnd:function(e){r.f.copy(this._end,e),r.f.copy(this._iEnd,e)},intersectNode:function(e){return this.intersectBoundingSphere(e.getBoundingSphere())},intersectBoundingSphere:function(){var e=r.f.create(),t=r.f.create();return function(n){if(!n.valid())return!1;r.f.sub(e,this._iStart,n.center());var i=r.f.sqrLen(e)-n.radius2();if(i<=0)return!0;r.f.sub(t,this._iEnd,this._iStart);var a=r.f.sqrLen(t),o=2*r.f.dot(e,t),s=o*o-4*a*i;if(s<0)return!1;var u=.5/a,l=(-o-(s=Math.sqrt(s)))*u,c=(-o+s)*u;return!(l<=0&&c<=0)&&!(l>1&&c>1)}}(),intersect:function(){var e=new o.a;return function(t,n){e.setGeometry(n),e.setIntersectionVisitor(t),e.setIntersector(this),e.set(this._iStart,this._iEnd,this._iThreshold);var i=n.getShape();i?i.intersectLineSegment(e,i.getNodes()[0],this._iStart,this._iEnd,this._iThreshold):(n.computeTransformedVertices&&e.setVertices(n.computeTransformedVertices()),e.apply(n),e.reset())}}(),setCurrentTransformation:function(e){if(r.c.invert(e,e),this._threshold>0){var t=this._iStart;r.c.getScale(t,e);var n=t[0],i=t[1],a=t[2];this._iThreshold=this._threshold*(n>i?n>a?n:a:i>a?i:a)}r.f.transformMat4(this._iStart,this._start,e),r.f.transformMat4(this._iEnd,this._end,e)}}),"osgUtil","LineSegmentIntersector"),t.a=s},EjV6:function(e,t){e.exports='#define HAS_VIEW_NORMAL\n#define HAS_VIEW_VERTEX\n#pragma include "base.vert"\n'},EnLC:function(e,t,n){"use strict";var i=function(e){this._createFunction=e,this._pool=[],this._length=0};i.prototype={clean:function(){this._pool.length=0,this._length=0},getLength:function(){return this._length},reset:function(){this._length=0},getOrCreateObject:function(){var e;return this._length===this._pool.length?(e=this._createFunction(),this._pool.push(e)):e=this._pool[this._length],this._length++,e},forEach:function(e){for(var t=0;t<this._length;t++)e(this._pool[t])}},t.a=i},Ep1f:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Vx0a"),a=n("czSk"),o=n("LTZp"),s=function(){r.a.call(this),this.referenceFrame=o.a.RELATIVE_RF};i.a.createPrototypeNode(s,i.a.objectInherit(r.a.prototype,{setReferenceFrame:function(e){this.referenceFrame=e},getReferenceFrame:function(){return this.referenceFrame},computeBoundingSphere:function(){var e=a.c.create();return function(t){return r.a.prototype.computeBoundingSphere.call(this,t),t.valid()?(a.c.identity(e),this.computeLocalToWorldMatrix(e),t.transformMat4(t,e),t):t}}()}),"osg","Transform"),t.a=s},"F/aS":function(e,t,n){"use strict";var i=n("a3nb"),r=n("czSk"),a=n("oDvv"),o=function(){a.a.Intersection.call(this),this._localIntersectionNormal=r.f.clone(r.f.ONE),this._i1=-1,this._i2=-1,this._i3=-1,this._r1=0,this._r2=0,this._r3=0},s=function(){a.a.call(this),this._threshold=0,this._d=r.f.create(),this._length=0,this._invLength=0,this._start=r.f.create(),this._end=r.f.create(),this._dInvX=r.f.create(),this._dInvY=r.f.create(),this._dInvZ=r.f.create(),this._hit=!1};i.a.createPrototypeObject(s,i.a.objectInherit(a.a.prototype,{set:function(e,t,n){this._start=e,this._end=t,r.f.sub(this._d,t,e),this._length=r.f.length(this._d),this._invLength=0!==this._length?1/this._length:0,r.f.scale(this._d,this._d,this._invLength),0!==this._d[0]&&r.f.scale(this._dInvX,this._d,1/this._d[0]),0!==this._d[1]&&r.f.scale(this._dInvY,this._d,1/this._d[1]),0!==this._d[2]&&r.f.scale(this._dInvZ,this._d,1/this._d[2]),void 0!==n&&(this._threshold=n)},enter:function(e,t,n){var i=e._min,a=i[0],o=i[1],s=i[2],u=e._max,l=u[0],c=u[1],h=u[2],d=this._dInvX,f=this._dInvY,p=this._dInvZ;if(t[0]<=n[0]){if(n[0]<a)return!1;if(t[0]>l)return!1;t[0]<a&&r.f.scaleAndAdd(t,t,d,a-t[0]),n[0]>l&&r.f.scaleAndAdd(n,t,d,l-t[0])}else{if(t[0]<a)return!1;if(n[0]>l)return!1;n[0]<a&&r.f.scaleAndAdd(n,t,d,a-t[0]),t[0]>l&&r.f.scaleAndAdd(t,t,d,l-t[0])}if(t[1]<=n[1]){if(n[1]<o)return!1;if(t[1]>c)return!1;t[1]<o&&r.f.scaleAndAdd(t,t,f,o-t[1]),n[1]>c&&r.f.scaleAndAdd(n,t,f,c-t[1])}else{if(t[1]<o)return!1;if(n[1]>c)return!1;n[1]<o&&r.f.scaleAndAdd(n,t,f,o-t[1]),t[1]>c&&r.f.scaleAndAdd(t,t,f,c-t[1])}if(t[2]<=n[2]){if(n[2]<s)return!1;if(t[2]>h)return!1;t[2]<s&&r.f.scaleAndAdd(t,t,p,s-t[2]),n[2]>h&&r.f.scaleAndAdd(n,t,p,h-t[2])}else{if(t[2]<s)return!1;if(n[2]>h)return!1;n[2]<s&&r.f.scaleAndAdd(n,t,p,s-t[2]),t[2]>h&&r.f.scaleAndAdd(t,t,p,h-t[2])}return!0},intersectPoint:function(){var e=r.f.create(),t=r.f.create();return function(n,i){var a=this._start;r.f.sub(e,n,a),r.f.sub(t,this._end,a);var s=r.f.dot(e,t)*this._invLength*this._invLength;if(!((s<0?r.f.sqrLen(e):s>1?r.f.sqrDist(n,this._end):r.f.sqrLen(r.f.scaleAndAdd(e,e,t,-s)))>this._threshold*this._threshold)){var u=this.initIntersection(new o);u._i1=i,u._r1=1,r.f.scaleAndAdd(u._localIntersectionPoint,a,t,s),u._ratio=s}}}(),intersectLine:function(){var e=r.f.create(),t=r.f.create(),n=r.f.create(),i=r.f.create(),a=r.f.create();return function(s,u,l,c){r.f.sub(e,u,s),r.f.sub(t,this._end,this._start),r.f.sub(n,s,this._start);var h,d,f=r.f.dot(e,e),p=r.f.dot(e,t),g=r.f.dot(t,t),m=r.f.dot(e,n),v=r.f.dot(t,n),_=f*g-p*p,b=_,S=_;_<1e-8?(h=0,b=1,d=v,S=g):(d=f*v-p*m,(h=p*v-g*m)<0?(h=0,d=v,S=g):h>b&&(h=b,d=v+p,S=g)),d<0?(d=0,-m<0?h=0:-m>f?h=b:(h=-m,b=f)):d>S&&(d=S,-m+p<0?h=0:-m+p>f?h=b:(h=-m+p,b=f));var y=Math.abs(h)<1e-8?0:h/b,x=Math.abs(d)<1e-8?0:d/S;if(r.f.scaleAndAdd(i,s,e,y),r.f.scaleAndAdd(a,this._start,t,x),!(r.f.sqrDist(i,a)>this._threshold*this._threshold)){var C=this.initIntersection(new o);C._i1=l,C._i2=c,C._r1=1-x,C._r2=x,r.f.copy(C._localIntersectionPoint,a),C._ratio=x}}}(),intersectTriangle:function(){var e=r.f.create(),t=r.f.create(),n=r.f.create(),i=r.f.create(),a=r.f.create(),s=r.f.create();return function(u,l,c,h,d,f){var p=this._d;r.f.sub(t,c,u),r.f.sub(n,l,u),r.f.cross(a,p,t);var g=r.f.dot(a,n);if(!(g>-1e-20&&g<1e-20)){var m=1/g;r.f.sub(i,this._start,u);var v=r.f.dot(a,i)*m;if(!(v<0||v>1)){r.f.cross(s,i,n);var _=r.f.dot(s,p)*m;if(!(_<0||v+_>1)){var b=r.f.dot(s,t)*m;if(!(b<1e-20||b>this._length)){var S=1-v-_,y=v,x=_,C=b*this._invLength,w=u[0]*S+l[0]*y+c[0]*x,T=u[1]*S+l[1]*y+c[1]*x,M=u[2]*S+l[2]*y+c[2]*x;r.f.cross(e,n,t),r.f.normalize(e,e);var E=this.initIntersection(new o);E._i1=h,E._i2=d,E._i3=f,E._r1=S,E._r2=y,E._r3=x,r.f.set(E._localIntersectionPoint,w,T,M),r.f.copy(E._localIntersectionNormal,e),E._ratio=C,E._backface=r.c.determinant(E._matrix)*g<0}}}}}}(),operatorPoint:function(e){this._threshold<=0||a.a.prototype.operatorPoint.call(this,e)},operatorLine:function(e,t){this._threshold<=0||a.a.prototype.operatorLine.call(this,e,t)}}),"osgUtil","LineSegmentIntersectFunctor"),t.a=s},F2PT:function(e,t){e.exports="//////////////////////////////\n// UN-OPTIMIZED VERSION (WITH IF)\n//////////////////////////////\n\n// //http://http.developer.nvidia.com/GPUGems/gpugems_ch04.html\n// mat4 getMat4FromVec4(const int index, inout mat4 myMat) {\n//     // We have to use a global variable because we can't access dynamically\n//     // matrix is transpose so we should do vec * matrix\n//     myMat[0] = uBones[index];\n//     myMat[1] = uBones[index + 1];\n//     myMat[2] = uBones[index + 2];\n//     return myMat;\n// }\n\n// mat4 skinning( const in vec4 weights, const in vec4 bonesIndex ) {\n//     ivec4 idx =  3 * ivec4(bonesIndex);\n//     mat4 tmpMat = mat4(1.0);\n//     mat4 outMat = mat4(0.0);\n\n//     // we handle negative weights\n//     if(all(equal(weights, vec4(0.0)))) return tmpMat;\n\n//     if(weights.x != 0.0) outMat += weights.x * getMat4FromVec4(idx.x, tmpMat);\n//     if(weights.y != 0.0) outMat += weights.y * getMat4FromVec4(idx.y, tmpMat);\n//     if(weights.z != 0.0) outMat += weights.z * getMat4FromVec4(idx.z, tmpMat);\n//     if(weights.w != 0.0) outMat += weights.w * getMat4FromVec4(idx.w, tmpMat);\n//     return outMat;\n// }\n\n//////////////////////////////\n// UN-OPTIMIZED VERSION (NO IF)\n//////////////////////////////\n\nmat4 skinning(const in vec4 weights, const in vec4 bonesIndex) {\n    ivec4 idx =  3 * ivec4(bonesIndex);\n    mat4 tmpMat = mat4(1.0);\n\n    // if sum is 0, return identity\n    vec4 absWeights = -abs(weights);\n    mat4 outMat = step(0.0, absWeights.x + absWeights.y + absWeights.z + absWeights.w) * tmpMat;\n\n    // we handle negative weights\n    // outMat[3][3] += weights.x + weights.y + weights.z + weights.w;\n\n    tmpMat[0] = uBones[idx.x];\n    tmpMat[1] = uBones[idx.x + 1];\n    tmpMat[2] = uBones[idx.x + 2];\n    outMat += weights.x * tmpMat;\n\n    tmpMat[0] = uBones[idx.y];\n    tmpMat[1] = uBones[idx.y + 1];\n    tmpMat[2] = uBones[idx.y + 2];\n    outMat += weights.y * tmpMat;\n\n    tmpMat[0] = uBones[idx.z];\n    tmpMat[1] = uBones[idx.z + 1];\n    tmpMat[2] = uBones[idx.z + 2];\n    outMat += weights.z * tmpMat;\n\n    tmpMat[0] = uBones[idx.w];\n    tmpMat[1] = uBones[idx.w + 1];\n    tmpMat[2] = uBones[idx.w + 2];\n    outMat += weights.w * tmpMat;\n\n    return outMat;\n}\n"},FDfc:function(e,t,n){"use strict";var i,r=n("gRsq");window.requestAnimationFrame&&(i=Object(r.a)()?function(){return 0}:window.requestAnimationFrame.bind(window)),t.a={get:function(){return i}}},FFzg:function(e,t,n){"use strict";var i,r=n("UXvI"),a=n("xqmJ"),o=n("tNdj"),s=n("dZz+"),u=n("bLLl"),l=n("eEbW"),c=o.a.extend({defaults:{activitiesCount:0,modelsCount:0},initialize:function(){var e=s.a.me();e.isAuthenticated()&&e.canAccessFeature("ff_newsfeed_v2")&&(a.a.subscribeToActivities(Object(r.a)(this.refreshUnseenActivitiesCount.bind(this),5e3)),setTimeout(this.refreshUnseenActivitiesCount.bind(this),100))},refreshUnseenActivitiesCount:function(){var e=this;c.getUnseenActivitiesCount().then(function(t){t!==e.get("activitiesCount")&&(u.b.invalidate("/i/feeds"),e.set("activitiesCount",t))})},hasNewActivities:function(){return Boolean(this.get("activitiesCount"))}},{getSingleton:function(){return i||(i=new c),i},seeActivities:function(){return l.b.seeActivities().then(function(){c.getSingleton().set("activitiesCount",0)})},readActivities:function(e){return l.b.readActivities(e)},getUnseenActivitiesCount:function(){return l.b.getUnseenActivitiesCount()}});t.a=c},FOip:function(e,t,n){"use strict";var i=n("EVdn"),r=n.n(i),a=n("YfG3"),o=n("bLLl");t.a=function(){var e=r.a.ajax;r.a.ajax=function(){var t=arguments.length>=2?arguments[1]:arguments[0];if((t=Object(a.a)({allowPrefetching:!0,cacheBusting:!0},t)).method)throw new Error('The "method" option is actually "type" ;)');if(t.allowPrefetch)throw new Error('The "allowPrefetch" option is actually "allowPrefetching" ;)');if(t.immediate&&!t.allowPrefetching)throw new Error('The "immediate" option cannot be used with "allowPrefetching" false (mutually exclusives)');if("GET"===t.type.toUpperCase()){var n=o.b.get(t.url);if(!n&&t.immediate)throw new Error('The "'+t.url+'" URL should be prefetched: immediate loading required');if(n&&t.allowPrefetching){var i={status:200,data:n};t.success&&t.success(i.data,"success",i),t.complete&&t.complete(i,"success");var s=r.a.Deferred().resolve(i.data,"success",i);return s.readyState=4,s.status=200,s.abort=function(){},s}var u=e.apply(this,arguments);return u.then(function(e,n,i){return o.b.register(t.url,e),r.a.Deferred().resolve(e,n,i)}),u}return"PATCH"===t.type.toUpperCase()?(o.b.invalidate(t.url),e.apply(this,arguments)):t.cacheBusting?(o.b.invalidate(t.url),e.apply(this,arguments)):e.apply(this,arguments)}}},FPi9:function(e,t,n){"use strict";var i=n("icjm"),r=n("AwiE"),a=function(e){this._enabled=!1,this.reset(e)};a.FRAME_COUNT=0,a.instance=function(e,t){return a._instance?e&&(a._instance.getContext()!==e||t)&&(a._instance.setContext(e),a._instance.reset(e)):a._instance=new a(e),a._instance},a.prototype={reset:function(e){if(e){var t=r.a.instance(e).getDisjointTimerQuery();if(!t)return this;if(e.getQueryParameter||(e.getQueryParameter=t.getQueryObjectEXT.bind(t)),this._hasTimeElapsed=e.getQuery(t.TIME_ELAPSED_EXT,t.QUERY_COUNTER_BITS_EXT)>=30,this._hasTimeStamp=e.getQuery(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)>=30,!this._hasTimeElapsed&&!this._hasTimeStamp)return this;this._hasTimeStamp||i.a.debug("Warning: do not use interleaved GPU query"),this._ext=t,this._gl=e,this._enabled=!0}this._frameAverageCount=10,this._glQueries=[],this._queriesByID={},this._userQueries=[],this._queryCount=0,this._nbOpened=0},getContext:function(){return this._gl},setContext:function(e){this._gl=e},setFrameAverageCount:function(e){this._frameAverageCount=e},clearQueries:function(){for(var e=this._glQueries,t=0,n=e.length;t<n;++t){var i=e[t];this._gl.deleteQuery(i._pollingStartQuery),i._pollingEndQuery&&this._gl.deleteQuery(i)}this._userQueries.length=0,this._glQueries.length=0,this._queriesByID={}},supportTimeStamp:function(){return this._hasTimeStamp},enable:function(){this._enabled=!!this._ext},disable:function(){this._enabled=!1},isEnabled:function(){return this._enabled},setCallback:function(e){this._callback=e},createUserQuery:function(e){var t;return(t=this._hasTimeStamp?this.createGLQuery():{_startIndex:0,_endIndex:0})._id=e,t._frame=a.FRAME_COUNT,t._isOpened=!0,t._siblings=[],t},createGLQuery:function(){var e={_isWaiting:!1,_pollingStartQuery:void 0,_pollingEndQuery:void 0,_averageTimer:0,_resultCount:0};return this._hasTimeStamp&&(e._pollingEndQuery=this._gl.createQuery()),e._pollingStartQuery=this._gl.createQuery(),this._glQueries.push(e),e},getOrCreateLastGLQuery:function(){var e=this._glQueries[this._queryCount-1];return e||(e=this._glQueries[this._queryCount-1]=this.createGLQuery())},beginCurrentQuery:function(){if(0!==this._nbOpened){this._queryCount++;var e=this.getOrCreateLastGLQuery();e._isWaiting||this._gl.beginQuery(this._ext.TIME_ELAPSED_EXT,e._pollingStartQuery)}},endCurrentQuery:function(){0!==this._nbOpened&&(this.getOrCreateLastGLQuery()._isWaiting||this._gl.endQuery(this._ext.TIME_ELAPSED_EXT))},getAvailableQueryByID:function(e){var t=this._queriesByID[e];if(!t)return t=this._queriesByID[e]=this.createUserQuery(e),this._userQueries.push(t),t;if(t._frame===a.FRAME_COUNT){if(t._isOpened)return t;for(var n=t._siblings,i=0,r=n.length;i<r;++i){var o=n[i];if(o._frame!==a.FRAME_COUNT||o._isOpened)return o._frame=a.FRAME_COUNT,o}var s=this.createUserQuery();return n.push(s),s}return t._frame=a.FRAME_COUNT,t},start:function(e){if(this._enabled){var t=this.getAvailableQueryByID(e);t._isOpened=!0,this._hasTimeStamp?t._isWaiting||this._ext.queryCounterEXT(t._pollingStartQuery,this._ext.TIMESTAMP_EXT):(this.endCurrentQuery(),this._nbOpened++,t._startIndex=this._queryCount,this.beginCurrentQuery())}},end:function(e){if(this._enabled){var t=this.getAvailableQueryByID(e);t._isOpened=!1,this._hasTimeStamp?t._isWaiting||this._ext.queryCounterEXT(t._pollingEndQuery,this._ext.TIMESTAMP_EXT):(this.endCurrentQuery(),t._endIndex=this._queryCount,this._nbOpened--,this.beginCurrentQuery())}},computeQueryAverageTime:function(e){for(var t=0,n=this._glQueries,i=e._startIndex;i<e._endIndex;++i){var r=n[i]._averageTimer;if(r<0)return-1;t+=r}return t},computeFullAverageTime:function(e){var t=this.computeQueryAverageTime(e);if(t<0)return-1;for(var n=e._siblings,i=0,r=n.length;i<r;++i){var o=n[i];if(o._frame===a.FRAME_COUNT-1){var s=this.computeQueryAverageTime(o);if(s<0)return-1;t+=s}}return t},pollQueries:function(){if(a.FRAME_COUNT++,this._queryCount=0,this._nbOpened=0,this._enabled&&this._callback){var e,t=this._glQueries,n=t.length;if(this._gl.getParameter(this._ext.GPU_DISJOINT_EXT))for(e=0;e<n;++e)t[e]._isWaiting=!1;else{for(e=0;e<n;++e)this.pollQuery(t[e]);var i=this._userQueries,r=i.length;for(e=0;e<r;++e){var o=i[e],s=this.computeFullAverageTime(o);s>0&&this._callback(s,o._id)}}}},pollQuery:function(e){e._isWaiting=!1;var t,n=this._hasTimeStamp?e._pollingEndQuery:e._pollingStartQuery;if(!this._gl.getQueryParameter(n,this._gl.QUERY_RESULT_AVAILABLE))return e._isWaiting=!0,0;if(this._hasTimeStamp){var i=this._gl.getQueryParameter(e._pollingStartQuery,this._gl.QUERY_RESULT);t=this._gl.getQueryParameter(n,this._gl.QUERY_RESULT)-i}else t=this._gl.getQueryParameter(n,this._gl.QUERY_RESULT);return e._resultCount++,e._resultCount>this._frameAverageCount&&(e._averageTimer=0,e._resultCount=1),e._averageTimer=e._averageTimer+(t-e._averageTimer)/e._resultCount,e._averageTimer}},t.a=a},FPmW:function(e,t,n){"use strict";var i=n("MVZn"),r=n.n(i),a=n("EVdn"),o=n.n(a);t.a=function(e){return{name:"PreventPageScroll",constructor:function(){this.events=function(e,t){var n,i={},a=e?" "+e:"";return i["wheel"+a]=function(e){var t=-.25*e.originalEvent.wheelDelta;t&&(e.preventDefault(),o()(e.currentTarget).scrollTop(t+o()(e.currentTarget).scrollTop()))},i["touchstart"+a]=function(e){n=e.originalEvent.touches[0].pageY},i["touchmove"+a]=function(e){e.preventDefault();var t=n-e.originalEvent.touches[0].pageY;n=e.originalEvent.touches[0].pageY,o()(e.currentTarget).scrollTop(t+o()(e.currentTarget).scrollTop())},r()({},t,i)}(e,this.events)}}}},FYHc:function(e,t){e.exports='uniform vec3 uColor;\nuniform int uOutputLinear;\n\nvarying float vHeight;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n  vec4 color = vec4(uColor, 1.0) * smoothstep(1.0, 0.0, vHeight + 1.0);\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'},FcGm:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("gcR/"),r=n.n(i),a=(n("q1tI"),n("wsGC"));function o(e){var t=e.className,n=e.brand,i=void 0===n||n,o=e.color,s=void 0===o?"#555555":o,u=e.logoColor,l=void 0===u?"#ffffff":u,c=e.circleColor,h=void 0===c?a.b.skfbBlue:c,d=i?121:25;return r()("svg",{className:Object(a.a)("svg-logo",t),version:"1.1",xmlnsXlink:"http://www.w3.org/1999/xlink",xmlSpace:"preserve",x:"0",y:"0",viewBox:"0 0 ".concat(d," 25"),enableBackground:"new 0 0 ".concat(d," 25")},void 0,i?r()("g",{className:"logo-text"},void 0,r()("path",{fill:s,d:"M36.471,7.719c-1.526,0-2.289,0.504-2.289,1.512c0,0.448,0.189,0.791,0.567,1.029 c0.378,0.238,1.263,0.582,2.656,1.029c1.393,0.448,2.37,0.956,2.93,1.522c0.56,0.567,0.84,1.438,0.84,2.615 c0,1.498-0.455,2.632-1.365,3.401c-0.911,0.771-2.1,1.155-3.57,1.155c-1.092,0-2.429-0.168-4.011-0.504l-0.756-0.147l0.294-2.247 c1.876,0.253,3.311,0.379,4.305,0.379c1.484,0,2.226-0.616,2.226-1.849c0-0.447-0.171-0.798-0.515-1.05s-1.025-0.525-2.047-0.819 c-1.624-0.462-2.769-1.011-3.434-1.648s-0.998-1.522-0.998-2.657c0-1.428,0.434-2.492,1.302-3.192c0.868-0.7,2.058-1.05,3.57-1.05 c1.036,0,2.352,0.14,3.948,0.42l0.756,0.147L40.65,8.056C38.676,7.832,37.283,7.719,36.471,7.719z"}),r()("path",{fill:s,d:"M46.068,19.731h-2.814v-14.7h2.814v8.358l1.071-0.189l2.079-3.969h3.15l-2.73,4.977l2.877,5.523h-3.171 l-2.121-4.095l-1.155,0.188V19.731z"}),r()("path",{fill:s,d:"M56.705,17.075c0.329,0.287,0.801,0.431,1.417,0.431c1.302,0,2.464-0.042,3.486-0.126l0.589-0.063 l0.041,2.079c-1.61,0.392-3.066,0.588-4.368,0.588c-1.582,0-2.73-0.42-3.444-1.26c-0.714-0.84-1.071-2.205-1.071-4.095 c0-3.766,1.547-5.649,4.641-5.649c3.052,0,4.578,1.582,4.578,4.746l-0.209,1.953H56.19C56.204,16.322,56.375,16.788,56.705,17.075z M59.802,13.536c0-0.84-0.133-1.424-0.399-1.753c-0.266-0.329-0.732-0.493-1.396-0.493c-0.666,0-1.134,0.171-1.407,0.514 c-0.273,0.343-0.417,0.921-0.431,1.732H59.802z"}),r()("path",{fill:s,d:"M70.407,11.625h-2.583v4.305c0,0.42,0.011,0.718,0.031,0.893c0.021,0.175,0.098,0.325,0.231,0.451 c0.133,0.126,0.339,0.189,0.619,0.189l1.596-0.042l0.126,2.246c-0.938,0.211-1.651,0.315-2.142,0.315 c-1.26,0-2.121-0.283-2.583-0.851c-0.462-0.566-0.693-1.613-0.693-3.14v-4.368h-1.238V9.231h1.238V6.312h2.814v2.919h2.583V11.625z"}),r()("path",{fill:s,d:"M76.161,8.979c0.729,0,1.659,0.112,2.794,0.336l0.566,0.126l-0.084,2.226 c-1.106-0.112-1.925-0.168-2.457-0.168c-0.966,0-1.606,0.207-1.921,0.62c-0.315,0.413-0.473,1.193-0.473,2.341 c0,1.148,0.157,1.937,0.473,2.363c0.314,0.427,0.962,0.641,1.942,0.641l2.436-0.168l0.084,2.246 c-1.498,0.295-2.639,0.441-3.423,0.441c-1.554,0-2.671-0.438-3.35-1.312s-1.019-2.278-1.019-4.211c0-1.932,0.35-3.328,1.05-4.189 S74.607,8.979,76.161,8.979z"}),r()("path",{fill:s,d:"M84.414,19.731H81.6v-14.7h2.814v4.704c0.966-0.504,1.834-0.756,2.604-0.756c1.4,0,2.366,0.413,2.898,1.239 c0.531,0.826,0.798,2.1,0.798,3.822v5.691h-2.814v-5.628c0-0.882-0.104-1.536-0.314-1.963s-0.63-0.641-1.26-0.641 c-0.546,0-1.093,0.084-1.639,0.252l-0.272,0.084V19.731z"}),r()("path",{fill:s,d:"M96.531,11.625v8.106h-2.814v-8.106h-1.134V9.231h1.134V8.77c0-1.512,0.224-2.555,0.672-3.129 s1.246-0.861,2.395-0.861c0.504,0,1.155,0.07,1.953,0.21l0.44,0.063l-0.042,2.289c-0.616-0.028-1.134-0.042-1.554-0.042 s-0.7,0.112-0.84,0.336c-0.141,0.224-0.21,0.609-0.21,1.155v0.441h2.541v2.394H96.531z"}),r()("path",{fill:s,d:"M108.753,12.507v4.368c0.028,0.337,0.084,0.571,0.168,0.704s0.259,0.228,0.525,0.283l-0.084,2.121 c-0.714,0-1.285-0.049-1.712-0.146c-0.427-0.099-0.857-0.295-1.291-0.589c-1.008,0.49-2.037,0.735-3.087,0.735 c-2.171,0-3.255-1.147-3.255-3.444c0-1.119,0.301-1.914,0.902-2.383c0.603-0.469,1.526-0.746,2.772-0.83l2.247-0.168v-0.651 c0-0.434-0.099-0.731-0.294-0.893c-0.196-0.161-0.512-0.241-0.945-0.241l-3.948,0.168l-0.084-1.953 c1.498-0.406,2.923-0.609,4.273-0.609c1.352,0,2.324,0.28,2.919,0.84C108.456,10.379,108.753,11.276,108.753,12.507z M104.028,15.279c-0.784,0.07-1.176,0.49-1.176,1.26c0,0.771,0.343,1.155,1.028,1.155c0.532,0,1.113-0.084,1.743-0.252l0.315-0.084 v-2.247L104.028,15.279z"}),r()("path",{fill:s,d:"M116.522,8.979c1.47,0,2.545,0.402,3.224,1.208s1.019,2.244,1.019,4.316c0,2.071-0.392,3.503-1.176,4.294 s-2.136,1.187-4.053,1.187c-0.603,0-1.701-0.07-3.298-0.21l-0.798-0.084V5.031h2.814v4.515 C115.15,9.168,115.906,8.979,116.522,8.979z M115.536,17.464c0.938,0,1.567-0.228,1.89-0.683s0.482-1.271,0.482-2.447 c0-1.89-0.588-2.834-1.764-2.834c-0.56,0-1.092,0.07-1.596,0.21l-0.294,0.063v5.607C114.898,17.436,115.325,17.464,115.536,17.464z"})):null,r()("g",{className:"logo"},void 0,r()("path",{fill:l,d:"M12.5,0.833C6.056,0.833,0.834,6.057,0.834,12.5S6.056,24.167,12.5,24.167S24.167,18.943,24.167,12.5 S18.944,0.833,12.5,0.833z"})),r()("g",{className:"logo-circle"},void 0,r()("path",{fill:h,d:"M12.5-0.029C5.596-0.029,0,5.568,0,12.472c0,6.904,5.596,12.501,12.5,12.501s12.5-5.597,12.5-12.501 C25.001,5.568,19.405-0.029,12.5-0.029z M11.414,19.911L6.025,16.8v-6.276l5.389,2.911V19.911z M12.374,11.958l-6.376-3.38 l6.376-3.682l6.377,3.682L12.374,11.958z M18.755,16.812l-5.369,3.1v-6.452l5.369-2.901V16.812z"})))}},Fhuz:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"b",function(){return T}),n.d(t,"c",function(){return M}),n.d(t,"a",function(){return I});var i,r,a=n("o0o1"),o=n.n(a),s=n("yXPU"),u=n.n(s),l=n("lSNA"),c=n.n(l),h=n("MVZn"),d=n.n(h),f=n("0Uag"),p=n("oTSI"),g=n("XiPH"),m=n("12sq"),v=n("wHZf"),_=n("WRMX"),b=n("NpZ0"),S=n("XsDm"),y=n("QKgc"),x=n("89mf"),C=n("P1HB"),w=n("gPpI");!function(e){e.INIT_CLIENT="authUser.INIT_CLIENT",e.INIT_RECAPTCHA="authUser.INIT_RECAPTCHA",e.SET_ALLOWS_RESTRICTED="authUser.SET_ALLOWS_RESTRICTED",e.GET_FROM_PREFETCHED="authUser.GET_FROM_PREFETCHED",e.GET="authUser.GET",e.AUTHENTICATE="authUser.AUTHENTICATE",e.LOGOUT="authUser.LOGOUT",e.SIGNUP="authUser.SIGNUP",e.LOGIN="authUser.LOGIN",e.LIKE_MODEL="authUser.LIKE_MODEL",e.UNLIKE_MODEL="authUser.UNLIKE_MODEL",e.GET_LIKES="authUser.GET_LIKES",e.GET_PURCHASES="authUser.GET_PURCHASES",e.GET_SUBSCRIPTIONS="authUser.GET_SUBSCRIPTIONS",e.SUBSCRIBE="authUser.SUBSCRIBE",e.UNSUBSCRIBE="authUser.UNSUBSCRIBE",e.GET_FOLLOWINGS="authUser.GET_FOLLOWINGS",e.FOLLOW="authUser.FOLLOW",e.UNFOLLOW="authUser.UNFOLLOW",e.GET_UPVOTES="authUser.GET_UPVOTES",e.UPVOTE_REVIEW="authUser.UPVOTE_REVIEW",e.DOWNVOTE_REVIEW="authUser.DOWNVOTE_REVIEW",e.CAN_REVIEW_MODEL="authUser.CAN_REVIEW_MODEL",e.UPDATE_AVATAR="authUser.UPDATE_AVATAR",e.UPDATE_PUBLISH_CREDITS="authUser.UPDATE_PUBLISH_CREDITS",e.PROVIDE_GDPR_CONSENT="authUser.PROVIDE_GDPR_CONSENT",e.GET_IS_SELLER="authUser.GET_IS_SELLER",e.ADD_MEMBERSHIP="authUser.ADD_MEMBERSHIP"}(r||(r={}));var T=Object(v.optimistic)(Object(b.b)({uid:null,likes:{},purchases:{},followings:{},subscriptions:{},upvotes:{},reviewableModels:{},memberships:{},allowsRestricted:!1,allowsGdpr:!1,isSeller:!1,optimistic:{}},(i={},c()(i,r.INIT_CLIENT,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){return d()({},e,t)}})}),c()(i,r.SET_ALLOWS_RESTRICTED,function(e,t){return t.effect.caseOf({Pending:function(){return d()({},e,{allowsRestricted:t.allowsRestricted})},Rejected:function(){return e},Resolved:function(){return e}})}),c()(i,r.GET_FROM_PREFETCHED,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){var n=t.allowsGdpr,i=t.allowsRestricted,r=t.result;return d()({},e,{uid:r,allowsGdpr:n,allowsRestricted:i})}})}),c()(i,r.GET,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){var n=t.allowsGdpr,i=t.allowsRestricted,r=t.result;return d()({},e,{uid:r,allowsGdpr:n,allowsRestricted:i})}})}),c()(i,r.AUTHENTICATE,function(e){return e}),c()(i,r.LOGOUT,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){var n=t.allowsGdpr,i=t.allowsRestricted;return d()({},e,{uid:"anonymous",allowsGdpr:n,allowsRestricted:i,isSeller:!1})}})}),c()(i,r.SIGNUP,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){var n=t.result;return d()({},e,{uid:n})}})}),c()(i,r.LOGIN,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){var n=t.result,i=t.allowsGdpr,r=t.allowsRestricted;return d()({},e,{uid:n,allowsGdpr:i,allowsRestricted:r})}})}),c()(i,r.GET_LIKES,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){return d()({},e,{likes:d()({},e.likes,t)})}})}),c()(i,r.GET_PURCHASES,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){return d()({},e,{purchases:d()({},e.purchases,t)})}})}),c()(i,r.GET_SUBSCRIPTIONS,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){return d()({},e,{subscriptions:d()({},e.subscriptions,t)})}})}),c()(i,r.GET_FOLLOWINGS,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){return d()({},e,{followings:d()({},e.followings,t)})}})}),c()(i,r.GET_UPVOTES,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){return d()({},e,{upvotes:d()({},e.upvotes,t)})}})}),c()(i,r.LIKE_MODEL,function(e,t){return t.effect.caseOf({Pending:function(){return d()({},e,{likes:d()({},e.likes,c()({},t.modelUid,!0))})},Rejected:function(){return e},Resolved:function(){return e}})}),c()(i,r.UNLIKE_MODEL,function(e,t){return t.effect.caseOf({Pending:function(){return d()({},e,{likes:d()({},e.likes,c()({},t.modelUid,!1))})},Rejected:function(){return e},Resolved:function(){return e}})}),c()(i,r.SUBSCRIBE,function(e,t){return t.effect.caseOf({Pending:function(){return d()({},e,{subscriptions:d()({},e.subscriptions,c()({},t.collectionUid,!0))})},Rejected:function(){return e},Resolved:function(){return e}})}),c()(i,r.UNSUBSCRIBE,function(e,t){return t.effect.caseOf({Pending:function(){return d()({},e,{subscriptions:d()({},e.subscriptions,c()({},t.collectionUid,!1))})},Rejected:function(){return e},Resolved:function(){return e}})}),c()(i,r.FOLLOW,function(e,t){return t.effect.caseOf({Pending:function(){return d()({},e,{followings:d()({},e.followings,c()({},t.userUid,!0))})},Rejected:function(){return e},Resolved:function(){return e}})}),c()(i,r.UNFOLLOW,function(e,t){return t.effect.caseOf({Pending:function(){return d()({},e,{followings:d()({},e.followings,c()({},t.userUid,!1))})},Rejected:function(){return e},Resolved:function(){return e}})}),c()(i,r.UPVOTE_REVIEW,function(e,t){return t.effect.caseOf({Pending:function(){return d()({},e,{upvotes:d()({},e.upvotes,c()({},t.reviewUid,!0))})},Rejected:function(){return e},Resolved:function(){return e}})}),c()(i,r.DOWNVOTE_REVIEW,function(e,t){return t.effect.caseOf({Pending:function(){return d()({},e,{upvotes:d()({},e.upvotes,c()({},t.reviewUid,!1))})},Rejected:function(){return e},Resolved:function(){return e}})}),c()(i,r.CAN_REVIEW_MODEL,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(n){return d()({},e,{reviewableModels:d()({},e.reviewableModels,c()({},t.modelUid,n))})}})}),c()(i,r.UPDATE_PUBLISH_CREDITS,function(e){return e}),c()(i,r.PROVIDE_GDPR_CONSENT,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){var n=t.allowsGdpr;return d()({},e,{allowsGdpr:n})}})}),c()(i,r.GET_IS_SELLER,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){return d()({},e,{isSeller:t})}})}),c()(i,r.ADD_MEMBERSHIP,function(e,t){return d()({},e,{memberships:d()({},e.memberships,c()({},t.orgUid,t.memberUid))})}),i))),M={isInflated:function(e){return null!==e.authUser.uid},uid:function(e){return e.authUser.uid},user:function(e){return Object(g.a)(e.authUser.uid,_.k,e.entities)},isAuthenticated:function(e){return M.isInflated(e)&&!0!==M.user(e).isAnonymous},allowsRestricted:function(e){return e.authUser.allowsRestricted},allowsGdpr:function(e){return e.authUser.allowsGdpr},isSeller:function(e){return e.authUser.isSeller},isStaff:function(e){return M.isAuthenticated(e)&&M.user(e).isStaff},canAccessFeature:Object(f.a)(function(e,t){return M.isInflated(t)&&M.user(t).features.includes(e)}),likes:function(e){return e.authUser.likes},doesLike:function(e,t){return t.authUser.likes[e]||!1},hasPurchased:function(e,t){return t.authUser.purchases[e]||!1},hasSubscribed:function(e,t){return t.authUser.subscriptions[e]||!1},doesFollow:function(e,t){return t.authUser.followings[e]||!1},hasUpvotedReview:function(e,t){return t.authUser.upvotes[e]||!1},canReviewModel:function(e,t){return t.authUser.reviewableModels[e]||!1},hasCredits:function(e){return Object(C.f)(M.user(e))},plan:function(e){var t=M.user(e);return t.isAnonymous?"basic":t.account},hasAtLeastPlan:function(e,t){var n=M.user(t);return!n.isAnonymous&&Object(C.j)(n.account,e)},getOrgRole:Object(f.a)(function(e,t){var n=M.user(t),i=t.authUser.memberships[e.uid];if(n.isAnonymous||!i)return S.a;var r=t.entities.orgMembers[i];return r?Object(S.b)(r.role):S.a})},E=Object(p.a)(function(e){return Object(x.a)(function(t){var n={type:r.GET_LIKES,payload:{effect:function(){var e=u()(o.a.mark(function e(n){var i,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.Api,r=n.getState,!M.isAuthenticated(r())){e.next=7;break}return e.next=4,i.getCurrentUserLikes(t);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0={};case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}};return e(n)})}),A=Object(p.a)(function(e){return Object(x.a)(function(t){var n={type:r.GET_PURCHASES,payload:{effect:function(){var e=u()(o.a.mark(function e(n){var i,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.Api,r=n.getState,!M.isAuthenticated(r())){e.next=7;break}return e.next=4,i.getCurrentUserPurchases(t);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0={};case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}};return e(n)})}),O=Object(p.a)(function(e){return Object(x.a)(function(t){var n={type:r.GET_SUBSCRIPTIONS,payload:{effect:function(){var e=u()(o.a.mark(function e(n){var i,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.Api,r=n.getState,!M.isAuthenticated(r())){e.next=7;break}return e.next=4,i.getCurrentUserSubscriptions(t);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0={};case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}};return e(n)})}),R=Object(p.a)(function(e){return Object(x.a)(function(t){var n={type:r.GET_FOLLOWINGS,payload:{effect:function(){var e=u()(o.a.mark(function e(n){var i,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.Api,r=n.getState,!M.isAuthenticated(r())){e.next=7;break}return e.next=4,i.getCurrentUserFollowings(t);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0={};case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}};return e(n)})}),P=Object(p.a)(function(e){return Object(x.a)(function(t){var n={type:r.GET_UPVOTES,payload:{effect:function(){var e=u()(o.a.mark(function e(n){var i,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.Api,r=n.getState,!M.isAuthenticated(r())){e.next=7;break}return e.next=4,i.getCurrentUserUpvotes(t);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0={};case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}};return e(n)})}),I={initClient:function(){return{type:r.INIT_CLIENT,payload:{effect:Object(v.clientOnly)(function(e){var t=e.CookieBag,n=e.Trackers,i=(0,e.getState)();if(M.isAuthenticated(i))return M.allowsGdpr(i)&&n.gtm.triggerAllowsGdprEvent(),{};var r=!!t.get("sf_gdpr_consent_provided_at");return r&&n.gtm.triggerAllowsGdprEvent(),{allowsGdpr:r,allowsRestricted:"true"===t.get("sb_allows_age_restricted")}},r.INIT_CLIENT)}}},initRecaptcha:function(){return{type:r.INIT_RECAPTCHA,payload:{effect:Object(v.clientOnly)(function(e){e.Recaptcha.initialize().catch(console.warn)},r.INIT_RECAPTCHA)}}},getFromPrefetched:function(){return{type:r.GET_FROM_PREFETCHED,payload:{effect:function(e){var t=e.Prefetching,n=e.CookieBag,i=(0,e.getState)();if(M.isInflated(i))return{result:M.uid(i),entities:{},allowsGdpr:M.allowsGdpr(i),allowsRestricted:M.allowsRestricted(i)};var r={uid:"anonymous",features:[],isAnonymous:!0},a=t.get("/i/users/me")||r;if(a.isAnonymous){var o=d()({},r,a);return d()({},Object(g.b)(o,_.k),{allowsGdpr:!!n.get("sf_gdpr_consent_provided_at"),allowsRestricted:"true"===n.get("sb_allows_age_restricted")})}var s=t.get("/i/users/".concat(a.uid))||a;return d()({},Object(g.b)(s,_.k),{allowsGdpr:s.allowsGdpr,allowsRestricted:s.allowsRestricted})}}}},get:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).allowPrefetching,t=void 0===e||e;return{type:r.GET,payload:{effect:function(){var e=u()(o.a.mark(function e(n){var i,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.Api,e.next=3,i.getCurrentUser({allowPrefetching:t});case 3:return r=e.sent,e.abrupt("return",d()({},Object(g.b)(r,_.k),{allowsGdpr:r.allowsGdpr,allowsRestricted:r.allowsRestricted}));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}}},getIsSeller:function(){return{type:r.GET_IS_SELLER,payload:{effect:function(){var e=u()(o.a.mark(function e(t){var n,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.Api,i=t.getState,M.isAuthenticated(i())){e.next=5;break}e.t0=!1,e.next=8;break;case 5:return e.next=7,n.isCurrentUserSeller();case 7:e.t0=e.sent;case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}}},authenticate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.redirectUrl,i=t.initialForm,a=void 0===i?"login":i,o=t.usageType;return function(t,i){return M.isAuthenticated(i())?e(M.user(i())):t({type:r.AUTHENTICATE,payload:{effect:Object(v.clientOnly)(function(t){var i=t.Popups,r=t.dispatch,s=t.getState,u=t.History;return i.loadAuthenticatePopup().then(function(e){return new e({initialForm:a,next:n,usageType:o}).open()}).then(function(t){return r(I.get({allowPrefetching:!1})).then(function(){return e(M.user(s()))}).catch(function(e){return console.error(e)}).then(function(){return n||t})}).then(function(e){e&&u.push(e)})},r.AUTHENTICATE)}})}},logout:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).next,t=void 0===e?"pages:index":e;return{type:r.LOGOUT,payload:{effect:Object(v.clientOnly)(function(e){var n=e.Api,i=e.History,r=e.Trackers,a=e.CookieBag;return n.logout().then(function(){a.set(m.a.userTrackingCookie,r.mixpanel.getTrackingId()),a.remove(m.a.campaignTrackingCookie),t&&i.push(Object(w.e)(t,{},{logged_out:1}));return{allowsRestricted:"true"===a.get("sb_allows_age_restricted"),allowsGdpr:!!a.get("sf_gdpr_consent_provided_at"),entities:{users:{anonymous:{isAnonymous:!0,features:[],uid:"anonymous"}}}}})},r.LOGOUT)}}},signup:function(e){var t=e.username,n=e.email,i=e.password,a=e.gdprConsent,s=e.recaptcha,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=l.redirect,h=l.usageType;return{type:r.SIGNUP,payload:{effect:Object(v.clientOnly)(function(){var e=u()(o.a.mark(function e(r){var u,l,f,p,v;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=r.Api,l=r.CookieBag,f=r.Recaptcha,e.next=3,u.signup({username:t,email:n,password:i,gdprConsent:a,recaptcha:s});case 3:return p=e.sent,e.prev=4,e.next=7,f.generate("login");case 7:return v=e.sent,e.next=10,u.login({email:n,password:i,recaptcha:v,next:c});case 10:if(!h){e.next=13;break}return e.next=13,u.updateUserUsageType(p.uid,h);case 13:return l.remove(m.a.userTrackingCookie),e.abrupt("return",d()({},Object(g.b)(d()({features:[]},p),_.k),{redirectTo:Object(w.e)("users:onboarding")}));case 17:throw e.prev=17,e.t0=e.catch(4),new y.c;case 20:case"end":return e.stop()}},e,null,[[4,17]])}));return function(t){return e.apply(this,arguments)}}(),r.SIGNUP)}}},login:function(e,t){var n=e.email,i=e.password,a=e.recaptcha;return{type:r.LOGIN,payload:{effect:function(){var e=u()(o.a.mark(function e(r){var s,u,l,c,h;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.Api,u=r.CookieBag,e.next=3,s.login({email:n,password:i,recaptcha:a,next:t.redirect});case 3:return l=e.sent,c=l.redirectTo,e.next=7,s.getCurrentUser({allowPrefetching:!1});case 7:return h=e.sent,u.remove(m.a.userTrackingCookie),e.abrupt("return",d()({},Object(g.b)(h,_.k),{redirectTo:c,allowsGdpr:h.allowsGdpr,allowsRestricted:h.allowsRestricted}));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}}},getDoesLike:function(e){return function(t){return E(t)([e]).then(function(t){return t[e]})}},likeModel:function(e){return{type:r.LIKE_MODEL,payload:{modelUid:e,entities:{models:c()({},e,{likeCount:function(e){return e+1}})},effect:function(t){var n=t.Api;return(0,t.dispatch)(I.authenticate(function(){return n.likeModel(e)}))}}}},unlikeModel:function(e){return{type:r.UNLIKE_MODEL,payload:{modelUid:e,entities:{models:c()({},e,{likeCount:function(e){return e-1}})},effect:function(t){var n=t.Api;return(0,t.dispatch)(I.authenticate(function(){return n.unlikeModel(e)}))}}}},toggleLikeModel:function(e,t){return function(n,i){if(!M.isAuthenticated(i()))return n(I.authenticate(function(){return n(I.likeModel(e))},{redirectUrl:t}));var r=M.doesLike(e,i());return n(r?I.unlikeModel(e):I.likeModel(e))}},getHasPurchased:function(e){return function(t){return A(t)([e]).then(function(t){return t[e]||!1})}},getHasSubscribed:function(e){return function(t){return O(t)([e]).then(function(t){return t[e]})}},subscribe:function(e){return{type:r.SUBSCRIBE,payload:{collectionUid:e,entities:{collections:c()({},e,{subscriberCount:function(e){return e+1}})},effect:function(t){var n=t.Api;return(0,t.dispatch)(I.authenticate(function(){return n.subscribeToCollection(e)}))}}}},unsubscribe:function(e){return{type:r.UNSUBSCRIBE,payload:{collectionUid:e,entities:{collections:c()({},e,{subscriberCount:function(e){return e-1}})},effect:function(t){var n=t.Api;return(0,t.dispatch)(I.authenticate(function(){return n.unsubscribeFromCollection(e)}))}}}},toggleSubscribe:function(e){return function(t,n){if(!M.isAuthenticated(n()))return t(I.authenticate(function(){return t(I.subscribe(e))}));var i=M.hasSubscribed(e,n());return t(i?I.unsubscribe(e):I.subscribe(e))}},getDoesFollow:function(e){return function(t){return R(t)([e]).then(function(t){return t[e]})}},follow:function(e){return{type:r.FOLLOW,payload:{userUid:e,entities:{users:c()({},e,{followerCount:function(e){return e+1}})},effect:function(t){var n=t.Api;return(0,t.dispatch)(I.authenticate(function(){return n.followUser(e)}))}}}},unfollow:function(e){return{type:r.UNFOLLOW,payload:{userUid:e,entities:{users:c()({},e,{followerCount:function(e){return e-1}})},effect:function(t){var n=t.Api;return(0,t.dispatch)(I.authenticate(function(){return n.unfollowUser(e)}))}}}},toggleFollow:function(e){return function(t,n){if(!M.isAuthenticated(n()))return t(I.authenticate(function(){return t(I.follow(e))}));var i=M.doesFollow(e,n());return t(i?I.unfollow(e):I.follow(e))}},setAllowsRestricted:function(e){return function(t,n){var i=M.uid(n());return t({type:r.SET_ALLOWS_RESTRICTED,payload:{allowsRestricted:e,effect:function(){var t=u()(o.a.mark(function t(n){var r,a,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.Api,a=n.CookieBag,s=n.getState,t.abrupt("return",M.isAuthenticated(s())?r.updateUserAllowsRestriced(i,e):a.set("sb_allows_age_restricted",e.toString()));case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}})}},getHasUpvotedReview:function(e){return function(t){return P(t)([e]).then(function(t){return t[e]})}},upvoteReview:function(e){return{type:r.UPVOTE_REVIEW,payload:{reviewUid:e,entities:{reviews:c()({},e,{upvoteCount:function(e){return e+1}})},effect:function(t){var n=t.Api;return(0,t.dispatch)(I.authenticate(function(){return n.upvoteReview(e)}))}}}},downvoteReview:function(e){return{type:r.DOWNVOTE_REVIEW,payload:{reviewUid:e,entities:{reviews:c()({},e,{upvoteCount:function(e){return e-1}})},effect:function(t){var n=t.Api;return(0,t.dispatch)(I.authenticate(function(){return n.downvoteReview(e)}))}}}},toggleUpvoteReview:function(e){return function(t,n){if(!M.isAuthenticated(n()))return t(I.authenticate(function(){return t(I.upvoteReview(e))}));var i=M.hasUpvotedReview(e,n());return t(i?I.downvoteReview(e):I.upvoteReview(e))}},canReviewModel:function(e){return{type:r.CAN_REVIEW_MODEL,payload:{modelUid:e,effect:function(t){var n=t.Api,i=t.getState;return!!M.isAuthenticated(i())&&n.canReviewModel(e).then(function(e){return e.canReview})}}}},updateAvatar:function(e){return{type:r.UPDATE_AVATAR,payload:{effect:function(){var t=u()(o.a.mark(function t(n){var i,r,a,s,u,l,h;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.Api,r=n.getState,a=M.uid(r())){t.next=4;break}throw new Error("actions.authUser.updateAvatar error: current user isn't logged in");case 4:return t.next=6,i.updateCurrentUserAvatar(e);case 6:return s=t.sent,u=s.uid,t.next=10,i.pollAvatars(u);case 10:return l=t.sent,h={users:c()({},a,{avatars:l})},t.abrupt("return",{entities:h});case 13:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}},updatePublishCredits:function(e){return{type:r.UPDATE_PUBLISH_CREDITS,payload:{effect:function(){var t=u()(o.a.mark(function t(n){var i,r,a,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.getState,!(r=M.user(i())).isAnonymous&&"unlimited"!==r.viewOnlyLimit.type){t.next=4;break}return t.abrupt("return",{});case 4:return a=r.viewOnlyLimit.remaining,s=e(a),t.abrupt("return",{entities:{users:c()({},r.uid,{viewOnlyLimit:d()({},r.viewOnlyLimit,{remaining:s})})}});case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}},allowGdpr:function(){return{type:r.PROVIDE_GDPR_CONSENT,payload:{effect:Object(v.clientOnly)(function(){var e=u()(o.a.mark(function e(t){var n,i,r,a,s,l,c,h;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.Api,i=t.getState,r=t.Trackers,a=t.CookieBag,s=function(){var e=u()(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(new Date).toUTCString(),a.set("sf_gdpr_consent_provided_at",t);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),l=function(){var e=u()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provideCurrentUserGdprConsent();case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),c=M.user(i()),h=c.isAnonymous?null:c.uid,!M.isAuthenticated(i())){e.next=10;break}return e.next=8,l();case 8:e.next=12;break;case 10:return e.next=12,s();case 12:return r.gtm.triggerAllowsGdprEvent(),r.ga.userAllowedGdpr(h),e.abrupt("return",{allowsGdpr:!0});case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.PROVIDE_GDPR_CONSENT)}}},addMembership:function(e,t){return{type:r.ADD_MEMBERSHIP,payload:{orgUid:e,memberUid:t}}}}},FiKZ:function(e,t){e.exports='uniform float uEnvironmentExposure;\r\nuniform mat3 uEnvironmentTransform;\r\nuniform vec2 uTextureEnvironmentSpecularPBRLodRange;\r\nuniform vec2 uTextureEnvironmentSpecularPBRTextureSize;\r\nuniform vec3 uDiffuseSPH[9];\r\n\r\n#ifdef HAS_ENVIRONMENT_BRDF\r\nuniform sampler2D sIntegrateBRDF;\r\n#endif\r\n\r\nvec3 computeDiffuseSPH(const in vec3 normal) {\r\n    vec3 n = uEnvironmentTransform * normal;\r\n    // https://github.com/cedricpinson/envtools/blob/master/Cubemap.cpp#L523\r\n    vec3 result =\r\n        uDiffuseSPH[0] +\r\n        uDiffuseSPH[1] * n.y +\r\n        uDiffuseSPH[2] * n.z +\r\n        uDiffuseSPH[3] * n.x +\r\n        uDiffuseSPH[4] * n.y * n.x +\r\n        uDiffuseSPH[5] * n.y * n.z +\r\n        uDiffuseSPH[6] * (3.0 * n.z * n.z - 1.0) +\r\n        uDiffuseSPH[7] * (n.z * n.x) +\r\n        uDiffuseSPH[8] * (n.x * n.x - n.y * n.y);\r\n     return max(result, vec3(0.0));\r\n}\r\n\r\n#ifndef HAS_LEGACY_CLASSIC\r\n\r\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/BRDF.ush#L202\r\nvec3 integrateBRDF(const in vec3 specular, const in float roughness, const in float NoV, const in float f90) {\r\n#ifdef HAS_ENVIRONMENT_BRDF\r\n    vec4 rgba = texture2D(sIntegrateBRDF, vec2(NoV, roughness));\r\n    float b = (rgba[3] * 65280.0 + rgba[2] * 255.0);\r\n    float a = (rgba[1] * 65280.0 + rgba[0] * 255.0);\r\n    const float div = 1.0 / 65535.0;\r\n    return (specular * a + b * f90) * div;\r\n#else\r\n    // https://www.unrealengine.com/blog/physically-based-shading-on-mobile\r\n    // TODO should we use somehow specular f0 ?\r\n    const vec4 c0 = vec4(-1.0, -0.0275, -0.572, 0.022);\r\n    const vec4 c1 = vec4(1.0, 0.0425, 1.04, -0.04);\r\n    vec4 r = roughness * c0 + c1;\r\n    float a004 = min(r.x * r.x, exp2(-9.28 * NoV)) * r.x + r.y;\r\n    vec2 AB = vec2(-1.04, 1.04) * a004 + r.zw;\r\n    return specular * AB.x + AB.y * f90;\r\n#endif\r\n}\r\n\r\n// Frostbite, Lagarde paper p67\r\n// http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\nfloat linRoughnessToMipmap(const in float roughnessLinear) {\r\n    return sqrt(roughnessLinear);\r\n}\r\n\r\n#ifdef ENV_CUBEMAP\r\nuniform samplerCube sSpecularPBR;\r\n#pragma include "utils/cubemapLod.glsl"\r\n#endif\r\n\r\n#ifdef ENV_PANORAMA\r\nuniform sampler2D sSpecularPBR;\r\n#pragma include "utils/panoramaLod.glsl"\r\n#endif\r\n\r\nvec3 getSpecularDominantDir(const in vec3 N, const in vec3 R, const in float realRoughness) {\r\n    float smoothness = 1.0 - realRoughness;\r\n    float lerpFactor = smoothness * (sqrt(smoothness) + realRoughness);\r\n    // The result is not normalized as we fetch in a cubemap\r\n    return mix(N, R, lerpFactor);\r\n}\r\n\r\nvec3 getPrefilteredEnvMapColor(const in vec3 normal, const in vec3 eyeVector, const in float roughness, const in vec3 frontNormal) {\r\n    vec3 R = reflect(-eyeVector, normal);\r\n\r\n    // specular dominant dir is using the bentNormal in the anisotropy scenario\r\n    // if we want to get rid of the dominant dir but still have a matching result with anisotropy=0 we could try:\r\n    // R = mix(getSpecularDominantDir(normal, R, roughness), R, anisotropy);\r\n    R = getSpecularDominantDir(normal, R, roughness);\r\n\r\n#ifdef ENV_CUBEMAP\r\n    vec3 prefilteredColor = prefilterEnvMapCube(roughness, uEnvironmentTransform * R);\r\n#else\r\n    vec3 prefilteredColor = prefilterEnvMapPanorama(roughness, uEnvironmentTransform * R);\r\n#endif\r\n\r\n    // http://marmosetco.tumblr.com/post/81245981087\r\n    // marmoset uses 1.3, we force it to 1.0\r\n    float factor = clamp(1.0 + dot(R, frontNormal), 0.0, 1.0);\r\n    prefilteredColor *= factor * factor;\r\n    return prefilteredColor;\r\n}\r\n\r\nvec3 computeIBLSpecularUE4(const in vec3 normal, const in vec3 eyeVector, const in float roughness, const in vec3 specular, const in vec3 frontNormal, const in float f90) {\r\n    float NoV = dot(normal, eyeVector);\r\n    return getPrefilteredEnvMapColor(normal, eyeVector, roughness, frontNormal) * integrateBRDF(specular, roughness, NoV, f90);\r\n}\r\n\r\n#endif\r\n'},GFHa:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var i=function(e){var t=0;return e<.0031308?e>0&&(t=12.92*e):t=1.055*Math.pow(e,1/2.4)-.055,t},r=function(e){var t=0;return e<.04045?e>=0&&(t=e*(1/12.92)):t=Math.pow((e+.055)*(1/1.055),2.4),t},a=function(e){var t=decodeURI(e);return function(e){return/^[0-9a-f]{3}([0-9a-f]{3})?$/i.test(e)}(t)?"#".concat(t):t};t.a={linearToSrgb1:i,srgbToLinear1:r,linearToSrgb:function(e,t){var n=t||new Array(e.length);return n[0]=i(e[0]),n[1]=i(e[1]),n[2]=i(e[2]),n.length>3&&e.length>3&&(n[3]=e[3]),n},srgbToLinear:function(e,t){var n=t||new Array(e.length);return n[0]=r(e[0]),n[1]=r(e[1]),n[2]=r(e[2]),n.length>3&&e.length>3&&(n[3]=e[3]),n},encodeRGBM:function(e,t,n){n[3]=Math.min(1,Math.max(e[0]/t,n[1]/t,n[2]/t,1e-6)),n[3]=Math.ceil(255*n[3])/255;var i=1/(t*n[3]);return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n},decodeRGBM:function(e,t,n){var i=t*e[3];return n[0]=i*n[0],n[1]=i*n[1],n[2]=i*n[2],n},rgbToHex:function(e){var t=Math.round(255*e.r),n=Math.round(255*e.g);return"#"+(16777216|Math.round(255*e.b)|n<<8|t<<16).toString(16).substr(1)},parseUrlColor:a}},GRG7:function(e,t,n){"use strict";var i=n("a3nb"),r=n("r7P/"),a=function(){r.a.call(this),this.visitorType=r.a.UPDATE_VISITOR,this._numUpdateCallback=0};i.a.createPrototypeObject(a,i.a.objectInherit(r.a.prototype,{resetStats:function(){this._numUpdateCallback=0},apply:function(e){var t=e.getStateSet();if(t&&t.requiresUpdateTraversal()){var n=t.getUpdateCallbackList(),i=n.length;if(i){this._numUpdateCallback+=i;for(var r=0,a=i;r<a;r++)n[r].update(t,this)}}for(var o=e.getUpdateCallbackList(),s=o.length,u=0;u<s;u++)if(this._numUpdateCallback++,!o[u].update(e,this))return;e.getNumChildrenRequiringUpdateTraversal()>0&&this.traverse(e)}}),"osg","NodeVisitor"),t.a=a},Gc7n:function(e,t,n){"use strict";n.r(t);var i=n("D1Qd"),r=n("YVF9"),a=n("uvJm"),o=n("W8Lp"),s=n("vcgX"),u=n("czSk"),l=n("ULzY"),c=n("ip6O"),h=n("H9HN"),d=n("oCbj"),f=n("DNxV"),p=n("kKFa"),g=n("AwiE"),m=n("TMnl"),v=n("EhLm"),_=n("UwbM"),b=n("cuuI"),S=n("ff9x"),y=n("icjm"),x=function(){this._camera=new r.a,this._camera.setName("OSGJS camera"),this._scene=new b.a,this._camera.setName("OSGJS Scene"),this._frameStamp=new a.a,this._lightingMode=void 0,this._manipulator=void 0,this._canvasWidth=0,this._canvasHeight=0,this._requestContinousUpdate=!0,this._requestRedraw=!0,this.setLightingMode(x.LightingMode.HEADLIGHT);var e=this.createRenderer(this.getCamera());e.setFrameStamp(this._frameStamp),this.getCamera().setRenderer(e),this.getCamera().setView(this)};x.LightingMode={NO_LIGHT:0,HEADLIGHT:1,SKY_LIGHT:2},x.prototype={requestRedraw:function(){this._requestRedraw=!0},requestContinuousUpdate:function(e){this._requestContinousUpdate=e},createRenderer:function(e){return new _.default(e)},setGraphicContext:function(e){this.getCamera().getRenderer().getState().setGraphicContext(e)},getGraphicContext:function(){return this.getCamera().getRenderer().getState().getGraphicContext()},initWebGLCaps:function(e,t){g.a.instance(e,t)},computeCanvasSize:function(){var e,t,n;return function(i){n||(window.ResizeObserver?((n=new ResizeObserver(function(){e=i.clientWidth,t=i.clientHeight})).observe(i),e=i.clientWidth,t=i.clientHeight):(e=i.clientWidth,t=i.clientHeight)),e<1&&(e=1),t<1&&(t=1);var r=this._devicePixelRatio,a=Math.floor(e*r),o=Math.floor(t*r),s=!1;return this._canvasWidth!==a&&(i.width=a,this._canvasWidth=a,s=!0),this._canvasHeight!==o&&(i.height=o,this._canvasHeight=o,s=!0),s}}(),getCanvasWidth:function(){return this._canvasWidth},getCanvasHeight:function(){return this._canvasHeight},getCanvasClientWidth:function(){return Math.ceil(this._canvasWidth/this._devicePixelRatio)},getCanvasClientHeight:function(){return Math.ceil(this._canvasHeight/this._devicePixelRatio)},getCanvasPixelRatio:function(){return this._devicePixelRatio},setUpView:function(e,t){var n=window.devicePixelRatio||1,i=t.getNumber("overrideDevicePixelRatio"),r=t.getNumber("maxDevicePixelRatio")||-1;"number"==typeof i?n=i:-1!==r&&(n=Math.min(n,r)),this._devicePixelRatio=n,this.computeCanvasSize(e);var a=e.width,o=e.height,s=a/o;if(this._camera.setViewport(new f.a(0,0,a,o)),this._camera.setScissor(new d.a),this._camera.setGraphicContext(this.getGraphicContext()),u.c.lookAt(this._camera.getViewMatrix(),u.f.fromValues(0,0,-10),u.f.create(),u.f.fromValues(0,1,0)),u.c.perspective(this._camera.getProjectionMatrix(),Math.PI/180*55,s,1,1e3),t&&t.enableFrustumCulling&&this.getCamera().getRenderer().getCullVisitor().setEnableFrustumCulling(!0),t&&t.debugGraph){var l=this.getCamera();S.a.instance().refreshGraph=function(){var e=S.a.instance();e.setDisplayGraphRenderer(!0),e.createGraph(l)},y.a.log("to refresh the graphs type in the console:\nOSG.osgUtil.DisplayGraph.instance().refreshGraph()")}},computeIntersections:function(e,t,n){return void 0===n&&(n=-1),this._lsi?this._lsi.reset():this._lsi=new v.a,this._origIntersect||(this._origIntersect=u.f.create(),this._dstIntersect=u.f.create()),this._lsi.set(u.f.set(this._origIntersect,e,t,0),u.f.set(this._dstIntersect,e,t,1)),this._iv?this._iv.reset():(this._iv=new m.a,this._iv.setIntersector(this._lsi)),this._iv.setTraversalMask(n),this._camera.accept(this._iv),this._lsi.getIntersections()},setFrameStamp:function(e){this._frameStamp=e},getFrameStamp:function(){return this._frameStamp},setCamera:function(e){this._camera=e},getCamera:function(){return this._camera},setSceneData:function(e){if(e!==this._scene.getSceneData()){this._scene.setSceneData(e);for(var t=this._camera.getChildren(),n=void 0,i=0,r=t.length;i<r;i++)if("osgStats"===t[i].getName()){n=t[i];break}this._camera.removeChildren(),this._camera.addChild(e),n&&this._camera.addChild(n)}},getSceneData:function(){return this._scene.getSceneData()},setDatabasePager:function(e){this._scene.setDatabasePager(e)},getDatabasePager:function(){return this._scene.getDatabasePager()},getScene:function(){return this._scene},getManipulator:function(){return this._manipulator},setManipulator:function(e){this._manipulator=e},getLight:function(){return this._light},setLight:function(e){this._light=e,this._lightingMode!==x.LightingMode.NO_LIGHT&&this._scene.getOrCreateStateSet().setAttributeAndModes(this._light)},getLightingMode:function(){return this._lightingMode},setLightingMode:function(e){this._lightingMode!==e&&(this._lightingMode=e,this._lightingMode!==x.LightingMode.NO_LIGHT?this._light||(this._light=new s.a):this._light=void 0)},flushDeletedGLObjects:function(e){var t=this.getGraphicContext(),n=e;n=i.a.flushDeletedGLBufferArrays(t,n),n=p.a.flushDeletedGLVertexArrayObjects(t,n),n=l.default.getTextureManager(t).flushDeletedTextureObjects(t,n),n=c.a.flushDeletedGLPrograms(t,n),n=h.a.flushDeletedGLShaders(t,n),n=o.a.flushDeletedGLFrameBuffers(t,n),o.a.flushDeletedGLRenderBuffers(t,n)},flushAllDeletedGLObjects:function(){var e=this.getGraphicContext();p.a.flushAllDeletedGLVertexArrayObjects(e),i.a.flushAllDeletedGLBufferArrays(e),l.default.getTextureManager(e).flushAllDeletedTextureObjects(e),c.a.flushAllDeletedGLPrograms(e),h.a.flushAllDeletedGLShaders(e),o.a.flushAllDeletedGLFrameBuffers(e),o.a.flushAllDeletedGLRenderBuffers(e)}},t.default=x},GfGl:function(e,t,n){"use strict";var i=n("czSk"),r=n("D1Qd"),a=n("wwkN"),o=n("QVk6"),s=n("SoBM"),u=n("OZCL"),l=n("ip6O"),c=n("H9HN"),h=n("a3nb"),d=function(){var e=new a.a,t=new h.a.Float32Array([4,-1,-1,4,-1,-1]),n=new r.a(r.a.ARRAY_BUFFER,t,2);e.getAttributes().Vertex=n,e.getAttributes().TexCoord0=n;var i=new s.a(o.a.TRIANGLES,0,3);return e.getPrimitives().push(i),function(){return e}}(),f=function(e){void 0===e&&(e=1),void 0===f.getShader&&(f.getShader=function(){if(void 0===f.getShader.program){var e=["attribute vec3 Vertex;","attribute vec4 Color;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","","varying vec4 vColor;","","void main(void) {","  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex, 1.0));","  vColor = Color;","}"].join("\n"),t=["varying vec4 vColor;","void main(void) {","gl_FragColor = vColor;","}"].join("\n"),n=new l.a(new c.a("VERTEX_SHADER",e),new c.a("FRAGMENT_SHADER",t));f.getShader.program=n}return f.getShader.program});var t=new a.a,n=new h.a.Float32Array(18);n[3]=e,n[10]=e,n[17]=e;var i=new h.a.Float32Array(24);i[0]=i[3]=1,i[4]=i[7]=1,i[9]=i[11]=1,i[13]=i[15]=1,i[18]=i[19]=1,i[22]=i[23]=1,t.getAttributes().Vertex=new r.a(r.a.ARRAY_BUFFER,n,3),t.getAttributes().Color=new r.a(r.a.ARRAY_BUFFER,i,4);var u=new s.a(o.a.LINES,0,6);return t.getPrimitives().push(u),t.getOrCreateStateSet().setAttributeAndModes(f.getShader()),t},p=function(e,t,n,l,c,d,f){e=e||1,l=void 0!==l?l:0,c=void 0!==c?c:2*Math.PI,d=void 0!==d?d:0,f=void 0!==f?f:Math.PI;for(var p=Math.max(3,Math.floor(t)||8),g=Math.max(2,Math.floor(n)||6),m=p*g/3>=65536,v=m?p*g*6:p*g*4,_=new h.a.Float32Array(3*v),b=new h.a.Float32Array(3*v),S=new h.a.Float32Array(2*v),y=m?void 0:new h.a.Uint16Array(p*g*6),x=0,C=0,w=new h.a.Float32Array(3),T=new h.a.Float32Array(3),M=new h.a.Float32Array(3),E=new h.a.Float32Array(3),A=new h.a.Float32Array(3),O=new h.a.Float32Array(3),R=new h.a.Float32Array(3),P=new h.a.Float32Array(3),I=new h.a.Float32Array(2),N=new h.a.Float32Array(2),L=new h.a.Float32Array(2),k=new h.a.Float32Array(2),D=function(t,n,r,a,o){r[0]=-e*Math.cos(l+t*c)*Math.sin(d+n*f),r[1]=e*Math.cos(d+n*f),r[2]=e*Math.sin(l+t*c)*Math.sin(d+n*f),i.f.normalize(a,r),o[0]=t,o[1]=1-n},F=0;F<g;F++)for(var V=0;V<p;V++){D((V+1)/p,F/g,w,A,I),D(V/p,F/g,T,O,N),D(V/p,(F+1)/g,M,R,L),D((V+1)/p,(F+1)/g,E,P,k);var B=3*x;_[B]=w[0],_[B+1]=w[1],_[B+2]=w[2],_[B+3]=T[0],_[B+4]=T[1],_[B+5]=T[2],_[B+6]=M[0],_[B+7]=M[1],_[B+8]=M[2],b[B]=A[0],b[B+1]=A[1],b[B+2]=A[2],b[B+3]=O[0],b[B+4]=O[1],b[B+5]=O[2],b[B+6]=R[0],b[B+7]=R[1],b[B+8]=R[2];var U=2*x;if(S[U]=I[0],S[U+1]=I[1],S[U+2]=N[0],S[U+3]=N[1],S[U+4]=L[0],S[U+5]=L[1],x+=3,m)_[B=3*x]=w[0],_[B+1]=w[1],_[B+2]=w[2],_[B+3]=M[0],_[B+4]=M[1],_[B+5]=M[2],_[B+6]=E[0],_[B+7]=E[1],_[B+8]=E[2],b[B]=A[0],b[B+1]=A[1],b[B+2]=A[2],b[B+3]=R[0],b[B+4]=R[1],b[B+5]=R[2],b[B+6]=P[0],b[B+7]=P[1],b[B+8]=P[2],S[U=2*x]=I[0],S[U+1]=I[1],S[U+2]=L[0],S[U+3]=L[1],S[U+4]=k[0],S[U+5]=k[1],x+=3;else{_[B=3*x]=E[0],_[B+1]=E[1],_[B+2]=E[2],b[B]=P[0],b[B+1]=P[1],b[B+2]=P[2],S[U=2*x]=k[0],S[U+1]=k[1];var j=3*C,G=x-3;y[j]=G,y[j+1]=G+1,y[j+2]=G+2,y[j+3]=G,y[j+4]=G+2,y[j+5]=G+3,C+=2,x+=1}}var H=new a.a;return H.getAttributes().Vertex=new r.a("ARRAY_BUFFER",_,3),H.getAttributes().Normal=new r.a("ARRAY_BUFFER",b,3),H.getAttributes().TexCoord0=new r.a("ARRAY_BUFFER",S,2),m?H.getPrimitives().push(new s.a(o.a.TRIANGLES,0,_.length/3)):H.getPrimitives().push(new u.a(o.a.TRIANGLES,new r.a("ELEMENT_ARRAY_BUFFER",y,1))),H};t.a={createTexturedBoxGeometry:function(e,t,n,i,s,l){var c,d,f,p=void 0!==e?e:0,g=void 0!==t?t:0,m=void 0!==n?n:0,v=void 0!==i?i:1,_=void 0!==s?s:1,b=void 0!==l?l:1,S=new a.a;c=v/2,d=_/2,f=b/2;var y=new h.a.Float32Array(72),x=new h.a.Float32Array(48),C=new h.a.Float32Array(72);y[0]=p-c,y[1]=g-d,y[2]=m+f,C[0]=0,C[1]=-1,C[2]=0,x[0]=0,x[1]=1,y[3]=p-c,y[4]=g-d,y[5]=m-f,C[3]=0,C[4]=-1,C[5]=0,x[2]=0,x[3]=0,y[6]=p+c,y[7]=g-d,y[8]=m-f,C[6]=0,C[7]=-1,C[8]=0,x[4]=1,x[5]=0,y[9]=p+c,y[10]=g-d,y[11]=m+f,C[9]=0,C[10]=-1,C[11]=0,x[6]=1,x[7]=1,y[12]=p+c,y[13]=g+d,y[14]=m+f,C[12]=0,C[13]=1,C[14]=0,x[8]=0,x[9]=1,y[15]=p+c,y[16]=g+d,y[17]=m-f,C[15]=0,C[16]=1,C[17]=0,x[10]=0,x[11]=0,y[18]=p-c,y[19]=g+d,y[20]=m-f,C[18]=0,C[19]=1,C[20]=0,x[12]=1,x[13]=0,y[21]=p-c,y[22]=g+d,y[23]=m+f,C[21]=0,C[22]=1,C[23]=0,x[14]=1,x[15]=1,y[24]=p+c,y[25]=g-d,y[26]=m+f,C[24]=1,C[25]=0,C[26]=0,x[16]=0,x[17]=1,y[27]=p+c,y[28]=g-d,y[29]=m-f,C[27]=1,C[28]=0,C[29]=0,x[18]=0,x[19]=0,y[30]=p+c,y[31]=g+d,y[32]=m-f,C[30]=1,C[31]=0,C[32]=0,x[20]=1,x[21]=0,y[33]=p+c,y[34]=g+d,y[35]=m+f,C[33]=1,C[34]=0,C[35]=0,x[22]=1,x[23]=1,y[36]=p-c,y[37]=g+d,y[38]=m+f,C[36]=-1,C[37]=0,C[38]=0,x[24]=0,x[25]=1,y[39]=p-c,y[40]=g+d,y[41]=m-f,C[39]=-1,C[40]=0,C[41]=0,x[26]=0,x[27]=0,y[42]=p-c,y[43]=g-d,y[44]=m-f,C[42]=-1,C[43]=0,C[44]=0,x[28]=1,x[29]=0,y[45]=p-c,y[46]=g-d,y[47]=m+f,C[45]=-1,C[46]=0,C[47]=0,x[30]=1,x[31]=1,y[48]=p-c,y[49]=g+d,y[50]=m+f,C[48]=0,C[49]=0,C[50]=1,x[32]=0,x[33]=1,y[51]=p-c,y[52]=g-d,y[53]=m+f,C[51]=0,C[52]=0,C[53]=1,x[34]=0,x[35]=0,y[54]=p+c,y[55]=g-d,y[56]=m+f,C[54]=0,C[55]=0,C[56]=1,x[36]=1,x[37]=0,y[57]=p+c,y[58]=g+d,y[59]=m+f,C[57]=0,C[58]=0,C[59]=1,x[38]=1,x[39]=1,y[60]=p+c,y[61]=g+d,y[62]=m-f,C[60]=0,C[61]=0,C[62]=-1,x[40]=0,x[41]=1,y[63]=p+c,y[64]=g-d,y[65]=m-f,C[63]=0,C[64]=0,C[65]=-1,x[42]=0,x[43]=0,y[66]=p-c,y[67]=g-d,y[68]=m-f,C[66]=0,C[67]=0,C[68]=-1,x[44]=1,x[45]=0,y[69]=p-c,y[70]=g+d,y[71]=m-f,C[69]=0,C[70]=0,C[71]=-1,x[46]=1,x[47]=1;var w=new h.a.Uint16Array(36);w[0]=0,w[1]=1,w[2]=2,w[3]=0,w[4]=2,w[5]=3,w[6]=4,w[7]=5,w[8]=6,w[9]=4,w[10]=6,w[11]=7,w[12]=8,w[13]=9,w[14]=10,w[15]=8,w[16]=10,w[17]=11,w[18]=12,w[19]=13,w[20]=14,w[21]=12,w[22]=14,w[23]=15,w[24]=16,w[25]=17,w[26]=18,w[27]=16,w[28]=18,w[29]=19,w[30]=20,w[31]=21,w[32]=22,w[33]=20,w[34]=22,w[35]=23,S.getAttributes().Vertex=new r.a(r.a.ARRAY_BUFFER,y,3),S.getAttributes().Normal=new r.a(r.a.ARRAY_BUFFER,C,3),S.getAttributes().TexCoord0=new r.a(r.a.ARRAY_BUFFER,x,2);var T=new u.a(o.a.TRIANGLES,new r.a(r.a.ELEMENT_ARRAY_BUFFER,w,1));return S.getPrimitives().push(T),S},createTexturedQuadGeometry:function(e,t,n,s,l,c,d,f,p,g,m,v,_){void 0===v&&void 0===_&&(v=g,_=m,g=0,m=0);var b=new a.a,S=new h.a.Float32Array(12);S[0]=e+d,S[1]=t+f,S[2]=n+p,S[3]=e,S[4]=t,S[5]=n,S[6]=e+s,S[7]=t+l,S[8]=n+c,S[9]=e+s+d,S[10]=t+l+f,S[11]=n+c+p,void 0===v&&(v=1),void 0===_&&(_=1);var y=new h.a.Float32Array(8);y[0]=g,y[1]=_,y[2]=g,y[3]=m,y[4]=v,y[5]=m,y[6]=v,y[7]=_;var x=i.f.fromValues(s,l,c);i.f.cross(x,x,i.f.fromValues(d,f,p)),i.f.normalize(x,x);var C=new h.a.Float32Array(12);C[0]=x[0],C[1]=x[1],C[2]=x[2],C[3]=x[0],C[4]=x[1],C[5]=x[2],C[6]=x[0],C[7]=x[1],C[8]=x[2],C[9]=x[0],C[10]=x[1],C[11]=x[2];var w=new h.a.Uint16Array(6);w[0]=0,w[1]=1,w[2]=2,w[3]=0,w[4]=2,w[5]=3,b.getAttributes().Vertex=new r.a(r.a.ARRAY_BUFFER,S,3),b.getAttributes().Normal=new r.a(r.a.ARRAY_BUFFER,C,3),b.getAttributes().TexCoord0=new r.a(r.a.ARRAY_BUFFER,y,2);var T=new u.a(o.a.TRIANGLES,new r.a(r.a.ELEMENT_ARRAY_BUFFER,w,1));return b.getPrimitives().push(T),b},createTexturedSphereGeometry:p,createTexturedFullScreenFakeQuadGeometry:d,createAxisGeometry:f,createTexturedSphere:p,createGridGeometry:function(e,t,n,i,u,l,c,h,d,f,p){e=void 0!==e?e:-.5,t=void 0!==t?t:-.5,n=void 0!==n?n:0,i=void 0!==i?i:1,u=void 0!==u?u:0,l=void 0!==l?l:0,c=void 0!==c?c:0,h=void 0!==h?h:1,d=void 0!==d?d:0,f=void 0!==f?f:5,p=void 0!==p?p:f,f+=2,p+=2;var g=new a.a,m=new Float32Array(2*(f+p)*3),v=0,_=0,b=i/(f-1),S=u/(f-1),y=l/(f-1),x=e+i+c,C=t+u+h,w=n+l+d;for(v=0;v<f;++v)m[_=6*v]=e+b*v,m[_+1]=t+S*v,m[_+2]=n+y*v,m[_+3]=x-b*(f-v-1),m[_+4]=C-S*(f-v-1),m[_+5]=w-y*(f-v-1);for(b=c/(p-1),S=h/(p-1),y=d/(p-1),v=0;v<p;++v)m[_=6*(f+v)]=e+b*v,m[_+1]=t+S*v,m[_+2]=n+y*v,m[_+3]=x-b*(p-v-1),m[_+4]=C-S*(p-v-1),m[_+5]=w-y*(p-v-1);g.getAttributes().Vertex=new r.a(r.a.ARRAY_BUFFER,m,3);var T=new s.a(o.a.LINES,0,2*(f+p));return g.getPrimitives().push(T),g},createBoundingBoxGeometry:function(e){var t=new a.a,n=new Float32Array([-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5]);t.getAttributes().Vertex=new r.a(r.a.ARRAY_BUFFER,n,3),e||(e=[1,0,0,1]);for(var i=new h.a.Float32Array(32),s=0;s<8;s++)for(var l=0;l<4;l++)i[3*s+l]=e[l];t.getAttributes().Color=new r.a(r.a.ARRAY_BUFFER,i,4);var c=new h.a.Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);return t.getPrimitives().push(new u.a(o.a.LINES,new r.a("ELEMENT_ARRAY_BUFFER",c,1))),t}}},GhR1:function(e,t,n){"use strict";var i=n("a3nb"),r=n("czSk"),a=n("Ep1f"),o=n("LTZp"),s=function(){a.a.call(this),this.matrix=r.c.create()};i.a.createPrototypeNode(s,i.a.objectInherit(a.a.prototype,{getMatrix:function(){return this.matrix},setMatrix:function(e){this.matrix=e,this.dirtyBound()},computeLocalToWorldMatrix:function(e){return this.referenceFrame===o.a.RELATIVE_RF?r.c.mul(e,e,this.matrix):r.c.copy(e,this.matrix),!0},computeWorldToLocalMatrix:function(){var e=r.c.create();return function(t){return r.c.invert(e,this.matrix),this.referenceFrame===o.a.RELATIVE_RF?r.c.mul(t,e,t):r.c.copy(t,e),!0}}()}),"osg","MatrixTransform"),t.a=s},GpBa:function(e,t){e.exports="attribute vec3 Vertex;\nvarying vec2 vTexCoord0;\n\nvoid main(void) {\n    gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);\n    vTexCoord0 = Vertex.xy;\n}\n"},H9HN:function(e,t,n){"use strict";var i=n("icjm"),r=n("a3nb"),a=n("zP/P"),o=n("RwmW"),s=function(e,t){o.a.call(this);var n=e;"string"==typeof e&&(n=s[e]),this.type=n,this.setText(t)};s.VERTEX_SHADER=35633,s.FRAGMENT_SHADER=35632;s.VS_DBG="#define _DEBUG 1\n#ifdef _DEBUG\nattribute vec3 Vertex;uniform mat4 uModelViewMatrix;uniform mat4 uProjectionMatrix;void main(void) {  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);}\n",s.FS_DBG="#define _DEBUG 1\n#ifdef _DEBUG\n precision lowp float; void main(void) { gl_FragColor = vec4(1.0, 0.6, 0.6, 1.0);}\n",s._sDeletedGLShaderCache=new window.Map,s.deleteGLShader=function(e,t){s._sDeletedGLShaderCache.has(e)||s._sDeletedGLShaderCache.set(e,[]),s._sDeletedGLShaderCache.get(e).push(t)},s.flushDeletedGLShaders=function(e,t){if(t<=0)return t;if(!s._sDeletedGLShaderCache.has(e))return t;for(var n=0,i=a.a.instance().tick(),r=s._sDeletedGLShaderCache.get(e),o=r.length-1;o>=0&&n<t;o--)e.deleteShader(r[o]),r.splice(o,1),n=a.a.instance().deltaS(i,a.a.instance().tick());return t-n},s.flushAllDeletedGLShaders=function(e){if(s._sDeletedGLShaderCache.has(e))for(var t=s._sDeletedGLShaderCache.get(e),n=t.length-1;n>=0;n--)e.deleteShader(t[n]),t.splice(n,1)},s.onLostContext=function(e){s._sDeletedGLShaderCache.has(e)&&(s._sDeletedGLShaderCache.get(e).length=0)},r.a.createPrototypeObject(s,r.a.objectInherit(o.a.prototype,{setText:function(e){this.text=e},getText:function(){return this.text},failSafe:function(e,t){this.shader=e.createShader(this.type);var n=t.match(/#define[\s]+SHADER_NAME[\s]+([\S]+)(\n|$)/);n=n?n[1]:"";var i=this.type===s.VERTEX_SHADER?s.VS_DBG:s.FS_DBG;i+="\n#define SHADER_NAME FailSafe"+n+"\n#else\n"+t+"\n#endif\n",e.shaderSource(this.shader,i),e.compileShader(this.shader)},processErrors:function(e,t){var n,r,a=/ERROR: [\d]+:([\d]+): (.+)/gim,o=t.split("\n"),s=o.length;if(0!==s)if(null===a.exec(e)&&(a=/Shader compilation errors\n\((\d+)\, \d+\): (.+)/gim),a.lastIndex=0,null!==a.exec(e))for(a.lastIndex=0;null!==(r=a.exec(e));){r.index===a.lastIndex&&a.lastIndex++;var u=parseInt(r[1],10);if(!(u>s)){i.a.error("ERROR "+r[2]+" in line "+u);var l=Math.max(0,u-7),c=Math.max(0,u-2);for(n=l;n<=c;n++)i.a.warn(o[n].replace(/^[ \t]+/g,""));for(c=Math.max(0,u-1),i.a.error(o[c].replace(/^[ \t]+/g,"")),l=Math.min(s,u),c=Math.min(s,u+5),n=l;n<c;n++)i.a.warn(o[n].replace(/^[ \t]+/g,""))}}else i.a.error(e)},compile:function(e){this._gl||this.setGraphicContext(e),this.shader=e.createShader(this.type),e.shaderSource(this.shader,this.text),e.compileShader(this.shader)},getCompilationResult:function(e,t){if(!e.getShaderParameter(this.shader,e.COMPILE_STATUS)&&!e.isContextLost()){var n=e.getShaderInfoLog(this.shader);this.processErrors(n,this.text);for(var r=this.text.split("\n"),a="\n",o=0,s=r.length;o<s;++o)a+=o+" "+r[o]+"\n";return i.a.errorFold("can't compile shader",a),t&&t(this.text,a,n),!1}return!0},releaseGLObjects:function(){void 0!==this._gl&&(s.deleteGLShader(this._gl,this.shader),o.a.removeObject(this._gl,this)),this.invalidate()},invalidate:function(){this.shader=void 0}}),"osg","Shader"),t.a=s},HF1e:function(e,t){e.exports='#pragma include "utils/rand.glsl"\n\nuniform vec3 uDofBlurNearFarFocal;\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureDofColor;\nuniform vec2 uTextureDofColorSize;\n\n#ifndef COLOR_WITH_COC\nuniform sampler2D TextureDofCoC;\nuniform vec2 uTextureDofCoCSize;\n#endif\n\nuniform float uDofScale;\nuniform float uQuality;\n\nuniform float uFrameModTaaSS;\n\n#ifdef COLOR_WITH_COC\n#define DOF_TAP(id) ofs = fTaps_Poisson[id]; \\\n                    ofs = gTexCoord + blurDist * vec2(dot(ofs, basis.xy), dot(ofs, basis.zw) ); \\\n                    sumcol += TEXTURE_2D_TextureDofColor(ofs);\n#else\n#define DOF_TAP(id) ofs = fTaps_Poisson[id]; \\\n                    ofs = gTexCoord + blurDist * vec2(dot(ofs, basis.xy), dot(ofs, basis.zw) ); \\\n                    cocWeight = abs(TEXTURE_2D_TextureDofCoC(ofs).a * 2.0 - 1.0); \\\n                    cocWeight *= cocWeight * cocWeight; \\\n                    sumcol.rgb += TEXTURE_2D_TextureDofColor(ofs).rgb * cocWeight; \\\n                    sumcol.a += cocWeight;\n#endif\n\nvec4 dofBlur16(const in vec2 blurDist, const in float ntime) {\n    float rnd = 6.28 * ditheringNoise(gl_FragCoord.xy, uFrameModTaaSS + ntime);\n\n    float cosa = cos(rnd);\n    float sina = sin(rnd);\n    vec4 basis = vec4(cosa, -sina, sina, cosa);\n\n    vec4 sumcol = vec4(0.0);\n\n    float total = 0.0;\n\n    vec2 fTaps_Poisson[17];\n    // https://github.com/bartwronski/PoissonSamplingGenerator\n    fTaps_Poisson[0] = vec2(0.343280198355, 0.921191856785);\n    fTaps_Poisson[1] = vec2(-0.116859107262, 0.873056831344);\n    fTaps_Poisson[2] = vec2(-0.646421287853, 0.760425284853);\n    fTaps_Poisson[3] = vec2(-0.0437332058416, 0.47196719804);\n    fTaps_Poisson[4] = vec2(0.48240473891, 0.464894594736);\n    fTaps_Poisson[5] = vec2(-0.718897237297, 0.352191304304);\n    fTaps_Poisson[6] = vec2(-0.939061387886, -0.0387376698953);\n    fTaps_Poisson[7] = vec2(0.546569494557, -0.0169516524446);\n    fTaps_Poisson[8] = vec2(-0.182644095652, -0.0702667761349);\n    fTaps_Poisson[9] = vec2(-0.576191305396, -0.252368997099);\n    fTaps_Poisson[10] = vec2(0.921914032366, -0.366530187909);\n    fTaps_Poisson[11] = vec2(-0.0582053944545, -0.510617206206);\n    fTaps_Poisson[12] = vec2(-0.783101528934, -0.601411360136);\n    fTaps_Poisson[13] = vec2(0.430604354377, -0.729559481383);\n    fTaps_Poisson[14] = vec2(-0.350716524868, -0.809522919973);\n    fTaps_Poisson[15] = vec2(0.0600898835968, -0.952568587297);\n    fTaps_Poisson[16] = vec2(0.0, 0.0); // dummy because of intel off-by-one bug\n\n    vec2 ofs;\n    vec4 sampleTex;\n    float cocWeight;\n\n    DOF_TAP(0);\n    DOF_TAP(1);\n    DOF_TAP(2);\n    DOF_TAP(3);\n    DOF_TAP(4);\n    DOF_TAP(5);\n    DOF_TAP(6);\n    DOF_TAP(7);\n    DOF_TAP(8);\n    DOF_TAP(9);\n    DOF_TAP(10);\n    DOF_TAP(11);\n    DOF_TAP(12);\n    DOF_TAP(13);\n    DOF_TAP(14);\n    DOF_TAP(15);\n\n    return sumcol;\n}\n\nvec4 dofBlurCircular() {\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT) {\n        return vec4(0.0);\n    }\n\n    float factor = MAX_BLUR * uDofScale;\n\n#ifdef COLOR_WITH_COC\n    vec2 blurDist = factor * pow(TEXTURE_2D_TextureDofColor(gTexCoord).a, 0.333) / uTextureDofColorSize;\n#else\n    vec2 blurDist = factor * abs(TEXTURE_2D_TextureDofCoC(gTexCoord).a * 2.0 - 1.0) / uTextureDofCoCSize;\n#endif\n\n    // TODO optimize dofBlur16 (unroll...)\n    vec4 sumcol = dofBlur16(blurDist, 0.0); // 16\n    if (uQuality > 0.33) sumcol += dofBlur16(blurDist, 3.0); // 32\n    if (uQuality > 0.66) sumcol += dofBlur16(blurDist, 5.0); // 48\n\n    return vec4(sumcol.rgb / sumcol.a, 1.0);\n}\n'},HMIp:function(e,t){e.exports="float decodeFloatRGBA(const in vec4 rgba) {\n    return dot(rgba, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));\n}\n\nfloat getSingleFloatFromTex(const in sampler2D depths, const in vec2 uv){\n#ifndef _FLOATTEX\n    return  decodeFloatRGBA(texture2D(depths, uv));\n#else\n    return texture2D(depths, uv).x;\n#endif\n}\n\n// simulation of texture2Dshadow glsl call on HW\n// http://codeflow.org/entries/2013/feb/15/soft-shadow-mapping/\nfloat texture2DCompare(const in sampler2D depths,\n                       const in vec2 uv,\n                       const in float compare,\n                       const in vec4 clampDimension){\n    float depth = getSingleFloatFromTex(depths, clamp(uv, clampDimension.xy, clampDimension.zw));\n    return compare - depth;\n}\n\n#ifdef _JITTER_OFFSET\n// TODO could be in a random.glsl file\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/Random.ush#L27\nfloat shadowInterleavedGradientNoise(const in vec2 fragCoord, const in float frameMod) {\n    vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);\n    return fract(magic.z * fract(dot(fragCoord.xy + frameMod * vec2(47.0, 17.0) * 0.695, magic.xy)));\n}\n#endif\n\n// simulates linear fetch like texture2d shadow\nfloat texture2DShadowLerp(\n    const in sampler2D depths,\n    const in vec2 size,\n    const in vec2 uv,\n    const in float compare,\n    const in vec4 clampDimension\n    OPT_ARG_outDistance\n    OPT_ARG_jitter){\n\n    vec2 centroidCoord = uv / size.xy;\n\n#ifdef _JITTER_OFFSET\n    if (jitter > 0.0){\n        centroidCoord += shadowInterleavedGradientNoise(gl_FragCoord.xy, jitter);\n    }\n#endif\n\n    centroidCoord = centroidCoord + 0.5;\n    vec2 f = fract(centroidCoord);\n    vec2 centroidUV = floor(centroidCoord) * size.xy;\n\n    vec4 fetches;\n    const vec2 shift  = vec2(1.0, 0.0);\n    fetches.x = texture2DCompare(depths, centroidUV + size.xy * shift.yy, compare, clampDimension);\n    fetches.y = texture2DCompare(depths, centroidUV + size.xy * shift.yx, compare, clampDimension);\n    fetches.z = texture2DCompare(depths, centroidUV + size.xy * shift.xy, compare, clampDimension);\n    fetches.w = texture2DCompare(depths, centroidUV + size.xy * shift.xx, compare, clampDimension);\n\n#ifdef _OUT_DISTANCE\n    float _a = mix(fetches.x, fetches.y, f.y);\n    float _b = mix(fetches.z, fetches.w, f.y);\n    outDistance = mix(_a, _b, f.x);\n#endif\n\n    vec4 st = step(fetches, vec4(0.0));\n\n    float a = mix(st.x, st.y, f.y);\n    float b = mix(st.z, st.w, f.y);\n    return mix(a, b, f.x);\n}\n"},HNW4:function(e,t){e.exports='#pragma include "utils/functions.glsl"\n\n// used by background.frag\nvec3 textureCubeFixed(const in samplerCube tex, const in vec3 R, const in float size) {\n    vec3 dir = R;\n    float scale = 1.0 - 1.0 / size;\n    // http://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/\n    vec3 absDir = abs(dir);\n    float M = max(max(absDir.x, absDir.y), absDir.z);\n\n    if (absDir.x != M) dir.x *= scale;\n    if (absDir.y != M) dir.y *= scale;\n    if (absDir.z != M) dir.z *= scale;\n\n    return LUVToRGB(textureCube(tex, dir));\n}\n'},HORL:function(e,t,n){"use strict";n("icjm");var i=n("a3nb"),r=n("qRO0"),a=window.ImageBitmap||function(){},o=function(e){r.a.call(this),this._imageObject=void 0,this._url=void 0,this._width=void 0,this._height=void 0,this._dirty=!0,this._mipmap=[],e&&this.setImage(e),this._isGreyscale=void 0};i.a.createPrototypeObject(o,i.a.objectInherit(r.a.prototype,{dirty:function(){this._isGreyscale=void 0,this._dirty=!0},isDirty:function(){return this._dirty},setDirty:function(e){this._dirty=e},getImage:function(){return this._imageObject instanceof o?this._imageObject.getImage():this._imageObject},getURL:function(){return this._url},setURL:function(e){this._url=e},useOrCreateImage:function(e){return e instanceof o==!1?new o(e):e},setImage:function(e){if(!this._url&&e&&(e.src||e.currentSrc)&&(this._url=e.src||e.currentSrc),this._mipmap.length=0,Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)this._mipmap.push(this.useOrCreateImage(e[t]));this.setWidth(this._mipmap[0].getWidth()),this.setHeight(this._mipmap[0].getHeight())}else this._mipmap.push(e);this._imageObject=this._mipmap[0],this.dirty()},isCanvas:function(){return this.getImage()instanceof window.HTMLCanvasElement},isBitmap:function(){return this.getImage()instanceof a},isVideo:function(){return this.getImage()instanceof window.HTMLVideoElement},isImage:function(){return this.getImage()instanceof window.Image},isTypedArray:function(){var e=this.getImage();return e instanceof Uint8Array||e instanceof Float32Array||e instanceof Uint16Array},setWidth:function(e){this._width=e},setHeight:function(e){this._height=e},getWidth:function(){var e=this.getImage();return this.isImage()?e.naturalWidth:this.isVideo()?e.videoWidth:this.isCanvas()||this.isBitmap()?e.width:this._width},getHeight:function(){var e=this.getImage();return this.isImage()?e.naturalHeight:this.isVideo()?e.videoHeight:this.isCanvas()||this.isBitmap()?e.height:this._height},isGreyscale:function(e){if(void 0!==this._isGreyscale)return this._isGreyscale;if(void 0!==this._imageObject&&this.isReady()&&void 0===this._isGreyscale){var t=this._imageObject;this.isCanvas()||(t=document.createElement("canvas"));var n,i,r=t.getContext("2d");t.width=this._imageObject.width,t.height=this._imageObject.height,r.drawImage(this._imageObject,0,0),e||(n=t.width,i=t.height),e>0&&(n=i=e=Math.min(Math.min(t.width,t.height),e));for(var a=!0,o=t.width/n,s=t.height/i,u=0;u<n;u++)for(var l=0;l<i;l++){var c=Math.floor(o*(u+.5)),h=Math.floor(s*(l+.5)),d=r.getImageData(c,h,1,1).data;if(d[0]!==d[1]||d[0]!==d[2]){a=!1;break}}this._isGreyscale=a}return this._isGreyscale},isReady:function(){if(this._imageObject&&this._imageObject instanceof o)return this._imageObject.isReady();if(this.isCanvas()||this.isTypedArray()||this.isBitmap())return!0;if(this.isImage()){var e=this.getImage();if(e.complete)return void 0===e.naturalWidth||0!==e.naturalWidth}if(this.isVideo()&&0!==this.getWidth())return!0;var t=this.getImage();return!!t.complete&&(void 0===t.naturalWidth||0!==t.naturalWidth)},getMipmap:function(){return this._mipmap},hasMipmap:function(){return this._mipmap.length>1},release:function(){this._mipmap.length=0,this._imageObject=void 0}}),"osg","Image"),t.a=o},"Hi2/":function(e,t,n){"use strict";var i={OPAQUE:0};i.OPAQUE_NO_EARLYZ=i.BACKGROUND=1,i.REFRACTION=2,i.TRANSPARENT_CUSTOM_EARLYZ=8,i.TRANSPARENT_NO_EARLYZ_PRE=9,i.TRANSPARENT=10,i.TRANSPARENT_NO_EARLYZ_POST=11,i.EXTRA=19,i.EDITOR_GIZMO=i.HOTSPOT=20,i.GRID=i.TOOLTIP=i.VR_MENU=21,i.WIREFRAME=i.VR_CURSOR=22,i.OUTLINE=23,i.DEBUG=24,i.DEBUG_2=25,t.a=i},"Ht5+":function(e,t){e.exports='#pragma include "utils/encodeDecode.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureDepth;\nuniform int uFirstDepth;\n\nuniform vec2 uTextureDepthSize;\nuniform vec2 uTextureOutputSize;\n\n// For some reasons it requires unpacking *and* repacking to avoid transition between mipmap\nvec4 depthMipmap() {\n    vec2 invSize = 1.0 / uTextureDepthSize;\n    vec4 depths;\n    vec2 offDepth = vec2(0.25, -0.25);\n    if (uFirstDepth == 1) {\n        depths.x = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yy * invSize));\n        depths.y = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xy * invSize));\n        depths.z = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yx * invSize));\n        depths.w = decodeDepth(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xx * invSize));\n    } else {\n        depths.x = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yy * invSize).xyz);\n        depths.y = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xy * invSize).xyz);\n        depths.z = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.yx * invSize).xyz);\n        depths.w = decode24(TEXTURE_2D_TextureDepth(gTexCoord + offDepth.xx * invSize).xyz);\n    }\n\n    return vec4(encode24(min(min(depths.x, depths.y), min(depths.z, depths.w))), 1.0);\n}\n'},HxyN:function(e,t){e.exports='#pragma include "utils/decodeDepth.glsl"\n\nvarying vec2 vTexCoord0;\nvarying vec4 vViewPos;\n\nuniform sampler2D uTextureHotspot;\nuniform vec3 uColor;\n\nuniform sampler2D uTextureDepth;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\nuniform vec2 uNearFar;\n\nconst float BIAS_VISIBILITY = 0.05;\n\nvoid main(void) {\n  float distDepth = distanceToDepth(uTextureDepth, uGlobalTexRatio * gl_FragCoord.xy / uGlobalTexSize, vViewPos, uNearFar);\n  float alpha = distDepth < BIAS_VISIBILITY ? 1.0 : 0.1;\n\n  gl_FragColor = vec4(uColor, 1.0) * texture2D(uTextureHotspot, vTexCoord0);\n  gl_FragColor.a *= alpha;\n\n  gl_FragColor.rgb *= gl_FragColor.a;\n}\n'},"I/i6":function(e,t,n){"use strict";var i=n("jPMi"),r=n("9oTK"),a=n.n(r),o=n("EVdn"),s=n.n(o),u=n("UXvI"),l=n("zmn3"),c=n("OZf9"),h=n("12sq"),d=n("QKgc"),f=n("dZz+"),p=n("QLQS"),g=n("CXDX"),m=n("vBtE"),v=n("eEbW"),_=n("uGjJ"),b=n("DWw0"),S=n("nLHx"),y=n("8v7q"),x=n("6uKY"),C=n("M4AY"),w=p.a.osg,T={FeatureName:"saveUI",ModelName:"Material",ViewListType:[m.a.extend({savingEnabled:!1,constructor:function(){this.onSave=Object(u.a)(this.onSave,1e3),m.a.apply(this,arguments)},initialize:function(){m.a.prototype.initialize.apply(this,arguments),s()(".save-model").click(this.onSave.bind(this));var e=this.options.context;this._features=e.getFeatures();var t=e.getModel();t&&(this.listenTo(t,"status:loaded",this.enableSaving.bind(this)),this.listenTo(t,"status:pending",this.disableSaving.bind(this)))},onSave:function(e){e.preventDefault();var t=C.b.store.getState();C.c.authUser.canAccessFeature("ff_read_only_mode",t)?y.a.showPopup():this.save()},save:function(){var e=this._features.inspector.getModel(),t=e.get("displayView");e.set("displayView","Default");var n=this._save();return n.finally(function(){e.set("displayView",t)}),n},_save:function(){if(!this.savingEnabled)return a.a.reject(new Error("Model is still loading. Please try to save again later."));if(s()(".save-model").hasClass("progress"))return a.a.reject(new Error("Already saving previous changes. Please try to save again later."));s()(".save-model").addClass("progress");var e={modelUID:this.options.context.getModel().get("uid"),userUID:this.options.context.getModel().get("user").uid},t=this,n=[];return this.cancelSave=!1,a.a.all([this.saveBackgroundImages(e,n),this.saveMaterialImages(e,n),this.saveTexturesColorspace(e,n),this.saveHotspots(e,n),this.saveAnimations(e,n),this.saveSounds(e,n),this.saveGroundTexture(e,n)].map(function(e){return e.reflect()})).then(function(){return n.length>0||this.cancelSave?a.a.reject(new Error):t.saveOptions()}.bind(this)).then(function(){return n.length>0?a.a.reject(new Error):a.a.all([t.deleteTextures(n),t.deleteMatcaps(n),t.deleteBackgroundImages(n),t.deleteAnimations(n),t.deleteEnvironments(n),t.deleteGroundTexture(n)].map(function(e){return e.reflect()}))}).then(function(){if(n.length>0)return a.a.reject(new Error);s()(".save-model").removeClass("progress"),s()(".save-model").addClass("success"),setTimeout(function(){s()(".save-model").removeClass("success")},4e3)}.bind(this)).catch(function(e){if(s()(".save-model").removeClass("progress"),e&&503===e.status)y.a.showPopup();else{if(this.cancelSave)return;var t="";if(n.length)t=n.join("<br/>");else{t="An unexpected error happened while saving the following settings : <br/><ul>";var i=e&&e.responseJSON&&e.responseJSON.detail||e&&e.response&&e.response.data.detail;if(i){w.error(i);var r="string"==typeof i?{"":[i]}:i;for(var a in r)t+="<li>&bullet; "+(a?a+": ":"")+r[a].join(", ")+"</li>"}t+="</ul>"}t+='<br/>Contact our support team <a href="'+h.a.hosts.faq+'/requests/new?type=3d_viewing&utm_source=website&utm_campaign=save_error" target="_blank">here</a> if you need help.';var o=new _.default({title:"Error",text:t,buttons:{ok:!0},safe:!0});o.open().then(o.close.bind(o))}}.bind(this))},deleteUnusedResources:function(e,t,n){if(0===e.length)return a.a.resolve();var i="Errors while deleting the following "+t+" :<br/><ul>",r=!1,o=Object(l.a)(e,function(e){return a.a.resolve(e.destroy()).catch(function(t){var n=t&&t.responseJSON&&t.responseJSON.detail;i+="<li>&bullet; "+Object(x.escapeHTML)(e.get("name"))+" : "+n+"</li>",e.trigger("restore",e),r=!0})});return e.length=0,a.a.all(o).then(function(){if(r)return n.push(i+"</ul>"),a.a.reject(new Error)})},deleteTextures:function(e){var t=this._features.material.getModel()._textureTrashbin,n=Object(l.a)(t,function(e){return new g.a({uid:e})});return t.length=0,this.deleteUnusedResources(n,"material textures",e)},deleteMatcaps:function(e){var t=this._features.material.getModel()._matcapTrashbin;return this.deleteUnusedResources(t,"matcap textures",e)},deleteAnimations:function(e){var t=this._features.animation.getModel().get("animations")._trashbin;return this.deleteUnusedResources(t,"animations",e)},deleteEnvironments:function(e){var t=this._features.environment.getModel()._trashbin;return this.deleteUnusedResources(t,"environments",e)},deleteBackgroundImages:function(e){var t=this._features.background.getModel()._trashbin;return this.deleteUnusedResources(t,"backgrounds",e)},deleteGroundTexture:function(e){var t=this._features.ground.getModel()._trashbin;return this.deleteUnusedResources(t,"ground",e)},saveBackgroundImages:function(e,t){var n=this,i=[];return this._features.background.getModel().backgroundCollection.each(function(r){if(r.isNew()){var a=n.saveImage(r,e);a.catch(function(e){var n=0;if(e.responseJSON.detail.imageFile)for(n=0;n<e.responseJSON.detail.imageFile.length;n++)e.responseJSON.detail.imageFile[n].match("The image should be less than 4mb")&&t.push("Background image is too big (max: 4MB)")}),i.push(a)}}),a.a.all(i)},saveGroundTexture:function(e,t){var n=this._features.ground.getModel(),i="BakedAO"===n.get("shadowMode");if(n.get("enable")&&n.get("dirty")&&i){var r=n.get("imageCanvas"),o=Object(S.a)(r.toDataURL("image/jpeg",.95));o.name="internal_ground_ao_texture";var s=new g.a({name:o.name,imageFile:o}),u=this.saveImage(s,e);return u.then(function(){n.set("aoTextureUid",s.get("uid")),n.set("dirty",!1)}),u.catch(function(){t.push("Error while saving the baked AO texture "),n.set("enable",!1)}),a.a.resolve(u)}if(!n.get("enable")||!i){var l=n.get("aoTextureUid");l&&(n._trashbin.push(new g.a({uid:l})),n.set("aoTextureUid",void 0))}return a.a.resolve()},saveImage:function(e,t){return a.a.resolve(e.save(t).then(function(t){e.set("uid",t.uid)}))},_saveImageToBlob:function(e,t,n,i){var r,a=e.getImageModel(),o=e.getMultiresTexture().getImage().getImage();if(o.toBlob){var s=this;o.toBlob(function(e){e.name=t.name,a.set("imageFile",e),n(s.saveImage(a,i))},t.type,.95)}else{if(!o.toDataURL){var u=o;if(o=document.createElement("canvas"),void 0!==u.width)o.width=u.width,o.height=u.height,o.getContext("2d").drawImage(u,0,0);else{var l=o.getContext("2d"),c=e.getImageModel().getImages()[0];o.width=c.width,o.height=c.height;var h=l.getImageData(0,0,c.width,c.height);h.data.set(u),l.putImageData(h,0,0)}}(r=Object(S.a)(o.toDataURL(t.type,.95))).name=t.name,a.set("imageFile",r),n(this.saveImage(a,i))}},saveMaterialImages:function(e,t){var n=this,i=[],r={},o=this._features.material,s="Errors while saving the following texture materials :<br/><ul>",u=!1;return Object(c.a)(o.getModel().attributes,function(t){var o=t.getChannels();Object(c.a)(o,function(t){if(!t.transient){var o=t.getTextureModel();if(o){var l=o.getImageModel();if(l&&l.isNew()){var c=l.getUID();if(1!==r[c]){r[c]=1;var h=new a.a(function(t){var i=l.get("imageFile");if(void 0===i){var r=l.findImageNearestToResolution(16384,16384),a=Object(S.a)(r.url);return l.set("imageFile",a),void t(n.saveImage(l,e))}if(0===i.size)n._saveImageToBlob(o,i,t,e);else if(window.File){var s=new FileReader;s.onload=function(){this.readyState===FileReader.DONE?t(n.saveImage(l,e)):n._saveImageToBlob(o,i,t,e)},s.onerror=function(){n._saveImageToBlob(o,i,t,e)},s.readAsArrayBuffer(i)}});i.push(h.catch(function(e){var t=e&&e.responseJSON&&e.responseJSON.detail;t=t&&t.imageFile&&t.imageFile[0],s+="<li>&bullet; "+Object(x.escapeHTML)(l.get("name"))+" : "+t+"</li>",u=!0}))}}}}})}),a.a.all(i).then(function(){if(u)return t.push(s+"</ul>"),a.a.reject(new Error)})},saveOptions:function(){var e=this.options.context,t=e.getViewer(),n=t.getOptionsJSON(),i=e.getModel();if(t.getFeaturesManager().registerOptionsJSON(n),n.animation)for(var r=this._features.animation.getModel().get("animations")._trashbin,a=0;a<r.length;a++)r[a]&&n.animation.order.splice(a,0,r[a].get("uid"));return i.set({options:n}),v.b.patchModelOptions(i.get("uid"),n)},saveHotspot:function(e,t,n){return e.save(t).catch(function(t){if(n.push("Annotation #"+(+e.get("order")+1)+" could not be saved."),t.responseJSON&&t.responseJSON.detail){var i=0;if(t.responseJSON.detail.name)for(i=0;i<t.responseJSON.detail.name.length;i++)t.responseJSON.detail.name[i].match("This field is required.")?n.push("Title is required."):t.responseJSON.detail.name[i].match("Ensure this value has at most 64 characters")?n.push("Title is too long (64 characters max)."):n.push(t.responseJSON.detail.name[i]);if(t.responseJSON.detail.content)for(i=0;i<t.responseJSON.detail.content.length;i++)t.responseJSON.detail.content[i].match("Ensure this value has at most 1024 characters")?n.push("Description is too long (1024 characters max)."):n.push(t.responseJSON.detail.content[i])}})},deleteHotspot:function(e,t,n,i){return e.remove(t).catch(function(){i.push(e),n.push("An annotation could not be deleted. Please try saving your settings again.")})},saveHotspots:function(e,t){var n=this._features.hotspot.getModel(),i=n.get("hotspots"),r=this.options.context.getModel().toJSON(),o=Object(b.o)(r),s=h.a.maxHotspotsPerModel[o];if(i.length>s)return n.trigger("hotspot-error",new d.e(void 0,"hotspot",i.length,s,f.a.me().toJSON().account)),this.cancelSave=!0,a.a.reject();if(i.models.some(function(e){return!e.get("name")}))return n.trigger("hotspot-error",new Error("All your annotations must have a title")),this.cancelSave=!0,a.a.reject();var u=[],l=this,c=n.hotspotsToBeDeleted.map(function(n){return l.deleteHotspot(n,e,t,u)});return n.hotspotsToBeDeleted=u,a.a.all(c).then(function(){return a.a.all(i.map(function(n){return n.set("order",i.indexOf(n)),l.saveHotspot(n,e,t)}))})},saveTexturesColorspace:function(e,t){var n="Errors while changing the following texture colorspace :<br/><ul>",i=!1,r=[];return this.model.getImageCollection().each(function(e){!e.isNew()&&e.hasChanged("colorSpace")&&r.push(e.saveColorspace().catch(function(t){var r=t&&t.responseJSON&&t.responseJSON.detail;n+="<li>&bullet; "+Object(x.escapeHTML)(e.get("name"))+" : "+r+"</li>",i=!0}))}),a.a.all(r).then(function(){if(i)return t.push(n+"</ul>"),a.a.reject(new Error)})},saveAnimations:function(e,t){var n="Errors while saving the following animations :<br/><ul>",i=!1,r=this._features.animation.getModel().get("animations").map(function(t){return t.save(e).catch(function(e){var r=e&&e.responseJSON&&e.responseJSON.detail;n+="<li>&bullet; "+Object(x.escapeHTML)(t.get("name"))+" : "+r+"</li>",i=!0})});return a.a.all(r).then(function(){if(i)return t.push(n+"</ul>"),a.a.reject(new Error)})},saveSounds:function(e,t){var n=this._features.sound.getModel(),i=n.get("soundtracks"),r=this.options.context.getModel().toJSON(),o=Object(b.o)(r),s=h.a.maxSoundtracksPerModel[o];if(this.maxSoundtracksCount=h.a.maxSoundtracksPerModel[o],i.length>s)return n.trigger("sound-error",new d.e(void 0,"sound",i.length,s,f.a.me().toJSON().account)),this.cancelSave=!0,a.a.reject();var u=!1,l="Errors while saving the following sounds :<br/><ul>",c=a.a.resolve();return i.each(function(t){c=c.then(function(){return t.save(e)}).catch(function(e){var n=e&&e.responseJSON&&e.responseJSON.detail;return n&&n.__all__&&(n=n.__all__[0]),n&&n.soundFile&&(n=n.soundFile[0]),l+="<li>&bullet; "+Object(x.escapeHTML)(t.get("name"))+" : "+n+"</li>",u=!0,a.a.resolve()})}),c.then(function(){if(u)return t.push(l+"</ul>"),a.a.reject(new Error)})},enableSaving:function(){this.savingEnabled=!0,s()(".save-model").removeClass("btn-disabled")},disableSaving:function(){this.savingEnabled=!1,s()(".save-model").addClass("btn-disabled")}})]};t.a=i.a.create(T)},I2mH:function(e,t,n){"use strict";(function(e){var i=n("EVdn"),r=n.n(i),a=n("12sq"),o=["<script>","  (function(d, s, id){","     var js, fjs = d.getElementsByTagName(s)[0];","     if (d.getElementById(id)) {return;}","     js = d.createElement(s); js.id = id;",'     js.src = "//connect.facebook.net/en_US/sdk.js";',"     fjs.parentNode.insertBefore(js, fjs);",'   }(document, "script", "facebook-jssdk"));',"<\/script>"].join(""),s=null;t.a={getSDK:function(){return window.FB?e.resolve(window.FB):s||(s=new e(function(e){var t=r()(o);r()("body").append(t),window.fbAsyncInit=function(){window.FB.init({appId:a.a.facebookAppId,status:!0,cookie:!0,xfbml:!0,version:a.a.facebookApiVersion}),e(window.FB)}}))}}}).call(this,n("CSL1"))},I6qS:function(e,t){e.exports="int decodeProfile(const in vec4 pack) {\n    float packValue = floor(pack.b * 255.0 + 0.5);\n    // we extract the 2 lowest bits\n    float profile = mod(packValue, 2.0);\n    profile += mod(packValue - profile, 4.0);\n    return int(profile);\n}\n\nfloat decodeDepth(const in vec4 pack) {\n    if(decodeProfile(pack) == 0){\n        const vec3 decode = 1.0 / vec3(1.0, 255.0, 65025.0);\n        return dot(pack.rgb, decode);\n    }\n\n    return pack.r + pack.g / 255.0;\n}\n\nfloat decodeScatter(const in vec4 pack) {\n    float scatter = pack.b - mod(pack.b, 4.0 / 255.0);\n    return scatter * 255.0 / 4.0 / 63.0;\n}\n\nfloat decodeAlpha(const in vec4 pack) {\n    return pack.a;\n}\n\nfloat distanceToDepth(const in sampler2D depth, const in vec2 uv, const in vec4 viewPos, const vec2 nearFar) {\n    float fragDepth = clamp( (-viewPos.z * viewPos.w - nearFar.x) / (nearFar.y - nearFar.x), 0.0, 1.0);\n    return fragDepth - decodeDepth(texture2D(depth, uv));\n}\n"},I9Ql:function(e,t){e.exports='#define MIN_ROUGHNESS 0.045\n\nuniform float uRGBMRange;\nuniform int uOutputLinear;\n\nvarying vec4 vViewVertex;\nvarying vec3 vViewNormal;\nvarying vec4 vColor;\n\nuniform float uNormalSign;\nuniform vec3 uAlbedo;\nuniform float uRoughness;\nuniform float uMetalness;\n\nvec3 lightDir = normalize(vec3(0.0, 0.3, 0.9));\nvec3 lightColor = vec3(0.7, 0.7, 0.9);\n\n#pragma include "utils/functions.glsl"\n\n#pragma include "utils/lightsPBR.glsl"\n\nvoid main() {\n    vec3 eyeVector = -normalize(vViewVertex.xyz);\n    vec3 materialNormal = uNormalSign * normalize(gl_FrontFacing ? vViewNormal : -vViewNormal);\n\n    // material\n    float f0 = 0.04;\n    vec3 materialDiffuse = uAlbedo * vColor.r;\n    vec3 materialSpecular = mix(vec3(f0), materialDiffuse, uMetalness);\n    materialDiffuse *= 1.0 - uMetalness;\n    float materialRoughness = max(MIN_ROUGHNESS, uRoughness);\n    float materialF90 = clamp(50.0 * materialSpecular.g, 0.0, 1.0);\n\n    // precompute light\n    float attenuation, dotNL;\n    vec3 eyeLightDir;\n    bool lighted;\n    vec3 lightSpecular;\n    vec3 lightDiffuse;\n    vec4 prepGGX = precomputeGGX(materialNormal, eyeVector, materialRoughness);\n\n    // shading\n    attenuation = 1.0;\n    dotNL = dot(lightDir, materialNormal);\n    computeLightLambertGGX(materialNormal, eyeVector, dotNL, prepGGX, materialDiffuse, materialSpecular, attenuation, lightColor, lightDir, materialF90, lightDiffuse, lightSpecular, lighted);\n\n    vec3 frag = lightDiffuse + lightSpecular;\n    if (uOutputLinear != 1) frag = linearTosRGB(frag);\n    gl_FragColor = encodeRGBM(frag, uRGBMRange);\n}\n'},IJ4l:function(e,t){e.exports="\nuniform float uAlpha;\n\nuniform vec4 uColor;\n\nuniform float uUp;\nuniform float uDown;\n\n#ifdef ICON\n    uniform sampler2D uTextureIcon;\n    varying vec2 vTexCoord0;\n#else\n    varying vec3 pos;\n#endif\n\nvoid main(void) {\n\n    #ifdef ICON\n        gl_FragColor = vec4(uColor.rgb, uAlpha) * texture2D(uTextureIcon, vTexCoord0);\n    #else\n        float alpha = step(pos.x, uUp) * step(uDown, pos.x);\n        gl_FragColor = vec4(uColor.rgb, uAlpha * alpha);\n    #endif\n\n    gl_FragColor.rgb *= gl_FragColor.a;\n}\n"},IKww:function(e,t,n){"use strict";var i=n("JQdh"),r=n("Y14P"),a=n("qCPs"),o=n("QLQS"),s=n("9oTK"),u=n.n(s),l=n("G9Ht"),c=n.n(l),h=n("uPP5"),d=n("xvcl"),f=o.a.osg,p=.2;d.a&&(p=.35);var g=function(e,t,n){var i=n.isNew()?n.get("url"):n.get("files")[0].url;this._src=i,t&&this.setMediaElement(t),this._manager=e,this._model=n,this._mediaElementSource=void 0,this._gain=void 0,this._panner=void 0,this._canPlayDefered=void 0,this._isPlaying=!1,this._seeking=!1,this._duration=void 0,this._isPlayerPendingToPlay=!1,this._doPausePlayerWhenPendingToPlayFinished=void 0,this.pendingToPlayResolvedBound=this.pendingToPlayResolved.bind(this),this.releasePlayerBound=this.releasePlayer.bind(this)};g.prototype={setMediaElement:function(e){this._player=e,this._player.setAttribute("src",this._src),c.a.apple.device||this._player.load(),this._player.addEventListener("ended",this.onEnded.bind(this)),this._player.addEventListener("loadedmetadata",function(e){this._duration=e.currentTarget.duration}.bind(this))},isPlayerPlaying:function(){return!!this._player&&!(!(this._player.currentTime>0)||this._player.paused||this._player.ended)},playerPlay:function(){if(this._player&&!this.isPlayerPlaying()){if(this._isPlayerPendingToPlay)return this._pendingToPlayPromise;var e;this._managerContextVersion=this._manager._releaseSafeCounter;try{e=this._player.play()}catch(e){return this.checkAndHandleDOMError(e),u.a.resolve()}return this._isPlayerPendingToPlay=!0,this._pendingToPlayPromise=e,e||(e=new u.a(function(e){this._player.addEventListener("play",e)}.bind(this))),e.then(this.pendingToPlayResolvedBound).catch(function(e){return e instanceof DOMException&&"The element has no supported sources."===e.message?(this._isPlayerPendingToPlay=!1,void(this._pendingToPlayPromise=void 0)):this.checkAndHandleDOMError(e)?void 0:this._doPausePlayerWhenPendingToPlayFinished||this._managerContextVersion!==this._manager._releaseSafeCounter||this._manager.releasePending?void this.pendingToPlayResolved():(this._isPlayerPendingToPlay=!1,this._pendingToPlayPromise=void 0,void window.setTimeout(this.playerPlay.bind(this),1e3))}.bind(this)),e}},playerPause:function(){return this._gain&&0!==this._gain.gain.value&&this.setGainValue(0),this._doPausePlayerWhenPendingToPlayFinished?this._doPausePlayerWhenPendingToPlayFinished.promise:this._isPlayerPendingToPlay?(this._doPausePlayerWhenPendingToPlayFinished=new h.a,this._doPausePlayerWhenPendingToPlayFinished.promise):(this.isPlayerPlaying()&&this._player&&this._player.pause(),u.a.resolve())},pendingToPlayResolved:function(){this._isPlayerPendingToPlay=!1,this._pendingToPlayPromise=void 0,this._doPausePlayerWhenPendingToPlayFinished&&(this._player&&this._player.pause(),this._doPausePlayerWhenPendingToPlayFinished.resolve(),this._doPausePlayerWhenPendingToPlayFinished=void 0),this.updateVolume()},releasePlayer:function(){this._player=void 0,this._mediaElementSource=void 0},onEnded:function(){this._model.get("loop")||this.pause()},play:function(){this._isPlaying=!0,this.updateVolume()},pause:function(){this._isPlaying=!1,this.updateVolume()},getModel:function(){return this._model},updateVolume:function(){if(this._player)if(this._manager.getIsMute())this.setGainValue(0);else if(this._gain&&this._manager.isTabVisible()){if(void 0===this._model.get("volume")||!this._isPlaying||this._seeking||!this._manager.isPlaying()){if(this._player.muted)return;return f.debug("[SOUND] Volume Change: "+this._model.get("name")+" = 0"),void this.setGainValue(0)}this._volumeReal=this._model.get("volume")*this._manager.getVolume(),this.setGainValue(this._volumeReal)}else this.setGainValue(0)},_seekToSync:function(e){return!!this._player&&(void 0!==this._duration&&this._duration<1.5||(Math.abs(this._player.currentTime-e)>p?this._player.seeking?(this._seeking=!0,!1):(this._player.currentTime=e+.05,this._seeking=!0,!1):!(this._seeking&&!this._player.seeking)||(this._seeking=!1,!0)))},setTime:function(e,t){if(this._manager.canPlay()){if(!this._player||!this._gain){if(!t)return;this.updateFromModel()}if(void 0!==this._duration){var n=this._model.get("loop");if(this._player.loop!==n&&(this._player.loop=n),this.isSoundAsync())n||this._player.currentTime<this._duration?this.play():this.pause();else{var i=e-this._model.get("startTime"),r=i>=0;if(r&&(n?i%=this._duration:r=r&&this._duration>=i),!r)return this.isPlayerPlaying()&&(this._player.currentTime=0,this.playerPause()),void this.pause();this._seekToSync(i)&&this._manager.isPlaying()?(!this.isPlayerPlaying()&&this._manager.isPlaying()&&this.playerPlay(),this.play()):this.pause()}}}},isSoundAsync:function(){return!1===this._manager._hasAnim||!this._model.get("sync")},setRefDistanceNormalized:function(e){this._panner&&(this._panner.refDistance=e/this._manager.getRadius())},setMaxDistanceNormalized:function(e){this._panner&&(this._panner.maxDistance=e/this._manager.getRadius())},setPositionNormalized:function(e){if(this._panner){var t=this._manager.getRadius();this._manager._setPannerPosition(this._panner,e[0]/t,e[1]/t,e[2]/t)}},setLoop:function(){this._player&&(this._player.loop=this._model.get("loop"))},updateFromModel:function(){if(!this._player){var e=this._manager._createAudio();e&&this.setMediaElement(e)}var t;this.setLoop(),t=this._model.get("ambient")?this._manager.connectAmbientSound(this):this._manager.connect3DSound(this),this.isSoundAsync()&&this.play(),t?t.catch(function(e){this.checkAndHandleDOMError(e)}.bind(this)):(this.isSoundAsync()&&this.playerPlay(),this.updateVolume())},checkAndHandleDOMError:function(e){f.debug(e.message);return e instanceof DOMException&&-1!==["Failed to execute 'play' on 'HTMLMediaElement': API can only be initiated by a user gesture.","play() can only be initiated by a user gesture."].indexOf(e.message)&&(this._authErrors=!0,this.pendingToPlayResolved(),this._manager._lock(),!0)},whenReady:function(){if(!this._canPlayDefered){var e=new u.a(function(e){this._player.addEventListener("canplaythrough",e)}.bind(this));this._canPlayDefered=e}return this._canPlayDefered},setGainValue:function(e){if(this._player&&(this._player.muted=e<=0),this._gain){var t=this._gain.gain;if(t.setValueAtTime){var n=this._manager.getOrCreateAudioContext();if(!n)return;t.setValueAtTime(e,n.currentTime)}else t.value=e}}};var m=g,v=n("fgaA"),_=n("6xPH"),b=n("gRsq"),S=o.a.osg,y=function(){if(this._volume=Number(r.a.get("sf_volume",1)),this._sounds=[],this._context=void 0,this._enabled=!1,this._tabVisible=!0,this._isPlaying=!1,this._waiting=!Object(_.a)(),this._muted=!1,this._unlockBound=this._unlock.bind(this),this._lockBound=this._lock.bind(this),this._forcePlayBound=function(){this.forcePlay(this._isPlaying)}.bind(this),this._hasSounds=!1,this._willHaveSounds=void 0,window.AudioContext||window.webkitAudioContext){if(Object(_.a)()&&(this._willHaveSounds=!0),!this._willHaveSounds){var e=Object(v.a)().model;if(!e){var t=window.location.href.match(/\/models\/((.+)(?:\/)+|(.+))/);t&&t.length>3&&(e=t[2]?t[2]:t[3])}e&&a.a.get(e).then(this.checkWillHaveSounds.bind(this))}this._authErrors=this.featureDetectSoundAuthGestureNeeded(),this._resetPlayedOnceFromAuthGesture(),this._enablingAuthAudio=!1,this._firstEnter=!0,this._readyForErrorMessage=new h.a,this._audioContextTriesCount=0,window.addEventListener("beforeunload",this.exit.bind(this)),this._contextClosePending=!1,this._radius=1,i.a.getBoxReady().then(function(){this._radius=i.a.getModelBoxWithoutDisplacement().radius()}.bind(this))}else this._willHaveSounds=!1};y.prototype={release:function(){if(this._context&&!this._releasePending){var e;this._releasePendingPromises=[];for(var t=0;t<this._sounds.length;t++)(e=this.releaseSound(this._sounds[t]))&&this._releasePendingPromises.push(e);var n=this._context.close;n&&((e=this._context.close())?(this._contextClosePending=!0,e.then(function(){this._contextClosePending=!1,this._context=void 0}.bind(this)),this._releasePendingPromises.push(e)):n=!1),this._releasePending=u.a.all(this._releasePendingPromises),this._releasePending.finally(function(){n||(this._context=void 0),this._releasePendingPromises=void 0,this._releasePending=void 0}.bind(this))}},releaseSound:function(e){if(e&&(this.disconnectSound(e),e._mediaElementSource&&(e._mediaElementSource.disconnect(),e._mediaElementSource=void 0),e._player)){e._player.volume=0,e.pause();var t=e.playerPause();return t.then(e.releasePlayerBound),e.isSoundAsync()&&(e._exitTime=e._player.currentTime),e._player=void 0,e.isPlayerPlaying()||e.releasePlayer(),t}},removeSound:function(e){e&&(this.releaseSound(e),this._sounds.splice(this._sounds.indexOf(e),1))},reset:function(){this._releasePending?this._releasePending.then(this.reset.bind(this)):(this._audioContextTriesCount=0,this._hasSounds&&!this._firstEnter&&this.forcePlay(this._isPlaying))},enableTapRequestPopup:function(){this._osdProxyModel&&this._willHaveSounds&&!Object(_.a)()&&this._osdProxyModel.trigger("sound-show","Tap/Click to play sounds",{position:"top",duration:1/0})},exit:function(){this._context&&(this.release(),this._firstEnter=!1,this._lock())},enter:function(){this.reset()},checkWillHaveSounds:function(e){if(void 0!==this._willHaveSounds)return this._willHaveSounds;var t,n=e.get("options").sound;if(!n||!n.soundtracks||!n.soundtracks.length)return this._willHaveSounds=!1,!1;if(!c.a.apple.device)return this._willHaveSounds=!0,!0;for(var i=0,r=n.soundtracks.length;i<r;i++)if(n.soundtracks[i].ambient){t=i;break}return void 0!==t?(n.soundtracks.length>1&&(n.soundtracks.splice(t+1,n.soundtracks.length-t),n.soundtracks.splice(0,t)),this._willHaveSounds=!0,!0):(n.soundtracks.length=0,this._willHaveSounds=!1,!1)},setProxyModel:function(e){this._osdProxyModel=e,this._readyForErrorMessage&&this._readyForErrorMessage.resolve()},getProxyModel:function(){return this._osdProxyModel},getOrCreateAudioContext:function(e){if(this._willHaveSounds&&this._enabled&&(!this._waiting||Object(_.a)())&&this._tabVisible){if(this._context&&!this._contextClosePending)return this._context;var t=window.AudioContext||window.webkitAudioContext;try{return this._context=e?new t:new t({latencyHint:"interactive"}),"suspended"===this._context.state?void this._context.resume().then(function(){this._unlock()}.bind(this)).catch(function(){this._authErrors=!0,this._lock()}.bind(this)):(this._audioContextTriesCount&&this.forcePlay(this._isPlaying),this._context)}catch(e){if(e instanceof TypeError){if(S.debug(e.message),this.getOrCreateAudioContext(!0),this._context)return this._context}else if("An AudioContext in a cross origin iframe must be created or resumed from a user gesture to enable audio output."===e.message)return this._authErrors=!0,this.pendingToPlayResolved(),void this._lock();this._readyForErrorMessage.promise.then(function(){this._audioContextTriesCount++,this._audioContextTriesCount<5?setTimeout(function(){this.getOrCreateAudioContext()}.bind(this),200):this._osdProxyModel.trigger("sound-error",new Error('Your browser can not play additional sounds and this page must be reloaded. If the problem persists, try to restart your browser. <a style="color: -webkit-link; cursor: auto; text-decoration: underline;" href="javascript:window.location.reload()">reload</a>'),{position:"top",duration:1/0})}.bind(this))}return this._context}},_createAudio:function(){var e=document.createElement("audio");return e.loop=!0,e.volume=1,e.muted=!0,e.preload="auto",e.crossOrigin="anonymous",e},addSound:function(e,t){return this._hasSounds=!0,this._playedOnceFromAuthGesture||this._enableAuthAudioListener(this._forcePlayBound),this.canPlay()&&(t||!1===this._hasAnim)&&e.play(),this._sounds.push(e),e},createSound:function(e,t){this._isPlaying=t;var n,i=this._createAudio(e),r=new m(this,i,e);return i&&this.canPlay()&&(n=e.get("ambient")?this.connectAmbientSound(r):this.connect3DSound(r))&&n.then(this._unlockBound).catch(this._lockBound),this.addSound(r,t)},createPreview:function(e){var t=this._createAudio(e),n=new m(this,t,e);return this.connectAmbientSound(n),n},_errorCatchAndTryAgain:function(e){S.debug(e.message),this.exit(),window.setTimeout(function(){this.reset()}.bind(this),500)},_tryCreateMediaElementSource:function(e){if(e._mediaElementSource)return!0;try{return e._mediaElementSource=this._context.createMediaElementSource(e._player),!0}catch(e){return e instanceof DOMException&&"Failed to execute 'createMediaElementSource' on 'BaseAudioContext': AudioContext has been closed."===e.message&&this._errorCatchAndTryAgain(e),!1}},_tryConnectMediaElementSource:function(e,t){try{return e._mediaElementSource.connect(t),!0}catch(e){return this._errorCatchAndTryAgain(e),!1}},_setPannerPosition:function(e,t,n,i){if(e.positionX){var r=this.getOrCreateAudioContext(),a=r?r.currentTime:0;e.positionX.setTargetAtTime(t,a,.016),e.positionY.setTargetAtTime(n,a,.016),e.positionZ.setTargetAtTime(i,a,.016)}else e.setPosition(t,n,i)},_setPannerOrientation:function(e,t,n,i,r,a,o){if(e.forwardX){var s=this.getOrCreateAudioContext(),u=s?s.currentTime:0;e.forwardX.setTargetAtTime(t,u,.016),e.forwardY.setTargetAtTime(n,u,.016),e.forwardZ.setTargetAtTime(i,u,.016),e.upX.setTargetAtTime(r,u,.016),e.upY.setTargetAtTime(a,u,.016),e.upZ.setTargetAtTime(o,u,.016)}else e.setOrientation(t,n,i,r,a,o)},connect3DSound:function(e){var t=this.getOrCreateAudioContext();if(t){this.disconnectSound(e);var n=t.createPanner();if(e._panner=n,n.panningModel="HRTF",n.rolloffFactor=1,n.coneInnerAngle=360,n.coneOuterAngle=0,n.coneOuterGain=0,n.distanceModel=e.getModel().get("distanceModel"),e.setRefDistanceNormalized(e.getModel().get("distance")),e.setMaxDistanceNormalized(e.getModel().get("distanceMax")),e._player||(e._player=this._createAudio(e.getModel())),this._tryCreateMediaElementSource(e)){var i=e._gain?e._gain:t.createGain();if(e._gain=i,e.setGainValue(0),i.connect(n),n.connect(t.destination),this._tryConnectMediaElementSource(e,i))return e.playerPlay()}}},connectAmbientSound:function(e){var t=this.getOrCreateAudioContext();if(t&&(this.disconnectSound(e),e._player||(e._player=this._createAudio(e.getModel())),this._tryCreateMediaElementSource(e))){var n=t.createGain();if(e._gain=n,e.setGainValue(0),n.connect(t.destination),this._tryConnectMediaElementSource(e,n))return e.playerPlay()}},disconnectSound:function(e){e&&(e._panner&&(e._panner.disconnect(),e._panner=void 0),e._gain&&(e._gain.disconnect(),e._gain=void 0))},update:function(){var e=S.vec3.create(),t=S.vec3.create(),n=S.vec3.create();return function(){if(!this._enabled)return!0;var i=this._context,r=this._camera;if(!r||!i)return!0;S.mat4.getLookAt(e,t,n,r.getViewMatrix()),S.vec3.sub(t,t,e),S.vec3.normalize(t,t);var a=this._radius,o=i.listener;return this._setPannerPosition(o,e[0]/a,e[1]/a,e[2]/a),this._setPannerOrientation(o,t[0],t[1],t[2],n[0],n[1],n[2]),!0}}(),getVolume:function(){return this._volume},setCamera:function(e){this._camera=e},setVolume:function(e){var t=0===this._volume;if(this._volume=e,!this._muted&&(r.a.set("sf_volume",e),this.canPlay())){!t&&e>0&&this._lock();for(var n=0,i=this._sounds.length;n<i;n++)this._sounds[n].updateVolume()}},isTabVisible:function(){return this._tabVisible},hide:function(){this._tabVisible=!1,this.exit()},show:function(){this._tabVisible=!0,this.enter()},setEnabled:function(e){e?(this._enabled=!0,this.reset()):(this.exit(),this._enabled=!1)},isEnabled:function(){return this._enabled},setHasAnim:function(e){this._hasAnim=e},_unlockAcknowledge:function(){document.removeEventListener("touchend",this._forcePlayBound,!0),document.removeEventListener("mouseup",this._forcePlayBound,!0),this._playedOnceFromAuthGesture=!0,this._authErrors=this.featureDetectSoundAuthGestureNeeded(),this._osdProxyModel&&this._osdProxyModel.trigger("sound-hide")},_unlock:function(){if(this._enablingAuthAudio=!1,this._context)return this._context.resume(),void this._unlockAcknowledge();var e=this.getOrCreateAudioContext();e&&(e.resume(),this._unlockAcknowledge())},_lock:function(){this._resetPlayedOnceFromAuthGesture(),this._playedOnceFromAuthGesture||this._waiting||this._muted||0===this._volume||(this._enableAuthAudioListener(this._forcePlayBound),this.enableTapRequestPopup())},_enableAuthAudioListener:function(){this._enablingAuthAudio||(this._enablingAuthAudio=!0,document.addEventListener("touchend",this._forcePlayBound,!0),document.addEventListener("mouseup",this._forcePlayBound,!0))},setPlaying:function(e){this._isPlaying=e},isPlaying:function(){return this._isPlaying},forcePlay:function(e){var t=this._sounds.length;if(!t)return this._unlock();for(var n=[],i=0;i<t;i++){var r=this._sounds[i];r.updateFromModel();var a=r.playerPlay();a&&n.push(a),r.isSoundAsync()&&(r.play(),r._exitTime&&(r._player.currentTime=r._exitTime,r._exitTime=void 0))}this._isPlaying=e,this._context&&this._context.resume&&n.push(this._context.resume()),n.length&&u.a.all(n).then(this._unlockBound).catch(function(){S.debug("error on sound play"),this._authErrors=!0,this._lock()}.bind(this))},pause:function(){for(var e=0;e<this._sounds.length;e++){var t=this._sounds[e];t.isSoundAsync()||t.pause()}this._isPlaying=!1},getPlayedOnceFromAuthGesture:function(){return this._playedOnceFromAuthGesture},_resetPlayedOnceFromAuthGesture:function(){this._playedOnceFromAuthGesture=!this._authErrors||Object(v.a)().isApp||Object(b.a)(),this._playedOnceFromAuthGesture||(this._playedOnceFromAuthGesture=!1,this._enabled&&this._hasSounds&&(this._playedOnceFromAuthGesture=!this._authErrors))},canPlay:function(){return this._enabled&&!this._releasePending&&!this._waiting&&this._tabVisible},setWaiting:function(e){this._waiting=e,e&&this._lock()},getRadius:function(){return this._radius},featureDetectSoundAuthGestureNeeded:function(){if(window.navigator.userActivation){var e=window.navigator.userActivation.hasBeenActive||window.navigator.userActivation.isActive;return e||(this._authErrors=!0,this._lock()),e}var t=document.createElement("audio");try{return t.pause(),t.play().catch(function(e){e instanceof DOMException&&"NotAllowedError"===e.name&&(this._authErrors=!0,this._lock())}.bind(this)),t.paused}catch(e){return S.debug(e),!0}},setMute:function(e){if(this.canPlay()){this._muted=e;for(var t=0,n=this._sounds.length;t<n;t++)this._sounds[t].updateVolume();this._muted||this._lock()}},getIsMute:function(){return this._muted}};var x=new y;t.a=x},IOM8:function(e,t){e.exports='uniform vec3 uColor;\nuniform float uAlpha;\nuniform int uOutputLinear;\n\nvarying float vHeight;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n  vec4 color = vec4(uColor, 1.0) * uAlpha * smoothstep(1.0, 0.0, pow(vHeight, 0.3));\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'},IOd0:function(e,t,n){"use strict";t.a={name:"OpenSceneGraph",version:"0.2.9",author:"Cedric Pinson <trigrou@trigrou.com> (http://cedricpinson.com)"}},IOyo:function(e,t,n){"use strict";n.d(t,"c",function(){return l}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return h});var i=n("Wgwc");n.d(t,"a",function(){return i});var r=n("jxkT"),a=n("QgiU"),o=60,s=60*o,u=24*s;i.extend(r),i.extend(a);i.extend(function(e,t,n){t.prototype.isValid=function(){return!isNaN(this.$s)},n.utc=function(e){return i(function(e){if("number"==typeof e)return e;var t=new Date(e);return t.getTime()-60*t.getTimezoneOffset()*1e3}(e))};var r=t.prototype.format;t.prototype.format=function(){if(!this.isValid())return this.toString();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.call.apply(r,[this].concat(t))}});var l=function(e){return i.utc(e).fromNow()};function c(e){var t=i(),n=Math.max(i.utc(e).diff(t,"second"),0);if(!Number.isNaN(n)){var r=n%u,a=r%s,l=a%o;return{days:(n-r)/u,hours:(r-a)/s,mins:(a-l)/o,secs:l}}console.error("Invalid date: ".concat(e,", causes NaN"))}var h=function(e,t){return i.utc(e).format(t)}},IZz7:function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/notification.jinja"]={root:function(e,t,n,i,r){var a="";try{a+="\n\n";var o=i.makeMacro(["type","content"],["options"],function(r,a,o){var s=n;n=new i.Frame,(o=o||{}).hasOwnProperty("caller")&&n.set("caller",o.caller),n.set("type",r),n.set("content",a),n.set("options",o.hasOwnProperty("options")?o.options:{});var u,l="";return l+="\n\n    ",u=e.getFilter("merge").call(t,{safecontent:!1},i.contextOrFrameLookup(t,n,"options")),n.set("options",u,!0),n.topLevel&&t.setVariable("options",u),n.topLevel&&t.addExport("options",u),l+='\n\n    <div class="flashmessage notification ',l+=i.suppressValue(r,e.opts.autoescape),l+='">\n        <div class="inner">\n            <button class="flashmessage-close" data-action="close" title="Close"></button>\n            <div class="message">\n                ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"safecontent")?(l+="\n                    ",l+=i.suppressValue(e.getFilter("safe").call(t,a),e.opts.autoescape),l+="\n                "):(l+="\n                    ",l+=i.suppressValue(a,e.opts.autoescape),l+="\n                "),l+="\n            </div>\n        </div>\n    </div>\n\n",n=s,new i.SafeString(l)});t.addExport("flashmessage"),t.setVariable("flashmessage",o),r(null,a+="\n")}catch(e){r(i.handleError(e,null,null))}}}},IlCM:function(e,t,n){"use strict";function i(e,t){return void 0!==e[t]}n.d(t,"a",function(){return i})},JBIC:function(e,t,n){"use strict";var i=n("QLQS"),r=n("kZIE"),a=i.a.osg,o=["Inspector","Matcap","Displacement","Opacity","SubsurfaceScattering","SubsurfaceTranslucency","DiffuseColor","DiffusePBR","AlbedoPBR","ClearCoat","ClearCoatRoughness","ClearCoatNormalMap","SpecularColor","DiffuseIntensity","SpecularPBR","MetalnessPBR","GlossinessPBR","RoughnessPBR","NormalMap","BumpMap","AOPBR","EmitColor","CavityPBR","SpecularHardness","SpecularF0","Anisotropy"],s=function(e){switch(e){case"DiffuseColor":case"DiffuseIntensity":case"SpecularColor":case"NormalMap":case"EmitColor":case"DiffusePBR":case"AlbedoPBR":case"SpecularPBR":case"Matcap":case"Inspector":case"ClearCoatNormalMap":case"Anisotropy":return a.Texture.RGB;case"SpecularHardness":case"BumpMap":case"GlossinessPBR":case"RoughnessPBR":case"MetalnessPBR":case"SpecularF0":case"AOPBR":case"CavityPBR":case"Displacement":case"SubsurfaceScattering":case"SubsurfaceTranslucency":case"ClearCoat":case"ClearCoatRoughness":return a.Texture.LUMINANCE;case"Opacity":return a.Texture.ALPHA;default:return console.error("unknown channel: "+e),a.Texture.RGB}},u=function(e){if("Anisotropy"===e)return"rg";var t=s(e);return t===a.Texture.RGB?"rgb":t===a.Texture.LUMINANCE?"r":t===a.Texture.ALPHA?"a":"rgba"},l=function(e){for(var t={},n=0,i=o.length;n<i;++n){var r=o[n];t[r]=e(r)}return function(e){return t[e]}};o.getShadingMask=l(function(e){switch(e){case"Matcap":return r.a.MATCAP;case"SubsurfaceScattering":case"SubsurfaceTranslucency":return r.a.LIT;case"Opacity":case"Displacement":return r.a.LIT|r.a.SHADELESS|r.a.MATCAP|r.a.INSPECTOR;case"EmitColor":return r.a.LIT|r.a.SHADELESS;case"NormalMap":case"BumpMap":return r.a.LIT|r.a.MATCAP;case"DiffusePBR":case"AlbedoPBR":case"AOPBR":case"CavityPBR":return r.a.PBR;case"SpecularPBR":case"MetalnessPBR":case"GlossinessPBR":case"RoughnessPBR":case"SpecularF0":case"ClearCoat":case"ClearCoatRoughness":case"ClearCoatNormalMap":case"Anisotropy":return r.a.PBR_LIT;case"DiffuseColor":case"DiffuseIntensity":return r.a.CLASSIC;case"SpecularColor":case"SpecularHardness":return r.a.CLASSIC_LIT;case"Inspector":return r.a.INSPECTOR}}),o.isSRGB=l(function(e){switch(e){case"DiffuseColor":case"DiffusePBR":case"AlbedoPBR":case"EmitColor":case"SpecularColor":case"SpecularPBR":case"Matcap":case"Inspector":return!0;default:return!1}}),o.getDefaultFormatEnum=l(s),o.getDefaultFormatComponent=l(u),o.getDefaultFormatString=l(function(e){var t=s(e);return t===a.Texture.RGB?"RGB":t===a.Texture.LUMINANCE?"LUMINANCE":t===a.Texture.ALPHA?"ALPHA":"RGBA"}),o.getDefaultComponentCount=l(function(e){return u(e).length}),o.getPossibleFormat=l(function(e){var t={};switch(e){case"NormalMap":case"SpecularPBR":case"ClearCoatNormalMap":case"Anisotropy":t.RGB="RGB";break;case"SpecularHardness":case"BumpMap":case"GlossinessPBR":case"RoughnessPBR":case"MetalnessPBR":case"SpecularF0":case"AOPBR":case"CavityPBR":case"Displacement":case"SubsurfaceScattering":case"SubsurfaceTranslucency":case"ClearCoat":case"ClearCoatRoughness":t.LUMINANCE="Luminance";break;case"DiffuseColor":case"DiffuseIntensity":case"SpecularColor":case"EmitColor":case"DiffusePBR":case"AlbedoPBR":case"Matcap":case"Inspector":t.LUMINANCE="Luminance",t.RGB="RGB";break;case"Opacity":t.ALPHA="Alpha",t.LUMINANCE="Luminance";break;default:return console.error("unknown channel: "+e),a.Texture.RGB}return t}),o.getPossibleFiltering=l(function(e){var t={};return"Displacement"!==e&&(t.LINEAR_MIPMAP_LINEAR="Trilinear (best)",t.NEAREST_MIPMAP_LINEAR="Nearest (mipmap)"),t.LINEAR="Bilinear",t.NEAREST="Nearest",t}),o.getColorPacking=l(function(e){switch(e){case"DiffuseColor":case"DiffusePBR":case"AlbedoPBR":case"Inspector":return 0;case"EmitColor":return 1;case"SpecularColor":case"SpecularPBR":return 2;case"DiffuseIntensity":return 3;default:return-1}}),o.getBoxFactor=l(function(e){return"SubsurfaceScattering"===e?.2:"SubsurfaceTranslucency"===e?.2:"Displacement"===e?1:-1}),t.a=o},JFXa:function(e,t,n){"use strict";var i=n("YfG3"),r=n("4kdM"),a=n("gySG"),o=n("ozxe"),s=n("gBaA");t.a=o.a.extend({el:['<div class="widget slider-widget volume-slider-widget">','          <div class="widget-wrapper">','              <a class="fa fa-volume-up"></a>','              <div class="bar">','                  <div class="slide">','                      <div class="cursor"></div>',"                  </div>","              </div>","          </div>","      </div>"].join(""),events:Object(i.a)({},o.a.prototype.events,{"click .fa":"onoff","touchstart .fa":"onoff"}),constructor:function(e,t){t=Object(r.a)(t||{},{name:"volume",minimum:0,maximum:1,step:.1}),o.a.prototype.constructor.call(this,e,t)},initialize:function(){o.a.prototype.initialize.apply(this,arguments),this.isMute=0===this.get(),this.value=this.get(),this.model.on("change:"+this.options.name,Object(a.a)(function(){0===this.get()?(this.isMute=!0,this.mute(this.$(".fa"))):this.isMute&&(this.isMute=!1,this.unmute(this.$(".fa")))}.bind(this)))},mute:function(e){e.removeClass("fa-volume-up").addClass("fa-volume-off")},unmute:function(e){e.removeClass("fa-volume-off").addClass("fa-volume-up")},onoff:function(){this.isMute?(0!==this.value&&null!==this.value||(this.value=1),this.model.set("mute",!1),this.set(this.value),this.model.set("playing",!0),s.a.modelViewerMuteButtonClicked(0)):(this.value=this.get(),this.set(0),this.model.set("mute",!0),s.a.modelViewerMuteButtonClicked(1))},cursorDrag:function(){o.a.prototype.cursorDrag.apply(this,arguments),this.value=null}})},"JJ+t":function(e,t,n){"use strict";var i=n("IzLi"),r=n("4kdM"),a=n("YfG3"),o=n("CpTu"),s=n("EVdn"),u=n.n(s),l=n("q1z7"),c=n.n(l),h=n("imBb"),d=function(e,t){if(Array.isArray(e))this.shortcuts=e||[];else{if(!Object(i.a)(e))throw new Error("Shortcut manager needs a shortcut object to function");this.shortcutGroup=e,this.shortcuts=e.shortcuts||[]}this.options=t||{},this.handlers={},this.options=Object(r.a)({},this.options,{listen:!1}),this.options.listen&&this.listen()},f=new(n.n(h).a);f.stopCallback=function(e,t){return!((" "+t.className+" ").indexOf(" mousetrap ")>-1)&&("button"===document.activeElement.tagName.toLowerCase()||("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.contentEditable&&"true"===t.contentEditable))},Object(a.a)(d.prototype,c.a.Events),d.prototype.listen=function(e){void 0===e?this.shortcuts.forEach(this._listen.bind(this)):Array.isArray(e)?(this.shortcuts=this.shortcuts.concat(e),e.forEach(this._listen.bind(this))):this._listen(e)},d.prototype.stopListening=function(e){e.forEach(function(e){f.unbind(this._getShortcut(e).keyCombinations),delete this.handlers[e]}.bind(this))},d.prototype.getTitle=function(){return this.shortcutGroup&&this.shortcutGroup.name||""},d.prototype.getShortcut=function(e){return this.shortcuts.filter(function(t){return t.id===e})[0]||""},d.prototype.getShortDescriptionById=function(e){var t="";return this.shortcuts.forEach(function(n){n.id===e&&(t=this._formatKeyCombination(n.keyCombinations).replace("<br />",""))}.bind(this)),t},d.prototype.generateHelpSection=function(){var e=u()("<div />"),t=this.getTitle();return t&&e.append('<span class="title">'+t+"</span>"),this.shortcuts.filter(this._validate).forEach(function(t){t.name&&e.append("<b>"+t.name+"</b>"),e.append(this._formatKeyCombination(t.keyCombinations))}.bind(this)),e.html()||""},d.prototype.hasKeyCombination=function(e){var t=!1;return this.shortcuts.forEach(function(n){t||(Array.isArray(n.shortcuts)?n.shortcuts.forEach(function(n){t=n===e}):t=n.shortcuts===e)}),t},d.prototype._formatKeyCombination=function(e){return[].concat(e).map(function(e){return"<kbd>"+e+"</kbd>"}).join(" or ")+"<br />"},d.prototype._listen=function(e){this._validate(e)&&!this.handlers[e.id]&&(this.handlers[e.id]=this._notify.bind(this,e),f.bind(e.keyCombinations,this.handlers[e.id]))},d.prototype._getShortcut=function(e){return Object(o.a)(this.shortcuts,function(t){return t.id===e})},d.prototype._validate=function(e){return!!e.keyCombinations&&!!e.id},d.prototype._notify=function(e,t){this.trigger(e.id,e,t)},t.a=d},JLE6:function(e,t,n){"use strict";var i=n("a3nb"),r=n("czSk"),a=n("7E8H"),o=function(){a.a.call(this),this._stackedTransforms=[],this._matrix=r.c.create(),this._dirty=!1};i.a.createPrototypeObject(o,i.a.objectInherit(a.a.prototype,{getStackedTransforms:function(){return this._stackedTransforms},setMatrix:function(e){r.c.copy(this._matrix,e),this._dirty=!0},getMatrix:function(){return this._matrix},computeChannels:function(){this._dirty=!0;var e=this._matrix;r.c.identity(e);for(var t=this._stackedTransforms,n=0,i=t.length;n<i;n++){t[n].applyToMatrix(e)}},reset:function(){for(var e=this._stackedTransforms,t=0,n=e.length;t<n;t++)e[t].resetToDefaultValue();this.computeChannels()},update:function(e){return r.c.copy(e.getMatrix(),this._matrix),this._dirty&&(e.dirtyBound(),this._dirty=!1),!0}}),"osgAnimation","UpdateMatrixTransform"),t.a=o},JNWj:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Vx0a"),a=n("r7P/"),o=n("czSk"),s=n("6JLc"),u=function(){r.a.call(this),this._radius=-1,this._range=[],this._rangeMode=u.DISTANCE_FROM_EYE_POINT,this._userDefinedCenter=[],this._centerMode=u.USE_BOUNDING_SPHERE_CENTER};u.DISTANCE_FROM_EYE_POINT=0,u.PIXEL_SIZE_ON_SCREEN=1,u.USE_BOUNDING_SPHERE_CENTER=0,u.USER_DEFINED_CENTER=1,u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED=2,i.a.createPrototypeNode(u,i.a.objectInherit(r.a.prototype,{getRadius:function(){return this._radius},setRadius:function(e){this._radius=e},setCenter:function(e){this._centerMode!==u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED&&(this._centerMode=u.USER_DEFINED_CENTER),this._userDefinedCenter=e},getCenter:function(){return this._centerMode===u.USER_DEFINED_CENTER||this._centerMode===u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED?this._userDefinedCenter:this.getBound().center()},setCenterMode:function(e){this._centerMode=e},computeBoundingSphere:function(e){if(this._centerMode===u.USER_DEFINED_CENTER&&this._radius>=0)return e.set(this._userDefinedCenter,this._radius),e;if(this._centerMode===u.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED&&this._radius>=0){e.set(this._userDefinedCenter,this._radius);var t=new s.a;return e.expandByBoundingSphere(r.a.prototype.computeBoundingSphere.call(this,t)),e}return r.a.prototype.computeBoundingSphere.call(this,e),e},projectBoundingSphere:function(){var e=o.f.create();return function(t,n,i){o.f.transformMat4(e,t.center(),n);var r=t.radius2(),a=e[2]*e[2],s=o.f.sqrLen(e);return-Math.PI*i*i*r*Math.sqrt(Math.abs((s-r)/(r-a)))/(r-a)}}(),setRangeMode:function(e){this._rangeMode=e},addChildNode:function(e){if(r.a.prototype.addChild.call(this,e),this.children.length>this._range.length){var t=[],n=0;this._range.lenght>0&&(n=this._range[this._range.length-1][1]),t.push(o.e.fromValues(n,n)),this._range.push(t)}return!0},addChild:function(e,t,n){if(r.a.prototype.addChild.call(this,e),this.children.length>this._range.length){var i=[];i.push(o.e.fromValues(t,t)),this._range.push(i)}return this._range[this.children.length-1][0]=t,this._range[this.children.length-1][1]=n,!0},traverse:function(){var e=o.f.create(),t=o.f.create(),n=o.c.create();return function(i){switch(i.traversalMode){case a.a.TRAVERSE_ALL_CHILDREN:for(var r=0;r<this.children.length;r++)this.children[r].accept(i);break;case a.a.TRAVERSE_ACTIVE_CHILDREN:var s=0,l=i.getCurrentModelViewMatrix();if(o.c.invert(n,l),this._rangeMode===u.DISTANCE_FROM_EYE_POINT){o.f.transformMat4(t,e,n),s=o.f.distance(this.getBound().center(),t)*i.getLODScale()}else{var c=i.getCurrentProjectionMatrix();s=(s=this.projectBoundingSphere(this.getBound(),l,c[0]))*i.getViewport().width()*i.getViewport().width()*.25/i.getLODScale()}var h=this.children.length;this._range.length<h&&(h=this._range.length);for(var d=0;d<h;++d)this._range[d][0]<=s&&s<this._range[d][1]&&this.children[d].accept(i)}}}()}),"osg","Lod"),t.a=u},JPvX:function(e,t){e.exports="uniform vec3 uColorDebug;\n\nvoid main(void) {\n   gl_FragColor = vec4(uColorDebug, 1.0);\n}\n"},JQdh:function(e,t,n){"use strict";var i=n("QLQS"),r=i.a.osg,a=function(){r.ComputeBoundsVisitor.call(this),this._minBox=new r.BoundingBox,this._visitedBuffers={}};r.createPrototypeObject(a,r.objectInherit(r.ComputeBoundsVisitor.prototype,{getPreciseBox:function(){return this._minBox},apply:function(e){if(e instanceof r.Transform)this.applyTransform(e);else{if(e instanceof r.Geometry){var t=this._matrixStack.getLength()>0?this._matrixStack.back():r.mat4.IDENTITY,n=e.getVertexAttributeList().Vertex,i=this._visitedBuffers[n.getInstanceID()];if(i&&r.mat4.exactEquals(i.matrix,t))return;var a=e.computeTransformedVertices?e.computeTransformedVertices():n.getElements();this._visitedBuffers[n.getInstanceID()]={buffer:a,matrix:r.mat4.copy(r.mat4.create(),t)};for(var o=t[0],s=t[1],u=t[2],l=t[3],c=t[4],h=t[5],d=t[6],f=t[7],p=t[8],g=t[9],m=t[10],v=t[11],_=t[12],b=t[13],S=t[14],y=t[15],x=1/0,C=1/0,w=1/0,T=-1/0,M=-1/0,E=-1/0,A=0,O=a.length;A<O;A+=3){var R=a[A],P=a[A+1],I=a[A+2],N=l*R+f*P+v*I+y||1,L=(o*R+c*P+p*I+_)/N,k=(s*R+h*P+g*I+b)/N,D=(u*R+d*P+m*I+S)/N;L<x&&(x=L),k<C&&(C=k),D<w&&(w=D),L>T&&(T=L),k>M&&(M=k),D>E&&(E=D)}var F=this._minBox.getMin(),V=this._minBox.getMax();return x<F[0]&&(F[0]=x),C<F[1]&&(F[1]=C),w<F[2]&&(F[2]=w),T>V[0]&&(V[0]=T),M>V[1]&&(V[1]=M),void(E>V[2]&&(V[2]=E))}this.traverse(e)}}}));var o,s,u=a,l=n("uPP5"),c=i.a.osg,h=0,d=new l.a,f={BIAS_MIN:.9,BIAS_MAX:1.1,getBoxReady:function(){return d.promise},updateMaxWorldDisplacement:function(e){e<=h||(h=e,this._updateModelBoxes())},getModelBoxWithDisplacement:function(){return o},getModelBoxWithoutDisplacement:function(){return s},_updateModelBoxes:function(){if(o){var e=o.getMin(),t=o.getMax(),n=c.vec3.fromValues(h,h,h);c.vec3.add(t,t,n),c.vec3.sub(e,e,n)}},computePreciseBox:function(e){var t=new u;e.accept(t),s=t.getPreciseBox(),(o=new c.BoundingBox).copy(s),this._updateModelBoxes(),d.resolve()},getMaxDistanceFromOrigin:function(){var e=c.vec3.length(s.getMin()),t=c.vec3.length(s.getMax());return Math.max(e,t)}};t.a=f},JW7N:function(e,t,n){"use strict";var i=n("lSNA"),r=n.n(i),a=n("EVdn"),o=n.n(a),s=n("vJtL"),u=n("Ui7z"),l=n("oR1v"),c=Symbol("windowCallbackKey");t.a={name:"WithWindowEvents",constructor:function(){var e=this;this[c]={listeners:[]},this.events=Object(u.e)(this.events,function(t,n){var i=Object(l.e)(n);if("window"!==i.selector)return r()({},n,t);if("string"==typeof t&&!e[t])throw new Error("WithWindowEvents error: "+e.displayName+"."+t+" is not defined.");return e[c].listeners.push({eventName:i.eventName,callback:function(){for(var n,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return Object(s.a)(t)?t.call.apply(t,[e].concat(r)):(n=e[t]).call.apply(n,[e].concat(r))}}),{}})},delegateEvents:function(){this[c].listeners.forEach(function(e){o()(window).on(e.eventName,e.callback)})},undelegateEvents:function(){this[c].listeners.forEach(function(e){o()(window).off(e.eventName,e.callback)})},beforeRemove:function(){this[c].listeners.forEach(function(e){o()(window).off(e.eventName,e.callback)})}}},Ja3s:function(e,t,n){"use strict";var i=n("9mpE"),r=n("Y14P"),a=n("dZz+"),o=n("12sq"),s=n("eEbW");t.a={track:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.b.trackMixpanelEvent(e,t)},getLastTouchUtms:function(){var e={utm_source:i.c.string("utm_source"),utm_medium:i.c.string("utm_medium"),utm_campaign:i.c.string("utm_campaign"),utm_content:i.c.string("utm_content"),utm_term:i.c.string("utm_term")};return Object.values(e).some(function(e){return!!e})?e:void 0},getAcquisitionChannel:function(){if(document.referrer){var e=document.createElement("a");return e.href=document.referrer,e.hostname}return"Direct"},getTrackingId:function(){return JSON.stringify({user_id:"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),acquisition_channel:this.getAcquisitionChannel()})},initializeCookies:function(){a.a.me().isAuthenticated()?r.a.remove(o.a.userTrackingCookie):r.a.get(o.a.userTrackingCookie)||r.a.set(o.a.userTrackingCookie,this.getTrackingId());var e=this.getLastTouchUtms();e&&r.a.set(o.a.campaignTrackingCookie,JSON.stringify(e),{expires:864e5}),r.a.get(o.a.campaignTrackingCookie)&&a.a.me().isAuthenticated()&&s.b.registerUTM().then(function(){r.a.remove(o.a.campaignTrackingCookie)})}}},Ji7B:function(e,t){e.exports="(function webpackUniversalModuleDefinition(root, factory) {\n  if(typeof exports === 'object' && typeof module === 'object')\n    module.exports = factory();\n  else if(typeof define === 'function' && define.amd)\n    define([], factory);\n  else {\n    var a = factory();\n    for(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n  }\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/  // The module cache\n/******/  var installedModules = {};\n\n/******/  // The require function\n/******/  function __webpack_require__(moduleId) {\n\n/******/    // Check if module is in cache\n/******/    if(installedModules[moduleId])\n/******/      return installedModules[moduleId].exports;\n\n/******/    // Create a new module (and put it into the cache)\n/******/    var module = installedModules[moduleId] = {\n/******/      exports: {},\n/******/      id: moduleId,\n/******/      loaded: false\n/******/    };\n\n/******/    // Execute the module function\n/******/    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/    // Flag the module as loaded\n/******/    module.loaded = true;\n\n/******/    // Return the exports of the module\n/******/    return module.exports;\n/******/  }\n\n\n/******/  // expose the modules object (__webpack_modules__)\n/******/  __webpack_require__.m = modules;\n\n/******/  // expose the module cache\n/******/  __webpack_require__.c = installedModules;\n\n/******/  // __webpack_public_path__\n/******/  __webpack_require__.p = \"\";\n\n/******/  // Load entry module and return exports\n/******/  return __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n  'use strict';\n\n  var decompressor = __webpack_require__( 1 );\n\n  /*jshint worker: true */\n\n  self.onmessage = function ( event ) {\n      var input = event.data;\n      var result = decompressor.decompress( input.buffer );\n\n      var img = new Uint8Array( result.img.buffer );\n      var width = result.width;\n      var height = result.height;\n\n      if ( input.swizzle ) {\n          var nbComponents = input.nbComponents || 3;\n          var nbPixel = width * height * 4;\n          for ( var i = 0, j = 0; i < nbPixel; i += 4, j += nbComponents ) {\n              var r = img[ i ];\n              var a = img[ i + 3 ];\n\n              var x = ( r / 255.0 ) * 2.0 - 1.0;\n              var y = ( a / 255.0 ) * 2.0 - 1.0;\n              var z = Math.sqrt( 1.0 - x * x - y * y );\n              z = Math.round( ( z * 0.5 + 0.5 ) * 255.0 );\n\n              img[ j ] = r;\n              img[ j + 1 ] = a;\n              img[ j + 2 ] = z;\n          }\n\n          img = img.subarray( 0, width * height * nbComponents );\n      }\n\n      postMessage( {\n          img: img,\n          width: width,\n          height: height,\n          uid: input.uid || 'uid'\n      }, [ img.buffer ] );\n  };\n\n  /*jshint worker: false */\n\n  module.exports = {\n      astcDecompressor: decompressor\n  };\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n  'use strict';\n\n  var precompute = __webpack_require__(2);\n  var cacheUnquantizeSimple = precompute.cacheUnquantizeSimple;\n  var cacheUnquantizeTrits = precompute.cacheUnquantizeTrits;\n  var cacheUnquantizeQuints = precompute.cacheUnquantizeQuints;\n  var cacheDecodeSimple = precompute.cacheDecodeSimple;\n  var cacheDecodeTrits = precompute.cacheDecodeTrits;\n  var cacheDecodeQuints = precompute.cacheDecodeQuints;\n\n  var bitUtils = __webpack_require__(3);\n  var popCount = bitUtils.popCount;\n  var readBits = bitUtils.readBits;\n  var writeBits = bitUtils.writeBits;\n  var extractBits = bitUtils.extractBits;\n  var replicateBits = bitUtils.replicateBits;\n  var bitTransferSigned = bitUtils.bitTransferSigned;\n  var reverseU8Array = bitUtils.reverseU8Array;\n\n\n  // Counting how many bits have been read for each block\n  // the value is reseted when computing a new block\n  var bitsReadCount = 0;\n  // Counting how many bits have been written\n  // useful when extracting color endpoint data\n  var bitsWrittenCount = 0;\n  // Counting how many bits have been read in the\n  // current block color data stream\n  var colorDataBitsRead = 0;\n  // Keeping track of the current index\n  // when calling the computeEndpoints routine\n  var decodedColorValuesIdx = 0;\n\n  // Contains the information\n  // of the current processed block\n  var CURRENT_BLOCK_INFO = {};\n  // Describes how trit/quint/bit is packed\n  // for a single encoded integer in the maxWeightQuintsTritsMapper\n  var TRIT_IDX = 0;\n  var QUINT_IDX = 1;\n  var BIT_IDX = 2;\n\n  // Maximum number of encoded values = 288\n  var resultDecodedStorage = new Uint16Array(288 * 6);\n  var subDecodedValue = new Array(8);\n  var classSelectorBitsArray = new Uint8Array(4);\n  var colorModeLSB = new Uint8Array(4);\n  var texelWeightData = new Uint8Array(16);\n  var colorEndpointData = new Uint8Array(16);\n  var endpoints = new Uint8Array(4 * 2 * 4);\n  var blockPixelsOutput = null;\n\n  /**\n   * Encodes a given value into its quints/trits/bits representation\n   * @param  {uint} val the value to encode\n   * @return {Object} contains the number of trits/quints/bits to encode the given value.\n   */\n  var getEncodedInteger = function(val) {\n    var encodedInt = {\n      trits: 0,\n      quints: 0,\n      bits: 0,\n      tritValue: 0,\n      quintValue: 0,\n      bitValue: 0\n    };\n    while (val > 0) {\n      var check = val + 1;\n\n      if (!(check & (check - 1))) {\n        encodedInt.bits = popCount(val);\n        return encodedInt;\n      }\n      if ((check % 3 === 0) && !(Math.floor(check / 3) & Math.floor((check / 3) - 1))) {\n        encodedInt.bits = popCount(Math.floor(check / 3 - 1));\n        encodedInt.trits = 1;\n        return encodedInt;\n      }\n      if ((check % 5 === 0) && !(Math.floor(check / 5) & Math.floor((check / 5) - 1))) {\n        encodedInt.bits = popCount(Math.floor(check / 5 - 1));\n        encodedInt.quints = 1;\n        return encodedInt;\n      }\n\n      val--;\n    }\n    return encodedInt;\n  };\n\n  var replicateBits0816Map = new Uint16Array(256);\n  for (var i = 0; i < 256; ++i)\n    replicateBits0816Map[i] = replicateBits(i, 8, 16);\n\n  var maxWeightQuintsTritsMapper = new Uint16Array(256 * 3);\n  var idx = 0;\n  for (var i = 0; i < 256; i++) {\n    var encodedInt = getEncodedInteger(i);\n    maxWeightQuintsTritsMapper[idx + TRIT_IDX] = encodedInt.trits;\n    maxWeightQuintsTritsMapper[idx + QUINT_IDX] = encodedInt.quints;\n    maxWeightQuintsTritsMapper[idx + BIT_IDX] = encodedInt.bits;\n\n    idx += 3;\n  }\n\n  /**\n   * Gives additional precision to RGB colors near gray\n   * pixel is changed in-place in the endpoints array\n   * Refers to ASTC specifications (Section 3.8)\n   * @param  {int} a the alpha channel component\n   * @param  {int} r the red channel component\n   * @param  {int} g the green channel component\n   * @param  {int} b the blue channel component\n   */\n  var blueContract = function(a, r, g, b) {\n    var idx = endpoints.currIdx;\n    endpoints[idx] = a;\n    endpoints[idx + 1] = (r + b) >> 1;\n    endpoints[idx + 2] = (g + b) >> 1;\n    endpoints[idx + 3] = b;\n  };\n\n  /**\n   * Expands a given seed\n   * Refers to ASTC specifications (Section 3.15)\n   * @param  {uint32} p the seed to expand\n   * @return {uint32} the processed expanded seed\n   */\n  var hash52 = function(p) {\n    p ^= (p >>> 15) >>> 0;\n    p -= (p << 17) >>> 0;\n    p += (p << 7) >>> 0;\n    p += (p << 4) >>> 0;\n    p ^= (p >>> 5) >>> 0;\n    p += (p << 16) >>> 0;\n    p ^= (p >>> 7) >>> 0;\n    p ^= (p >>> 3) >>> 0;\n    p ^= (p << 6) >>> 0;\n    p ^= (p >>> 17) >>> 0;\n\n    return p;\n  };\n\n  /**\n   * Computes the partition index for a given texel\n   * @param  {uint32} seed partition pattern index\n   * @param  {int} x texel x position withing the block\n   * @param  {int} y texel y position withing the block\n   * @param  {int} z texel z position withing the block\n   * @param  {uint} partitionCount maximum number of existing partitions\n   * @param  {bool} smallBlock set to true, number of texel in the block is less than 31\n   * @return {uint} the partition index of the given texel\n   */\n\n  var seedsPartitionTable = new Uint8Array(12);\n\n  var precomputeSelectPartition = function(seed, partitionCount) {\n\n    // Refers to ASTC specifications (Section 3.15)\n    seed += (partitionCount - 1) * 1024;\n    var seedUint32 = seed >>> 0;\n\n    var rnum = hash52(seedUint32);\n\n    // The seeds values should be saved in an uint8 variable\n    seedsPartitionTable[0] = rnum & 0xF;\n    seedsPartitionTable[1] = (rnum >> 4) & 0xF;\n    seedsPartitionTable[2] = (rnum >> 8) & 0xF;\n    seedsPartitionTable[3] = (rnum >> 12) & 0xF;\n    seedsPartitionTable[4] = (rnum >> 16) & 0xF;\n    seedsPartitionTable[5] = (rnum >> 20) & 0xF;\n    seedsPartitionTable[6] = (rnum >> 24) & 0xF;\n    seedsPartitionTable[7] = (rnum >> 28) & 0xF;\n    seedsPartitionTable[8] = (rnum >> 18) & 0xF;\n    seedsPartitionTable[9] = (rnum >> 22) & 0xF;\n    seedsPartitionTable[10] = (rnum >> 26) & 0xF;\n    seedsPartitionTable[11] = ((rnum >> 30) | (rnum << 2)) & 0xF;\n\n    seedsPartitionTable[0] *= seedsPartitionTable[0];\n    seedsPartitionTable[1] *= seedsPartitionTable[1];\n    seedsPartitionTable[2] *= seedsPartitionTable[2];\n    seedsPartitionTable[3] *= seedsPartitionTable[3];\n    seedsPartitionTable[4] *= seedsPartitionTable[4];\n    seedsPartitionTable[5] *= seedsPartitionTable[5];\n    seedsPartitionTable[6] *= seedsPartitionTable[6];\n    seedsPartitionTable[7] *= seedsPartitionTable[7];\n    seedsPartitionTable[8] *= seedsPartitionTable[8];\n    seedsPartitionTable[9] *= seedsPartitionTable[9];\n    seedsPartitionTable[10] *= seedsPartitionTable[10];\n    seedsPartitionTable[11] *= seedsPartitionTable[11];\n\n    var sh1 = 0;\n    var sh2 = 0;\n    var sh3 = 0;\n    if (seed & 1) {\n      sh1 = (seed & 2) ? 4 : 5;\n      sh2 = (partitionCount === 3) ? 6 : 5;\n    } else {\n      sh1 = (partitionCount === 3) ? 6 : 5;\n      sh2 = (seed & 2) ? 4 : 5;\n    }\n    sh3 = (seed & 0x10) ? sh1 : sh2;\n\n    seedsPartitionTable[0] >>= sh1;\n    seedsPartitionTable[1] >>= sh2;\n    seedsPartitionTable[2] >>= sh1;\n    seedsPartitionTable[3] >>= sh2;\n    seedsPartitionTable[4] >>= sh1;\n    seedsPartitionTable[5] >>= sh2;\n    seedsPartitionTable[6] >>= sh1;\n    seedsPartitionTable[7] >>= sh2;\n    seedsPartitionTable[8] >>= sh3;\n    seedsPartitionTable[9] >>= sh3;\n    seedsPartitionTable[10] >>= sh3;\n    seedsPartitionTable[11] >>= sh3;\n\n    return rnum;\n  };\n\n  var selectPartition = function(rnum, x, y, z, partitionCount, smallBlock) {\n    if (partitionCount === 1)\n      return 0;\n\n    if (smallBlock) {\n      x <<= 1;\n      y <<= 1;\n      z <<= 1;\n    }\n\n    var a = seedsPartitionTable[0] * x + seedsPartitionTable[1] * y + seedsPartitionTable[10] * z + (rnum >> 14);\n    var b = seedsPartitionTable[2] * x + seedsPartitionTable[3] * y + seedsPartitionTable[11] * z + (rnum >> 10);\n    var c = seedsPartitionTable[4] * x + seedsPartitionTable[5] * y + seedsPartitionTable[8] * z + (rnum >> 6);\n    var d = seedsPartitionTable[6] * x + seedsPartitionTable[7] * y + seedsPartitionTable[9] * z + (rnum >> 2);\n\n    a &= 0x3F;\n    b &= 0x3F;\n    c &= 0x3F;\n    d &= 0x3F;\n\n    if (partitionCount < 4)\n      d = 0;\n    if (partitionCount < 3)\n      c = 0;\n\n    if (a >= b && a >= c && a >= d)\n      return 0;\n    else if (b >= c && b >= d)\n      return 1;\n    else if (c >= d)\n      return 2;\n\n    return 3;\n  };\n\n  /**\n   * Simple swap util procedure swapping to cells in a given array\n   * @param  {array} array contains the cells to swap\n   * @param  {uint} i the first index\n   * @param  {uint} j the second index\n   */\n  var swapCell = function(array, i, j) {\n    var a = array[i];\n    array[i] = array[j];\n    array[j] = a;\n  };\n\n  /**\n   * Computes the total number of bits required to encoded\n   * the same encoded integer a given amount of times.\n   * @param  {uint} nbValues the number of encoded values\n   * @param  {[type]} encodedInteger the encoded value\n   * @return {uint} the number of bits to encoded nbValues of encodedInteger\n   */\n  var getBitsNbrFromEncodedInt = function(nbValues, trits, quints, bits) {\n    var totalBits = bits * nbValues;\n\n    if (trits)\n      totalBits += Math.floor((nbValues * 8 + 4) / 5);\n    else if (quints)\n      totalBits += Math.floor((nbValues * 7 + 2) / 3);\n\n    return totalBits;\n  };\n\n  /**\n   * Computes the number of weight values\n   * available in a given block\n   * @param  {Object} blockInfo the block info containing block size, max weight, etc...\n   * @return {uint} the number of weight values encoded inside the block\n   */\n  var getNumberWeightValues = function(blockInfo) {\n    var nbValues = blockInfo.width * blockInfo.height;\n    if (blockInfo.dualPlane)\n      nbValues *= 2;\n\n    // max nbValues = 12*12*2\n    return nbValues;\n  };\n\n\n  /**\n   * Computes the total number of bits needed to\n   * encode all the weights using Integer Sequence Encoding\n   * @param  {Object} blockInfo the block info containing block size, max weight, etc...\n   * @return {uint} the number of required bits to encoded the weights.\n   */\n  var getPackedBitSize = function(blockInfo) {\n    var nbValues = getNumberWeightValues(blockInfo);\n\n    var idx = blockInfo.maxWeight * 3;\n    var trits = maxWeightQuintsTritsMapper[idx + TRIT_IDX];\n    var quints = maxWeightQuintsTritsMapper[idx + QUINT_IDX];\n    var bits = maxWeightQuintsTritsMapper[idx + BIT_IDX];\n\n    return getBitsNbrFromEncodedInt(nbValues, trits, quints, bits);\n  };\n\n  /**\n   * Reads n values from a given array\n   * @param  {array} decodedColorValues the array to read\n   * @param  {uint} n the number of array cells to read\n   * @return {array} sub-array containing the read data\n   */\n  var readNDecodedColor = function(decodedColorValues, n) {\n    for (var i = 0; i < n; ++i)\n      subDecodedValue[i] = decodedColorValues[decodedColorValuesIdx++];\n    return subDecodedValue;\n  };\n\n  /**\n   * Clamps a pixel to the [0...255] range\n   * @param  {uint} beginIdx the index of the pixel alpha channel\n   * in the endpoints global array\n   */\n  var clampPixel = function(beginIdx) {\n    for (var i = 0; i < 4; ++i)\n      endpoints[beginIdx + i] = Math.max(0, Math.min(255, endpoints[beginIdx + i]));\n  };\n\n  /**\n   * Fills the endpoints global array with the given channel colors\n   * @param  {int} a the alpha channel component\n   * @param  {int} r the red channel component\n   * @param  {int} g the green channel component\n   * @param  {int} b the blue channel component\n   */\n  var fillEndpointsWithPixel = function(a, r, g, b) {\n    var idx = endpoints.currIdx;\n    endpoints[idx] = a;\n    endpoints[idx + 1] = r;\n    endpoints[idx + 2] = g;\n    endpoints[idx + 3] = b;\n  };\n\n  /**\n   * Parses the first 16 bytes a buffer\n   * considering it as an ASTC file buffer.\n   * @param  {ArrayBuffer} imgBuffer buffer containing the ASTC raw data\n   * @return {Object} contains data about the compressed image\n   */\n  var parseHeader = function(imgBuffer) {\n    var header = {};\n\n    var u8buffer = new Uint8Array(imgBuffer);\n    var u32Buffer = new Uint32Array(imgBuffer);\n\n    header.magic = u32Buffer[0];\n\n    var littleEndian = u8buffer[0] === (header.magic & 0xFF);\n\n    var isFormatCorrect = false;\n    if (littleEndian && header.magic === 0x5CA1AB13)\n      isFormatCorrect = true;\n    else if (!littleEndian && header.magic === 0x13ABA15C)\n      isFormatCorrect = true;\n\n    if (!isFormatCorrect)\n      console.error('The ASTC header does not meet the requirements.');\n\n    header.blockDimX = u8buffer[4];\n    header.blockDimY = u8buffer[5];\n    header.blockDimZ = u8buffer[6];\n\n    if (header.blockDimX > 12 || header.blockDimY > 12)\n      console.error('Incorrect ASTC file: block can not be larger than 12x12 pixels.');\n    if (header.blockDimZ > 1)\n      console.error('3D ASTC file are not supported.');\n\n    // Image width\n    header.xSize = u8buffer[7] + (u8buffer[8] << 8) + (u8buffer[9] << 16);\n    // Image height\n    header.ySize = u8buffer[10] + (u8buffer[11] << 8) + (u8buffer[12] << 16);\n    // Image depth\n    header.zSize = u8buffer[13] + (u8buffer[14] << 8) + (u8buffer[15] << 16);\n\n    if (header.zSize > 1)\n      console.error('3D ASTC file are not supported.');\n\n    return header;\n  };\n\n  /**\n   * Computes the layout of 2D block\n   * @param  {uint} blockModeBits extracted 11 first bit of the block\n   * @return {int} contains the layout of the block [0...9]\n   */\n  var findBlockLayout = function(blockModeBits) {\n    var layout = -1;\n\n    // Layout is in [0-4]\n    if ((blockModeBits & 0x1) || blockModeBits & 0x2) {\n      // layout is in [2-4]\n      if (blockModeBits & 0x8) {\n        // layout is in [3-4]\n        if (blockModeBits & 0x4)\n          layout = (blockModeBits & 0x100) ? 4 : 3;\n        else\n          layout = 2;\n      }\n      // layout is in [0-1]\n      else\n        layout = blockModeBits & 0x4 ? 1 : 0;\n\n      return layout;\n    }\n\n    // Layout is in [7-9]\n    if (blockModeBits & 0x100) {\n      // Layout [7-8]\n      if (blockModeBits & 0x80) {\n        if ((blockModeBits & 0x40))\n          console.error('Invalid block layout found.');\n        layout = (blockModeBits & 0x20) ? 8 : 7;\n      } else\n        layout = 9;\n\n      return layout;\n    }\n\n    layout = (blockModeBits & 0x80) ? 6 : 5;\n    return layout;\n  };\n\n  /**\n   * Extracts data regarding how block data are organized\n   * @param  {Uint8Array} u8buffer the ASTC raw data\n   * @param  {uint} blockId the first byte id of the current block\n   * @return {Object} contains block related data (void extent, maximum weight, etc;..)\n   */\n  var getBlockInfo = function(u8buffer, blockId) {\n    var blockInfo = CURRENT_BLOCK_INFO;\n    blockInfo.isVoidExtent = false;\n    blockInfo.error = false;\n\n    // Get the 'block mode' represented by the last 11 bits\n    var blockModeBits = readBits(u8buffer, blockId, bitsReadCount, 11);\n    bitsReadCount += 11;\n\n    // Checks the 9 least significant bits\n    // allowing to know if the block is a void-extent block (uniform color)\n    if ((blockModeBits & 0x01FF) === 0x1FC) {\n      blockInfo.isVoidExtent = true;\n      return blockInfo;\n    }\n\n    // Checks the first reserved pattern\n    // (xxxxx0000)\n    if ((blockModeBits & 0xF) === 0) {\n      blockInfo.error = true;\n      console.log('Warning: Block layout is reserved (xxxxx0000)');\n    }\n\n    // Checks the second reserved pattern\n    // (111xxxx00)\n    if ((blockModeBits & 0x3) === 0 &&\n      (blockModeBits & 0x1C0) === 0x1C0) {\n      blockInfo.error = true;\n      console.log('Warning: Block layout is reserved (111xxxx00)');\n    }\n\n    var layout = findBlockLayout(blockModeBits);\n    if (layout < 0)\n      console.error('Invalid block layout found.');\n\n    // Retrieves the R least significant bit according\n    // to the current block layout\n    var R = !!(blockModeBits & 0x10);\n    if (layout < 5)\n      R |= (blockModeBits & 0x3) << 1;\n    else\n      R |= (blockModeBits & 0xC) >> 1;\n\n    if (R < 2 || R > 7)\n      console.error('Invalid block mode. The file is not encoded in ASTC or corrupted.');\n\n    var a = 0;\n    var b = 0;\n    // Computes weights grid dimension\n    // Refers to ASTC specifications(Table 11)\n    switch (layout) {\n      case 0:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x3;\n        blockInfo.width = b + 4;\n        blockInfo.height = a + 2;\n        break;\n      case 1:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x3;\n        blockInfo.width = b + 8;\n        blockInfo.height = a + 2;\n        break;\n      case 2:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x3;\n        blockInfo.width = a + 2;\n        blockInfo.height = b + 8;\n        break;\n      case 3:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x1;\n        blockInfo.width = a + 2;\n        blockInfo.height = b + 6;\n        break;\n      case 4:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 7) & 0x1;\n        blockInfo.width = b + 2;\n        blockInfo.height = a + 2;\n        break;\n      case 5:\n        a = (blockModeBits >> 5) & 0x3;\n        blockInfo.width = 12;\n        blockInfo.height = a + 2;\n        break;\n      case 6:\n        a = (blockModeBits >> 5) & 0x3;\n        blockInfo.width = a + 2;\n        blockInfo.height = 12;\n        break;\n      case 7:\n        blockInfo.width = 6;\n        blockInfo.height = 10;\n        break;\n      case 8:\n        blockInfo.width = 10;\n        blockInfo.height = 6;\n        break;\n      case 9:\n        a = (blockModeBits >> 5) & 0x3;\n        b = (blockModeBits >> 9) & 0x3;\n        blockInfo.width = a + 6;\n        blockInfo.height = b + 6;\n        break;\n      default:\n        console.error('The block layout is not recognized. Layout should be [0-9].');\n    }\n\n    // The dual plane mode bit is the most significant bit\n    blockInfo.dualPlane = (layout !== 9) && (blockModeBits & 0x400);\n    // The high precision mode bit is the second most significant bit\n    blockInfo.highPrecisionRange = (layout !== 9) && (blockModeBits & 0x200);\n\n    // Selects the appropriate weight range\n    if (blockInfo.highPrecisionRange) {\n      var highWeightRanges = [9, 11, 15, 19, 23, 31];\n      blockInfo.maxWeight = highWeightRanges[R - 2];\n    } else {\n      var weightRanges = [1, 2, 3, 4, 5, 7];\n      blockInfo.maxWeight = weightRanges[R - 2];\n    }\n\n    return blockInfo;\n  };\n\n  /**\n   * Decodes a trit in colorData raw data\n   * @param  {Uint8Array} colorData encoded raw data\n   * @param  {uint} nbBitsPerValue number of bits\n   * on which the integer is encoded\n   * @param  {array} resultStorage contains decoded integer,\n   * the decoded trit will be pushed back at the end of this procedure\n   */\n\n  var lsbDecodingValues = new Uint8Array(5);\n  var msbDecodingValues = new Uint8Array(5);\n\n  var decodeTrit = function(colorData, nbBitsPerValue) {\n    var m = lsbDecodingValues;\n    var t = msbDecodingValues;\n    var T = 0;\n\n    // Refers to ASTC specifications (Table 17)\n    m[0] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T = readBits(colorData, 0, colorDataBitsRead, 2);\n    colorDataBitsRead += 2;\n\n    m[1] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 2) << 2;\n    colorDataBitsRead += 2;\n\n    m[2] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 1) << 4;\n    colorDataBitsRead += 1;\n\n    m[3] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 2) << 5;\n    colorDataBitsRead += 2;\n\n    m[4] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    T |= readBits(colorData, 0, colorDataBitsRead, 1) << 7;\n    colorDataBitsRead += 1;\n\n    var C = 0 >>> 0;\n    if (extractBits(T, 2, 4) === 7) {\n      C = (extractBits(T, 5, 7) << 2) | extractBits(T, 0, 1);\n      t[3] = 2;\n      t[4] = 2;\n    } else {\n      C = extractBits(T, 0, 4);\n      if (extractBits(T, 5, 6) === 3) {\n        t[4] = 2;\n        t[3] = extractBits(T, 7, 7);\n      } else {\n        t[4] = extractBits(T, 7, 7);\n        t[3] = extractBits(T, 5, 6);\n      }\n    }\n\n    if (extractBits(C, 0, 1) === 3) {\n      t[2] = 2;\n      t[1] = extractBits(C, 4, 4);\n      t[0] = (extractBits(C, 3, 3) << 1) | (extractBits(C, 2, 2) & ~extractBits(C, 3, 3));\n    } else if (extractBits(C, 2, 3) === 3) {\n      t[2] = 2;\n      t[1] = 2;\n      t[0] = extractBits(C, 0, 1);\n    } else {\n      t[2] = extractBits(C, 4, 4);\n      t[1] = extractBits(C, 2, 3);\n      t[0] = (extractBits(C, 1, 1) << 1) | (extractBits(C, 0, 0) & ~extractBits(C, 1, 1));\n    }\n\n    for (var i = 0; i < 5; ++i) {\n      var idx = resultDecodedStorage.currIndex;\n      resultDecodedStorage[idx] = 1;\n      resultDecodedStorage[idx + 1] = 0;\n      resultDecodedStorage[idx + 2] = nbBitsPerValue;\n      resultDecodedStorage[idx + 3] = t[i];\n      resultDecodedStorage[idx + 4] = 0;\n      resultDecodedStorage[idx + 5] = m[i];\n\n      resultDecodedStorage.currIndex += 6;\n    }\n  };\n\n  /**\n   * Decodes a quint in colorData raw data\n   * @param  {Uint8Array} colorData encoded raw data\n   * @param  {uint} nbBitsPerValue number of bits\n   * on which the integer is encoded\n   * @param  {array} resultStorage contains decoded integer,\n   * the decoded quint will be pushed back at the end of this procedure\n   */\n  var decodeQuint = function(colorData, nbBitsPerValue) {\n    var m = lsbDecodingValues;\n    var q = msbDecodingValues;\n    var Q = 0;\n\n    // Refers to ASTC specifications (Table 18)\n    m[0] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    Q = readBits(colorData, 0, colorDataBitsRead, 3);\n    colorDataBitsRead += 3;\n\n    m[1] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    Q |= readBits(colorData, 0, colorDataBitsRead, 2) << 3;\n    colorDataBitsRead += 2;\n\n    m[2] = readBits(colorData, 0, colorDataBitsRead, nbBitsPerValue);\n    colorDataBitsRead += nbBitsPerValue;\n\n    Q |= readBits(colorData, 0, colorDataBitsRead, 2) << 5;\n    colorDataBitsRead += 2;\n\n    if (extractBits(Q, 1, 2) === 3 && extractBits(Q, 5, 6) === 0) {\n      q[0] = 4;\n      q[1] = 4;\n      q[2] = (extractBits(Q, 0, 0) << 2) | ((extractBits(Q, 4, 4) & ~extractBits(Q, 0, 0)) << 1) | (extractBits(Q, 3, 3) & ~extractBits(Q, 0, 0));\n    } else {\n      var C = 0 >>> 0;\n      if (extractBits(Q, 1, 2) === 3) {\n        q[2] = 4;\n        C = (extractBits(Q, 3, 4) << 3) | ((~extractBits(Q, 5, 6) & 3) << 1) | (extractBits(Q, 0, 0));\n      } else {\n        q[2] = extractBits(Q, 5, 6);\n        C = extractBits(Q, 0, 4);\n      }\n\n      if (extractBits(C, 0, 2) === 5) {\n        q[1] = 4;\n        q[0] = extractBits(C, 3, 4);\n      } else {\n        q[1] = extractBits(C, 3, 4);\n        q[0] = extractBits(C, 0, 2);\n      }\n    }\n\n    for (var i = 0; i < 3; ++i) {\n      var idx = resultDecodedStorage.currIndex;\n      resultDecodedStorage[idx] = 0;\n      resultDecodedStorage[idx + 1] = 1;\n      resultDecodedStorage[idx + 2] = nbBitsPerValue;\n      resultDecodedStorage[idx + 3] = 0;\n      resultDecodedStorage[idx + 4] = q[i];\n      resultDecodedStorage[idx + 5] = m[i];\n\n      resultDecodedStorage.currIndex += 6;\n    }\n  };\n\n  /**\n   * Decodes nbValues of colorData raw data\n   * according to its max range value\n   * @param  {Uint8Array} colorData encoded raw data\n   * @param  {uint} range max value of the Integere Sequence\n   * @param  {uint} nbValues contains the number of values to decode\n   * @return {array} contains decoded integer\n   */\n  var decodeIntegerSequence = function(colorData, range, nbValues) {\n    var baseIdx = range * 3;\n    var trits = maxWeightQuintsTritsMapper[baseIdx + TRIT_IDX];\n    var quints = maxWeightQuintsTritsMapper[baseIdx + QUINT_IDX];\n    var bits = maxWeightQuintsTritsMapper[baseIdx + BIT_IDX];\n\n    resultDecodedStorage.currIndex = 0;\n\n    var nbDecodedValues = 0;\n    while (nbDecodedValues < nbValues) {\n\n      if (quints === 0 && trits === 0) {\n        var idx = resultDecodedStorage.currIndex;\n        resultDecodedStorage[idx] = trits;\n        resultDecodedStorage[idx + 1] = quints;\n        resultDecodedStorage[idx + 2] = bits;\n        resultDecodedStorage[idx + 3] = 0;\n        resultDecodedStorage[idx + 4] = 0;\n        resultDecodedStorage[idx + 5] = readBits(colorData, 0, colorDataBitsRead, bits);\n        colorDataBitsRead += bits;\n\n        resultDecodedStorage.currIndex += 6;\n\n        nbDecodedValues++;\n      } else if (quints === 1 && trits === 0) {\n        decodeQuint(colorData, bits);\n        nbDecodedValues += 3;\n      } else {\n        decodeTrit(colorData, bits);\n        nbDecodedValues += 5;\n      }\n    }\n  };\n\n  /**\n   * Decodes color from the colorData encoded Integer Sequence\n   * @param  {Uint8Array} colorData encoded color raw data\n   * @param  {array} colorModes contains the color for each partition\n   * @param  {uint} nbPartitions Number of available partitions\n   * @param  {uint} colorDataBits remaining bits number on which color data are encoded\n   * @return {array} decoded endpoints value in the [0...255] range\n   */\n\n  var endpointValuesOutput = new Uint8Array(32);\n\n  var decodeColorValues = function(colorData, colorModes, nbPartitions, colorDataBits) {\n    var trits = 0;\n    var quints = 0;\n    var bits = 0;\n    var i = 0;\n    // Computes the number of endpoint by using the associated class\n    // max endpoint values = 32\n    var nbEndpointValues = 0;\n    for (i = 0; i < nbPartitions; ++i)\n      nbEndpointValues += ((colorModes[i] >> 2) + 1) << 1;\n\n    // Finds the max range for each color endpoints\n    var range = 256;\n    while (--range > 0) {\n\n      var idx = range * 3;\n      trits = maxWeightQuintsTritsMapper[idx + TRIT_IDX];\n      quints = maxWeightQuintsTritsMapper[idx + QUINT_IDX];\n      bits = maxWeightQuintsTritsMapper[idx + BIT_IDX];\n\n      var bitsNbr = getBitsNbrFromEncodedInt(nbEndpointValues, trits, quints, bits);\n      if (bitsNbr <= colorDataBits) {\n        // Some integers share the same encoding\n        // this piece of code finds the smallest one\n        while (--range > 0) {\n          var newIdx = range * 3;\n          var newTrits = maxWeightQuintsTritsMapper[newIdx + TRIT_IDX];\n          var newQuints = maxWeightQuintsTritsMapper[newIdx + QUINT_IDX];\n          var newBits = maxWeightQuintsTritsMapper[newIdx + BIT_IDX];\n\n          if (newTrits !== trits || newQuints !== quints || newBits !== bits)\n            break;\n        }\n\n        range++;\n        break;\n      }\n    }\n\n    // Decodes the integer sequence based on the range and\n    // the number of values\n    var endpointIdx = 0;\n    decodeIntegerSequence(colorData, range, nbEndpointValues);\n\n    for (i = 0; i < nbEndpointValues * 6; i += 6) {\n      var bitLength = resultDecodedStorage[i + BIT_IDX];\n      var bitValue = resultDecodedStorage[i + BIT_IDX + 3];\n\n      // Refers to ASTC specifications(Section 3.11)\n      var result;\n      if (resultDecodedStorage[i + TRIT_IDX]) result = cacheDecodeTrits[bitLength + resultDecodedStorage[i + TRIT_IDX + 3] * 7 + bitValue * 21];\n      else if (resultDecodedStorage[i + QUINT_IDX]) result = cacheDecodeQuints[bitLength + resultDecodedStorage[i + QUINT_IDX + 3] * 6 + bitValue * 30];\n      else result = cacheDecodeSimple[bitLength + bitValue * 9];\n\n      endpointValuesOutput[endpointIdx++] = result;\n    }\n\n    // Makes sure each decoded value is not ambiguous\n    for (i = 0; i < nbEndpointValues; ++i)\n      if (endpointValuesOutput[i] > 255)\n        console.error('Decoded endpoint value can not be above 255.');\n  };\n\n  /**\n   * Computes the two color endpoint values\n   * from the decoded Integer Sequence data\n   * @param  {[type]} endpointColorValues [description]\n   * @param  {[type]} colorMode           [description]\n   */\n  var computeColorEndpointsLDR = function(endpointColorValues, colorMode) {\n    var v = 0;\n    var currIdx = 0;\n\n    switch (colorMode) {\n      case 0:\n        v = readNDecodedColor(endpointColorValues, 2);\n        fillEndpointsWithPixel(0xFF, v[0], v[0], v[0]);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(0xFF, v[1], v[1], v[1]);\n        endpoints.currIdx += 4;\n        break;\n      case 1:\n        v = readNDecodedColor(endpointColorValues, 2);\n        var L0 = (v[0] >> 2) | (v[1] & 0xC0);\n        var L1 = Math.max(L0 + (v[1] & 0x3F), 0xFF);\n\n        fillEndpointsWithPixel(0xFF, L0, L0, L0);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(0xFF, L1, L1, L1);\n        endpoints.currIdx += 4;\n        break;\n      case 4:\n        v = readNDecodedColor(endpointColorValues, 4);\n\n        fillEndpointsWithPixel(v[2], v[0], v[0], v[0]);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(v[3], v[1], v[1], v[1]);\n        endpoints.currIdx += 4;\n        break;\n      case 5:\n        v = readNDecodedColor(endpointColorValues, 4);\n\n        bitTransferSigned(v, 1, 0);\n        bitTransferSigned(v, 3, 2);\n\n        currIdx = endpoints.currIdx;\n\n        fillEndpointsWithPixel(v[2], v[0], v[0], v[0]);\n        endpoints.currIdx += 4;\n\n        fillEndpointsWithPixel(v[2] + v[3], v[0] + v[1], v[0] + v[1], v[0] + v[1]);\n        endpoints.currIdx += 4;\n\n        clampPixel(currIdx);\n        clampPixel(currIdx + 4);\n        break;\n      case 6:\n        v = readNDecodedColor(endpointColorValues, 4);\n\n        fillEndpointsWithPixel(0xFF, v[0] * v[3] >> 8, v[1] * v[3] >> 8, v[2] * v[3] >> 8);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(0xFF, v[0], v[1], v[2]);\n        endpoints.currIdx += 4;\n        break;\n      case 8:\n        v = readNDecodedColor(endpointColorValues, 6);\n        if (v[1] + v[3] + v[5] >= v[0] + v[2] + v[4]) {\n          fillEndpointsWithPixel(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n          fillEndpointsWithPixel(0xFF, v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(0xFF, v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n          blueContract(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        break;\n      case 9:\n        v = readNDecodedColor(endpointColorValues, 6);\n\n        bitTransferSigned(v, 1, 0);\n        bitTransferSigned(v, 3, 2);\n        bitTransferSigned(v, 5, 4);\n\n        currIdx = endpoints.currIdx;\n\n        if (v[1] + v[3] + v[5] >= 0) {\n          fillEndpointsWithPixel(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n\n          fillEndpointsWithPixel(0xFF, v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(0xFF, v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n\n          blueContract(0xFF, v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        clampPixel(currIdx);\n        clampPixel(currIdx + 4);\n        break;\n      case 10:\n        v = readNDecodedColor(endpointColorValues, 6);\n\n        fillEndpointsWithPixel(v[4], v[0] * v[3] >> 8, v[1] * v[3] >> 8, v[2] * v[3] >> 8);\n        endpoints.currIdx += 4;\n        fillEndpointsWithPixel(v[5], v[0], v[1], v[2]);\n        endpoints.currIdx += 4;\n        break;\n      case 12:\n        v = readNDecodedColor(endpointColorValues, 8);\n        if (v[1] + v[3] + v[5] >= v[0] + v[2] + v[4]) {\n          fillEndpointsWithPixel(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n          fillEndpointsWithPixel(v[7], v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(v[7], v[1], v[3], v[5]);\n          endpoints.currIdx += 4;\n          blueContract(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        break;\n      case 13:\n        v = readNDecodedColor(endpointColorValues, 8);\n\n        bitTransferSigned(v, 1, 0);\n        bitTransferSigned(v, 3, 2);\n        bitTransferSigned(v, 5, 4);\n        bitTransferSigned(v, 7, 6);\n\n        currIdx = endpoints.currIdx;\n\n        if (v[1] + v[3] + v[5] >= 0) {\n          fillEndpointsWithPixel(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n\n          fillEndpointsWithPixel(v[7] + v[6], v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n        } else {\n          blueContract(v[6] + v[7], v[0] + v[1], v[2] + v[3], v[4] + v[5]);\n          endpoints.currIdx += 4;\n\n          blueContract(v[6], v[0], v[2], v[4]);\n          endpoints.currIdx += 4;\n        }\n        clampPixel(currIdx);\n        clampPixel(currIdx + 4);\n        break;\n      default:\n        console.error('Unsupported color endpoint mode. Only LDR modes are supported.');\n    }\n  };\n\n  /**\n   * Unquantizes a single texel returning it to a standard\n   * [0...64] range according to its trit/quint/bit encoding\n   * @param  {uint} val the decoded integer\n   * @return {uint} the unquantized weight in the range [0...64]\n   */\n  var unquantizeTexel = function(i) {\n    var bitLength = resultDecodedStorage[i + BIT_IDX];\n    var bitValue = resultDecodedStorage[i + BIT_IDX + 3];\n\n    // Refers to ASTC specifications (Section 3.11)\n    if (resultDecodedStorage[i + TRIT_IDX]) return cacheUnquantizeTrits[bitLength + resultDecodedStorage[i + TRIT_IDX + 3] * 4 + bitValue * 12];\n    if (resultDecodedStorage[i + QUINT_IDX]) return cacheUnquantizeQuints[bitLength + resultDecodedStorage[i + QUINT_IDX + 3] * 3 + bitValue * 15];\n    return cacheUnquantizeSimple[bitLength + bitValue * 8];\n  };\n\n  /**\n   * Returns weights in a standard range [0...64]\n   * @param  {array} weightValues contains the decoded\n   * Integer Sequence of the weight data\n   * @param  {uint} blockId the current block index\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} multidimensional array containing the weights\n   * for both planes\n   */\n\n  var unquantizedOutput = new Uint8Array(2 * 144);\n  var infilledWeightsOutput = new Uint8Array(2 * 144);\n\n  var unquantizeWeights = function(blockInfo, blockWidth, blockHeight, nbWeightValues) {\n\n    var bw = blockInfo.width;\n    var bh = blockInfo.height;\n    var bwh = bw * bh;\n\n    var i = 0;\n    var end = 0;\n\n    if (blockInfo.dualPlane) {\n      end = Math.min(nbWeightValues * 2, bwh);\n      for (i = 0; i < end; ++i) {\n        unquantizedOutput[i] = unquantizeTexel(i * 12);\n        unquantizedOutput[i + 144] = unquantizeTexel(i * 12 + 6);\n      }\n\n    } else {\n      // Unquantizes the whole weight grid\n      end = Math.min(nbWeightValues, bwh);\n      for (i = 0; i < end; ++i) {\n        unquantizedOutput[i] = unquantizeTexel(i * 6);\n      }\n    }\n\n    // Applies the weight infill procedure\n    // Refers to ASTC specifications (Section 3.12)\n    // 3D blocks are not handled for the moment\n    var Ds = ((1024 + (blockWidth / 2)) / (blockWidth - 1)) >>> 0;\n    var Dt = ((1024 + (blockHeight / 2)) / (blockHeight - 1)) >>> 0;\n    var dPlane = (blockInfo.dualPlane) ? 2 : 1;\n\n    for (var planeId = 0; planeId < dPlane; ++planeId) {\n      var idp = planeId * 144;\n      for (var t = 0; t < blockHeight; ++t) {\n        for (var s = 0; s < blockWidth; ++s) {\n          var cs = Ds * s;\n          var ct = Dt * t;\n\n          var gs = (cs * (bw - 1) + 32) >> 6;\n          var gt = (ct * (bh - 1) + 32) >> 6;\n\n          var js = gs >> 4;\n          var fs = gs & 0xF;\n\n          var jt = gt >> 4;\n          var ft = gt & 0x0F;\n\n          var w11 = (fs * ft + 8) >> 4;\n          var w10 = (ft - w11) >>> 0;\n          var w01 = (fs - w11) >>> 0;\n          var w00 = (16 - fs - ft + w11) >>> 0;\n\n          var v0 = js + jt * bw;\n\n          var val = 8;\n          var vid = v0;\n          if (vid < bwh) val += w00 * unquantizedOutput[vid + idp];\n\n          vid = v0 + 1;\n          if (vid < bwh) val += w01 * unquantizedOutput[vid + idp];\n\n          vid = v0 + bw;\n          if (vid < bwh) val += w10 * unquantizedOutput[vid + idp];\n\n          vid = v0 + bw + 1;\n          if (vid < bwh) val += w11 * unquantizedOutput[vid + idp];\n\n          infilledWeightsOutput[t * blockWidth + s + idp] = val >> 4;\n        }\n      }\n    }\n  };\n\n  /**\n   * Decompresses a single void-extent block,\n   * in other words, a block containing only one color\n   * @param  {Uint8Array} u8buffer the ASTC raw data\n   * @param  {uint} blockId the current block index\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} containing blockWidth * blockHeight Pixels\n   */\n  var decompressVoidExtent = function(u8buffer, blockId, blockInfo, blockWidth, blockHeight) {\n    // Do not read extra data\n    bitsReadCount += 53;\n\n    var r16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n    var g16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n    var b16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n    var a16 = readBits(u8buffer, blockId, bitsReadCount, 16);\n    bitsReadCount += 16;\n\n    if (bitsReadCount !== 128)\n      console.error('Invalid void-extent bits reading.');\n\n    var nbPixel = blockWidth * blockHeight * 4;\n    for (var i = 0; i < nbPixel; i += 4) {\n      blockPixelsOutput[i] = extractBits(a16, 0, 7);\n      blockPixelsOutput[i + 1] = extractBits(r16, 0, 7);\n      blockPixelsOutput[i + 2] = extractBits(g16, 0, 7);\n      blockPixelsOutput[i + 3] = extractBits(b16, 0, 7);\n    }\n  };\n\n  /**\n   * Decompresses a single block by returning\n   * the error color (0xFF, 0xFF, 0x00, 0xFF)\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} containing blockWidth * blockHeight Pixels\n   */\n  var getErrorPixelBlock = function(blockWidth, blockHeight) {\n    var nbPixel = blockWidth * blockHeight * 4;\n    for (var i = 0; i < nbPixel; i += 4) {\n      blockPixelsOutput[i] = 0xFF;\n      blockPixelsOutput[i + 1] = 0xFF;\n      blockPixelsOutput[i + 2] = 0x00;\n      blockPixelsOutput[i + 3] = 0xFF;\n    }\n  };\n\n  /**\n   * Decompresses a single block by retrieving\n   * the block layout as well as the number of partitions,\n   * the color endpoints and weights data.\n   * @param  {Uint8Array} u8buffer the ASTC raw data\n   * @param  {uint} blockId the current block index\n   * @param  {uint} blockWidth the width of the blocks\n   * @param  {uint} blockHeight the height of the blocks\n   * @return {array} containing blockWidth * blockHeight Pixels\n   */\n  var decompressBlock = function(u8buffer, blockId, blockWidth, blockHeight) {\n    bitsReadCount = 0;\n    bitsWrittenCount = 0;\n    colorDataBitsRead = 0;\n    decodedColorValuesIdx = 0;\n\n    var i = 0;\n    var CEM = 0;\n    var blockInfo = getBlockInfo(u8buffer, blockId);\n\n    if (blockInfo.error)\n      return getErrorPixelBlock(blockWidth, blockHeight);\n\n    // Handles the case whenever the block is filled with only one color\n    if (blockInfo.isVoidExtent)\n      return decompressVoidExtent(u8buffer, blockId, blockInfo, blockWidth, blockHeight);\n\n    if (blockInfo.width > blockWidth)\n      console.error('Texel weight grid width can not be larger than the block width.');\n    if (blockInfo.height > blockHeight)\n      console.error('Texel weight grid height can not be larger than the block height.');\n\n    // Extracts the partitions number\n    var nbPartitions = readBits(u8buffer, blockId, bitsReadCount, 2) + 1;\n    bitsReadCount += 2;\n\n    if (nbPartitions > 4)\n      console.error('The block partitions number is too high.');\n    if (nbPartitions === 4 && blockInfo.dualPlane)\n      return getErrorPixelBlock(blockWidth, blockHeight);\n\n    // Reads the extra configuration field\n    // At most 4 modes describing how color data is encoded\n    var colorEndpointModes = [0, 0, 0, 0];\n    var partitionIndex = -1;\n    var planeIndex = -1;\n    var cemBits = 0;\n    if (nbPartitions === 1) {\n      colorEndpointModes[0] = readBits(u8buffer, blockId, bitsReadCount, 4);\n      bitsReadCount += 4;\n      partitionIndex = 0;\n    } else {\n      // Reads 10 bits containing the partition index\n      partitionIndex = readBits(u8buffer, blockId, bitsReadCount, 10);\n      bitsReadCount += 10;\n      // Reads 6 bits containing the cem extra\n      cemBits = readBits(u8buffer, blockId, bitsReadCount, 6);\n      bitsReadCount += 6;\n    }\n    var baseMode = (cemBits & 3);\n\n    // Computes remaining bits containing color endpoint data\n    //var numberWeightBits = getPackedBitSize(blockInfo);\n    var remainingBits = 128 - getPackedBitSize(blockInfo) - bitsReadCount;\n    var dualPlaneSelectorBits = (blockInfo.dualPlane) ? 2 : 0;\n    remainingBits -= dualPlaneSelectorBits;\n\n    // Gets extra bits number according to CEM\n    // mode 0 does not need any extra CEM bits\n    var extraCEMbitsNb = 0;\n    if (baseMode) {\n      if (nbPartitions === 2)\n        extraCEMbitsNb = 2;\n      else if (nbPartitions === 3)\n        extraCEMbitsNb = 5;\n      else if (nbPartitions === 4)\n        extraCEMbitsNb = 8;\n    }\n    remainingBits -= extraCEMbitsNb;\n\n    // Reads color data\n    // read data are written to a buffer for later use\n    var colorDataBits = remainingBits;\n    for (i = 0; i < 16; ++i)\n      colorEndpointData[i] = 0;\n\n    while (remainingBits > 0) {\n      var bitsNb = Math.min(remainingBits, 8);\n      var bits = readBits(u8buffer, blockId, bitsReadCount, bitsNb);\n      bitsReadCount += bitsNb;\n\n      writeBits(colorEndpointData, bits, bitsNb, bitsWrittenCount);\n      bitsWrittenCount += bitsNb;\n\n      remainingBits -= 8;\n    }\n\n    planeIndex = readBits(u8buffer, blockId, bitsReadCount, dualPlaneSelectorBits);\n    bitsReadCount += dualPlaneSelectorBits;\n\n    // Reads extra CEM data\n    if (baseMode) {\n      var extraCEMbits = readBits(u8buffer, blockId, bitsReadCount, extraCEMbitsNb);\n      bitsReadCount += extraCEMbitsNb;\n\n      CEM = (extraCEMbits << 6) | cemBits;\n      CEM >>= 2;\n\n      // Extracts the class selector bit by bit\n      var C = classSelectorBitsArray;\n      var M = colorModeLSB;\n      for (i = 0; i < nbPartitions; ++i) {\n        C[i] = CEM & 1;\n        CEM >>= 1;\n      }\n      // Extracts the color endoint mode low bits\n      /*for (i = 0; i < nbPartitions; ++i) {\n        M[i] = CEM & 3;\n        CEM >>= 2;\n        if (M[i] > 3)\n          console.error(  'Error while extracting the color endpoint mode LSB.'); \n      }*/\n      for (i = 0; i < nbPartitions; ++i) {\n        M[i] = CEM & 3;\n        CEM >>= 2;\n        if (M[i] > 3)\n          console.error('Error while extracting the color endpoint mode LSB.');\n\n        colorEndpointModes[i] = baseMode;\n        if (!(C[i]))\n          colorEndpointModes[i] -= 1;\n        colorEndpointModes[i] <<= 2;\n        colorEndpointModes[i] |= M[i];\n      }\n    } else if (nbPartitions > 1) {\n      CEM = cemBits >> 2;\n      for (i = 0; i < nbPartitions; ++i)\n        colorEndpointModes[i] = CEM;\n    }\n\n    // Makes sure the extracted data obtained until here is correct\n    var blockBitsRead = bitsReadCount + getPackedBitSize(blockInfo);\n\n    for (i = 0; i < nbPartitions; ++i)\n      if (colorEndpointModes[i] >= 16)\n        console.error('The color endpoint mode ' + colorEndpointModes[i] + ' is not correct.');\n\n    if (blockBitsRead < 128)\n      console.error('The current block as not been read entirely. (' + blockBitsRead + ' read)');\n    else if (blockBitsRead > 128)\n      console.error('Too many bits have been read for the current block. (' + blockBitsRead + ' read)');\n\n    // Decodes color data\n    decodeColorValues(colorEndpointData, colorEndpointModes, nbPartitions, colorDataBits);\n\n    // Computes endpoint for all partitions\n    endpoints.currIdx = 0;\n    for (i = 0; i < nbPartitions; i++)\n      computeColorEndpointsLDR(endpointValuesOutput, colorEndpointModes[i]);\n\n    // Reads remaining bits containing packed texel weight data\n    // This code can be factorized with the color data reading above\n    var texelWeightDataIndex = 0;\n    for (i = 0; i < 16; ++i)\n      texelWeightData[texelWeightDataIndex++] = u8buffer[blockId + i];\n\n    // Reverses the textWeightData array\n    // and each byte\n    reverseU8Array(texelWeightData);\n\n    var weightPackedSize = getPackedBitSize(blockInfo);\n    var clearByteStart = (weightPackedSize >> 3) + 1;\n    var nbBytesToClean = 16 - clearByteStart;\n    texelWeightData[clearByteStart - 1] &= (1 << (weightPackedSize % 8)) - 1;\n    for (i = 0; i < nbBytesToClean; ++i)\n      texelWeightData[clearByteStart + i] = 0;\n\n    // Decodes the weight\n    colorDataBitsRead = 0;\n    var nbWeightValues = getNumberWeightValues(blockInfo);\n    decodeIntegerSequence(texelWeightData, blockInfo.maxWeight, nbWeightValues);\n\n    unquantizeWeights(blockInfo, blockWidth, blockHeight, nbWeightValues);\n\n    // Interpolates colors\n    var smallBlock = (blockHeight * blockWidth) < 32;\n    var rnum = precomputeSelectPartition(partitionIndex, nbPartitions);\n    for (var j = 0; j < blockHeight; j++) {\n      for (i = 0; i < blockWidth; i++) {\n        var partition = selectPartition(rnum, i, j, 0, nbPartitions, smallBlock);\n        if (partition >= nbPartitions)\n          console.error('The block partition index can not be larger or equal to the number of partitions.');\n\n        var rowIndex = (j * blockWidth + i) * 4;\n        var endpointBaseIdx = partition * 8;\n        for (var c = 0; c < 4; ++c) {\n          var C0 = endpoints[endpointBaseIdx + c] >>> 0;\n          C0 = replicateBits0816Map[C0];\n\n          var C1 = endpoints[endpointBaseIdx + c + 4] >>> 0;\n          C1 = replicateBits0816Map[C1];\n\n          var plane = 0 >>> 0;\n          if (blockInfo.dualPlane && (((planeIndex + 1) & 3) === c))\n            plane = 1;\n\n          var weight = infilledWeightsOutput[j * blockWidth + i + plane * 144];\n          var color = Math.floor(((C0 * (64 - weight) + C1 * weight + 32) / 64));\n\n          if (color === 65535)\n            blockPixelsOutput[rowIndex + c] = 255;\n          else\n            blockPixelsOutput[rowIndex + c] = Math.round(255.0 * (color / 65536.0));\n        }\n      }\n    }\n  };\n\n  /**\n   * Decompresses a complete buffer containing ASTC file raw data\n   * @param  {ArrayBuffer} contains the compressed ASTC raw data\n   * @return {Object} contains the uncompressed image buffer\n   * as well as the image dimensions\n   */\n  // TODO export\n  var decompress = function(imgBuffer) {\n    var u8buffer = new Uint8Array(imgBuffer);\n\n    // Retrieves the header\n    var header = parseHeader(imgBuffer);\n\n    var imgWidth = header.xSize;\n    var imgHeight = header.ySize;\n    var halfImgHeight = (imgHeight >> 1);\n\n    var blockWidth = header.blockDimX;\n    var blockHeight = header.blockDimY;\n\n    var firstBlockIndex = 16;\n    var blockNb = 0;\n\n    // Initializes temp storages used\n    // in helper functions\n    blockPixelsOutput = new Uint8Array(blockWidth * blockHeight * 4);\n\n    var j = 0;\n    var i = 0;\n    var resultImg = new Uint8ClampedArray(imgWidth * imgHeight * 4);\n\n    for (j = 0; j < imgHeight; j += blockHeight) {\n      for (i = 0; i < imgWidth; i += blockWidth) {\n\n        var currentBlockIndex = firstBlockIndex + blockNb * 16;\n        // Decompresses the current block\n        decompressBlock(u8buffer, currentBlockIndex, blockWidth, blockHeight);\n\n        var widthBound = Math.min(blockWidth, imgWidth - i);\n        var heightBound = Math.min(blockHeight, imgHeight - j);\n        var rowIndex = (j * imgWidth + i) * 4;\n        for (var jj = 0; jj < heightBound; jj++) {\n          var destId = rowIndex + jj * imgWidth * 4;\n          var srcId = jj * blockWidth * 4;\n\n          for (var x = 0; x < widthBound * 4; x += 4) {\n            resultImg[destId + x] = blockPixelsOutput[srcId + x + 1];\n            resultImg[destId + x + 1] = blockPixelsOutput[srcId + x + 2];\n            resultImg[destId + x + 2] = blockPixelsOutput[srcId + x + 3];\n            resultImg[destId + x + 3] = blockPixelsOutput[srcId + x];\n          }\n        }\n\n        ++blockNb;\n      }\n    }\n\n    // Flips the image using the Y-axis\n    for (j = 0; j < halfImgHeight; j++) {\n      for (i = 0; i < imgWidth; i++) {\n        var beginByte = (j * imgWidth + i) * 4;\n        var endByte = ((imgHeight - j - 1) * imgWidth + i) * 4;\n\n        swapCell(resultImg, beginByte, endByte);\n        swapCell(resultImg, beginByte + 1, endByte + 1);\n        swapCell(resultImg, beginByte + 2, endByte + 2);\n        swapCell(resultImg, beginByte + 3, endByte + 3);\n      }\n    }\n\n    var result = {};\n    result.img = resultImg;\n    result.width = imgWidth;\n    result.height = imgHeight;\n\n    return result;\n  };\n\n  module.exports = {\n    decompress: decompress\n  };\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n  'use strict';\n\n  var replicateBits = __webpack_require__(3).replicateBits;\n\n  // Describes how to unpack trit/quint\n  // with no additional bits\n  var WEIGHT_TRIT_RANGE = [0, 32, 63];\n  var WEIGHT_QUINT_RANGE = [0, 16, 32, 47, 63];\n\n  ///////////////////\n  // CACHE UNQUANTIZE\n  ///////////////////\n\n  // -----------------\n  // UNQUANTIZE SIMPLE\n  // -----------------\n  var cacheUnquantizeSimple = new Uint8Array(256 * 8);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var bitLength = 1; bitLength < 8; ++bitLength) {\n\n      var result = replicateBits(bitValue, bitLength, 6);\n      if (result > 32) result++;\n\n      cacheUnquantizeSimple[bitLength + bitValue * 8] = result;\n    }\n  }\n\n  // ----------------\n  // UNQUANTIZE TRITS\n  // ----------------\n  var cacheUnquantizeTrits = new Uint8Array(256 * 3 * 4);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var tri = 0; tri < 3; ++tri) {\n      for (var bitLength = 0; bitLength < 4; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 0:\n            result = WEIGHT_TRIT_RANGE[tri];\n            break;\n          case 1:\n            C = 50;\n            break;\n          case 2:\n            C = 23;\n            var bBit = (bitValue >> 1) & 1;\n            B = (bBit << 6) | (bBit << 2) | bBit;\n            break;\n          case 3:\n            C = 11;\n            var cbBits = (bitValue >> 1) & 3;\n            B = (cbBits << 5) | cbBits;\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 127 : 0;\n          result = tri * C + B;\n          result ^= A;\n          result = (A & 0x20) | (result >> 2);\n        }\n\n        if (result > 32) result++;\n\n        cacheUnquantizeTrits[bitLength + tri * 4 + bitValue * 12] = result;\n      }\n    }\n  }\n\n  // -----------------\n  // UNQUANTIZE QUINTS\n  // -----------------\n  var cacheUnquantizeQuints = new Uint8Array(256 * 5 * 3);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var quint = 0; quint < 5; ++quint) {\n      for (var bitLength = 0; bitLength < 3; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 0:\n            result = WEIGHT_QUINT_RANGE[quint];\n            break;\n          case 1:\n            C = 28;\n            break;\n          case 2:\n            C = 13;\n            var bBits = (bitValue >> 1) & 1;\n            B = (bBits << 6) | (bBits << 1);\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 127 : 0;\n          result = quint * C + B;\n          result ^= A;\n          result = (A & 0x20) | (result >> 2);\n        }\n\n        if (result > 32) result++;\n\n        cacheUnquantizeQuints[bitLength + quint * 3 + bitValue * 15] = result;\n      }\n    }\n  }\n\n  ///////////////\n  // CACHE DECODE\n  ///////////////\n\n  // -------------\n  // DECODE SIMPLE\n  // -------------\n  var cacheDecodeSimple = new Uint8Array(256 * 9);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var bitLength = 1; bitLength < 9; ++bitLength) {\n      cacheDecodeSimple[bitLength + bitValue * 9] = replicateBits(bitValue, bitLength, 8);\n    }\n  }\n\n  // ----------------\n  // UNQUANTIZE TRITS\n  // ----------------\n  var cacheDecodeTrits = new Uint8Array(256 * 3 * 7);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var tri = 0; tri < 3; ++tri) {\n      for (var bitLength = 0; bitLength < 7; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 1:\n            C = 204;\n            break;\n          case 2:\n            C = 93;\n            // b000b0bb0\n            var bBit = (bitValue >> 1) & 1;\n            B = (bBit << 8) | (bBit << 4) | (bBit << 2) | (bBit << 1);\n            break;\n          case 3:\n            C = 44;\n            // cb000cbcb\n            var cbBit = (bitValue >> 1) & 3;\n            B = (cbBit << 7) | (cbBit << 2) | cbBit;\n            break;\n          case 4:\n            C = 22;\n            // dcb000dcb\n            var dcbBit = (bitValue >> 1) & 7;\n            B = (dcbBit << 6) | dcbBit;\n            break;\n          case 5:\n            C = 11;\n            // edcb000ed\n            var edcbBit = (bitValue >> 1) & 0xF;\n            B = (edcbBit << 5) | (edcbBit >> 2);\n            break;\n          case 6:\n            C = 5;\n            // fedcb000f\n            var fedcbBit = (bitValue >> 1) & 0x1F;\n            B = (fedcbBit << 4) | (fedcbBit >> 4);\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 511 : 0;\n          result = (tri * C + B) >>> 0;\n          result ^= A;\n          result = (A & 0x80) | (result >> 2);\n        }\n\n        cacheDecodeTrits[bitLength + tri * 7 + bitValue * 21] = result;\n      }\n    }\n  }\n\n  // -----------------\n  // UNQUANTIZE QUINTS\n  // -----------------\n  var cacheDecodeQuints = new Uint8Array(256 * 5 * 6);\n  for (var bitValue = 0; bitValue < 256; ++bitValue) {\n    for (var quint = 0; quint < 5; ++quint) {\n      for (var bitLength = 0; bitLength < 6; ++bitLength) {\n\n        var C = 0;\n        var B = 0;\n        var result;\n        switch (bitLength) {\n          case 1:\n            C = 113;\n            break;\n          case 2:\n            C = 54;\n            // b0000bb00\n            var bBit = (bitValue >> 1) & 1;\n            B = (bBit << 8) | (bBit << 3) | (bBit << 2);\n            break;\n          case 3:\n            C = 26;\n            // cb0000cbc\n            var cbBit = (bitValue >> 1) & 3;\n            B = (cbBit << 7) | (cbBit << 1) | (cbBit >> 1);\n            break;\n          case 4:\n            C = 13;\n            // dcb0000dc\n            var dcbBit = (bitValue >> 1) & 7;\n            B = (dcbBit << 6) | (dcbBit >> 1);\n            break;\n          case 5:\n            C = 6;\n            // edcb0000e\n            var edcbBit = (bitValue >> 1) & 0xF;\n            B = (edcbBit << 5) | (edcbBit >> 3);\n            break;\n        }\n\n        if (bitLength > 0) {\n          var A = bitValue % 2 ? 511 : 0;\n          result = (quint * C + B) >>> 0;\n          result ^= A;\n          result = (A & 0x80) | (result >> 2);\n        }\n\n        cacheDecodeQuints[bitLength + quint * 6 + bitValue * 30] = result;\n      }\n    }\n  }\n\n\n  // TOTO module exports\n  module.exports = {\n    cacheUnquantizeSimple: cacheUnquantizeSimple,\n    cacheUnquantizeTrits: cacheUnquantizeTrits,\n    cacheUnquantizeQuints: cacheUnquantizeQuints,\n    cacheDecodeSimple: cacheDecodeSimple,\n    cacheDecodeTrits: cacheDecodeTrits,\n    cacheDecodeQuints: cacheDecodeQuints\n  };\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n  'use strict';\n\n  /**\n   * Creates a binary mask between two given bounds\n   * @param  {int} a starting bit\n   * @param  {int} b ending bit\n   * @return {int} mask integer containing binary 1 between a and b\n   */\n  var createMask = function(a, b) {\n    var r = 0;\n    for (var i = a; i <= b; ++i)\n      r |= 1 << i;\n\n    return r;\n  };\n\n  /**\n   * Applies the Hamming weight algorithm: looks for the number of bits set to 1\n   * @param  {int} value\n   * @return {int} the number of bits set to 1\n   */\n  var popCount = function(value) {\n    var i = 0;\n    for (; value; ++i)\n      value &= value - 1;\n    return i;\n  };\n\n  /**\n   * Extracts bits from a bounded range\n   * @param  {int} value representing the integer value where the bits are extracted\n   * @param  {int} start the index of the starting bit\n   * @param  {int} stop  the index of the ending bit\n   * @return {int} the integer composed by the extracted bits\n   */\n  var extractBits = function(value, start, stop) {\n    return (value & createMask(start, stop)) >> start;\n  };\n\n\n  /**\n   * Replicates the n lower bits until the given bit index\n   * @param  {int} val contains the bits to replicate\n   * @param  {int} bitsNb describes the number of lower bits to replicate\n   * @param  {int} endBit the \"index\" of the included final bit\n   * @return {int} result containing a number made of the replicated bits\n   */\n  var replicateBits = function(val, bitsNb, endBit) {\n    // Extracts the bitsNb lower bits from the val value\n    var extractedBits = val & ((1 << bitsNb) - 1);\n    var result = extractedBits;\n    var resultLength = bitsNb;\n\n    while (resultLength < endBit) {\n\n      var extractedBitsShift = 0;\n      if (bitsNb > endBit - resultLength) {\n        var newShift = endBit - resultLength;\n        extractedBitsShift = bitsNb - newShift;\n        bitsNb = newShift;\n      }\n\n      // Shifts the result to \"add\" the pattern\n      result <<= bitsNb;\n      result |= extractedBits >> extractedBitsShift;\n      resultLength += bitsNb;\n    }\n\n    return result;\n  };\n\n  /**\n   * Transfers one bit from an integer to another\n   * @param  {array} array containing the two cells to transfer\n   * @param  {uint} i1 the index of the first cell\n   * @param  {uint} i2 the index of the second cell\n   */\n  var bitTransferSigned = function(array, i1, i2) {\n    var a = array[i1];\n    var b = array[i2];\n\n    b >>= 1;\n    b |= a & 0x80;\n    a >>= 1;\n    a &= 0x3F;\n    if (a & 0x20)\n      a -= 0x40;\n\n    array[i1] = a;\n    array[i2] = b;\n  };\n\n  /**\n   * Reads at most 30 bits from the given U8Int array\n   * @param  {U8IntArray} u8buffer buffer containing data to read\n   * @param  {int} beginByteId first byte at which the reading should begin\n   * @param  {int} bitsOffset nth bits at which the reading should begin\n   * @param  {int} bitsNb number of bits to read\n   * @return {int} an integer containing the read bits\n   */\n  var readBits = function(u8buffer, beginByteId, bitsOffset, bitsNb) {\n    if (bitsNb > 30)\n      console.error('The reader can not read more than 30 bits in a row.');\n    if (bitsNb <= 0)\n      return 0;\n\n    // Updates the total number of extracted bits\n    // for the current block\n    //bitsReadCount += bitsNb;\n\n    var bitsReadResult = 0;\n    var offsetByteId = beginByteId + Math.floor(bitsOffset / 8);\n    var endByteId = beginByteId + Math.floor((bitsOffset + bitsNb) / 8);\n    var bornInfBit = bitsOffset % 8;\n    var bornSupBit = (bitsOffset + bitsNb - 1) % 8;\n\n    // Simple reading where data lies on the same byte\n    if (offsetByteId === endByteId)\n      return (u8buffer[offsetByteId] & createMask(bornInfBit, bornSupBit)) >> bornInfBit;\n\n    // Recreates the integer by shifting bytes\n    // the created integer is at most a 24bits integer\n    var shift = 8;\n    bitsReadResult += u8buffer[offsetByteId];\n    for (var i = offsetByteId + 1; i <= endByteId; ++i) {\n      bitsReadResult += u8buffer[i] << shift;\n      shift *= 2;\n    }\n\n    bitsReadResult = (bitsReadResult & createMask(bornInfBit, bornInfBit + bitsNb - 1)) >> bornInfBit;\n\n    return bitsReadResult;\n  };\n\n  /**\n   * Write a given value in colorEndpointData at the byte index\n   * computed from the number of bits currently written.\n   * It is important to note that the number of bits to write in\n   * a row never exceed the size of a byte (8 bits)\n   * @param  {Uint8Array} colorEndpointData destination byte array\n   * @param  {int} bits the value to write\n   * @param  {uint} bitsNb the number of bits to write\n   * @param  {uint} bitsWritten the current number of bits written\n   */\n  var writeBits = function(colorEndpointData, bits, bitsNb, bitsWritten) {\n    colorEndpointData[Math.floor(bitsWritten / 8)] = bits;\n  };\n\n  /**\n   * Reverses the bits in a byte\n   * @param  {uint8} b the byte to reverse\n   * @return {uint32} the reversed byte not casted\n   */\n  var reverseByte = function(b) {\n    // Converts x to a 32 bits unsigned integer\n    b = b >>> 0;\n    return ((b * 0x0802 & 0x22110) | (b * 0x8020 & 0x88440)) * 0x10101 >> 16;\n  };\n\n  /**\n   * Reverses each byte just as the global bytes order\n   * @param  {Uint8Array} u8array the array to reverse\n   */\n  var reverseU8Array = function(u8array) {\n    for (var i = 0; i < u8array.length / 2; ++i) {\n      var a = reverseByte(u8array[i]);\n      var b = reverseByte(u8array[u8array.length - 1 - i]);\n\n      u8array[i] = b;\n      u8array[u8array.length - 1 - i] = a;\n    }\n  };\n\n  module.exports = {\n    popCount: popCount,\n    readBits: readBits,\n    writeBits: writeBits,\n    extractBits: extractBits,\n    replicateBits: replicateBits,\n    bitTransferSigned: bitTransferSigned,\n    reverseU8Array: reverseU8Array\n  };\n\n/***/ }\n/******/ ])\n});\n;"},JoeM:function(e,t,n){"use strict";var i,r=n("Z+Lw"),a=n("fgaA"),o=[{type:"VERTEX_SHADER",text:["attribute vec3 aPosition;","void main() {","gl_Position = vec4(aPosition, 1.0);","}"].join("\n")},{type:"FRAGMENT_SHADER",text:["#version 100","#ifdef GL_FRAGMENT_PRECISION_HIGH","  precision highp float;","#else"," precision mediump float;","#endif","uniform sampler2D uT0;","uniform sampler2D uT1;","uniform sampler2D uT2;","uniform sampler2D uT3;","uniform ivec4 uR;","varying vec2 vT;","varying vec3 vC;","varying vec3 vColor;","varying vec4 vColor2;","void f(in vec3 a, out vec3 b) {","b = 2.0 * a;","}","#define LIN_SRGB(x) x < 0.0031308 ? x * 12.92 : 1.055 * pow(x, 1.0/2.4) - 0.055","#define SRGB_LIN(x) x < 0.04045 ? x * (1.0 / 12.92) : pow((x + 0.055) * (1.0 / 1.055), 2.4)","float linearTosRGB(const in float color) { return LIN_SRGB(color); }","vec3 linearTosRGB(const in vec3 color) { return vec3(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b)); }","vec4 linearTosRGB(const in vec4 color) { return vec4(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b), color.a); }","void main(void) {","vec4 col;","col.r = linearTosRGB(vColor2.r);","col.rgb = linearTosRGB(vColor);","f(vC, col.xyz);","if ( uR.x == 3 ) {","  col.rgb = texture2D( uT0, vT ).aaa;","  col.a = uR.y == 0 ? texture2D( uT1, vT ).r : texture2D( uT1, vT ).a;","} else if ( uR.x == 2 ) {","  col.rgb = texture2D( uT0, vT ).rgb;","  col.a = uR.y == 0 ? texture2D( uT1, vT ).r : texture2D( uT1, vT ).a;","} else {","  col.r = uR.x == 0 ? texture2D( uT0, vT ).r : texture2D( uT0, vT ).a;","  col.g = uR.y == 0 ? texture2D( uT1, vT ).r : texture2D( uT1, vT ).a;","  col.b = uR.z == 0 ? texture2D( uT2, vT ).r : texture2D( uT2, vT ).a;","  col.a = uR.w == 0 ? texture2D( uT3, vT ).r : texture2D( uT3, vT ).a;","}","gl_FragColor = gl_FrontFacing ? vec4(col.rgb, 1.0) : col;","}"].join("\n")}];function s(e){var t=e&&e.getExtension("WEBGL_lose_context");return t&&t.loseContext(),!0}t.a=function(){if(void 0!==window.sketchfabWebGLSupport)return window.sketchfabWebGLSupport;if(i=!1,window.sketchfabWebGLSupport=i,!window.Set||!window.Map||!window.Uint8ClampedArray)return!1;if(Object(r.a)())return!1;var e=null;try{var t=["webgl","experimental-webgl"],n={antialias:!1},u=document.createElement("canvas");if(!u||!u.getContext)return!1;for(var l=0;l<t.length&&!(e=u.getContext(t[l],n));l++);if(!(e&&e.getParameter&&e.getExtension&&e.getShaderPrecisionFormat))return s(e)&&!1;var c=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS);if(!c||c<64)return s(e)&&!1;var h=e.getParameter(e.MAX_VARYING_VECTORS);if(!h||h<8)return s(e)&&!1;var d=e.getExtension("WEBGL_debug_renderer_info");if(d&&"Google SwiftShader"===e.getParameter(d.UNMASKED_RENDERER_WEBGL)&&!Object(a.a)().allowSwiftShader)return s(e)&&!1;i=o.every(function(t){return function(e,t,n){var i=t;"string"==typeof i&&(i=e[t]);var r=e.createShader(i);return e.shaderSource(r,n),e.compileShader(r),!(!e.getShaderParameter(r,e.COMPILE_STATUS)&&!e.isContextLost()&&(console.warn("Could't compile shader "+n),console.warn(e.getShaderInfoLog(r)),console.warn("You may want to consider a browser that fully supports WebGL."),1))}(e,t.type,t.text)}),s(e)}catch(t){return s(e)&&!1}return window.sketchfabWebGLSupport=i,i}},"K/JG":function(e,t,n){"use strict";var i=n("QILm"),r=n.n(i),a=n("nzRv"),o=n("gCTM"),s=n("/kmq"),u=n("77vZ"),l=n("f5KD"),c=n("nPtx"),h=n("WefB"),d=Object(s.a)(function(e){var t=e.createChildrenComponents,n=r()(e,["createChildrenComponents"]);return o.default.getFromString('\n        <div class="c-loading-popup">\n            {{ components.spinner | component }}\n            <p class="c-loading-popup__message">{{ options.message }}</p>\n        </div>\n        ',{options:n,components:t({spinner:{viewClass:h.a,options:{type:"small",style:{margin:"auto"}}}})})});t.a=Object(u.a)(a.a.extend({displayName:"LoadingPopup",optionTypes:{title:l.b.string,message:l.b.string,width:l.b.number},defaultOptions:{title:"",message:"",width:350},template:function(){return o.default.getFromString("{{ components.popup | component }}",{components:this.createChildrenComponents({popup:{viewClass:c.a,options:{title:this.options.title,width:this.options.width,child:{viewClass:d,options:{message:this.options.message}}}}})})}}))},K0P0:function(e,t){e.exports="#define PI 3.141593\n#define saturate(_x) clamp(_x, 0., 1.)\n"},KK83:function(e,t,n){"use strict";var i=n("QLQS").a.osg,r={uProjFactor:i.Uniform.createFloat("uProjFactor"),uSsaoRadius:i.Uniform.createFloat("uSsaoRadius"),uSsaoIntensity:i.Uniform.createFloat("uSsaoIntensity"),uSsaoBias:i.Uniform.createFloat("uSsaoBias"),uSsaoProjectionInfo:i.Uniform.createFloat4("uSsaoProjectionInfo"),uSsaoProjectionScale:i.Uniform.createFloat(1,"uSsaoProjectionScale"),uDofBlurNearFarFocal:i.Uniform.createFloat3("uDofBlurNearFarFocal"),uDofCross:i.Uniform.createFloat3(i.vec3.create(),"uDofCross"),uDofScale:i.Uniform.createFloat(1,"uDofScale"),uBloomFactor:i.Uniform.createFloat("uBloomFactor"),uBloomThreshold:i.Uniform.createFloat("uBloomThreshold"),uBloomRadius:i.Uniform.createFloat("uBloomRadius"),uChromaFactor:i.Uniform.createFloat("uChromaFactor"),uColorBalanceLow:i.Uniform.createFloat3("uColorBalanceLow"),uColorBalanceMid:i.Uniform.createFloat3("uColorBalanceMid"),uColorBalanceHigh:i.Uniform.createFloat3("uColorBalanceHigh"),uToneExposure:i.Uniform.createFloat("uToneExposure"),uToneBrightness:i.Uniform.createFloat("uToneBrightness"),uToneContrast:i.Uniform.createFloat("uToneContrast"),uToneSaturation:i.Uniform.createFloat("uToneSaturation"),uToneMethod:i.Uniform.createInt("uToneMethod"),uDistortion:i.Uniform.createFloat2("uDistortion"),uProjectionLeft:i.Uniform.createFloat4("uProjectionLeft"),uUnprojectionLeft:i.Uniform.createFloat4("uUnprojectionLeft"),uSharpFactor:i.Uniform.createFloat("uSharpFactor"),uLensRadius:i.Uniform.createFloat2("uLensRadius"),uTimeGrain:i.Uniform.createFloat("uTimeGrain"),uGrainFactor:i.Uniform.createFloat("uGrainFactor"),uTaaInvViewMatrixLeft:i.Uniform.createMatrix4("uTaaInvViewMatrixLeft"),uTaaCurrentFramePVLeft:i.Uniform.createMatrix4("uTaaCurrentFramePVLeft"),uTaaLastFramePVLeft:i.Uniform.createMatrix4("uTaaLastFramePVLeft"),uTaaCornersCSLeft:i.Uniform.createFloat4Array("uTaaCornersCSLeft",2),uTaaEnabled:i.Uniform.createFloat(1,"uTaaEnabled"),uTaaInvViewMatrixRight:i.Uniform.createMatrix4("uTaaInvViewMatrixRight"),uTaaCurrentFramePVRight:i.Uniform.createMatrix4("uTaaCurrentFramePVRight"),uTaaLastFramePVRight:i.Uniform.createMatrix4("uTaaLastFramePVRight"),uTaaCornersCSRight:i.Uniform.createFloat4Array("uTaaCornersCSRight",2),uVrFadeFactor:i.Uniform.createFloat(0,"uVrFadeFactor"),uVrVeilFactor:i.Uniform.createFloat(1,"uVrVeilFactor")};t.a=r},"KL/6":function(e,t,n){"use strict";t.a={clamp:function(e,t,n){return Math.min(n,Math.max(t,e))},smoothStep:function(e,t,n){if(n<=e)return 0;if(n>=t)return 1;var i=(n-e)/(t-e);return i*i*(3-2*i)},isNaN:function(e){return e!=e}}},KOua:function(e,t,n){"use strict";(function(e){var i=n("hbEN"),r=n("QLQS"),a=n("i4v/"),o=n("LMwx"),s=n("I/i6"),u=n("uGjJ"),l=n("nLHx"),c=r.a.osg;t.a=a.a.extend({events:{"mouseover .snapshot .button":"showGuides","mouseout .snapshot .button":"hideGuides"},initialize:function(){a.a.prototype.initialize.apply(this,arguments),this.$el.find(".snapshot .button").on("click",this.onSnapshot.bind(this))},onSnapshot:function(t){var n=this.viewer.scene;t.preventDefault();var i=this.$el.find(".snapshot"),r=this.$el.find(".snapshot-flash"),a=this.$el.find(".img-container");if(!i.hasClass("progress")){i.addClass("progress"),r.addClass("active"),setTimeout(function(){r.removeClass("active")},2e3);var o=!0,u=n.getFeatures();if(u.camera){u.camera.getModel().saveCameraPosition();var l=n.getFeatures().saveUI;l||((l=new s.a).init(n.getFeaturesManager()._context),l._views[0].enableSaving()),o=l._views[0].save()}e.all([n.getScreenShot(1920,1080),o]).then(this.onTakeScreenshot.bind(this,i,a))}},onTakeScreenshot:function(e,t,n){var i=n[0].toDataURL("image/jpeg"),r=Object(l.a)(i),a=new o.a({imageFile:r}),s=this.viewer._currentModel,h=a.save({modelUID:s.get("uid")}),d=t.find("img");d&&(d.remove(),null!==this.previewTimeout&&(window.clearTimeout(this.previewTimeout),this.previewTimeout=null));var f=new Image;f.src=i,t.prepend(f),t.removeClass("invisible"),this.previewTimeout=setTimeout(function(){t.addClass("invisible")},4e3),h.then(function(){e.removeClass("progress"),e.addClass("success"),setTimeout(function(){e.removeClass("success")},2e3)}).catch(function(){new u.default({title:"Save settings error",text:"An unexpected error happened. The thumbnail has NOT been saved.",buttons:{ok:!0}}).open(),c.error("Error while saving snapshot"),e.removeClass("progress")})},showGuides:Object(i.a)(function(){this.$(".snapshot-guides").addClass("active")},100),hideGuides:Object(i.a)(function(){this.$(".snapshot-guides").removeClass("active")},100)})}).call(this,n("CSL1"))},KYKV:function(e,t){var n={ApiCoreVersion:"1_0",start:"-",stop:"-",load:"-",gotoAnnotation:"-",getAnnotationList:"-",lookat:"-",setFov:"-",getCurrentTime:"-",play:"-",pause:"-",seekTo:"-",getAnimations:"-",setCurrentAnimationByUID:"-",setCycleMode:"-",setSpeed:"-",getSceneGraph:"-",getNodeMap:"-",getMatrix:"-",setMatrix:"-",hide:"-",show:"-",translate:"-",rotate:"-",getRootMatrixNode:"-",getCameraLookAt:"-",setCameraLookAt:"-",getScreenShot:"-",getMaterialList:"-",getTextureList:"-",addTexture:"-",updateTexture:"-",setTextureQuality:"-",setMaterial:"-",setPostProcessing:"-",getPostProcessing:"-"},i=Object.assign({},n,{getWorldToScreenCoordinates:"-"}),r=Object.assign({},i,{ApiCoreVersion:"1_2",pickColor:"-",setListenerOptions:"-",unselectAnnotation:"-"}),a=Object.assign({},r,{ApiCoreVersion:"1_3",setCameraEasing:"-",showAnnotation:"-",hideAnnotation:"-",getAnnotation:"-",updateAnnotation:"-",createAnnotation:"-",removeAnnotation:"-",pickFromScene:"-",pickFromScreen:"-",addVideoTexture:"-",translate:"-",rotate:"-"}),o=Object.assign({},a,{}),s=Object.assign({},o,{ApiCoreVersion:"1_4",getEnvironment:"-",getLight:"-",getFov:"-",getRootMatrixNode:"-",getShadingStyle:"-",getWireframe:"-",setCurrentAnimationByUID:"-",setEnvironment:"-",setLight:"-",setShadingStyle:"-",setWireframe:"-"}),u=Object.assign({},s,{ApiCoreVersion:"1_5",setAnnotationsTexture:"-",addVideoTexture:"-",gotoAnnotation:"-",setBackground:"-",getBackgroundList:"-",setEnvironment:"-",getEnvironmentList:"-",setCycleMode:"-"}),l=Object.assign({},u,{}),c=Object.assign({},l,{mouseMove:"-",mouseDown:"-",mouseUp:"-",mouseClick:"-",mouseDblClick:"-",mouseWheel:"-",startRecord:"-",endRecord:"-"}),h=Object.assign({},c,{ApiCoreVersion:"1_6",createAnnotationFromScenePosition:"-",createAnnotationFromWorldPosition:"-",getAnimations:"-",hideAnnotationTooltip:"-",removeAllAnnotations:"-",setCameraConstraints:"-",setEnableCameraConstraints:"-",setAnnotationCameraTransition:"-",showAnnotationTooltip:"-",recenterCamera:"-",setUserInteraction:"-"}),d=Object.assign({},h,{ApiCoreVersion:"1_7",setUVOffset:"-",setUVRotation:"-",setUVScale:"-",refreshCanvas:"-",refreshDraw:"-",setHighlightOptions:"-",highlightMaterial:"-"}),f=Object.assign({},d,{setEnableCameraConstraints:"-"});e.exports={"1.0.0":n,"1.0.1":n,"1.0.2":n,"1.0.3":n,"1.1.0":i,"1.2.0":r,"1.2.1":r,"1.3.0":a,"1.3.1":o,"1.4.0":s,"1.4.1":s,"1.4.2":s,"1.5.0":u,"1.5.1":l,"1.5.2":c,"1.6.0":h,"1.7.0":d,"1.7.1":f}},KbKu:function(e,t,n){"use strict";(function(e){var i=n("gcR/"),r=n.n(i),a=n("J4zp"),o=n.n(a),s=n("q1tI"),u=n("wsGC"),l=n("Ql/c"),c=n("yOYh"),h=n("fw8H"),d=n("sgO5"),f=n("NdcT"),p=r()("div",{className:"c-user-orgs__title"},void 0,"Switch to organization");t.a=function(t){var n=t.authUser,i=t.className,a=t.initiallyDisplayed,g=void 0===a?4:a,m=t.isDisplayed,v=s.useRef(null),_=s.useState(g),b=o()(_,2),S=b[0],y=b[1],x=Object(d.a)(function(e,t){return e.Api.getCurrentUserMemberships(t)},[n.uid]);s.useEffect(function(){m&&x.onLoadFirst()},[n.uid,m]),Object(h.a)(v,function(){return x.hasNextPage?x.onLoadNext():e.resolve()},[x],v.current),Object(f.a)(v);var C=x.list;return C&&C.length>0?r()("div",{className:Object(u.a)("c-user-orgs",i)},void 0,C.length>0&&p,s.createElement("div",{className:"c-user-orgs__rows",ref:v},C.slice(0,S).map(function(e){var t=e.org;return r()("li",{className:"c-user-orgs-item"},t.uid,r()(l.a,{to:"orgs:all_models",params:{username:t.username}},void 0,r()("div",{className:"c-user-orgs__row"},void 0,r()(c.a,{className:"c-user-orgs__row-avatar",alt:"Avatar of ".concat(t.username),avatars:t.avatars,size:14}),t.displayName)))}),r()("li",{className:Object(u.a)("c-user-orgs__row",{"--hidden":C.length<=S}),onClick:function(){return y(1/0)}},void 0,"... See all organizations"))):null}}).call(this,n("CSL1"))},KhKb:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("RIqP"),r=n.n(i),a=n("cDf5"),o=n.n(a),s=n("Zo4r");var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return new RegExp(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.reduceRight(function(e,t,i){var r=n[i-1]||"";return"".concat(r).concat(function(e){return e.replace(/\\?\//g,"\\/")}(t)).concat(e)},"")}.apply(void 0,[t].concat(r()(function e(t){return t.map(function(t){if(!t)return"";if(Object(s.a)(t))return function(e){return"".concat(e).slice(1).replace(/\/([gmiyus]){0,6}$/,"")}(t);if(Array.isArray(t))return e(t).join("");if("string"==typeof t)return function(e){return e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}(t);throw new Error('parseRegExpItems error: unsupported param "'.concat(t,'" of type "').concat(o()(t),'"'))})}(i)))),e)}},l=function(e){return"string"==typeof e};function c(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return l(e)?u(e):u().apply(void 0,[e].concat(n))}},Kp3F:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return u});var i=n("par7"),r=n("QLQS").a.osg,a=function(e){this._translateUpdateCallbackListPerNode={},this._rotateUpdateCallbackListPerNode={},this._nodeList=e};a.prototype={addTranslateUpdateCallback:function(e,t,n){var i=this._translateUpdateCallbackListPerNode[n];i&&(r.mat4.setTranslation(e.getMatrix(),i._target),t._source=i._target),this._translateUpdateCallbackListPerNode[n]=t},addRotateUpdateCallback:function(e,t,n){var i=this._rotateUpdateCallbackListPerNode[n];if(i){var a=i._target,o=r.mat4.create(),s=r.vec3.create();r.mat4.fromQuat(o,a),r.mat4.getTranslation(s,e.getMatrix()),r.mat4.setTranslation(o,s),r.mat4.copy(e.getMatrix(),o),t._source=i._target}this._rotateUpdateCallbackListPerNode[n]=t},removeTranslateUpdateCallback:function(e){delete this._translateUpdateCallbackListPerNode[e]},removeRotateUpdateCallback:function(e){delete this._rotateUpdateCallbackListPerNode[e]},update:function(e,t){var n,i,r;for(i in this._rotateUpdateCallbackListPerNode)n=this._rotateUpdateCallbackListPerNode[i],r=this._nodeList[i],n.update(r,t);for(i in this._translateUpdateCallbackListPerNode)n=this._translateUpdateCallbackListPerNode[i],r=this._nodeList[i],n.update(r,t);return!0}};var o=function(e,t,n,i,r){this._source=e,this._target=t,this._duration=n,this._started=-1,this._easing=i,this._finished=!1,this._callback=r};o.prototype={isFinished:function(){return this._finished},update:function(e,t){if(this._finished)return!0;i.a.redrawShadow();var n=t.getFrameStamp().getSimulationTime();this._started<0&&(this._started=n);var r=(n-this._started)/this._duration;return r>1&&(this._finished=!0,this._callback&&this._callback(this._result),r=1),this._easing&&(r=this._easing(r)),this.interpolate(r,e),!0}};var s=function(e,t,n,i,a){o.call(this,e,t,n,i,a),this._result=r.vec3.create()};s.prototype=r.objectInherit(o.prototype,{interpolate:function(e,t){r.vec3.lerp(this._result,this._source,this._target,e),r.mat4.setTranslation(t.getMatrix(),this._result),t.dirtyBound()}});var u=function(e,t,n,i,a){o.call(this,e,t,n,i,a),this._result=r.quat.create(),this._translate=r.vec3.create(),this._finalResult=r.mat4.create()};u.prototype=r.objectInherit(o.prototype,{interpolate:function(e,t){r.quat.slerp(this._result,this._source,this._target,e),r.mat4.getTranslation(this._translate,t.getMatrix()),r.mat4.fromQuat(this._finalResult,this._result),r.mat4.setTranslation(this._finalResult,this._translate),r.mat4.copy(t.getMatrix(),this._finalResult),t.dirtyBound()}})},Kult:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("+lWh");function r(){var e=Object(i.o)("trackers-options","json");try{var t=e.unauthorizedReferrers||[],n=(document.cookie+";").match(/skfb_referrer_override=(.*?);/i),r=document.referrer,a=!1;return n=n&&n.length>1?n[1]:"",n=decodeURIComponent(n),t.forEach(function(e){a||(a=!!r.match(e))}),a&&(console.info("Overriding referrer with : ",n),window.ga("set","referrer",n)),!!a&&n}catch(e){return console.error(e),!1}}},KxLt:function(e,t,n){"use strict";var i=n("CpTu"),r=n("OZf9"),a=n("QLQS").a.osg,o=function(e){this._model=void 0!==e?e.model:void 0,this._viewer=void 0!==e?e.viewer:void 0,this._scene=void 0!==e?e.scene:void 0,this._widgetAPI=void 0!==e?e.widgetAPI:void 0,this._features={}};o.prototype={getModel:function(){return this._model},getFeatures:function(){return this._features},getViewer:function(){return this._viewer},getScene:function(){return this._scene},getWidgetAPI:function(){return this._widgetAPI},addFeature:function(e){if(e){var t=e.getName();this._features[t]?a.error("Feature already added"+t):this._features[t]=e}return this._features},getModelByName:function(e){if(e){var t=Object(i.a)(this._features,function(t){var n=t.getModel();return!(!n||!n.getName)&&n.getName()===e});return t?t.getModel():void 0}},getViewsByName:function(e){if(e){var t=[];return Object(r.a)(this._features,function(n){if(n){var i=n._views.filter(function(t){return!!t.getName&&t.getName()===e});Array.prototype.push.apply(t,i)}}),t}}},t.a=o},LB4S:function(e,t){e.exports='#pragma include "pbr.vert"\n'},LMwx:function(e,t,n){"use strict";var i=n("cDf5"),r=n.n(i),a=n("tNdj"),o=n("eEbW");t.a=a.a.extend({save:function(e,t){return null!=e&&"object"!==r()(e)||(t=e),o.b.createThumbnail({imageFile:this.get("imageFile"),source:this.get("source"),modelUid:t.modelUID})},endpoint:function(){return"/thumbnails"}})},LTW4:function(e,t){e.exports="uniform int uProjectedWireframe;\nuniform int uInspectorView; // see globalUniforms\nuniform vec4 uColor;\n\nvarying vec4 vColor;\n\nvoid main() {\n    gl_FragColor = uProjectedWireframe == 1 ? vec4(uColor.rgb * uColor.a, uColor.a) : vec4(uInspectorView == 1 ? vColor.aaa : vColor.rgb, 1.0);\n}\n"},LTZp:function(e,t,n){"use strict";t.a={RELATIVE_RF:0,ABSOLUTE_RF:1}},LfNR:function(e,t,n){"use strict";var i=n("QLQS").a.osg;t.a=function(e,t,n){for(var r=new i[n](t),a=0,o=0;a!==t;){var s=0,u=0;do{s|=(127&e[o])<<u,u+=7}while(0!=(128&e[o++]));r[a++]=s}if("U"!==n[0])for(var l=0;l<t;++l){var c=r[l];r[l]=c>>1^-(1&c)}return r}},LiSq:function(e,t){e.exports="uniform sampler2D TextureInput;\nuniform sampler2D TextureBloomBlur1;\nuniform sampler2D TextureBloomBlur2;\nuniform sampler2D TextureBloomBlur3;\nuniform sampler2D TextureBloomBlur4;\nuniform sampler2D TextureBloomBlur5;\n\nuniform float uBloomRadius;\nuniform float uBloomFactor;\n\nfloat getRadiusFactored(const float value, const float middle) {\n    return mix(value, middle * 2.0 - value, uBloomRadius);\n}\n\nvec4 bloomCombine() {\n    vec3 bloom = vec3(0.0);\n\n    const float midVal = 0.6;\n\n    const float factor1 = 1.1;\n    const float factor2 = 0.9;\n    const float factor3 = 0.6;\n    const float factor4 = 0.3;\n    const float factor5 = 0.1;\n\n    bloom += TEXTURE_2D_TextureBloomBlur1(gTexCoord).rgb * getRadiusFactored(factor1, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur2(gTexCoord).rgb * getRadiusFactored(factor2, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur3(gTexCoord).rgb * getRadiusFactored(factor3, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur4(gTexCoord).rgb * getRadiusFactored(factor4, midVal);\n    bloom += TEXTURE_2D_TextureBloomBlur5(gTexCoord).rgb * getRadiusFactored(factor5, midVal);\n\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\n    return vec4(color + (bloom * uBloomFactor), 1.0);\n}"},LlpJ:function(e,t,n){"use strict";t.a=function(e){var t=e||{};return window.location&&window.location.hash?(window.location.hash.substr(1).split(",").forEach(function(e){var n=e.split("="),i=n[0],r=n[1];if("debug3d"===i&&(t.debug3D=!0),"stats"===i&&(t.stats=!0),"inspector"===i&&(t.inspector=!0),i.match("material_"))switch(i=i.substr(9)){case"showcase":t.materialShowcase=void 0===r?t.materialShowcase:"0"!==r;break;case"names":t.materialNames=r;break;case"normal":t.materialNormal=r;break;case"emissive":t.materialEmissive=r;break;case"transparency":t.materialTransparency=r;break;case"diffuse":t.materialDiffuse=r;break;case"metalness":t.materialMetalness=r;break;case"roughness":t.materialRoughness=r;break;case"glossiness":t.materialGlossiness=r;break;case"specular":t.materialSpecular=r;break;case"cavity":t.materialCavity=r;break;case"f0":t.materialF0=r;break;case"ao":t.materialAO=r;break;case"displacement":t.materialDisplacement=r;break;case"displacement_factor":t.materialDisplacementFactor=void 0===r?t.materialDisplacementFactor:Number(r)}}),t):t}},LnOO:function(e,t){e.exports='#pragma include "utils/functions.glsl"\n\nvec4 finalPremultAlpha(const in vec4 color) {\n    return vec4(linearTosRGB(sRGBToLinear(color.rgb) * color.a), color.a);\n}'},"M+Bz":function(e,t,n){"use strict";var i=n("q1tI");t.a=function(e){var t=Object(i.useRef)();return Object(i.useCallback)(function(){return t.current?t.current:(t.current=e.apply(void 0,arguments),t.current.catch(function(e){throw t.current=void 0,e}).then(function(e){return t.current=void 0,e}))},[e])}},"M+L8":function(e,t){e.exports="// random links on packing :\n// cesium attributes packing\n// https://cesiumjs.org/2015/05/18/Vertex-Compression/\n\n// float packing in 24 bits or 32 bits\n// https://skytiger.wordpress.com/2010/12/01/packing-depth-into-color/\n\nvec4 encodeDepthAlphaProfileScatter(const in float depth, const in float alpha, const in float profile, const in float scatter) {\n    vec4 pack = vec4(0.0);\n\n    // opacity in alpha\n    pack.a = alpha;\n\n    if(profile == 0.0) {\n        const vec3 code = vec3(1.0, 255.0, 65025.0);\n        pack.rgb = vec3(code * depth);\n        pack.gb = fract(pack.gb);\n        pack.rg -= pack.gb * (1.0 / 256.0);\n    } else {\n        // depth in rg\n        pack.g = fract(depth * 255.0);\n        pack.r = depth - pack.g / 255.0;\n\n        // scatter 6 bits\n        pack.b = floor(0.5 + scatter * 63.0) * 4.0 / 255.0;\n    }\n\n    // profile on 2 lower bits\n    pack.b -= mod(pack.b, 4.0 / 255.0);\n    pack.b += profile / 255.0; // 3 profile possible for sss\n\n    return pack;\n}\n"},M4AY:function(e,t,n){"use strict";var i,r=n("+lWh"),a=n("ANjH"),o=n("Fhuz"),s=n("NcRr"),u=n("t04s"),l=n("lSNA"),c=n.n(l),h=n("MVZn"),d=n.n(h),f=n("wHZf");i||(i={});var p,g,m={},v={effect:function(e,t){return t.effects[e.ORIGINAL]||{}},isPending:function(e,t){return v.effect(e,t).status===f.EffectStatus.Pending},isResolved:function(e,t){return v.effect(e,t).status===f.EffectStatus.Resolved},isRejected:function(e,t){return v.effect(e,t).status===f.EffectStatus.Rejected}},_=n("kj78"),b=n("YBiY"),S=n("9mpE"),y=n("gPpI"),x=n("NpZ0");!function(e){e.INIT_CLIENT="search.INIT_CLIENT",e.UPDATE_QUERY="search.UPDATE_QUERY",e.UPDATE_TYPE="search.UPDATE_TYPE",e.UPDATE_IS_CURRENT_ROUTE="search.UPDATE_IS_CURRENT_ROUTE",e.OPEN="search.OPEN",e.BACK="search.BACK",e.CLOSE="search.CLOSE"}(g||(g={}));var C,w=Object(x.b)({isOpen:!1,isCurrentRoute:!1,query:"",type:"models",previousLocation:""},(p={},c()(p,g.INIT_CLIENT,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){return d()({},e,t)}})}),c()(p,g.UPDATE_QUERY,function(e,t){return d()({},e,{query:t.query})}),c()(p,g.UPDATE_TYPE,function(e,t){return d()({},e,{type:t.type})}),c()(p,g.UPDATE_IS_CURRENT_ROUTE,function(e,t){return d()({},e,{isCurrentRoute:t.isCurrentRoute})}),c()(p,g.OPEN,function(e,t){return t.effect.caseOf({Pending:function(){return d()({},e,{isOpen:!0})},Rejected:function(){return e},Resolved:function(t){return d()({},e,{previousLocation:t})}})}),c()(p,g.BACK,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(){return d()({},e,{isOpen:!1})}})}),c()(p,g.CLOSE,function(e){return d()({},e,{isOpen:!1})}),p)),T={query:function(e){return e.search.query},type:function(e){return e.search.type},isOpen:function(e){return e.search.isOpen},isCurrentRoute:function(e){return e.search.isCurrentRoute},previousLocation:function(e){return e.search.previousLocation||{models:"/models/popular",users:"/members",collections:"/collections"}[T.type(e)]}},M={initClient:function(){return{type:g.INIT_CLIENT,payload:{effect:function(){return{isOpen:!!Object(y.b)("search:search",window.location.pathname),query:S.c.string("q",""),type:S.c.string("type","models")}}}}},updateQuery:function(e){return{type:g.UPDATE_QUERY,payload:{query:e}}},updateType:function(e){return{type:g.UPDATE_TYPE,payload:{type:e}}},updateIsCurrentRoute:function(e){return{type:g.UPDATE_IS_CURRENT_ROUTE,payload:{isCurrentRoute:e}}},open:function(){return function(e,t){if(!T.isOpen(t()))return e({type:g.OPEN,payload:{effect:Object(f.clientOnly)(function(e){var t=e.isServer,n=e.History;if(t)return"";var i=Object(y.b)("search:search",window.location.pathname)?"":window.location.pathname;return n.push(Object(y.e)("search:search")),i},g.OPEN)}})}},back:function(){return function(e,t){if(T.isOpen(t()))return e({type:g.BACK,payload:{effect:Object(f.clientOnly)(function(e){e.History.push(T.previousLocation(t()),{shouldPreventModelPopup:!0})},g.BACK)}})}},close:function(){return{type:g.CLOSE,payload:void 0}}},E=n("gkeB"),A=n("o0o1"),O=n.n(A),R=n("yXPU"),P=n.n(R),I=n("WRMX"),N=n("XiPH");!function(e){e.UPDATE_AVATAR="orgs.UPDATE_AVATAR",e.UPDATE="orgs.UPDATE",e.ADD_MEMBER="orgs.ADD_MEMBER",e.UPDATE_MEMBER="orgs.UPDATE_MEMBER",e.ACTIVATE_MEMBER="orgs.ACTIVATE_MEMBER",e.DEACTIVATE_MEMBER="orgs.DEACTIVATE_MEMBER",e.DELETE_MEMBER="orgs.DELETE_MEMBER",e.SEND_INVITATION="orgs.SEND_INVITATION",e.ACCEPT_INVITATION="orgs.ACCEPT_INVITATION",e.REQUEST_SEATS="orgs.REQUEST_SEATS"}(C||(C={}));var L,k,D={},F={updateAvatar:function(e,t){return{type:C.UPDATE_AVATAR,payload:{effect:function(){var n=P()(O.a.mark(function n(i){var r,a,o,s;return O.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.Api,n.next=3,r.updateOrgAvatar(e,t);case 3:return a=n.sent,o=a.uid,n.next=7,r.pollAvatars(o);case 7:return s=n.sent,n.abrupt("return",{entities:{orgs:c()({},e,{avatars:s})}});case 9:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},update:function(e,t){return{type:C.UPDATE,payload:{effect:function(){var n=P()(O.a.mark(function n(i){var r,a,o;return O.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.Api,a=i.Prefetching,n.next=3,r.updateOrg(e,t);case 3:return o=n.sent,a.register("/i/users/me/orgs/@".concat(o.username),o),a.invalidate("/i/users/me/memberships"),n.abrupt("return",Object(N.b)(o,I.g));case 7:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},addMember:function(e,t,n){return{type:C.ADD_MEMBER,payload:{effect:function(){var i=P()(O.a.mark(function i(r){var a,o,u,l,c,h;return O.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.Api,o=r.Prefetching,u=r.getState,l=r.dispatch,i.next=3,a.addOrgMember(e,t,n);case 3:return c=i.sent,i.next=6,l(F.sendInvite(e,c.uid));case 6:return o.invalidateAllMatchRegExp(/^\/i\/orgs\/\w*\/members.*/),h=s.c.org(e,u()),i.abrupt("return",Object(N.b)(d()({},h,{seatCount:h.seatCount+1}),I.g));case 9:case"end":return i.stop()}},i)}));return function(e){return i.apply(this,arguments)}}()}}},updateMember:function(e,t,n){return{type:C.UPDATE_MEMBER,payload:{effect:function(){var i=P()(O.a.mark(function i(r){var a,o;return O.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.Api,i.next=3,a.updateOrgMember(e,t,n);case 3:return o=i.sent,i.abrupt("return",Object(N.b)(o,I.h));case 5:case"end":return i.stop()}},i)}));return function(e){return i.apply(this,arguments)}}()}}},activateMember:function(e,t){return{type:C.ACTIVATE_MEMBER,payload:{effect:function(){var n=P()(O.a.mark(function n(i){var r,a,o;return O.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.getState,a=i.dispatch,n.next=3,a(F.updateMember(e,t,{status:"active"}));case 3:return o=s.c.org(e,r()),n.abrupt("return",Object(N.b)(d()({},o,{seatCount:o.seatCount+1}),I.g));case 5:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},deactivateMember:function(e,t){return{type:C.DEACTIVATE_MEMBER,payload:{effect:function(){var n=P()(O.a.mark(function n(i){var r,a,o;return O.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.getState,a=i.dispatch,n.next=3,a(F.updateMember(e,t,{status:"inactive"}));case 3:return o=s.c.org(e,r()),n.abrupt("return",Object(N.b)(d()({},o,{seatCount:o.seatCount-1}),I.g));case 5:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},deleteMember:function(e,t){return{type:C.DELETE_MEMBER,payload:{effect:function(){var n=P()(O.a.mark(function n(i){var r,a,o,u;return O.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.Api,a=i.Prefetching,o=i.getState,n.next=3,r.deleteOrgMember(e,t);case 3:return a.invalidateAllMatchRegExp(/^\/i\/orgs\/\w*\/members.*/),u=s.c.org(e,o()),n.abrupt("return",Object(N.b)(d()({},u,{seatCount:u.seatCount-1}),I.g));case 6:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},sendInvite:function(e,t){return{type:C.SEND_INVITATION,payload:{effect:function(){var n=P()(O.a.mark(function n(i){var r;return O.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.Api,n.next=3,r.sendOrgInvite(e,t);case 3:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},acceptInvite:function(e,t){return{type:C.ACCEPT_INVITATION,payload:{effect:function(){var n=P()(O.a.mark(function n(i){var r;return O.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.Api,n.next=3,r.acceptOrgInvite(e,t);case 3:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},requestSeats:function(e,t){return{type:C.REQUEST_SEATS,payload:{effect:function(){var n=P()(O.a.mark(function n(i){var r;return O.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.Api,n.next=3,r.requestOrgSeats(e,t);case 3:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}}},V=n("RIqP"),B=n.n(V),U=n("fp5s");!function(e){e.ADD="messages.ADD",e.ADD_MULTIPLE="messages.ADD_MULTIPLE",e.REMOVE="messages.REMOVE"}(k||(k={}));var j=function(e,t){return d()({},e,{messages:[].concat(B()(e.messages),[t])})},G=Object(x.b)({messages:[]},(L={},c()(L,k.ADD,j),c()(L,k.ADD_MULTIPLE,function(e,t){return t.reduce(j,e)}),c()(L,k.REMOVE,function(e,t){return d()({},e,{messages:e.messages.filter(function(e){return e.uid!==t})})}),L)),H={add:function(e){return{type:k.ADD,payload:d()({},e,{uid:Object(U.a)()})}},addMultiple:function(e){return{type:k.ADD_MULTIPLE,payload:e.map(function(e){return d()({},e,{uid:Object(U.a)()})})}},remove:function(e){return{type:k.REMOVE,payload:e}}},z={authUser:o.d,entities:s.d,cart:u.d,effects:i,storeSearch:_.e,orgSearch:b.e,search:g,models:E.d,orgs:C,messages:k},W=Object(a.c)({authUser:o.b,entities:s.b,cart:u.b,effects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;return Object(f.isEffect)(t)?d()({},e,c()({},t.type,{status:t.payload.effect.type})):e},storeSearch:_.c,orgSearch:b.c,search:w,models:E.b,orgs:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:D},messages:G}),q={authUser:o.c,entities:s.c,cart:u.c,effects:v,storeSearch:_.d,orgSearch:b.d,search:T,models:E.c,orgs:{},messages:{messages:function(e){return e.messages.messages}}},X={authUser:o.a,entities:s.a,cart:u.a,effects:{},storeSearch:_.a,orgSearch:b.a,search:M,models:E.a,orgs:F,messages:H},Y=n("gcR/"),K=n.n(Y),Q=(n("q1tI"),n("/MKj")),J=n("eEbW"),Z=n("aRm7"),$=n("o1A9"),ee=n("Y14P"),te=n("bLLl"),ne=n("a5AJ"),ie=n("+N0+"),re=n("RfQL"),ae=n("8eYQ"),oe=n("Ja3s"),se=n("YL90"),ue=n("gBaA"),le={adroll:ie.a,facebook:re.a,sentry:ae.a,mixpanel:oe.a,ga:ue.a,gtm:se.a},ce=n("m/V4"),he=n("/0FW"),de=n("sINF");function fe(e,t){var n=[de.a,Object(f.createEffectMiddleware)(t)],i=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||a.d;return Object(a.e)(W,e,i(a.a.apply(void 0,n)))}n.d(t,"b",function(){return _e}),n.d(t,"c",function(){return q}),n.d(t,"d",function(){return z}),n.d(t,"a",function(){return X});var pe=Object(r.j)()?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){var n=Object(te.a)(e),i=Object(he.a)(n);return{isServer:!0,Api:Object(J.a)(i),Http:i,CookieBag:{get:function(e,n){return t[e]||n},set:function(){},remove:function(){}},Prefetching:n}}({},{}),n=fe(e,t);return{services:t,store:n,StateProvider:function(e){var i=e.children;return K()(f.EffectContext.Provider,{value:t},void 0,K()(Q.a,{store:n},void 0,i))}}}():function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te.b.get("initialState"),t={isServer:!1,Api:J.b,Http:he.b,LocalStorage:Z,CookieBag:ee.a,Prefetching:te.b,History:ne.a,Popups:$,Trackers:le,Recaptcha:ce.a},n=fe(e,t);Object.values(X).forEach(function(e){e.initClient&&n.dispatch(e.initClient())}),window.__getState=function(){return n.getState()};return{services:t,store:n,StateProvider:function(e){var i=e.children;return K()(f.EffectContext.Provider,{value:t},void 0,K()(Q.a,{store:n},void 0,i))}}}(),ge=pe.store,me=pe.services,ve=pe.StateProvider;Object(r.j)()&&(global.__setStore=function(e){ge=e},global.__setStateProvider=function(e){ve=e});var _e={get Provider(){return ve},get store(){return ge},get services(){return me}}},MAI5:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n("gcR/"),r=n.n(i),a=n("m8R6"),o=n("q1tI"),s=n.n(o),u=n("i8i4"),l=n("M4AY"),c=n("nzRv"),h=function(e){return new Error("\n\nReactDOM.render error: `".concat(e,"` Component doesn't have a valid mount point. Check its selector.\n"))},d=function(e){return Object(a.a)(e,["el","_isChildOfAComponent"])};function f(e){return c.a.extend({displayName:"FromReact(".concat(e.displayName||e.name,")"),optionTypes:e.propTypes,initialize:function(){c.a.prototype.initialize.apply(this,arguments)},viewDidMount:function(){this.render()},viewWillReceiveOptions:function(e){this.renderReact(e)},shouldViewUpdate:function(){return!1},template:function(){return""},render:function(){this.renderReact(this.options)},viewWillUnmount:function(){this.el&&Object(u.unmountComponentAtNode)(this.el)},renderReact:function(t){if(!this.el)throw h(this.displayName);Object(u.render)(r()(l.b.Provider,{},void 0,s.a.createElement(e,d(t))),this.el)}})}},MBd8:function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("J4zp"),o=n.n(a),s=n("q1tI"),u=n.n(s),l=n("/MKj"),c=n("G9Ht"),h=n.n(c),d=n("M4AY"),f=n("oR1v"),p=n("DWw0"),g=n("wsGC"),m=n("gPpI"),v=n("x2jA"),_=n("dvlG"),b=n("NdcT"),S=n("/f4T"),y=n("pVnL"),x=n.n(y),C=r()("path",{d:"M8 12a1 1 0 11.002 1.998A1 1 0 018 12zm-5 0a1 1 0 110 2 1 1 0 010-2zm5.865-2.367a.504.504 0 01-.472.367H2.835a.5.5 0 01-.467-.346L1.783 7.5h7.684l-.602 2.133zM1.111 4.206A.48.48 0 011.501 4h8.952l-.202.717v.004L9.75 6.5H1.511l-.48-1.773a.572.572 0 01.08-.521zM13.5 0h-1.54a.501.501 0 00-.482.364L10.735 3H1.501a1.47 1.47 0 00-1.197.616A1.573 1.573 0 00.071 5.01L1.41 9.936A1.504 1.504 0 002.835 11h5.558c.651 0 1.223-.428 1.43-1.08l1.391-4.932L12.339 1H13.5a.5.5 0 100-1z",transform:"matrix(-1 0 0 1 14 0)",fillRule:"evenodd"}),w=function(e){return u.a.createElement("svg",x()({viewBox:"0 0 14 14"},e),C)},T=function(e){var t=e.count,n=void 0===t?0:t,i=e.title,a=e.action,o=void 0===a?null:a;return r()("div",{className:"c-cart-header"},void 0,r()("p",{className:"c-cart-header__title"},void 0,i),n?r()("span",{className:"c-cart-header__count"},void 0,n):null,r()("div",{className:"c-cart-header__action"},void 0,o))},M=n("89mf"),E=n("YO6B"),A=n("51YE"),O=r()("span",{className:"help"},void 0,r()("i",{className:"fa fa-question-circle"}),r()("span",{className:"tooltip tooltip-right"},void 0,"This model was deleted")),R=r()("span",{className:"help"},void 0,r()("i",{className:"fa fa-question-circle"}),r()("span",{className:"tooltip tooltip-right"},void 0,"This model is no longer for sale")),P=r()("br",{}),I=r()("i",{className:"icon fa fa-times"});function N(e){var t=e.model,n=e.size,i=e.onRemove,a=void 0===i?M.d:i,o=!Object(p.r)(t);return r()("div",{className:Object(g.a)("c-cart-row",n?"--".concat(n):void 0,{"--disabled":o})},void 0,r()("div",{className:"c-cart-row__thumbnail"},void 0,r()("a",{"data-route":!0,href:t.viewerUrl},void 0,r()(E.a,{alt:"Thumbnail for ".concat(t.name," 3D model"),width:70,height:40,images:t.thumbnails}))),r()("div",{className:"c-cart-row__content"},void 0,r()("p",{},void 0,r()("span",{"data-action":"open-model",className:Object(g.a)("c-cart-row__title",{"--deleted":t.isDeleted})},void 0,r()(A.a,{model:t})),t.isDeleted&&O,"store"!==t.downloadType&&R,t.isOwned&&s.createElement(s.Fragment,null,P,r()("a",{className:"skfb-link",href:t.viewerUrl},void 0,"Model already bought"))),r()("p",{className:"c-cart-row__price"},void 0,Object(v.g)(t.price))),a!==M.d&&r()("div",{className:"c-cart-row__actions"},void 0,r()("button",{className:"c-cart-row__remove",onClick:function(e){e.stopPropagation(),a()}},void 0,I)))}var L=r()("p",{className:"c-cart-empty-state__text"},void 0,"Your cart is empty"),k=r()(S.a,{text:"browse store models",type:"store",size:"large"}),D=function(e){var t=e.size,n=void 0===t?"normal":t;return r()("div",{className:"c-cart-empty-state"},void 0,r()("div",{className:Object(g.a)("c-cart-empty-state__image","--".concat(n))}),L,r()("a",{href:Object(m.e)("store:search")},void 0,k))},F=Object(l.c)(function(e){return{cartModels:d.c.cart.models(e)}},{removeModel:d.a.cart.removeModel,getCart:d.a.cart.get}),V=r()(w,{className:"c-page-header__action__icon"}),B=r()(D,{}),U=r()("p",{className:"c-cart-popin__footer__total-title"},void 0,"total"),j=r()("div",{className:"c-cart-popin__footer__button"},void 0,r()(S.a,{text:"go to checkout",type:"store",size:"large"}));t.a=s.memo(F(function(e){var t=e.className,n=e.cartModels,i=e.removeModel,a=e.getCart,u=s.useRef(null),l=s.useRef(null),c=s.useState(!1),d=o()(c,2),S=d[0],y=d[1];return Object(_.a)(u,function(){y(!1)}),Object(b.a)(l),s.useEffect(function(){a()},[]),s.createElement("div",{ref:u,className:Object(g.a)("c-cart-popin","c-page-header__action","--store",t),onClick:function(e){h.a.any||(e.preventDefault(),y(function(e){return!e}))}},r()("a",{"aria-label":"Your shopping cart",className:"c-page-header__action__icon-container",href:Object(m.e)("store:cart")},void 0,V,r()("div",{className:Object(g.a)("c-page-header__action__count","--store",{"--hidden":!n.length})},void 0,n.length)),r()("div",{className:"c-page-header__action__popin-container",onClick:f.g},void 0,S?r()("div",{className:"c-page-header__action__popin c-cart-popin__popin"},void 0,n.length?r()(T,{title:"Shopping Cart",count:n.length}):null,s.createElement("div",{ref:l,className:"c-page-header__action__list c-cart-popin__list"},n.length?n.map(function(e){return r()(N,{model:e,onRemove:function(){return i(e)}},e.uid)}):B),n.length?r()("div",{className:"c-cart-popin__footer"},void 0,r()("div",{className:"c-cart-popin__footer__row c-cart-popin__footer__total"},void 0,U,r()("p",{className:"c-cart-popin__footer__total-price"},void 0,Object(v.g)(Object(p.q)(n)))),r()("a",{href:Object(m.e)("store:checkout"),className:"c-cart-popin__footer__row"},void 0,j)):null):null))}))},MCB2:function(e,t){e.exports='#pragma include "utils/common.glsl"\n#pragma include "utils/lightCommon.glsl"\n\n///////////////////////////\n/// SUBSURFACE TRANSLUCENCY\n///////////////////////////\nvec3 computeLightSSS(\n        const in float dotNL,\n        const in float attenuation,\n        const in float thicknessFactor,\n        const in vec3 translucencyColor,\n        const in float translucencyFactor,\n        const in float shadowDistance,\n        const in vec3 diffuse,\n        const in vec3 lightColor) {\n\n    // http://blog.stevemcauley.com/2011/12/03/energy-conserving-wrapped-diffuse/\n    // float scatter = 0.5;\n    // float wrap = saturate((dotNL + scatter) / ((1.0 + scatter) * (1.0 + scatter)));\n\n    // https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L362\n    float wrap = saturate(0.3 - dotNL);\n    float thickness = max(0.0, shadowDistance / max(0.001, thicknessFactor));\n\n    // http://www.crytek.com/download/2014_03_25_CRYENGINE_GDC_Schultz.pdf\n    // skin approximation vec3(0.98, 0.3, 0.2)\n    float finalAttenuation = translucencyFactor * attenuation * wrap;\n    return finalAttenuation * lightColor * diffuse * exp(-thickness / max(translucencyColor, vec3(0.001))); \n}\n'},MCYI:function(e,t){e.exports='varying vec2 vTexCoord0;\n\nuniform sampler2D uTextureIcon;\nuniform float uAlpha;\nuniform vec2 uScale;\n\n#pragma include "utils/functions.glsl"\n\nvoid main() {\n    vec2 uvCenter = vTexCoord0 * 2.0 - 1.0;\n\n    vec4 icon = texture2D(uTextureIcon, vTexCoord0 * uScale * 10.0);\n\n    float alpha = uAlpha * icon.a * clamp(1.0 - dot(uvCenter, uvCenter), 0.0, 1.0);\n\n    icon.rgb *= alpha;\n    icon.rgb = linearTosRGB(icon.rgb);\n    gl_FragColor = vec4(icon.rgb, alpha);\n}\n'},"ME+G":function(e,t){e.exports="uniform vec2 uTextureInputSize;\nuniform vec3 uDofCross;\n\nuniform vec2 uPixelRatio;\n\nvec4 dofCross(const in vec4 color) {\n    float ratio = uTextureInputSize.y / uTextureInputSize.x;\n    float dist = distance(vec2(uDofCross.x, uDofCross.y * ratio), gTexCoord * vec2(1.0, ratio));\n    float widthCircle = uPixelRatio.x / uTextureInputSize.x;\n    return vec4(mix(color.rgb, vec3(1.0), abs(dist - 60.0 * widthCircle) > widthCircle ? 0.0 : uDofCross.z), color.a);\n}"},Ma4s:function(e,t){e.exports='varying vec3 vLocalVertex;\n\nuniform int uOutputLinear;\nuniform float uAlpha;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n  vec4 color = linearTosRGB(vec4(0.1, 0.66, 0.85, 1.0)) * (smoothstep(1.0, 0.0, vLocalVertex.y) * smoothstep(1.0, 0.0, abs(vLocalVertex.x * 4.0))) * uAlpha;\n\n  gl_FragColor = color;\n}\n'},MdnG:function(e,t){e.exports="attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying float vHeight;\n\nvoid main(void) {\n  vHeight = Vertex.z;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},Mg89:function(e,t){e.exports='#pragma include "utils/getLuminance.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\nuniform float uToneExposure;\nuniform float uToneBrightness;\nuniform float uToneContrast;\nuniform float uToneSaturation;\nuniform int uToneMethod;\n\n#ifdef HAS_FIXED_BACKGROUND\nuniform sampler2D TextureDepth;\n#endif\n\nvec3 toneMapping(const in vec3 color) {\n    vec3 col = color * uToneExposure;\n    float luminance = dot(col * (1.0 + uToneBrightness), vec3(0.2126, 0.7152, 0.0722));\n    col = mix(vec3(luminance), col * (1.0 + uToneBrightness), vec3(uToneSaturation));\n\n    // contrast is annoying and require special treatment in case of fixed background\n    // because it doesn\'t output black when the input is black\n    float toneContrast = uToneContrast;\n#ifdef HAS_FIXED_BACKGROUND\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n    if(alpha == 0.0) toneContrast *= luminance;\n#endif\n    col = max(vec3(0.0), col * (1.0 + toneContrast) - 0.5 * toneContrast);\n\n    // simple reinhard and filmic\n    // http://filmicgames.com/archives/190\n    if(uToneMethod == 1) { // reinhard (on luminance)\n        col /= 1.0 + getLuminance(col);\n    } else if( uToneMethod == 2) { // filmic\n        vec3 x = max(vec3(0.0), col - 0.004);\n        col = (x * (6.2 * x + 0.5) ) / ( x * (6.2 * x + 1.7) + 0.06);\n        col = pow(col, vec3(2.2)); // filmic curve already encode srgb to linear\n    }\n\n    return col;\n}\n\nvec4 toneMapping(const in vec4 color) {\n    return vec4(toneMapping(color.rgb), 1.0);\n}\n'},MzWk:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("MVZn"),r=n.n(i),a=n("RzKY"),o=n("QKgc"),s=500;function u(e){var t=e.loader,n=e.loading,i=n.viewClass,u=n.options,l=void 0===u?{}:u,c=new i(r()({},l,{shouldRejectOnCancel:!0})),h=a.a.fromPromise(t()),d=a.a.fromPromise(Object(a.d)(s)),f=!1;return d.then(function(){f=!0,c.open().catch(function(){h.cancel()})}).catch(Object(o.l)(o.a)),h.then(function(e){var t=e.default;return f?c.close():d.cancel(),t}).catch(function(e){throw f?c.close():d.cancel(),e}).catch(function(e){throw e instanceof o.a?new o.j:e})}},N3k8:function(e,t,n){"use strict";var i=function(){this._globalDefault=void 0,this._lastApplied=void 0,this._changed=!1,this._values=[],this._back=void 0,this._length=0};i.prototype={getLength:function(){return this._length},push:function(e,t){var n;this._length===this._values.length?(n={object:e,value:t},this._values.push(n)):((n=this._values[this._length]).object=e,n.value=t),this._back=n,this._length++},pop:function(){if(this._length){var e=this._values;this._length--;var t=e[this._length];return this._back=this._length?e[this._length-1]:void 0,t}}},t.a=i},N4IH:function(e,t){e.exports="uniform float uVrVeilFactor;\r\n\r\nvec4 veilVr(const in vec4 color) {\r\n\treturn vec4(color.rgb * uVrVeilFactor, 1.0);\r\n}"},N68w:function(e,t){e.exports='attribute vec3 BonesColor;\nvarying vec3 vBonesColor;\n\n#define NO_JITTER\n#define INJECT_VERT vBonesColor = BonesColor;\n\n#pragma include "base.vert"\n'},ND70:function(e,t){e.exports="attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec3 vLocalVertex;\n\nvoid main(void) {\n  vLocalVertex = Vertex;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},NG5u:function(e,t,n){"use strict";var i=n("EVdn"),r=n.n(i);t.a=function(){r()(document).on("focus blur","*",function(e){var t=r()(e.target).attr("id"),n=e.target===document.activeElement;void 0!==t&&r()("label[for]").filter(function(){return r()(this).attr("for")===t}).toggleClass("focused",n)}),r()(document).on("input","input, textarea",function(e){r()(e.target).addClass("edited").toggleClass("empty",""===r()(e.target).val())}),r()(document).on("submit","form:not([action])",function(e){e.preventDefault()}),r()(document.documentElement).addClass("ready"),r()(document).on("keydown","form textarea",function(e){e.ctrlKey&&13===e.keyCode&&r()(e.target).closest("form").submit()}),r()(document).on("click","a",function(e){if(0!==(e.currentTarget!==e.target?r()(e.target).parentsUntil(e.currentTarget):r()()).addBack().filter("[data-action]").length){var t=r()(e.target).parents().filter("[href]");0!==t.length&&"#"!==t.eq(0).attr("href")||e.preventDefault()}}),r()(document).on("mousedown","label[for]",function(e){if(e.target===e.currentTarget){var t=r()(e.currentTarget).attr("for"),n=document.getElementById(t);n&&n===document.activeElement&&e.preventDefault()}})}},NNol:function(e,t,n){"use strict";n.d(t,"b",function(){return c});var i,r,a,o=n("fgaA"),s=n("par7"),u=document.createElement("canvas"),l=document.createElement("canvas"),c=function(e,t,n,a){return a||(a=l),function(e,t,n,i){u.width===t&&u.height===n||(i.width=t,i.height=n,u.width=t,u.height=n,r=new Uint8Array(4*t*n));var a=e.getGraphicContext(),o=a.checkFramebufferStatus(a.FRAMEBUFFER);if(o!==a.FRAMEBUFFER_COMPLETE)return console.error("FRAMEBUFFER status invalid.",o);a.flush(),a.finish(),a.readPixels(0,0,t,n,a.RGBA,a.UNSIGNED_BYTE,r);var s=u.getContext("2d"),l=s.getImageData(0,0,t,n);l.data.set(r),s.putImageData(l,0,0);var c=i.getContext("2d");c.clearRect(0,0,t,n),c.fillStyle="transparent",c.fillRect(0,0,t,n),c.save(),c.globalCompositeOperation="copy",c.scale(1,-1),c.drawImage(u,0,0,t,n,0,-n,t,n),c.restore()}(e,t,n,a),Object(o.a)().downloadPicture&&(i||(i=document.createElement("a"),document.body.appendChild(i),i.style.display="none"),i.href=a.toDataURL("image/jpeg"),i.download="image.jpg",i.click()),a},h=function(e){e.getScene().updateSceneGraph(e.getUpdateVisitor());var t=e.getCamera().getRenderer();t.cull(),t.draw()};t.a=function(e,t,n,i){var r=n.getSuperSample(),o=n.getViewerOSGJS();if(e&&t||(e=o.getCanvasWidth(),t=o.getCanvasHeight()),function(e,t,n){var i=e.getFeatures(),r=e.getSuperSample(),o=e.getViewerOSGJS(),u=e.getFeaturesManager().getNodeGizmo(),l=o.getCamera();for(var d in i)i[d].prepareForScreenShot();a=void 0,u&&u.getNodeMask()&&(a=u.getNodeMask(),u.setNodeMask(0)),e.trigger("resizeViewer",t,n),o.updateViewport(),s.a.setPoseForScreenshot(!0),o.checkNeedToDoFrame(),h(o),l.setFinalDrawCallback(function(e){r.isEnabled()||c(e,t,n)})}(n,e,t),r.canBeEnabled())for(r.forceEnable();r.isEnabled();)r.updateFrame(),h(o);else h(o);return function(e){var t=e.getFeatures(),n=e.getViewerOSGJS(),i=e.getFeaturesManager().getNodeGizmo(),r=n.getCamera();for(var o in s.a.setPoseForScreenshot(!1),r.setFinalDrawCallback(void 0),t)t[o].resetAfterScreenShot();a&&i.setNodeMask(a),e.trigger("resizeViewerOnNextFrame",-1,-1)}(n),i||(o.updateViewport(),n.getFeatures().inspector.getModel().trigger("change:viewerToCanvasRatio")),l}},NYmz:function(e,t,n){n("QF8f"),(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/partials/embed/iframe.jinja"]={root:function(e,t,n,i,r){var a=null,o=null,s="";try{e.getTemplate("skfb_front/macros/model.jinja",!1,"skfb_front/partials/embed/iframe.jinja",!1,function(u,l){u?r(u):l.getExported(function(u,l){if(u)r(u);else if(l.hasOwnProperty("model_iframe")){var c=l.model_iframe;t.setVariable("model_iframe",c),s+='<div class="sketchfab-embed-wrapper">',s+=i.suppressValue((a=0,o=108,i.callWrap(c,"model_iframe",t,[e.getFilter("query_string").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"model"),"embedUrl"),i.memberLookup(i.contextOrFrameLookup(t,n,"parameters"),"flags")),{width:i.memberLookup(i.contextOrFrameLookup(t,n,"parameters"),"width"),height:i.memberLookup(i.contextOrFrameLookup(t,n,"parameters"),"height")}])),e.opts.autoescape),i.memberLookup(i.contextOrFrameLookup(t,n,"parameters"),"byline")&&(s+='\n    <p style="font-size: 13px; font-weight: normal; margin: 5px; color: #4A4A4A;">\n        <a href="',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"model"),"viewerUrl"),e.opts.autoescape),s+=i.suppressValue(e.getFilter("safe").call(t,i.contextOrFrameLookup(t,n,"anchor")),e.opts.autoescape),s+='" target="_blank" style="font-weight: bold; color: #1CAAD9;">',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"model"),"name"),e.opts.autoescape),s+='</a>\n        by <a href="',s+=i.suppressValue(i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"model"),"user"),"profileUrl"),e.opts.autoescape),s+=i.suppressValue(e.getFilter("safe").call(t,i.contextOrFrameLookup(t,n,"anchor")),e.opts.autoescape),s+='" target="_blank" style="font-weight: bold; color: #1CAAD9;">',s+=i.suppressValue(i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"model"),"user"),"displayName"),e.opts.autoescape),s+='</a>\n        on <a href="https://sketchfab.com',s+=i.suppressValue(e.getFilter("safe").call(t,i.contextOrFrameLookup(t,n,"anchor")),e.opts.autoescape),s+='" target="_blank" style="font-weight: bold; color: #1CAAD9;">Sketchfab</a>\n    </p>\n'),r(null,s+="</div>\n")}else r(new Error("cannot import 'model_iframe'"))})})}catch(e){r(i.handleError(e,a,o))}}}},NcRr:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"b",function(){return y}),n.d(t,"c",function(){return x}),n.d(t,"a",function(){return C});var i,r,a=n("o0o1"),o=n.n(a),s=n("yXPU"),u=n.n(s),l=n("lSNA"),c=n.n(l),h=n("XiPH"),d=n("WRMX"),f=n("NpZ0"),p=n("wHZf"),g=n("Ui7z"),m=Object(g.j)(3);!function(e){e.UPDATE="entities.UPDATE",e.GET_CATEGORIES="entities.GET_CATEGORIES"}(r||(r={}));var v={models:{},users:{},collections:{},categories:{},licenses:{},comments:{},reviews:{},orgs:{},orgMembers:{},orgProjects:{},uploadActivities:{},collectionActivities:{},collectActivities:{},commentActivities:{},followActivities:{},subscribeActivities:{},likeActivities:{},staffpickActivities:{},reviewActivities:{},reviewReplyActivities:{},optimistic:{}},_=function(e,t){return t.payload&&t.payload.entities?Object(g.l)(t.payload.entities,e):e},b=Object(p.optimistic)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;return Object(p.isEffect)(t)?t.payload.effect.caseOf({Pending:function(){return _(e,t)},Rejected:function(){return e},Resolved:function(t){return t&&t.entities?m(e,t.entities):e}}):_(e,t)}),S=Object(f.b)(v,(i={},c()(i,r.UPDATE,function(e,t){return m(e,t.entities)}),c()(i,r.GET_CATEGORIES,function(e){return e}),i)),y=Object(f.a)(b,S),x={all:function(e){return e.entities},model:function(e,t){return Object(h.a)(e,d.f,t.entities)},user:function(e,t){return Object(h.a)(e,d.k,t.entities)},collection:function(e,t){return Object(h.a)(e,d.c,t.entities)},category:function(e,t){return Object(h.a)(e,d.b,t.entities)},categoryBySlug:function(e,t){return x.allCategories(t).find(function(t){return t.slug===e})},allCategories:function(e){return Object.values(e.entities.categories).sort(function(e,t){return e.slug<t.slug?-1:1})},license:function(e,t){return Object(h.a)(e,d.e,t.entities)},comment:function(e,t){return Object(h.a)(e,d.d,t.entities)},review:function(e,t){return Object(h.a)(e,d.j,t.entities)},org:function(e,t){return Object(h.a)(e,d.g,t.entities)},orgMember:function(e,t){return Object(h.a)(e,d.h,t.entities)},project:function(e,t){return Object(h.a)(e,d.i,t.entities)},activity:function(e,t){return Object(h.a)(e,d.a,t.entities)}},C={getCategories:function(){return{type:r.GET_CATEGORIES,payload:{effect:function(){var e=u()(o.a.mark(function e(t){var n,i,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Api,e.next=3,n.getCategories();case 3:return i=e.sent,r=i.results,e.abrupt("return",Object(h.b)(r,[d.b]));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}}},update:function(e){var t=e.models,n=void 0===t?[]:t,i=e.users,a=void 0===i?[]:i,o=e.collections,s=void 0===o?[]:o,u=e.categories,l=void 0===u?[]:u,c=e.licenses,f=void 0===c?[]:c,p=e.comments,g=void 0===p?[]:p,v=e.reviews,_=void 0===v?[]:v,b=e.orgs,S=void 0===b?[]:b,y=e.orgMembers,x=void 0===y?[]:y,C=e.orgProjects,w=void 0===C?[]:C,T=e.activities,M=void 0===T?[]:T;return{type:r.UPDATE,payload:{entities:m(Object(h.b)(n,[d.f]).entities,Object(h.b)(a,[d.k]).entities,Object(h.b)(s,[d.c]).entities,Object(h.b)(l,[d.b]).entities,Object(h.b)(f,[d.e]).entities,Object(h.b)(g,[d.d]).entities,Object(h.b)(_,[d.j]).entities,Object(h.b)(S,[d.g]).entities,Object(h.b)(x,[d.h]).entities,Object(h.b)(w,[d.i]).entities,Object(h.b)(M.map(function(e){var t=e.obj,n=e.target,i=e.actor,r=e.verb;return{timestamp:e.timestamp,uid:e.uid,obj:t,target:n,actor:i,verb:r}}),[d.a]).entities)}}}}},NdcT:function(e,t,n){"use strict";var i=n("q1tI"),r=n("cQ/I");t.a=function(e){var t=i.useRef(0);Object(r.a)(e,"wheel",function(e){var t=-.25*e.wheelDelta;t&&(e.preventDefault(),e.currentTarget.scrollTop=t+e.currentTarget.scrollTop)}),Object(r.a)(e,"touchstart",function(e){t.current=e.touches[0].pageY}),Object(r.a)(e,"touchmove",function(e){e.preventDefault();var n=t.current-e.touches[0].pageY;t.current=e.touches[0].pageY,e.currentTarget.scrollTop=n+e.currentTarget.scrollTop})}},NpZ0:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return o});var i=n("Ui7z"),r=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,i=arguments.length>1?arguments[1]:void 0;return t[i.type]?t[i.type](n,i.payload):n}},a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n){return t.reduceRight(function(e,t){return t(e,n)},e)}},o=function(e,t,n){var r=t(e.getState());return e.subscribe(function(){var a=t(e.getState());(function(e,t){return e===t||Object(i.f)(e)&&Object(i.f)(t)&&Object(i.g)(e,t)})(r,a)||(n(a),r=a)})}},NuLH:function(e,t,n){"use strict";var i=function(){var e=function(e){return'<div style="margin: auto; width:500px;z-index:10000;margin-top:20em;text-align:center;">'+e+"</div>"},t='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',n='It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org">Click here for more information.</a>',i=!0,r=function(e,t,n){for(var i=null,r=0;r<n.length;++r){try{i=e.getContext(n[r],t)}catch(e){}if(i)break}return i},a=function(e,t){var n;if(t&&t.webgl2){if(i=!1,n=r(e,t,["webgl2","experimental-webgl2"]))return n;i=!0}return r(e,t,["webgl","experimental-webgl","webkit-3d","moz-webgl"])};return{create3DContext:a,setupWebGL:function(r,o,s){s=s||function(r){if(i){var a=document.getElementsByTagName("body")[0];if(a){var o=window.WebGLRenderingContext?n:t;r&&(o+="<br/><br/>Status: "+r),a.innerHTML=e(o)}}},r.addEventListener&&r.addEventListener("webglcontextcreationerror",function(e){s(e.statusMessage)},!1);var u=a(r,o);return u||s(""),u}}}();window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}),window.cancelRequestAnimFrame||(window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout),Date.now||(Date.now=function(){return(new Date).getTime()}),t.a=i},"O+7P":function(e,t){e.exports='uniform vec3 uDofBlurNearFarFocal;\n\n#pragma include "dofCommon.glsl"\n\nuniform sampler2D TextureDofCoC;\nuniform vec2 uTextureDofCoCSize;\nuniform sampler2D TextureDepth;\n\nuniform float uDofScale;\n\nvec4 dilateNear(const in vec2 offset) {\n    if(uDofBlurNearFarFocal.x < EPS_EARLY_OUT && uDofBlurNearFarFocal.y < EPS_EARLY_OUT){\n        return vec4(0.0);\n    }\n\n    // TODO DOF both the weights and the formula can be tweaked, also we could add a bit of jitter or something\n    vec2 uv = gTexCoord;\n    bool isBG = TEXTURE_2D_TextureDepth(uv).x == 1.0;\n\n    float coc = 0.0;\n    vec2 ofs = MAX_BLUR * offset / 5.0;\n\n    float coc0 = TEXTURE_2D_TextureDofCoC(uv).a * 2.0 - 1.0;\n    float coc1 = TEXTURE_2D_TextureDofCoC(uv - 5.0 * ofs).a * 2.0 - 1.0;\n    float coc2 = TEXTURE_2D_TextureDofCoC(uv - 4.0 * ofs).a * 2.0 - 1.0;\n    float coc3 = TEXTURE_2D_TextureDofCoC(uv - 3.0 * ofs).a * 2.0 - 1.0;\n    float coc4 = TEXTURE_2D_TextureDofCoC(uv - 2.0 * ofs).a * 2.0 - 1.0;\n    float coc5 = TEXTURE_2D_TextureDofCoC(uv - 1.0 * ofs).a * 2.0 - 1.0;\n    float coc6 = TEXTURE_2D_TextureDofCoC(uv + 1.0 * ofs).a * 2.0 - 1.0;\n    float coc7 = TEXTURE_2D_TextureDofCoC(uv + 2.0 * ofs).a * 2.0 - 1.0;\n    float coc8 = TEXTURE_2D_TextureDofCoC(uv + 3.0 * ofs).a * 2.0 - 1.0;\n    float coc9 = TEXTURE_2D_TextureDofCoC(uv + 4.0 * ofs).a * 2.0 - 1.0;\n    float coc10 = TEXTURE_2D_TextureDofCoC(uv + 5.0 * ofs).a * 2.0 - 1.0;\n\n    if(isBG == true){\n        // avoid "shrink" effect on the out of focus far part on the model edges\n        // gaussian weights (sigma 10), (doesn\'t have to be gaussian though), but the sum must be 1.0\n        // http://dev.theomader.com/gaussian-kernel-calculator/\n        coc = abs(coc0) * 0.095474 +\n        (abs(coc1) + abs(coc10)) * 0.084264 +\n        (abs(coc2) + abs(coc9)) * 0.088139 +\n        (abs(coc3) + abs(coc8)) * 0.091276 +\n        (abs(coc4) + abs(coc7)) * 0.093585 +\n        (abs(coc5) + abs(coc6)) * 0.094998;\n    } else {\n        // blur only near field (expand)\n        coc = min(coc0, 0.0);\n        coc = min(coc1 * 0.3, coc);\n        coc = min(coc2 * 0.5, coc);\n        coc = min(coc3 * 0.75, coc);\n        coc = min(coc4 * 0.8, coc);\n        coc = min(coc5 * 0.95, coc);\n        coc = min(coc6 * 0.95, coc);\n        coc = min(coc7 * 0.8, coc);\n        coc = min(coc8 * 0.75, coc);\n        coc = min(coc9 * 0.5, coc);\n        coc = min(coc10 * 0.3, coc);\n        if(abs(coc0) > abs(coc)) coc = coc0;\n    }\n\n    return vec4(0.0, 0.0, 0.0, coc * 0.5 + 0.5);\n}\n\nvec4 dofNearDilateH() {\n    vec2 offset = vec2(uDofScale / uTextureDofCoCSize.x, 0.0);\n    return dilateNear(offset);\n}\n\nvec4 dofNearDilateV() {\n    vec2 offset = vec2(0.0, uDofScale / uTextureDofCoCSize.y);\n    return dilateNear(offset);\n}'},O67m:function(e,t,n){"use strict";var i=n("jge3");t.a={name:"LazyLoading",handleLazyLoading:function(){var e=this,t=function(){var t=e.$(".lazyload");if(t.length){var n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;if(!(u instanceof HTMLElement))break;Object(i.b)(u)}}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}t.removeClass("lazyload")}};"complete"===document.readyState?t():window.addEventListener("load",t)},afterInitialize:function(){this.handleLazyLoading()},afterViewDidMount:function(){this.handleLazyLoading()},afterViewDidUpdate:function(){this.handleLazyLoading()}}},"OD5+":function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=(n("q1tI"),n("YO6B"));t.a=function(e){var t=e.user,n=e.width,i=void 0===n?20:n,o=e.height,s=void 0===o?20:o;return r()("div",{className:"avatar","data-user-summary-anchor":"true","data-user":t.uid},void 0,r()(a.a,{alt:"Avatar of ".concat(t.username),images:t.avatars,width:i,height:s}))}},OLaa:function(e,t,n){"use strict";t.a=["4024128cf8904b69946e891caac5f305","b83e3a8794ae47e0b4039e7fdb031602","16cdcddf277d423d99094f8db0c731e9","efd4ef0fc18a4ec0a1313d782fade965","675ff0f13b474c62947097939fe9aa1e","df5b82c5ccec42cbb9c5ba9528f0be52","491ddabd93aa49ecb5ad36538f7d00e3","02751cd893a14f3986fb17a90245f64f","78a54c2fd53a4ba4891a4bbdac7f30f7","956bb00775a044e7afdd1c17f6bdab63","003c1543cd754a19a0e14bc89726ccf5","268447ca0a954f44b06d1387863d114e","80fba9759ab94307a782f38d359b8ea8","e73867d210de4bc2b5eb261738cf3e79","2e9c3708feb74137b0436f946b8b66b8","591b2c2db5744df1803a09d477f5a2c7"]},"OT+x":function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec4 vProjCoord;\n\nvoid main(void) {\n  gl_Position = vec4(TexCoord0 * 2.0 - 1.0, 0.0, 1.0);\n  vProjCoord = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  vProjCoord = uProjectionMatrix * vProjCoord;\n  vProjCoord = vProjCoord / vProjCoord.w * 0.5 + 0.5;\n}\n"},OVPj:function(e,t){e.exports='#define NO_JITTER 1\n#pragma include "base.vert"\n'},OZ7T:function(e,t,n){"use strict";var i=n("QLQS"),r=i.a.osg,a=i.a.osgAnimation,o={wireframe:!0,epsilon:!0,nphi:!0,attributes:!0,vertex_mode:!0,triangle_mode:!0,rigIndex:!0,framerate:!0,bx:!0,by:!0,bz:!0,hx:!0,hy:!0,hz:!0,ox:!0,oy:!0,oz:!0,ow:!0,ot:!0,channel_mode:!0},s=function(){r.NodeVisitor.call(this)};s.convertUserDataToObject=function(e,t){var n=t||{};if(!e)return n;for(var i=0,r=e.length;i<r;++i){var a=e[i],s=a.Name;o[s]||-1!==s.indexOf("_bbl_")||-1!==s.indexOf("_h_")||-1!==s.indexOf("_mode")?n[s]=JSON.parse(a.Value):n[s]=a.Value}return n},s.instanceIDGeometryMap={},s.uidGeometryMap={},s.hasPoints=!1,s.hasTriangles=!1,s.hasLines=!1,s.hasVertexNormals=!1,s.hasBones=!1,s.hasRigsOrMorphs=!1,r.createPrototypeObject(s,r.objectInherit(r.NodeVisitor.prototype,{apply:function(e){var t=e instanceof r.Geometry;if(t&&(void 0!==e._uniqueID&&(s.uidGeometryMap[e._uniqueID]=e),s.instanceIDGeometryMap[e.getInstanceID()]=e,!s.hasRigsOrMorphs)){var n=e instanceof a.RigGeometry,i=e instanceof a.MorphGeometry;s.hasRigsOrMorphs=n||i}var o=e instanceof a.Bone;if(s.hasBones=s.hasBones||o,t||o){e.userDataMap=s.convertUserDataToObject(e.getUserData());var u=e;if(e.getSourceGeometry&&(u=e.getSourceGeometry(),s.convertUserDataToObject(u.getUserData(),e.userDataMap)),u instanceof a.MorphGeometry)for(var l=u.getMorphTargets(),c=0,h=l.length;c<h;++c){var d=e.userDataMap["morph_"+c]={};s.convertUserDataToObject(l[c].getUserData(),d)}}return this.traverse(e)}})),t.a=s},OZCL:function(e,t,n){"use strict";var i=n("QVk6"),r=n("AwiE"),a=function(e,t){this.mode=i.a.POINTS,void 0!==e&&("string"==typeof e&&(e=i.a[e]),this.mode=e),this.count=0,this.offset=0,this.indices=t,this.uType=a.UNSIGNED_SHORT,void 0!==t&&this.setIndices(t)};a.UNSIGNED_BYTE=5121,a.UNSIGNED_SHORT=5123,a.UNSIGNED_INT=5125,a.prototype={getMode:function(){return this.mode},draw:function(e){0!==this.count&&(e.setIndexArray(this.indices),this.drawElements(e))},drawElements:function(e){e.getGraphicContext().drawElements(this.mode,this.count,this.uType,this.offset)},setIndices:function(e){var t=e.getElements();r.a.instance().isWebGL2()&&(1===t.BYTES_PER_ELEMENT?-1!==t.indexOf(255)&&(e.setElements(new Uint16Array(t)),t=e.getElements()):2===t.BYTES_PER_ELEMENT?-1!==t.indexOf(65535)&&(e.setElements(new Uint32Array(t)),t=e.getElements()):4===t.BYTES_PER_ELEMENT&&-1!==t.indexOf(4294967295)&&console.error("primitives restart in a 32bits index buffer, unhandled")),this.indices=e,this.count=t.length;var n=t.BYTES_PER_ELEMENT;1===n?this.uType=a.UNSIGNED_BYTE:2===n?this.uType=a.UNSIGNED_SHORT:4===n&&(this.uType=a.UNSIGNED_INT)},getIndices:function(){return this.indices},setFirst:function(e){this.offset=e},getFirst:function(){return this.offset},setCount:function(e){this.count=e},getCount:function(){return this.count},getNumIndices:function(){return this.indices.getElements().length},index:function(e){return this.indices.getElements()[e]}},t.a=a},Og9V:function(e,t){e.exports='\n#pragma include "shadowing/shadowReceive.glsl"\n\nvarying vec3 vModelNormal;\nvarying vec3 vModelVertex;\n\nvoid main() {\n    vec3 modelNormal = normalize(gl_FrontFacing ? vModelNormal : -vModelNormal);\n    #ifdef _ATLAS_SHADOW\n        float shadow = shadowReceive(true, modelNormal, vModelVertex, Texture7, uShadow_Texture0_renderSize, uShadow_Texture0_projection, uShadow_Texture0_viewRight, uShadow_Texture0_viewUp, uShadow_Texture0_viewLook, uShadow_Texture0_depthRange, uShadowReceive0_bias, uShadow_Texture0_mapSize, uStaticFrameNumShadow0);\n    #else\n        float shadow = shadowReceive(true, modelNormal, vModelVertex, Texture12, uShadow_Texture0_renderSize, uShadow_Texture0_projection, uShadow_Texture0_viewRight, uShadow_Texture0_viewUp, uShadow_Texture0_viewLook, uShadow_Texture0_depthRange, uShadowReceive0_bias, uStaticFrameNumShadow0);\n    #endif\n\n    // not much blending, so no need to convert to srgb\n    // gl_FragColor = vec4(0.0, 0.0, 0.0, linearTosRGB(0.5 - shadow));\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 0.5 - shadow);\n}\n'},Onwk:function(e,t){e.exports="attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying float vHeight;\n\nvoid main(void) {\n  vHeight = Vertex.z;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},Ou4k:function(e,t,n){"use strict";var i=n("q1tI"),r=i.createContext({});t.a=r},P1HB:function(e,t,n){"use strict";n.d(t,"k",function(){return c}),n.d(t,"i",function(){return h}),n.d(t,"j",function(){return d}),n.d(t,"g",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"b",function(){return g}),n.d(t,"c",function(){return m}),n.d(t,"e",function(){return v}),n.d(t,"d",function(){return b}),n.d(t,"h",function(){return y}),n.d(t,"l",function(){return x}),n.d(t,"f",function(){return C});var i=n("RIqP"),r=n.n(i),a=n("J4zp"),o=n.n(a),s=n("12sq"),u=["plus","pro","prem","biz","ent"],l=["basic"].concat(u);function c(e){return s.a.planLabels[e]}function h(e,t){return u.indexOf(e)>u.indexOf(t)}function d(e,t){return u.indexOf(e)>=u.indexOf(t)}function f(e,t){return!!e.isStaff||!!u.includes(t)&&u.slice(u.indexOf(t)).includes(e.account)}function p(e){return l.indexOf(e)<l.indexOf("pro")}function g(e){return l[l.indexOf(e)+1]}function m(e){return v(g(e))}function v(e){return s.a.planLabels[e]||null}var _=Object.entries(s.a.maxModelFilesizes).sort(function(e,t){return e[1]-t[1]||(h(e[0],t[0])?-1:1)});function b(e){var t=!0,n=!1,i=void 0;try{for(var r,a=_[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=o()(r.value,2),u=s[0];if(s[1]>e)return u}}catch(e){n=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return"ent"}var S=Math.max.apply(Math,r()(Object.values(s.a.maxModelFilesizes)));function y(e){return e>S}function x(e){if("basic"===e.account)return!0;if("unlimited"===e.viewOnlyLimit.type)return!1;if(0===e.viewOnlyLimit.remaining)return!0;var t=.25*s.a.plansViewOnlyLimit[e.account];return e.viewOnlyLimit.remaining<=t}var C=function(e){return!e.isAnonymous&&("unlimited"===e.viewOnlyLimit.type||e.viewOnlyLimit.remaining>0)}},P40d:function(e,t){e.exports="vec3 morphing(const in vec4 weights, const in vec3 vertex, const in vec3 target0) {\n    return mix(vertex, target0, weights[0]);\n}\n\nvec3 morphing(const in vec4 weights, const in vec3 vertex, const in vec3 target0, const in vec3 target1) {\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1]));\n    vecOut += target0 * weights[0];\n    vecOut += target1 * weights[1];\n    return vecOut;\n}\n\nvec3 morphing(const in vec4 weights, const in vec3 vertex, const in vec3 target0, const in vec3 target1, const in vec3 target2) {\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1] + weights[2]));\n    vecOut += target0 * weights[0];\n    vecOut += target1 * weights[1];\n    vecOut += target2 * weights[2];\n    return vecOut;\n}\n\nvec3 morphing(const in vec4 weights,const in vec3 vertex,const in vec3 target0,const in vec3 target1,const in vec3 target2,const in vec3 target3) {\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1] + weights[2] + weights[3]));\n    vecOut += target0 * weights[0];\n    vecOut += target1 * weights[1];\n    vecOut += target2 * weights[2];\n    vecOut += target3 * weights[3];\n    return vecOut;\n}\n"},P9l5:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("MVZn"),r=n.n(i),a=n("YfG3"),o=n("4kdM"),s=n("XIp8"),u=n("m8R6"),l=n("Ui7z");function c(e){return e[0].toUpperCase()+e.slice(1)}function h(e,t,n){t.mixins.forEach(function(i){i[e]&&i[e].apply(t,n)})}function d(e){var t=e||[];return function(e){return e.extend(Object(a.a)(function(e,t){var n=function(e){return function(){if(t.prototype[e]){var n=t.prototype[e].apply(this,arguments);return h(e,this,arguments),n}h(e,this,arguments)}};return e.reduce(function(e,t){var i="after"+c(t),r="before"+c(t),a=n(t),o=n(r),s=n(i);return e[t]=a,e[r]=o,e[i]=s,e},{})}(t,e),{mixins:e.prototype.mixins||[],constructor:function(){Array.isArray(this.mixins)?this.mixins.forEach(function(e){!function(e,t){if(!e.name)throw new Error("Every mixin should have a `name` property. Check https://sketchfab.atlassian.net/wiki/display/DOC/Mixins for more info");e.dependencies&&e.dependencies.forEach(function(n){if(-1===t.mixins.map(Object(l.k)("name")).indexOf(n))throw new Error("You must include the "+n+" mixin in order to use the "+e.name+" mixin. Check https://sketchfab.atlassian.net/wiki/display/DOC/Mixins for more info")})}(e,this),Object(o.a)(this,Object(s.a)(Object(u.a)(e,["name","dependencies","constructor"].concat(t))))}.bind(this)):(this.mixins=[],console.error("Mixinable instances must have a `mixins` property of type Array.","Check https://sketchfab.atlassian.net/wiki/display/DOC/Mixins for more info")),t.forEach(function(e){var t="after"+c(e),n="before"+c(e),i=this[e];this[e]=function(){this[n].apply(this,arguments);var e=i.apply(this,arguments);return this[t].apply(this,arguments),e}}.bind(this)),h("constructor",this,arguments),e.apply(this,arguments)}}),{extend:function(t,n){var i=t.mixins||[],a=r()({},t,{mixins:this.prototype.mixins.filter(function(e){return i.every(function(t){return t.name!==e.name})}).concat(i)});return e.extend.call(this,a,n)}})}}},PJYv:function(e,t){e.exports='#pragma include "base.vert"\n'},PNlk:function(e,t){e.exports="attribute vec2 %UV%;\nattribute vec4 Color;\n\nuniform float uArrayColorEnabled;\nuniform float uPointSize;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec4 vColor;\n\nvoid main() {\n    vec2 uv = %UV_UNPACK%;\n    gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(uv - 0.5, 1.0, 1.0));\n    gl_PointSize = 1.0;\n    vColor = uArrayColorEnabled == 1.0 ? Color : vec4(1.0, 1.0, 1.0, 1.0);\n}\n"},PhaV:function(e,t){e.exports='#pragma include "utils/encodeDecode.glsl"\n\n// opacity\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\n#ifdef HAS_OPACITY\n#pragma include "utils/material.glsl"\n#pragma include "utils/rand.glsl"\n#endif\n\nvoid main(void) {\n    #ifdef HAS_OPACITY_MASK_OR_DITHER\n        ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n    #endif\n\n    #if defined(HAS_OPACITY_BLEND_OR_ADDITIVE) || defined(HAS_OPACITY_REFRACTION)\n        if (getMaterialOpacity() < EPSILON_ALPHA) discard;\n    #endif\n\n    // Depth in clip space\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    gl_FragColor.rgb = encode24(depth);\n    gl_FragColor.a = 1.0;\n\n}\n'},PnIl:function(e,t,n){"use strict";var i=n("QLQS").a.osg,r={DEPTH_LESS_WRITE:new i.Depth(i.Depth.LESS,0,1,!0),DEPTH_LESS_NO_WRITE:new i.Depth(i.Depth.LESS,0,1,!1),DEPTH_DISABLE:new i.Depth(i.Depth.DISABLE,0,1,!0),DEPTH_ALWAYS:new i.Depth(i.Depth.ALWAYS,0,1,!0),DEPTH_NEVER:new i.Depth(i.Depth.NEVER,0,1,!1),DEPTH_LEQUAL_BACKGROUND_NO_WRITE:new i.Depth(i.Depth.LEQUAL,1,1,!1),DEPTH_LEQUAL_WRITE:new i.Depth(i.Depth.LEQUAL,0,1,!0),DEPTH_LEQUAL_NO_WRITE:new i.Depth(i.Depth.LEQUAL,0,1,!1),DEPTH_EQUAL_NO_WRITE:new i.Depth(i.Depth.EQUAL,0,1,!1),COLOR_MASK_NONE:new i.ColorMask(!1,!1,!1,!1),COLOR_MASK_ALPHA:new i.ColorMask(!1,!1,!1,!0),COLOR_MASK_RGBA:new i.ColorMask(!0,!0,!0,!0),BLEND_DISABLE:new i.BlendFunc,BLEND_SUBSTRACTIVE:new i.BlendFunc(i.BlendFunc.ONE,i.BlendFunc.ONE_MINUS_SRC_ALPHA),BLEND_ADDITIVE:new i.BlendFunc(i.BlendFunc.ONE,i.BlendFunc.ONE),CULL_BACK:new i.CullFace(i.CullFace.BACK),CULL_FRONT:new i.CullFace(i.CullFace.FRONT),CULL_DISABLE:new i.CullFace(i.CullFace.DISABLE)};t.a=r},PtOh:function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i);n("q1tI");t.a=function(e){var t=e.collection;return r()("span",{className:"collection-name"},void 0,r()("a",{className:"label",onClick:function(e){return e.stopPropagation()},href:t.collectionUrl,title:t.name},void 0,r()("data",{itemProp:"name"},void 0,t.name)))}},PteP:function(e,t,n){"use strict";var i=n("q1z7"),r=n.n(i),a=n("P9l5");t.a=Object(a.a)(["initialize","remove","delegateEvents","undelegateEvents","setElement","render","viewDidMount","viewDidUpdate","viewWillUnmount"])(r.a.View)},PvUo:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var i=n("pVnL"),r=n.n(i),a=n("QILm"),o=n.n(a),s=n("12sq"),u=n("q1tI"),l=n("/MKj"),c=n("M4AY"),h=n("o1A9"),d=n("QKgc"),f=n("/f4T"),p=n("ftdA");function g(e){var t=e.gaEvent,n=e.iconClassName,i=void 0===n?"fa fa-arrow-up":n,a=e.org,g=o()(e,["gaEvent","iconClassName","org"]),m=Object(l.d)(),v=Object(l.e)(c.c.authUser.canAccessFeature("ff_read_only_mode")),_=Object(p.a)().Trackers;return u.createElement(f.a,r()({"data-selenium":"upload",iconClassName:i,text:"Upload",size:"medium",type:"important",onClick:function(e){e.preventDefault(),e.stopPropagation(),t&&_.ga[t](),m(c.a.authUser.authenticate(function(){return Object(h.loadUploadPopup)().then(function(e){return new e({org:a}).open()}).catch(Object(d.l)(d.j))},{redirectUrl:"/feed#upload",usageType:s.a.userUsageTypeChoices.uploader,initialForm:"signup"}))}},g,{disabled:v||g.disabled}))}},PxxW:function(e,t){e.exports='#pragma include "base.vert"\n'},Q7Tl:function(e,t,n){"use strict";var i=n("D1Qd"),r=function(e){this._initialBufferArray=void 0,this._bufferArray=void 0,e&&(this.setBufferArray(e),this.setInitialBufferArray(e))},a={setInitialBufferArray:function(e){this._initialBufferArray=e},getInitialBufferArray:function(){return this._initialBufferArray},setBufferArray:function(e){this._bufferArray=e.getBufferArray?e.getBufferArray():e},getBufferArray:function(){return this._bufferArray},getGlItemSize:function(){return this._bufferArray.getGlItemSize()},getGlType:function(){return this._bufferArray.getGlType()},getGlNormalize:function(){return this._bufferArray.getGlNormalize()}},o=function(e){return function(){return e.apply(this._bufferArray,arguments)}};for(var s in i.a.prototype)a[s]=o(i.a.prototype[s]);r.prototype=a,t.a=r},Q7lG:function(e,t){e.exports="#pragma include \"utils/encodeDecode.glsl\"\n\nuniform sampler2D uShadowMap;\nuniform sampler2D uPrevLightMap;\nuniform float uNumFrames;\nuniform float uTextureSize;\n\nvarying vec4 vProjCoord;\n\nvec4 accumulateShadow(const in vec4 projCoord, const in sampler2D shadowMap, const in sampler2D prevLightMap, const in float numFrames, const in float textureSize ){\n    float depth = decode24(texture2D(shadowMap, projCoord.xy).rgb);\n    float prevShadow = decode24(texture2D(prevLightMap, gl_FragCoord.xy / textureSize).rgb);\n\n\n    // here should be step (projCoord.z, depth) for proper comparison.\n    // but I still have some precision issue I can't sort out for now\n    // step (1.0, depth) is actually putting shadows everywhere the depth has been written, even when behind the ground\n    // It's only a problem for scenes that already have a ground geometry that has been made transparent,\n    // has the shader doesnt take opacity into account.\n    float currentShadow = step (1.0, depth);\n\n    // limits of light frustum\n    if (any(bvec4 ( projCoord.x > 1., projCoord.x < 0., projCoord.y > 1., projCoord.y < 0.))) {\n       currentShadow = 1.0;\n    }\n\n    float s = mix(prevShadow , currentShadow, 1.0 / numFrames);\n    return vec4(encode24(s),1.0);\n}\n\n\nvoid main(void) {\n    gl_FragColor = accumulateShadow(vProjCoord, uShadowMap, uPrevLightMap, uNumFrames, uTextureSize);\n}\n"},Q9ME:function(e,t){e.exports='//original shader : https://www.shadertoy.com/view/lssGDj by @movAX13h\n// Here\'s a little tool for new characters: thrill-project.com/archiv/coding/bitmap/\n\nfloat character(const in float n, vec2 p)\n{\n  p = floor(p*vec2(4.0, -4.0) + 2.5);\n  if (clamp(p.x, 0.0, 4.0) == p.x && clamp(p.y, 0.0, 4.0) == p.y)\n  {\n      if (int(mod(n/exp2(p.x + 5.0 * p.y), 2.0)) == 1) return 1.5;\n  }\n  return 0.2;\n}\n\nuniform vec2 uTextureInputSize;\n\nvec4  ascii( const in vec2 coord )\n{\n  vec2 pix = coord*uTextureInputSize.xy;\n  vec3 col = TEXTURE_2D_TextureInput(floor(pix/16.0)*16.0/uTextureInputSize.xy).rgb;\n\n  float gray = 0.3 * col.r + 0.59 * col.g + 0.11 * col.b;\n\n  // 458144   fish\n  // 473536   square\n  // 33408895 empty round\n  // a 469450 33095217\n  // p 469448 33095184\n  // r 32078482\n  // i 14815374\n  // l 8659215\n\n/*\n  float n =  4096.0;               // .\n  if (gray > 0.2) n = 65600.0;    // :\n  if (gray > 0.3) n = 332772.0;   // *\n  if (gray > 0.4) n = 15255086.0; // o\n  if (gray > 0.5) n = 23385164.0; // &\n  if (gray > 0.6) n = 15252014.0; // 8\n  if (gray > 0.7) n = 13199452.0; // @\n  if (gray > 0.8) n = 11512810.0; // #\n*/\n\n  // letters are APRIL\n  // "emojii" are fish, square, hollow round\n  float n =  14815374.0;               // I\n  if (gray > 0.2) n = 473536.0;    // square\n  if (gray > 0.3) n = 15255086.0;   //  round o\n  if (gray > 0.4) n = 458144.0; // fish\n  if (gray > 0.5) n = 10955200.0; // A\n  if (gray > 0.6) n = 1113663.0; // P\n  if (gray > 0.7) n = 5356847.0; // R\n  if (gray > 0.8) n = 15762465.0; // L\n\n  vec2 p = mod(pix / 8.0, 2.0) - vec2(1.0);\n  col = col * vec3(character(n, p));\n  return vec4(col, 1.0);\n}\n'},QCSq:function(e,t){e.exports="#define LIGHT_SPOT 0\n#define LIGHT_POINT 1\n#define LIGHT_DIRECTION 2\n#define LIGHT_HEMI 3\n\n%UNROLL 4%\n#ifdef LIGHT_TYPE_%ID%\n    uniform vec4 uSketchfabLight%ID%_diffuse;\n\n    #if LIGHT_TYPE_%ID% == LIGHT_DIRECTION\n        uniform vec3 uSketchfabLight%ID%_viewDirection;\n    #elif LIGHT_TYPE_%ID% == LIGHT_SPOT\n        uniform vec3 uSketchfabLight%ID%_viewDirection;\n        uniform vec4 uSketchfabLight%ID%_viewPosition;\n        uniform float uSketchfabLight%ID%_spotBlend;\n        uniform float uSketchfabLight%ID%_spotCutOff;\n        uniform vec4 uSketchfabLight%ID%_attenuation;\n    #elif LIGHT_TYPE_%ID% == LIGHT_POINT\n        uniform vec4 uSketchfabLight%ID%_viewPosition;\n        uniform vec4 uSketchfabLight%ID%_attenuation;\n    #elif LIGHT_TYPE_%ID% == LIGHT_HEMI\n        uniform vec4 uSketchfabLight%ID%_ground;\n        uniform vec3 uSketchfabLight%ID%_viewDirection;\n    #endif\n#endif // LIGHT_TYPE\n%%\n\nfloat getLightAttenuation(const in float dist, const in vec4 lightAttenuation) {\n    // lightAttenuation(constantEnabled, linearEnabled, quadraticEnabled)\n    // TODO find a vector alu instead of 4 scalar\n    float constant = lightAttenuation.x;\n    float linear = lightAttenuation.y * dist;\n    float quadratic = lightAttenuation.z * dist * dist;\n    return 1.0 / (constant + linear + quadratic);\n}\n\nvoid precomputeSpot(\n        const in vec3 normal,\n        const in vec3 viewVertex,\n                          \n        const in vec3 lightViewDirection,\n        const in vec4 lightAttenuation,\n        const in vec3 lightViewPosition,\n        const in float lightSpotCutOff,\n        const in float lightSpotBlend,\n                          \n        out float attenuation,\n        out vec3 eyeLightDir,\n        out float dotNL) {\n\n    eyeLightDir = lightViewPosition - viewVertex;\n    float dist = length(eyeLightDir);\n    eyeLightDir = dist > 0.0 ? eyeLightDir / dist : vec3( 0.0, 1.0, 0.0 );\n\n    float cosCurAngle = dot(-eyeLightDir, lightViewDirection);\n    float spot = cosCurAngle * smoothstep(0.0, 1.0, (cosCurAngle - lightSpotCutOff) / lightSpotBlend);\n\n    dotNL = dot(eyeLightDir, normal);\n    attenuation = spot * getLightAttenuation(dist, lightAttenuation);\n}\n\nvoid precomputePoint(\n        const in vec3 normal,\n        const in vec3 viewVertex,\n\n        const in vec4 lightAttenuation,\n        const in vec3 lightViewPosition,\n\n        out float attenuation,\n        out vec3 eyeLightDir,\n        out float dotNL) {\n\n    eyeLightDir = lightViewPosition - viewVertex;\n    float dist = length(eyeLightDir);\n\n    attenuation = getLightAttenuation(dist, lightAttenuation);\n    eyeLightDir = dist > 0.0 ? eyeLightDir / dist :  vec3( 0.0, 1.0, 0.0 );\n    dotNL = dot(eyeLightDir, normal);\n}\n\nvoid precomputeSun(\n        const in vec3 normal,\n        const in vec3 lightViewDirection,\n  \n        out float attenuation,\n        out vec3 eyeLightDir,\n        out float dotNL) {\n\n    attenuation = 1.0;\n    eyeLightDir = -lightViewDirection;\n    dotNL = dot(eyeLightDir, normal);\n}"},QD80:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Vx0a"),a=n("czSk"),o=function(){r.a.call(this),this.projection=a.c.create()};i.a.createPrototypeNode(o,i.a.objectInherit(r.a.prototype,{getProjectionMatrix:function(){return this.projection},setProjectionMatrix:function(e){this.projection=e}}),"osg","Projection"),t.a=o},QF8f:function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/model.jinja"]={root:function(e,t,n,i,r){var a=null,o=null,s="";try{var u=i.makeMacro(["model"],["options"],function(r,s){var u=n;n=new i.Frame,(s=s||{}).hasOwnProperty("caller")&&n.set("caller",s.caller),n.set("model",r),n.set("options",s.hasOwnProperty("options")?s.options:{});var l,c,h="";return h+="\n    ",l=e.getFilter("merge").call(t,{withStaffpickFlag:!0,withStaffpickLink:!1,withRestrictedFlag:!0,displayRecentlyStaffpicked:!1},i.contextOrFrameLookup(t,n,"options")),n.set("options",l,!0),n.topLevel&&t.setVariable("options",l),n.topLevel&&t.addExport("options",l),h+="\n    ",c=i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"displayRecentlyStaffpicked")&&i.memberLookup(r,"recentlyStaffpicked"),n.set("recentlyStaffpicked",c,!0),n.topLevel&&t.setVariable("recentlyStaffpicked",c),n.topLevel&&t.addExport("recentlyStaffpicked",c),h+="\n\n    ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"withStaffpickLink")&&i.memberLookup(r,"staffpickedAt")?(h+='\n        <meta itemprop="award" content="Staff Pick" />\n        <a href="',h+=i.suppressValue((a=11,o=21,i.callWrap(i.contextOrFrameLookup(t,n,"url"),"url",t,["models:staffpicks"])),e.opts.autoescape),h+='" class="flag --staffpicked" title="See all staff picks"></a>\n    '):i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"withStaffpickFlag")&&i.memberLookup(r,"staffpickedAt")?(h+='\n        <meta itemprop="award" content="Staff Pick" />\n        <span class="flag --staffpicked ',i.contextOrFrameLookup(t,n,"recentlyStaffpicked")&&(h+="--with-text"),h+='" title="Staff Picks"></span>\n    ',h+="\n    "):0==i.memberLookup(r,"isPublished")&&(h+='\n        <span class="flag --draft">DRAFT</span>\n    '),h+="\n\n    ",(i.memberLookup(r,"isRestricted")||i.memberLookup(r,"isAdult"))&&(h+="\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"withRestrictedFlag")&&(h+='\n            <a\n                href="https://help.sketchfab.com/hc/en-us/articles/214867883-What-is-Restricted-Content-?utm_source=website&utm_campaign=restrictedcontent"\n                target="_blank"\n                class="flag --restricted"\n                title="Restricted Content"></a>\n        '),h+="\n    "),h+="\n",n=u,new i.SafeString(h)});t.addExport("model_labels"),t.setVariable("model_labels",u),s+="\n\n";var l=i.makeMacro(["model"],["options"],function(r,s){var u=n;n=new i.Frame,(s=s||{}).hasOwnProperty("caller")&&n.set("caller",s.caller),n.set("model",r),n.set("options",s.hasOwnProperty("options")?s.options:{});var l,c="";return l=e.getFilter("merge").call(t,{clickable:!0},i.contextOrFrameLookup(t,n,"options")),n.set("options",l,!0),n.topLevel&&t.setVariable("options",l),n.topLevel&&t.addExport("options",l),c+='<span class="model-name">\n\n        ',i.memberLookup(r,"visibility")&&(c+="\n            ","protected"==i.memberLookup(r,"visibility")?c+='\n                <i class="model-name__icon fa fa-lock --protected"></i>\n            ':"private"==i.memberLookup(r,"visibility")&&(c+='\n                <i class="model-name__icon custom-icons icon-private --private"></i>\n            '),c+="\n        "),c+="\n\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"clickable")?(c+='\n            <a class="model-name__label" data-route href="',c+=i.suppressValue(i.memberLookup(r,"viewerUrl"),e.opts.autoescape),c+='"',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"target")&&(c+=' target="',c+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"target"),e.opts.autoescape),c+='"'),c+=' title="',c+=i.suppressValue("store"==i.memberLookup(r,"downloadType")?"Buy ":"",e.opts.autoescape),c+=i.suppressValue(i.memberLookup(r,"name"),e.opts.autoescape),c+=' 3D Model">',c+=i.suppressValue(i.memberLookup(r,"name"),e.opts.autoescape),c+="</a>\n        "):(c+='\n            <span class="model-name__label">',c+=i.suppressValue(i.memberLookup(r,"name"),e.opts.autoescape),c+="</span>\n        "),c+="\n\n        ",c+=i.suppressValue((a=51,o=21,i.callWrap(i.contextOrFrameLookup(t,n,"model_labels"),"model_labels",t,[r,i.contextOrFrameLookup(t,n,"options")])),e.opts.autoescape),c+="\n\n    </span>",n=u,new i.SafeString(c)});t.addExport("model_name"),t.setVariable("model_name",l),s+="\n\n";var c=i.makeMacro(["model"],["options"],function(r,a){var o=n;n=new i.Frame,(a=a||{}).hasOwnProperty("caller")&&n.set("caller",a.caller),n.set("model",r),n.set("options",a.hasOwnProperty("options")?a.options:{});var s,u,l="";return s=e.getFilter("merge").call(t,{withUsernameMention:!0,withSuffix:!1},i.contextOrFrameLookup(t,n,"options")),n.set("options",s,!0),n.topLevel&&t.setVariable("options",s),n.topLevel&&t.addExport("options",s),u=i.memberLookup(r,"org")?i.memberLookup(r,"org"):i.memberLookup(r,"user"),n.set("uploader",u,!0),n.topLevel&&t.setVariable("uploader",u),n.topLevel&&t.addExport("uploader",u),l+=i.suppressValue(i.memberLookup(r,"name")+" - "+("store"==i.memberLookup(r,"downloadType")?"Buy Royalty Free ":"free"==i.memberLookup(r,"downloadType")?"Download Free ":"")+"3D model by "+i.memberLookup(i.contextOrFrameLookup(t,n,"uploader"),"displayName")+(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"withUsernameMention")?" (@"+i.memberLookup(i.contextOrFrameLookup(t,n,"uploader"),"username")+")":"")+" ["+e.getFilter("truncate").call(t,i.memberLookup(r,"uid"),i.makeKeywordArgs({length:7,killwords:i.contextOrFrameLookup(t,n,"True"),end:""}))+"]"+(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"withSuffix")?" - Sketchfab"+("store"==i.memberLookup(r,"downloadType")?" Store":""):""),e.opts.autoescape),n=o,new i.SafeString(l)});t.addExport("model_page_title"),t.setVariable("model_page_title",c),s+="\n\n";var h=i.makeMacro(["list"],["options"],function(r,s){var u=n;n=new i.Frame,(s=s||{}).hasOwnProperty("caller")&&n.set("caller",s.caller),n.set("list",r),n.set("options",s.hasOwnProperty("options")?s.options:{});var l,c,h,d="";l=e.getFilter("merge").call(t,{maxDisplayed:3,othersHref:""},i.contextOrFrameLookup(t,n,"options")),n.set("options",l,!0),n.topLevel&&t.setVariable("options",l),n.topLevel&&t.addExport("options",l),c=e.getFilter("first_n").call(t,r,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"maxDisplayed")),n.set("shortList",c,!0),n.topLevel&&t.setVariable("shortList",c),n.topLevel&&t.addExport("shortList",c),h=e.getFilter("length").call(t,r)-e.getFilter("length").call(t,i.contextOrFrameLookup(t,n,"shortList")),n.set("otherCount",h,!0),n.topLevel&&t.setVariable("otherCount",h),n.topLevel&&t.addExport("otherCount",h),n=n.push();var f=i.contextOrFrameLookup(t,n,"shortList");if(f)for(var p=f.length,g=0;g<f.length;g++){var m=f[g];n.set("model",m),n.set("loop.index",g+1),n.set("loop.index0",g),n.set("loop.revindex",p-g),n.set("loop.revindex0",p-g-1),n.set("loop.first",0===g),n.set("loop.last",g===p-1),n.set("loop.length",p),i.memberLookup(i.contextOrFrameLookup(t,n,"loop"),"first")||(i.memberLookup(i.contextOrFrameLookup(t,n,"loop"),"last")&&i.contextOrFrameLookup(t,n,"otherCount")<1?d+="<span> and </span>":d+="<span>, </span>"),d+=i.suppressValue((a=84,o=19,i.callWrap(i.contextOrFrameLookup(t,n,"model_name"),"model_name",t,[m,{withStaffpickFlag:!1,withStaffpickLink:!1,withRestrictedFlag:!1}])),e.opts.autoescape)}return n=n.pop(),i.contextOrFrameLookup(t,n,"otherCount")>0&&(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"othersHref")?(d+='<a href="',d+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"othersHref"),e.opts.autoescape),d+='" class="others"> and ',d+=i.suppressValue(i.contextOrFrameLookup(t,n,"otherCount"),e.opts.autoescape),d+=" other",d+=i.suppressValue(e.getFilter("pluralize").call(t,i.contextOrFrameLookup(t,n,"otherCount")),e.opts.autoescape),d+="</a>"):(d+='<span class="others"> and ',d+=i.suppressValue(i.contextOrFrameLookup(t,n,"otherCount"),e.opts.autoescape),d+=" other",d+=i.suppressValue(e.getFilter("pluralize").call(t,i.contextOrFrameLookup(t,n,"otherCount")),e.opts.autoescape),d+="</span>")),n=u,new i.SafeString(d)});t.addExport("model_name_list"),t.setVariable("model_name_list",h),s+="\n\n";var d=i.makeMacro([],[],function(e){var t=n;n=new i.Frame,(e=e||{}).hasOwnProperty("caller")&&n.set("caller",e.caller);var r="";return r+='\n\n    <div class="card-preview" data-action="open-preview">\n        <i class="card-preview__icon fa fa-search" title="see preview"></i>\n    </div>\n\n',n=t,new i.SafeString(r)});t.addExport("preview_link"),t.setVariable("preview_link",d),s+="\n\n";var f=i.makeMacro([],["options"],function(e){var r=n;n=new i.Frame,(e=e||{}).hasOwnProperty("caller")&&n.set("caller",e.caller),n.set("options",e.hasOwnProperty("options")?e.options:{});var a="";return a+='\n\n    <ul class="hover-menu quicksettings corner',"up"==i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"direction")&&(a+=" hover-menu-up"),"left"==i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"direction")&&(a+=" --left"),a+='">\n        <li><a data-action="remove-model">Remove</a></li>\n    </ul>\n\n',n=r,new i.SafeString(a)});t.addExport("collection_item_quicksettings"),t.setVariable("collection_item_quicksettings",f),s+="\n\n",s+="\n";var p=i.makeMacro(["authUser","model"],["options"],function(r,s,u){var l=n;n=new i.Frame,(u=u||{}).hasOwnProperty("caller")&&n.set("caller",u.caller),n.set("authUser",r),n.set("model",s),n.set("options",u.hasOwnProperty("options")?u.options:{});var c="";return c+='\n\n    <div class="model-uploadcard">\n\n        <h3 class="filename">\n            <a data-route href="',c+=i.suppressValue(i.memberLookup(s,"viewerUrl"),e.opts.autoescape),c+='">',i.memberLookup(s,"name")?c+=i.suppressValue((a=125,o=31,i.callWrap(i.contextOrFrameLookup(t,n,"model_name"),"model_name",t,[s,{withStaffpickFlag:!1}])),e.opts.autoescape):c+=i.suppressValue(e.getFilter("default").call(t,i.memberLookup(s,"originalFileName"),"No file name"),e.opts.autoescape),c+='</a>\n        </h3>\n        <div class="meta">\n            ',i.memberLookup(s,"processedAt")?(c+='\n                <span class="date" title="',c+=i.suppressValue(i.memberLookup(s,"processedAt"),e.opts.autoescape),c+='">',c+=i.suppressValue(e.getFilter("time_ago").call(t,i.memberLookup(s,"processedAt")),e.opts.autoescape),c+="</span>\n            "):(c+='\n                <span class="date" title="',c+=i.suppressValue(i.memberLookup(s,"createdAt"),e.opts.autoescape),c+='">',c+=i.suppressValue(e.getFilter("time_ago").call(t,i.memberLookup(s,"createdAt")),e.opts.autoescape),c+="</span>\n            "),c+='\n        </div>\n\n        <div class="status">',0==i.memberLookup(s,"processingStatus")?c+='<div class="help">\n                    <i class="icon spinner-small-slow"></i>\n                    <div class="tooltip tooltip-down">Pending</div>\n                </div>':1==i.memberLookup(s,"processingStatus")?c+='<div class="help">\n                    <i class="icon spinner-small"></i>\n                    <div class="tooltip tooltip-down">Processing</div>\n                </div>':2==i.memberLookup(s,"processingStatus")?i.memberLookup(s,"isPublished")?c+='<div class="help">\n                        <i class="icon fa fa-check"></i>\n                        <div class="tooltip tooltip-down">Published</div>\n                    </div>':(c+='<button type="button" class="button btn-important btn-medium" data-action="publish">\n                        Publish\n                    </button>\n\n                    <a href="',c+=i.suppressValue(i.memberLookup(s,"editorUrl"),e.opts.autoescape),c+='" class="button btn-tertiary btn-medium btn-edit" data-action="edit">\n                        3D Settings\n                    </a>'):3==i.memberLookup(s,"processingStatus")&&(c+='<div class="help">\n                    <i class="icon fa fa-times"></i>\n                    <div class="tooltip tooltip-down">Error</div>\n                </div>'),c+='</div>\n\n        <div class="model-uploadcard-settings">\n            <div class="button btn-medium btn-primary display-icon-only"',i.memberLookup(s,"processingStatus")<2&&(c+=" disabled"),c+='>\n                <i class="fa fa-cog"></i>\n                <div class="js-quicksettings"></div>\n            </div>\n        </div>\n\n    </div>\n\n',n=l,new i.SafeString(c)});t.addExport("model_uploadcard"),t.setVariable("model_uploadcard",p),s+="\n\n\n";var g=i.makeMacro([],["options"],function(r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var o="";return o+='\n\n    <div class="annotation" data-hotspot="',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"hotspotIndex"),e.opts.autoescape),o+='">\n\n        <div class="tooltip">\n\n            ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"editMode")?o+='\n                <form class="tooltip-content">\n                    <div class="edition">\n                        <input class="title" placeholder="Title *" maxlength="64" required>\n                        <textarea class="description" placeholder="Description (add links, images and other formatting with Markdown)" maxlength="1024" rows="2"></textarea>\n                    </div>\n                    <div class="render">\n                        <div class="title"></div>\n                        <div class="markdown-editor">\n                            <div class="description markdown-rendered-content inversed"></div>\n                        </div>\n                    </div>\n                    <div class="meta">\n                        <button type="submit" class="submit button btn-primary btn-small">OK</button>\n                        <div class="meta__mode">\n                            <i class="fa fa-pencil activate-edition selected" title="Edit"></i>\n                            <i class="fa fa-eye activate-render" title="Preview"></i>\n                        </div>\n                    </div>\n                </form>\n            ':o+='\n\n                <div class="tooltip-content">\n                    <div class="tooltip-content-minimal">\n                        <div class="title"></div>\n                        <a href="#" class="more">+ more info</a>\n                    </div>\n                    <div class="title"></div>\n                    <div class="description markdown-rendered-content inversed"></div>\n                </div>\n\n            ',o+="\n\n        </div>\n\n    </div>\n\n",n=a,new i.SafeString(o)});t.addExport("model_hotspot"),t.setVariable("model_hotspot",g),s+="\n\n\n";var m=i.makeMacro([],["options"],function(r){var s=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var u="";u+="\n\n",n.set("width_before",30,!0),n.topLevel&&t.setVariable("width_before",30),n.topLevel&&t.addExport("width_before",30),u+="\n",n.set("width_next",960,!0),n.topLevel&&t.setVariable("width_next",960),n.topLevel&&t.addExport("width_next",960),u+='\n\n<div class="annotation vr visible" data-hotspot="',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"hotspotIndex"),e.opts.autoescape),u+='" style="width:',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"widthContent"),e.opts.autoescape),u+='px;height:576px;position:absolute;top:30px;left:30px;">\n\n    <div class="tooltip visible" style="width:',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"widthContent"),e.opts.autoescape),u+='px;border-radius:30px;left:0;">\n        <div class="tooltip-content" style="width:',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"widthContent"),e.opts.autoescape),u+='px;height:576px;border-radius:30px;display:flex;flex-direction:column;">\n\n            <div class="title" style="font-size:48px;line-height:1.5;padding:10px 80px 0 80px;">',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"title"),e.opts.autoescape),u+="</div>",n=n.push();var l=(a=255,o=32,i.callWrap(i.contextOrFrameLookup(t,n,"range"),"range",t,[0,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"column")]));if(l)for(var c=l.length,h=0;h<l.length;h++){var d,f=l[h];n.set("column",f),n.set("loop.index",h+1),n.set("loop.index0",h),n.set("loop.revindex",c-h),n.set("loop.revindex0",c-h-1),n.set("loop.first",0===h),n.set("loop.last",h===c-1),n.set("loop.length",c),i.contextOrFrameLookup(t,n,"width_before")>30&&(u+='<div class="fa fa-arrow-left" style="font-size:40px;position:absolute;top:250px;left:',u+=i.suppressValue(i.contextOrFrameLookup(t,n,"width_before"),e.opts.autoescape),u+='px"></div>'),d=i.contextOrFrameLookup(t,n,"width_before")+1024,n.set("width_before",d,!0),n.topLevel&&t.setVariable("width_before",d),n.topLevel&&t.addExport("width_before",d)}n=n.pop(),u+='<div class="description" style="column-gap:180px;column-count:',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"column"),e.opts.autoescape),u+=';font-size:36px;width:100%;line-height:1.5;padding:10px 80px 0 80px;">',u+=i.suppressValue(e.getFilter("safe").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"description")),e.opts.autoescape),u+="</div>",n=n.push();var p=(a=264,o=32,i.callWrap(i.contextOrFrameLookup(t,n,"range"),"range",t,[1,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"column")]));if(p)for(var g=p.length,m=0;m<p.length;m++){var v,_=p[m];n.set("column",_),n.set("loop.index",m+1),n.set("loop.index0",m),n.set("loop.revindex",g-m),n.set("loop.revindex0",g-m-1),n.set("loop.first",0===m),n.set("loop.last",m===g-1),n.set("loop.length",g),u+='<div class="fa fa-arrow-right" style="font-size:40px;position:absolute;top:250px;left:',u+=i.suppressValue(i.contextOrFrameLookup(t,n,"width_next"),e.opts.autoescape),u+='px"></div>\n                ',v=i.contextOrFrameLookup(t,n,"width_next")+1024,n.set("width_next",v,!0),n.topLevel&&t.setVariable("width_next",v),n.topLevel&&t.addExport("width_next",v)}u+='<div class="footer" style="text-align:left;font-size:36px;justify-content:space-around;bottom:15px;left:0;position:absolute;margin:20px 0 20px 0;">',n=(n=n.pop()).push();var b=(a=270,o=40,i.callWrap(i.contextOrFrameLookup(t,n,"range"),"range",t,[0,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"column")]));if(b)for(var S=b.length,y=0;y<b.length;y++){var x=b[y];n.set("column",x),n.set("loop.index",y+1),n.set("loop.index0",y),n.set("loop.revindex",S-y),n.set("loop.revindex0",S-y-1),n.set("loop.first",0===y),n.set("loop.last",y===S-1),n.set("loop.length",S),u+='<div class="containter-button" style="width:1024px;display:inline-block;text-align:center;">',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"displayNavigation")?u+='<button id="prevButton" class="button" style="background:#444444;">Prev</button>\n                                <button id="closeButton" class="button" style="background:#444444;">Close annotation</button>\n                                <button id="nextButton" class="button" style="background:#444444;">Next</button>':u+='<button id="closeButton" class="button" style="background:#444444;">Close annotation</button>',u+="</div>"}return n=n.pop(),u+="</div>\n\n        </div>\n    </div>\n</div>\n\n",n=s,new i.SafeString(u)});t.addExport("model_hotspot_vr"),t.setVariable("model_hotspot_vr",m),s+="\n\n";var v=i.makeMacro(["src"],["options"],function(r,a){var o=n;n=new i.Frame,(a=a||{}).hasOwnProperty("caller")&&n.set("caller",a.caller),n.set("src",r),n.set("options",a.hasOwnProperty("options")?a.options:{});var s,u="";return s=e.getFilter("merge").call(t,{title:"A 3D model"},i.contextOrFrameLookup(t,n,"options")),n.set("options",s,!0),n.topLevel&&t.setVariable("options",s),n.topLevel&&t.addExport("options",s),u+="\n    <iframe ",u+=i.suppressValue(e.getFilter("attributes").call(t,{title:i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"title"),class:i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"class"),width:i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"width"),height:i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"height"),src:r,frameborder:"0",allow:"autoplay; fullscreen; vr",allowvr:"",allowfullscreen:"",mozallowfullscreen:"true",webkitallowfullscreen:"true",onmousewheel:""}),e.opts.autoescape),u+="></iframe>",n=o,new i.SafeString(u)});t.addExport("model_iframe"),t.setVariable("model_iframe",v),s+="\n\n";var _=i.makeMacro(["license"],["show_requirements"],function(r,a){var o=n;n=new i.Frame,(a=a||{}).hasOwnProperty("caller")&&n.set("caller",a.caller),n.set("license",r),n.set("show_requirements",a.hasOwnProperty("show_requirements")?a.show_requirements:i.contextOrFrameLookup(t,n,"True"));var s="";return s+='\n    <div class="model-license">\n        <p class="model-license__name help">\n            ',s+=i.suppressValue(i.memberLookup(r,"label"),e.opts.autoescape),s+='\n            <span class="tooltip tooltip-up">',s+=i.suppressValue(i.memberLookup(r,"fullname"),e.opts.autoescape),s+="</span>\n        </p>\n\n        ",i.contextOrFrameLookup(t,n,"show_requirements")&&(s+='\n            <p class="model-license__requirements">',s+=i.suppressValue(i.memberLookup(r,"requirements"),e.opts.autoescape),s+="</p>\n        "),s+='\n\n        <a\n            class="model-license__link skfb-link"\n            href="',s+=i.suppressValue(i.memberLookup(r,"url"),e.opts.autoescape),s+='"\n            rel="license"\n            itemprop="license"\n            target="_blank">Learn more</a>\n    </div>\n',n=o,new i.SafeString(s)});t.addExport("model_license"),t.setVariable("model_license",_),s+="\n\n";var b=i.makeMacro(["model"],["options"],function(r,a){var o=n;n=new i.Frame,(a=a||{}).hasOwnProperty("caller")&&n.set("caller",a.caller),n.set("model",r),n.set("options",a.hasOwnProperty("options")?a.options:{});var s,u="";return u+="\n    ",s=e.getFilter("merge").call(t,{className:""},i.contextOrFrameLookup(t,n,"options")),n.set("options",s,!0),n.topLevel&&t.setVariable("options",s),n.topLevel&&t.addExport("options",s),u+='\n    <span class="',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"className"),e.opts.autoescape),u+=' custom-icons icon-eye-icon help">\n        <span class="count">\n            ',u+=i.suppressValue(e.getFilter("humanize_number").call(t,i.memberLookup(r,"viewCount")),e.opts.autoescape),u+='\n        </span>\n        <span class="tooltip tooltip-up">Views</span>\n    </span>\n',n=o,new i.SafeString(u)});t.addExport("model_view_count"),t.setVariable("model_view_count",b),s+="\n\n";var S=i.makeMacro(["model"],["options"],function(r,s){var u=n;n=new i.Frame,(s=s||{}).hasOwnProperty("caller")&&n.set("caller",s.caller),n.set("model",r),n.set("options",s.hasOwnProperty("options")?s.options:{});var l,c="";return l=e.getFilter("merge").call(t,{isMine:!1},i.contextOrFrameLookup(t,n,"options")),n.set("options",l,!0),n.topLevel&&t.setVariable("options",l),n.topLevel&&t.addExport("options",l),c+='<div class="model-cell__name-container">\n        <p class="model-cell__name ',c+=i.suppressValue(i.memberLookup(r,"isDeleted")?"--deleted":"",e.opts.autoescape),c+='">\n            ',c+=i.suppressValue((a=344,o=23,i.callWrap(i.contextOrFrameLookup(t,n,"model_name"),"model_name",t,[r,{clickable:!i.memberLookup(r,"isDeleted")}])),e.opts.autoescape),c+="\n        </p>\n\n        ",i.memberLookup(r,"isDeleted")&&(c+='\n            <span class="model-cell__deleted-tooltip help">\n                <i class="fa fa-question-circle"></i>\n                <span class="tooltip tooltip-right">\n                    This model was deleted',c+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"isMine")?"":", but no worries, you can still download the latest version!",e.opts.autoescape),c+="\n                </span>\n            </span>\n        "),c+="\n    </div>\n",n=u,new i.SafeString(c)});t.addExport("model_cell_name"),t.setVariable("model_cell_name",S),s+="\n\n";var y=i.makeMacro([],["options"],function(r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var o,s="";return s+="\n    ",o=e.getFilter("merge").call(t,{className:""},i.contextOrFrameLookup(t,n,"options")),n.set("options",o,!0),n.topLevel&&t.setVariable("options",o),n.topLevel&&t.addExport("options",o),s+='\n    <svg class="',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"className"),e.opts.autoescape),s+=' --unity" width="20" height="20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <path d="M17.812 0l-8.17 2.129-1.209 2.075-2.453-.018L0 10l5.98 5.815 2.452-.018 1.212 2.073L17.812 20 20 12.058l-1.243-2.057L20 7.944 17.812 0zM8.63 4.538l6.25-1.562-3.588 6.043H4.116L8.63 4.538zm0 10.926l-4.514-4.482h7.176l3.587 6.044-6.249-1.562zm7.998.58L13.039 10l3.589-6.044L18.36 10l-1.733 6.042z" id="a"/>\n    </svg>\n',n=a,new i.SafeString(s)});t.addExport("model_unity_icon"),t.setVariable("model_unity_icon",y),s+="\n\n";var x=i.makeMacro([],["options"],function(r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var o,s="";return s+="\n    ",o=e.getFilter("merge").call(t,{className:""},i.contextOrFrameLookup(t,n,"options")),n.set("options",o,!0),n.topLevel&&t.setVariable("options",o),n.topLevel&&t.addExport("options",o),s+='\n    <svg class="',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"className"),e.opts.autoescape),s+=' --unreal" width="20" height="20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <path d="m.041 12.405s-.548-2.726 2.353-6.027c2.9-3.301 5.077-4.501 7.428-5.127l-.005.003.01-.003s-1.847 1.076-1.847 2.701c0 .472.075.796.18 1.013.138.287.357.385.553.386.166 0 .263-.067.472-.149v8.803s.023.142.15.31c.184.242.472.537 1.014.54.924-.006 2.086-1.05 2.086-1.05v-7.127c0-.725-.519-1.6-1.068-1.9 0 0 .075-.005.196-.005.363 0 1.142.041 1.576.373.12-.14 2.066-2.342 5.528-3.02 0 0 0 .002-.002.003l.01-.002s-1.915 2.255-2.515 3.373c-.107.006-.123 2.121-.105 4.235.017 2.04.066 4.079.094 4.22 0 0 .204.304.725.306.586.003 1.575-.377 3.126-2.007 0 0-.04.093-.123.258-.445.887-2.096 3.864-5.028 5.594l-1.903-1.609-.049-.04-2.074 2.2-.004-.001s-4.73-.4-6.705-3.25c0 0 .004 0 .01.003l-.003-.003s.299.116.637.122c.395.008.81-.137.81-.798v-6.702a.71.71 0 0 0 -.752-.724c-.465 0-1.133.314-2.045 1.25-1.926 1.975-2.725 3.85-2.725 3.85l-.002-.007-.003.008" fill-rule="evenodd"/>\n    </svg>\n',n=a,new i.SafeString(s)});t.addExport("model_unreal_icon"),t.setVariable("model_unreal_icon",x),r(null,s+="\n")}catch(e){r(i.handleError(e,a,o))}}}},QFwy:function(e,t,n){"use strict";(function(e){var i=n("EVdn"),r=n.n(i),a=n("Y14P"),o={"http:":"80","https:":"443"};t.a=function(){var t=r.a.ajax;r.a.ajax=function(){var n=this,i=arguments,r=arguments.length>=2?arguments[1]:arguments[0];return"GET"===r.type.toUpperCase()||"HEAD"===r.type.toUpperCase()||a.a.get("sb_csrftoken")?t.apply(this,arguments):new e(function(e,r){var a=new XMLHttpRequest;a.open("GET","/i/csrf"),a.addEventListener("load",function(){e(t.apply(n,i))}),a.addEventListener("error",function(e){r(e)}),a.send()})},r()(document).ajaxSend(function(e,t,n){var i=window.location,r=document.createElement("a");r.href=n.url,r.href=r.href;var s=r.port;s=(s="0"!==s?s:o[r.protocol])!==o[r.protocol]?s:"",r.protocol!==i.protocol||r.hostname!==i.hostname||s!==i.port||t.setRequestHeader("X-CsrfToken",a.a.get("sb_csrftoken"))})}}).call(this,n("CSL1"))},QKgc:function(e,t,n){"use strict";n.d(t,"n",function(){return _}),n.d(t,"e",function(){return b}),n.d(t,"j",function(){return S}),n.d(t,"i",function(){return y}),n.d(t,"h",function(){return x}),n.d(t,"a",function(){return C}),n.d(t,"g",function(){return w}),n.d(t,"d",function(){return T}),n.d(t,"c",function(){return M}),n.d(t,"f",function(){return E}),n.d(t,"b",function(){return A}),n.d(t,"k",function(){return O}),n.d(t,"l",function(){return R}),n.d(t,"m",function(){return P});var i=n("PJYZ"),r=n.n(i),a=n("lSNA"),o=n.n(a),s=n("lwsE"),u=n.n(s),l=n("a1gu"),c=n.n(l),h=n("Nsbk"),d=n.n(h),f=n("7W2i"),p=n.n(f),g=n("oShl"),m=n.n(g),v=n("Ui7z"),_=function(e){return e.preventSentryReport},b=function(e){function t(e,n,i,r,a){var o;return u()(this,t),(o=c()(this,d()(t).call(this,e))).feature=n,o.value=i,o.limit=r,o.account=a,o}return p()(t,e),t}(m()(Error)),S=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"UserDeclinedError";return u()(this,t),e=c()(this,d()(t).call(this,n)),o()(r()(e),"preventSentryReport",!0),e}return p()(t,e),t}(m()(Error)),y=function(e){function t(e,n,i){var r;return u()(this,t),(r=c()(this,d()(t).call(this,"UploadSizeLimitReachedError"))).fileSize=e,r.limit=n,r.account=i,r}return p()(t,e),t}(m()(Error)),x=function(e){function t(e){var n;return u()(this,t),(n=c()(this,d()(t).call(this,"UnsuportedFormatError"))).extension=e,n}return p()(t,e),t}(m()(Error)),C=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CancellationError";return u()(this,t),c()(this,d()(t).call(this,e))}return p()(t,e),t}(m()(Error)),w=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ReviewNotFoundError";return u()(this,t),c()(this,d()(t).call(this,e))}return p()(t,e),t}(m()(Error)),T=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"MaxItemsInCartExceededError";return u()(this,t),c()(this,d()(t).call(this,e))}return p()(t,e),t}(m()(Error)),M=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"LoginError";return u()(this,t),c()(this,d()(t).call(this,e))}return p()(t,e),t}(m()(Error)),E=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"RetryError";return u()(this,t),c()(this,d()(t).call(this,e))}return p()(t,e),t}(m()(Error)),A=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"EmailConfirmationError";return u()(this,t),c()(this,d()(t).call(this,e))}return p()(t,e),t}(m()(Error)),O=function(e,t){return function(n){if(n instanceof e)return t(n);throw n}},R=function(e){return function(t){if(!(t instanceof e))throw t}},P=function(e){return Object(v.f)(e)&&Object(v.f)(e.response)&&Object(v.f)(e.response.data)&&Object(v.f)(e.response.data.detail)}},QLQS:function(e,t,n){"use strict";n("cohD");var i=n("IOd0"),r=n("5mbm"),a=n("a3nb"),o=n("czSk"),s={Vec3:0,Quat:1,Float:2,FloatCubicBezier:3,Vec3CubicBezier:4,QuatSlerp:5,Matrix:6,Count:7},u={InvalidTargetID:-1},l=function(e,t,n){return{type:e,id:u.InvalidTargetID,channels:[],value:t,defaultValue:n}};u.createQuatTarget=function(e){return l(s.Quat,o.d.copy(o.d.create(),e),o.d.copy(o.d.create(),e))},u.createVec3Target=function(e){return l(s.Vec3,o.f.copy(o.f.create(),e),o.f.copy(o.f.create(),e))},u.createFloatTarget=function(e){return l(s.Float,e,e)},u.createMatrixTarget=function(e){return l(s.Matrix,o.c.copy(o.c.create(),e),o.c.copy(o.c.create(),e))};var c=u,h={},d=function(e,t,n,i,r,a){var o=n[0],s=n[n.length-1];return a.start=o,a.keys=t,a.end=s,a.times=n,a.type=e,a.duration=s-o,a.target=i,a.name=r,a},f={create:function(){return 0}},p={create:function(){return o.f.create32()}},g={create:function(){return o.d.create32()}},m=function(e,t){return{channel:t,value:e.create(),targetID:c.InvalidTargetID,weight:1,key:0,start:0,end:0}},v=function(e){return m(p,e)},_=function(e){return m(g,e)},b=function(e){return m(f,e)},S=function(e){return m(f,e)},y=function(e){return m(p,e)};h.createInstanceChannel=function(e){return h[e.type](e)},h.createInstanceVec3Channel=v,h.createInstanceQuatChannel=_,h.createInstanceQuatSlerpChannel=_,h.createInstanceFloatChannel=b,h.createInstanceFloatCubicBezierChannel=S,h.createInstanceVec3CubicBezierChannel=y,h.createVec3Channel=function(e,t,n,i,r){return d(s.Vec3,e,t,n,i,r||{})},h.createQuatChannel=function(e,t,n,i,r){return d(s.Quat,e,t,n,i,r||{})},h.createQuatSlerpChannel=function(e,t,n,i,r){return d(s.QuatSlerp,e,t,n,i,r||{})},h.createFloatChannel=function(e,t,n,i,r){return d(s.Float,e,t,n,i,r||{})},h.createFloatCubicBezierChannel=function(e,t,n,i,r){return d(s.FloatCubicBezier,e,t,n,i,r||{})},h.createVec3CubicBezierChannel=function(e,t,n,i,r){return d(s.Vec3CubicBezier,e,t,n,i,r||{})},h[s.Vec3]=v,h[s.Quat]=_,h[s.QuatSlerp]=_,h[s.Float]=b,h[s.FloatCubicBezier]=S,h[s.Vec3CubicBezier]=y,h.ChannelType=s;var x=h,C=0,w=function(){};w.createAnimation=function(e,t){for(var n=1/0,i=-1/0,r=0;r<e.length;r++)n=Math.min(n,e[r].start),i=Math.max(i,e[r].end);var a=i-n,o=t||"animation"+C.toString();return C++,{channels:e,duration:a,name:o,start:n}},w.createInstanceAnimation=function(e){for(var t=[],n=0;n<e.channels.length;n++){var i=x.createInstanceChannel(e.channels[n]);t.push(i)}return{channels:t,duration:e.duration,start:0,name:e.name,firstKeyTime:e.start}};var T=w,M=n("vnIN"),E=n("7E8H"),A=n("icjm"),O=n("qRO0"),R=function(e,t,n){n[0]=t[e++],n[1]=t[e++],n[2]=t[e++]},P=function(e,t,n){n[0]=t[e++],n[1]=t[e++],n[2]=t[e++],n[3]=t[e++]},I=function(e,t){var n=t.channel,i=t.value,r=n.keys,a=n.times;if(e>=a[a.length-1])return t.key=0,void R(r.length-3,r,i);if(e<=a[0])return t.key=0,void R(0,r,i);var o=t.key;if(e>a[o])for(;a[o+1]<e;)o++;else if(e<a[o])for(;a[o]>e;)o--;var s=a[o],u=a[o+1],l=3*o,c=r[l++],h=r[l++],d=r[l++],f=r[l++],p=r[l++],g=r[l++],m=(e-s)/(u-s);i[0]=c+(f-c)*m,i[1]=h+(p-h)*m,i[2]=d+(g-d)*m,t.key=o},N=function(){var e=o.d.create32(),t=o.d.create32();return function(n,i){var r=i.channel,a=i.value,s=r.keys,u=r.times;if(n>=u[u.length-1])return i.key=0,void P(s.length-4,s,a);if(n<=u[0])return i.key=0,void P(0,s,a);var l=i.key;if(n>u[l])for(;u[l+1]<n;)l++;else if(n<u[l])for(;u[l]>n;)l--;var c=u[l],h=u[l+1],d=4*l;e[0]=s[d++],e[1]=s[d++],e[2]=s[d++],e[3]=s[d++],t[0]=s[d++],t[1]=s[d++],t[2]=s[d++],t[3]=s[d++];var f=(n-c)/(h-c);o.d.nlerp(a,e,t,f),i.key=l}}(),L=function(){var e=o.d.create32(),t=o.d.create32();return function(n,i){var r=i.channel,a=i.value,s=r.keys,u=r.times;if(n>=u[u.length-1])return i.key=0,void P(s.length-4,s,a);if(n<=u[0])return i.key=0,void P(0,s,a);var l=i.key;if(n>u[l])for(;u[l+1]<n;)l++;else if(n<u[l])for(;u[l]>n;)l--;var c=u[l],h=u[l+1],d=4*l;e[0]=s[d++],e[1]=s[d++],e[2]=s[d++],e[3]=s[d++],t[0]=s[d++],t[1]=s[d++],t[2]=s[d++],t[3]=s[d++];var f=(n-c)/(h-c);o.d.slerp(a,e,t,f),i.key=l}}(),k=function(e,t){var n=t.channel,i=t.value,r=n.keys,a=n.times;if(e>=a[a.length-1])return t.key=0,void(t.value=r[r.length-1]);if(e<=a[0])return t.key=0,void(t.value=r[0]);var o=t.key;if(e>a[o])for(;a[o+1]<e;)o++;else if(e<a[o])for(;a[o]>e;)o--;var s=a[o],u=a[o+1],l=o,c=r[l++];i=c+(r[l++]-c)*((e-s)/(u-s)),t.key=o,t.value=i},D=function(e,t){var n=t.channel,i=t.value,r=n.keys,a=n.times;if(e>=a[a.length-1])return t.key=0,void(t.value=r[r.length-3]);if(e<=a[0])return t.key=0,void(t.value=r[0]);var o=t.key;if(e>a[o])for(;a[o+1]<e;)o++;else if(e<a[o])for(;a[o]>e;)o--;var s=(e-a[o])/(a[o+1]-a[o]),u=1-s,l=u*u,c=l*u,h=s*s,d=3*o;i=r[d]*c+r[d+1]*(3*s*l)+r[d+2]*(3*h*u)+r[d+3]*(h*s),t.key=o,t.value=i},F=function(){var e=o.f.create(),t=o.f.create(),n=o.f.create(),i=o.f.create();return function(r,a){var s=a.channel,u=a.value,l=s.keys,c=s.times;if(r>=c[c.length-1])return a.key=0,void R(l.length-9,l,u);if(r<=c[0])return a.key=0,void R(0,l,u);var h=a.key;if(r>c[h])for(;c[h+1]<r;)h++;else if(r<c[h])for(;c[h]>r;)h--;var d=(r-c[h])/(c[h+1]-c[h]),f=1-d,p=f*f,g=p*f,m=d*d,v=9*h;o.f.scale(e,o.f.set(e,l[v++],l[v++],l[v++]),g),o.f.scale(t,o.f.set(t,l[v++],l[v++],l[v++]),3*d*p),o.f.scale(n,o.f.set(n,l[v++],l[v++],l[v++]),3*m*f),o.f.scale(i,o.f.set(i,l[v++],l[v++],l[v++]),m*d),u[0]=e[0]+t[0]+n[0]+i[0],u[1]=e[1]+t[1]+n[1]+i[1],u[2]=e[2]+t[2]+n[2]+i[2],a.key=h}}(),V=x.ChannelType,B={};B[V.Vec3]=I,B[V.Quat]=N,B[V.QuatSlerp]=L,B[V.Float]=k,B[V.FloatCubicBezier]=D,B[V.Vec3CubicBezier]=F,B.Vec3LerpInterpolator=I,B.QuatLerpInterpolator=N,B.QuatSlerpInterpolator=L,B.FloatLerpInterpolator=k,B.FloatCubicBezierInterpolator=D,B.Vec3CubicBezierInterpolator=F;var U=B,j=n("r7P/"),G=function(){j.a.call(this),this._animationUpdateCallback={}};a.a.createPrototypeObject(G,a.a.objectInherit(j.a.prototype,{getAnimationUpdateCallbackMap:function(){return this._animationUpdateCallback},apply:function(e){for(var t=e.getUpdateCallbackList(),n=0,i=t.length;n<i;n++){var r=t[n];r instanceof E.a&&(this._animationUpdateCallback[r.getInstanceID()]=r)}this.traverse(e)}}),"osgAnimation","CollectAnimationUpdateCallbackVisitor");var H=G,z=n("D1Qd"),W=n("hLWu"),q=n("WqyB"),X=function(){E.a.call(this),this._targets=[],this._targetNames=[],this._morphs=[],this._weights=new Float32Array(q.a.MAX_MORPH_GPU),this._indexMap=new Uint32Array(q.a.MAX_MORPH_GPU),this._gpuMorphed=[],this._maxMorphGPU=-1},Y=function(e,t){return Math.abs(t.value)-Math.abs(e.value)};a.a.createPrototypeObject(X,a.a.objectInherit(E.a.prototype,{_initNode:function(e){var t;e instanceof q.a?t=e:e instanceof W.a&&e.getSourceGeometry()instanceof q.a&&(t=e.getSourceGeometry()),t&&t.getName()===this.getName()&&(t.isInitialized()||t.init(),this._morphs.push(t),this._maxMorphGPU=Math.min(this._maxMorphGPU,t.getMaximumPossibleMorphGPU()))},init:function(e){this._maxMorphGPU=q.a.MAX_MORPH_GPU,this._morphs.length=0;var t=e.getChildren();if(t.length)for(var n=0,i=t.length;n<i;n++)this._initNode(t[n]);else this._initNode(e)},isInitialized:function(){var e=this._morphs,t=e.length;if(!t)return!1;for(var n=0;n<t;++n)if(!e[n].isInitialized())return!1;return!0},getNumTarget:function(){return this._targets.length},getTarget:function(e){return this._targets[e]},getTargetName:function(e){return this._targetNames[e]},addTarget:function(e,t){this._targets[t]=c.createFloatTarget(0),this._targetNames[t]=e},_remapBufferArrays:function(){for(var e=this._indexMap,t=this._morphs,n=0;n<this._maxMorphGPU;++n)for(var i="_"+n,r="_"+e[n],a=0,o=t.length;a<o;++a)for(var s=t[a],u=s.getVertexAttributeList(),l=s.getMorphTargetNames(),c=0,h=l.length;c<h;++c){var d=l[c];u[d+i].setBufferArray(u[d+r].getInitialBufferArray())}},_mergeExtraMorphTarget:function(e,t,n){var i=0,r=this._gpuMorphed,a=e[t],o=a.getElements().length,s=o/a.getItemSize(),u=a.getItemSize();a._cpuMorph=a._cpuMorph||new z.a(z.a.ARRAY_BUFFER,new Float32Array(o),u);var l=a._cpuMorph.getElements();for(i=0;i<o;++i)l[i]=0;for(var c=this._targets,h=0,d=c.length;h<d;++h)if(!0!==r[h]){var f=c[h].value;if(!(Math.abs(f)<=q.a.EFFECTIVE_EPS)){f/=n;var p=e[t+"_"+h].getInitialBufferArray().getElements();for(i=0;i<s;++i){var g=i*u;l[g]+=f*p[g],l[g+1]+=f*p[g+1],l[g+2]+=f*p[g+2]}}}e[t+"_"+(this._maxMorphGPU-1)].setBufferArray(a._cpuMorph),a._cpuMorph.dirty()},_computeExtraWeightsSum:function(){for(var e=this._gpuMorphed,t=0,n=this._targets,i=0,r=n.length;i<r;++i)if(!0!==e[i]){var a=n[i].value;Math.abs(a)<=q.a.EFFECTIVE_EPS||(t+=a)}return Math.abs(t)>1e-5?t:t<0?-1e-5:1e-5},_morphBufferArrayCPU:function(){for(var e=this._weights[this._maxMorphGPU-1]=this._computeExtraWeightsSum(),t={},n=this._morphs,i=0,r=n.length;i<r;++i)for(var a=n[i],o=a.getVertexAttributeList(),s=a.getMorphTargetNames(),u=0,l=s.length;u<l;++u){var c=s[u],h=o[c];h&&!t[h.getInstanceID()]&&(t[h.getInstanceID()]=!0,this._mergeExtraMorphTarget(o,c,e))}},updateWeights:function(){if(0!==this._maxMorphGPU){var e=0,t=this._targets,n=t.length,i=this._weights;if(i[0]=i[1]=i[2]=i[3]=0,n<=this._maxMorphGPU)for(e=0;e<n;++e)i[e]=t[e].value;else{var r=this._indexMap;r[0]=r[1]=r[2]=r[3]=0;var a=this._gpuMorphed;for(a.length=n,e=0;e<n;++e)a[e]=!1;var o=t.slice(0).sort(Y);for(e=0;e<this._maxMorphGPU;++e){var s=t.indexOf(o[e]);a[s]=!0,r[e]=s,i[e]=o[e].value}var u=Math.abs(o[this._maxMorphGPU].value)>q.a.EFFECTIVE_EPS;a[r[this._maxMorphGPU-1]]=!u,this._remapBufferArrays(),u&&this._morphBufferArrayCPU()}}},reset:function(){for(var e=this._targets,t=0,n=e.length;t<n;++t)e[t].value=e[t].defaultValue},update:function(e){this.isInitialized()||this.init(e),this.updateWeights();for(var t=this._weights,n=Math.min(this._maxMorphGPU,this._targets.length),i=this._morphs,r=0,a=i.length;r<a;++r)for(var o=i[r].getTargetsWeight(),s=0;s<n;s++)o[s]=t[s];return!0}}),"osgAnimation","UpdateMorph");var K=X,Q=n("f/27"),J=n("JLE6"),Z={lerp:function(e,t,n){return e+(t-e)*n},init:function(){return 0},copy:function(e,t){return t},create:function(){return 0}},$=[];$[x.ChannelType.Float]=1,$[x.ChannelType.FloatCubicBezier]=1,$[x.ChannelType.Vec3]=3,$[x.ChannelType.Vec3CubicBezier]=3,$[x.ChannelType.Quat]=4,$[x.ChannelType.QuatSlerp]=4,$[x.ChannelType.Matrix]=16;var ee=[];ee.length=x.ChannelType.Count,ee[x.ChannelType.Vec3]=o.f,ee[x.ChannelType.Quat]=o.d,ee[x.ChannelType.QuatSlerp]=o.d,ee[x.ChannelType.Float]=Z,ee[x.ChannelType.FloatCubicBezier]=Z,ee[x.ChannelType.Vec3CubicBezier]=o.f,ee[x.ChannelType.Matrix]=o.c;var te=function(){O.a.call(this),this._simulationTime=0,this._pauseTime=0,this._timeFactor=1,this._startTime=0,this._instanceAnimations={},this._startAnimations={},this._targets=[],this._targetsMap={},this._targetsByTypes=[],this._targetsByTypes.length=x.ChannelType.Count;for(var e=0,t=this._targetsByTypes.length;e<t;e++)this._targetsByTypes[e]=[];this._activeAnimations={},this._activeAnimationList=[],this._activeChannelsByTypes=[],this._activeChannelsByTypes.length=x.ChannelType.Count;for(var n=0,i=this._activeChannelsByTypes.length;n<i;n++)this._activeChannelsByTypes[n]=[];this._animationsUpdateCallback={},this._animationsUpdateCallbackArray=[],this._animationsToRegister=[],this._pause=!1,this._dirty=!1,this._seekTime=-1};a.a.createPrototypeObject(te,a.a.objectInherit(O.a.prototype,{init:function(e){this._simulationTime=0,this._pauseTime=0,this._timeFactor=1,this._startTime=0,this._instanceAnimations={},this._startAnimations={},this._resetTargets(),this._activeAnimations={},this._activeAnimationList.length=0;for(var t=0,n=this._activeChannelsByTypes.length;t<n;t++)this._activeChannelsByTypes[t].length=0;this._animationsUpdateCallback={},this._animationsUpdateCallbackArray.length=0,this._pause=!1,this._seekTime=-1,this.addAnimations(e)},addAnimations:function(e){var t=this._addAnimation(e);Array.prototype.push.apply(this._animationsToRegister,t),this._dirty=!0,this._registerAnimations()},update:function(e,t){this._dirty&&(this._findAnimationUpdateCallback(e),this._registerTargetFoundInAnimationCallback(),this._registerAnimations());var n=t.getFrameStamp().getSimulationTime();return-1!==this._seekTime&&(this._pauseTime=-this._seekTime+this._startTime+n),this._seekTime=-1,this._pause?this._pauseTime=n-this._simulationTime+this._startTime:this._simulationTime=this._startTime+(n-this._pauseTime),this.updateManager(this._simulationTime*this._timeFactor),!0},updateManager:function(e){this._processStartAnimation(e);for(var t=x.ChannelType.Count,n=0;n<t;n++){var i=this._activeChannelsByTypes[n];this._updateChannelsType(e,i,U[n])}for(var r=0;r<t;r++){var a=this._targetsByTypes[r];this._updateTargetType(a,ee[r])}for(var o=0,s=this._animationsUpdateCallbackArray.length;o<s;o++){this._animationsUpdateCallbackArray[o].computeChannels()}this._removeFinishedAnimation(e)},togglePause:function(){this._pause=!this._pause,this._pause||(this._seekTime=this._simulationTime)},getSimulationTime:function(){return this._simulationTime},setSimulationTime:function(e){this._simulationTime=e},setSeekTime:function(e){this._simulationTime=e,this._seekTime=e},stopAnimation:function(e){for(var t=this._activeAnimationList,n=0,i=t.length;n<i;++n)if(t[n].name===e)return this._removeActiveChannels(this._instanceAnimations[e]),this._activeAnimations[e]=void 0,void t.splice(n,1)},stopAllAnimation:function(){for(var e=this._activeAnimationList,t=0,n=e.length;t<n;++t){var i=e[t].name;this._removeActiveChannels(this._instanceAnimations[i]),this._activeAnimations[i]=void 0}e.length=0},setTimeFactor:function(e){var t=e/this._timeFactor;this._startTime+=(this._simulationTime-this._simulationTime*t)/t,this._timeFactor=e,this._pause&&(this._simulationTime+=(this._simulationTime-this._simulationTime*t)/t)},getTimeFactor:function(){return this._timeFactor},isPlaying:function(e){return!!this._activeAnimations[e]},playAnimationObject:function(e){var t=this._instanceAnimations[e.name];t?this.isPlaying(e.name)||(t.priority=void 0===e.priority?0:e.priority,t.weight=void 0===e.weight?1:e.weight,t.loop=void 0===e.loop||e.loop,this._startAnimations[t.name]=t):A.a.info("no animation "+e.name+" found")},playAnimation:function(e,t,n,i){var r;return r="object"==typeof e?e:{name:e,priority:n,weight:i,loop:t},this.playAnimationObject(r)},getAnimations:function(){return this._instanceAnimations},_registerAnimations:function(){if(this._targets.length){for(var e=0,t=this._animationsToRegister.length;e<t;e++){var n=this._animationsToRegister[e];this._registerInstanceAnimation(n)}this._animationsToRegister.length=0,this._dirty=!1}},_registerInstanceAnimation:function(e){for(var t=e.channels,n=0,i=t.length;n<i;n++){var r=t[n],a=r.channel.target+"."+r.channel.name;this._targetMap[a]?r.targetID=this._targetMap[a].id:A.a.warn("registerInstanceAnimation did not find targetName ("+a+") in the scene graph")}return!0},_findAnimationUpdateCallback:function(e){var t=new H;e.accept(t),this._animationsUpdateCallback=t.getAnimationUpdateCallbackMap()},_registerTargetFoundInAnimationCallback:function(){this._resetTargets();var e,t,n=0,i=this._targetMap,r=this._targets,a=function(e,t){if(i[e])t!==i[e]&&A.a.warn("detected differents target instance with the same name ("+e+")");else{i[e]=t,t.id=n++,r.push(t);var a=t.type;this._targetsByTypes[a].push(t)}}.bind(this);for(var o in this._animationsUpdateCallback){var s=this._animationsUpdateCallback[o];if(s instanceof J.a||s instanceof Q.a){var u=s.getStackedTransforms(),l=u.length;if(!l)continue;this._animationsUpdateCallbackArray.push(s);for(var c=0;c<l;c++){var h=u[c];e=h.getTarget(),t=h.getName(),a(s.getName()+"."+t,e,t)}}else if(s instanceof K){var d=s.getNumTarget();if(!d)continue;this._animationsUpdateCallbackArray.push(s);for(var f=0;f<d;f++)a((t=s.getTargetName(f))+"."+f,e=s.getTarget(f),t)}}},_addAnimation:function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n],a=r.name;if(!this._instanceAnimations[a]){var o=T.createInstanceAnimation(r);this._instanceAnimations[a]=o,t.push(o)}}return t},_addActiveChannels:function(e,t){for(var n=t.channels,i=0,r=n.length;i<r;i++){var a=n[i],o=a.channel.type;a.t=e,a.instanceAnimation=t;var s=a.targetID;s!==c.InvalidTargetID&&(this._activeChannelsByTypes[o].push(a),this._targets[s].channels.push(a))}},_removeActiveChannels:function(e){for(var t=e.channels,n=0,i=t.length;n<i;n++){var r=t[n],a=r.channel.type,o=r.targetID;if(o!==c.InvalidTargetID){var s=this._targets[o].channels,u=s.indexOf(r);s.splice(u,1);var l=this._activeChannelsByTypes[a],h=l.indexOf(r);l.splice(h,1)}}},_updateTargetType:function(e,t){for(var n=0,i=e.length;n<i;n++){var r=e[n],a=r.channels,o=a.length;if(0===o)r.value=t.copy(r.value,r.defaultValue);else if(1===o)r.value=t.copy(r.value,a[0].value);else{r.value=t.init(r.value);for(var s=0,u=0,l=a.length;u<l;u++){var c=a[u],h=c.weight;if(0!==(s+=h)&&0!==h){var d=h/s;r.value=t.lerp(r.value,r.value,c.value,d)}}}}},_updateChannelsType:function(e,t,n){for(var i=0,r=t.length;i<r;i++){var a=t[i],o=a.instanceAnimation,s=o.loop,u=e-a.t;s&&o.duration>0&&(u%=o.duration),n(u+o.firstKeyTime,a)}},_removeFinishedAnimation:function(e){for(var t=this._activeAnimationList,n=0;n<t.length;){var i=t[n],r=i.name;e>i.end&&!1===i.loop?(this._removeActiveChannels(i),this._activeAnimations[r]=void 0,t.splice(n,1)):n++}},_addActiveAnimation:function(e,t){this._activeAnimations[t.name]=t;var n=this._instanceAnimations[t.name];n.start=e,n.end=e+n.duration,this._addActiveChannels(e,n),this._activeAnimationList.push(n)},_processStartAnimation:function(e){if(this._targets.length){var t;for(t in this._startAnimations){var n=this._startAnimations[t],i=n.name;this.isPlaying(i)||this._addActiveAnimation(e,n)}void 0!==t&&(this._startAnimations={})}},_resetTargets:function(){this._targetMap={},this._targets.length=0;for(var e=0,t=this._targetsByTypes.length;e<t;e++)this._targetsByTypes[e].length=0},resetUpdateCallbacks:function(){for(var e=this._animationsUpdateCallbackArray,t=0,n=e.length;t<n;t++)e[t].reset()},resetAllStackedTransforms:function(){A.a.warn("Uses resetUpdateCallback instead"),this.resetUpdateCallbacks()},setAnimationLerpEndStart:function(e,t){var n=e.channels;void 0===e.originalDuration&&(e.originalDuration=e.duration),e.duration=e.originalDuration+t;for(var i=e.firstKeyTime,r=e.originalDuration,a=0,o=n.length;a<o;++a){var s=n[a].channel;if(!(Math.abs(s.start-i)>.01||Math.abs(s.duration-r)>.01)){void 0===s.originalEnd&&(s.originalEnd=s.end),s.end=s.originalEnd+t;var u=$[s.type],l=s.times.buffer.byteLength/4;if(0===t)s.keys=new Float32Array(s.keys.buffer,0,(l-1)*u),s.times=new Float32Array(s.times.buffer,0,l-1);else{s.keys=new Float32Array(s.keys.buffer,0,l*u);for(var c=(l-1)*u,h=0;h<u;++h)s.keys[c+h]=s.keys[h];s.times=new Float32Array(s.times.buffer,0,l),s.times[l-1]=s.times[l-2]+t}}}}}),"osgAnimation","BasicAnimationManager"),te.TypeToSize=$;var ne=te,ie=n("gHdx");var re={easeLinear:function(e){return e},easeOutQuad:function(e){var t=e-1;return 1-t*t},easeInQuad:function(e){return e*e},easeInOutQuad:function(e){var t=e-1,n=2*e;return n<1?e*n:1-t*t*2},easeOutCubic:function(e){var t=e-1;return 1+t*t*t},easeInCubic:function(e){return e*e*e},easeInOutCubic:function(e){var t=e-1,n=2*e;return n<1?e*n*n:1+t*t*t*4},easeOutQuart:function(e){var t=e-1;return 1-t*t*t*t},easeInQuart:function(e){return e*e*e*e},easeInOutQuart:function(e){var t=e-1,n=2*e;return n<1?e*n*n*n:1-t*t*t*t*8},easeOutQuintic:function(e){var t=e-1;return 1+t*t*t*t*t},easeInQuintic:function(e){return e*e*e*e*e},easeInOutQuintic:function(e){var t=e-1,n=2*e;return n<1?e*n*n*n*n:1+t*t*t*t*t*16},easeOutSextic:function(e){var t=e-1;return 1-t*t*t*t*t*t},easeInSextic:function(e){return e*e*e*e*e*e},easeInOutSextic:function(e){var t=e-1,n=2*e;return n<1?e*n*n*n*n*n:1-t*t*t*t*t*t*32},easeOutSeptic:function(e){var t=e-1;return 1+t*t*t*t*t*t*t},easeInSeptic:function(e){return e*e*e*e*e*e*e},easeInOutSeptic:function(e){var t=e-1,n=2*e;return n<1?e*n*n*n*n*n*n:1+t*t*t*t*t*t*t*64},easeOutOctic:function(e){var t=e-1;return 1-t*t*t*t*t*t*t*t},easeInOctic:function(e){return e*e*e*e*e*e*e*e},easeInOutOctic:function(e){var t=e-1,n=2*e;return n<1?e*n*n*n*n*n*n*n:1-t*t*t*t*t*t*t*t*128},easeOutBack:function(e){var t=e-1,n=1.70158;return 1+t*t*(t*(n+1)+n)},easeInBack:function(e){var t=1.70158;return e*e*(e*(t+1)-t)},easeInOutBack:function(e){var t=e-1,n=2*e,i=2.5949095;return e<.5?e*n*(n*(i+1)-i):1+2*t*t*(2*t*(i+1)+i)},easeOutCircle:function(e){var t=e-1;return Math.sqrt(1-t*t)},easeInCircle:function(e){return 1-Math.sqrt(1-e*e)},easeInOutCircle:function(e){var t=e-1,n=2*e;return n<1?.5*(1-Math.sqrt(1-n*n)):.5*(Math.sqrt(1-4*t*t)+1)},easeOutElastic:function(e){return Math.pow(2,-10*e)*Math.sin((e-.075)*(2*Math.PI)/.3)+1},easeInElastic:function(e){return-1*Math.pow(2,10*e)*Math.sin(2*(e-1-.075)*Math.PI/.3)},easeInOutElastic:function(e){return(e*=2)<1?1*Math.pow(2,10*e)*-.5*Math.sin(2*(e-1-.45)*Math.PI/.45):1*Math.pow(2,-10*(e-=1))*Math.sin(2*(e-.45)*Math.PI/.45)*.5+1},easeOutBounce:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInBounce:function(e){return(e=1-e)<1/2.75?1-7.5625*e*e:e<2/2.75?1-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)},easeInOutBounce:function(e){var t;return e<.5?(t=!0,e=1-2*e):e=2*e-1,e<1/2.75?e*=7.5625*e:e=e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,t?.5*(1-e):.5*e+.5}},ae=n("djFS"),oe=n("/pUn"),se=function(e,t){O.a.call(this),this._target=c.createMatrixTarget(t||o.c.IDENTITY),e&&this.setName(e)};a.a.createPrototypeObject(se,a.a.objectInherit(O.a.prototype,{init:function(e){this.setMatrix(e),o.c.copy(this._target.defaultValue,e)},getTarget:function(){return this._target},getMatrix:function(){return this._target.value},setMatrix:function(e){o.c.copy(this._target.value,e)},resetToDefaultValue:function(){this.setMatrix(this._target.defaultValue)},applyToMatrix:function(e){o.c.mul(e,e,this._target.value)}}),"osgAnimation","StackedMatrix");var ue=se,le=o.d.create(),ce=function(e,t){O.a.call(this),this._target=c.createQuatTarget(t||le),e&&this.setName(e)};a.a.createPrototypeObject(ce,a.a.objectInherit(O.a.prototype,{init:function(e){this.setQuaternion(e),o.d.copy(this._target.defaultValue,e)},setQuaternion:function(e){o.d.copy(this._target.value,e)},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setQuaternion(this._target.defaultValue)},applyToMatrix:function(){var e=o.c.create();return function(t){var n=e;o.c.fromQuat(n,this._target.value),o.c.mul(t,t,n)}}()}),"osgAnimation","StackedQuaternion");var he=ce,de=function(e,t,n){O.a.call(this),this._axis=o.f.fromValues(0,0,1),t&&o.f.copy(this._axis,t),this._target=c.createFloatTarget("number"==typeof n?n:0),e&&this.setName(e)};a.a.createPrototypeObject(de,a.a.objectInherit(O.a.prototype,{init:function(e,t){this.setAxis(e),this.setAngle(t),this._target.defaultValue=t},setAxis:function(e){o.f.copy(this._axis,e)},setAngle:function(e){this._target.value=e},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setAngle(this._target.defaultValue)},applyToMatrix:function(){var e=o.c.create(),t=o.d.create();return function(n){var i=this._axis,r=t,a=e,s=this._target.value;o.d.setAxisAngle(r,i,s),o.c.fromQuat(a,r),o.c.mul(n,n,a)}}()}),"osgAnimation","StackedRotateAxis");var fe=de,pe=function(e,t){O.a.call(this),this._target=c.createVec3Target(t||o.f.ONE),e&&this.setName(e)};a.a.createPrototypeObject(pe,a.a.objectInherit(O.a.prototype,{init:function(e){this.setScale(e),o.f.copy(this._target.defaultValue,e)},setScale:function(e){o.f.copy(this._target.value,e)},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setScale(this._target.defaultValue)},applyToMatrix:function(e){var t=this._target.value;o.c.scale(e,e,t)}}),"osgAnimation","StackedScale");var ge=pe,me=function(e,t){O.a.call(this),this._target=c.createVec3Target(t||o.f.ZERO),e&&this.setName(e)};a.a.createPrototypeObject(me,a.a.objectInherit(O.a.prototype,{init:function(e){this.setTranslate(e),o.f.copy(this._target.defaultValue,e)},setTranslate:function(e){o.f.copy(this._target.value,e)},getTarget:function(){return this._target},resetToDefaultValue:function(){this.setTranslate(this._target.defaultValue)},applyToMatrix:function(e){o.c.translate(e,e,this._target.value)}}),"osgAnimation","StackedTranslate");var ve=me,_e=n("1MxV"),be={};a.a.objectMix(be,re),a.a.objectMix(be,U),be.Animation=T,be.SkinningAttribute=M.a,be.AnimationUpdateCallback=E.a,be.BasicAnimationManager=ne,be.Bone=ie.a,be.Channel=x,be.CollectAnimationUpdateCallbackVisitor=H,be.MorphAttribute=ae.a,be.MorphGeometry=q.a,be.RigGeometry=W.a,be.Skeleton=oe.a,be.StackedMatrix=ue,be.StackedQuaternion=he,be.StackedRotateAxis=fe,be.StackedScale=ge,be.StackedTranslate=ve,be.UpdateBone=Q.a,be.UpdateMatrixTransform=J.a,be.UpdateMorph=K,be.UpdateSkeleton=_e.a;var Se=be,ye=n("zeFU"),xe=n("RTFJ"),Ce=n("DkmK"),we=n("9oTK"),Te=n.n(we),Me=n("LTZp"),Ee=a.a.rejectObject,Ae={Object:function(e,t){var n=e.getJSON();if(n.Name&&t.setName(n.Name),n.UserDataContainer){var i=e.setJSON(n.UserDataContainer).readUserDataContainer();void 0!==i&&t.setUserData(i)}return t},Node:function(e,t){var n=e.getJSON();Ae.Object(e,t);var i=[];if(n.UpdateCallbacks)for(var r=t.addUpdateCallback.bind(t),a=0,o=n.UpdateCallbacks.length;a<o;a++){var s=e.setJSON(n.UpdateCallbacks[a]).readObject();i.push(s),s.then(r)}if(n.StateSet){var u=e.setJSON(n.StateSet).readObject();i.push(u),u.then(t.setStateSet.bind(t))}var l=[];if(n.Children)for(var c=0,h=n.Children.length;c<h;c++)l.push(e.setJSON(n.Children[c]).readObject());return Te.a.all(i).then(function(){return Te.a.all(l).then(function(e){for(var n=e.length,i=0;i<n;i++)t.addChild(e[i]);return t})})},StateSet:function(e,t){var n=e.getJSON();Ae.Object(e,t),void 0!==n.RenderingHint&&t.setRenderingHint(n.RenderingHint);var i=[],r=function(n){var r=e.setJSON(n).readObject();r.isRejected()||(i.push(r),r.then(t.setAttributeAndModes.bind(t)))};if(void 0!==n.AttributeList)for(var a=0,o=n.AttributeList.length;a<o;a++)r(n.AttributeList[a]);var s=function(n,r){var a=e.setJSON(r).readObject();a.isRejected()||(i.push(a),a.then(t.setTextureAttributeAndModes.bind(t,n)))};if(n.TextureAttributeList)for(var u=n.TextureAttributeList,l=0,c=u.length;l<c;l++)for(var h=u[l],d=0,f=h.length;d<f;d++)s(l,h[d]);return Te.a.all(i).then(function(){return t})},Material:function(e,t){var n=e.getJSON();return n.Diffuse&&n.Emission&&n.Specular&&void 0!==n.Shininess?(Ae.Object(e,t),t.setAmbient(n.Ambient),t.setDiffuse(n.Diffuse),t.setEmission(n.Emission),t.setSpecular(n.Specular),t.setShininess(n.Shininess),Te.a.resolve(t)):Ee("Material",n)},BlendFunc:function(e,t){var n=e.getJSON();return n.SourceRGB&&n.SourceAlpha&&n.DestinationRGB&&n.DestinationAlpha?(Ae.Object(e,t),t.setSourceRGB(n.SourceRGB),t.setSourceAlpha(n.SourceAlpha),t.setDestinationRGB(n.DestinationRGB),t.setDestinationAlpha(n.DestinationAlpha),Te.a.resolve(t)):Ee("BlendFunc",n)},CullFace:function(e,t){var n=e.getJSON();return void 0===n.Mode?Ee("CullFace",n):(Ae.Object(e,t),t.setMode(n.Mode),Te.a.resolve(t))},BlendColor:function(e,t){var n=e.getJSON();return n.ConstantColor?(Ae.Object(e,t),t.setConstantColor(n.ConstantColor),Te.a.resolve(t)):Ee("BlendColor",n)},Light:function(e,t){var n=e.getJSON();return n.Ambient&&n.Diffuse&&n.Direction&&n.Position&&n.Specular&&void 0!==n.LightNum&&void 0!==n.SpotCutoff&&void 0!==n.LinearAttenuation&&void 0!==n.ConstantAttenuation&&void 0!==n.QuadraticAttenuation?(Ae.Object(e,t),t.setAmbient(n.Ambient),t.setConstantAttenuation(n.ConstantAttenuation),t.setDiffuse(n.Diffuse),t.setDirection(n.Direction),t.setLightNumber(n.LightNum),t.setLinearAttenuation(n.LinearAttenuation),t.setPosition(n.Position),t.setQuadraticAttenuation(n.QuadraticAttenuation),t.setSpecular(n.Specular),t.setSpotCutoff(n.SpotCutoff),t.setSpotBlend(.01),void 0!==n.SpotExponent&&t.setSpotBlend(n.SpotExponent/128),Te.a.resolve(t)):Ee("Light",n)},Texture:function(e,t){var n=e.getJSON();Ae.Object(e,t),n.MinFilter&&t.setMinFilter(n.MinFilter),n.MagFilter&&t.setMagFilter(n.MagFilter),n.WrapT&&t.setWrapT(n.WrapT),n.WrapS&&t.setWrapS(n.WrapS);var i=n.File;return void 0===i&&(i="no-image-provided"),e.readImageURL(i).then(function(e){return t.setImage(e),t})},Projection:function(e,t){var n=e.getJSON();if(!n.Matrix)return Ee("Projection",n);var i=Ae.Node(e,t);return t.setMatrix(n.Matrix),i},MatrixTransform:function(e,t){var n=e.getJSON();if(!n.Matrix)return Ee("MatrixTransform",n);var i=Ae.Node(e,t);return t.setMatrix(n.Matrix),i},LightSource:function(e,t){var n=e.getJSON();if(!n.Light)return Ee("LightSource",n);var i=Ae.Node(e,t);return Te.a.all([e.setJSON(n.Light).readObject(),i]).then(function(e){var i=e[0];return t.setLight(i),"ABSOLUTE_RF"===n.ReferenceFrame&&t.setReferenceFrame(Me.a.ABSOLUTE_RF),t})},functionSortAttributes:function(e,t){return-1!==e.indexOf("TexCoord")&&-1!==t.indexOf("TexCoord")?parseInt(e.substr(8),10)-parseInt(t.substr(8),10):e<t?-1:e>t?1:0},Geometry:function(e,t){var n=e.getJSON();if(!n.VertexAttributeList)return Ee("Geometry",n);n.PrimitiveSetList=n.PrimitiveSetList||[];var i=[];i.push(Ae.Node(e,t));var r=t.getPrimitives(),a=r.push.bind(r),o=0,s=n.PrimitiveSetList.length;for(o=0;o<s;o++){var u=e.setJSON(n.PrimitiveSetList[o]).readPrimitiveSet();i.push(u),u.then(a)}var l=function(e,t){this.getVertexAttributeList()[e]=t},c=n.VertexAttributeList,h=window.Object.keys(c);for(h.sort(Ae.functionSortAttributes),s=h.length,o=0;o<s;o++){var d=h[o],f=e.setJSON(c[d]).readBufferArray();i.push(f),f.then(l.bind(t,d))}return Te.a.all(i).then(function(){return t})},PagedLOD:function(e,t){var n,i=e.getJSON();Ae.Object(e,t),"USE_BOUNDING_SPHERE_CENTER"===i.CenterMode?t.setCenterMode(0):"UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED"===i.CenterMode&&t.setCenterMode(2),t.setCenter([i.UserCenter[0],i.UserCenter[1],i.UserCenter[2]]),t.setRadius(i.UserCenter[3]),"PIXEL_SIZE_ON_SCREEN"===i.RangeMode&&t.setRangeMode(1);for(var r=i.RangeList,a=0;a<window.Object.keys(r).length;a++){var o=r[n="Range "+a];t.setRange(a,o[0],o[1])}for(r=i.RangeDataList,a=0;a<window.Object.keys(r).length;a++)n="File "+a,t.setFileName(a,r[n]);t.setDatabasePath(e.getDatabasePath());var s=[];if(i.Children)for(var u=0,l=i.Children.length;u<l;u++)s.push(e.setJSON(i.Children[u]).readObject());return Te.a.all(s).then(function(e){var n=e.length;for(a=0;a<n;a++)t.addChildNode(e[a]);return t})}},Oe=Ae,Re=n("wwkN"),Pe=a.a.rejectObject,Ie={},Ne=function(){},Le=xe.default.registry();Le.registerObject("osgAnimation.Vec3LerpChannel",Ne),Le.registerObject("osgAnimation.FloatLerpChannel",Ne),Le.registerObject("osgAnimation.QuatSlerpChannel",Ne),Le.registerObject("osgAnimation.QuatLerpChannel",Ne),Le.registerObject("osgAnimation.FloatCubicBezierChannel",Ne),Le.registerObject("osgAnimation.Vec3CubicBezierChannel",Ne),Le.registerObject("osgAnimation.StackedMatrixElement",ue),Le.registerObject("osgAnimation.StackedScaleElement",ge),Ie.Animation=function(e){var t=e.getJSON();if(void 0===t.Name||!t.Channels||0===t.Channels.length)return Pe("Animation",t);for(var n=[],i=0,r=t.Channels.length;i<r;i++){var a=e.setJSON(t.Channels[i]).readObject();n.push(a)}return Te.a.all(n).then(function(e){return T.createAnimation(e,t.Name)})},Ie.StandardVec3Channel=function(e,t,n){var i=e.getJSON();if(!(void 0!==i.TargetName&&i.KeyFrames&&i.Name&&i.KeyFrames.Time&&i.KeyFrames.Key&&3===i.KeyFrames.Key.length))return Pe("StandardVec3Channel",i);var r=e.setJSON(i.KeyFrames.Time).readBufferArray(),a=e.setJSON(i.KeyFrames.Key[0]).readBufferArray(),o=e.setJSON(i.KeyFrames.Key[1]).readBufferArray(),s=e.setJSON(i.KeyFrames.Key[2]).readBufferArray();return Te.a.all([r,a,o,s]).then(function(e){for(var r=e[0].getElements(),a=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),u=r.length,l=new Float32Array(new ArrayBuffer(4*(u+1)*3),0,3*u),c=new Float32Array(new ArrayBuffer(4*(u+1)),0,u),h=0;h<u;h++){var d=3*h;c[h]=r[h],l[d++]=a[h],l[d++]=o[h],l[d]=s[h]}return n(l,c,i.TargetName,i.Name,t),t})},Ie.StandardQuatChannel=function(e,t,n){var i=e.getJSON();if(!(void 0!==i.TargetName&&i.KeyFrames&&i.Name&&i.KeyFrames.Time&&i.KeyFrames.Key&&4===i.KeyFrames.Key.length))return Pe("StandardQuatChannel",i);var r=e.setJSON(i.KeyFrames.Time).readBufferArray(),a=e.setJSON(i.KeyFrames.Key[0]).readBufferArray(),o=e.setJSON(i.KeyFrames.Key[1]).readBufferArray(),s=e.setJSON(i.KeyFrames.Key[2]).readBufferArray(),u=e.setJSON(i.KeyFrames.Key[3]).readBufferArray();return Te.a.all([r,a,o,s,u]).then(function(e){for(var r=e[0].getElements(),a=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),u=e[4].getElements(),l=r.length,c=new Float32Array(new ArrayBuffer(4*(l+1)*4),0,4*l),h=new Float32Array(new ArrayBuffer(4*(l+1)),0,l),d=0;d<l;d++){var f=4*d;h[d]=r[d],c[f++]=a[d],c[f++]=o[d],c[f++]=s[d],c[f]=u[d]}return n(c,h,i.TargetName,i.Name,t),t})},Ie.StandardFloatChannel=function(e,t,n){var i=e.getJSON();if(!(void 0!==i.TargetName&&i.KeyFrames&&i.Name&&i.KeyFrames.Time&&i.KeyFrames.Key))return Pe("StandardFloatChannel",i);var r=e.setJSON(i.KeyFrames.Time).readBufferArray(),a=e.setJSON(i.KeyFrames.Key).readBufferArray();return Te.a.all([r,a]).then(function(e){for(var r=e[0].getElements(),a=e[1].getElements(),o=r.length,s=new Float32Array(new ArrayBuffer(4*(o+1)),0,o),u=new Float32Array(new ArrayBuffer(4*(o+1)),0,o),l=0;l<o;l++)u[l]=r[l],s[l]=a[l];return n(s,u,i.TargetName,i.Name,t),t})},Ie.Vec3LerpChannel=function(e,t){return Ie.StandardVec3Channel(e,t,x.createVec3Channel)},Ie.QuatLerpChannel=function(e,t){return Ie.StandardQuatChannel(e,t,x.createQuatChannel)},Ie.QuatSlerpChannel=function(e,t){return Ie.StandardQuatChannel(e,t,x.createQuatChannel)},Ie.FloatLerpChannel=function(e,t){return Ie.StandardFloatChannel(e,t,x.createFloatChannel)},Ie.FloatCubicBezierChannel=function(e,t){var n=e.getJSON();if(!(void 0!==n.TargetName&&n.KeyFrames&&n.Name&&n.KeyFrames.Time&&n.KeyFrames.Position&&n.KeyFrames.ControlPointOut&&n.KeyFrames.ControlPointIn))return Pe("FloatCubicBezierChannel",n);var i,r=[],a=window.Object.keys(n.KeyFrames);for(i=0;i<a.length;i++)r.push(e.setJSON(n.KeyFrames[a[i]]).readBufferArray());return Te.a.all(r).then(function(e){var r=e[0].getElements(),a=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),u=s.length,l=new Float32Array(new ArrayBuffer(4*(u+1)*3),0,3*u),c=new Float32Array(new ArrayBuffer(4*(u+1)),0,u);for(i=0;i<u;i++){var h=3*i;c[i]=s[i],l[h++]=o[i],l[h++]=r[i],l[h]=a[i]}return x.createFloatCubicBezierChannel(l,c,n.TargetName,n.Name,t),t})},Ie.Vec3CubicBezierChannel=function(e,t){var n=e.getJSON();if(!(void 0!==n.TargetName&&n.KeyFrames&&n.Name&&n.KeyFrames.Time&&n.KeyFrames.Position&&n.KeyFrames.ControlPointOut&&n.KeyFrames.ControlPointIn&&3===n.KeyFrames.Position.length&&3===n.KeyFrames.ControlPointIn.length&&3===n.KeyFrames.ControlPointOut.length))return Pe("Vec3CubicBezierChannel",n);var i,r=[],a=window.Object.keys(n.KeyFrames);for(i=0;i<a.length;i++){var o=a[i],s=n.KeyFrames[o];"Time"!==o?(r.push(e.setJSON(s[0]).readBufferArray()),r.push(e.setJSON(s[1]).readBufferArray()),r.push(e.setJSON(s[2]).readBufferArray())):r.push(e.setJSON(s).readBufferArray())}return Te.a.all(r).then(function(e){var r=e[0].getElements(),a=e[1].getElements(),o=e[2].getElements(),s=e[3].getElements(),u=e[4].getElements(),l=e[5].getElements(),c=e[6].getElements(),h=e[7].getElements(),d=e[8].getElements(),f=e[9].getElements(),p=f.length,g=new Float32Array(new ArrayBuffer(4*(p+1)*9),0,9*p),m=new Float32Array(new ArrayBuffer(4*(p+1)),0,p);for(i=0;i<p;i++){var v=9*i;m[i]=f[i],g[v++]=c[i],g[v++]=h[i],g[v++]=d[i],g[v++]=r[i],g[v++]=a[i],g[v++]=o[i],g[v++]=s[i],g[v++]=u[i],g[v]=l[i]}return x.createVec3CubicBezierChannel(g,m,n.TargetName,n.Name,t),t})},Ie.BasicAnimationManager=function(e,t){var n=e.getJSON();if(!n.Animations)return Pe("BasicAnimationManager",n);Oe.Object(e,t);for(var i=[],r=0,a=n.Animations.length;r<a;r++){var o=e.setJSON(n.Animations[r]).readObject();o.isRejected()?A.a.warn("An Animation failed on the parsing!"):i.push(o)}return Te.a.all(i).then(function(e){return t.init(e),t})},Ie.UpdateMatrixTransform=function(e,t){var n=e.getJSON();if(/*!jsonObj.Name ||*/!n.StackedTransforms)return Pe("UpdateMatrixTransform",n);Oe.Object(e,t);var i,r,a=[];for(i=0,r=n.StackedTransforms.length;i<r;i++){var o=e.setJSON(n.StackedTransforms[i]).readObject();o.isRejected()?A.a.warn("A stacked transforms failed on the parsing!"):a.push(o)}return Te.a.all(a).then(function(e){var n=t.getStackedTransforms();for(i=0,r=e.length;i<r;i++)n.push(e[i]);return t.computeChannels(),t})},Ie.StackedTranslate=function(e,t){var n=e.getJSON();return n.Name&&n.Translate?(Oe.Object(e,t),t.init(n.Translate),Te.a.resolve(t)):Pe("StackedTranslate",n)},Ie.StackedQuaternion=function(e,t){var n=e.getJSON();return n.Name&&n.Quaternion?(Oe.Object(e,t),t.init(n.Quaternion),Te.a.resolve(t)):Pe("StackedQuaternion",n)},Ie.StackedRotateAxis=function(e,t){var n=e.getJSON();return n.Axis&&void 0!==n.Angle?(Oe.Object(e,t),t.init(n.Axis,n.Angle),Te.a.resolve(t)):Pe("StackedRotateAxis",n)},Ie.StackedMatrix=function(e,t){var n=e.getJSON();return n.Name&&n.Matrix?(Oe.Object(e,t),t.init(n.Matrix),Te.a.resolve(t)):Pe("StackedMatrix",n)},Ie.StackedScale=function(e,t){var n=e.getJSON();return n.Name&&n.Scale?(Oe.Object(e,t),t.init(n.Scale),Te.a.resolve(t)):Pe("StackedScale",n)},Ie.Bone=function(e,t){var n=e.getJSON();if(!n.InvBindMatrixInSkeletonSpace)return Pe("Bone",n);var i=Oe.MatrixTransform(e,t);if(t.setInvBindMatrixInSkeletonSpace(n.InvBindMatrixInSkeletonSpace),n.BoundingBox){var r=t.getBoneBoundingBox();r.setMax(n.BoundingBox.max),r.setMin(n.BoundingBox.min)}return i},Ie.UpdateBone=Ie.UpdateMatrixTransform,Ie.UpdateSkeleton=function(e,t){return Oe.Object(e,t),Te.a.resolve(t)},Ie.Skeleton=Oe.MatrixTransform,Ie.RigGeometry=function(e,t){var n=e.getJSON();if(!n.SourceGeometry)return Pe("RigGeometry",n);n.BoneMap||A.a.warn("No boneMap found in a RigGeometry !");var i=Oe.Geometry(e,t);t._boneNameID=n.BoneMap;var r,a=n.SourceGeometry["osg.Geometry"];return a?(e.setJSON(a),t.setSourceGeometry(new Re.a),r=Oe.Geometry(e,t.getSourceGeometry())):(a=n.SourceGeometry["osgAnimation.MorphGeometry"])?(e.setJSON(a),t.setSourceGeometry(new q.a),r=Ie.MorphGeometry(e,t.getSourceGeometry())):A.a.warn("SourceGeometry type no recognized"),void 0===t._uniqueID&&(t._uniqueID=a.UniqueID),Te.a.all([i,r]).then(function(){return t.mergeChildrenData(),t})},Ie.MorphGeometry=function(e,t){var n=e.getJSON();if(!n.MorphTargets)return Pe("MorphGeometry",n);var i=n.MorphTargets,r=[];r.push(Oe.Geometry(e,t));for(var a=0,o=i.length;a<o;a++)r.push(e.setJSON(i[a]).readObject());return Te.a.all(r).then(function(e){for(var t=e[0],n=t.getMorphTargets(),i=1,r=e.length;i<r;i++)n.push(e[i]);return t.mergeChildrenVertexAttributeList(),t})},Ie.UpdateMorph=function(e,t){var n=e.getJSON();if(!n.TargetMap)return Pe("UpdateMorph",n);Oe.Object(e,t);for(var i=window.Object.keys(n.TargetMap),r=0,a=i.length;r<a;r++){var o=i[r];t.addTarget(n.TargetMap[o],parseInt(o,10))}return Te.a.resolve(t)},Ie.StackedMatrixElement=Ie.StackedMatrix,Ie.StackedScaleElement=Ie.StackedScale;var ke=Ie,De=n("zB1R"),Fe=n("6ZYx"),Ve=n("GhR1"),Be=n("GfGl"),Ue=n("ULzY"),je=n("v+9t"),Ge=n("Vx0a"),He=function(e){Fe.a.call(this),this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d"),this._matrixTransform=new Ve.a,this.addChild(this._matrixTransform),this._text="",void 0!==e&&(this._text=e),this._font="monospace",this._color=o.g.fromValues(0,0,0,1),this._fillStyle="rgba( 0, 0, 0, 1 )",this._context.textAlign="center",this._textX=void 0,this._context.baseLine="middle",this._textY=void 0,this._characterSize=1,this._characterSizeMode=He.OBJECT_COORDS,this._fontSize=32,this._geometry=void 0,this._autoRotateToScreen=!1,this._position=o.f.create(),this._layout=He.LEFT_TO_RIGHT,this._alignment=He.CENTER_CENTER,this._forcePowerOfTwo=!1,this._texture=new Ue.default,this.drawText(),this._dirty=!1,this._previousModelView=o.c.create()};He.OBJECT_COORDS=0,He.SCREEN_COORDS=1,He.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT=2,He.LEFT_TO_RIGHT="ltr",He.RIGHT_TO_LEFT="rtl",He.LEFT_TOP=0,He.LEFT_CENTER=1,He.LEFT_BOTTOM=2,He.CENTER_TOP=3,He.CENTER_CENTER=4,He.CENTER_BOTTOM=5,He.RIGHT_TOP=6,He.RIGHT_CENTER=7,He.RIGHT_BOTTOM=8,a.a.createPrototypeNode(He,a.a.objectInherit(Fe.a.prototype,{drawText:function(){if(void 0!==this._geometry&&(this._matrixTransform.removeChild(this._geometry),this._geometry.releaseGLObjects()),this._text){this.setTextProperties(),this._canvas.width=this._context.measureText(this._text).width,this._canvas.height=2*this._fontSize,this._forcePowerOfTwo&&(this._canvas.width=this._nextPowerOfTwo(this._canvas.width),this._canvas.height=this._nextPowerOfTwo(this._canvas.height)),this.setTextProperties(),this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._context.fillText(this._text,this._textX,this._textY);var e=this._canvas.width/this._canvas.height,t=this._characterSize*e;this._geometry=Be.a.createTexturedQuadGeometry(-t/2,-this._characterSize/2,0,t,0,0,0,this._characterSize,0),this._texture.setTextureSize(this._canvas.width,this._canvas.height),this._texture.setMinFilter("LINEAR"),this._texture.setMagFilter("LINEAR"),this._texture.setImage(this._canvas);var n=this._geometry.getOrCreateStateSet();n.setTextureAttributeAndModes(0,this._texture),n.setRenderingHint("TRANSPARENT_BIN"),n.setAttributeAndModes(new je.a(je.a.ONE,je.a.ONE_MINUS_SRC_ALPHA)),this._matrixTransform.addChild(this._geometry),this.dirtyBound()}},setText:function(e){this._text=e,this._dirty=!0},getText:function(){return this._text},setFont:function(e){this._font=e,this._dirty=!0},setColor:function(e){this._color=e,this._fillStyle="rgba("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+","+e[3]+")",this._context.fillStyle=this._fillStyle,this._context.fillText(this._text,this._textX,this._textY)},getColor:function(){return this._color},setCharacterSize:function(e){this._characterSize=e,this._characterSizeMode!==He.OBJECT_COORDS&&(o.c.fromScaling(this._matrixTransform.getMatrix(),[this._characterSize,this._characterSize,this._characterSize]),this._characterSizeMode===He.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT&&this.setMaximumScale(this._characterSize)),this._dirty=!0},getCharacterSize:function(){return this._characterSize},setCharacterSizeMode:function(e){this._characterSizeMode=e,this._characterSizeMode!==He.OBJECT_COORDS?(o.c.fromScaling(this._matrixTransform.getMatrix(),[this._characterSize,this._characterSize,this._characterSize]),this.setAutoScaleToScreen(!0),this.setMaximumScale(Number.MAX_VALUE),this._characterSizeMode===He.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT&&this.setMaximumScale(this._characterSize)):(this._matrixTransform.setMatrix(o.c.create()),this.setAutoScaleToScreen(!1)),this._dirty=!0},getCharacterSizeMode:function(){return this._characterSizeMode},setFontResolution:function(e){this._fontSize=e,this._dirty=!0},getFontResolution:function(){return this._fontSize},setPosition:function(e){this._position=e,o.c.fromTranslation(this.getMatrix(),e)},getPosition:function(){return this._position},setTextProperties:function(){this._context.fillStyle=this._fillStyle,this._setAlignmentValues(this._alignment),this._context.font=this._fontSize+"px "+this._font,this._context.direction=this._layout},setAutoRotateToScreen:function(e){Fe.a.prototype.setAutoRotateToScreen.call(this,e),this._dirty=!0},getAutoRotateToScreen:function(){return this._autoRotateToScreen},setLayout:function(e){this._layout="string"==typeof e?He[e]:e,this._dirty=!0},getLayout:function(){return this._layout},setAlignment:function(e){this._alignment="string"==typeof e?He[e]:e,this._dirty=!0},getAlignment:function(){return this._alignment},accept:function(e){if(this._dirty&&(this.drawText(),this._dirty=!1),e.getVisitorType()===j.a.CULL_VISITOR){var t=e.getViewport().width(),n=e.getViewport().height(),i=e.getCurrentProjectionMatrix(),r=e.getCurrentModelViewMatrix(),a=this._position,s=this._firstTimeToInitEyePoint;if(this._firstTimeToInitEyePoint||(o.c.exactEquals(r,this._previousModelView)?t!==this._previousWidth||n!==this._previousHeight?s=!0:o.c.exactEquals(i,this._previousProjection)&&o.f.exactEquals(a,this._previousPosition)||(s=!0):s=!0),this._firstTimeToInitEyePoint=!1,s){if(this._autoScaleToScreen){var u=e.getViewport(),l=this.computePixelSizeVector(u,i,r),c=o.g.fromValues(this._position[0],this._position[1],this._position[2],1),h=o.g.dot(c,l),d=1/(h=.48/h);if(this._autoScaleTransitionWidthRatio>0){var f,p,g;if(this._minimumScale>0){var m=this._minimumScale,v=this._maximumScale<Number.MAX_VALUE?this._minimumScale+(this._maximumScale-this._minimumScale)*this._autoScaleTransitionWidthRatio:this._minimumScale*(1+this._autoScaleTransitionWidthRatio);g=m+(p=1-2*(f=1/(4*(v-m)))*v)*p/(4*f),d<-p/(2*f)?d=this._minimumScale:d<v&&(d=g+p*d+f*(d*d))}if(this._maximumScale<Number.MAX_VALUE){var _=this._maximumScale,b=this._minimumScale>0?this._maximumScale+(this._minimumScale-this._maximumScale)*this._autoScaleTransitionWidthRatio:this._maximumScale*(1-this._autoScaleTransitionWidthRatio);g=_+(p=1-2*(f=1/(4*(b-_)))*b)*p/(4*f),d>-p/(2*f)?d=this._maximumScale:d>b&&(d=g+p*d+f*(d*d))}}this.setScale(d)}if(this._autoRotateToScreen){var S=o.d.create(),y=e.getCurrentModelViewMatrix();o.c.getRotation(S,y),this.setRotation(o.d.invert(S,S))}this._previousWidth=t,this._previousHeight=n,o.f.copy(this._previousPosition,a),o.c.copy(this._previousProjection,i),o.c.copy(this._previousModelView,r)}}Ge.a.prototype.accept.call(this,e)},_setAlignmentValues:function(e){switch(e){case He.LEFT_TOP:this._context.textAlign="left",this._textX=0,this._context.textBaseline="top",this._textY=0;break;case He.LEFT_CENTER:this._context.textAlign="left",this._textX=0,this._context.textBaseline="middle",this._textY=this._canvas.height/2;break;case He.LEFT_BOTTOM:this._context.textAlign="left",this._textX=0,this._context.textBaseline="bottom",this._textY=this._canvas.height;break;case He.CENTER_TOP:this._context.textAlign="center",this._textX=this._canvas.width/2,this._context.textBaseline="top",this._textY=0;break;case He.CENTER_CENTER:this._context.textAlign="center",this._textX=this._canvas.width/2,this._context.textBaseline="middle",this._textY=this._canvas.height/2;break;case He.CENTER_BOTTOM:this._context.textAlign="center",this._textX=this._canvas.width/2,this._context.textBaseline="bottom",this._textY=this._canvas.height;break;case He.RIGHT_TOP:this._context.textAlign="right",this._textX=this._canvas.width,this._context.textBaseline="top",this._textY=0;break;case He.RIGHT_CENTER:this._context.textAlign="right",this._textX=this._canvas.width,this._context.textBaseline="middle",this._textY=this._canvas.height/2;break;case He.RIGHT_BOTTOM:this._context.textAlign="right",this._textX=this._canvas.width,this._context.textBaseline="bottom",this._textY=this._canvas.height}},setForcePowerOfTwo:function(e){this._forcePowerOfTwo=e},getForcePowerOfTwo:function(){return this._forcePowerOfTwo},_nextPowerOfTwo:function(e){var t=e;return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}}),"osgText","Text"),De.a.registerApplyFunction(He.nodeTypeID,De.a.getApplyFunction(Fe.a.nodeTypeID));var ze=He,We={Text:function(e,t){var n=e.getJSON();if(!n.Text)return Te.a.reject();var i=Oe.Node(e,t);if(t.setColor(n.Color),t.setText(n.Text),t.setAutoRotateToScreen(n.AutoRotateToScreen),t.setPosition(n.Position),t.setCharacterSize(n.CharacterSize),"VERTICAL"===n.Layout)return A.a.error("Vertical Alignment not supported"),Te.a.reject();var r=n.Alignment;return n.Alignment.indexOf("BASE_LINE")>-1&&("LEFT_BASE_LINE"===n.Alignment?r=ze.LEFT_CENTER:"CENTER_BASE_LINE"===n.Alignment?r=ze.CENTER_CENTER:"RIGHT_BASE_LINE"===n.Alignment?r=ze.RIGHT_CENTER:"LEFT_BOTTOM_BASE_LINE"===n.Alignment?r=ze.LEFT_BOTTOM:"CENTER_BOTTOM_BASE_LINE"===n.Alignment?r=ze.CENTER_BOTTOM:"RIGHT_BOTTOM_BASE_LINE"===n.Alignment&&(r=ze.RIGHT_BOTTOM)),t.setAlignment(r),t.setLayout(n.Layout),i}},qe=We,Xe=n("+vQk"),Ye=n("hIgY"),Ke=n("1nG6"),Qe=n("ljaD"),Je=n.n(Qe),Ze={};Ze.Input=ye.default,a.a.objectMix(Ze,xe.default),Ze.DatabasePager=Ce.a,Ze.ObjectWrapper.serializers.osg=Oe,Ze.ObjectWrapper.serializers.osgAnimation=ke,Ze.ObjectWrapper.serializers.osgText=qe,Ze.Registry=Xe.a,Ze.fileHelper=Ye.a,Ze.requestFile=Ke.a,a.a.objectMix(Ze,Je.a);var $e=Ze,et=n("yLV6"),tt=n.n(et),nt=n("6JLc"),it=function(e){e&&(this._boundStrategy=e.boundStrategy,this.setInputManager(e.inputManager)),void 0===this._boundStrategy&&(this._boundStrategy=it.COMPUTE_HOME_USING_SPHERE),this._controllerList={},this._inverseMatrix=o.c.create(),this._camera=void 0,this._node=void 0,this._frustum={},this._computeBoundNodeMaskOverride=-1,this._tmpSphere=new nt.a};it.prototype={setCamera:function(e){this._camera=e},getCamera:function(){return this._camera},setNode:function(e){this._node=e},setComputeBoundNodeMaskOverride:function(e){this._computeBoundNodeMaskOverride=e},getComputeBoundNodeMaskOverride:function(){return this._computeBoundNodeMaskOverride},setInputManager:function(e){this._inputManager=e},getInputManager:function(){return this._inputManager},getHomeBoundingSphere:function(e){var t=this._node;if(t){var i=void 0!==e?e:this._boundStrategy;if(i&it.COMPUTE_HOME_USING_BBOX){var r;if(-1===this._computeBoundNodeMaskOverride)r=t.getBoundingBox();else{var a=new(0,n("oDhZ").default);a.setNodeMaskOverride(this._computeBoundNodeMaskOverride),a.reset(),a.apply(t),r=a.getBoundingBox()}if(!r.valid())return t.getBoundingSphere();if(i&it.COMPUTE_HOME_USING_SPHERE){var o=t.getBoundingSphere();if(o.valid()&&o.volume()<r.volume())return o}return this._tmpSphere.copyBoundingBox(r),this._tmpSphere}return t.getBoundingSphere()}},getHomeBound:function(e){return A.a.warn("Please use getHomeBoundingSphere instead"),this.getHomeBoundingSphere(e)},getHomeDistance:function(e){var t=this._frustum,n=e.radius();if(this._camera&&o.c.getFrustum(t,this._camera.getProjectionMatrix())){var i=Math.abs(t.right-t.left)/t.zNear/2,r=Math.abs(t.top-t.bottom)/t.zNear/2;n/=Math.sin(Math.atan2(r<i?r:i,1))}else n*=1.5;return n},update:function(){},getInverseMatrix:function(){return this._inverseMatrix},getControllerList:function(){return this._controllerList}},it.COMPUTE_HOME_USING_SPHERE=1,it.COMPUTE_HOME_USING_BBOX=2;var rt=it,at=n("TMnl"),ot=n("EhLm"),st=n("ZLu7"),ut=n("jq0H"),lt=n("3Pif"),ct=n("oDvv"),ht=function(){ct.a.call(this),this._src=[],this._dest=[],this._maxNumIntersectionsPoints=6};a.a.createPrototypeObject(ht,a.a.objectInherit(ct.a.prototype,{reset:function(){ct.a.prototype.reset.call(this),this._src=[],this._dest=[]},enter:function(e){return!!this._intersector.getPolytope().containsBoundingBox(e)&&(this._intersector.getPolytope().pushCurrentMask(),!0)},leave:function(){this._intersector.getPolytope().popCurrentMask()},addIntersection:function(){this._src=a.a.arrayUniq(this._src);for(var e=this._src,t=o.f.create(),n=-Number.MAX_VALUE,i=this._intersector._iReferencePlane,r=0;r<e.length;++r){o.f.add(t,t,e[r]);var s=ut.a.distanceToPlane(i,e[r]);s>n&&(n=s)}o.f.scale(t,t,1/e.length);var u=this.initIntersection(new function(){ct.a.Intersection.call(this),this._intersectionPoints=[],this._distance=0,this._maxDistance=0,this._numIntersectionPoints=0});u._distance=ut.a.distanceToPlane(i,t),u._maxDistance=n,o.f.copy(u._localIntersectionPoint,t);var l=this._maxNumIntersectionsPoints;for(u._numIntersectionPoints=e.length<l?e.length:l,r=0;r<u._numIntersectionPoints;++r)u._intersectionPoints.push(o.f.clone(this._src[r]))},contains:function(){var e=this._intersector.getPolytope(),t=e.getPlanes(),n=e.getCurrentMask();if(!n)return!0;for(var i=1,r=0;r<t.length;++r)if(n&0===i)i<<=1;else{this._dest=[];for(var a=t[r],s=this._src[0],u=ut.a.distanceToPlane(a,s),l=1;l<this._src.length;++l){var c=this._src[l],h=ut.a.distanceToPlane(a,c);if(u>=0&&this._dest.push(o.f.clone(s)),u*h<0){var d=u/(u-h),f=o.f.add(o.f.create(),o.f.scale(o.f.create(),s,1-d),o.f.scale(o.f.create(),c,d));this._dest.push(f)}u=h,s=c}if(u>=0&&this._dest.push(o.f.clone(s)),this._dest.length<=1)return!1;var p=this._src.slice();this._src=this._dest.slice(),this._dest=p}return!0},containsPoint:function(e){return!!this._intersector.getPolytope().containsVertex(e)&&(this._src=[],this._src[0]=e,!0)},containsLine:function(e,t){return this._src=[],this._src[0]=e,this._src[1]=t,this._src[2]=e,this.contains()},containsTriangle:function(e,t,n){return this._src=[],this._src[0]=e,this._src[1]=t,this._src[2]=n,this._src[3]=e,this.contains()},intersectPoint:function(e){this.containsPoint(e)&&this.addIntersection()},intersectLine:function(e,t){this.containsLine(e,t)&&this.addIntersection()},intersectTriangle:function(e,t,n){this.containsTriangle(e,t,n)&&this.addIntersection()}}),"osgUtil","PolytopeIntersectFunctor");var dt=ht,ft=function(){lt.a.call(this),this._index=0,this._polytope=new st.a,this._iPolytope=new st.a,this._referencePlane=o.g.create(),this._iReferencePlane=o.g.create()},pt=function(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3];e[0]=n[0]*i+n[1]*r+n[2]*a+n[3]*o,e[1]=n[4]*i+n[5]*r+n[6]*a+n[7]*o,e[2]=n[8]*i+n[9]*r+n[10]*a+n[11]*o,e[3]=n[12]*i+n[13]*r+n[14]*a+n[15]*o};a.a.createPrototypeObject(ft,a.a.objectInherit(lt.a.prototype,{setPolytope:function(e){this._polytope.setPlanes(e);for(var t=[],n=0;n<e.length;++n){var i=e[n];t[n]=o.g.copy(this._iPolytope.getPlanes()[n]||ut.a.create(),i)}this._iPolytope.setPlanes(t),o.g.copy(this._referencePlane,e[e.length-1]),o.g.copy(this._iReferencePlane,this._referencePlane)},getPolytope:function(){return this._iPolytope},setPolytopeFromWindowCoordinates:function(e,t,n,i){this.setPolytope([o.g.fromValues(1,0,0,-e),o.g.fromValues(-1,0,0,n),o.g.fromValues(0,1,0,-t),o.g.fromValues(0,-1,0,i),o.g.fromValues(0,0,1,0)])},intersectBoundingBox:function(e){return this._iPolytope.containsBoundingBox(e)},intersectBoundingSphere:function(e){return this._iPolytope.containsBoundingSphere(e)},intersect:function(){var e=new dt;return function(t,n){e.setGeometry(n),e.setIntersectionVisitor(t),e.setIntersector(this);var i=n.getShape();i?i.intersect(e,i.getNodes()[0]):(n.computeTransformedVertices&&e.setVertices(n.computeTransformedVertices()),e.apply(n)),e.reset()}}(),setCurrentTransformation:function(e){for(var t=this._polytope.getPlanes(),n=this._iPolytope.getPlanes(),i=0,r=t.length;i<r;i++){var a=n[i]=n[i]||o.g.create();pt(a,t[i],e),o.g.scale(a,a,1/o.f.len(a))}pt(this._iReferencePlane,this._referencePlane,e),o.g.scale(this._iReferencePlane,this._iReferencePlane,1/o.f.len(this._iReferencePlane))}}),"osgUtil","PolytopeIntersector");var gt=ft,mt=n("zWCM"),vt=function(e){this._manipulator=e,this._enable=!0};vt.prototype={isEnabled:function(){return this._enable},setEnable:function(e){this._enable=e}};var _t=vt,bt=n("KL/6"),St=0,yt=1,xt=2,Ct=n("4ANv"),wt=function(e){_t.call(this,e),this._zoomFactor=1,this.init()};a.a.createPrototypeObject(wt,a.a.objectInherit(_t.prototype,{init:function(){this._mode=void 0,this._inMotion=!1,this._initInputs(Ct.a.ORBIT_MANIPULATOR_MOUSEKEYBOARD,Ct.a.ORBIT_MANIPULATOR_RESETTOHOME)},_initInputs:function(e,t){var n=this._manipulator.getInputManager(),i=this.setMode.bind(this,St,this._manipulator.getRotateInterpolator()),r=this.setMode.bind(this,yt,this._manipulator.getPanInterpolator()),a=this.setMode.bind(this,xt,this._manipulator.getZoomInterpolator());n.group(e).addMappings({move:"mousemove",startPan:["mousedown shift 0","mousedown 1","mousedown 2"],startZoom:["mousedown ctrl 0","mousedown ctrl 2"],startRotate:"mousedown 0 !shift !ctrl",stopMotion:["mouseup","mouseout","keyup a","keyup s","keyup d"],zoom:"wheel"},this),n.group(t).addMappings({reset:"keydown space"},this),n.group(e).addMappings({setRotationMode:"keydown a"},i),n.group(e).addMappings({setPanMode:"keydown d"},r),n.group(e).addMappings({setZoomMode:"keydown s"},a)},getMode:function(){return this._mode},setMode:function(e,t){this.getMode()!==e&&(this._mode=e,t.reset(),this._inMotion=!0)},setManipulator:function(e){this._manipulator=e},getZoomFactor:function(){return this._zoomFactor},setZoomFactor:function(e){this._zoomFactor=e},move:function(e){if(!1!==this._inMotion){var t=e.canvasX,n=-e.canvasY,i=this._manipulator;if(!1===bt.a.isNaN(t)&&!1===bt.a.isNaN(n)){var r=this.getMode();if(r===St)i.getRotateInterpolator().setTarget(t,n);else if(r===yt)i.getPanInterpolator().setTarget(t,n);else if(r===xt){var a=i.getZoomInterpolator();a.isReset()&&(a.setStart(n),a.set(0));var o=n-a.getStart();a.setStart(n);var s=a.getTarget()[0];a.setTarget(s-o/20)}}}},startPan:function(e){var t=this._manipulator.getPanInterpolator();this.setMode(yt,t),t.reset(),t.set(e.canvasX,-e.canvasY)},startRotate:function(e){var t=this._manipulator.getRotateInterpolator();this.setMode(St,t),t.reset(),t.set(e.canvasX,-e.canvasY)},startZoom:function(e){var t=this._manipulator.getZoomInterpolator();this.setMode(xt,t),t.setStart(-e.canvasY),t.set(0)},stopMotion:function(){this._inMotion=!1,this._mode=void 0},zoom:function(e){var t=e.deltaY/this._zoomFactor,n=this._manipulator,i=n.getZoomInterpolator().getTarget()[0]-t;n.getZoomInterpolator().setTarget(i)},reset:function(){this._manipulator.computeHomePosition()}}));var Tt=wt,Mt=function(e){Tt.call(this,e),this._timer=!1};a.a.createPrototypeObject(Mt,a.a.objectInherit(Tt.prototype,{_initInputs:function(){Tt.prototype._initInputs.call(this,Ct.a.CAD_MANIPULATOR_MOUSEKEYBOARD,Ct.a.CAD_MANIPULATOR_RESETTOHOME),this._manipulator.getInputManager().group(Ct.a.CAD_MANIPULATOR_MOUSEKEYBOARD).addMappings({savePosition:"mousemove"},this)},zoom:function(e){var t=-e.deltaY/this._zoomFactor,n=this._manipulator,i=n.getZoomInterpolator().getTarget()[0]-t;if(n.getZoomInterpolator().setTarget(i),!1===this._timer){this._timer=!0;var r=this;this._timerRef&&clearTimeout(this._timerRef),this._timerRef=setTimeout(function(){r._timer=!1},200),n.computeIntersections(e.glX,e.glY)}},savePosition:function(e){this._lastX=e.glX,this._lastY=e.glY},setMode:function(e,t,n){this._inMotion||this._manipulator.computeIntersections(this._lastX,this._lastY),Tt.prototype.setMode.call(this,e,t,n)},center:function(e){var t=this._manipulator;t.getZoomInterpolator().set(0);var n=t.getZoomInterpolator().getTarget()[0]-10;t.getZoomInterpolator().setTarget(n),t.computeIntersections(e.glX,e.glY)}}));var Et=Mt,At=function(e){_t.call(this,e),this.init()};a.a.createPrototypeObject(At,a.a.objectInherit(_t.prototype,{init:function(){this._panFactor=[],this._panFactor[0]=1,this._panFactor[1]=-this._panFactor[0],this._rotateFactor=[],this._rotateFactor[0]=.6,this._rotateFactor[1]=-this._rotateFactor[0],this._zoomFactor=5,this._lastScale=0,this._zooming=!1,this._dragStarted=!1,this._initInputs(Ct.a.ORBIT_MANIPULATOR_TOUCH)},_initInputs:function(e){this._manipulator.getInputManager().group(e).addMappings({pinchEnd:"pinchend",pinchStart:"pinchstart",pinchInOut:["pinchin","pinchout"],startPan:["panstart 2"],startRotate:["panstart 1"],pan:["panmove 2"],rotate:["panmove 1"],endMotion:["touchend 2","touchcancel 2","touchend 1","touchcancel 1"]},this)},startPan:function(e){this._panning=!0,this.startMotion(this._manipulator.getPanInterpolator(),this._panFactor,e)},startRotate:function(e){this._rotating=!0,this.startMotion(this._manipulator.getRotateInterpolator(),this._rotateFactor,e)},pan:function(e){this._panning||(this.endMotion(),this.startPan(e)),this.move(this._manipulator.getPanInterpolator(),this._panFactor,e)},rotate:function(e){this._rotating||(this.endMotion(),this.startPan(e)),this.move(this._manipulator.getRotateInterpolator(),this._rotateFactor,e)},startMotion:function(e,t,n){if(!this._zooming){e.reset();var i=n.canvasX*t[0],r=n.canvasY*t[1];e.set(i,r)}},move:function(e,t,n){var i=n.canvasX*t[0],r=n.canvasY*t[1];e.setTarget(i,r)},endMotion:function(){(this._panning||this._rotating)&&(this._panning=!1,this._rotating=!1)},pinchStart:function(e){this._zooming=!0,this._lastScale=e.scale;var t=this._manipulator.getZoomInterpolator();t.reset(),t.set(this._lastScale)},pinchEnd:function(){this._zooming=!1},pinchInOut:function(e){if(this._zooming){var t=e.scale>this._lastScale?this._zoomFactor:3*this._zoomFactor,n=.5-Math.abs(e.velocity);t*=bt.a.smoothStep(0,.5,n);var i=(e.scale-this._lastScale)*t;this._lastScale=e.scale;var r=this._manipulator.getZoomInterpolator();r.setTarget(r.getTarget()[0]-i)}},setManipulator:function(e){this._manipulator=e}}));var Ot=At,Rt=function(e){Ot.call(this,e),this._timer=!1};a.a.createPrototypeObject(Rt,a.a.objectInherit(Ot.prototype,{_initInputs:function(){Ot.prototype._initInputs.call(this,Ct.a.CAD_MANIPULATOR_TOUCH)},startMotion:function(e,t,n){Ot.prototype.startMotion.call(this,e,t,n),this._manipulator.computeIntersections(n.glX,n.glY)}}));var Pt=Rt,It=function(e,t){this._current=new Float32Array(e),this._target=new Float32Array(e),this._delta=new Float32Array(e),this._delay=void 0!==t?t:.15,this._reset=!1,this._start=0,this.reset()};It.prototype={setDelay:function(e){this._delay=e},reset:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=0;this._reset=!0},update:function(e){for(var t=Math.min(1,this._delay*e*60),n=0,i=this._current.length;n<i;n++){var r=(this._target[n]-this._current[n])*t;this._delta[n]=r,this._current[n]+=r}return this._delta},set:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=arguments[e];this._reset=!1},isReset:function(){return this._reset},getCurrent:function(){return this._current},setTarget:function(){for(var e=0,t=this._target.length;e<t;e++)this._reset?this._target[e]=this._current[e]=arguments[e]:this._target[e]=arguments[e];this._reset=!1},addTarget:function(){for(var e=0;e<arguments.length;e++)this._target[e]+=arguments[e]},getTarget:function(){return this._target},getDelta:function(){return this._delta},getStart:function(){return this._start},setStart:function(e){this._start=e}};var Nt=It,Lt=n("QtKT"),kt=function(e){rt.call(this,e),this._tmpHomePosition=o.f.create(),this._intersectionVisitor=new at.a,this._lineSegmentIntersector=new ot.a,this._polytopeIntersector=void 0,this._usePolytopeIntersector=!1,this._primitiveMask=Lt.a.ALL_PRIMITIVES,this.init()};(kt.Interpolator=function(){this._current=o.e.create(),this._target=o.e.create(),this._delta=o.e.create(),this._reset=!1,this.reset(),this._width=void 0,this._height=void 0}).prototype={setWidth:function(e){this._width=e},setHeight:function(e){this._height=e},reset:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=0;this._reset=!0},update:function(){var e,t;return e=void 0===this._width?0:(this._target[0]-this._current[0])/this._width,this._delta[0]=e,this._current[0]=this._target[0],t=void 0===this._height?0:(this._target[1]-this._current[1])/this._height,this._delta[1]=t,this._current[1]=this._target[1],this._delta},set:function(){for(var e=0,t=this._current.length;e<t;e++)this._current[e]=this._target[e]=arguments[e];this._reset=!1},isReset:function(){return this._reset},getCurrent:function(){return this._current},setTarget:function(){for(var e=0,t=this._target.length;e<t;e++)this._reset?this._target[e]=this._current[e]=arguments[e]:this._target[e]=arguments[e];this._reset=!1},addTarget:function(){for(var e=0;e<arguments.length;e++)this._target[e]+=arguments[e]},getTarget:function(){return this._target},getDelta:function(){return this._delta}},kt.AvailableControllerList=["StandardMouseKeyboard","Hammer"],kt.ControllerList=["StandardMouseKeyboard","Hammer"],a.a.createPrototypeObject(kt,a.a.objectInherit(rt.prototype,{init:function(){this._distance=25,this._target=o.f.create(),this._upz=o.f.fromValues(0,0,1),this._right=o.f.fromValues(1,0,0),o.f.init(this._target);var e=o.c.fromRotation(o.c.create(),-Math.PI,this._upz),t=o.c.fromRotation(o.c.create(),Math.PI/10,this._right);this._rotation=o.c.create(),o.c.mul(this._rotation,e,t),this._time=0,this._rotate=new kt.Interpolator,this._pan=new kt.Interpolator,this._zoom=new Nt(1),this._panFactor=1.5,this._rotateFactor=1,this._zoomFactor=1,this._inverseMatrix=o.c.create(),this._homeEye=void 0,this._homeCenter=void 0,this._homeUp=o.f.fromValues(0,0,1),this._orientation=o.d.create(),this._pivotPoint=o.f.create(),this._eye=void 0,this._zoomDir=o.f.create();var n=this;kt.ControllerList.forEach(function(e){void 0!==kt[e]&&(n._controllerList[e]?n._controllerList[e].init():n._controllerList[e]=new kt[e](n))})},setViewer:function(e){this._viewer=e},reset:function(){this.init()},setEnable:function(e){this.getInputManager().setEnable(Ct.a.CAD_MANIPULATOR,e)},setNode:function(e){this._node=e},setPivotPoint:function(e){o.f.copy(this._pivotPoint,e)},setTarget:function(){var e=o.f.create();return function(t){o.f.copy(this._target,t),this.getEyePosition(e),this._distance=o.f.distance(t,e)}}(),setEyePosition:function(e){o.f.copy(this._eye,e),this._distance=o.f.distance(this._target,e)},setHomePosition:function(e,t,n){this._homeEye=e,this._homeCenter=t,this._homeUp=n},computeHomePosition:function(){var e=o.f.create(),t=o.f.create(),n=o.f.create(),i=o.c.create();return function(r){var a=this.getHomeBoundingSphere(r);if(a){this.setDistance(this.getHomeDistance(a)),this.setTarget(a.center()),this.setPivotPoint(a.center()),void 0===this._homeEye&&(this._homeEye=o.f.create(),this.getEyePosition(this._homeEye)),void 0===this._homeCenter&&(this._homeCenter=o.f.create(),o.f.copy(this._homeCenter,a.center())),void 0===this._eye&&(this._eye=o.f.create()),o.f.copy(this._eye,this._homeEye),o.f.copy(this._target,this._homeCenter),o.f.copy(this._upz,this._homeUp),o.c.copy(i,this._rotation);var s=this._target,u=this._eye;o.f.sub(e,s,u),o.f.normalize(e,e),o.f.cross(t,e,this._upz),o.f.normalize(t,t),o.f.cross(n,t,e),o.f.normalize(n,n),i[0]=t[0],i[1]=n[0],i[2]=-e[0],i[3]=0,i[4]=t[1],i[5]=n[1],i[6]=-e[1],i[7]=0,i[8]=t[2],i[9]=n[2],i[10]=-e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,o.c.getRotation(this._orientation,i),o.d.invert(this._orientation,this._orientation)}}}(),setZoomFactor:function(e){this._zoomFactor=e},setRotateFactor:function(e){this._rotateFactor=e},setPanFactor:function(e){this._panFactor=e},setDistance:function(e){this._distance=e},setUsePolytopeIntersector:function(e){this._usePolytopeIntersector=e},getUsePolytopeIntersector:function(){return this._usePolytopeIntersector},getDistance:function(){return this._distance},zoom:function(e){this._distance=e},getRotateInterpolator:function(){return this._rotate},getPanInterpolator:function(){return this._pan},getZoomInterpolator:function(){return this._zoom},getIntersectionVisitor:function(){return this._intersectionVisitor},getLineSegmentIntersector:function(){return this._lineSegmentIntersector},getOrCreatePolytopeIntersector:function(){return void 0===this._polytopeIntersector&&(this._polytopeIntersector=new gt,this._polytopeIntersector.setIntersectionLimit(Lt.a.LIMIT_ONE_PER_DRAWABLE),this._polytopeIntersector.setPrimitiveMask(Lt.a.POINT_PRIMITIVES|Lt.a.LINE_PRIMITIVES)),this._polytopeIntersector},getTarget:function(e){return o.f.copy(e,this._target),e},getEyePosition:function(e){void 0===this._eye?this.computeEyePosition(this._target,this._distance,e):o.f.copy(e,this._eye)},computeEyePosition:function(){var e=o.f.create(),t=o.c.create();return function(n,i,r){o.c.invert(t,this._rotation),e[1]=i,o.f.transformMat4(r,e,t),o.f.add(r,n,r)}}(),computePan:function(){var e=o.f.create(),t=o.f.create(),n=o.f.create();return function(i,r,a){var s=o.f.length(o.f.sub(n,this._eye,this._pivotPoint))/this._panFactor;s<10&&(s=10),e[0]=i*s/2,e[1]=r*s/2,e[2]=0,o.f.transformMat4(t,e,a),o.f.add(this._eye,this._eye,t)}}(),computeZoom:function(){var e=o.f.create(),t=o.f.create();return function(n){var i=n*this._zoomFactor;o.f.sub(e,this._pivotPoint,this._eye),o.f.add(this._eye,this._eye,o.f.scale(t,e,i))}}(),computeRotation:function(){var e=o.f.create(),t=o.f.create(),n=o.f.create(),i=o.f.create(),r=o.d.create(),a=o.d.create(),s=o.d.create(),u=o.f.create(),l=o.f.create();return function(c,h){o.f.transformQuat(t,this._right,this._orientation),o.f.normalize(e,t),o.f.sub(n,this._eye,this._pivotPoint);var d=o.f.dot(e,n);o.f.sub(i,n,o.f.scale(l,e,d));var f=o.f.fromValues(-i[0],-i[1],0),p=Math.atan2(-i[2],o.f.length(f));h=Math.max(-Math.PI/2+.01,Math.min(Math.PI/2-.01,p+h))-p,o.d.setAxisAngle(r,t,h*this._rotateFactor),o.d.setAxisAngle(a,this._upz,c*this._rotateFactor),o.d.mul(s,a,r),o.f.transformQuat(u,n,s),o.f.add(this._eye,u,this._pivotPoint),o.d.mul(this._orientation,a,this._orientation),o.f.transformQuat(t,this._right,this._orientation),o.d.setAxisAngle(r,t,h*this._rotateFactor),o.d.mul(this._orientation,r,this._orientation)}}(),update:function(){var e=o.c.create(),t=o.c.create();return function(n){var i=n.getFrameStamp().getDeltaTime(),r=this._rotate.update();this.computeRotation(10*-r[0],10*r[1]),o.c.fromQuat(e,this._orientation);var a=this._pan.update();this.computePan(10*-a[0],10*-a[1],e),r=this._zoom.update(i),this.computeZoom(-r[0]/10),o.c.fromTranslation(t,this._eye),o.c.mul(this._inverseMatrix,t,e),o.c.invert(this._inverseMatrix,this._inverseMatrix)}}(),getInverseMatrix:function(){return this._inverseMatrix},computeIntersections:function(){var e=[],t=o.f.create();return function(n,i){var r,a,s=this._camera.getView(),u=this._camera,l=u.getViewport().width(),c=u.getViewport().height();if(this._rotate.setWidth(l),this._rotate.setHeight(c),this._pan.setWidth(l),this._pan.setHeight(c),0!=(this._primitiveMask&Lt.a.TRIANGLE_PRIMITIVES)&&(e=s.computeIntersections(n,i)).length>0&&(r=e[0]._localIntersectionPoint,e[0]._nodePath.shift(),a=mt.a.computeLocalToWorld(e[0]._nodePath),o.f.transformMat4(t,r,a),this.setPivotPoint(t)),0===e.length&&this._usePolytopeIntersector){var h=this.getOrCreatePolytopeIntersector();h.reset(),h.setPolytopeFromWindowCoordinates(n-5,i-5,n+5,i+5);var d=this._intersectionVisitor;d.setIntersector(h),s.getCamera().accept(d),(e=h.getIntersections()).sort(function(e,t){return e._distance-t._distance}),e.length>0&&(r=e[0]._localIntersectionPoint,e[0]._nodePath.shift(),a=mt.a.computeLocalToWorld(e[0]._nodePath),o.f.transformMat4(t,r,a),this.setPivotPoint(t))}}}(),getPositionRelativeToCanvas:function(){var e=o.e.create(),t=o.e.create();return function(n,i){var r=this._camera._graphicContext.canvas;this.getOffsetRect(r,e);var a=r.width/r.clientWidth,o=r.height/r.clientHeight;return t[0]=(n-e[1])*a,t[1]=(r.clientHeight-(i-e[0]))*o,t}}(),getCanvasCenter:function(){var e=o.e.create(),t=o.e.create();return function(){var n=this._camera.getGraphicContext().canvas;this.getOffsetRect(n,e);var i=n.width/n.clientWidth,r=n.height/n.clientHeight;return t[0]=n.clientWidth/2*i,t[1]=n.clientHeight/2*r,t}}(),getOffsetRect:function(e,t){var n=e.getBoundingClientRect(),i=document.body,r=document.documentElement,a=window.pageYOffset||r.scrollTop||i.scrollTop,o=window.pageXOffset||r.scrollLeft||i.scrollLeft,s=r.clientTop||i.clientTop||0,u=r.clientLeft||i.clientLeft||0,l=n.top+a-s,c=n.left+o-u;return t[0]=Math.round(l),t[1]=Math.round(c),t}}),"osgGA","CADManipulator"),kt.StandardMouseKeyboard=Et,kt.Hammer=Pt;var Dt=kt,Ft=Math.PI/180,Vt=function(e){_t.call(this,e),this.init()};Vt.computeQuaternion=function(){var e=o.d.create(),t=o.d.fromValues(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(n,i,r){var a=i.alpha*Ft,s=i.beta*Ft,u=i.gamma*Ft,l=r*Ft;!function(e,t,n,i,r){var a=Math.cos(t/2),o=Math.cos(n/2),s=Math.cos(i/2),u=Math.sin(t/2),l=Math.sin(n/2),c=Math.sin(i/2);"XYZ"===r?(e[0]=u*o*s+a*l*c,e[1]=a*l*s-u*o*c,e[2]=a*o*c+u*l*s,e[3]=a*o*s-u*l*c):"YXZ"===r?(e[0]=u*o*s+a*l*c,e[1]=a*l*s-u*o*c,e[2]=a*o*c-u*l*s,e[3]=a*o*s+u*l*c):"ZXY"===r?(e[0]=u*o*s-a*l*c,e[1]=a*l*s+u*o*c,e[2]=a*o*c+u*l*s,e[3]=a*o*s-u*l*c):"ZYX"===r?(e[0]=u*o*s-a*l*c,e[1]=a*l*s+u*o*c,e[2]=a*o*c-u*l*s,e[3]=a*o*s+u*l*c):"YZX"===r?(e[0]=u*o*s+a*l*c,e[1]=a*l*s+u*o*c,e[2]=a*o*c-u*l*s,e[3]=a*o*s-u*l*c):"XZY"===r&&(e[0]=u*o*s-a*l*c,e[1]=a*l*s-u*o*c,e[2]=a*o*c+u*l*s,e[3]=a*o*s+u*l*c)}(n,s,a,-u,"YXZ");var c=-l/2;e[1]=Math.sin(c),e[3]=Math.cos(c),o.d.mul(n,n,e),o.d.mul(n,n,t);var h=n[1];return n[1]=-n[2],n[2]=h,n}}(),a.a.createPrototypeObject(Vt,a.a.objectInherit(_t.prototype,{init:function(){this._quat=o.d.create(),this._pos=o.f.create(),this._deviceOrientation=void 0,this._screenOrientation=void 0;var e=this._manipulator.getInputManager();e.group(Ct.a.FPS_MANIPULATOR_DEVICEORIENTATION).addMappings({setDeviceOrientation:"deviceorientation",setScreenOrientation:"orientationchange"},this),e.setEnable(Ct.a.FPS_MANIPULATOR_DEVICEORIENTATION,!1)},setDeviceOrientation:function(e){this._deviceOrientation||(this._deviceOrientation={}),this._deviceOrientation.alpha=e.alpha,this._deviceOrientation.beta=e.beta,this._deviceOrientation.gamma=e.gamma,e.screenOrientation?this.setScreenOrientation(e):this._update()},setScreenOrientation:function(e){this._screenOrientation=e.screenOrientation,this._update()},_update:function(){this._deviceOrientation&&this._screenOrientation&&(Vt.computeQuaternion(this._quat,this._deviceOrientation,this._screenOrientation),this._manipulator.setPoseVR(this._quat,this._pos))}}));var Bt=Vt,Ut=function(e){Ot.call(this,e),this._timer=!1};a.a.createPrototypeObject(Ut,a.a.objectInherit(Ot.prototype,{_initInputs:function(){Ot.prototype._initInputs.call(this,Ct.a.FPS_MANIPULATOR_TOUCH)}}));var jt=Ut,Gt=(o.d.create(),o.f.create(),function(e){_t.call(this,e),this.init()});a.a.createPrototypeObject(Gt,a.a.objectInherit(_t.prototype,{init:function(){this._pos=o.f.create(),this._quat=o.d.create();var e=this._manipulator.getInputManager();e.group(Ct.a.FPS_MANIPULATOR_WEBVR).addMappings({update:"vrdisplayposechanged"},this),e.setEnable(Ct.a.FPS_MANIPULATOR_WEBVR,!1)},update:function(e){var t=e.pose.transform.orientation;t&&(this._quat[0]=t.x,this._quat[1]=-t.z,this._quat[2]=t.y,this._quat[3]=t.w);var n=e.pose.transform.position;n&&(this._pos[0]=n.x*e.worldFactor,this._pos[1]=-n.z*e.worldFactor,this._pos[2]=n.y*e.worldFactor),this._manipulator.setPoseVR(this._quat,this._pos)}}));var Ht=Gt,zt=function(e){_t.call(this,e),this.init()};a.a.createPrototypeObject(zt,a.a.objectInherit(_t.prototype,{init:function(){this._delay=.15,this._stepFactor=1,this._looking=!1;var e=this._manipulator.getInputManager();e.group(Ct.a.FPS_MANIPULATOR_MOUSEKEYBOARD).addMappings({startLookAt:"mousedown",lookAt:"mousemove",stopLookAt:["mouseup","mouseout"],goForward:["keydown w","keydown z","keydown ArrowUp"],goBackward:["keydown s","keydown ArrowDown"],goLeft:["keydown a","keydown q","keydown ArrowLeft"],goRight:["keydown d","keydown ArrowRight"],stopMoving:["keyup w","keyup z","keyup ArrowUp","keyup s","keyup ArrowDown"],stopStrafing:["keyup a","keyup q","keyup ArrowLeft","keyup d","keyup ArrowRight"],changeStepFactor:"wheel"},this),e.group(Ct.a.FPS_MANIPULATOR_RESETTOHOME).addMappings({reset:"keydown space"},this)},setEnable:function(e){e||(this._buttonup=!0),_t.prototype.setEnable.call(this,e)},setManipulator:function(e){this._manipulator=e,this._manipulator.setStepFactor(this._stepFactor)},stopLookAt:function(){this._looking=!1},startLookAt:function(e){this._manipulator.getLookPositionInterpolator().set(e.canvasX,-e.canvasY),this._looking=!0},lookAt:function(e){this._looking&&(this._manipulator.getLookPositionInterpolator().setDelay(this._delay),this._manipulator.getLookPositionInterpolator().setTarget(e.canvasX,-e.canvasY))},changeStepFactor:function(e){this._stepFactor=Math.min(Math.max(.001,this._stepFactor+.01*e.deltaY),4),this._manipulator.setStepFactor(this._stepFactor)},reset:function(){this._manipulator.computeHomePosition()},goForward:function(){this._manipulator.getForwardInterpolator().setDelay(this._delay),this._manipulator.getForwardInterpolator().setTarget(1)},goBackward:function(){this._manipulator.getForwardInterpolator().setDelay(this._delay),this._manipulator.getForwardInterpolator().setTarget(-1)},goLeft:function(){this._manipulator.getSideInterpolator().setDelay(this._delay),this._manipulator.getSideInterpolator().setTarget(-1)},goRight:function(){this._manipulator.getSideInterpolator().setDelay(this._delay),this._manipulator.getSideInterpolator().setTarget(1)},stopMoving:function(){this._manipulator.getForwardInterpolator().setDelay(this._delay),this._manipulator.getForwardInterpolator().setTarget(0)},stopStrafing:function(){this._manipulator.getSideInterpolator().setDelay(this._delay),this._manipulator.getSideInterpolator().setTarget(0)}}));var Wt=zt,qt=function(e){rt.call(this,e),this.init()};qt.AvailableControllerList=["StandardMouseKeyboard","WebVR","DeviceOrientation","Hammer"],qt.ControllerList=["StandardMouseKeyboard","WebVR","DeviceOrientation","Hammer"],a.a.createPrototypeObject(qt,a.a.objectInherit(rt.prototype,{computeHomePosition:function(e){var t=this.getHomeBoundingSphere(e);if(t&&t.valid()){this._distance=this.getHomeDistance(t);var n=t.center();o.f.scale(this._eye,this._direction,-this._distance),o.f.add(this._eye,n,this._eye),this.setTarget(n)}},init:function(){this._direction=o.f.fromValues(0,1,0),this._eye=o.f.fromValues(0,25,10),this._up=o.f.fromValues(0,0,1),this._distance=1,this._forward=new Nt(1),this._side=new Nt(1),this._lookPosition=new Nt(2),this._pan=new Nt(2),this._zoom=new Nt(1),this._stepFactor=1,this._angleVertical=0,this._angleHorizontal=0,this._tmpGetTargetDir=o.f.create(),this._vrEnable=!1,this._vrRot=o.d.create(),this._vrPos=o.f.create(),this._vrTrans=o.f.create();var e=this;this._controllerList={},qt.ControllerList.forEach(function(t){void 0!==qt[t]&&(e._controllerList[t]?e._controllerList[t].init():e._controllerList[t]=new qt[t](e))})},setDelay:function(e){this._forward.setDelay(e),this._side.setDelay(e),this._lookPosition.setDelay(e),this._pan.setDelay(e),this._zoom.setDelay(e)},getEyePosition:function(e){return e[0]=this._eye[0],e[1]=this._eye[1],e[2]=this._eye[2],e},setEyePosition:function(e){return this._eye[0]=e[0],this._eye[1]=e[1],this._eye[2]=e[2],this},getTarget:function(e){var t=o.f.scale(this._tmpGetTargetDir,this._direction,this._distance);return o.f.add(e,this._eye,t),e},setEnable:function(e){this.getInputManager().setEnable(Ct.a.FPS_MANIPULATOR,e)},setTarget:function(e){var t=this._tmpGetTargetDir;o.f.sub(t,e,this._eye),t[2]=0,o.f.normalize(t,t),this._angleHorizontal=Math.acos(t[1]),t[0]<0&&(this._angleHorizontal=-this._angleHorizontal),o.f.sub(t,e,this._eye),o.f.normalize(t,t),this._angleVertical=-Math.asin(t[2]),o.f.copy(this._direction,t)},getLookPositionInterpolator:function(){return this._lookPosition},getSideInterpolator:function(){return this._side},getForwardInterpolator:function(){return this._forward},getPanInterpolator:function(){return this._pan},getZoomInterpolator:function(){return this._zoom},getRotateInterpolator:function(){return this._lookPosition},computeRotation:function(){var e=o.c.create(),t=o.c.create(),n=o.f.fromValues(1,0,0),i=o.f.fromValues(0,1,0),r=o.f.fromValues(0,0,1),a=.5*Math.PI;return function(s,u){this._angleVertical+=.01*u,this._angleHorizontal-=.01*s,this._angleVertical>a?this._angleVertical=a:this._angleVertical<-a&&(this._angleVertical=-a),this._vrEnable?(o.f.transformQuat(this._direction,i,this._vrRot),o.f.normalize(this._direction,this._direction),o.f.transformQuat(this._up,r,this._vrRot)):(o.c.fromRotation(e,-this._angleVertical,n),o.c.fromRotation(t,-this._angleHorizontal,r),o.c.mul(t,t,e),o.f.transformMat4(this._direction,i,t),o.f.normalize(this._direction,this._direction),o.f.transformMat4(this._up,r,t))}}(),reset:function(){this.init()},setDistance:function(e){this._distance=e},getDistance:function(){return this._distance},setStepFactor:function(e){this._stepFactor=e},computePosition:function(){var e=o.e.create();return function(t){this._forward.update(t),this._side.update(t);var n=this._distance<.001?.001:this._distance,i=this._camera.getProjectionMatrix(),r=1===i[15]?1:2/i[5];e[0]=this._forward.getCurrent()[0],e[1]=this._side.getCurrent()[0];var a=o.e.sqrLen(e);a>1&&o.e.scale(e,e,1/Math.sqrt(a));var s=this._pan.update(t),u=this._zoom.update(t),l=this._stepFactor*n*r*t,c=this._stepFactor*n*r*.005;this.moveForward(e[0]*l-u[0]*c*20),this.strafe(e[1]*l-s[0]*c),this.strafeVertical(-s[1]*c),this._vrEnable&&(o.f.add(this._eye,this._eye,this._vrTrans),o.f.init(this._vrTrans))}}(),update:function(){var e=o.f.create();return function(t){var n=t.getFrameStamp().getDeltaTime(),i=this._lookPosition.update(n);this.computeRotation(.5*-i[0],.5*-i[1]),this.computePosition(n),o.f.add(e,this._eye,this._direction),o.c.lookAt(this._inverseMatrix,this._eye,e,this._up),this._vrEnable=!1}}(),setPoseVR:function(e,t){this._vrEnable=!0,o.d.copy(this._vrRot,e),o.f.sub(this._vrTrans,t,this._vrPos),o.f.copy(this._vrPos,t)},moveForward:function(){var e=o.f.create();return function(t){o.f.normalize(e,this._direction),o.f.scale(e,e,t),o.f.add(this._eye,this._eye,e)}}(),strafe:function(){var e=o.f.create();return function(t){o.f.cross(e,this._direction,this._up),o.f.normalize(e,e),o.f.scale(e,e,t),o.f.add(this._eye,this._eye,e)}}(),strafeVertical:function(){var e=o.f.create();return function(t){o.f.normalize(e,this._up),o.f.scale(e,e,t),o.f.add(this._eye,this._eye,e)}}()}),"osgGA","FirstPersonManipulator"),qt.DeviceOrientation=Bt,qt.Hammer=jt,qt.WebVR=Ht,qt.StandardMouseKeyboard=Wt;var Xt=qt,Yt=function(e){_t.call(this,e),this.init()};a.a.createPrototypeObject(Yt,a.a.objectInherit(_t.prototype,{init:function(){this._quat=o.d.create(),this._pos=o.f.create(),this._deviceOrientation=void 0,this._screenOrientation=void 0;var e=this._manipulator.getInputManager();e.group(Ct.a.ORBIT_MANIPULATOR_DEVICEORIENTATION).addMappings({setDeviceOrientation:"deviceorientation",setScreenOrientation:"orientationchange"},this),e.setEnable(Ct.a.ORBIT_MANIPULATOR_DEVICEORIENTATION,!1)},setDeviceOrientation:function(e){this._deviceOrientation||(this._deviceOrientation={}),this._deviceOrientation.alpha=e.alpha,this._deviceOrientation.beta=e.beta,this._deviceOrientation.gamma=e.gamma,e.screenOrientation?this.setScreenOrientation(e):this._update()},setScreenOrientation:function(e){this._screenOrientation=e.screenOrientation,this._update()},_update:function(){this._deviceOrientation&&this._screenOrientation&&(Bt.computeQuaternion(this._quat,this._deviceOrientation,this._screenOrientation),this._manipulator.setPoseVR(this._quat,this._pos))}}));var Kt=Yt,Qt=function(e){_t.call(this,e),this.init()};a.a.createPrototypeObject(Qt,a.a.objectInherit(_t.prototype,{init:function(){this._delay=.15,this._zoomFactor=.5,this._rotateFactor=5,this._panFactor=10,this._rotate=this._manipulator.getRotateInterpolator(),this._zoom=this._manipulator.getZoomInterpolator(),this._pan=this._manipulator.getPanInterpolator(),this._rotate.setDelay(this._delay),this._zoom.setDelay(this._delay),this._pan.setDelay(this._delay);var e=this._manipulator.getInputManager();e.group(Ct.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({addZoom:"axis 3",addRotateX:"axis 0",addRotateY:"axis 1"},this),e.group(Ct.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panUp:"buttonvalue 12"},this.pan.bind(this,o.e.fromValues(0,1))),e.group(Ct.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panDown:"buttonvalue 13"},this.pan.bind(this,o.e.fromValues(0,-1))),e.group(Ct.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panLeft:"buttonvalue 14"},this.pan.bind(this,o.e.fromValues(1,0))),e.group(Ct.a.ORBIT_MANIPULATOR_GAMEPAD).addMappings({panRight:"buttonvalue 15"},this.pan.bind(this,o.e.fromValues(-1,0)))},pan:function(e){var t=this._pan.getTarget();this._pan.setTarget(t[0]-e[0]*this._panFactor,t[1]+e[1]*this._panFactor)},addZoom:function(e){this._zoom.addTarget(-e.value*this._zoomFactor)},addRotateX:function(e){this._rotate.addTarget(-e.value*this._rotateFactor)},addRotateY:function(e){this._rotate.addTarget(0,e.value*this._rotateFactor)}}));var Jt=Qt,Zt=o.d.create(),$t=o.f.create(),en=function(e){_t.call(this,e),this.init()};a.a.createPrototypeObject(en,a.a.objectInherit(_t.prototype,{init:function(){this._pos=o.f.create(),this._quat=o.d.create();var e=this._manipulator.getInputManager();e.group(Ct.a.ORBIT_MANIPULATOR_WEBVR).addMappings({update:"vrdisplayposechanged"},this),e.setEnable(Ct.a.ORBIT_MANIPULATOR_WEBVR,!1)},update:function(e){var t=e.pose.orientation;t&&(e.sitToStandMatrix&&(t=o.c.getRotation(Zt,e.sitToStandMatrix),o.d.mul(t,t,e.pose.orientation)),this._quat[0]=t[0],this._quat[1]=-t[2],this._quat[2]=t[1],this._quat[3]=t[3]);var n=e.pose.position;n&&(e.sitToStandMatrix&&(n=o.f.transformMat4($t,n,e.sitToStandMatrix)),this._pos[0]=n[0]*e.worldFactor,this._pos[1]=-n[2]*e.worldFactor,this._pos[2]=n[1]*e.worldFactor),this._manipulator.setPoseVR(this._quat,this._pos)}}));var tn=en,nn=function(e){rt.call(this,e),this._homePosition=o.f.create(),this._frustum={},this.init()};nn.AvailableControllerList=["StandardMouseKeyboard","GamePad","Hammer","DeviceOrientation","WebVR"],nn.ControllerList=["StandardMouseKeyboard","GamePad","Hammer","DeviceOrientation","WebVR"];var rn=2*Math.PI,an=function(e,t){return e<t+1e-5};a.a.createPrototypeObject(nn,a.a.objectInherit(rt.prototype,{init:function(){this._distance=25,this._target=o.f.create(),this._upz=o.f.fromValues(0,0,1),o.f.init(this._target);var e=o.c.fromRotation(o.c.create(),-Math.PI,this._upz),t=o.c.fromRotation(o.c.create(),Math.PI/10,o.f.fromValues(1,0,0));this._rotation=o.c.create(),o.c.mul(this._rotation,e,t),this._time=0,this._vrMatrix=o.c.create(),this._rotate=new Nt(2),this._pan=new Nt(2),this._zoom=new Nt(1),this._minSpeed=1e-4,this._scaleMouseMotion=1,this._inverseMatrix=o.c.create(),this._autoPushTarget=!0,this._limitPitchUp=.5*Math.PI*.9,this._limitPitchDown=-this._limitPitchUp,this._limitYawLeft=-Math.PI,this._limitYawRight=-this._limitYawLeft,this._limitZoomIn=1e-4,this._limitZoomOut=1/0,this._constrainYaw=!1,this._constrainPitch=!1,this._constrainYaw=!1,this._constrainZoom=!1,this._panFactor=.002,this._rotationFactor=.1,this._zoomFactor=.1;var n=this;nn.ControllerList.forEach(function(e){void 0!==nn[e]&&(n._controllerList[e]?n._controllerList[e].init():n._controllerList[e]=new nn[e](n))})},setZoomFactor:function(e){this._zoomFactor=.1*e},setRotationFactor:function(e){this._rotationFactor=.1*e},setPanFactor:function(e){this._panFactor=.002*e},setLimitPitchUp:function(e){this._limitPitchUp=e},setLimitPitchDown:function(e){this._limitPitchDown=e},setLimitYawLeft:function(e){this._limitYawLeft=e,this._constrainYaw=!0},setLimitYawRight:function(e){this._limitYawRight=e,this._constrainYaw=!0},setLimitZoomOut:function(e){this._limitZoomOut=e,this._constrainZoom=!0},setLimitZoomIn:function(e){this._limitZoomIn=e,this._constrainZoom=!0},setConstrainPitch:function(e){this._constrainPitch=e,this._previousPitch=void 0},isConstrainPitch:function(){return this._constrainPitch},setConstrainYaw:function(e){this._constrainYaw=e,this._previousYaw=void 0},isConstrainYaw:function(){return this._constrainYaw},setConstrainZoom:function(e){this._constrainZoom=e},isConstrainZoom:function(){return this._constrainZoom},setDelay:function(e){this._rotate.setDelay(e),this._pan.setDelay(e),this._zoom.setDelay(e)},reset:function(){this.init()},setTarget:function(e){o.f.copy(this._target,e);var t=o.f.create();this.getEyePosition(t),this._distance=o.f.distance(e,t)},setEyePosition:function(){var e=o.f.create(),t=o.f.create(),n=o.f.create();return function(i){var r=this._rotation,a=this._target;o.f.sub(e,i,a),o.f.normalize(e,e),o.f.cross(t,e,this._upz),o.f.normalize(t,t),o.f.cross(n,t,e),o.f.normalize(n,n),r[0]=t[0],r[1]=e[0],r[2]=n[0],r[3]=0,r[4]=t[1],r[5]=e[1],r[6]=n[1],r[7]=0,r[8]=t[2],r[9]=e[2],r[10]=n[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this._distance=o.f.distance(a,i)}}(),setEnable:function(e){this.getInputManager().setEnable(Ct.a.ORBIT_MANIPULATOR,e)},computeHomePosition:function(e){var t=this.getHomeBoundingSphere(e);t&&t.valid()&&(this.setDistance(this.getHomeDistance(t)),this.setTarget(t.center()))},getHomePosition:function(){if(void 0!==this._node){var e=this._target,t=this.getDistance();this.computeEyePosition(e,t,this._homePosition)}return this._homePosition},setMinSpeed:function(e){this._minSpeed=e},getMinSpeed:function(){return this._minSpeed},setDistance:function(e){this._distance=e},getDistance:function(){return this._distance},getSpeedFactor:function(){return Math.max(this._distance,this._minSpeed)},computePan:function(){var e=o.c.create(),t=o.f.create(),n=o.f.create();return function(i,r){var a=this._camera.getProjectionMatrix(),s=1===a[15]?1:2/a[5],u=this.getSpeedFactor()*s;r*=u,i*=u,o.c.invert(e,this._rotation),t[0]=e[0],t[1]=e[1],t[2]=e[2],o.f.normalize(t,t),n[0]=e[8],n[1]=e[9],n[2]=e[10],o.f.normalize(n,n),o.f.scale(t,t,-i),o.f.scale(n,n,r),o.f.add(this._target,this._target,t),o.f.add(this._target,this._target,n)}}(),computeRotation:function(){var e=o.f.fromValues(1,0,0);return function(t,n){var i=Math.atan(-this._rotation[6]/this._rotation[5]);isNaN(i)&&(i=0);var r=this._computePitch(i,n),a=t/10,s=Math.atan2(this._rotation[4],this._rotation[0]),u=this._computeYaw(s,a);o.c.fromRotation(this._rotation,-r,e),o.c.rotate(this._rotation,this._rotation,-u,this._upz)}}(),_computePitch:function(e,t){var n=e+t/10;return Math.min(Math.max(n,this._limitPitchDown),this._limitPitchUp)},_computeYaw:function(e,t){var n=e+t,i=this._limitYawLeft,r=this._limitYawRight;if(this._constrainYaw){if(r<i&&(n>Math.PI&&(e-=rn,n-=rn),n<-Math.PI&&(e+=rn,n+=rn)),0===t){(i>r?n<i&&n>r:n<i||n>r)&&(n=Math.abs(n-i)>Math.abs(n-r)?r:i)}t>0&&an(e,r)&&n>r?n=r:t<0&&an(i,e)&&n<i&&(n=i)}return n},computeZoom:function(e){this.zoom(e)},setAutoPushTarget:function(e){this._autoPushTarget=e},zoom:function(){var e=o.f.create();return function(t){var n=this._distance+this.getSpeedFactor()*(t-1);this._autoPushTarget&&n<this._limitZoomIn&&(o.f.sub(e,this._target,this.getEyePosition(e)),o.f.normalize(e,e),o.f.scale(e,e,this._limitZoomIn-n),o.f.add(this._target,this._target,e));var i=this._constrainZoom?this._limitZoomIn:1e-4,r=this._constrainZoom?this._limitZoomOut:1/0;this._distance=Math.max(i,Math.min(r,n))}}(),getRotateInterpolator:function(){return this._rotate},getPanInterpolator:function(){return this._pan},getZoomInterpolator:function(){return this._zoom},getTarget:function(e){return o.f.copy(e,this._target)},getEyePosition:function(e){return this.computeEyePosition(this._target,this._distance,e),e},computeEyePosition:function(){var e=o.f.create(),t=o.c.create();return function(n,i,r){o.c.invert(t,this._rotation),e[1]=i,o.f.transformMat4(r,e,t),o.f.add(r,n,r)}}(),update:function(){var e=o.f.create();return function(t){var n,i=t.getFrameStamp().getDeltaTime();n=this._rotate.update(i),this.computeRotation(-n[0]*this._rotationFactor*this._scaleMouseMotion,-n[1]*this._rotationFactor*this._scaleMouseMotion),n=this._pan.update(i),this.computePan(-n[0]*this._panFactor,-n[1]*this._panFactor),n=this._zoom.update(i),this.computeZoom(1+n[0]*this._zoomFactor);var r=this._target,a=this._distance;o.c.invert(this._inverseMatrix,this._rotation),o.c.mul(this._inverseMatrix,this._vrMatrix,this._inverseMatrix),o.f.set(e,0,a,0),o.f.transformMat4(e,e,this._inverseMatrix),o.c.lookAt(this._inverseMatrix,o.f.add(e,r,e),r,this._upz)}}(),setPoseVR:function(e){o.c.fromQuat(this._vrMatrix,e)}}),"osgGA","OrbitManipulator"),nn.DeviceOrientation=Kt,nn.GamePad=Jt,nn.Hammer=Ot,nn.WebVR=tn,nn.StandardMouseKeyboard=Tt;var on=nn,sn=function(e){this._manipulatorList=[],this._currentManipulator=void 0,this._inputManager=e};sn.prototype={getCamera:function(){return this.getCurrentManipulator().getCamera()},setCamera:function(e){for(var t=this.getManipulatorList(),n=0,i=t.length;n<i;++n)t[n].setCamera(e)},update:function(e){var t=this.getCurrentManipulator();if(void 0!==t)return t.update(e)},getInputManager:function(){return this._inputManager},setEnable:function(e){this.getCurrentManipulator().setEnable(e)},getNode:function(){return this.getCurrentManipulator()._node},setNode:function(e){for(var t=this.getManipulatorList(),n=0,i=t.length;n<i;++n)t[n].setNode(e)},getControllerList:function(){return this.getCurrentManipulator().getControllerList()},getNumManipulator:function(){return this._manipulatorList.length},addManipulator:function(e){this._manipulatorList.push(e),void 0===this._currentManipulator&&this.setManipulatorIndex(0)},getManipulatorList:function(){return this._manipulatorList},setManipulatorIndex:function(e){this._currentManipulator=e},getCurrentManipulatorIndex:function(){return this._currentManipulator},getCurrentManipulator:function(){return this._manipulatorList[this._currentManipulator]},reset:function(){this.getCurrentManipulator().reset()},computeHomePosition:function(e){var t=this.getCurrentManipulator();void 0!==t&&t.computeHomePosition(e)},getInverseMatrix:function(){var e=this.getCurrentManipulator();if(void 0!==e)return e.getInverseMatrix()},getHomeBound:function(e){return A.a.warn("Please use getHomeBoundingSphere instead"),this.getHomeBoundingSphere(e)},getHomeBoundingSphere:function(e){return this.getCurrentManipulator().getHomeBoundingSphere(e)},getHomeDistance:function(e){return this.getCurrentManipulator().getHomeDistance(e)}};var un=sn,ln={};tt.a.NO_MOUSEEVENTS=!0,ln.CADManipulator=Dt,ln.getCADManipulatorStandardMouseKeyboardController=function(){return Et},ln.getCADManipulatorHammerController=function(){return Pt},ln.FirstPersonManipulator=Xt,ln.getFirstPersonDeviceOrientationController=function(){return Bt},ln.getFirstPersonManipulatorHammerController=function(){return jt},ln.getFirstPersonStandardMouseKeyboardControllerClass=function(){return Wt},ln.getFirstPersonWebVRControllerClass=function(){return Ht},ln.Manipulator=rt,ln.OrbitManipulator=on,ln.getOrbitManipulatorDeviceOrientationController=function(){return Kt},ln.getOrbitManipulatorGamePadController=function(){return Jt},ln.getOrbitManipulatorHammerController=function(){return Ot},ln.getOrbitManipulatorStandardMouseKeyboardController=function(){return Tt},ln.getOrbitManipulatorWebVRController=function(){return tn},ln.SwitchManipulator=un,ln.OrbitManipulator.Rotate=St,ln.OrbitManipulator.Pan=yt,ln.OrbitManipulator.Zoom=xt,ln.Controller=_t;var cn=ln,hn=n("jTTs"),dn=n("1D44"),fn=n("/QLk"),pn=n("vQSd"),gn=n("YVF9"),mn=n("W8Lp"),vn=n("DNxV"),_n=n("ip6O"),bn=n("H9HN"),Sn=n("dhQu"),yn=function(){Ge.a.call(this),this._feedbackSwapped=!1,this._syncFeedbackUniforms=!1,this._syncOnNextFrame=!1,this._lastXratio=1,this._lastYratio=1,this._xViewportRatio=1,this._yViewportRatio=1,this._xTextureRatio=1,this._yTextureRatio=1,this._finalPassUpScaleToScreen=!0,this._methodWrapUV=0,this._thresholdWrapUV=1,this._texInfos=void 0,this._screenWidth=this._screenHeight=0,this._feedbackData={},this._cameras=[],this._stateSets=[],this._textureUniforms=[],this._programs={},this._externalTextures={},this._internalPasses=[],this._textures={},this._userTextures={},this._currentPoolIndex=0,this._texturePool={},this._firstTexture="",this._offScreen=!1;var e=this.getOrCreateStateSet();e.setAttributeAndModes(new dn.a(dn.a.DISABLE)),e.setAttributeAndModes(new hn.a(hn.a.BACK)),this.setCullCallback(this)};yn.VertexShader=["attribute vec3 Vertex;","void main(void) {","    gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);","}","","#define SHADER_NAME %name%",""].join("\n"),yn.FragmentShader=["uniform float uRGBMRange;","vec2 gTexCoord;","%uniforms%","",'#pragma include "utils/functions.glsl"',"","%header%","","%texturesColorSpace%","","%functionBodies%","","void main(void) {","    gTexCoord = gl_FragCoord.xy / uTextureOutputSize.xy;","    vec4 color = %firstFunc%(%firstArg%);","    %optionalFuncs%","    %colorSpaces%","    gl_FragColor = color;","}","","#define SHADER_NAME %name%",""].join("\n"),a.a.createPrototypeObject(yn,a.a.objectInherit(Ge.a.prototype,{setOffscreen:function(e){this._offScreen=e},clear:function(){for(var e in this._textures={},this._internalPasses.length=0,this._firstTexture="",this._texturePool)this._texturePool[e].usage=-1;this._feedbackData={},this._cameras.length=0,this._stateSets.length=0,this._textureUniforms.length=0,this.removeChildren()},clearShaderCache:function(){this._programs={}},getGlobalXRatio:function(){return this._xViewportRatio*this._xTextureRatio},getGlobalYRatio:function(){return this._yViewportRatio*this._yTextureRatio},setFinalPassUpScaleToScreen:function(e){this._finalPassUpScaleToScreen=e},_enforceFromInputParameter:function(e,t){var n=t.name,i=this._textures[n],r=this._textures[n+"FeedbackTexture"],a=t[e];void 0!==a&&(void 0!==i[e]&&i[e]!==a&&console.error("Mismatch on parameter "+e+" : "+n),i[e]=a,r&&(r[e]=a))},_updatePassInfoFromInputs:function(e,t,n){var i=this._textures[t],r=n.srgb;n.srgb=void 0;for(var a=0;a<e.textures.length;a++){var o=e.textures[a];this._renameTextureAlias(o,t,n.name);var s=o.name;if(!this._externalTextures[s]){this._usages[s]=(this._usages[s]||0)+1;var u=o.srgb;this._enforceFromInputParameter("filter",o),this._enforceFromInputParameter("rgbm",o),this._enforceFromInputParameter("srgb",o);var l=this._textures[s];if(!l){var c=s.substring(0,s.indexOf("FeedbackTexture"));l=this._textures[c]}void 0!==r&&void 0!==u&&r!==u&&(l.encodeSRGB=!0),this._setInferredParameter("rgbmInferred","rgbm",i,l),this._setInferredParameter("srgbInferred","srgb",i,l)}}void 0===n.srgb&&(n.srgb=void 0===i.srgb?i.srgbInferred:i.srgb)},_setInferredParameter:function(e,t,n,i){void 0===n[e]&&(n[e]=void 0===i[t]?i[e]:i[t])},_createTextureOut:function(e,t,n){var i={srgb:e.out.srgb,rgbm:e.out.rgbm,filter:e.out.filter,type:e.out.type},r=e.out.type!==Ue.default.UNSIGNED_BYTE;return void 0===i.rgbm&&(n||r)&&(i.rgbm=!1),void 0===i.srgb&&(n?i.srgb=!0:(i.rgbm||r)&&(i.srgb=!1)),i},_processUserPasses:function(e){e=this._internalPasses.concat(e);for(var t=this._preprocessUserPasses(e),n=t.length,i=[],r={name:this._firstTexture,srgb:void 0},a={},o=0;o<n;o++){var s=t[o],u=o===n-1;if(u||!this._collapsePasses(s,t[o+1])){var l=s.out.name,c="%next"===l;c&&(a[l=s.funcs.join("_")]?l+=a[l]++:a[l]=1);var h=this._createTextureOut(s,l,u);this._textures[l]=h,this._updatePassInfoFromInputs(s,l,r),s.feedbackLoop&&(this._textures[l+"FeedbackTexture"]={srgb:h.srgb,rgbm:h.rgbm,srgbInferred:h.srgbInferred,rgbmInferred:h.rgbmInferred,filter:h.filter}),c&&(r.name=l,s.out.name=l),i.push(s)}else t.splice(o+1,1),n--,o--}return i},_hasFreeTexture:function(e,t,n){if(e===n.name&&this._texturePool[e])return e;if(!n.immuable)for(var i in this._texturePool){var r=this._texturePool[i];if(r.reusable&&(!(r.usage>0)&&r.texture.divisor===n.divisor&&r.texture.getInternalFormatType()===n.type)){if(-1===r.usage)return r.texture.getMinFilter()!==t&&(r.texture.setMinFilter(t),r.texture.setMagFilter(t)),i;if(r.texture.getMinFilter()===t)return i}}},_setOrCreateTextureKey:function(e,t,n){var i="linear"===this._textures[t].filter?Ue.default.LINEAR:Ue.default.NEAREST,r=this._hasFreeTexture(t,i,n);if(r)return this._texturePool[r].usage=e,void(this._textures[t].key=r);r=n.immuable?t:"key"+this._currentPoolIndex++,this._texturePool[r]={usage:e,texture:this._createTexture(t,n.divisor,n.type,i),immuable:n.immuable,reusable:n.reusable},-1===n.divisor&&(this._texturePool[r].width=n.width,this._texturePool[r].height=n.height),this._textures[t].key=r},_addStateSet:function(e,t){for(var n=0;n<e.funcs.length;n++){var i=e.funcs[n].name;this._stateSets[i]=t}},_addTextureToStateSet:function(e,t,n,i,r){t.addUniform(fn.a.createInt1(n,e.uniformName));var a,o=e.name;if(void 0!==this._textures[o]){var s=this._textures[o].key;a=this._texturePool[s].texture}else a=this._externalTextures[o];if(this._addTextureUniforms(e.uniformName,a,t,i,r),"TexturePrevious"===e.uniformName)return n;t.setTextureAttributeAndModes(n,a)},_getUniformName:function(e){return"u"+e[0].toUpperCase()+e.slice(1)},_addTextureUniforms:function(e,t,n,i,r){var a=this._getUniformName(e),o=fn.a.createFloat2(a+"Size"),s=fn.a.createFloat2(a+"Ratio");n.addUniform(o),n.addUniform(s),i.push(o),i.push(s),this._textureUniforms.push({size:o,ratio:s,texture:t,isFeedback:!!r})},_checkInferredParameters:function(){for(var e in this._textures){var t=this._textures[e];void 0===t.srgb&&(t.srgb=t.srgbInferred),void 0===t.rgbm&&(t.rgbm=t.rgbmInferred)}},_buildPass:function(e,t){var n=t[e],i=n.out.name;this._setOrCreateTextureKey(this._usages[i],i,n.out);var r=n.out.name+"FeedbackTexture";if(n.feedbackLoop&&this._setOrCreateTextureKey(this._usages[r],r,n.out),n.funcs.length){var a,o=new pn.a;for(this._addStateSet(n,o),a=0;a<n.uniforms.length;a++)o.addUniform(n.uniforms[a]);var s=[],u=void 0;for(a=0;a<n.textures.length;a++){var l=n.textures[a],c=l.name===r;if(!c&&!this._externalTextures[l.name]){var h=this._textures[l.name].key;this._texturePool[h].usage--}var d=this._addTextureToStateSet(l,o,a,s,c);if(void 0!==d&&(u=d),void 0!==this._feedbackData[l.name]){var f={stateSet:o,textureUnit:a};this._feedbackData[l.name].nextPasses.push(f)}}var p=void 0;if(e!==t.length-1||this._offScreen){var g=this._textures[i].key;p=this._texturePool[g].texture}this._addTextureUniforms("TextureOutput",p,o,s),o.setAttributeAndModes(this._createProgram(n,s)),n.feedbackLoop?this._feedbackData[i]=this._createFeedbackLoopCameras(i,o,p,u):this.addChild(this._createCamera(i,o,p))}else{var m=this._textures[i].key;this._userTextures[i]=this._texturePool[m].texture}},_buildGraphFromPasses:function(e){for(var t=0;t<e.length;t++)this._buildPass(t,e)},build:function(e){this._usages={};var t=this._processUserPasses(e);this._checkInferredParameters(t),this._buildGraphFromPasses(t),this.resize(this._screenWidth,this._screenHeight)},_createFeedbackLoopCameras:function(e,t,n,i){var r=this._textures[e+"FeedbackTexture"].key,a=this._texturePool[r].texture,o=new Ge.a;o.setStateSet(t);var s=this._createFeedbackLoopCamera(e,n,a,i),u=this._createFeedbackLoopCamera(e+"FeedbackTexture",a,n,i);u.setNodeMask(0),o.addChild(s),o.addChild(u),this.addChild(o);var l={};return l.camera1=s,l.camera2=u,l.texture1=n,l.texture2=a,l.nextPasses=[],l},_createFeedbackLoopCamera:function(e,t,n,i){var r=new pn.a;r.setTextureAttributeAndModes(i,n);var a=this._createCamera(e,r,t);return a.setStateSet(r),a},_createCamera:function(e,t,n){var i=new gn.a;i.setName(e),i.setStateSet(t),i.setClearMask(0),i.setReferenceFrame(Me.a.ABSOLUTE_RF),n&&(i.setRenderOrder(gn.a.PRE_RENDER,0),i.attachTexture(mn.a.COLOR_ATTACHMENT0,n)),i.setViewport(new vn.a);var r=Be.a.createTexturedFullScreenFakeQuadGeometry();return r.setName("composer layer"),i.addChild(r),this._cameras.push(i),i},swapFeedbackLoopTextures:function(e){for(var t in this._feedbackData){var n=this._feedbackData[t];n.camera1.setNodeMask(e?-1:0),n.camera2.setNodeMask(e?0:-1);for(var i=e?n.texture1:n.texture2,r=0;r<n.nextPasses.length;r++){var a=n.nextPasses[r];a.stateSet.setTextureAttributeAndModes(a.textureUnit,i)}}this._feedbackSwapped=!0},_createFuncFromUserData:function(e){var t="string"==typeof e?{name:e,file:e+".glsl"}:e;return t.toString=function(){return this.name},t},_createTextureInfoFromUserData:function(e){var t={name:"",uniformName:"",rgbm:void 0,srgb:void 0,filter:void 0};return"string"==typeof e?t.name=e:(t.name=e.name,e.uniformName&&(t.uniformName=e.uniformName),void 0!==e.rgbm&&(t.rgbm=e.rgbm),void 0!==e.srgb&&(t.srgb=e.srgb),void 0!==e.filter&&(t.filter=e.filter)),t},_preprocessUserPasses:function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],r={funcs:[]};if(i.func&&r.funcs.push(this._createFuncFromUserData(i.func)),r.textures=[],r.feedbackLoop=!1,void 0!==i.textures){Array.isArray(i.textures)||(i.textures=[i.textures]);for(var a=0;a<i.textures.length;a++){var o=this._createTextureInfoFromUserData(i.textures[a]);"%previous"===o.name&&(r.feedbackLoop=!0),r.textures.push(o)}}"string"==typeof i.header?r.header=[i.header]:r.header=i.header||[],void 0!==i.uniforms?Array.isArray(i.uniforms)?r.uniforms=i.uniforms:r.uniforms=[i.uniforms]:r.uniforms=[],r.out=i.out,r.out.divisor=r.out.divisor||1,r.out.type=r.out.type||Ue.default.UNSIGNED_BYTE,void 0===r.out.immuable&&(r.out.immuable=!1),void 0===r.out.reusable&&(r.out.reusable=!0),(r.feedbackLoop||-1===r.out.divisor)&&(r.out.immuable=!0,r.out.reusable=!1),r.collapsible=i.collapsible||!1,t.push(r)}return t},_canBeCollapsed:function(e,t){return e.funcs.length&&t.collapsible&&"%next"===e.out.name&&e.out.divisor===t.out.divisor&&e.out.width==e.out.width&&e.out.height==e.out.height},_collapsePasses:function(e,t){return!!this._canBeCollapsed(e,t)&&(e.funcs=e.funcs.concat(t.funcs),e.header=e.header.concat(t.header),e.textures=this._mergeWithoutDuplicates(e.textures,t.textures,function(e,t){return e.name===t.name}),e.uniforms=this._mergeWithoutDuplicates(e.uniforms,t.uniforms,function(e,t){return e.getName()===t.getName()}),!0)},_renameTextureAlias:function(e,t,n){"%last"===e.name?(e.name=n,e.uniformName=e.uniformName||"TextureInput"):"%previous"===e.name?(e.name=t+"FeedbackTexture",e.uniformName=e.uniformName||"TexturePrevious"):e.uniformName||(e.uniformName=e.name)},_createTexture:function(e,t,n,i){var r=new Ue.default;return r.setTextureSize(1,1),r.setInternalFormatType(n),r.setInternalFormat(Ue.default.RGBA),r.setMinFilter(i),r.setMagFilter(i),r.divisor=t,r.setName(e),r},_computeHashFromPass:function(e){for(var t="",n=0;n<e.funcs.length;n++)t+=e.funcs[n].name+"_"+e.funcs[n].file+"_";for(e.header&&(t+=e.header.join("_")),n=0;n<e.textures.length;n++)t+=!!e.textures[n].rgbm+"_"+!!e.textures[n].srgb+"_";return t+=!!e.out.encodeSRGB+"_",t+=!!this._textures[e.out.name].rgbm+"_"},_writeDeclarations:function(e,t,n,i){var r,a="uniform sampler2D TextureInput;\n";for(r=0;r<n.length;r++){a+="uniform sampler2D "+(n[r].uniformName||n[r].name)+";\n"}for(r=0;r<t.length;r++){var o=t[r];a+="uniform "+o.getType()+" "+o.getName()+";\n"}return e=e.replace("%uniforms%",a),i&&(e=e.replace("%header%",i.join("\n"))),e},setMethodWrapUV:function(e,t){void 0!==e&&(this._methodWrapUV=e),void 0!==t&&(this._thresholdWrapUV=t),this._texInfos=void 0},_getInfos:function(){if(this._texInfos)return this._texInfos;var e="texture2D(%tex, (uv) * %ratio)",t="texture2D(%tex, (floor((uv) * %size) + 0.5) * %ratio / %size, -99999.0)",n="texture2D(%tex, (uv) * %ratio)",i=this._thresholdWrapUV.toExponential();if(1===this._methodWrapUV){var r="min(uv, 1.0 - "+i+" / %size.xy)";e=e.replace(/(uv)/g,r),t=t.replace(/(uv)/g,r),n=n.replace(/(uv)/g,r)}else if(2===this._methodWrapUV){var a="step((uv).x, 1.0 - "+i+" / %size.x) *";e=(a+="step((uv).y, 1.0 - "+i+" / %size.y) * ")+e,t=a+t,n=a+n}return this._texInfos={TEXTURE_2D:{signature:"TEXTURE_2D_%tex(uv)",body:e},TEXTURE_2D_NEAREST:{signature:"TEXTURE_2D_NEAREST_%tex(uv)",body:t},TEXTURE_2D_BIAS:{signature:"TEXTURE_2D_BIAS_%tex(uv, bias)",body:n}},this._texInfos},_extractTextures:function(e){var t=this._getInfos(),n=e.match(/TEXTURE_2D(?:_BIAS|_NEAREST)?_\w+\(/g);if(!n)return{};for(var i={},r=0;r<n.length;r++){var a=n[r].match(/((TEXTURE_2D(?:_BIAS|_NEAREST)?)_(\w+))\(/),o=t[a[2]];i[a[1]]={name:a[3],signature:o.signature,body:o.body}}return i},_writeFunctionBodies:function(e,t,n,i){for(var r=[],a="",o={},s=0;s<t.length;s++){a+=Sn.a.getShaderTextPure(t[s].file)+"\n"}a=Sn.a.processIncludes(a,["utils/functions.glsl"]);var u=this._extractTextures(a);if(i){var l=this._getInfos().TEXTURE_2D;u.TEXTURE_2D_TextureInput={name:"TextureInput",signature:l.signature,body:l.body}}for(var c in u)if(!o[c]){o[c]=!0;for(var h=u[c],d=h.name,f=!1,p=0;p<n.length;p++){var g=n[p];if(g.uniformName===d){var m=this._textures[g.name];if(m&&m.rgbm){f=m.rgbm;break}}}var v=h.body;f&&(v="vec4(decodeRGBM("+v+", uRGBMRange), 1.0)"),v="#define "+h.signature+" ("+v+")";var _=this._getUniformName(d);v=(v=(v=v.replace(/%size/g,_+"Size")).replace(/%ratio/g,_+"Ratio")).replace(/%tex/g,d),r.push(v)}return(e=e.replace("%texturesColorSpace%",r.join("\n"))).replace("%functionBodies%",a.replace(/\\\n/g,""))},_writeMainFunction:function(e,t,n,i){e=e.replace("%firstFunc%",t[0].name);var r=n?"TEXTURE_2D_TextureInput(gTexCoord)":"";e=e.replace("%firstArg%",r);for(var a="",o=1;o<t.length;o++)a+="\tcolor = "+t[o].name+"(color);\n";(e=e.replace("%optionalFuncs%",a),!0===this._textures[i].encodeSRGB)?a="\tcolor.rgb = "+(this._textures[i].srgb?"linearTosRGB":"sRGBToLinear")+"(color.rgb);\n":a="";return this._textures[i].rgbm?a+="\tcolor = encodeRGBM(color.rgb, uRGBMRange);":a+="",e.replace("%colorSpaces%",a)},_removeDuplicatedUniforms:function(e){for(var t=e.split("\n"),n={},i=t.length,r=0;r<i;r++){var a=t[r].match(/uniform(?:\s+){1,}\w+(?:\s+){1,}(\w+)/);if(null!==a){var o=a[1];void 0!==n[o]?(t.splice(r,1),i--,r--):n[o]=!0}}return t.join("\n")},_createProgram:function(e,t){var n=this._computeHashFromPass(e);if(void 0!==this._programs[n])return this._programs[n];var i=this._writeDeclarations(yn.FragmentShader,t,e.textures,e.header);i=this._writeFunctionBodies(i,e.funcs,e.textures,e.collapsible),i=(i=this._writeMainFunction(i,e.funcs,e.collapsible,e.out.name)).replace("%name%",e.out.name),i=this._removeDuplicatedUniforms(i);var r=yn.VertexShader.replace("%name%",e.out.name),a=new _n.a(new bn.a(bn.a.VERTEX_SHADER,r),new bn.a(bn.a.FRAGMENT_SHADER,i));return this._programs[n]=a,a},resize:function(e,t){for(var n in this.setScreenSize(e,t),this._texturePool){var i=this._texturePool[n].texture;void 0===this._texturePool[n].width?i.setTextureSize(this._getTextureSize(e,i.divisor),this._getTextureSize(t,i.divisor)):i.setTextureSize(this._texturePool[n].width,this._texturePool[n].height)}this.resizeRatio()},resizeRatio:function(e,t,n,i){void 0!==e&&(this._xViewportRatio=e),void 0!==t&&(this._yViewportRatio=t),void 0!==n&&(this._xTextureRatio=n),void 0!==i&&(this._yTextureRatio=i),this._resizeViewports(),this._resizeTextureUniforms()},_resizeViewports:function(){for(var e=this.getGlobalXRatio(),t=this.getGlobalYRatio(),n=this._cameras,i=0;i<n.length;++i){var r=n[i],a=1;if(r.isRenderToTextureCamera())a=r.getAttachments()[mn.a.COLOR_ATTACHMENT0].texture.divisor;if(i===n.length-1&&this._finalPassUpScaleToScreen&&(e=this._xViewportRatio,t=this._yViewportRatio),-1!==a){var o=this._getTextureSize(this._screenWidth,a/e),s=this._getTextureSize(this._screenHeight,a/t);r.getViewport().setViewport(0,0,o,s)}}},_resizeTextureUniforms:function(){var e=this.getGlobalXRatio(),t=this.getGlobalYRatio(),n=this._finalPassUpScaleToScreen?this._xViewportRatio:e,i=this._finalPassUpScaleToScreen?this._yViewportRatio:t;this._syncFeedbackUniforms=!0;for(var r=this._textureUniforms,a=0;a<r.length;++a){var o=r[a],s=o.size.getInternalArray(),u=o.ratio.getInternalArray();if(!o.isFeedback||!s[0]){u[0]=e,u[1]=t;var l=o.texture;l?!l.divisor||l.divisor<0?(s[0]=l.getWidth(),s[1]=l.getHeight(),u[0]=u[1]=1):(s[0]=e*l.getWidth(),s[1]=t*l.getHeight()):(s[0]=this._screenWidth*n,s[1]=this._screenHeight*i)}}},_resizeFeedbackTextureUniforms:function(){for(var e=this._lastXratio,t=this._lastYratio,n=this._textureUniforms,i=0;i<n.length;++i){var r=n[i];if(r.isFeedback){var a=r.size.getInternalArray(),o=r.ratio.getInternalArray(),s=r.texture;o[0]=e,o[1]=t,a[0]=e*s.getWidth(),a[1]=t*s.getHeight()}}},cull:function(){return this._syncOnNextFrame&&(this._resizeFeedbackTextureUniforms(),this._syncOnNextFrame=!1),this._syncFeedbackUniforms&&this._feedbackSwapped&&(this._syncFeedbackUniforms=!1,this._syncOnNextFrame=!0,this._lastXratio=this.getGlobalXRatio(),this._lastYratio=this.getGlobalYRatio()),this._feedbackSwapped=!1,!0},_mergeWithoutDuplicates:function(e,t,n){for(var i=0;i<t.length;i++){for(var r=t[i],a=!0,o=0;o<e.length;o++)if(n(e[o],r)){a=!1;break}a&&e.push(r)}return e},_getTextureSize:function(e,t){return Math.max(1,Math.round(e/t))},setScreenSize:function(e,t){this._screenWidth=e,this._screenHeight=t},addInternalTexture:function(e){this._internalPasses.push({out:{name:e.name,divisor:e.divisor,type:e.type,filter:e.filter,srgb:e.srgb,rgbm:e.rgbm,immuable:e.immuable,reusable:e.reusable}})},addExternalTexture:function(e,t){this._externalTextures[e]=t},setInputTexture:function(e){this._firstTexture=e},getCameras:function(){return this._cameras},getStateSetPass:function(e){return this._stateSets[e]},getInternalTexture:function(e){return this._userTextures[e]}}),"osgUtil","ComposerPostProcess");var xn=yn,Cn=function(e,t){var n,i;t?(n=t[0],i=t[1]):(n=e[14]/(e[10]-1),i=e[14]/(1+e[10]));var r=n*(e[8]-1)/e[0],a=n*(1+e[8])/e[0],o=n*(1+e[9])/e[5],s=n*(e[9]-1)/e[5],u=i*(e[8]-1)/e[0],l=i*(1+e[8])/e[0],c=i*(1+e[9])/e[5],h=i*(e[9]-1)/e[5],d=this.getAttributes().Vertex,f=d.getElements();f[0]=r,f[1]=s,f[2]=-n,f[3]=a,f[4]=s,f[5]=-n,f[6]=a,f[7]=o,f[8]=-n,f[9]=r,f[10]=o,f[11]=-n,f[12]=u,f[13]=h,f[14]=-i,f[15]=l,f[16]=h,f[17]=-i,f[18]=l,f[19]=c,f[20]=-i,f[21]=u,f[22]=c,f[23]=-i,d.dirty()},wn={createDebugFrustumGeometry:function(){var e=Be.a.createBoundingBoxGeometry();return e.updateGeometry=Cn,e}},Tn=n("SoBM"),Mn=n("QVk6"),En=n("Hi2/"),An=function(){j.a.call(this),this._unifScale=fn.a.createFloat(1,"uScale");var e=this._normalStateSet=new pn.a;e.addUniform(fn.a.createFloat3(o.f.fromValues(1,0,0),"uColorDebug")),e.addUniform(this._unifScale),e.setAttributeAndModes(new dn.a(dn.a.NEVER)),e.setShaderGeneratorName("debugNormal"),e.setRenderBinDetails(En.a.DEBUG,"RenderBin");var t=this._tangentStateSet=new pn.a;t.addUniform(fn.a.createFloat3(o.f.fromValues(0,1,0),"uColorDebug")),t.addUniform(this._unifScale),t.setAttributeAndModes(new dn.a(dn.a.NEVER)),t.setShaderGeneratorName("debugTangent"),t.setRenderBinDetails(En.a.DEBUG,"RenderBin")};a.a.createPrototypeObject(An,a.a.objectInherit(j.a.prototype,{setScale:function(e){this._unifScale.setFloat(e)},testCreateNormalVisitor:function(e){this._alreadyRun||(this._alreadyRun=!0,this.apply(e))},setTangentVisibility:function(e,t){this._tangentStateSet.setAttributeAndModes(new dn.a(e?dn.a.LESS:dn.a.NEVER)),this.testCreateNormalVisitor(t)},setNormalVisibility:function(e,t){this._normalStateSet.setAttributeAndModes(new dn.a(e?dn.a.LESS:dn.a.NEVER)),this.testCreateNormalVisitor(t)},apply:function(e){if(!(e instanceof Re.a&&e.getCullCallback()||e._isVisitedNormalDebug)){if(e._isVisitedNormalDebug=!0,e instanceof Re.a)return this._createDebugGeom(e,"Normal",this._normalStateSet),void this._createDebugGeom(e,"Tangent",this._tangentStateSet);this.traverse(e);for(var t=e.getUpdateCallbackList(),n=0,i=t.length;n<i;++n)t[n]instanceof K&&t[n].init(e)}},_createDoubleOffsetArray:function(e){for(var t=new Float32Array(2*e),n=0;n<e;++n)t[2*n]=1;return new z.a(z.a.ARRAY_BUFFER,t,1)},_createDoubledBufferArray:function(e){e.getInitialBufferArray&&(e=e.getInitialBufferArray());for(var t=e.getItemSize(),n=e.getElements(),i=n.length/t,r=new(0,n.constructor)(2*n.length),a=0;a<i;++a)for(var o=a*t,s=2*o,u=0;u<t;++u)r[s+u]=r[s+u+t]=n[o+u];return new z.a(z.a.ARRAY_BUFFER,r,t)},_addMorphTargets:function(e,t,n){var i=t.getMorphTargets();t.setName(e.getName());for(var r=e.getMorphTargets(),a=0,o=r.length;a<o;++a){var s=r[a],u=s.getVertexAttributeList(),l=new Re.a;l.setName(s.getName());var c=l.getVertexAttributeList();c.Vertex=this._createDoubledBufferArray(u.Vertex),u[n]&&(c[n]=this._createDoubledBufferArray(u[n])),i.push(l)}return t.mergeChildrenVertexAttributeList(),t},_createDebugGeom:function(e,t,n){var i=e.getAttributes(),r=i[t];if(r){var a=i.Vertex;if(a){var o;e instanceof q.a?o=e:e.getSourceGeometry&&e.getSourceGeometry()instanceof q.a&&(o=e.getSourceGeometry());var s,u=a.getElements().length/a.getItemSize(),l=o?new q.a:new Re.a;if(l.getAttributes().Vertex=this._createDoubledBufferArray(a),l.getAttributes().Offset=this._createDoubleOffsetArray(u),l.getAttributes()[t]=this._createDoubledBufferArray(r),l.getPrimitives().push(new Tn.a(Mn.a.LINES,0,2*u)),o&&this._addMorphTargets(o,l,t),e instanceof W.a){var c=new W.a;c.setSourceGeometry(l),c.getVertexAttributeList().Bones=this._createDoubledBufferArray(i.Bones),c.getVertexAttributeList().Weights=this._createDoubledBufferArray(i.Weights),c._rigTransformImplementation=e._rigTransformImplementation,c._stateSetAnimation=e._stateSetAnimation,c.mergeChildrenData(),s=c}else s=l;var h=e.getParents(),d=h.length;s._isVisitedNormalDebug=!0,s._isNormalDebug=!0,s.setStateSet(n),s.nodeMask=-49;for(var f=0;f<d;++f)h[f].addChild(s);return s}}}}),"osgUtil","DisplayNormalVisitor");var On=An,Rn=n("8eYQ"),Pn=function(){j.a.call(this),this._debugColor=!0,this._debugSkinning=!1,this._stCenter=new pn.a,this._stCenter.setShaderGeneratorName("debugGeometry")};a.a.createPrototypeObject(Pn,a.a.objectInherit(j.a.prototype,{setGeometryDebug:function(e){this._stCenter.setAttributeAndModes(new dn.a(dn.a.ALWAYS)),this._debugColor=!0,this._debugSkinning=!1,this.apply(e)},setSkinningDebug:function(e){this._stCenter.setAttributeAndModes(new dn.a(dn.a.NEVER)),this._debugColor=!1,this._debugSkinning=!0,this._boneIndexErrors=[],this.apply(e),this._boneIndexErrors.length&&this._warnBonesIndex()},disableDebug:function(e){(this._debugColor||this._debugSkinning)&&(this._stCenter.setAttributeAndModes(new dn.a(dn.a.NEVER)),this._debugColor=!1,this._debugSkinning=!1,this.apply(e))},_debugCenterGeometry:function(e,t){var n=e.getBound(),i=new Float32Array(18),r=.1*n.radius();i[0]=r,i[3]=-r,i[7]=r,i[10]=-r,i[14]=r,i[17]=-r;var a=new Re.a;a.getAttributes().Vertex=new z.a(z.a.ARRAY_BUFFER,i,3);var s=new Tn.a(Mn.a.LINES,0,6);a.getPrimitives().push(s);var u=new Ve.a,l=n.center();u.getMatrix()[12]=l[0],u.getMatrix()[13]=l[1],u.getMatrix()[14]=l[2],u.addChild(a),this.nodePath[this.nodePath.length-2].addChild(u),t=o.f.fromValues(.8*t[0],.8*t[1],.8*t[2]),a.getOrCreateStateSet().addUniform(fn.a.createFloat3(t,"uColorDebug")),u.setStateSet(this._stCenter),u._isCenterDebug=!0},_warnBonesIndex:function(){for(var e="Couldn't find bones. Indices: ",t="",n=0;n<this._boneIndexErrors.length&&n<10;n++){var i=this._boneIndexErrors[n];e+=i.index+", ",t+=i.boneNum+", "}Rn.a.client.captureMessage(e+" respectively reference bone nums: "+t)},_debugRigGeometry:function(e){var t=e.getVertexAttributeList();if(!t.BonesColor){for(var n=t.Bones.getElements(),i=t.Weights.getElements(),r=e._rigTransformImplementation._bones,a=n.length/4,o=new Float32Array(3*a),s=0;s<a;++s){for(var u=4*s,l=!1,c=u;c<u+4;c++)n[c]>r.length&&(this._boneIndexErrors.push({index:c,boneNum:n[c]}),l=!0);if(!l){var h=r[n[u]].getOrCreateDebugColor(),d=r[n[u+1]].getOrCreateDebugColor(),f=r[n[u+2]].getOrCreateDebugColor(),p=r[n[u+3]].getOrCreateDebugColor(),g=i[u],m=i[u+1],v=i[u+2],_=i[u+3],b=3*s;o[b]=g*h[0]+m*d[0]+v*f[0]+_*p[0],o[b+1]=g*h[1]+m*d[1]+v*f[1]+_*p[1],o[b+2]=g*h[2]+m*d[2]+v*f[2]+_*p[2]}}t.BonesColor=new z.a(z.a.ARRAY_BUFFER,o,3)}},_debugGeometry:function(e){var t=this._debugColor,n=this._debugSkinning&&e instanceof W.a;if(t||n){void 0===e._originalStateSet&&(e._originalStateSet=e.getStateSet()||null);var i=new pn.a;if(i.setRenderBinDetails(En.a.DEBUG,"RenderBin"),e.setStateSet(i),n)return i.setShaderGeneratorName("debugSkinning"),void this._debugRigGeometry(e);var r=o.f.fromValues(Math.random(),Math.random(),Math.random());i.addUniform(fn.a.createFloat3(r,"uColorDebug")),i.setShaderGeneratorName("debugGeometry"),this._debugCenterGeometry(e,r)}else void 0!==e._originalStateSet&&e.setStateSet(e._originalStateSet||void 0)},apply:function(e){e._isBoneBox||e._isSkeleton||e._isNormalDebug||e._isCenterDebug||(e instanceof Re.a&&this._debugGeometry(e),this.traverse(e))}}),"osgUtil","GeometryColorDebugVisitor");var In,Nn,Ln,kn=Pn,Dn=n("ff9x"),Fn=n("F/aS"),Vn=n("OZCL"),Bn=function(){if(In)return In;var e="#define SHADER_NAME GizmoLine3D",t=["attribute vec3 Vertex;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;",e,"","void main(void) {","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);","}"].join("\n"),n=["uniform vec4 uColor;",e,"","void main(void) {","  gl_FragColor = uColor;","}"].join("\n");return In=new _n.a(new bn.a(bn.a.VERTEX_SHADER,t),new bn.a(bn.a.FRAGMENT_SHADER,n))},Un=function(e,t){var n=e?.5*e:.5,i=t?.5*t:.5,r=new Re.a,a=new Float32Array(12);a[0]=-n,a[1]=-i,a[3]=n,a[4]=-i,a[6]=-n,a[7]=i,a[9]=n,a[10]=i,r.getAttributes().Vertex=new z.a(z.a.ARRAY_BUFFER,a,3);var o=new Tn.a(Mn.a.TRIANGLE_STRIP,0,4);return r.getOrCreateStateSet().setAttributeAndModes(Bn()),r.getPrimitives().push(o),r},jn={createCircleGeometry:function(e,t,n){for(var i=new Re.a,r=new Float32Array(3*e),a=n||2*Math.PI,o=0;o<e;++o){var s=3*o,u=a*o/e;r[s]=Math.cos(u)*t,r[s+1]=Math.sin(u)*t}i.getAttributes().Vertex=new z.a(z.a.ARRAY_BUFFER,r,3);var l=new Tn.a(Mn.a.LINE_STRIP,0,e);return i.getOrCreateStateSet().setAttributeAndModes(Bn()),i.getPrimitives().push(l),i},createCylinderGeometry:function(e,t,n,i,r,a,o){var s=void 0!==e?e:1,u=void 0!==t?t:1,l=void 0!==n?n:5,c=void 0!==i?i:32,h=void 0!==r?r:1,d=void 0===a||a,f=void 0===o||o;d=d&&s>0,f=f&&u>0;var p=.5*l,g=(h+1)*(c+1),m=h*c*2;d&&(g+=1,m+=c),f&&(g+=1,m+=c);var v,_=new Re.a,b=new Float32Array(3*g),S=new Uint16Array(3*m),y=0,x=0,C=0,w=0;for(C=0;C<=h;C++){var T=C/h,M=T*(u-s)+s;for(w=0;w<=c;w++){var E=w/c;b[x=3*y]=M*Math.sin(E*Math.PI*2),b[x+1]=M*Math.cos(E*Math.PI*2),b[x+2]=-T*l+p,y++}}for(y=0,w=0;w<c;w++)for(C=0;C<h;C++)S[x=6*y]=(c+1)*C+w,S[x+1]=S[x+3]=(c+1)*(C+1)+w,S[x+2]=S[x+5]=(c+1)*C+w+1,S[x+4]=(c+1)*(C+1)+w+1,y++;if(y*=2,d)for(b[3*(v=(f?b.length-6:b.length-3)/3)+2]=p,w=0;w<c;w++)S[x=3*y]=w,S[x+1]=w+1,S[x+2]=v,y++;if(f){b[3*(v=(b.length-3)/3)+2]=-p;var A=(c+1)*C;for(w=0;w<c;w++)S[x=3*y]=A+w+1,S[x+1]=A+w,S[x+2]=v,y++}return _.getAttributes().Vertex=new z.a(z.a.ARRAY_BUFFER,b,3),_.getOrCreateStateSet().setAttributeAndModes(Bn()),_.getPrimitives().push(new Vn.a(Mn.a.TRIANGLES,new z.a(z.a.ELEMENT_ARRAY_BUFFER,S,1))),_},createTorusGeometry:function(e,t,n,i,r){var a=void 0!==e?e:1,o=void 0!==t?t:.2,s=void 0!==n?n:6,u=void 0!==i?i:64,l=void 0!==r?r:2*Math.PI,c=(s+1)*(u+1),h=s*u*2,d=new Re.a,f=new Float32Array(3*c),p=new Uint16Array(3*h);l=l||2*Math.PI;var g=0,m=0,v=0,_=0;for(_=0;_<=s;++_)for(v=0;v<=u;++v){var b=v/u*l,S=_/s*Math.PI*2;f[m=3*g]=(a+o*Math.cos(S))*Math.cos(b),f[m+1]=(a+o*Math.cos(S))*Math.sin(b),f[m+2]=o*Math.sin(S),g++}for(g=0,_=1;_<=s;++_)for(v=1;v<=u;++v)p[m=6*g]=(u+1)*_+v-1,p[m+1]=p[m+3]=(u+1)*(_-1)+v-1,p[m+2]=p[m+5]=(u+1)*_+v,p[m+4]=(u+1)*(_-1)+v,g++;return d.getAttributes().Vertex=new z.a(z.a.ARRAY_BUFFER,f,3),d.getOrCreateStateSet().setAttributeAndModes(Bn()),d.getPrimitives().push(new Vn.a(Mn.a.TRIANGLES,new z.a(z.a.ELEMENT_ARRAY_BUFFER,p,1))),d}};jn.createDebugLineGeometry=function(){var e=new Re.a;e.getAttributes().Vertex=new z.a(z.a.ARRAY_BUFFER,new Float32Array(4),2);var t=new Tn.a(Mn.a.LINES,0,2);return e.getPrimitives().push(t),e.getOrCreateStateSet().setAttributeAndModes(function(){if(Nn)return Nn;var e="#define SHADER_NAME GizmoLine2D",t=["attribute vec2 Vertex;",e,"","void main(void) {","  gl_Position = vec4(Vertex, 0.0, 1.0);","}"].join("\n"),n=[e,"","void main(void) {","  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);","}"].join("\n");return Nn=new _n.a(new bn.a(bn.a.VERTEX_SHADER,t),new bn.a(bn.a.FRAGMENT_SHADER,n))}()),e},jn.createPlaneGeometry=Un,jn.createQuadCircleGeometry=function(){var e=Un();return e.getOrCreateStateSet().setAttributeAndModes(function(){if(Ln)return Ln;var e="#define SHADER_NAME GizmoQuadCircle",t=["attribute vec3 Vertex;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","varying vec3 vViewVertex;",e,"","void main(void) {","  vViewVertex = Vertex;","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);","}"].join("\n"),n=["uniform float uAngle;","uniform vec3 uBase;","varying vec3 vViewVertex;","const float PI = 3.14159265358979323846264;","const float PI2 = PI * 2.0;",e,"","void main(void) {","  if(length(vViewVertex) > 0.5)","    discard;","  vec3 vn = normalize(vViewVertex);","  float angle = atan(uBase.y * vn.x - uBase.x * vn.y, dot(uBase, vn));","  if(angle > 0.0) {","    if(uAngle >= 0.0 && angle > uAngle) discard;","    if(uAngle < -PI && angle < uAngle + PI2) discard;","    if(uAngle < 0.0 && uAngle > -PI) discard;","  }","  if(angle < 0.0) {","    if(uAngle <= 0.0 && angle < uAngle) discard;","    if(uAngle > PI && angle > uAngle - PI2) discard;","    if(uAngle > 0.0 && uAngle < PI) discard;","  }","  gl_FragColor = vec4(1.0, 1.0, 0.0, 0.5);","}"].join("\n");return Ln=new _n.a(new bn.a(bn.a.VERTEX_SHADER,t),new bn.a(bn.a.FRAGMENT_SHADER,n))}()),e},jn.resetPrograms=function(){In=void 0,Nn=void 0,Ln=void 0};var Gn=jn,Hn=function(){};Hn.prototype={cull:function(){return!1}};var zn=new je.a(je.a.SRC_ALPHA,je.a.ONE_MINUS_SRC_ALPHA),Wn=function(e){this._testPlane=e,this._inter=o.f.create(),ot.a.call(this)};a.a.createPrototypeObject(Wn,a.a.objectInherit(ot.a.prototype,{setTestPlane:function(e){this._testPlane=e},getTranslateDistance:function(){return this._inter},enter:function(){var e=o.f.create(),t=o.f.create();return function(n){if(void 0===n._nbAxis)return!0;if(o.f.init(e),e[n._nbAxis]=1,this._testPlane){var i=o.f.dot(this._iStart,e),r=o.f.dot(this._iEnd,e);if(i===r)return!1;var a=-i/(r-i);this._inter[0]=this._iStart[0]+(this._iEnd[0]-this._iStart[0])*a,this._inter[1]=this._iStart[1]+(this._iEnd[1]-this._iStart[1])*a,this._inter[2]=this._iStart[2]+(this._iEnd[2]-this._iStart[2])*a}else{o.f.normalize(t,o.f.sub(t,this._iEnd,this._iStart));var s=-o.f.dot(t,e),u=o.f.dot(this._iStart,t),l=Math.abs(1-s*s),c=-o.f.dot(this._iStart,e);o.f.init(this._inter),this._inter[n._nbAxis]=(s*u-c)/l}return!1}}(),intersectTriangle:function(){},intersectLine:function(){},intersectPoint:function(){}}),"osgUtil","LineCustomIntersector");var qn=o.c.create(),Xn=function(e){Ve.a.call(this),this._tmask=1,this._autoInsertMT=!1,this._correctPivotOnAutoInsert=!1,this._viewer=e,this._canvas=e.getGraphicContext().canvas,this._rotateNode=new Ve.a,this._translateNode=new Ve.a,this._planeNode=new Ve.a,this._rotateInLocal=!0,this._translateInLocal=!0,this._showAngle=new Ve.a,this._downCanvasCoord=o.e.create(),this._hoverNode=null,this._keepHoverColor=o.g.create(),this._isEditing=!1,this._editLineOrigin=o.f.create(),this._editLineDirection=o.f.create(),this._editOffset=o.f.create(),this._editLocal=o.c.create(),this._editWorldTrans=o.c.create(),this._editWorldScaleRot=o.c.create(),this._editInvWorldScaleRot=o.c.create(),this._debugNode=new Ge.a,this._lastDistToEye=0,this._attachedNode=null,this._pivotOffset=o.f.create(),this.attachToNode(null),this._lsi=new Wn,this._origIntersect=o.f.create(),this._dstIntersect=o.f.create(),this._iv=new at.a,this._iv.setIntersector(this._lsi),this.init()};Xn.NO_PICK=1,Xn.PICK_ARC_X=2,Xn.PICK_ARC_Y=4,Xn.PICK_ARC_Z=8,Xn.PICK_ARROW_X=16,Xn.PICK_ARROW_Y=32,Xn.PICK_ARROW_Z=64,Xn.PICK_PLANE_X=128,Xn.PICK_PLANE_Y=256,Xn.PICK_PLANE_Z=512,Xn.NO_FULL_CIRCLE=1024,Xn.CORRECT_PIVOT=2048,Xn.PICK_GIZMO=(Xn.PICK_ARC=Xn.PICK_ARC_X|Xn.PICK_ARC_Y|Xn.PICK_ARC_Z)|(Xn.PICK_ARROW=Xn.PICK_ARROW_X|Xn.PICK_ARROW_Y|Xn.PICK_ARROW_Z)|(Xn.PICK_PLANE=Xn.PICK_PLANE_X|Xn.PICK_PLANE_Y|Xn.PICK_PLANE_Z);var Yn=function(){j.a.call(this,j.a.TRAVERSE_PARENTS),this._editableNode=null};a.a.createPrototypeObject(Yn,a.a.objectInherit(j.a.prototype,{reset:function(){j.a.prototype.reset.call(this),this._editableNode=null},getEditableNode:function(){return this._editableNode},apply:function(e){if(!this._editableNode){var t=e.editMask;t&&t&Xn.PICK_GIZMO?this._editableNode=e:this.traverse(e)}}})),a.a.createPrototypeNode(Xn,a.a.objectInherit(Ve.a.prototype,{setRotateInLocal:function(e){this._rotateInLocal=e},setTranslateInLocal:function(e){this._translateInLocal=e},setTraversalMask:function(e){this._tmask=e},setAutoMatrixTransformInsertion:function(e){this._autoInsertMT=e},setCorrectPivotOnAutoInsert:function(e){this._correctPivotOnAutoInsert=e},isEditing:function(){return this._isEditing},getAttachedNode:function(){return this._attachedNode},init:function(){this.getOrCreateStateSet().setAttributeAndModes(new dn.a(dn.a.DISABLE)),this.getOrCreateStateSet().setAttributeAndModes(new hn.a(hn.a.DISABLE)),this.addUpdateCallback(this),this.addChild(this.initNodeTranslate()),this.addChild(this.initNodeTranslatePlane()),this.addChild(this.initNodeRotate()),this._debugNode&&(this._debugNode.addChild(Gn.createDebugLineGeometry()),this.addChild(this._debugNode),this._debugNode.setNodeMask(0));var e=this._viewer.getInputManager();e.group(Ct.a.NODE_GIZMO).addMappings({onMouseMove:"mousemove",onMouseDown:"mousedown",onMouseUp:["mouseup","mouseout"]},this),e.setPriority(Ct.a.NODE_GIZMO,e.getHigherPriority(Ct.a.MANIPULATORS))},_insertEditNode:function(e,t){var n=new Ve.a;return n.editMask=Xn.PICK_GIZMO,this._correctPivotOnAutoInsert&&(n.editMask|=Xn.CORRECT_PIVOT),e.addChild(n),e.removeChild(t),n.addChild(t),n._isInserted=!0,n},_findEditNodeFromNodePath:function(e){if(!e)return null;var t=e[e.length-1];if(t.editMask)return t;if(!this._autoInsertMT){for(var n=e.length-1;n>=0;--n){var i=e[n].editMask;if(i&&i&Xn.PICK_GIZMO)return e[n]}return null}var r=e[e.length-2];return r.editMask?r:this._insertEditNode(r,t)},_findEditNodeFromNode:function(e){if(!e)return null;if(e.editMask)return e;if(this._autoInsertMT){for(var t=e.getParents(),n=0;n<t.length;++n){var i=t[n].editMask;if(i&&i&Xn.PICK_GIZMO)return t[n]}return this._insertEditNode(t[0],e)}return this._getEditNodeVisitor?this._getEditNodeVisitor.reset():this._getEditNodeVisitor=new Yn,e.accept(this._getEditNodeVisitor),this._getEditNodeVisitor.getEditableNode()},attachToNodePath:function(e){var t=this._findEditNodeFromNodePath(e);this._attachEditNode(t,e&&e[e.length-1])},attachToNode:function(e){var t=this._findEditNodeFromNode(e);this._attachEditNode(t,e)},_attachEditNode:function(e,t){this._attachedNode=e,e&&t&&t!==e&&e.editMask&Xn.CORRECT_PIVOT&&o.f.copy(this._pivotOffset,t.getBoundingSphere().center()),this.updateGizmoMask()},updateGizmoMask:function(){if(!this._attachedNode)return o.f.init(this._pivotOffset),void this.setNodeMask(0);var e=this._attachedNode.editMask;this.setNodeMask(e&Xn.PICK_GIZMO?Xn.NO_PICK:0),this._translateNode.setNodeMask(e&Xn.PICK_ARROW?Xn.PICK_ARROW:0),this._rotateNode.setNodeMask(e&Xn.PICK_ARC?Xn.PICK_ARC:0),this._planeNode.setNodeMask(e&Xn.PICK_PLANE?Xn.PICK_PLANE:0);var t=this._translateNode.getChildren();t[0].setNodeMask(e&Xn.PICK_ARROW_X?Xn.PICK_ARROW_X:0),t[1].setNodeMask(e&Xn.PICK_ARROW_Y?Xn.PICK_ARROW_Y:0),t[2].setNodeMask(e&Xn.PICK_ARROW_Z?Xn.PICK_ARROW_Z:0);var n=this._rotateNode.getChildren();n[0].setNodeMask(e&Xn.NO_FULL_CIRCLE?0:Xn.NO_PICK),n[1].setNodeMask(e&Xn.PICK_ARC_X?Xn.PICK_ARC_X:0),n[2].setNodeMask(e&Xn.PICK_ARC_Y?Xn.PICK_ARC_Y:0),n[3].setNodeMask(e&Xn.PICK_ARC_Z?Xn.PICK_ARC_Z:0);var i=this._planeNode.getChildren();i[0].setNodeMask(e&Xn.PICK_PLANE_X?Xn.PICK_PLANE_X:0),i[1].setNodeMask(e&Xn.PICK_PLANE_Y?Xn.PICK_PLANE_Y:0),i[2].setNodeMask(e&Xn.PICK_PLANE_Z?Xn.PICK_PLANE_Z:0)},onNodeHovered:function(){var e=o.g.fromValues(1,1,0,1);return function(t){if(this._hoverNode&&this._hoverNode.getStateSet().getUniform("uColor").setFloat4(this._keepHoverColor),t){for(var n=t._nodePath,i=n.length-1,r=n[i];void 0===r._nbAxis;){if(0===i)return;r=n[--i]}var a=r.getStateSet().getUniform("uColor");this._hoverNode=r,o.g.copy(this._keepHoverColor,a.getInternalArray()),a.setFloat4(e)}else this._hoverNode=null}}(),initNodeRotate:function(){var e=Gn.createTorusGeometry(1,.01,6,64,2*Math.PI),t=Gn.createTorusGeometry(1,.01,6,64,Math.PI),n=Gn.createTorusGeometry(1,.1,6,64,Math.PI),i=new Ve.a,r=new Ve.a,a=new Ve.a,s=new Ve.a;r._nbAxis=0,a._nbAxis=1,s._nbAxis=2;var u=new Ge.a;u.setCullCallback(new Hn),u.addChild(n),e.setNodeMask(Xn.NO_PICK),t.setNodeMask(Xn.NO_PICK),r.setNodeMask(Xn.PICK_ARC_X),a.setNodeMask(Xn.PICK_ARC_Y),s.setNodeMask(Xn.PICK_ARC_Z),i.addChild(e),r.addChild(t),a.addChild(t),s.addChild(t),r.addChild(u),a.addChild(u),s.addChild(u),i.getOrCreateStateSet().addUniform(fn.a.createFloat4(o.g.fromValues(.2,.2,.2,1),"uColor")),r.getOrCreateStateSet().addUniform(fn.a.createFloat4(o.g.fromValues(1,0,0,1),"uColor")),a.getOrCreateStateSet().addUniform(fn.a.createFloat4(o.g.fromValues(0,1,0,1),"uColor")),s.getOrCreateStateSet().addUniform(fn.a.createFloat4(o.g.fromValues(0,0,1,1),"uColor"));var l=this._showAngle;l.getOrCreateStateSet().setAttributeAndModes(zn),l.setNodeMask(0),l.getOrCreateStateSet().addUniform(fn.a.createFloat3(o.f.fromValues(1,0,0),"uBase")),l.getOrCreateStateSet().addUniform(fn.a.createFloat(0,"uAngle")),l.addChild(Gn.createQuadCircleGeometry());var c=this._rotateNode;return c.setNodeMask(Xn.PICK_ARC),c.addChild(i),c.addChild(r),c.addChild(a),c.addChild(s),c.addChild(l),c},initNodeTranslate:function(){var e=new Ve.a;o.c.fromTranslation(e.getMatrix(),o.f.fromValues(0,0,1.65)),e.addChild(Gn.createCylinderGeometry(0,.07,.3,32,1,!0,!0));var t=new Ve.a;o.c.fromTranslation(t.getMatrix(),o.f.fromValues(0,0,.75)),t.addChild(Gn.createCylinderGeometry(.01,.01,1.5,32,1,!0,!0));var n=new Ge.a;n.addChild(t),n.addChild(e);var i=Gn.createCylinderGeometry(.1,.1,1.3*1.1,32,1,!0,!0),r=new Ve.a,a=new Ve.a,s=new Ve.a;r._nbAxis=0,a._nbAxis=1,s._nbAxis=2,o.c.fromRotation(r.getMatrix(),.5*Math.PI,o.f.fromValues(0,1,0)),o.c.fromRotation(a.getMatrix(),.5*-Math.PI,o.f.fromValues(1,0,0));var u=new Ve.a;u.setCullCallback(new Hn),o.c.fromTranslation(u.getMatrix(),o.f.fromValues(0,0,1.215)),u.addChild(i),n.setNodeMask(Xn.NO_PICK),r.setNodeMask(Xn.PICK_ARROW_X),a.setNodeMask(Xn.PICK_ARROW_Y),s.setNodeMask(Xn.PICK_ARROW_Z),r.addChild(n),a.addChild(n),s.addChild(n),r.addChild(u),a.addChild(u),s.addChild(u),r.getOrCreateStateSet().addUniform(fn.a.createFloat4(o.g.fromValues(1,0,0,1),"uColor")),a.getOrCreateStateSet().addUniform(fn.a.createFloat4(o.g.fromValues(0,1,0,1),"uColor")),s.getOrCreateStateSet().addUniform(fn.a.createFloat4(o.g.fromValues(0,0,1,1),"uColor"));var l=this._translateNode;return l.setNodeMask(Xn.PICK_ARROW),l.addChild(r),l.addChild(a),l.addChild(s),l},initNodeTranslatePlane:function(){var e=new Ve.a;o.c.fromTranslation(e.getMatrix(),o.f.fromValues(.5,.5,0)),o.c.mul(e.getMatrix(),o.c.fromScaling(o.c.create(),o.f.fromValues(.5,.5,1)),e.getMatrix()),e.addChild(Gn.createPlaneGeometry());var t=new Ve.a,n=new Ve.a,i=new Ve.a;t._nbAxis=0,n._nbAxis=1,i._nbAxis=2,o.c.fromRotation(t.getMatrix(),.5*-Math.PI,o.f.fromValues(0,1,0)),o.c.fromRotation(n.getMatrix(),.5*Math.PI,o.f.fromValues(1,0,0)),t.setNodeMask(Xn.PICK_PLANE_X),n.setNodeMask(Xn.PICK_PLANE_Y),i.setNodeMask(Xn.PICK_PLANE_Z),t.addChild(e),n.addChild(e),i.addChild(e),t.getOrCreateStateSet().addUniform(fn.a.createFloat4(o.g.fromValues(1,0,0,.3),"uColor")),n.getOrCreateStateSet().addUniform(fn.a.createFloat4(o.g.fromValues(0,1,0,.3),"uColor")),i.getOrCreateStateSet().addUniform(fn.a.createFloat4(o.g.fromValues(0,0,1,.3),"uColor"));var r=this._planeNode;return r.setNodeMask(Xn.PICK_PLANE),r.getOrCreateStateSet().setAttributeAndModes(zn),r.addChild(t),r.addChild(n),r.addChild(i),r},updateArcRotation:function(){var e=o.d.create(),t=o.d.setAxisAngle(o.d.create(),[0,1,0],.5*-Math.PI),n=o.d.setAxisAngle(o.d.create(),[1,0,0],.5*-Math.PI);return function(i){var r=this._rotateNode.getChildren();e[0]=-i[1],e[1]=i[0],e[2]=0,e[3]=1+i[2],o.d.normalize(e,e),o.c.fromQuat(r[0].getMatrix(),e),o.d.setAxisAngle(e,[1,0,0],Math.atan2(i[2],i[1])),o.d.mul(e,e,t),o.c.fromQuat(r[1].getMatrix(),e),o.d.setAxisAngle(e,[0,1,0],Math.atan2(-i[0],-i[2])),o.d.mul(e,e,n),o.c.fromQuat(r[2].getMatrix(),e),o.d.setAxisAngle(e,[0,0,1],Math.atan2(-i[0],i[1])),o.c.fromQuat(r[3].getMatrix(),e),r[1].dirtyBound(),r[2].dirtyBound(),r[3].dirtyBound()}}(),getTransformType:function(e){for(var t=e;t.getParents().length>0;){var n=t.referenceFrame;if(void 0!==n&&n===Me.a.ABSOLUTE_RF)return Me.a.ABSOLUTE_RF;t=t.getParents()[0]}return Me.a.RELATIVE_RF},getAttachedNodeWorldMatrix:function(){var e=this._attachedNode.getWorldMatrix(void 0,qn);return o.c.translate(e,e,this._pivotOffset)},update:function(){var e=o.f.create(),t=o.f.create(),n=o.f.create(),i=o.c.create();return function(){if(this._attachedNode){var r=this.getTransformType(this._attachedNode);this.setReferenceFrame(r),this.setCullingActive(r===Me.a.RELATIVE_RF);var a=this.getAttachedNodeWorldMatrix();o.c.getTranslation(t,a);var s=3;if(r===Me.a.ABSOLUTE_RF)e[0]=e[1]=e[2]=0;else{var u=this._viewer.getCamera().getProjectionMatrix(),l=.023*this._canvas.clientWidth*u[0];this._viewer.getManipulator().getEyePosition(e),this._lastDistToEye=this._isEditing?this._lastDistToEye:o.f.distance(t,e),s*=this._lastDistToEye/l}var c=this.getMatrix();if(o.c.fromTranslation(c,t),o.f.set(n,s,s,s),o.c.mul(c,c,o.c.fromScaling(i,n)),o.f.sub(e,e,t),o.f.normalize(e,e),this._rotateInLocal||this._translateInLocal){o.c.getScale(n,a);var h=o.c.fromScaling(i,n);o.c.invert(h,h);var d=o.c.mul(a,a,h);d[12]=d[13]=d[14]=0,this._translateInLocal&&(o.c.copy(this._translateNode.getMatrix(),d),o.c.copy(this._planeNode.getMatrix(),d)),this._rotateInLocal&&(o.c.copy(this._rotateNode.getMatrix(),d),o.c.invert(d,d),o.f.transformMat4(e,e,d))}else o.c.identity(this._rotateNode.getMatrix());this.updateArcRotation(e),this._rotateNode.dirtyBound(),this._translateNode.dirtyBound(),this._planeNode.dirtyBound(),this._isEditing&&o.c.copy(this._showAngle.getMatrix(),this._hoverNode.getMatrix())}}}(),computeNearestIntersection:function(){var e=function(e,t){return e._ratio-t._ratio};return function(t,n){var i=this._viewer,r=this._canvas,a=t.canvasX*(i._canvasWidth/r.clientWidth),o=(r.clientHeight-t.canvasY)*(i._canvasHeight/r.clientHeight),s=this._viewer.computeIntersections(a,o,n);if(0!==s.length)return s.sort(e),s[0]}}(),setOnlyGizmoPicking:function(){this._viewer.getCamera().addChild(this),this._viewer.getSceneData().setNodeMask(0),this.setNodeMask(-1)},setOnlyScenePicking:function(){this._viewer.getCamera().removeChild(this),this._viewer.getSceneData().setNodeMask(-1),this.setNodeMask(Xn.NO_PICK)},pickGizmo:function(e,t){this.setOnlyGizmoPicking();var n=this.computeNearestIntersection(e,t);return this.setOnlyScenePicking(),n},getCanvasPositionFromWorldPoint:function(){var e=o.c.create();return function(t,n){var i=this._viewer.getCamera(),r=n;i.getViewport()?i.getViewport().computeWindowMatrix(e):o.c.identity(e),o.c.mul(e,e,i.getProjectionMatrix()),this.getReferenceFrame()===Me.a.RELATIVE_RF&&o.c.mul(e,e,i.getViewMatrix()),o.f.transformMat4(r,t,e);var a=this._viewer,s=this._canvas;return r[0]=r[0]/(a._canvasWidth/s.clientWidth),r[1]=s.clientHeight-r[1]/(a._canvasHeight/s.clientHeight),r}}(),onMouseDown:function(e){if(o.e.set(this._downCanvasCoord,e.canvasX,e.canvasY),this._hoverNode&&this._attachedNode){this._viewer.setEnableManipulator(!1),this.saveEditMatrices();var t=this._hoverNode.getParents()[0].getNodeMask();this._isEditing=!0,t&Xn.PICK_ARC?(this._translateNode.setNodeMask(0),this._planeNode.setNodeMask(0),this.startRotateEdit(e)):t&Xn.PICK_ARROW?(this._rotateNode.setNodeMask(0),this._planeNode.setNodeMask(0),this.startTranslateEdit(e)):t&Xn.PICK_PLANE&&(this._rotateNode.setNodeMask(0),this._translateNode.setNodeMask(0),this.startPlaneEdit(e))}},saveEditMatrices:function(){o.c.copy(this._editLocal,this._attachedNode.getMatrix());var e=this.getAttachedNodeWorldMatrix();o.c.fromTranslation(this._editWorldTrans,o.f.fromValues(e[12],e[13],e[14])),o.c.copy(this._editWorldScaleRot,e),this._editWorldScaleRot[12]=this._editWorldScaleRot[13]=this._editWorldScaleRot[14]=0,o.c.invert(this._editInvWorldScaleRot,this._editWorldScaleRot)},startRotateEdit:function(e){var t=this._rotateNode.getWorldMatrix(void 0,qn),n=o.f.create();o.f.transformMat4(n,n,t),this.getCanvasPositionFromWorldPoint(n,n);var i=this.pickGizmo(e,this._hoverNode.getNodeMask()|Xn.PICK_ARC);if(i){var r=0===this._hoverNode._nbAxis?-1:1,a=o.f.create();a[0]=r*i._localIntersectionPoint[1],a[1]=-r*i._localIntersectionPoint[0],a[2]=i._localIntersectionPoint[2];var s=o.f.create();o.f.transformMat4(s,a,this._hoverNode.getMatrix()),o.f.transformMat4(s,s,t),this.getCanvasPositionFromWorldPoint(s,s);var u=this._editLineDirection;o.e.sub(u,s,n),o.e.normalize(u,u),this._showAngle.setNodeMask(Xn.NO_PICK),i._localIntersectionPoint[2]=0;var l=this._showAngle.getStateSet();l.getUniform("uAngle").setFloat(0),l.getUniform("uBase").setVec3(o.f.normalize(i._localIntersectionPoint,i._localIntersectionPoint)),this._editLineOrigin[0]=e.canvasX,this._editLineOrigin[1]=e.canvasY}},startTranslateEdit:function(e){var t=this._editLineOrigin,n=this._editLineDirection,i=this._translateNode.getWorldMatrix(void 0,qn);o.c.getTranslation(t,i),o.f.init(n),n[this._hoverNode._nbAxis]=1,this._translateInLocal&&(o.f.transformMat4(n,n,this._editWorldScaleRot),o.f.normalize(n,n)),o.f.add(n,t,n),this.getCanvasPositionFromWorldPoint(t,t),this.getCanvasPositionFromWorldPoint(n,n),o.e.sub(n,n,t),o.e.normalize(n,n);var r=this._editOffset;o.e.set(r,e.canvasX,e.canvasY),o.e.sub(r,r,t)},startPlaneEdit:function(e){var t=this._editLineOrigin,n=this._planeNode.getWorldMatrix(void 0,qn);o.c.getTranslation(t,n),this.getCanvasPositionFromWorldPoint(t,t);var i=this._editOffset;o.e.set(i,e.canvasX,e.canvasY),o.e.sub(i,i,t)},drawLineCanvasDebug:function(e,t,n,i){this._debugNode.setNodeMask(Xn.NO_PICK);var r=this._debugNode.getChildren()[0].getAttributes().Vertex;r.getElements()[0]=e/this._canvas.clientWidth*2-1,r.getElements()[1]=(this._canvas.clientHeight-t)/this._canvas.clientHeight*2-1,r.getElements()[2]=n/this._canvas.clientWidth*2-1,r.getElements()[3]=(this._canvas.clientHeight-i)/this._canvas.clientHeight*2-1,r.dirty()},pickAndSelect:function(e){this.setNodeMask(0);var t=this.computeNearestIntersection(e,this._tmask);this.attachToNodePath(t?t._nodePath:t)},onMouseUp:function(e){this._viewer.setEnableManipulator(!0),this._debugNode&&this._debugNode.setNodeMask(0);var t=o.e.fromValues(e.canvasX,e.canvasY);0===o.e.distance(t,this._downCanvasCoord)&&this.pickAndSelect(e),this._showAngle.setNodeMask(0),this._isEditing=!1,this._hoverNode&&this.updateGizmoMask()},onMouseMove:function(e){if(this._attachedNode){var t;if(!1===this._isEditing)return t=this.pickGizmo(e,Xn.PICK_GIZMO),void this.onNodeHovered(t);if(this._hoverNode){var n=this._hoverNode.getParents()[0];n===this._rotateNode?this.updateRotateEdit(e):n===this._translateNode?this.updateTranslateEdit(e):n===this._planeNode&&this.updatePlaneEdit(e)}}},updateRotateEdit:function(){var e=o.c.create(),t=o.e.create(),n=o.f.fromValues(1,0,0),i=o.f.fromValues(0,1,0),r=o.f.fromValues(0,0,1),a=o.f.create();return function(s){var u=this._editLineOrigin,l=this._editLineDirection;o.e.set(t,s.canvasX,s.canvasY),o.e.sub(t,t,u);var c=o.e.dot(t,l);if(this._debugNode){var h=u[0],d=u[1];this.drawLineCanvasDebug(h,d,h+l[0]*c,d+l[1]*c)}var f=7*c/Math.min(this._canvas.clientWidth,this._canvas.clientHeight);f%=2*Math.PI;var p=this._hoverNode._nbAxis;0===p?o.c.fromRotation(e,-f,n):1===p?o.c.fromRotation(e,-f,i):2===p&&o.c.fromRotation(e,-f,r),this._showAngle.getOrCreateStateSet().getUniform("uAngle").setFloat(0===p?-f:f),this._rotateInLocal||(o.c.mul(e,this._editInvWorldScaleRot,e),o.c.mul(e,e,this._editWorldScaleRot));var g=this._attachedNode.getMatrix();o.c.translate(g,this._editLocal,this._pivotOffset),o.c.mul(g,g,e),o.c.translate(g,g,o.f.negate(a,this._pivotOffset)),this._attachedNode.dirtyBound()}}(),updateTranslateEdit:function(){var e=o.e.create(),t=o.f.create();return function(n){var i=this._editLineOrigin,r=this._editLineDirection;o.e.set(e,n.canvasX,n.canvasY),o.e.sub(e,e,i),o.e.sub(e,e,this._editOffset);var a=o.e.dot(e,r);e[0]=i[0]+r[0]*a,e[1]=i[1]+r[1]*a,this._debugNode&&this.drawLineCanvasDebug(i[0],i[1],e[0],e[1]);var s=this._viewer,u=this._canvas,l=e[0]*(s._canvasWidth/u.clientWidth),c=(u.clientHeight-e[1])*(s._canvasHeight/u.clientHeight);if(this._lsi.reset(),this._lsi.setTestPlane(!1),this._lsi.set(o.f.set(this._origIntersect,l,c,0),o.f.set(this._dstIntersect,l,c,1)),this._iv.reset(),this._iv.setTraversalMask(this._hoverNode.getNodeMask()),o.c.copy(this.getMatrix(),this._editWorldTrans),this.setOnlyGizmoPicking(),this._viewer._camera.accept(this._iv),this.setOnlyScenePicking(),this._translateInLocal){o.c.getScale(t,this._editInvWorldScaleRot);var h=this._lsi.getTranslateDistance();o.f.mul(t,t,h)}else o.f.transformMat4(t,this._lsi.getTranslateDistance(),this._editInvWorldScaleRot);o.c.translate(this._attachedNode.getMatrix(),this._editLocal,t),this._attachedNode.dirtyBound()}}(),updatePlaneEdit:function(){var e=o.e.create(),t=o.f.create();return function(n){o.e.set(e,n.canvasX,n.canvasY),o.e.sub(e,e,this._editOffset);var i=this._viewer,r=this._canvas,a=e[0]*(i._canvasWidth/r.clientWidth),s=(r.clientHeight-e[1])*(i._canvasHeight/r.clientHeight);if(this._lsi.reset(),this._lsi.setTestPlane(!0),this._lsi.set(o.f.set(this._origIntersect,a,s,0),o.f.set(this._dstIntersect,a,s,1)),this._iv.reset(),this._iv.setTraversalMask(this._hoverNode.getNodeMask()),o.c.copy(this.getMatrix(),this._editWorldTrans),this.setOnlyGizmoPicking(),this._viewer._camera.accept(this._iv),this.setOnlyScenePicking(),this._translateInLocal){o.c.getScale(t,this._editInvWorldScaleRot);var u=this._lsi.getTranslateDistance();o.f.mul(t,t,u)}else o.f.transformMat4(t,this._lsi.getTranslateDistance(),this._editInvWorldScaleRot);o.c.translate(this._attachedNode.getMatrix(),this._editLocal,t),this._attachedNode.dirtyBound()}}()}),"osgUtil","NodeGizmo");var Kn=Xn,Qn=function(){ct.a.Intersection.call(this),this._localIntersectionNormal=o.f.clone(o.f.ONE),this._i1=-1,this._i2=-1,this._i3=-1,this._r1=0,this._r2=0,this._r3=0},Jn=function(){ct.a.apply(this),this._center=void 0,this._radius=0};a.a.createPrototypeObject(Jn,a.a.objectInherit(ct.a.prototype,{set:function(e,t){this._center=e,this._radius=t},enter:function(e){for(var t=this._radius*this._radius,n=0,i=e.getMin(),r=e.getMax(),a=0,o=0;o<3;o++)this._center[o]<i[o]?n+=(a=this._center[o]-i[o])*a:this._center[o]>r[o]&&(n+=(a=this._center[o]-r[o])*a);return n<=t},intersectPoint:function(e,t){var n=o.f.sqrDist(e,this._center);if(!(n>this._radius*this._radius)){var i=this.initIntersection(new Qn);i._i1=t,i._r1=1,o.f.copy(i._localIntersectionPoint,e),i._ratio=Math.sqrt(n)/this._radius}},intersectLine:function(){var e=o.f.create(),t=o.f.create();return function(n,i,r,a){o.f.sub(e,this._center,n),o.f.sub(t,i,n);var s=o.f.dot(e,t)/o.f.sqrLen(t),u=1;if(!((u=s<0?o.f.sqrLen(e):s>1?o.f.sqrDist(this._center,i):o.f.sqrLen(o.f.scaleAndAdd(e,e,t,-s)))>this._radius*this._radius)){var l=this.initIntersection(new Qn);l._i1=r,l._i2=a,l._r1=1-s,l._r2=s,o.f.scaleAndAdd(l._localIntersectionPoint,n,t,s),l._ratio=Math.sqrt(u)/this._radius}}}(),intersectTriangle:function(){var e=o.f.create(),t=o.f.create(),n=o.f.create();return function(i,r,a,s,u,l){if(!this._limitOneIntersection||!this._hit){o.f.sub(e,r,i),o.f.sub(t,a,i);var c=o.f.sqrLen(e),h=o.f.dot(e,t),d=o.f.sqrLen(t);o.f.sub(n,i,this._center);var f=o.f.dot(n,e),p=o.f.dot(n,t),g=o.f.sqrLen(n),m=Math.abs(c*d-h*h);if(!(m<1e-10)){var v,_,b,S,y,x=h*p-d*f,C=h*f-c*p,w=4;if(x+C<=m)if(x<0)C<0?(w=4,f<0?(C=0,-f>=c?(x=1,v=c+2*f+g):v=f*(x=-f/c)+g):(x=0,p>=0?(C=0,v=g):-p>=d?(C=1,v=d+2*p+g):v=p*(C=-p/d)+g)):(w=3,x=0,p>=0?(C=0,v=g):-p>=d?(C=1,v=d+2*p+g):v=p*(C=-p/d)+g);else if(C<0)w=5,C=0,f>=0?(x=0,v=g):-f>=c?(x=1,v=c+2*f+g):v=f*(x=-f/c)+g;else{w=0;var T=1/m;v=(x*=T)*(c*x+h*(C*=T)+2*f)+C*(h*x+d*C+2*p)+g}else x<0?(w=2,(b=d+p)>(_=h+f)?(S=b-_)>=(y=c-2*h+d)?(x=1,C=0,v=c+2*f+g):v=(x=S/y)*(c*x+h*(C=1-x)+2*f)+C*(h*x+d*C+2*p)+g:(x=0,b<=0?(C=1,v=d+2*p+g):p>=0?(C=0,v=g):v=p*(C=-p/d)+g)):C<0?(w=6,(b=c+f)>(_=h+p)?(S=b-_)>=(y=c-2*h+d)?(C=1,x=0,v=d+2*p+g):v=(x=1-(C=S/y))*(c*x+h*C+2*f)+C*(h*x+d*C+2*p)+g:(C=0,b<=0?(x=1,v=c+2*f+g):f>=0?(x=0,v=g):v=f*(x=-f/c)+g)):(w=1,(S=d+p-h-f)<=0?(x=0,C=1,v=d+2*p+g):S>=(y=c-2*h+d)?(x=1,C=0,v=c+2*f+g):v=(x=S/y)*(c*x+h*(C=1-x)+2*f)+C*(h*x+d*C+2*p)+g);if(!(v>this._radius*this._radius)){var M=o.f.create(),E=this.initIntersection(new Qn);E._i1=s,E._i2=u,E._i3=l,E._r1=1-x-C,E._r2=x,E._r3=C;var A=E._localIntersectionPoint;o.f.scaleAndAdd(A,o.f.scaleAndAdd(A,i,e,x),t,C),o.f.cross(E._localIntersectionNormal,e,t),o.f.normalize(M,E._localIntersectionNormal),E._ratio=Math.sqrt(v)/this._radius,E._zone=w}}}}}()}),"osgUtil","SphereIntersectFunctor");var Zn=Jn,$n=function(){lt.a.call(this),this._center=o.f.create(),this._iCenter=o.f.create(),this._radius=1,this._iRadius=1};a.a.createPrototypeObject($n,a.a.objectInherit(lt.a.prototype,{set:function(e,t){o.f.copy(this._center,e),o.f.copy(this._iCenter,e),this._radius=this._iRadius=t,this.reset()},setCenter:function(e){o.f.copy(this._center,e),o.f.copy(this._iCenter,e)},setRadius:function(e){this._radius=this._iRadius=e},intersectNode:function(e){return this.intersectBoundingSphere(e.getBoundingSphere())},intersectBoundingSphere:function(e){if(!e.valid())return!1;var t=this._iRadius+e.radius();return o.f.sqrDist(e.center(),this._iCenter)<=t*t},intersect:function(){var e=new Zn;return function(t,n){e.setGeometry(n),e.setIntersectionVisitor(t),e.setIntersector(this),e.set(this._iCenter,this._iRadius);var i=n.getShape();i?i.intersect(e,i.getNodes()[0]):(n.computeTransformedVertices&&e.setVertices(n.computeTransformedVertices()),e.apply(n)),e.reset()}}(),setCurrentTransformation:function(){var e=o.f.create();return function(t){o.c.invert(t,t),o.f.transformMat4(this._iCenter,this._center,t),o.c.getScale(e,t);var n=e[0],i=e[1],r=e[2],a=n>i?n>r?n:r:i>r?i:r;this._iRadius=this._radius*a}}()}),"osgUtil","SphereIntersector");var ei=$n,ti=function(){j.a.call(this),this._T=void 0,this._B=void 0,this._N=void 0,this._texCoordUnit=0};a.a.createPrototypeObject(ti,a.a.objectInherit(j.a.prototype,{apply:function(e){e.getTypeID()===Re.a.getTypeID()?this.generate(e,this._texCoordUnit):this.traverse(e)},setTexCoordUnit:function(e){this._texCoordUnit=e},computePrimitiveSet:function(e,t){if(t.getIndices){var n,i=t.getNumIndices(),r=e.getAttributes().Vertex,a=e.getAttributes().Normal,o=e.getAttributes()["TexCoord"+this._texCoordUnit];if(t.getMode()===Mn.a.TRIANGLES)for(n=0;n<i;n+=3)this.compute(t,r,a,o,n,n+1,n+2);else if(t.getMode()===Mn.a.TRIANGLE_STRIP)for(n=0;n<i-2;++n)n%2==0?this.compute(t,r,a,o,n,n+1,n+2):this.compute(t,r,a,o,n+1,n,n+2)}},generate:function(e,t){if(this._texCoordUnit=t,void 0===this._texCoordUnit&&(this._texCoordUnit=0),e.getAttributes()["TexCoord"+this._texCoordUnit]){var n=e.getAttributes().Vertex.getElements().length;this._T=new a.a.Float32Array(n),this._B=new a.a.Float32Array(n),this._N=new a.a.Float32Array(n),e.getPrimitiveSetList().forEach(function(t){this.computePrimitiveSet(e,t)},this);for(var i=n/3,r=new a.a.Float32Array(4*i),s=o.f.create(),u=o.f.create(),l=o.f.create(),c=0;c<i;c++){var h=this._T.subarray(3*c,3*c+3),d=this._N.subarray(3*c,3*c+3),f=this._B.subarray(3*c,3*c+3);o.f.normalize(d,d);var p=o.f.dot(d,h);o.f.scale(u,d,p),o.f.sub(s,h,u),o.f.normalize(l,s),o.f.cross(s,d,h);var g=o.f.dot(s,f);g=g<0?-1:0,r[4*c]=l[0],r[4*c+1]=l[1],r[4*c+2]=l[2],r[4*c+3]=g}e.getAttributes().Normal.setElements(this._N),e.getAttributes().Tangent=new z.a("ARRAY_BUFFER",r,4)}},compute:function(e,t,n,i,r,a,s){var u,l,c=e.index(r),h=e.index(a),d=e.index(s),f=t.getElements().subarray(3*c,3*c+3),p=t.getElements().subarray(3*h,3*h+3),g=t.getElements().subarray(3*d,3*d+3),m=n.getElements().subarray(3*c,3*c+3),v=n.getElements().subarray(3*h,3*h+3),_=n.getElements().subarray(3*d,3*d+3),b=i.getElements().subarray(2*c,2*c+2),S=i.getElements().subarray(2*h,2*h+2),y=i.getElements().subarray(2*d,2*d+2),x=o.f.create(),C=o.f.create(),w=o.f.create(),T=o.f.create(),M=o.f.create(),E=o.f.create(),A=o.f.create(),O=o.f.create(),R=o.f.create();o.f.set(O,p[0]-f[0],S[0]-b[0],S[1]-b[1]),o.f.set(R,g[0]-f[0],y[0]-b[0],y[1]-b[1]),o.f.cross(x,O,R),0!==x[0]&&(o.f.normalize(x,x),l=-x[1]/x[0],u=-x[2]/x[0],M[0]+=l,C[0]+=u,E[0]+=l,w[0]+=u,A[0]+=l,T[0]+=u),o.f.set(O,p[1]-f[1],S[0]-b[0],S[1]-b[1]),o.f.set(R,g[1]-f[1],y[0]-b[0],y[1]-b[1]),o.f.cross(x,O,R),0!==x[0]&&(o.f.normalize(x,x),l=-x[1]/x[0],u=-x[2]/x[0],M[1]+=l,C[1]+=u,E[1]+=l,w[1]+=u,A[1]+=l,T[1]+=u),o.f.set(O,p[2]-f[2],S[0]-b[0],S[1]-b[1]),o.f.set(R,g[2]-f[2],y[0]-b[0],y[1]-b[1]),o.f.cross(x,O,R),0!==x[0]&&(o.f.normalize(x,x),l=-x[1]/x[0],u=-x[2]/x[0],M[2]+=l,C[2]+=u,E[2]+=l,w[2]+=u,A[2]+=l,T[2]+=u);var P,I,N,L=o.f.create(),k=o.f.create();o.f.cross(L,m,M),o.f.cross(k,L,m),P=this._T.subarray(3*c,3*c+3),o.f.add(P,k,P),o.f.cross(L,C,m),o.f.cross(k,m,L),I=this._B.subarray(3*c,3*c+3),o.f.add(I,k,I),o.f.cross(L,v,E),o.f.cross(k,L,v),P=this._T.subarray(3*h,3*h+3),o.f.add(P,k,P),o.f.cross(L,w,v),o.f.cross(k,v,L),I=this._B.subarray(3*h,3*h+3),o.f.add(I,k,I),o.f.cross(L,_,A),o.f.cross(k,L,_),P=this._T.subarray(3*d,3*d+3),o.f.add(P,k,P),o.f.cross(L,T,_),o.f.cross(k,_,L),I=this._B.subarray(3*d,3*d+3),o.f.add(I,k,I),N=this._N.subarray(3*c,3*c+3),o.f.add(N,m,N),N=this._N.subarray(3*h,3*h+3),o.f.add(N,v,N),N=this._N.subarray(3*d,3*d+3),o.f.add(N,_,N)}}),"osgUtil","TangentSpaceGenerator");var ni=ti,ii=n("Ep1f"),ri={},ai=function(e,t,n,i,r){this._viewer=e,this._rttScene=t,this._hmdConfig=n,this._root=i,this._canvas=r,this._width=r.width,this._height=r.height};ai.prototype={update:function(){var e=this._canvas,t=e.width,n=e.height;if(t!==this._width||n!==this._height){this._root.removeChildren();var i=this._hmdConfig;i&&i.isCardboard&&(i.hResolution=t,i.vResolution=n),this._width=t,this._height=n,ri.createScene(this._viewer,this._rttScene,i,this._root)}return!0}};var oi=function(e,t){this._rootView=e,this._offsetView=t};oi.prototype={update:function(e){var t=e.getViewMatrix();return o.c.mul(t,this._offsetView,this._rootView),!0}};var si=function(e){var t=new Ue.default;return t.setTextureSize(e[0],e[1]),t.setMinFilter("LINEAR"),t.setMagFilter("LINEAR"),t},ui=function(e,t,n,i,r,a){var s=new gn.a,u=t[0],l=t[1],c=n[0],h=n[1];!0===i?e?s.setViewport(new vn.a(0,0,c/2,h)):s.setViewport(new vn.a(c/2,0,c/2,h)):e?s.setViewport(new vn.a(.5*c-u,.5*(h-l),u,l)):s.setViewport(new vn.a(.5*c,.5*(h-l),u,l)),o.c.ortho(s.getProjectionMatrix(),-.5,.5,-.5,.5,-5,5),s.setRenderOrder(gn.a.NESTED_RENDER,0),s.setReferenceFrame(ii.a.ABSOLUTE_RF);var d=s.getOrCreateStateSet();return d.setTextureAttributeAndModes(0,r),d.setAttributeAndModes(function(){var e=["uniform vec2 uScale;","uniform vec2 uScaleIn;","uniform vec2 uLensCenter;","uniform vec4 uHmdWarpParam;","uniform vec4 uChromAbParam;","uniform sampler2D Texture0;","varying vec2 vTexCoord0;","void main(void) {","  vec2 uv = (vTexCoord0 * 2.0) - 1.0;","  vec2 theta = (uv - uLensCenter) * uScaleIn;","  float rSq = theta.x * theta.x + theta.y * theta.y;","  vec2 rvector = theta * (uHmdWarpParam.x + uHmdWarpParam.y * rSq + uHmdWarpParam.z * rSq * rSq + uHmdWarpParam.w * rSq * rSq * rSq);","  vec2 rBlue = rvector * (uChromAbParam.z + uChromAbParam.w * rSq);","  vec2 tcBlue = (uLensCenter + uScale * rBlue);","  tcBlue = (tcBlue + 1.0) * 0.5;","  if (any(bvec2(clamp(tcBlue, vec2(0.0, 0.0), vec2(1.0, 1.0)) - tcBlue))) {","    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","    return;","  }","  vec2 tcGreen = uLensCenter + uScale * rvector;","  tcGreen = (tcGreen + 1.0) * 0.5;","  vec2 rRed = rvector * (uChromAbParam.x + uChromAbParam.y * rSq);","  vec2 tcRed = uLensCenter + uScale * rRed;","  tcRed = (tcRed + 1.0) * 0.5;","  gl_FragColor = vec4(texture2D(Texture0, tcRed).r, texture2D(Texture0, tcGreen).g, texture2D(Texture0, tcBlue).b, 1);","}",""].join("\n");return new _n.a(new bn.a(bn.a.VERTEX_SHADER,["attribute vec3 Vertex;","varying vec2 vTexCoord0;","void main(void) {","  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);","  vTexCoord0 = Vertex.xy;","}","","#define SHADER_NAME VRpostProcessing",""].join("\n")),new bn.a(bn.a.FRAGMENT_SHADER,e))}()),d.addUniform(fn.a.createFloat2(a.scale,"uScale")),d.addUniform(fn.a.createFloat2(a.scaleIn,"uScaleIn")),d.addUniform(fn.a.createFloat2(e?a.lensCenterLeft:a.lensCenterRight,"uLensCenter")),d.addUniform(fn.a.createFloat4(a.hmdWarpParam,"uHmdWarpParam")),d.addUniform(fn.a.createFloat4(a.chromAbParam,"uChromAbParam")),s},li=function(e,t){var n=new gn.a;return n.setName("rtt camera"),n.setViewport(new vn.a(0,0,e.getWidth(),e.getHeight())),n.setProjectionMatrix(t),n.setClearColor(o.g.fromValues(.3,.3,.3,0)),n.setRenderOrder(gn.a.POST_RENDER,0),n.attachTexture(mn.a.COLOR_ATTACHMENT0,e),n.attachRenderBuffer(mn.a.DEPTH_ATTACHMENT,mn.a.DEPTH_COMPONENT16),n.setReferenceFrame(ii.a.ABSOLUTE_RF),n};ri.createScene=function(e,t,n,i,r){var a=ri.getDefaultConfig(n),s=o.e.fromValues(.5*a.hResolution,a.vResolution),u=o.e.fromValues(.5*a.hResolution,a.vResolution),l=e.getCamera().getViewport(),c=o.e.fromValues(l.width(),l.height()),h=e.getGraphicContext().canvas;a.isCardboard&&(c[0]=h.width,c[1]=h.height);var d={},f={};!function(e,t,n,i){var r=t.hResolution/(2*t.vResolution),a=-1-4*(.25*t.hScreenSize-.5*t.lensSeparationDistance)/t.hScreenSize,s=t.distortionK[0]+t.distortionK[1]*Math.pow(a,2)+t.distortionK[2]*Math.pow(a,4)+t.distortionK[3]*Math.pow(a,6),u=180/Math.PI*2*Math.atan2(t.vScreenSize*s,2*t.eyeToScreenDistance),l=o.c.perspective(o.c.create(),Math.PI/180*u,r,.3,1e4),c=4*(.25*t.hScreenSize-.5*t.interpupillaryDistance)/t.hScreenSize,h=4*(.25*t.hScreenSize-.5*t.lensSeparationDistance)/t.hScreenSize,d=o.c.create(),f=o.c.create();i.projectionLeft=o.c.mul(d,o.c.fromTranslation(d,o.f.fromValues(c,0,0)),l),i.projectionRight=o.c.mul(f,o.c.fromTranslation(f,o.f.fromValues(-c,0,0)),l),i.viewLeft=o.c.fromTranslation(o.c.create(),o.f.fromValues(e*t.interpupillaryDistance*.5,0,0)),i.viewRight=o.c.fromTranslation(o.c.create(),o.f.fromValues(-e*t.interpupillaryDistance*.5,0,0)),n.lensCenterLeft=o.e.fromValues(h,0),n.lensCenterRight=o.e.fromValues(-h,0),n.hmdWarpParam=t.distortionK,n.chromAbParam=t.chromaAbParameter,n.scaleIn=o.e.fromValues(1,1/r),n.scale=o.e.fromValues(1/s,1*r/s)}(void 0!==r?r:1,a,d,f);var p=e.getCamera().getViewMatrix(),g=i||new Ge.a;g.addUpdateCallback(new ai(e,t,n,g,h));var m=si(s),v=li(m,f.projectionLeft),_=ui(!0,u,c,a.isCardboard,m,d);v.addUpdateCallback(new oi(p,f.viewLeft));var b=si(s),S=li(b,f.projectionRight),y=ui(!1,u,c,a.isCardboard,b,d);return S.addUpdateCallback(new oi(p,f.viewRight)),v.addChild(t),S.addChild(t),_.addChild(Be.a.createTexturedFullScreenFakeQuadGeometry()),y.addChild(Be.a.createTexturedFullScreenFakeQuadGeometry()),g.addChild(v),g.addChild(S),g.addChild(_),g.addChild(y),g},ri.getDefaultConfig=function(e){var t={hResolution:1920,vResolution:1080,hScreenSize:.1296,vScreenSize:.0729,interpupillaryDistance:.064,lensSeparationDistance:.0635,eyeToScreenDistance:.04,distortionK:o.g.fromValues(1,.22,.13,.02),chromaAbParameter:o.g.fromValues(.996,-.004,1.014,0),isCardboard:!1};return 2===e||void 0===e?t:1===e?(t.hResolution=1280,t.vResolution=800,t.hScreenSize=.14976,t.vScreenSize=.0936,t.lensSeparationDistance=.064,t.eyeToScreenDistance=.041,t.distortionK=o.g.fromValues(1,.22,.24,0),t):(void 0!==e.hResolution&&(t.hResolution=e.hResolution),void 0!==e.vResolution&&(t.vResolution=e.vResolution),void 0!==e.hScreenSize&&(t.hScreenSize=e.hScreenSize),void 0!==e.vScreenSize&&(t.vScreenSize=e.vScreenSize),void 0!==e.interpupillaryDistance&&(t.interpupillaryDistance=e.interpupillaryDistance),void 0!==e.lensSeparationDistance&&(t.lensSeparationDistance=e.lensSeparationDistance),void 0!==e.eyeToScreenDistance&&(t.eyeToScreenDistance=e.eyeToScreenDistance),void 0!==e.distortionK&&(t.distortionK=e.distortionK),void 0!==e.chromaAbParameter&&(t.chromaAbParameter=e.chromaAbParameter),void 0!==e.isCardboard&&(t.isCardboard=e.isCardboard),t)};var ci=ri,hi=function(e,t){this._rootView=e,this._offsetView=t};hi.prototype={update:function(e){var t=e.getViewMatrix();return o.c.mul(t,this._offsetView,this._rootView),!0}};var di=function(e){var t=new Ue.default;return t.setTextureSize(e.width,e.height),t.setMinFilter("LINEAR"),t.setMagFilter("LINEAR"),t},fi=function(e,t,n){var i=new gn.a;i.setViewport(n),i.setRenderOrder(gn.a.NESTED_RENDER,0),i.setReferenceFrame(ii.a.ABSOLUTE_RF),o.c.ortho(i.getProjectionMatrix(),0,1,0,1,-5,5);var r=i.getOrCreateStateSet();return r.addUniform(fn.a.createInt(0,"TextureLeft")),r.addUniform(fn.a.createInt(1,"TextureRight")),r.setTextureAttributeAndModes(0,e),r.setTextureAttributeAndModes(1,t),r.setAttributeAndModes(function(){var e=["varying vec2 vTexCoord0;","uniform sampler2D TextureLeft;","uniform sampler2D TextureRight;","void main() {","   if (vTexCoord0.x < 0.5)","       gl_FragColor = texture2D(TextureLeft, vec2(vTexCoord0.x * 2.0, vTexCoord0.y));","   else","       gl_FragColor = texture2D(TextureRight, vec2(vTexCoord0.x * 2.0 - 1.0, vTexCoord0.y));","}"].join("\n");return new _n.a(new bn.a(bn.a.VERTEX_SHADER,["attribute vec3 Vertex;","varying vec2 vTexCoord0;","void main(void) {","  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);","  vTexCoord0 = Vertex.xy;","}","","#define SHADER_NAME VRpostProcessing",""].join("\n")),new bn.a(bn.a.FRAGMENT_SHADER,e))}()),i.addChild(Be.a.createTexturedFullScreenFakeQuadGeometry()),i},pi=function(e,t){var n=new gn.a;return n.setName("rtt camera"),n.setViewport(new vn.a(0,0,e.getWidth(),e.getHeight())),n.setProjectionMatrix(t),n.setClearColor(o.g.fromValues(.3,.3,.3,0)),n.setRenderOrder(gn.a.POST_RENDER,0),n.attachTexture(mn.a.COLOR_ATTACHMENT0,e),n.attachRenderBuffer(mn.a.DEPTH_ATTACHMENT,mn.a.DEPTH_COMPONENT16),n.setReferenceFrame(ii.a.ABSOLUTE_RF),n},gi={createScene:function(e,t,n,i,r){var a=i||new Ge.a;return n.requestAnimationFrame(function(){var i=void 0!==r?r:1,s=n.getEyeParameters("left"),u=n.getEyeParameters("right"),l=new window.VRFrameData;n.getFrameData(l);var c=o.c.fromTranslation(o.c.create(),o.f.fromValues(-i*s.offset[0],s.offset[1],s.offset[2])),h=o.c.fromTranslation(o.c.create(),o.f.fromValues(-i*u.offset[0],u.offset[1],u.offset[2])),d={width:Math.max(s.renderWidth,u.renderWidth),height:Math.max(s.renderHeight,u.renderHeight)},f=di(d),p=di(d),g=pi(f,l.leftProjectionMatrix),m=pi(p,l.rightProjectionMatrix),v=e.getCamera().getViewMatrix();g.addUpdateCallback(new hi(v,c)),m.addUpdateCallback(new hi(v,h));var _=fi(f,p,e.getCamera().getViewport());g.addChild(t),m.addChild(t),a.addChild(g),a.addChild(m),a.addChild(_)}),a}},mi=gi,vi={};vi.ComposerPostProcess=xn,a.a.objectMix(vi,wn),vi.DelayInterpolator=Nt,vi.DisplayNormalVisitor=On,vi.DisplayGeometryVisitor=kn,vi.DisplayGraph=Dn.a,vi.IntersectFunctor=ct.a,vi.Intersector=lt.a,vi.IntersectionVisitor=at.a,vi.LineSegmentIntersector=ot.a,vi.LineSegmentIntersectFunctor=Fn.a,vi.NodeGizmo=Kn,vi.GizmoGeometry=Gn,vi.WebVRCustom=ci,vi.PolytopeIntersector=gt,vi.PolytopeIntersectFunctor=dt,vi.SphereIntersector=ei,vi.TangentSpaceGenerator=ni,vi.WebVR=mi,vi.NO_LIMIT=Lt.a.NO_LIMIT,vi.LIMIT_ONE_PER_DRAWABLE=Lt.a.LIMIT_ONE_PER_DRAWABLE,vi.LIMIT_ONE=Lt.a.LIMIT_ONE,vi.POINT_PRIMITIVES=Lt.a.POINT_PRIMITIVES,vi.LINE_PRIMITIVES=Lt.a.LINE_PRIMITIVES,vi.TRIANGLE_PRIMITIVES=Lt.a.TRIANGLE_PRIMITIVES,vi.ALL_PRIMITIVES=Lt.a.ALL_PRIMITIVES;var _i=vi,bi=n("UwbM"),Si=n("Gc7n"),yi=n("WDex"),xi=n("zP/P"),Ci=n("FPi9"),wi=n("GRG7"),Ti=n("RwmW"),Mi=n("kKFa"),Ei=n("NuLH"),Ai=function(){var e=function(e){window.console&&window.console.error?window.console.error(e):function(e){window.console&&window.console.log&&window.console.log(e)}(e)},t={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},bindBuffer:{2:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}},bufferData:{3:{0:!0,2:!0},4:{0:!0,2:!0},5:{0:!0,2:!0}},bufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},copyBufferSubData:{5:{0:!0,1:!0}},getBufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},blitFramebuffer:{10:{8:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]},9:!0}},framebufferTextureLayer:{5:{0:!0,1:!0}},invalidateFramebuffer:{2:{0:!0}},invalidateSubFramebuffer:{6:{0:!0}},readBuffer:{1:{0:!0}},getInternalformatParameter:{3:{0:!0,1:!0,2:!0}},renderbufferStorageMultisample:{5:{0:!0,2:!0}},texStorage2D:{5:{0:!0,2:!0}},texStorage3D:{6:{0:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0},10:{0:!0,2:!0,6:!0,7:!0}},texImage3D:{10:{0:!0,2:!0,7:!0,8:!0},11:{0:!0,2:!0,7:!0,8:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0},10:{0:!0,6:!0,7:!0}},texSubImage3D:{11:{0:!0,8:!0,9:!0},12:{0:!0,8:!0,9:!0}},copyTexSubImage3D:{9:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0},8:{0:!0,2:!0},9:{0:!0,2:!0}},compressedTexImage3D:{8:{0:!0,2:!0},9:{0:!0,2:!0},10:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0},9:{0:!0,6:!0},10:{0:!0,6:!0}},compressedTexSubImage3D:{10:{0:!0,8:!0},11:{0:!0,8:!0},12:{0:!0,8:!0}},vertexAttribIPointer:{5:{2:!0}},drawArraysInstanced:{4:{0:!0}},drawElementsInstanced:{5:{0:!0,2:!0}},drawRangeElements:{6:{0:!0,4:!0}},readPixels:{7:{4:!0,5:!0},8:{4:!0,5:!0}},clearBufferfv:{3:{0:!0},4:{0:!0}},clearBufferiv:{3:{0:!0},4:{0:!0}},clearBufferuiv:{3:{0:!0},4:{0:!0}},clearBufferfi:{4:{0:!0}},beginQuery:{2:{0:!0}},endQuery:{1:{0:!0}},getQuery:{2:{0:!0,1:!0}},getQueryParameter:{2:{1:!0}},samplerParameteri:{3:{1:!0,2:!0}},samplerParameterf:{3:{1:!0}},getSamplerParameter:{2:{1:!0}},fenceSync:{2:{0:!0,1:{enumBitwiseOr:[]}}},clientWaitSync:{3:{1:{enumBitwiseOr:["SYNC_FLUSH_COMMANDS_BIT"]}}},waitSync:{3:{1:{enumBitwiseOr:[]}}},getSyncParameter:{2:{1:!0}},bindTransformFeedback:{2:{0:!0}},beginTransformFeedback:{1:{0:!0}},transformFeedbackVaryings:{3:{2:!0}},bindBufferBase:{3:{0:!0}},bindBufferRange:{5:{0:!0}},getIndexedParameter:{2:{0:!0}},getActiveUniforms:{3:{2:!0}},getActiveUniformBlockParameter:{3:{2:!0}}},n=null,i=null;function r(e){if(null==n)for(var t in n={},i={},e)"number"==typeof e[t]&&(n[e[t]]=t,i[t]=e[t])}function a(){if(null==n)throw"WebGLDebugUtils.init(ctx) not called"}function o(e){a();var t=n[e];return void 0!==t?"gl."+t:"/*UNKNOWN WebGL ENUM*/ 0x"+e.toString(16)}function s(e,n,r,a){var s;if(void 0!==(s=t[e])&&(void 0!==(s=s[n])&&s[r])){if("object"==typeof s[r]&&void 0!==s[r].enumBitwiseOr){for(var u=s[r].enumBitwiseOr,l=0,c=[],h=0;h<u.length;++h){var d=i[u[h]];0!=(a&d)&&(l|=d,c.push(o(d)))}return l===a?c.join(" | "):o(a)}return o(a)}return null===a?"null":void 0===a?"undefined":a.toString()}function u(e,t,n){e.__defineGetter__(n,function(){return t[n]}),e.__defineSetter__(n,function(e){t[n]=e})}function l(e){var t=!!e.createTransformFeedback;t&&e.bindVertexArray(null);var n=e.getParameter(e.MAX_VERTEX_ATTRIBS),i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i);for(var r=0;r<n;++r)e.disableVertexAttribArray(r),e.vertexAttribPointer(r,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(r,0),t&&e.vertexAttribDivisor(r,0);e.deleteBuffer(i);var a=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);for(r=0;r<a;++r)e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null),t&&(e.bindTexture(e.TEXTURE_2D_ARRAY,null),e.bindTexture(e.TEXTURE_3D,null),e.bindSampler(r,null));if(e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),t){e.drawBuffers([e.BACK]),e.readBuffer(e.BACK),e.bindBuffer(e.COPY_READ_BUFFER,null),e.bindBuffer(e.COPY_WRITE_BUFFER,null),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),e.bindBuffer(e.PIXEL_UNPACK_BUFFER,null);var o=e.getParameter(e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS);for(r=0;r<o;++r)e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,r,null);var s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);for(r=0;r<s;++r)e.bindBufferBase(e.UNIFORM_BUFFER,r,null);e.disable(e.RASTERIZER_DISCARD),e.pixelStorei(e.UNPACK_IMAGE_HEIGHT,0),e.pixelStorei(e.UNPACK_SKIP_IMAGES,0),e.pixelStorei(e.UNPACK_ROW_LENGTH,0),e.pixelStorei(e.UNPACK_SKIP_ROWS,0),e.pixelStorei(e.UNPACK_SKIP_PIXELS,0),e.pixelStorei(e.PACK_ROW_LENGTH,0),e.pixelStorei(e.PACK_SKIP_ROWS,0),e.pixelStorei(e.PACK_SKIP_PIXELS,0),e.hint(e.FRAGMENT_SHADER_DERIVATIVE_HINT,e.DONT_CARE)}for(;e.getError(););}return{init:r,mightBeEnum:function(e){return a(),void 0!==n[e]},glEnumToString:o,glFunctionArgToString:s,glFunctionArgsToString:function(e,t){for(var n="",i=t.length,r=0;r<i;++r)n+=(0==r?"":", ")+s(e,i,r,t[r]);return n},makeDebugContext:function t(n,i,a,l){l=l||n,r(n),i=i||function(t,n,i){for(var r="",a=i.length,u=0;u<a;++u)r+=(0==u?"":", ")+s(n,a,u,i[u]);e("WebGL error "+o(t)+" in "+n+"("+r+")")};var c={};function h(e,t){return function(){a&&a(t,arguments);var n=e[t].apply(e,arguments),r=l.getError();return 0!=r&&(c[r]=!0,i(r,t,arguments)),n}}var d={};for(var f in n)if("function"==typeof n[f])if("getExtension"!=f)d[f]=h(n,f);else{var p=h(n,f);d[f]=function(){var e=p.apply(n,arguments);return e?t(e,i,a,l):null}}else u(d,n,f);return d.getError=function(){for(var e in c)if(c.hasOwnProperty(e)&&c[e])return c[e]=!1,e;return n.NO_ERROR},d},makeLostContextSimulatingCanvas:function(e){var t,n,i=[],r=[],a={},o=1,s=!1,c=[],h=0,d=0,f=!1,p=0,g={};function m(e){return"function"==typeof e?e:function(t){e.handleEvent(t)}}e.getContext=function(i){return function(){var r=i.apply(e,arguments);if(r instanceof WebGLRenderingContext||window.WebGL2RenderingContext&&r instanceof WebGL2RenderingContext){if(r!=t){if(t)throw"got different context";n=window.WebGL2RenderingContext&&r instanceof WebGL2RenderingContext,a=function(e){for(var i in e)"function"==typeof e[i]?a[i]=S(e,i):u(a,e,i);a.getError=function(){if(b(),!s)for(;e=t.getError();)g[e]=!0;for(var e in g)if(g[e])return delete g[e],e;return a.NO_ERROR};var r=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"];n&&r.push("createQuery","createSampler","fenceSync","createTransformFeedback","createVertexArray");for(var l=0;l<r.length;++l){var h=r[l];a[h]=function(t){return function(){if(b(),s)return null;var n=t.apply(e,arguments);return n.__webglDebugContextLostId__=o,c.push(n),n}}(e[h])}var d=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];n&&d.push("getInternalformatParameter","getQuery","getQueryParameter","getSamplerParameter","getSyncParameter","getTransformFeedbackVarying","getIndexedParameter","getUniformIndices","getActiveUniforms","getActiveUniformBlockParameter","getActiveUniformBlockName");for(var l=0;l<d.length;++l){var h=d[l];a[h]=function(t){return function(){return b(),s?null:t.apply(e,arguments)}}(a[h])}var f=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];n&&f.push("isQuery","isSampler","isSync","isTransformFeedback","isVertexArray");for(var l=0;l<f.length;++l){var h=f[l];a[h]=function(t){return function(){return b(),!s&&t.apply(e,arguments)}}(a[h])}return a.checkFramebufferStatus=function(t){return function(){return b(),s?a.FRAMEBUFFER_UNSUPPORTED:t.apply(e,arguments)}}(a.checkFramebufferStatus),a.getAttribLocation=function(t){return function(){return b(),s?-1:t.apply(e,arguments)}}(a.getAttribLocation),a.getVertexAttribOffset=function(t){return function(){return b(),s?0:t.apply(e,arguments)}}(a.getVertexAttribOffset),a.isContextLost=function(){return s},n&&(a.getFragDataLocation=function(t){return function(){return b(),s?-1:t.apply(e,arguments)}}(a.getFragDataLocation),a.clientWaitSync=function(t){return function(){return b(),s?a.WAIT_FAILED:t.apply(e,arguments)}}(a.clientWaitSync),a.getUniformBlockIndex=function(t){return function(){return b(),s?a.INVALID_INDEX:t.apply(e,arguments)}}(a.getUniformBlockIndex)),a}(t=r)}return a}return r}}(e.getContext);var v=function(e){i.push(m(e))},_=function(e){r.push(m(e))};function b(){++d,s||h==d&&e.loseContext()}function S(e,t){var n=e[t];return function(){if(b(),!s)return n.apply(e,arguments)}}function y(e){return{statusMessage:e,preventDefault:function(){f=!0}}}return function(e){var t=e.addEventListener;e.addEventListener=function(n,i,r){switch(n){case"webglcontextlost":v(i);break;case"webglcontextrestored":_(i);break;default:t.apply(e,arguments)}}}(e),e.loseContext=function(){if(!s){for(s=!0,h=0,++o;t.getError(););!function(){for(var e=Object.keys(g),t=0;t<e.length;++t)delete g[e[t]]}(),g[t.CONTEXT_LOST_WEBGL]=!0;var n=y("context lost"),r=i.slice();setTimeout(function(){for(var t=0;t<r.length;++t)r[t](n);p>=0&&setTimeout(function(){e.restoreContext()},p)},0)}},e.restoreContext=function(){s&&r.length&&setTimeout(function(){if(!f)throw"can not restore. webglcontestlost listener did not call event.preventDefault";!function(){for(var e=0;e<c.length;++e){var i=c[e];i instanceof WebGLBuffer?t.deleteBuffer(i):i instanceof WebGLFramebuffer?t.deleteFramebuffer(i):i instanceof WebGLProgram?t.deleteProgram(i):i instanceof WebGLRenderbuffer?t.deleteRenderbuffer(i):i instanceof WebGLShader?t.deleteShader(i):i instanceof WebGLTexture?t.deleteTexture(i):n&&(i instanceof WebGLQuery?t.deleteQuery(i):i instanceof WebGLSampler?t.deleteSampler(i):i instanceof WebGLSync?t.deleteSync(i):i instanceof WebGLTransformFeedback?t.deleteTransformFeedback(i):i instanceof WebGLVertexArrayObject&&t.deleteVertexArray(i))}}(),l(t),s=!1,d=0,f=!1;for(var e=r.slice(),i=y("context restored"),a=0;a<e.length;++a)e[a](i)},0)},e.loseContextInNCalls=function(e){if(s)throw"You can not ask a lost contet to be lost";h=d+e},e.getNumCalls=function(){return d},e.setRestoreTimeout=function(e){p=e},e},resetToInitialState:l}}(),Oi=function(){this._values=new Float32Array(Oi.maxGraphValue),this._index=0,this._maxValue=0,this._x=0,this._y=0};Oi.maxGraphValue=120,Oi.prototype={getIndex:function(){return this._index},getValues:function(){return this._values},setDisplayPosition:function(e,t){this._x=e,this._y=t},getX:function(){return this._x},getY:function(){return this._y},addValue:function(e,t){var n=this._index;this._maxValue=e>this._maxValue?e:this._maxValue,this._maxValue*=.99,this._values[n]=e/(1.1*this._maxValue),t&&(this._values[n]+=t),this._index=(this._index+1)%Oi.maxGraphValue}};var Ri=Oi,Pi=function(){this._usageHint=z.a.DYNAMIC_DRAW;this._nbVertexes=0,this._maxNbVertexes=0,this._captionNbVertexes=0,this._valuesNbVertexes=0,this._graphsNbVertexes=0,this.resize(6560)};Pi.backgroundColor=10,Pi.redColor=7,Pi.greyColor=4,Pi.whiteColor=1,a.a.createPrototypeObject(Pi,{getGeometry:function(){return this._geometry},generateBackground:function(e,t,n,i){var r=this._vertexes;this._nbVertexes+=4,r[0]=e,r[1]=t,r[2]=0,r[3]=Pi.backgroundColor;var a=e+n,o=t+i;r[4]=e,r[5]=o,r[6]=0,r[7]=Pi.backgroundColor,r[8]=a,r[9]=o,r[10]=0,r[11]=Pi.backgroundColor,r[12]=a,r[13]=t,r[14]=0,r[15]=Pi.backgroundColor},generateCharacter:function(e,t,n,i,r,a,o){var s=this._vertexes,u=this._nbVertexes;this._nbVertexes+=4;var l=4*u;s[l++]=e,s[l++]=t,s[l++]=r,s[l++]=-(0+o);var c=e+n,h=t+i;s[l++]=e,s[l++]=h,s[l++]=r,s[l++]=-(1+o),s[l++]=c,s[l++]=h,s[l++]=a,s[l++]=-(1+o),s[l++]=c,s[l++]=t,s[l++]=a,s[l++]=-(0+o)},generateText:function(e,t,n,i,r){var a=n.length;this._nbVertexes+4*a>=this._maxNbVertexes&&this.resize(2*this._maxNbVertexes);for(var o=i._characterSizeUV,s=i._characterWidth,u=i._characterHeight,l=0;l<a;l++){var c=n.charCodeAt(l),h=i.getCharacterUV(c);this.generateCharacter(e,t,s,u,h,h+o,r),e+=s}return a*s},generateGraph:function(e,t){this._nbVertexes+2*Ri.maxGraphValue>=this._maxNbVertexes&&this.resize(2*this._maxNbVertexes);var n=this._vertexes,i=this._nbVertexes,r=e.getValues(),a=r.length,o=e.getIndex(),s=e.getX(),u=e.getY();this._nbVertexes+=2*a;for(var l=0;l<a;l++){var c=4*(i+2*l),h=r[(o+l)%a],d=Pi.greyColor;h>=Pi.redColor&&(d=Pi.redColor,h-=Pi.redColor),h>1&&(h=1),(h*=t)<1&&(h=1),n[c]=s+2*l,n[c+1]=u,n[c+2]=0,n[c+3]=d,n[c+4]=s+2*l,n[c+5]=u+h,n[c+6]=0,n[c+7]=d}},resize:function(e){A.a.log("resize buffer to "+e),this._maxNbVertexes=e;var t=new Float32Array(4*e);this._vertexes&&t.set(this._vertexes),this._vertexes=t;var n=Math.ceil(e/4);this._indexes=new Uint16Array(6*n);for(var i=0,r=0;i<n;i++)this._indexes[r++]=4*i+0,this._indexes[r++]=4*i+1,this._indexes[r++]=4*i+3,this._indexes[r++]=4*i+3,this._indexes[r++]=4*i+1,this._indexes[r++]=4*i+2;if(this._geometry)return this._geometry.getAttributes().Vertex.setElements(this._vertexes),void this._characterPrimitive.getIndices().setElements(this._indexes);this._geometry=new Re.a,this._geometry.setName("osgStats-Stats"),this._geometry.getAttributes().Vertex=new z.a(z.a.ARRAY_BUFFER,this._vertexes,4,!0);var a=new z.a(z.a.ELEMENT_ARRAY_BUFFER,this._indexes,1);this._geometry.getAttributes().Vertex.setUsage(this._usageHint);var o=new Vn.a(Mn.a.TRIANGLES,a);this._characterPrimitive=o,this._geometry.getPrimitives().push(this._characterPrimitive);var s=new Tn.a(Mn.a.LINES,0,0);this._graphPrimitive=s,this._geometry.getPrimitives().push(this._graphPrimitive)},update:function(){var e=this._captionNbVertexes+this._valuesNbVertexes;this._characterPrimitive.setCount(e/4*6),this._graphPrimitive.setCount(this._graphsNbVertexes),this._graphPrimitive.setFirst(e),this._geometry.getAttributes().Vertex.dirty()},resetCaptions:function(){this._nbVertexes=0,this._captionNbVertexes=0},resetValues:function(){this._nbVertexes=this._captionNbVertexes,this._valuesNbVertexes=0,this._graphsNbVertexes=0},captionsEnd:function(){this._captionNbVertexes=this._nbVertexes},valuesEnd:function(){this._valuesNbVertexes=this._nbVertexes-this._captionNbVertexes},graphsEnd:function(){this._graphsNbVertexes=this._nbVertexes-(this._valuesNbVertexes+this._captionNbVertexes)},getCharacterPrimitive:function(){return this._characterPrimitive},getGraphPrimitive:function(){return this._graphPrimitive},getNbVertexes:function(){return this._nbVertexes}});var Ii=Pi,Ni=window.performance,Li=function(e){this._caption=e.caption,this._accumValue=0,this._accumSamples=0,this._accumStart=0,this._value=0,this._averageValue=0,this._time=0,this._avgMs=0,this._over=e.over>0?e.over:0,this._below=e.below>0?e.below:0,this._graph=!!e.graph,e.average&&(this._avgMs=e.avgMs?e.avgMs:1e3),this._display=!1};a.a.createPrototypeObject(Li,{isDisplayable:function(){return this._display},setDisplayable:function(e){this._display=e},getOver:function(){return this._over},getBelow:function(){return this._below},getGraph:function(){return this._graph},getAverageMs:function(){return this._avgMs},getAverageValue:function(){return this._averageValue},getValue:function(){return this._value},average:function(e){if(this._avgMs){this._accumValue+=e,this._accumSamples++;var t=Ni.now();t-this._accumStart>this._avgMs&&(this._averageValue=this._accumValue/this._accumSamples,this._accumValue=0,this._accumStart=t,this._accumSamples=0)}},start:function(){this._display=!0,this._time=Ni.now()},end:function(){this._value=Ni.now()-this._time,this.average(this._value)},set:function(e){this._display=!0,this._value=e,this.average(e)},tick:function(){this.end(),this.start()},frame:function(){var e=Ni.now()-this._time;this.set(1e3/e),this.start()}});var ki=Li,Di=function(){this._canvas=void 0,this._characterHeight=0,this._characterWidth=0,this._fontSize=16,this._fontFamily="Source Code Pro",this._characterFirstCode=" ".charCodeAt(),this._characterLastCode="z".charCodeAt(),this._characterSizeUV=0,this._backgroundColor="rgba(0,0,0,0.0)",this._createCanvas()};a.a.createPrototypeObject(Di,{setFontSize:function(e){this._fontSize=e},getCharacterWidth:function(){return this._characterWidth},getCharacterHeight:function(){return this._characterHeight},getCanvas:function(){return this._promise},getCharacterUV:function(e){return(e-this._characterFirstCode)*this._characterSizeUV},_fillCanvas:function(e,t){var n=t+"px",i=function(e){var t=document.getElementsByTagName("body")[0],n=document.createElement("div"),i=document.createTextNode("M");n.appendChild(i),n.setAttribute("style",e),t.appendChild(n);var r=n.offsetHeight;return t.removeChild(n),r}("font-family: "+e+"; font-size: "+n+";");A.a.debug(e+" "+n+" ==> "+i+" pixels high."),this._characterHeight=Math.ceil(i);var r=t+"px '"+e+"'",a=document.createElement("canvas"),o=a.getContext("2d");this._canvas=a,o.font=r,o.textBaseline="middle",this._characterWidth=o.measureText(" ").width,this._characterWidth=Math.ceil(this._characterWidth);var s=this._characterLastCode-this._characterFirstCode+1;A.a.info("Stats character size "+this._characterWidth+" x "+this._characterHeight+" texture width "+this._characterWidth*s),a.width=Math.ceil(this._characterWidth*s),a.height=this._characterHeight,this._characterSizeUV=this._characterWidth/a.width,o.font=r,o.textBaseline="middle",o.fillStyle="rgb(255,255,255)";for(var u=this._characterFirstCode,l=0;u<=this._characterLastCode;u++,l++){var c=String.fromCharCode(u),h=l*this._characterWidth,d=this._characterHeight/2;o.fillText(c,h,d)}return a},_createCanvas:function(){this._promise=function(e){return new Te.a(function(t,n){window.WebFontConfig={google:{families:[e+":200"]},active:function(){t(e)},inactive:function(e){n("loadFont error:"+e)}};var i=document.createElement("script"),r=document.scripts[0];i.src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js",i.async=!0,i.onerror=function(){n()},r.parentNode.insertBefore(i,r)})}(this._fontFamily).then(function(e){return this._fillCanvas(e,this._fontSize)}.bind(this)).catch(function(){return this._fillCanvas("Courier New",this._fontSize)}.bind(this))}});var Fi=Di,Vi=n("XKim"),Bi=function(e,t){this._captionsBuffer=void 0,this._valuesBuffer=void 0,this._dirtyCaptions=!0,this._dirtyValues=!0,this._viewer=e,this._labelMaxWidth=0,this._viewport=e.getCamera().getViewport(),this._node=void 0,this._text=void 0,this._offsetGroup=void 0,this._counters={},this._groups={},this._updates=[],this._displayableCounters={},this._x=0,this._y=0,this._width=0,this._height=0,this._maxCaptionTextLength=32,this._lineFactor=1.1,this._displayFilter=[],this._backgroundWidth=0,this._backgroundHeight=0,this._bufferStats=new Ii,this._historyGraph={},this._graphToDisplay=[],this._valuesMaxWidth=72,this._showGraph=!1,this._backgroundPicking=Be.a.createTexturedQuadGeometry(0,0,0,10,0,0,0,10,0),this._backgroundPicking.setName("osgStats-Background-picking"),this._dragStop=o.e.create(),this._dragStart=o.e.create(),this._startTransformation=o.c.create(),this._init(t)};a.a.createPrototypeObject(Bi,{getCounter:function(e){return this._counters[e]||(this._counters[e]=new ki({caption:e,average:!0})),this._counters[e]},getBufferStats:function(){return this._bufferStats},addConfig:function(e){if(!e.init||e.init()){for(var t in e.values){var n=e.values[t],i=new ki(n);this._counters[t]=i}if(e.groups)for(var r=0;r<e.groups.length;r++){var a=e.groups[r],o={caption:a.caption,values:a.values,textCursorY:new Float32Array(a.values.length)},s=a.name?a.name:a.caption;this._groups[s]=o}e.update&&this._updates.push(e.update)}},reset:function(){this._bufferStats.resetCaptions(),this._bufferStats.resetValues(),this._dirtyCaptions=!0,this._dirtyValue=!0,this._bufferStats.resize(this._bufferStats._maxNbVertexes)},update:function(){for(var e=0;e<this._updates.length;e++)this._updates[e](this);this._dirtyValues=!0,(this._checkViewportChanged()||this._checkCounterDisplayableChanged())&&(this._dirtyCaptions=!0),this._dirtyCaptions&&(this._bufferStats.resetCaptions(),this._generateCaptions(),this._dirtyCaptions=!1),this._dirtyValues&&(this._bufferStats.resetValues(),this._generateValues(),this._dirtyValues=!1)},getNode:function(){return this._node},setShowFilter:function(e){this._dirtyCaptions=!0,e?this._displayFilter=e.slice():this._displayFilter.length=0},_init:function(e){var t=new gn.a;t.setRenderOrder(gn.a.POST_RENDER,0),t.setReferenceFrame(ii.a.ABSOLUTE_RF),t.setClearMask(0);var n=new Ve.a;n.setName("StatsNode"),n.addChild(this._backgroundPicking),this._nodeTransform=n,this._backgroundPicking.setNodeMask(0),t.addChild(n),t.setName("osgStats"),t.setViewport(this._viewport),this._node=t,this._text=new Fi;var i=12;if(e){var r=e.getString("statsFilter");if(r){var a=r.split(";");this.setShowFilter(a)}var o=e.getNumber("statsFontSize");void 0!==o&&(i=o),this._showGraph=e.getBoolean("statsShowGraph")}var s=new Ue.default;s.setMinFilter(Ue.default.NEAREST),s.setMagFilter(Ue.default.NEAREST),this._text.setFontSize(i*this._viewer.getCanvasPixelRatio()),this._text.getCanvas().then(function(e){this._dirtyCaptions=!0;var t=this._bufferStats.getGeometry();t.setNodeMask(-32769),n.addChild(t),s.setImage(e),t.setBound(new Vi.a)}.bind(this)),n.getOrCreateStateSet().setAttributeAndModes(function(){var e=["attribute vec4 Vertex;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","","varying vec2 vTexCoord0;","","void main(void) {","  vTexCoord0 = Vertex.zw;","  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xy,0.0, 1.0));","}"].join("\n"),t=["#define SHADER_NAME STATS","varying vec2 vTexCoord0;","uniform sampler2D Texture0;","void main(void) {","  vec4 color = vec4(1.0);","  vec2 uv =  vTexCoord0;","  int isText = 0;","  if ( uv.y < 0.0 ) {","     isText = 1;","     uv.y = -uv.y;","  }","  if ( uv.y >= "+(Ii.backgroundColor-1).toFixed(1)+" ) {","     color = vec4(0.0,0.0,0.0,0.5);","     uv.y -= "+Ii.backgroundColor.toFixed(1)+";","  } else if ( uv.y >= "+(Ii.redColor-1).toFixed(1)+" ) {","     color = vec4(1.0,0.0,0.0,1.0);","     uv.y -= "+Ii.redColor.toFixed(1)+";","  } else if ( uv.y == "+(Ii.greyColor-1).toFixed(1)+" ) {","     color = vec4(0.5,0.5,0.5,1.0);","     uv.y -= "+Ii.greyColor.toFixed(1)+";","  } else {","     uv.y -= "+Ii.whiteColor.toFixed(1)+";","  }","  if ( isText == 1 ) {","     color *= texture2D( Texture0, uv.xy);","  }","  gl_FragColor = color;","}"].join("\n");return new _n.a(new bn.a("VERTEX_SHADER",e),new bn.a("FRAGMENT_SHADER",t))}()),n.getOrCreateStateSet().setAttributeAndModes(new hn.a(hn.a.DISABLE));var u=new je.a("SRC_ALPHA","ONE_MINUS_SRC_ALPHA");n.getOrCreateStateSet().setAttributeAndModes(u),n.getOrCreateStateSet().setAttributeAndModes(new dn.a(dn.a.DISABLE)),n.getOrCreateStateSet().setTextureAttributeAndModes(0,s);var l=this._viewer.getGraphicContext().canvas;this._canvas=l;var c=this._viewer.getInputManager();c.group(Ct.a.STATS).addMappings({onMouseMove:["mousemove","touchmove"],onMouseDown:["mousedown","touchstart"],onMouseUp:["mouseup","mouseout","touchend","touchcancel"]},this),c.setPriority(Ct.a.STATS,c.getHigherPriority(Ct.a.SCENE))},onMouseDown:function(e){var t=this.computeNearestIntersection(e);this._onStats=!!t.length,this._onStats&&(this._viewer.getInputManager().setEnable(Ct.a.SCENE,!1),o.c.copy(this._startTransformation,this._nodeTransform.getMatrix()),o.e.set(this._dragStart,e.canvasX,e.canvasY),this._dragStop[1]=this._dragStart[1])},onMouseMove:function(){var e=o.f.create();return function(t){if(this._onStats){o.e.set(this._dragStop,t.canvasX,t.canvasY);var n=this._dragStop[1]-this._dragStart[1];o.c.translate(this._nodeTransform.getMatrix(),this._startTransformation,o.f.set(e,0,-n,0))}}}(),onMouseUp:function(){this._viewer.getInputManager().setEnable(Ct.a.SCENE,!0),this._onStats=!1},computeNearestIntersection:function(){var e=new ot.a,t=o.f.create(),n=o.f.create(),i=new at.a;return i.setIntersector(e),function(r){var a=r.glX,s=r.glY;e.reset(),e.set(o.f.set(t,a,s,0),o.f.set(n,a,s,1)),i.reset(),this._backgroundPicking.setNodeMask(32768),i.setTraversalMask(32768),this._node.accept(i);var u=e.getIntersections();return this._backgroundPicking.setNodeMask(0),u}}(),_updateBackgroundPicking:function(e,t,n,i){var r=this._backgroundPicking.getVertexAttributeList().Vertex.getElements();r[0]=e,r[1]=t+i,r[3]=e,r[4]=t,r[6]=e+n,r[7]=t,r[9]=e+n,r[10]=t+i,this._backgroundPicking.getVertexAttributeList().Vertex.dirty(),this._backgroundPicking.dirtyBound()},_generateCaptions:function(){var e=this._text.getCharacterHeight(),t=0,n=this._viewport.height()-e;this._labelMaxWidth=0,this._bufferStats.generateBackground(0,this._viewport.height()-this._backgroundHeight,this._backgroundWidth,this._backgroundHeight),this._updateBackgroundPicking(0,this._viewport.height()-this._backgroundHeight,this._backgroundWidth,this._backgroundHeight);var i=this._displayFilter;for(var r in this._groups)if(!r||!i.length||-1!==i.indexOf(r)){var a=this._groups[r],o="--- "+a.caption+" ---",s=this._bufferStats.generateText(t,n,o,this._text,Ii.whiteColor);this._labelMaxWidth=Math.max(s,this._labelMaxWidth),t=0,n-=this._lineFactor*e;for(var u=0;u<a.values.length;u++){var l=a.values[u],c=this._counters[l];if(c&&c.isDisplayable()){a.textCursorY[u]=n;for(var h=c._caption,d=h.length/this._maxCaptionTextLength,f=0;f<d;f++){var p=f*this._maxCaptionTextLength,g=h.substr(p,this._maxCaptionTextLength);s=this._bufferStats.generateText(t,n,g,this._text,Ii.whiteColor),this._labelMaxWidth=Math.max(s,this._labelMaxWidth),n-=e,t=0}}}n-=e}this._bufferStats.captionsEnd()},_generateValues:function(){var e,t=this._text.getCharacterWidth(),n=this._labelMaxWidth+2*t,i=this._valuesMaxWidth+2*t,r=this._text.getCharacterHeight(),a=n,o=this._displayFilter,s=0;for(var u in this._groups)if(!u||!o.length||-1!==o.indexOf(u)){var l=this._groups[u];a=n;for(var c=0;c<l.values.length;c++){var h=l.values[c],d=this._counters[h];if(d&&d.isDisplayable()){var f,p=d.getAverageMs()?d.getAverageValue():d.getValue();f=Number.isInteger(p)?p.toString():p.toFixed(2),e=l.textCursorY[c];var g=Ii.whiteColor,m=d.getOver(),v=d.getBelow();0!==m?g=p>m?Ii.redColor:g:0!==v&&(g=p<v?Ii.redColor:g);var _=this._bufferStats.generateText(a,e,f,this._text,g);s=Math.max(_,s),this._showGraph&&d._graph&&(this._historyGraph[h]||(this._historyGraph[h]=new Ri),this._graphToDisplay.push(this._historyGraph[h]),this._historyGraph[h].setDisplayPosition(n+i,e),this._historyGraph[h].addValue(p,g)),a=n}}}this._bufferStats.valuesEnd(),this._valuesMaxWidth=s;for(var b=0;b<this._graphToDisplay.length;b++){var S=this._graphToDisplay[b];this._bufferStats.generateGraph(S,r-2)}var y=n+i;this._graphToDisplay.length&&(y+=2*Ri.maxGraphValue+1);var x=this._viewport.height()-e;this._backgroundWidth===y&&this._backgroundHeight===x||(this._backgroundWidth=y,this._backgroundHeight=x,this._dirtyCaptions=!0),this._graphToDisplay.length=0,this._bufferStats.graphsEnd(),this._bufferStats.update()},_checkCounterDisplayableChanged:function(){var e=!1;for(var t in this._counters){var n=this._counters[t];this._displayableCounters[t]!==n.isDisplayable()&&(this._displayableCounters[t]=n.isDisplayable(),e=!0)}return e},_checkViewportChanged:function(){var e=this._viewport.x(),t=this._viewport.y(),n=this._viewport.width(),i=this._viewport.height();if(e!==this._x||t!==this._y||n!==this._width||i!==this._height){this._x=e,this._y=t,this._width=n,this._height=i;var r=this._node;return o.c.ortho(r.getProjectionMatrix(),this._x,this._width,this._y,this._height,-5,5),!0}return!1}});var Ui=Bi,ji={values:{frame:{caption:"Total frame time",over:16,average:!0,graph:!0,max:4},stats:{caption:"stats",over:1,graph:!0},fps:{caption:"Framerate (FPS)",below:30,average:!0},raf:{caption:"Time since last rAF",average:!0,avgMs:500},update:{caption:"update",average:!0,graph:!0},cull:{caption:"cull",average:!0,graph:!0,max:16},render:{caption:"render",average:!0,graph:!0},readPixels:{caption:"readPixels",average:!0,graph:!0},glframe:{caption:"glframe",average:!0,graph:!0},textureused:{caption:"texture used"},texturereserved:{caption:"texture reserved"},texturetotal:{caption:"texture total"},pushstateset:{caption:"num pushStateSet"},applyStateSet:{caption:"num applyStateSet"},updatecallback:{caption:"num updateCallback"},cullcamera:{caption:"camera"},cullmatrixtransform:{caption:"matrixTransform"},cullprojection:{caption:"projection"},cullnode:{caption:"node"},culllightsource:{caption:"lightSource"},cullgeometry:{caption:"geometry"}},groups:[{name:"framerate",caption:"Framerate",values:["fps","raf"]},{name:"frameBudget",caption:"Frame Budget",base:"frame",values:["frame","update","cull","render","glframe","stats"]},{name:"sceneGraph",caption:"Scene Graph ",values:["pushstateset","updatecallback","applyStateSet"]},{name:"cullVisitor",caption:"Cull",values:["cullnode","cullmatrixtransform","cullcamera","culllighsource","cullprojection","cullgeometry"]},{name:"texture",caption:"Texture Memory",values:["texturereserved","textureused","texturetotal"]},{name:"readback",caption:"gpu read back",values:["readpixels"]}]},Gi=[window.WebGLRenderingContext,window.WebGL2RenderingContext],Hi=function(e,t){return function(){t.apply(this,arguments),e.apply(this,arguments)}},zi=0,Wi=0,qi=0,Xi=0,Yi=0,Ki=0,Qi=0,Ji=0,Zi=0,$i=0,er={values:{glDrawCalls:{caption:"drawCalls"},glDrawElements:{caption:"drawElements"},glDrawArrays:{caption:"drawArrays"},glBindTexture:{caption:"bindTexture"},glUseProgram:{caption:"useProgram"},glFaces:{caption:"totalFaces"},glVertices:{caption:"totalVertices"},glPoints:{caption:"totalPoints"},statsFaces:{caption:"statsFaces"},statsVertices:{caption:"statsVertices"},statsLines:{caption:"statsLines"}},groups:[{name:"webgl",caption:"WebGL",values:["glDrawCalls","glDrawElements","glDrawArrays","glUseProgram","glBindTexture","glFaces","glVertices","glPoints","statsVertices","statsFaces","statsLines"]}],update:function(e){var t=e.getBufferStats(),n=t.getNbVertexes(),i=t.getCharacterPrimitive(),r=t.getGraphPrimitive();Wi-=1,r.getCount()&&(zi-=1),Qi-=2,qi-=1,Yi-=i.getCount()+r.getCount(),Xi-=i.getCount()/3,Ji=n,Zi=i.getCount()/3,$i=r.getCount()/2,e.getCounter("glDrawCalls").set(Wi+zi),e.getCounter("glDrawElements").set(Wi),e.getCounter("glDrawArrays").set(zi),e.getCounter("glBindTexture").set(Qi),e.getCounter("glUseProgram").set(qi),e.getCounter("glFaces").set(Xi),e.getCounter("glVertices").set(Yi),e.getCounter("glPoints").set(Ki),e.getCounter("statsVertices").set(Ji),e.getCounter("statsFaces").set(Zi),e.getCounter("statsLines").set($i),Ji=0,Zi=0,$i=0,zi=0,Wi=0,qi=0,Xi=0,Yi=0,Ki=0,Qi=0}.bind(void 0),init:function(){for(var e=!1,t=0;t<Gi.length;t++){var n=Gi[t];n&&(e=!0,n.prototype.drawArrays=Hi(n.prototype.drawArrays,function(){zi++,arguments[0]===this.POINTS?Ki+=arguments[2]:Yi+=arguments[2]}),n.prototype.drawElements=Hi(n.prototype.drawElements,function(){Wi++,Xi+=arguments[1]/3,Yi+=arguments[1]}),n.prototype.useProgram=Hi(n.prototype.useProgram,function(){qi++}),n.prototype.bindTexture=Hi(n.prototype.bindTexture,function(){Qi++}))}return e}},tr=void 0,nr=Math.log(1024),ir=function(e){var t=Math.floor(Math.log(e)/nr);return 0===e&&(t=1),Math.round(100*e/Math.pow(1024,t))/100},rr={values:{browserMemory:{caption:"Used Memory",average:!0,avgMs:1e3},browserMemoryTotal:{caption:"Total Memory"}},groups:[{name:"browser",caption:"Browser",values:["browserMemory","browserMemoryTotal"]}],update:function(e){var t=0,n=0;tr&&(t=ir(tr.usedJSHeapSize),n=ir(tr.totalJSHeapSize)),e.getCounter("browserMemory").set(t),e.getCounter("browserMemoryTotal").set(n)},init:function(){return window.performance&&window.performance.memory&&(tr=window.performance.memory),tr&&0!==tr.totalJSHeapSize||A.a.warn("Stats will not report memory, not supported by your browse"),!!tr}},ar=["shift","alt","ctrl","meta"],or=function(e,t){this._enabled=!0,this._name=t,this._mask=[],this._events={},this._mappings={},this._inputManager=e,this._boundCallback=this._collectNativeEvents.bind(this),this._priority=10,this._hasSources=!1};or.prototype={addMappings:function(e,t){for(var n in e)e[this._name+":"+n]=e[n],delete e[n];this._inputManager.addMappings(e,t)},_collectNativeEvents:function(e){if(this._enabled&&!this._mask.length){var t=this._mappings[e.type];if(t)for(var n=0;n<t.length;n++){var i=t[n];if(!i._source.isEventRegistered||i._source.isEventRegistered(e,i._parsedEvent)){if(i._source.populateEvent(e,i),i._nativeEvents||(i._nativeEvents=[]),!i._nativeEvents.length){var r=this._inputManager._queues[i._priority];r||(r=[],this._inputManager._queues[i._priority]=r),r.push(i)}i._nativeEvents.push(e)}}}},_addEvent:function(e,t){var n,i=this._name+":"+t,r=!1,a=this._mappings[e.name];a?n=this._findEvent(a,i,e.raw):(a=[],this._mappings[e.name]=a,r=!0);var o=this._events[t];o||(o=[],this._events[t]=o),n||(n=new Event(i),a.push(n),o.push(n)),n._parsedEvent=e,n._priority=10;var s=this._inputManager._getSource(e.name);s&&(this._enabled&&r&&s.setEnable(e.name,this._boundCallback,!0),this._hasSources=!0,n._source=s)},_findEvent:function(e,t,n){for(var i=0;i<e.length;i++){var r=e[i];if(r.type===t&&r._parsedEvent.raw===n)return r}},_setEnable:function(e){for(var t in this._enabled=e,this._mappings){var n=this._mappings[t][0];n._source&&n._source.setEnable(t,this._boundCallback,e)}}};var sr=function(){this._groups={},this._sources=[],this._queues=[],this._queues[10]=[],this._callbacks={},this._params={},this._maskedGroups=[],window.dumpInputGroups=this._dumpInputGroups.bind(this),window.dumpEventSequence=this._dumpEventSequence.bind(this)};sr.prototype={registerInputSource:function(e){if(!e.setEnable||!e.supportsEvent||!e.getName)throw"Invalid input target "+JSON.stringify(e);this._sources.push(e),e.setInputManager(this)},getInputSource:function(e){for(var t=0;t<this._sources.length;t++){var n=this._sources[t];if(n.getName()===e)return n}},addMappings:function(e,t){for(var n in e){var i=e[n],r=n.split(":");if(2!==r.length)throw"Mapping should be of the form 'group:methodName': ['nativeevent1, 'nativeevent2',...] ";var a,o,s=this._getOrCreateGroup(r[0]),u=r[1];if(t)if("object"==typeof t){if(!(a=t[u])||"function"!=typeof a)throw"Cannot find method "+u+" on "+t;a=a.bind(t)}else{if("function"!=typeof t)throw"Invalid listener "+t;a=t}if("string"==typeof i)o=this._parseNativeEvent(i),s._addEvent(o,u);else for(var l=0;l<i.length;l++){var c=i[l];o=this._parseNativeEvent(c),s._addEvent(o,u)}this._callbacks[s._name+":"+u]=a}},group:function(e){return this._getOrCreateGroup(e)},setEnable:function(e,t){var n,i=this._groups[e];for(var r in i&&i._setEnable(t),this._groups)if(i=this._groups[r],t){if((n=i._mask.indexOf(e))>=0){for(;n>=0;)i._mask.splice(n,1),n=i._mask.indexOf(e);for(n=this._maskedGroups.indexOf(e);n>=0;)this._maskedGroups.splice(n,1),n=this._maskedGroups.indexOf(e)}}else 0===(n=i._name.indexOf(e))&&"."===i._name[n+e.length]&&(i._mask.push(e),this._maskedGroups.push(e));if(!t)for(var a=0;a<this._queues.length;a++){var o=this._queues[a];if(o)for(var s=o.length-1;s>=0;s--){var u=o[s];u.type.indexOf(e)>=0&&(o.splice(s,1),u._nativeEvents.length=0)}}},setPriority:function(e,t){var n=e.split(":");if(t<0)throw"priority must be a positive number";var i,r,a=this._groups[n[0]];if(a&&n[1]){for(i=a._events[n[1]],r=0;r<i.length;r++)i[r]._priority=t;a._priority>t&&(a._priority=t)}else for(var o in this._groups)if((a=this._groups[o])._name.indexOf(e)>=0)for(var s in a._events)for(i=a._events[s],r=0;r<i.length;r++)i[r]._priority=t},getHigherPriority:function(e){var t=10;for(var n in this._groups){var i=this._groups[n];i._name.indexOf(e)>=0&&i._priority<t&&(t=i._priority)}return t>0?t-1:0},getParam:function(e){return this._params[e]},setParam:function(e,t){this._params[e]=t},cleanup:function(){for(var e in this._groups){this._groups[e]._setEnable(!1)}},_parseNativeEvent:function(e){var t,n=e.split(" "),i={};for(i.name=n[0],t=1;t<n.length;t++){var r=n[t],a=!0;0===r.indexOf("!")&&(a=!1,r=r.substring(1,r.length)),ar.indexOf(r)>=0?i[r]=a:i.action=r.toLowerCase()}if(i.action)for(t=0;t<ar.length;t++){var o=ar[t];0===i.action.indexOf(o)&&(i[o]=!0)}return 0===i.name.indexOf("key")&&!i.action&&n.length>1&&(i.action=n[n.length-1]),i.raw=e,i},_getOrCreateGroup:function(e){var t=this._groups[e];if(!t){t=new or(this,e),this._groups[e]=t;for(var n=0;n<this._maskedGroups.length;n++){var i=this._maskedGroups[n];0===e.indexOf(i)&&t._mask.push(i)}}return t},update:function(e){var t;for(t=0;t<this._sources.length;t++){var n=this._sources[t];n.poll&&n.poll(e)}for(t=0;t<this._queues.length;t++){var i=this._queues[t];if(i){for(var r=0;r<i.length;r++){var a=i[r];this._callbacks[a.type](a),a._nativeEvents.length=0}i.length=0}}},_getSource:function(e){for(var t=0;t<this._sources.length;t++){var n=this._sources[t];if(n.supportsEvent(e))return n}},_dumpInputGroups:function(e,t){for(var n in!0===e&&(t=e,e=void 0),this._groups)if(!(e&&n.indexOf(e)<0)){var i=this._groups[n],r=i._enabled&&!i._mask.length&&i._hasSources;if(!t||r){for(var a in A.a.groupCollapsed("%c"+n+(r?" (enabled)":" (disabled)"),r?"":"color: #888888"),A.a.log("enabled:",i._enabled),A.a.log("masks:",i._mask),A.a.log("input sources:",i._hasSources),A.a.group("events"),i._events){A.a.groupCollapsed(a);for(var o=i._events[a],s=0;s<o.length;s++){var u=o[s],l="%c"+u._parsedEvent.raw+" ("+(u._source?u._source.getName():"unknown source")+")",c=u._source?"":"color: #888888";A.a.log(l,c)}A.a.groupCollapsed("function"),A.a.log(this._callbacks[i._name+":"+a]),A.a.groupEnd(),A.a.groupEnd()}A.a.groupEnd(),A.a.groupEnd()}}},_dumpEventSequence:function(e,t){var n,i=[];for(var r in!0===e&&(t=e,e=void 0),this._groups){var a=this._groups[r];if(n=a._enabled&&!a._mask.length&&a._hasSources,!t||n)for(var o in a._events){var s=a._events[o],u=i[s[0]._priority];u||(u=[],i[s[0]._priority]=u);for(var l=0;l<s.length;l++){var c=s[l];(!e||e&&c._parsedEvent.raw.indexOf(e)>=0)&&u.push({name:c.type,group:a._name,on:c._parsedEvent.raw,enabled:a._enabled&&!a._mask.length&&!!c._source,source:c._source?"("+c._source.getName()+")":"(unknown source)"})}}}for(var h=0;h<i.length;h++){var d=i[h];if(d){var f;A.a.group("priority "+h);for(var p=0;p<d.length;p++){var g=d[p];if(0!==p&&f!==g.name&&A.a.groupEnd(),f!==g.name){var m=this._groups[g.group];n=m._enabled&&!m._mask.length&&m._hasSources,A.a.groupCollapsed("%c"+g.name,n?"":"color:#888888")}f=g.name,A.a.groupCollapsed("%c"+g.on+" "+g.source,g.enabled?"":"color:#888888"),A.a.log(this._callbacks[g.name]),A.a.groupEnd()}A.a.groupEnd(),A.a.groupEnd()}}}};var ur=sr,lr=function(e){this._target=e,this._supportedEvents=[]};lr.prototype={supportsEvent:function(e){for(var t=0;t<this._supportedEvents.length;t++){var n=this._supportedEvents[t];if(0===e.indexOf(n))return!0}return!1},setInputManager:function(e){this._inputManager=e}};var cr=lr,hr=0===navigator.platform.indexOf("Mac")?-1:-3,dr=function(e,t){cr.call(this,e),this._defaultRatio=o.e.fromValues(1,1),this._supportedEvents=["click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseup"],t&&!1===t.scrollwheel||this._supportedEvents.push("wheel")};a.a.createPrototypeObject(dr,a.a.objectInherit(cr.prototype,{getName:function(){return"Mouse"},setEnable:function(e,t,n){n?this._target.addEventListener(e,t):this._target.removeEventListener(e,t)},populateEvent:function(e,t){t.canvasX=void 0===e.offsetX?e.layerX:e.offsetX,t.canvasY=void 0===e.offsetY?e.layerY:e.offsetY;var n=this._inputManager.getParam("pixelRatio");n||(n=this._defaultRatio),t.glX=t.canvasX*n[0],t.glY=(this._target.clientHeight-t.canvasY)*n[1],t.clientX=e.clientX,t.clientY=e.clientY,t.screenX=e.screenX,t.screenX=e.screenX,t.pageX=e.pageX,t.pageY=e.pageY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.altKey=e.altKey,t.metaKey=e.metaKey,t.button=e.button,t.buttons=e.buttons,"wheel"===e.type&&(void 0!==e.wheelDelta?t.deltaY=e.wheelDelta/120:1===e.deltaMode?t.deltaY=e.deltaY/hr:t.deltaY=e.deltaY/(10*hr),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaZ=e.deltaZ)},isEventRegistered:function(e,t){return(!t.action||e.button===parseInt(t.action))&&((void 0===t.ctrl||e.ctrlKey===t.ctrl)&&((void 0===t.shift||e.shiftKey===t.shift)&&((void 0===t.alt||e.altKey===t.alt)&&((void 0===t.meta||e.metaKey===t.meta)&&(e.preventDefault(),!0)))))}}),"osgViewer","InputSourceMouse");var fr=dr,pr=function(e){cr.call(this,e),this._supportedEvents=["keydown","keyup","keypress"]};a.a.createPrototypeObject(pr,a.a.objectInherit(cr.prototype,{getName:function(){return"Keyboard"},setEnable:function(e,t,n){n?this._target.addEventListener(e,t):this._target.removeEventListener(e,t)},populateEvent:function(e,t){t.key=e.key,t.keyCode=e.keyCode,t.code=e.code,t.location=e.location,t.repeat=e.repeat,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.altKey=e.altKey,t.metaKey=e.metaKey},isEventRegistered:function(e,t){return!t.action||(e.key?e.key.toLowerCase()===t.action&&((void 0===t.ctrl||e.ctrlKey===t.ctrl)&&((void 0===t.shift||e.shiftKey===t.shift)&&((void 0===t.alt||e.altKey===t.alt)&&((void 0===t.meta||e.metaKey===t.meta)&&(e.preventDefault(),!0))))):void 0)}}),"osgViewer","InputSourceKeyboard");var gr=pr,mr=n("G9Ht"),vr=n.n(mr),_r=function(e,t){cr.call(this),this._supportedEvents=["vrsupported","vrpolyfilled","vrdisplayposechanged","vrdisplayconnected","vrdisplaynotfound","vrdisplaydisconnected"],this._callbacks={},this._events={};for(var n=0;n<this._supportedEvents.length;n++){var i=this._supportedEvents[n],r=new Event(i);this._events[i]=r}this._nbCallbacks=0,this._pollInterval=t&&void 0!==t.pollInterval?t.pollInterval:3e3};a.a.createPrototypeObject(_r,a.a.objectInherit(cr.prototype,{getName:function(){return"WebVR"},setEnable:function(e,t,n){var i=this._callbacks[e];i||(i=[],this._callbacks[e]=i);var r=i.indexOf(t);n?r<0&&(i.push(t),this._nbCallbacks++,this._schedulePolling()):r>=0&&(i.splice(r,1),this._nbCallbacks--,this._nbCallbacks||this._cancelPolling())},populateEvent:function(e,t){t.pose=e.pose,t.worldFactor=this._inputManager.getParam("worldFactor"),t.worldFactor||(t.worldFactor=1)},_schedulePolling:function(){this._pollInterval>0&&void 0===this._pollingTimeout&&(this._pollingTimeout=setInterval(this.pollHeadset.bind(this),this._pollInterval))},_cancelPolling:function(){void 0!==this._pollingTimeout&&clearInterval(this._pollingTimeout)},pollHeadset:function(){if(!navigator.xr||!navigator.xr.isSessionSupported){if(navigator.getVRDisplays||vr.a.any){if(this._vrPolyfillLoaded)return Te.a.reject("VR not supported");var e=this._events.vrsupported;this._dispatchEvent(e,this._callbacks.vrsupported);var t=this._events.vrpolyfilled;this._dispatchEvent(t,this._callbacks.vrpolyfilled)}return Te.a.resolve()}e=this._events.vrsupported;this._dispatchEvent(e,this._callbacks.vrsupported);var n=this;return navigator.xr.isSessionSupported("immersive-vr").then(function(e){if(!e){if(this._vrReady){var t=n._events.vrdisplaydisconnected;this._dispatchEvent(t,n._callbacks.vrdisplaydisconnected)}return this._vrReady=!1,this.triggerNotFoundEvent(),Te.a.reject("Immersive-vr session not supported")}if(!n._vrReady)return A.a.log("Found a VR display"),n._vrReady=!0,t=n._events.vrdisplayconnected,this._dispatchEvent(t,n._callbacks.vrdisplayconnected),Te.a.resolve()}.bind(this)).catch(function(e){return this._vrReady=!1,this.triggerNotFoundEvent(),A.a.warn(e),Te.a.reject(e)}.bind(this))},triggerNotFoundEvent:function(){if(!(this._pollInterval>0)){var e=this._events.vrdisplaynotfound;this._dispatchEvent(e,this._callbacks.vrdisplaynotfound)}},setPollInterval:function(e){this._pollInterval=e},_dispatchEvent:function(e,t){if(t)for(var n=0;n<t.length;n++){(0,t[n])(e)}},poll:function(e){if(this._vrReady&&e.frame){var t=this._callbacks.vrdisplayposechanged;if(t&&t.length){var n=e.frame.getViewerPose(e.xrReferenceSpace);if(n){var i=this._events.vrdisplayposechanged;i.pose=n,this._dispatchEvent(i,t)}}}}}),"osgViewer","InputSourceVR");var br=_r,Sr=function(){cr.call(this),this._target=window,this._supportedEvents=["buttondown","buttonup","buttonvalue","axis","gamepadconnected","gamepaddisconnected"],this._callbacks={},this._nbCallbacks=0,this._gamePadState=[],this._valueThreshold=.05,window.addEventListener("gamepadconnected",function(e){this._newGamePad(e.gamepad),this._onConnectionStateChange(e,"gamepadconnected")}.bind(this)),window.addEventListener("gamepaddisconnected",function(e){this._previousState[e.gamepad.index]=void 0,this._onConnectionStateChange(e,"gamepaddisconnected")}.bind(this))};a.a.createPrototypeObject(Sr,a.a.objectInherit(cr.prototype,{getName:function(){return"GamePad"},setEnable:function(e,t,n){var i=this._callbacks[e];i||(i=[],this._callbacks[e]=i);var r=i.indexOf(t);n?r<0&&(i.push(t),this._nbCallbacks++):r>=0&&(i.splice(r,1),this._nbCallbacks--)},_onConnectionStateChange:function(e,t){var n=this._callbacks[t];n&&n(e)},_newGamePad:function(e){var t,n={buttons:[]};for(n._buttonEvents=[],n._axisEvents=[],t=0;t<e.buttons.length;t++)n._buttonEvents[t]={buttondown:this._initEvent("buttondown",t,e.index,"button"),buttonup:this._initEvent("buttonup",t,e.index,"button"),buttonvalue:this._initEvent("buttonvalue",t,e.index,"button")};for(t=0;t<e.axes.length;t++)n._axisEvents[t]={axis:this._initEvent("axis",t,e.index,"axis")};this._gamePadState[e.index]=n},setValueThreshold:function(e){this._valueThreshold=e},_initEvent:function(e,t,n,i){var r=new Event(e);return r[i]=t,r.gamepadIndex=n,r},populateEvent:function(e,t){t.gamepadIndex=e.gamepadIndex,void 0!==e.button&&(t.button=e.button,t.value=e.value),void 0!==e.axis&&(t.axis=e.axis,t.value=e.value)},isEventRegistered:function(e,t){if(!t.action)return!0;var n=parseInt(t.action);return(void 0===e.button||e.button===n)&&(void 0===e.axis||e.axis===n)},_fireCallbacks:function(e,t){for(var n=0;n<e.length;n++)e[n](t)},poll:function(){if(this._nbCallbacks){var e=navigator.getGamepads();if(e)for(var t=0;t<e.length;t++){var n=e[t];if(n){var i=this._gamePadState[t];if(i){var r=this._callbacks.buttondown,a=this._callbacks.buttonup,o=this._callbacks.buttonvalue;if(r||a||o)for(var s=0;s<n.buttons.length;s++){var u=n.buttons[s],l=i._buttonEvents[s].buttondown;l.value=u.value;var c=i._buttonEvents[s].buttonup;if(c.value=u.value,u.pressed&&!i.buttons[s]&&(r&&r.length&&this._fireCallbacks(r,l),i.buttons[s]=u.pressed),!u.pressed&&i.buttons[s]&&(a&&a.length&&this._fireCallbacks(a,c),i.buttons[s]=!1),u.pressed&&o&&o.length){var h=i._buttonEvents[s].buttonvalue;h.value=u.value,Math.abs(u.value)>=this._valueThreshold&&this._fireCallbacks(o,h)}}var d=this._callbacks.axis;if(d)for(s=0;s<n.axes.length;s++){var f=n.axes[s],p=i._axisEvents[s].axis;p.value=f,Math.abs(f)>=this._valueThreshold&&this._fireCallbacks(d,p)}}}}}}}),"osgViewer","InputSourceGamePad");var yr=Sr,xr=function(){cr.call(this),this._target=window,this._callbacks=[],this._nbCallbacks=0,this._event=new Event("deviceorientation"),this._supportedEvents=["deviceorientation","orientationchange"],this._update=this.onDeviceOrientation.bind(this)};a.a.createPrototypeObject(xr,a.a.objectInherit(cr.prototype,{getName:function(){return"DeviceOrientation"},setEnable:function(e,t,n){if("orientationchange"!==e){var i=this._callbacks,r=i.indexOf(t);n?r<0&&(i.push(t),this._nbCallbacks++):r>=0&&(i.splice(r,1),this._nbCallbacks--),1===this._nbCallbacks&&window.addEventListener(e,this._update),0===this._nbCallbacks&&window.removeEventListener(e,this._update)}else n?this._target.addEventListener(e,t):this._target.removeEventListener(e,t)},onDeviceOrientation:function(e){this.populateEvent(e,this._event)},populateEvent:function(e,t){t.absolute=e.absolute,t.alpha=e.alpha,t.beta=e.beta,t.gamma=e.gamma,t.screenOrientation=window.orientation},isEventRegistered:function(e){if("deviceorientation"===e.type){if(null===e.alpha||void 0===e.alpha)return!1}else if(null===window.orientation||void 0===window.orientation)return!1;return!0},poll:function(){if(this._nbCallbacks)for(var e=0;e<this._callbacks.length;e++)this._callbacks[e](this._event)}}),"osgViewer","InputSourceDeviceOrientation");var Cr=xr,wr=function(e){cr.call(this,e),this._defaultRatio=o.e.fromValues(1,1),this._hammerEvents=["pan","pinch","press","rotate","swipe","doubletap","doubletap2fingers","singletap"],this._supportedEvents=["touchstart","touchend","touchcancel","touchmove"],this._hammer=new tt.a.Manager(e),this._hammer.add(new tt.a.Pan),this._hammer.add(new tt.a.Pinch),this._hammer.get("pan").set({threshold:0,pointers:0});var t=this._hammer.get("pinch");t.set({threshold:.1,enable:!1}),t.recognizeWith(this._hammer.get("pan")),this._hammer.add(new tt.a.Tap({event:"doubletap",pointers:1,taps:2,time:250,interval:450,threshold:5,posThreshold:50})),this._hammer.add(new tt.a.Tap({event:"doubletap2fingers",pointers:2,taps:2,time:250,interval:450,threshold:5,posThreshold:50})),this._hammer.add(new tt.a.Tap({event:"singletap",pointers:1,taps:1,time:250,interval:450,threshold:5,posThreshold:20}))};a.a.createPrototypeObject(wr,a.a.objectInherit(cr.prototype,{getName:function(){return"TouchScreen"},setEnable:function(e,t,n){this._isNativeEvent(e)?n?this._target.addEventListener(e,t):this._target.removeEventListener(e,t):(e.indexOf("pinch")>=0&&n&&this._hammer.get("pinch").set({enable:!0}),n?this._hammer.on(e,t):this._hammer.off(e,t))},populateEvent:function(e,t){if(this._isNativeEvent(e.type)){t.canvasX=t.canvasY=0;for(var n=e.touches.length?e.touches:e.changedTouches,i=n.length,r=0;r<i;++r)t.canvasX+=n[r].clientX/i,t.canvasY+=n[r].clientY/i;t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.altKey=e.altKey,t.metaKey=e.metaKey,t.pointers=e.touches}else t.canvasX=e.center.x,t.canvasY=e.center.y,t.scale=e.scale,t.rotation=e.rotation,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaTime=e.deltaTime,t.direction=e.direction,t.offsetDirection=e.offsetDirection,t.pointers=e.pointers,t.velocity=e.velocity;var a=this._target.getBoundingClientRect();t.canvasX+=-a.left,t.canvasY+=-a.top;var o=this._inputManager.getParam("pixelRatio");o||(o=this._defaultRatio),t.glX=t.canvasX*o[0],t.glY=(this._target.clientHeight-t.canvasY)*o[1]},_isNativeEvent:function(e){return this._supportedEvents.indexOf(e)>=0},isEventRegistered:function(e,t){if(e.preventDefault(),e.pointerType&&"touch"!==e.pointerType)return!1;if(!t.action)return!0;if(isNaN(t.action))throw"touch action should be a number representing the number of touches";var n=e.pointers;n||(n=e.touches);var i=parseInt(t.action);if("touchend"===e.type||"touchcancel"===e.type){if(n.length>=i)return!1}else if(n.length!==i)return!1;return!0},supportsEvent:function(e){var t=cr.prototype.supportsEvent.call(this,e);if(t)return t;for(var n=0;n<this._hammerEvents.length;n++){var i=this._hammerEvents[n];if(0===e.indexOf(i))return!0}return!1},getHammer:function(){return this._hammer}}),"osgViewer","InputSourceTouchScreen");var Tr=wr,Mr=n("jYW0"),Er=n("05ve"),Ar=n("Y6Ma"),Or=n("fgaA"),Rr="ontouchstart"in window||window.TouchEvent||window.DocumentTouch&&document instanceof DocumentTouch,Pr=function(e,t,n){Si.default.call(this),this._startTick=xi.a.instance().tick(),this._stats=void 0,this._running=!1,this._canvas=e;var i=this.initOptions(t),r=this.initWebGLContext(e,i,n);if(!r)throw"No WebGL implementation found";this._updateVisitor=new wi.a,this.setUpView(r.canvas,i),this.initInputManager(i,e),this.initStats(i,e),this._vrSession=null,this._vrSupported=!1,this._requestAnimationFrame=window.requestAnimationFrame.bind(window),this._options=i,this._contextLost=!1,this._forceRestoreContext=!0,this.renderBinded=this.render.bind(this)};a.a.createPrototypeObject(Pr,a.a.objectInherit(Si.default.prototype,{initInputManager:function(e,t){var n=new ur;this._inputManager=n,this._initInputSource(fr,"Mouse",t,e),this._initInputSource(gr,"Keyboard",document,e),Rr&&this._initInputSource(Tr,"TouchScreen",t,e),this._initInputSource(br,"WebVR",void 0,e),this._initInputSource(Cr,"DeviceOrientation",void 0,e),navigator.getGamepads&&this._initInputSource(yr,"GamePad",void 0,e),n.addMappings({"viewer.internals:vrSupported":"vrsupported"},function(){this.setVRSupported(!0)}.bind(this)),n.addMappings({"viewer.internals:hmdConnect":"vrdisplayconnected"},function(){this.setVRReady(!0)}.bind(this)),n.addMappings({"viewer.internals:hmdConnectPolyfill":"vrpolyfilled"},function(){this.setVRPolyfilled(!0)}.bind(this)),n.setParam("pixelRatio",[this._devicePixelRatio,this._devicePixelRatio])},_initInputSource:function(e,t,n,i){var r=i.InputSources?i.InputSources[t]:void 0;if(r){if(!1!==r.enable){var a=r.sourceElement||n;this._inputManager.registerInputSource(new e(a,r))}}else this._inputManager.registerInputSource(new e(n))},getInputManager:function(){return this._inputManager},initOptions:function(e){var t=new yi.a;return e&&t.extend(e),t.extendWithOptionsURL(),!0===t.getBoolean("traceLogCall")&&(A.a.traceLogCall=!0),!0===t.getBoolean("enableFrustumCulling")&&this.getCamera().getRenderer().getCullVisitor().setEnableFrustumCulling(!0),t.xrCompatible=!0,t},initWebGLContext:function(e,t,n){t.get("SimulateWebGLLostContext")&&((e=Ai.makeLostContextSimulatingCanvas(e)).loseContextInNCalls(t.get("SimulateWebGLLostContext")),this._canvas=e);var i=Ei.a.setupWebGL(e,t,n);return e.addEventListener("webglcontextlost",function(e){this.contextLost(),!1!==this._forceRestoreContext&&e.preventDefault()}.bind(this),!1),e.addEventListener("webglcontextrestored",function(){this.contextRestored()}.bind(this),!1),(A.a.reportWebGLError||t.get("reportWebGLError"))&&(i=Ai.makeDebugContext(i)),this.initWebGLCaps(i),this.setGraphicContext(i),i},setContextLostCallback:function(e){this._contextLostCallback=e,this._contextLost&&(this._forceRestoreContext=e())},setContextRestoreCallback:function(e){this._contextRestoreCallback=e},contextLost:function(){A.a.log("webgl context lost"),this._contextLostCallback&&(this._forceRestoreContext=this._contextLostCallback()),this._contextLost=!0,window.cancelAnimationFrame(this._requestID)},contextRestored:function(){!1!==this._forceRestoreContext?(this.restoreContext(),A.a.log("webgl context restored")):A.a.log("webgl context restore not supported - please reload the page - ")},restoreContext:function(){var e=this.getGraphicContext();bn.a.onLostContext(e),_n.a.onLostContext(e),z.a.onLostContext(e),Mi.a.onLostContext(e),mn.a.onLostContext(e),Ue.default.getTextureManager(e).onLostContext(e),Ti.a.onLostContext(e),this.getCamera().getRenderer().getState().resetCaches(),this.initWebGLCaps(e,!0),this.setGraphicContext(e),Ci.a.instance(this.getGraphicContext(),!0),this._stats&&this._stats.reset(),this._contextLost=!1,this._requestRedraw=!0,this._contextRestoreCallback&&this._contextRestoreCallback(e),this._runImplementation()},init:function(){},getUpdateVisitor:function(){return this._updateVisitor},getState:function(){return this.getCamera().getRenderer().getState()},initStats:function(e){var t=Ci.a.instance(this.getGraphicContext());e.getBoolean("stats")?(this._stats=new Ui(this,e),this._stats.addConfig(ji),this._stats.addConfig(er),this._stats.addConfig(rr),this.getCamera().addChild(this._stats.getNode()),t.setCallback(this.callbackTimerGPU.bind(this))):t.disable()},callbackTimerGPU:function(e,t){this._stats&&this._stats.getCounter(t).set(e/1e6)},getViewerStats:function(){return this._stats},renderingTraversal:function(){if(this.getState()._frameStamp=this._frameStamp,this.getScene().getSceneData()&&this.getScene().getSceneData().getBound(),this.getCamera()){var e=this._stats,t=Ci.a.instance(this.getGraphicContext()),n=this.getCamera().getRenderer();if(e&&e.getCounter("cull").start(),n.cull(),e&&e.getCounter("cull").end(),t.pollQueries(),t.start("glframe"),e&&e.getCounter("render").start(),n.draw(),e&&e.getCounter("render").end(),t.end("glframe"),e){var i=n.getCullVisitor();e.getCounter("cullcamera").set(i._numCamera),e.getCounter("cullmatrixtransform").set(i._numMatrixTransform),e.getCounter("cullprojection").set(i._numProjection),e.getCounter("cullnode").set(i._numNode),e.getCounter("culllightsource").set(i._numLightSource),e.getCounter("cullgeometry").set(i._numGeometry),e.getCounter("pushstateset").set(n.getState()._numPushStateSet),e.getCounter("applyStateSet").set(n.getState()._numApply)}}},updateTraversal:function(){var e=this._stats;e&&e.getCounter("update").start(),this._updateVisitor.resetStats(),this.getScene().updateSceneGraph(this._updateVisitor),e&&e.getCounter("updatecallback").set(this._updateVisitor._numUpdateCallback),this.getDatabasePager().releaseGLExpiredSubgraphs(.005),this.flushDeletedGLObjects(.005),e&&e.getCounter("update").end()},advance:function(e){var t=e;void 0===t&&(t=Number.MAX_VALUE);var n=this._frameStamp,i=n.getFrameNumber();n.setFrameNumber(i+1);var r=xi.a.instance().deltaS(this._startTick,xi.a.instance().tick());n.setReferenceTime(r);var a=n.getSimulationTime();n.setSimulationTime(t===Number.MAX_VALUE?r:t),n.setDeltaTime(n.getSimulationTime()-a)},beginFrame:function(){var e=this._stats;e&&(e.getCounter("frame").start(),e.getCounter("raf").tick(),e.getCounter("fps").frame())},endFrame:function(){var e=this.getFrameStamp().getFrameNumber();this._stats&&(Ue.default.getTextureManager(this.getGraphicContext()).updateStats(e,this._stats),this._stats.getCounter("stats").start(),this._stats.update(),this._stats.getCounter("stats").end(),this._stats.getCounter("frame").end())},checkNeedToDoFrame:function(){return this._requestContinousUpdate||this._requestRedraw},frame:function(e,t){if(!this._contextLost){this.beginFrame(),this.advance();var n=this.updateViewport(),i={};this._vrSession&&(i.frame=t,i.xrReferenceSpace=this._xrReferenceSpace,this._xrFrame=t),this._inputManager.update(i),this._updateVisitor.setFrameStamp(this.getFrameStamp()),this.getManipulator()&&(this.getManipulator().update(this._updateVisitor),o.c.copy(this.getCamera().getViewMatrix(),this.getManipulator().getInverseMatrix())),(this.checkNeedToDoFrame()||n)&&(this._requestRedraw=!1,this.updateTraversal(),this.renderingTraversal()),this.endFrame()}},stop:function(){this._running=!1},isRunning:function(){return this._running},render:function(e,t){this.isRunning()&&(this._requestID=this._requestAnimationFrame(this.renderBinded),this.frame(e,t))},_runImplementation:function(){this.render()},run:function(){this.isRunning()||(this._running=!0,this._runImplementation())},setVRSupported:function(e){e&&console.log("Webxr, is supported!"),this._vrSupported=!!e},setVRReady:function(e){e&&console.log("Found the VR DISPLAY"),this._vRReady=!!e},isVRSupported:function(){return this._vrSupported},setVRPolyfilled:function(e){console.log("I lied about webxr, but it might work with the polyfill."),this._vrPolyfilled=!!e},getVRSession:function(){return this._vrSession},getXRPose:function(e){if(this._xrFrame)return this._xrFrame.getPose(e,this._xrReferenceSpace)},needsVRPolyFill:function(){return!!this._vrPolyfilled&&!this._vrPolyfillLoaded},loadWebxrPolyFill:function(){return n.e(110).then(function(){window.WebXRPolyfill=n("RLSh")}.bind(null,n)).catch(n.oe).then(function(){return new window.WebXRPolyfill.default,this._vrPolyfillLoaded=!0,this.getInputManager().getInputSource("WebVR").pollHeadset().then(function(){this.setVRSupported(!0),this.setVRReady(!0)}.bind(this)).catch(function(e){return this.setVRSupported(!1),this.setVRReady(!1),Te.a.reject(e)}.bind(this))}.bind(this))},_getVRPixelRatio:function(e){return Object(Or.a)().vrScaleRtt>0?Object(Or.a)().maxDevicePixelRatio:window.XRWebGLLayer.getNativeFramebufferScaleFactor(e)},setPresentVR:function(e){if(!this.isVRSupported())return A.a.warn("VR not supported by the browser!"),Te.a.reject("VR not supported by the browser!");if(!this._vRReady)return A.a.log("VR headset not plugged in or immersive session not supported!"),Te.a.reject("VR headset not plugged in or immersive session not supported!");var t,n=function(e){return this._xrReferenceSpace=e,window.cancelAnimationFrame(this._requestID),this._requestAnimationFrame=this._vrSession.requestAnimationFrame.bind(this._vrSession),this._requestID=this._requestAnimationFrame(this.renderBinded),this.getCamera().frameBufferObject=new mn.a,this.getCamera().frameBufferObject.setFrameBufferObject(this,t.framebuffer),this._vrSession}.bind(this),i=function(e){this._vrSession=e;var i=1/this._getVRPixelRatio(e);return t=new window.XRWebGLLayer(this._vrSession,this.getGraphicContext(),{framebufferScaleFactor:i}),this._vrSession.updateRenderState({baseLayer:t}),e.requestReferenceSpace("local").then(n).catch(function(e){return e})}.bind(this);if(e)return this._vrSession?Te.a.resolve(this.vrSession):navigator.xr.requestSession("immersive-vr").then(i).catch(function(e){console.log(e)});if(this._vrSession){this._vrSession.cancelAnimationFrame(this._requestID),this.getCamera().frameBufferObject=new mn.a,this._requestAnimationFrame=window.requestAnimationFrame.bind(window),this._requestID=this._requestAnimationFrame(this.renderBinded);var r=this._vrSession.end();return this._vrSession=void 0,r}},setupManipulator:function(e){void 0===e&&(e=new on({inputManager:this._inputManager})),void 0!==e.setNode?e.setNode(this.getSceneData()):e.view=this,e.setCamera(this.getCamera()),this.setManipulator(e)},updateViewport:function(){var e=this.getGraphicContext().canvas;if(!this.computeCanvasSize(e))return!1;var t=this.getCamera(),n=t.getViewport(),i=n.width(),r=n.height(),a=e.width/i,s=e.height/r,u=a/s;return n.setViewport(Math.round(n.x()*a),Math.round(n.y()*s),Math.round(n.width()*a),Math.round(n.height()*s)),1!==u&&o.c.mul(t.getProjectionMatrix(),t.getProjectionMatrix(),o.c.fromScaling(o.c.create(),[1/u,1,1])),!0},setManipulator:function(e){this.setEnableManipulator(!1),e.getCamera()||e.setCamera(this.getCamera()),e.setEnable(!0),Si.default.prototype.setManipulator.call(this,e)},setEnableManipulator:function(e){this._manipulator&&this._manipulator.setEnable(e)},dispose:function(){Mr.a.clean(),Er.a.clean(),Ar.a.pooledStateGraph.clean()}}),"osgViewer","Viewer");var Ir=Pr,Nr=n("cuuI"),Lr={};Lr.Renderer=bi.default,Lr.View=Si.default,Lr.Viewer=Ir,Lr.Scene=Nr.a,Lr.InputGroups=Ct.a;var kr=Lr,Dr=n("nplI"),Fr=n("Qavt"),Vr=function(e,t){Fr.a.call(this),this._enable=!e,this._shadowReceiveAttribute=t,this._dirtyHash=!0,this._hash=""};a.a.createPrototypeStateAttribute(Vr,a.a.objectInherit(Fr.a.prototype,{attributeType:"ShadowCast",cloneType:function(){return new Vr(!0)},setReceiveAttribute:function(e){this._shadowReceiveAttribute=e},getReceiveAttribute:function(){return this._shadowReceiveAttribute},getDefines:function(){return this._shadowReceiveAttribute.getDefines()},_computeInternalHash:function(){return"ShadowCast"+this._enable+this._shadowReceiveAttribute.getPrecision()},getHash:function(){return this._shadowReceiveAttribute&&this._shadowReceiveAttribute._dirtyHash&&(this._receiveAttributeDirty=!0),this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},isEnabled:function(){return this._enable}}),"osgShadow","ShadowCastAttribute");var Br=Vr,Ur=n("vcgX"),jr=n("4KCM"),Gr=function(e){j.a.call(this),this._noCastMask=e,this._nodeList=[]};a.a.createPrototypeObject(Gr,a.a.objectInherit(j.a.prototype,{reset:function(){this._nodeList=[]},removeNodeFromCasting:function(e){var t=e.getNodeMask();-1===t?(t=this._noCastMask,e.setNodeMask(t),this._nodeList.push(e)):0!=(t&~this._noCastMask)&&(e.setNodeMask(t|this._noCastMask),this._nodeList.push(e))},apply:function(e){var t=e.getStateSet();if(t){var n=t.getAttribute("BlendFunc");if(void 0!==n&&n.getSource()!==je.a.DISABLE){var i=t.getAttribute("Depth");if(i&&(i.getFunc()===dn.a.DISABLE||!1===i.getWriteMask()))return void this.removeNodeFromCasting(e)}}e.getTypeID()!==Ur.a.typeID&&e.getTypeID()!==jr.a.typeID?e.getTypeID()===gn.a.typeID&&e.isRenderToTextureCamera()?this.removeNodeFromCasting(e):this.traverse(e):this.removeNodeFromCasting(e)},setNoCastMask:function(e){this._noCastMask=e},restore:function(){for(var e=0,t=this._nodeList.length;e<t;e++){var n=this._nodeList[e],i=n.getNodeMask();i===this._noCastMask?n.setNodeMask(-1):n.setNodeMask(i&~this._noCastMask)}}}),"osgShadow","ShadowCasterVisitor");var Hr=Gr,zr=n("EnLC"),Wr=n("b/No"),qr=function(){j.a.call(this,j.a.TRAVERSE_ALL_CHILDREN),this._pooledMatrix=new zr.a(o.c.create),this._matrixStack=new Wr.a,this._matrixStack.push(o.c.IDENTITY),this._bb=new Vi.a,this._bs=new nt.a};a.a.createPrototypeObject(qr,a.a.objectInherit(j.a.prototype,{reset:function(e,t,n,i,r){this.setTraversalMask(e),this._cameraFrustum=n,this._lightFrustum=r,this.getCameraPlaneMaskForLightNear(t,n,i?6:4),this._pooledMatrix.reset(),this._matrixStack.reset(),this._matrixStack.push(o.c.IDENTITY),this._bb.init()},getBoundingBox:function(){return this._bb},getCameraPlaneMaskForLightNear:function(e,t,n){var i,r=1,a=15;for(i=0;i<n;++i)a=a<<1|1;var o=t.getPlanes();for(i=0;i<n;++i)ut.a.distanceToPlane(o[i],e)<0&&(a^=r),r<<=1;return this._cameraPlaneMaskedByLightNear=a,t.setResultMask(a),t.pushCurrentMask(a),a},applyTransform:function(e){var t=this._pooledMatrix.getOrCreateObject();o.c.copy(t,this._matrixStack.back()),e.computeLocalToWorldMatrix(t,this);var n=this._bs;e.getBound().transformMat4(this._bs,t),(0===this._cameraFrustum.getCurrentMask()||this._cameraFrustum.containsBoundingSphere(n))&&(0===this._lightFrustum.getCurrentMask()||this._lightFrustum.containsBoundingSphere(n))&&(this._cameraFrustum.pushCurrentMask(),this._lightFrustum.pushCurrentMask(),this.pushMatrix(t),this.traverse(e),this._cameraFrustum.popCurrentMask(),this._lightFrustum.popCurrentMask(),this.popMatrix())},applyBoundingBox:function(){var e=new Vi.a;return function(t){var n=this._matrixStack.back();o.c.exactEquals(n,o.c.IDENTITY)?this._bb.expandByBoundingBox(t):t.valid()&&(t.transformMat4(e,n),this._bb.expandByBoundingBox(e))}}(),apply:function(e){var t=e.getTypeID();if(e instanceof Ve.a)this.applyTransform(e);else if(t!==Re.a.getTypeID())t===gn.a.getTypeID()||Ur.a.getTypeID(),this.traverse(e);else{var n=this._bs;if(e.getBound().transformMat4(n,this._matrixStack.back()),0!==this._cameraFrustum.getCurrentMask()&&!this._cameraFrustum.containsBoundingSphere(n))return;if(0!==this._lightFrustum.getCurrentMask()&&!this._lightFrustum.containsBoundingSphere(n))return;this.applyBoundingBox(e.getBoundingBox())}},pushMatrix:function(e){this._matrixStack.push(e)},popMatrix:function(){this._matrixStack.pop()}}),"osgShadow","ComputeMultiFrustumBoundsVisitor");var Xr=qr,Yr=n("AwiE"),Kr=function(e,t){Fr.a.call(this),this._lightNumber=e,this._bias=.001,this._normalBias=void 0,this._precision="UNSIGNED_BYTE",this._kernelSizePCF=void 0,this._fakePCF=!0,this._jitterOffset="none",this._enable=!t,this._isAtlasTexture=!1,this._dirtyHash=!0,this._hash=""};Kr.uniforms={},a.a.createPrototypeStateAttribute(Kr,a.a.objectInherit(Fr.a.prototype,{attributeType:"ShadowReceive",cloneType:function(){return new Kr(this._lightNumber,!0)},getTypeMember:function(){return this.attributeType+this.getLightNumber()},getLightNumber:function(){return this._lightNumber},getUniformName:function(e){return"u"+(this.getType()+this.getLightNumber().toString())+"_"+e},getAtlas:function(){return this._isAtlasTexture},setAtlas:function(e){this._isAtlasTexture=e},setBias:function(e){this._bias=e},getBias:function(){return this._bias},setNormalBias:function(e){this._normalBias=e},getNormalBias:function(){return this._normalBias},setJitterOffset:function(e){this._jitterOffset=e},getJitterOffset:function(){return this._jitterOffset},getKernelSizePCF:function(){return this._kernelSizePCF},setKernelSizePCF:function(e){this._kernelSizePCF=e,this._dirtyHash=!0},setPrecision:function(e){this._precision=e,this._dirtyHash=!0},getPrecision:function(){return this._precision},setLightNumber:function(e){this._lightNumber=e,this._dirtyHash=!0},getOrCreateUniforms:function(){var e=Kr,t=this.getTypeMember();return e.uniforms[t]?e.uniforms[t]:(e.uniforms[t]={bias:fn.a.createFloat(this.getUniformName("bias")),normalBias:fn.a.createFloat(this.getUniformName("normalBias"))},e.uniforms[t])},getDefines:function(){var e=[];switch(this.getKernelSizePCF()){case"4Tap(16texFetch)":e.push("#define _PCFx4");break;case"9Tap(36texFetch)":e.push("#define _PCFx9");break;case"16Tap(64texFetch)":e.push("#define _PCFx25");break;default:case"1Tap(4texFetch)":e.push("#define _PCFx1")}return"UNSIGNED_BYTE"!==this.getPrecision()&&e.push("#define _FLOATTEX"),this.getAtlas()&&e.push("#define _ATLAS_SHADOW"),this.getNormalBias()&&e.push("#define _NORMAL_OFFSET"),"none"!==this.getJitterOffset()&&e.push("#define _JITTER_OFFSET"),e},apply:function(){if(this._enable){var e=this.getOrCreateUniforms();e.normalBias.setFloat(this._normalBias),e.bias.setFloat(this._bias)}},isEnabled:function(){return this._enable},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+"_"+this.getKernelSizePCF()}}),"osgShadow","ShadowReceiveAttribute");var Qr=Kr,Jr=function(){O.a.call(this),this._shadowedScene=void 0,this._dirty=!1,this._continuousUpdate=!0,this._needRedraw=!0};a.a.createPrototypeObject(Jr,a.a.objectInherit(O.a.prototype,{dirty:function(){this._dirty=!0},getShadowedScene:function(){return this._shadowedScene},setContinuousUpdate:function(e){this._continuousUpdate=e},isContinuousUpdate:function(){return this._continuousUpdate},needRedraw:function(){return this._needRedraw},requestRedraw:function(){this._needRedraw=!0},setShadowedScene:function(e){this._shadowedScene=e},init:function(){A.a.log("No ShadowTechnique activated: normal rendering activated")},valid:function(){return!1},updateShadowTechnique:function(){},cullShadowCasting:function(){},cleanSceneGraph:function(){A.a.log("No ShadowTechnique activated: normal rendering activated")}}),"osgShadow","ShadowTechnique");var Zr=Jr,$r=function(){Ue.default.call(this),this._uniforms={},this._mapSize=o.g.create(),this._renderSize=o.e.create(),this._lightNumber=-1,this._dirtyHash=!0,this._hash=""};$r.uniforms={},a.a.createPrototypeStateAttribute($r,a.a.objectInherit(Ue.default.prototype,{cloneType:function(){return new $r},invalidate:function(){Ue.default.prototype.invalidate.call(this),this.dirty()},hasLightNumber:function(e){return this._lightNumber===e},setLightNumber:function(e){this._lightNumber=e,this._dirtyHash=!0},getLightNumber:function(){return this._lightNumber},getUniformName:function(e){return"u"+("Shadow_"+this.getType()+this._lightNumber.toString())+"_"+e},setInternalFormatType:function(e){Ue.default.prototype.setInternalFormatType.call(this,e),this._dirtyHash=!0},getOrCreateUniforms:function(e){var t=$r;if(A.a.assert(void 0!==e),A.a.assert(-1!==this._lightNumber),void 0!==t.uniforms[e])return t.uniforms[e];var n=t.uniforms[e]={ViewRight:fn.a.createFloat4(this.getUniformName("viewRight")),ViewUp:fn.a.createFloat4(this.getUniformName("viewUp")),ViewLook:fn.a.createFloat4(this.getUniformName("viewLook")),Projection:fn.a.createFloat3(this.getUniformName("projection")),DepthRange:fn.a.createFloat2(this.getUniformName("depthRange")),MapSize:fn.a.createFloat4(this.getUniformName("mapSize")),RenderSize:fn.a.createFloat2(this.getUniformName("renderSize"))},i="Texture"+e,r=fn.a.createInt1(e,i);return n[i]=r,t.uniforms[e]},setViewMatrix:function(e){this._viewMatrix=e},setProjection:function(e){this._projection=e},setDepthRange:function(e){this._depthRange=e},setTextureSize:function(e,t){Ue.default.prototype.setTextureSize.call(this,e,t),this.dirty(),this._mapSize[0]=e,this._mapSize[1]=t,this._mapSize[2]=1/e,this._mapSize[3]=1/t,this._renderSize[0]=1/e,this._renderSize[1]=1/t},_updateViewMatrixUniforms:function(e,t,n,i){var r,a=e;(r=t.getInternalArray())[0]=a[0],r[1]=a[4],r[2]=a[8],r[3]=a[12],(r=n.getInternalArray())[0]=a[1],r[1]=a[5],r[2]=a[9],r[3]=a[13],(r=i.getInternalArray())[0]=a[2],r[1]=a[6],r[2]=a[10],r[3]=a[14]},apply:function(e,t){if(Ue.default.prototype.apply.call(this,e,t),-1!==this._lightNumber){var n=this.getOrCreateUniforms(t);this._updateViewMatrixUniforms(this._viewMatrix,n.ViewRight,n.ViewUp,n.ViewLook),n.Projection.setFloat3(this._projection),n.DepthRange.setFloat2(this._depthRange),n.MapSize.setFloat4(this._mapSize),n.RenderSize.setFloat2(this._renderSize)}},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+"_"+this._lightNumber+"_"+this._type}}),"osgShadow","ShadowTexture");var ea=$r,ta=n("oCbj"),na=function(e){this._shadowTechnique=e};a.a.createPrototypeObject(na,{cull:function(e,t){this._shadowTechnique.getShadowedScene().nodeTraverse(t);var n=t.getCurrentCullingSet(),i=t.getCurrentProjectionMatrix(),r=t.getComputedNear(),a=t.getComputedFar();return r===1/0&&a===-1/0?(this._shadowTechnique.markSceneAsNoShadow(),!1):(o.c.getFrustumPlanes(n.getFrustum().getPlanes(),i,t.getCurrentModelViewMatrix(),!1),n.getFrustum().setupMask(6),this._shadowTechnique.setLightFrustum(n.getFrustum(),r,a),!1)}},"osgShadow","CameraCullCallback");var ia=function(e,t){Zr.call(this),this._projectionMatrix=o.c.create(),this._projection=o.f.create(),this._viewMatrix=o.c.create(),this._lightNumberArrayIndex=-1,this._lightUp=o.f.fromValues(0,0,1),this._light=e.light,this._cameraShadow=new gn.a,this._cameraShadow.setCullCallback(new na(this)),this._cameraShadow.setRenderOrder(gn.a.PRE_RENDER,0),this._cameraShadow.setReferenceFrame(ii.a.ABSOLUTE_RF),this._cameraShadow.setClearColor(o.g.fromValues(1,1,1,1)),t?this._texture=t:(this._texture=new ea,this._textureUnitBase=4,this._textureUnit=this._textureUnitBase,this._textureMagFilter=void 0,this._textureMinFilter=void 0),this._textureSize=256;var n=fn.a.createFloat2("RenderSize");this._texelSizeUniform=fn.a.createFloat1(1/this._textureSize,"texelSize"),this._renderSize=n.getInternalArray(),this._renderSize[0]=this._renderSize[1]=this._textureSize,this._receivingStateset=void 0,this._casterStateSet=new pn.a,this._casterStateSet.addUniform(fn.a.createFloat1(0,"exponent0")),this._casterStateSet.addUniform(fn.a.createFloat1(0,"exponent1")),this._casterStateSet.addUniform(fn.a.createFloat1(.005,"bias")),this._casterStateSet.addUniform(this._texelSizeUniform),this._casterStateSet.addUniform(n),this._casterStateSet.setAttributeAndModes(new dn.a(dn.a.LESS),Fr.a.ON|Fr.a.OVERRIDE),this._casterStateSet.setAttributeAndModes(new je.a,Fr.a.ON|Fr.a.OVERRIDE),this._shadowReceiveAttribute=new Qr(this._light.getLightNumber()),this._casterStateSet.setAttributeAndModes(this._shadowReceiveAttribute,Fr.a.ON|Fr.a.OVERRIDE),this._shadowCastShaderGeneratorName="ShadowCast";var i=fn.a.createFloat4("uShadowDepthRange");this._casterStateSet.addUniform(i),this._depthRange=i.getInternalArray(),this._depthRange[0]=.001,this._depthRange[1]=1e3,this._worldLightPos=o.g.create(),this._worldLightPos[3]=0,this._worldLightDir=o.g.create(),this._worldLightDir[3]=1,this._castsShadowDrawTraversalMask=4294967295,this._castsShadowBoundsTraversalMask=4294967295,this._tmpVec=o.f.create(),this._tmpVecBis=o.f.create(),this._tmpVecTercio=o.f.create(),this._tmpMatrix=o.c.create(),e&&this.setShadowSettings(e),this._infiniteFrustum=!0;var r=new Br(!1,this._shadowReceiveAttribute);this._casterStateSet.setAttributeAndModes(r,Fr.a.ON|Fr.a.OVERRIDE),this._casterStateSet.setShaderGeneratorName(this._shadowCastShaderGeneratorName,Fr.a.OVERRIDE|Fr.a.ON),this._debug=!1};a.a.createPrototypeObject(ia,a.a.objectInherit(Zr.prototype,{getDepthRange:function(){return this._depthRange},setLightFrustum:function(e,t,n){this._lightFrustum=e,this._depthRange[0]=t,this._depthRange[1]=n,this.nearFarBounding(),this._debug&&(this._debugGeomFrustum.updateGeometry(this._projectionMatrix,this._depthRange),o.c.invert(this._debugNodeFrustum.getMatrix(),this._viewMatrix))},getCamera:function(){return this._cameraShadow},getTexture:function(){return this._texture},isDirty:function(){return this._dirty},setTextureUnitBase:function(e){this._textureUnitBase=e,this._textureUnit=e},setShadowSettings:function(e){e&&(this._light=e.light,this._shadowCastShaderGeneratorName=e.getShadowCastShaderGeneratorName(),this.setCastsShadowDrawTraversalMask(e.castsShadowDrawTraversalMask),this.setCastsShadowBoundsTraversalMask(e.castsShadowBoundsTraversalMask),this.setLight(this._light),this.setTextureSize(e.textureSize),this.setTexturePrecision(e.textureType),this.setKernelSizePCF(e.kernelSizePCF),this.setBias(e.bias),this.setNormalBias(e.normalBias))},setCastsShadowDrawTraversalMask:function(e){this._castsShadowDrawTraversalMask=e},getCastsShadowDrawTraversalMask:function(){return this._castsDrawShadowTraversalMask},setCastsShadowBoundsTraversalMask:function(e){this._castsShadowBoundsTraversalMask=e},getCastsShadowBoundsTraversalMask:function(){return this._castsShadowBoundsTraversalMask},getNormalBias:function(){return this._shadowReceiveAttribute.getNormalBias()},setNormalBias:function(e){this._shadowReceiveAttribute.setNormalBias(e)},getJitterOffset:function(){return this._shadowReceiveAttribute.getJitterOffset()},setJitterOffset:function(e){this._shadowReceiveAttribute.setJitterOffset(e)},getBias:function(){return this._shadowReceiveAttribute.getBias()},setBias:function(e){this._shadowReceiveAttribute.setBias(e),this._casterStateSet.getUniformList().bias.getUniform().setFloat(e)},getKernelSizePCF:function(){return this._shadowReceiveAttribute.getKernelSizePCF()},setKernelSizePCF:function(e){this._shadowReceiveAttribute.setKernelSizePCF(e)},setShadowedScene:function(e){Zr.prototype.setShadowedScene.call(this,e),this._receivingStateset=this._shadowedScene.getReceivingStateSet(),this.dirty()},checkLightNumber:function(){var e=this._light.getLightNumber();this._shadowReceiveAttribute.getLightNumber()!==e&&this._receivingStateset.getAttribute(this._shadowReceiveAttribute.getTypeMember())===this._shadowReceiveAttribute&&this._receivingStateset.removeAttribute(this._shadowReceiveAttribute.getTypeMember()),this._texture&&!this._texture.hasLightNumber(e)&&this._receivingStateset.getTextureAttribute(this._textureUnit,this._texture.getTypeMember())===this._texture&&this._receivingStateset.removeTextureAttribute(this._textureUnit,this._texture.getTypeMember())},_rebindFbo:function(){this._cameraShadow.detachAll(),this._cameraShadow.attachTexture(mn.a.COLOR_ATTACHMENT0,this._texture),this._cameraShadow.attachRenderBuffer(mn.a.DEPTH_ATTACHMENT,mn.a.DEPTH_COMPONENT16)},init:function(e,t,n){if(this._shadowedScene){this._needRedraw=!0,this.checkLightNumber();var i=this._light.getLightNumber();e?(this._texture=e,this._lightNumberArrayIndex=t,this._textureUnit=n,this._shadowReceiveAttribute.setAtlas(!0)):(this.initTexture(),this._rebindFbo(),this._textureUnit=this._textureUnitBase+i,this._texture.setLightNumber(i),this._texture.setName("ShadowTexture"+this._textureUnit),this._shadowReceiveAttribute.setAtlas(!1)),this._cameraShadow.setName("light_shadow_camera"+this._light.getName()),this._shadowReceiveAttribute.setLightNumber(i);var r=Fr.a.OVERRIDE|Fr.a.ON;this._receivingStateset.setAttributeAndModes(this._shadowReceiveAttribute,r),this._preventTextureBindingDuringShadowCasting(),this._casterStateSet.setTextureAttributeAndModes(this._textureUnit,Ue.default.textureNull,Fr.a.PROTECTED),this._receivingStateset.setTextureAttributeAndModes(this._textureUnit,this._texture,r),this._dirty=!1}},_preventTextureBindingDuringShadowCasting:function(){for(var e=Yr.a.instance().getWebGLParameter("MAX_TEXTURE_IMAGE_UNITS"),t=0;t<e;t++)this._casterStateSet.setTextureAttributeAndModes(t,Ue.default.textureNull,Fr.a.OVERRIDE|Fr.a.ON)},valid:function(){return!0},updateShadowTechnique:function(e,t,n){var i=this._cameraShadow,r=this._texture;if(i&&r){var a=i.getViewport();if(a||(a=new vn.a,i.setViewport(a)),t){var o=i.getScissor();o||(o=new ta.a(t[0],t[1],t[2],t[3]),i.setScissor(o)),a.x()===t[0]&&a.y()===t[1]&&a.width()===t[2]&&a.height()===t[3]||(i.setFrameBufferObject(n),a.setViewport(t[0],t[1],t[2],t[3]),o.setScissor(t[0],t[1],t[2],t[3]))}else a.width()===r.getWidth()&&a.height()===r.getHeight()||(this._rebindFbo(),a.setViewport(0,0,r.getWidth(),r.getHeight()))}},updateShadowTechnic:function(){A.a.log("ShadowMap.updateShadowTechnic() is deprecated, use updateShadowTechnique instead"),this.updateShadowTechnique()},setTextureFiltering:function(){var e;switch(this.getTexturePrecision()){case"HALF_FLOAT":e=Ue.default.HALF_FLOAT;break;case"FLOAT":e=Ue.default.FLOAT;break;default:case"UNSIGNED_BYTE":e=Ue.default.UNSIGNED_BYTE}this._texture.setInternalFormatType(e),this._texture.setMinFilter(Ue.default.NEAREST),this._texture.setMagFilter(Ue.default.NEAREST),this._textureMagFilter=Ue.default.NEAREST,this._textureMinFilter=Ue.default.NEAREST},initTexture:function(){var e;this._dirty&&(this._texture||(this._texture=new ea,this._textureUnit=this._textureUnitBase),this._texture.setTextureSize(this._textureSize,this._textureSize),this._texelSizeUniform.setFloat(1/this._textureSize),this._renderSize[0]=this._textureSize,this._renderSize[1]=this._textureSize,e=Ue.default.RGBA,this.setTextureFiltering(),this._texture.setInternalFormat(e),this._texture.setWrapS(Ue.default.CLAMP_TO_EDGE),this._texture.setWrapT(Ue.default.CLAMP_TO_EDGE),this._texture.dirty())},setTexturePrecision:function(e){e!==this._shadowReceiveAttribute.getPrecision()&&(this._shadowReceiveAttribute.setPrecision(e),this.dirty())},getTexturePrecision:function(){return this._shadowReceiveAttribute.getPrecision()},setTextureSize:function(e){e!==this._textureSize&&(this._textureSize=e,this.dirty())},getCasterStateSet:function(){return this._casterStateSet},setLight:function(e){e&&e!==this._light&&(this._light=e,this.dirty())},getUp:function(e){return Math.abs(o.f.dot(this._lightUp,e))>=1&&(1===this._lightUp[0]?(this._lightUp[0]=0,this._lightUp[1]=1,this._lightUp[2]=0):(this._lightUp[0]=1,this._lightUp[1]=0,this._lightUp[2]=0)),this._lightUp},nearFarBounding:function(){var e=this._depthRange[0],t=this._depthRange[1],n=ia.EPSILON;t<e-n?(this._emptyCasterScene=!0,t=1,e=n):e<n&&(e=n),this._depthRange[0]=e,this._depthRange[1]=t},makePerspectiveFromBoundingBox:function(e,t,n,i,r,a){var s=e.center(this._tmpVec),u=e.radius(),l=ia.EPSILON,c=l,h=1;this._radius=u;var d=o.f.distance(s,n);d<=u?(c=l,h=d+u):(c=d-u,h=d+u),this._depthRange[0]=c,this._depthRange[1]=h,this.nearFarBounding();var f=this._depthRange[0]*Math.tan(t*Math.PI/180),p=f=f>u?u:f,g=-p,m=f,v=-m,_=this.getUp(i);this._infiniteFrustum?o.c.infiniteFrustum(a,v,m,g,p,this._depthRange[0]):o.c.frustum(a,v,m,g,p,this._depthRange[0],this._depthRange[1]),this._projection[0]=this._projectionMatrix[0],this._projection[1]=this._projectionMatrix[5],this._projection[2]=0,o.c.lookAtDirection(r,n,i,_)},makeOrthoFromBoundingBox:function(e,t,n,i){var r=e.center(this._tmpVecTercio),a=e.radius(),s=a+a,u=1e-4,l=s+1e-4,c=this._tmpVec;o.f.scaleAndAdd(c,r,t,-s);(u=a)<.001*(l+=a)&&(u=.001*l);var h,d,f=this.getUp(t);o.c.lookAtDirection(n,c,t,f),h=d=a,o.c.ortho(i,-h,h,-d,d,u,l),this._projection[0]=h,this._projection[1]=d,this._projection[2]=1,this._depthRange[0]=u,this._depthRange[1]=l},aimShadowCastingCamera:function(e,t){var n=this._light;if(n){var i=this._cameraShadow,r=this._worldLightPos,a=this._worldLightDir;o.c.copy(this._projectionMatrix,i.getProjectionMatrix()),o.c.copy(this._viewMatrix,i.getViewMatrix());for(var s,u=this._projectionMatrix,l=this._viewMatrix,c=e.getCurrentRenderBin().getPositionedAttribute(),h=c.getArray(),d=0;d<c.getLength();d++){var f=h[d],p=f[1],g=f[0];if(p===n){s=g;break}}if(void 0===s)return A.a.warn("light isnt inside children of shadowedScene Node"),void(this._emptyCasterScene=!0);var m=this._tmpMatrix;if(o.c.invert(m,e.getCurrentModelViewMatrix()),this._light.isDirectionLight())o.g.transformMat4(r,n.getPosition(),s),o.g.transformMat4(r,r,m),o.f.scale(r,r,-1),o.f.normalize(r,r),this.makeOrthoFromBoundingBox(t,r,l,u),this._debug&&o.c.invert(this._debugNodeFrustum.getMatrix(),l);else{o.c.mul(this._tmpMatrix,m,s);var v=this._tmpMatrix;o.f.transformMat4(r,n.getPosition(),v),v[12]=0,v[13]=0,v[14]=0,o.c.invert(v,v),o.c.transpose(v,v),o.f.copy(a,n.getDirection()),o.g.transformMat4(a,a,v),o.f.normalize(a,a),this.makePerspectiveFromBoundingBox(t,n.getSpotCutoff(),r,a,l,u)}o.c.copy(i.getProjectionMatrix(),this._projectionMatrix),o.c.copy(i.getViewMatrix(),this._viewMatrix)}else this._emptyCasterScene=!0},frameShadowCastingFrustum:function(e){this._infiniteFrustum||De.a.prototype.clampProjectionMatrix(this._projectionMatrix,this._depthRange[0],this._depthRange[1],e.getNearFarRatio(),this._depthRange);var t=this._cameraShadow;o.c.copy(t.getProjectionMatrix(),this._projectionMatrix),o.c.copy(t.getViewMatrix(),this._viewMatrix),this.setShadowUniformsReceive(!1)},setShadowUniformsReceive:function(e){if(e&&o.e.set(this._depthRange,0,0),-1!==this._lightNumberArrayIndex){var t=this._light.getLightNumber();this._texture.setViewMatrix(t,this._viewMatrix),this._texture.setProjection(t,this._projection),this._texture.setDepthRange(t,this._depthRange)}else this._texture.setViewMatrix(this._viewMatrix),this._texture.setProjection(this._projection),this._texture.setDepthRange(this._depthRange)},markSceneAsNoShadow:function(){this.setShadowUniformsReceive(!0),this._needRedraw=!1},cullShadowCasting:function(e,t){if(this._debug){var n=t.getMin(),i=t.getMax();t.center(this._tmpVec);var r=this._debugNodeSceneCast.getMatrix();o.c.fromScaling(r,[i[0]-n[0],i[1]-n[1],i[2]-n[2],1]),o.c.setTranslation(r,this._tmpVec)}if(this._emptyCasterScene=!1,this.aimShadowCastingCamera(e,t),this._emptyCasterScene)this.markSceneAsNoShadow();else{var a=e.getTraversalMask();e.setTraversalMask(this._castsShadowDrawTraversalMask),e.pushStateSet(this._casterStateSet),this._cameraShadow.setEnableFrustumCulling(!0),this._cameraShadow.setComputeNearFar(!0),this._debug&&this._debugNode.accept(e),this._cameraShadow.accept(e),this.nearFarBounding(),this.frameShadowCastingFrustum(e),this._cameraShadow.setComputeNearFar(!1),e.popStateSet(),e.setTraversalMask(a),this._needRedraw=!1}},cleanReceivingStateSet:function(e){if(this._receivingStateset){if(this._receivingStateset.getAttribute(this._shadowReceiveAttribute.getTypeMember())===this._shadowReceiveAttribute&&this._receivingStateset.removeAttribute(this._shadowReceiveAttribute.getTypeMember()),e)return;this._texture&&this._receivingStateset.getTextureAttribute(this._textureUnit,this._texture.getTypeMember())===this._texture&&this._receivingStateset.removeTextureAttribute(this._textureUnit,this._texture.getTypeMember())}},cleanSceneGraph:function(e){this._needRedraw=!0,this.cleanReceivingStateSet(e),this._texture=void 0,this._shadowedScene=void 0},setDebug:function(e){e&&!this._debug&&(this._debugNode||(this._debugGeomFrustum=wn.createDebugFrustumGeometry(),this._debugGeomSceneCast=Be.a.createBoundingBoxGeometry(),this._debugGeomSceneCast.getPrimitives()[0].mode=Mn.a.LINES,this._debugNode=new Ve.a,this._debugNodeFrustum=new Ve.a,this._debugNodeSceneCast=new Ve.a,this._debugNodeFrustum.addChild(this._debugGeomFrustum),this._debugNodeSceneCast.addChild(this._debugGeomSceneCast),this._debugNode.addChild(this._debugNodeFrustum),this._debugNode.addChild(this._debugNodeSceneCast))),this._debug=e},getDebug:function(){return this._debug},getLightNumber:function(){return this._light.getLightNumber()},getLight:function(){return this._light}}),"osgShadow","ShadowMap"),ia.EPSILON=.005;var ra=ia,aa=function(){Ue.default.call(this),this._uniforms={},this._lightNumberArray=[],this._viewMatrices=[],this._projection=[],this._depthRanges=[],this._mapSizes=[],this._renderSize=o.e.create(),this._dirtyHash=!0,this._hash=""};aa.uniforms={},a.a.createPrototypeStateAttribute(aa,a.a.objectInherit(Ue.default.prototype,{cloneType:function(){return new aa},getLightNumberArray:function(){return this._lightNumberArray},hasLightNumber:function(e){return-1!==this._lightNumberArray.indexOf(e)},setLightNumberArray:function(e){this._lightNumberArray=e,this._dirtyHash=!0},getUniformName:function(e,t){return"u"+("Shadow_"+this.getType()+e.toString())+"_"+t},setInternalFormatType:function(e){Ue.default.prototype.setInternalFormatType.call(this,e),this._dirtyHash=!0},createUniforms:function(e,t){t["ViewRight_"+e]=fn.a.createFloat4(this.getUniformName(e,"viewRight")),t["ViewUp_"+e]=fn.a.createFloat4(this.getUniformName(e,"viewUp")),t["ViewLook_"+e]=fn.a.createFloat4(this.getUniformName(e,"viewLook")),t["Projection_"+e]=fn.a.createFloat3(this.getUniformName(e,"projection")),t["DepthRange_"+e]=fn.a.createFloat2(this.getUniformName(e,"depthRange")),t["MapSize_"+e]=fn.a.createFloat4(this.getUniformName(e,"mapSize")),t["RenderSize_"+e]=t.RenderSize},getOrCreateUniforms:function(e){var t=aa;if(A.a.assert(void 0!==e||0!==this._lightNumberArray.length),void 0!==t.uniforms[e])return t.uniforms[e];var n=t.uniforms[e]={},i=fn.a.createFloat2(this.getUniformName(0,"renderSize"));n.RenderSize=i;for(var r=0,a=this._lightNumberArray.length;r<a;r++)this.createUniforms(this._lightNumberArray[r],n);var o="Texture"+e,s=fn.a.createInt1(e,o);return n[o]=s,t.uniforms[e]},setViewMatrix:function(e,t){this._viewMatrices[e]=t},setProjection:function(e,t){this._projection[e]=t},setDepthRange:function(e,t){this._depthRanges[e]=t},setLightShadowMapSize:function(e,t){this._mapSizes[e]=t},apply:function(e,t){if(Ue.default.prototype.apply.call(this,e,t),0!==this._lightNumberArray.length){for(var n=this.getOrCreateUniforms(t),i=0,r=this._lightNumberArray.length;i<r;i++){var a=this._lightNumberArray[i];n["ViewRight_"+a]||this.createUniforms(a,n),ea.prototype._updateViewMatrixUniforms.call(this,this._viewMatrices[a],n["ViewRight_"+a],n["ViewUp_"+a],n["ViewLook_"+a]),n["Projection_"+a].setFloat3(this._projection[a]),n["DepthRange_"+a].setFloat2(this._depthRanges[a]),n["MapSize_"+a].setFloat4(this._mapSizes[a])}n.RenderSize.setFloat2(this._renderSize)}},setTextureSize:function(e,t){this._renderSize[0]=1/e,this._renderSize[1]=1/t,Ue.default.prototype.setTextureSize.call(this,e,t),this.dirty()},_computeInternalHash:function(){for(var e=this.getTypeMember(),t=0,n=this._lightNumberArray.length;t<n;t++)e+="_"+this._lightNumberArray[t];return e+="_"+this._type},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash}}),"osgShadow","ShadowTextureAtlas");var oa=aa,sa=function(e){this._lights=[],this._shadowMaps=[],this._viewportDimension=[],Zr.apply(this,arguments),this._shadowSettings=e,this._texture=new oa,this._textureUnitBase=4,this._textureUnit=this._textureUnitBase,this._textureMagFilter=void 0,this._textureMinFilter=void 0,this._textureSize=1024,this._shadowMapSize=256,this._receivingStateset=void 0,e&&(this.setShadowSettings(e),e.atlasSize&&(this._textureSize=e.atlasSize),e.textureSize&&(this._shadowMapSize=e.textureSize)),this._texelSizeUniform=fn.a.createFloat1(1/this._textureSize,"texelSize");var t=fn.a.createFloat2("RenderSize");this._renderSize=t.getInternalArray(),this._renderSize[0]=this._renderSize[1]=this._textureSize,this._numShadowWidth=this._textureSize/this._shadowMapSize,this._numShadowHeight=this._textureSize/this._shadowMapSize,this._cameraClear=new gn.a,this._cameraClear.setName("shadowAtlasCameraClear"),this._cameraClear.setRenderOrder(gn.a.PRE_RENDER,0),this._cameraClear.setClearColor(o.g.fromValues(1,1,1,1)),this._cameraClear.setFrameBufferObject(new mn.a),this._cameraClear.setClearMask(0)};a.a.createPrototypeObject(sa,a.a.objectInherit(Zr.prototype,{getTexture:function(){return this._texture},isDirty:function(e){if(void 0!==e)return this._shadowMaps[e].isDirty();for(var t=0,n=this._shadowMaps.length;t<n;t++)if(this._shadowMaps[t].isDirty())return!0;return!1},setTextureUnitBase:function(e){this._textureUnitBase=e,this._textureUnit=e;for(var t=0,n=this._shadowMaps.length;t<n;t++)this._shadowMaps[t].setTextureUnitBase(e)},setShadowSettings:function(e){if(e){this._shadowSettings=e;for(var t=0,n=this._shadowMaps.length;t<n;t++)this._shadowMaps[t].setShadowSettings(e);this.setTextureSize(e.textureSize),this.setTexturePrecision(e.textureType)}},setCastsShadowDrawTraversalMask:function(e){for(var t=0,n=this._shadowMaps.length;t<n;t++)this._shadowMaps[t].setCastsShadowDrawTraversalMask(e)},getCastsShadowDrawTraversalMask:function(e){return void 0!==e?this._shadowMaps[e].getCastsShadowDrawTraversalMask():0!==this._shadowMaps.length?this._shadowMaps[0].getCastsShadowDrawTraversalMask():void 0},setCastsShadowBoundsTraversalMask:function(e){for(var t=0,n=this._shadowMaps.length;t<n;t++)this._shadowMaps[t].setCastsShadowBoundsTraversalMask(e)},getCastsShadowBoundsTraversalMask:function(e){return void 0!==e?this._shadowMaps[e].getCastsShadowDrawTraversalMask():0!==this._shadowMaps.length?this._shadowMaps[0].getCastsShadowDrawTraversalMask():void 0},getNormalBias:function(e){return void 0!==e?this._shadowMaps[e].getNormalBias():0!==this._shadowMaps.length?this._shadowMaps[0].getNormalBias():void 0},setNormalBias:function(e){for(var t=0,n=this._shadowMaps.length;t<n;t++)this._shadowMaps[t].setNormalBias(e)},getBias:function(e){return void 0!==e?this._shadowMaps[e].getBias():0!==this._shadowMaps.length?this._shadowMaps[0].getBias():void 0},setBias:function(e){for(var t=0,n=this._shadowMaps.length;t<n;t++)this._shadowMaps[t].setBias(e)},getKernelSizePCF:function(e){return void 0!==e?this._shadowMaps[e].getKernelSizePCF():1!==this._shadowMaps.length?this._shadowMaps[0].getKernelSizePCF():void 0},setKernelSizePCF:function(e){for(var t=0,n=this._shadowMaps.length;t<n;t++)this._shadowMaps[t].setKernelSizePCF(e)},setShadowedScene:function(e){Zr.prototype.setShadowedScene.call(this,e),this._receivingStateset=this._shadowedScene.getReceivingStateSet();for(var t=0,n=this._shadowMaps.length;t<n;t++)this._shadowMaps[t].setShadowedScene(e)},setTexturePrecision:function(e){for(var t=0,n=this._shadowMaps.length;t<n;t++)this._shadowMaps[t].setTexturePrecision(e)},getTexturePrecision:function(e){return void 0!==e?this._shadowMaps[e].getTexturePrecision():1!==this._shadowMaps.length?this._shadowMaps[0].getTexturePrecision():void 0},setTextureSize:function(e){e!==this._textureSize&&(this._shadowMapSize=e,this._numShadowWidth=this._textureSize/this._shadowMapSize,this._numShadowHeight=this._textureSize/this._shadowMapSize,this.dirty())},getShadowMap:function(e){return this._shadowMaps[e]},addLight:function(e){if(!e||-1!==this._lights.indexOf(e))return A.a.warn("no light or light already added"),-1;if(this._lights.length!==this._numShadowWidth*this._numShadowHeight){this._lights.push(e),this._shadowSettings.setLight(e);var t=new ra(this._shadowSettings,this._texture);return this._shadowMaps.push(t),this._shadowedScene&&t.setShadowedScene(this._shadowedScene),this.recomputeViewports(),t}A.a.warn("can't allocate shadow for light "+e.getLightNumber()+" ShadowAtlas already full ")},init:function(){if(this._shadowedScene){this.initTexture();for(var e=[],t=0;t<this._lights.length;t++)e.push(this._lights[t].getLightNumber());this._texture.setLightNumberArray(e),this._textureUnit=this._textureUnitBase,this._texture.setName("ShadowTexture"+this._textureUnit);var n=fn.a.createFloat2("RenderSize");this._texelSizeUniform=fn.a.createFloat1(1/this._textureSize,"texelSize"),this._renderSize=n.getInternalArray(),this._renderSize[0]=this._renderSize[1]=this._textureSize,this.recomputeViewports();for(var i=0,r=this._shadowMaps.length;i<r;i++){var a=this._shadowMaps[i];this._shadowedScene||(this._shadowedScene=a.getShadowedScene(this._shadowedScene)),this._shadowedScene&&a.setShadowedScene(this._shadowedScene),a.init(this._texture,i,this._textureUnitBase)}}},recomputeViewports:function(){for(var e=this._shadowMaps.length,t=e>2?Math.sqrt(2*Math.ceil(e/2)):e,n=t,i=this._textureSize/n,r=this._textureSize/t,a=this._textureSize/i,s=this._textureSize/r,u=0;u<e;u++){var l=this._shadowMaps[u],c=i*(u%a),h=r*Math.floor(u/s);this._viewportDimension.length<=u?this._viewportDimension.push(o.g.fromValues(c,h,i,r)):o.g.set(this._viewportDimension[u],c,h,i,r),this._texture.setLightShadowMapSize(this._lights[u].getLightNumber(),this._viewportDimension[u]),l.dirty()}},valid:function(){return!0},updateCameraClear:function(){var e=this._cameraClear,t=this._texture;if(e&&t){var n=e.getViewport();n||(n=new vn.a,e.setViewport(n)),n.width()===t.getWidth()&&n.height()===t.getHeight()||(e.detachAll(),e.attachTexture(mn.a.COLOR_ATTACHMENT0,t),e.attachRenderBuffer(mn.a.DEPTH_ATTACHMENT,mn.a.DEPTH_COMPONENT16),e.getViewport().setViewport(0,0,t.getWidth(),t.getHeight()))}},updateShadowTechnique:function(e){this.updateCameraClear();for(var t=this._cameraClear.getFrameBufferObject(),n=0,i=this._shadowMaps.length;n<i;n++)this._shadowMaps[n].updateShadowTechnique(e,this._viewportDimension[n],t)},initTexture:function(){var e;this._dirty&&(this._texture||(this._texture=new oa,this._textureUnit=this._textureUnitBase),this._texture.setTextureSize(this._textureSize,this._textureSize),this._texelSizeUniform.setFloat(1/this._textureSize),this._renderSize[0]=this._textureSize,this._renderSize[1]=this._textureSize,e=Ue.default.RGBA,ra.prototype.setTextureFiltering.call(this),this._texture.setInternalFormat(e),this._texture.setWrapS(Ue.default.CLAMP_TO_EDGE),this._texture.setWrapT(Ue.default.CLAMP_TO_EDGE),this._texture.dirty())},cullShadowCasting:function(e,t){this._cameraClear.accept(e);for(var n=0,i=this._shadowMaps.length;n<i;n++){var r=this._shadowMaps[n];(r.isContinuousUpdate()||r.needRedraw())&&r.cullShadowCasting(e,t)}},isContinuousUpdate:function(){for(var e=0,t=this._shadowMaps.length;e<t;e++)if(this._shadowMaps[e].isContinuousUpdate())return!0;return!1},needRedraw:function(){for(var e=0,t=this._shadowMaps.length;e<t;e++)if(this._shadowMaps[e].needRedraw())return!0;return!1},removeShadowMap:function(e){if(this._shadowMaps.length>0){var t=this._shadowMaps.indexOf(e);if(-1!==t){this._shadowMaps[t].valid()&&this._shadowMaps[t].cleanSceneGraph(!0),this._shadowMaps.splice(t,1);var n=this._texture.getLightNumberArray();-1!==(t=n.indexOf(e.getLightNumber()))&&n.splice(t,1);var i=e.getLight();-1!==(t=this._lights.indexOf(i))&&this._lights.splice(t,1),this._viewportDimension.length>t&&this._viewportDimension.splice(t,1),this.recomputeViewports()}}},addShadowMap:function(e){if(!(this._shadowMaps.length>0&&-1!==this._shadowMaps.indexOf(e))){this._shadowMaps.push(e);var t=e.getLight();-1===this._lights.indexOf(t)&&this._lights.push(t),this._shadowedScene&&e.setShadowedScene(this._shadowedScene);var n=this._texture.getLightNumberArray();-1===n.indexOf(e.getLightNumber())&&n.push(t.getLightNumber()),this.recomputeViewports()}},cleanReceivingStateSet:function(){if(this._receivingStateset){this._texture&&this._receivingStateset.getTextureAttribute(this._textureUnit,this._texture.getTypeMember())===this._texture&&this._receivingStateset.removeTextureAttribute(this._textureUnit,this._texture.getTypeMember());for(var e=0,t=this._shadowMaps.length;e<t;e++)this._shadowMaps[e].cleanReceivingStateSet()}},cleanSceneGraph:function(){this._texture=void 0,this._shadowedScene=void 0},setDebug:function(e,t){if(t)this._shadowMaps[t].setDebug(e);else for(var n=0,i=this._shadowMaps.length;n<i;n++)this._shadowMaps[n].setDebug(e)},markSceneAsNoShadow:function(){for(var e=0,t=this._shadowMaps.length;e<t;e++)this._shadowMaps[e].markSceneAsNoShadow()}}),"osgShadow","ShadowMapAtlas");var ua=sa,la=function(e){this.castsShadowDrawTraversalMask=4294967295,this.castsShadowBoundsTraversalMask=4294967295,this.textureSize=1024,this.textureType="UNSIGNED_BYTE",this.textureFormat=Ue.default.RGBA,this.shadowProjection="fov",this.fov=50,this.kernelSizePCF="4Tap(4texFetch)",this.bias=.005,this.normalBias=void 0,this.shadowCastShaderGeneratorName="ShadowCast",a.a.objectMix(this,e)};la.kernelSizeList=["1Tap(4texFetch)","4Tap(16texFetch)","9Tap(36texFetch)","16Tap(64texFetch)"],la.prototype={setCastsShadowDrawTraversalMask:function(e){this.castsShadowDrawTraversalMask=e},getCastsShadowDrawTraversalMask:function(){return this.castsDrawShadowTraversalMask},setCastsShadowBoundsTraversalMask:function(e){this.castsShadowBoundsTraversalMask=e},getCastsShadowBoundsTraversalMask:function(){return this.castsShadowBoundsTraversalMask},setLight:function(e){this.light=e},getLight:function(){return this.light},setTextureSize:function(e){this.textureSize=e},getTextureSize:function(){return this.textureSize},setTextureType:function(e){this.textureType=e},getTextureType:function(){return this.textureType},setTextureFormat:function(e){this.textureFormat=e},getTextureFormat:function(){return this.textureFormat},setShadowCastShaderGeneratorName:function(e){this.shadowCastShaderGeneratorName=e},getShadowCastShaderGeneratorName:function(){return this.shadowCastShaderGeneratorName}};var ca=la,ha=n("oDhZ"),da=function(e){Ge.a.call(this),this._shadowTechniques=[],this._optimizedFrustum=!1,this._frustumReceivers=[o.g.create(),o.g.create(),o.g.create(),o.g.create(),o.g.create(),o.g.create()],this._tmpMat=o.c.create(),this._receivingStateset=new pn.a,this._computeBoundsVisitor=new ha.default,this._castsShadowDrawTraversalMask=4294967295,this._castsShadowBoundsTraversalMask=4294967295,e&&this.setShadowSettings(e)};a.a.createPrototypeNode(da,a.a.objectInherit(Ge.a.prototype,{getReceivingStateSet:function(){return this._receivingStateset},getShadowTechniques:function(){return this._shadowTechniques},addShadowTechnique:function(e){this._shadowTechniques.length>0&&-1!==this._shadowTechniques.indexOf(e)||(this._shadowTechniques.push(e),e.valid()&&(e.setShadowedScene(this),e.dirty()))},removeShadowTechnique:function(e){if(this._shadowTechniques.length>0){var t=this._shadowTechniques.indexOf(e);-1!==t&&(this._shadowTechniques[t].valid()&&this._shadowTechniques[t].cleanSceneGraph(),this._shadowTechniques.splice(t,1))}},cleanSceneGraph:function(){for(var e=0,t=this._shadowTechniques.length;e<t;e++)this._shadowTechniques[e]&&this._shadowTechniques[e].valid()&&this._shadowTechniques[e].cleanSceneGraph()},dirty:function(){for(var e=0;e<this._shadowTechniques.length;e++)this._shadowTechniques[e].dirty()},nodeTraverse:function(e){Ge.a.prototype.traverse.call(this,e)},setShadowSettings:function(e){this._settings=e,this.setCastsShadowDrawTraversalMask(e.castsShadowDrawTraversalMask),this.setCastsShadowBoundsTraversalMask(e.castsShadowBoundsTraversalMask),!1!==e.userShadowCasterVisitor&&(this._removeNodesNeverCastingVisitor=e.userShadowCasterVisitor||new Hr(this._castsShadowTraversalMask))},setCastsShadowDrawTraversalMask:function(e){this._castsShadowDrawTraversalMask=e},getCastsShadowDrawTraversalMask:function(){return this._castsDrawShadowTraversalMask},setCastsShadowBoundsTraversalMask:function(e){this._castsShadowBoundsTraversalMask=e},getCastsShadowBoundsTraversalMask:function(){return this._castsShadowBoundsTraversalMask},computeShadowedSceneBounds:function(){return this._removeNodesNeverCastingVisitor&&(this._removeNodesNeverCastingVisitor.setNoCastMask(~(this._castsShadowBoundsTraversalMask|this._castsShadowDrawTraversalMask)),this._removeNodesNeverCastingVisitor.reset(),this.accept(this._removeNodesNeverCastingVisitor)),this._computeBoundsVisitor.setTraversalMask(this._castsShadowBoundsTraversalMask),this._computeBoundsVisitor.reset(),this.accept(this._computeBoundsVisitor),!!this._computeBoundsVisitor.getBoundingBox().valid()||(this._removeNodesNeverCastingVisitor&&this._removeNodesNeverCastingVisitor.restore(),!1)},traverse:function(e){if(e.getVisitorType()===j.a.CULL_VISITOR){var t,n,i=this._shadowTechniques.length;i&&e.pushStateSet(this._receivingStateset),this.nodeTraverse(e),i&&e.popStateSet();var r=!1;for(t=0;t<i;t++)(n=this._shadowTechniques[t])&&n.valid()&&(n.isDirty()&&(r=!0,n.init()),(n.isContinuousUpdate()||n.needRedraw())&&(r=!0));if(!r)return;if(!this.computeShadowedSceneBounds(e)){for(t=0;t<i;t++)(n=this._shadowTechniques[t]).markSceneAsNoShadow();return}var a=this._computeBoundsVisitor.getBoundingBox(),o=e.getCurrentModelMatrix();for(a.transformMat4(a,o),t=0;t<i;t++)((n=this._shadowTechniques[t]).isContinuousUpdate()||n.needRedraw())&&(n.updateShadowTechnique(e),n.cullShadowCasting(e,a));this._removeNodesNeverCastingVisitor&&this._removeNodesNeverCastingVisitor.restore()}else this.nodeTraverse(e)}}),"osgShadow","ShadowedScene"),De.a.registerApplyFunction(da.nodeTypeID,De.a.getApplyFunction(Ge.a.nodeTypeID));var fa=da,pa={};pa.ShadowCastAttribute=Br,pa.ShadowReceiveAttribute=Qr,pa.ShadowCasterVisitor=Hr,pa.ShadowFrustumIntersection=Xr,pa.ShadowMap=ra,pa.ShadowMapAtlas=ua,pa.ShadowedScene=fa,pa.ShadowSettings=ca,pa.ShadowTechnique=Zr,pa.ShadowTexture=ea,pa.ShadowTextureAtlas=oa;var ga=pa,ma={Stats:Ui,BufferStats:Ii,Graph:Ri,TextGenerator:Fi,Counter:ki,defaultStats:ji,browserStats:rr,glStats:er},va={};va.Text=ze;var _a=va,ba={};ba.osg=Oe,ba.osgAnimation=ke,ba.osgText=qe;var Sa=ba,ya=n("HORL"),xa=x.createQuatChannel,Ca=x.createVec3Channel,wa=x.createFloatChannel,Ta=function(){this._filesMap=void 0,this._loadedFiles=void 0,this._bufferViewCache=void 0,this._basicAnimationManager=void 0,this._visitedNodes=void 0,this._animatedNodes=void 0,this._bones=void 0,this._skeletonToInfluenceMap=void 0,this._inputImgReader=void 0,this._localPath="",this._extensions=[],this._nodeAnimationTypes=void 0,this.init()};Ta.WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Ta.TYPE_TABLE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ta.ATTRIBUTE_OSGJS_TABLE={POSITION:"Vertex",NORMAL:"Normal",TANGENT:"Tangent",TEXCOORD_0:"TexCoord0",TEXCOORD_1:"TexCoord1",TEXCOORD_2:"TexCoord2",TEXCOORD_3:"TexCoord3",TEXCOORD_4:"TexCoord4",TEXCOORD_5:"TexCoord5",TEXCOORD_6:"TexCoord6",TEXCOORD_7:"TexCoord7",TEXCOORD_8:"TexCoord8",TEXCOORD_9:"TexCoord9",TEXCOORD_10:"TexCoord10",TEXCOORD_11:"TexCoord11",TEXCOORD_12:"TexCoord12",TEXCOORD_13:"TexCoord13",TEXCOORD_14:"TexCoord14",TEXCOORD_15:"TexCoord15",COLOR_0:"Color",JOINTS_0:"Bones",WEIGHTS_0:"Weights"},Ta.TEXTURE_FORMAT={6406:Ue.default.ALPHA,6407:Ue.default.RGB,6408:Ue.default.RGBA,6409:Ue.default.LUMINANCE,6410:Ue.default.LUMINANCE_ALPHA},Ta.TYPE_CHANNEL_PATH={translation:{VEC3:Ca},scale:{VEC3:Ca},rotation:{VEC4:xa},weights:{SCALAR:wa}},Ta.TYPE_STACKED_TRANSFORMS={translation:ve,scale:ge,rotation:he},Ta.PBR_SPEC_EXT="KHR_materials_pbrSpecularGlossiness",Ta.PBR_SPEC_MODE="PBR_specular_glossiness",Ta.PBR_METAL_MODE="PBR_metal_roughness",Ta.ALBEDO_TEXTURE_UNIT=2,Ta.DIFFUSE_TEXTURE_UNIT=2,Ta.SPECULAR_GLOSSINESS_TEXTURE_UNIT=3,Ta.METALLIC_ROUGHNESS_TEXTURE_UNIT=3,Ta.SPECULAR_TEXTURE_UNIT=4,Ta.NORMAL_TEXTURE_UNIT=5,Ta.AO_TEXTURE_UNIT=6,Ta.EMISSIVE_TEXTURE_UNIT=7,Ta.ALBEDO_UNIFORM="albedoMap",Ta.METALLIC_ROUGHNESS_UNIFORM="metallicRoughnessMap",Ta.SPECULAR_UNIFORM="specularMap",Ta.NORMAL_UNIFORM="normalMap",Ta.AO_UNIFORM="aoMap",Ta.EMISSIVE_UNIFORM="emissiveMap",Ta.prototype={init:function(){this._glTFJSON=void 0,this._nodeAnimationTypes=[],this._bufferViewCache={},this._basicAnimationManager=void 0,this._localPath="",this._visitedNodes={},this._animatedNodes={},this._bones={},this._skeletonToInfluenceMap={},this._stateSetMap={},this._filesMap={},this._inputReader=new ye.default,this._rootStateSet=new pn.a,this._defaultBlendFunc=new je.a,this._transparentBlendFunc=new je.a("SRC_ALPHA","ONE_MINUS_SRC_ALPHA"),this._defaultCullFace=new hn.a,this._doubleSideCullFace=new hn.a(hn.a.DISABLE)},_preProcessNodes:function(){for(var e,t=this._gltfJSON.nodes,n=this._gltfJSON.meshes,i=0;i<t.length;i++){var r=t[i];e=r.name||"",e+="_"+i.toString(),r.osgjsNodeName=e;var a=r.children;if(a)for(var o=0;o<a.length;o++){t[a[o]].parent=i}}for(var s=0;s<n.length;s++){var u=n[s];e=u.name||"",e+="_"+s.toString(),u.osgjsNodeName=e}},loadBuffers:Te.a.method(function(){for(var e=[],t=this._gltfJSON.buffers,n=0;n<t.length;n++){var i=t[n];e.push(this.loadURI(i.uri,{responseType:"arraybuffer"}).then(function(e){i.data=e}))}return Te.a.all(e)}),loadBufferViews:function(){for(var e=this._gltfJSON.buffers,t=this._gltfJSON.bufferViews,n=0;n<t.length;n++){var i=t[n],r=e[i.buffer],a=i.byteLength||0,o=i.byteOffset||0;i.data=r.data.slice(o,o+a)}},loadAccessors:function(){for(var e=this._gltfJSON.bufferViews,t=this._gltfJSON.accessors,n=0;n<t.length;n++){var i,r=t[n],a=e[r.bufferView],o=Ta.TYPE_TABLE[r.type],s=Ta.WEBGL_COMPONENT_TYPES[r.componentType],u=s.BYTES_PER_ELEMENT*o,l=a.byteStride,c=!0===r.normalized;if(l&&l!==u)A.a.warn("GLTF interleaved accessors not supported");else{var h=new s(a.data,r.byteOffset,r.count*o);(i=new z.a(void 0,h,o)).setNormalize(c)}r.data=i}},_computeNodeMatrix:function(e){var t;if(e.matrix)t=o.c.clone(e.matrix);else if(e.translation||e.rotation||e.scale){var n=o.c.IDENTITY,i=o.c.IDENTITY,r=o.c.IDENTITY;e.translation&&(n=o.c.fromTranslation(o.c.create(),e.translation)),e.rotation&&(i=o.c.fromQuat(o.c.create(),e.rotation)),e.scale&&(r=o.c.fromScaling(o.c.create(),e.scale)),t=o.c.create(),o.c.multiply(t,i,r),o.c.multiply(t,n,t)}return t},loadNodes:function(){for(var e=this._gltfJSON.nodes,t=this._gltfJSON.skins,n=this._gltfJSON.meshes,i=0;i<e.length;i++){var r=e[i];if(!r.usedAsBone){if(void 0!==r.skin){var a=t[r.skin],o=a.osgjsNode;a.osgjsNodeAttached||(r.osgjsNode=o,a.osgjsNodeAttached=i);var s=n[r.mesh];s.osgjsGeometry.setBoneNameID(a.osgjsBoneMapID),o.addChild(s.osgjsGeometry)}else(r.matrix||r.translation||r.rotation||r.scale)&&(r.osgjsNode=this._createMatrixTransform(i)),void 0!==r.mesh&&(r.osgjsNode?r.osgjsNode.addChild(n[r.mesh].osgjsGeometry):r.osgjsNode=n[r.mesh].osgjsGeometry),r.osgjsNode||(r.osgjsNode=new Ge.a);r.name&&r.osgjsNode.setName(r.name)}}},_linkNodes:function(e){var t=this._gltfJSON.nodes,n=e.children;if(n)for(var i=0;i<n.length;i++){var r=t[n[i]];if(!r.usedAsBone){var a=r.osgjsNode;a&&!e.osgjsNode.hasChild(a)&&(e.osgjsNode.addChild(a),this._linkNodes(r))}}},loadSkins:function(){var e=this._gltfJSON.skins;if(e)for(var t=0;t<e.length;t++)this._processSkin(t)},loadScenes:function(){var e=this._gltfJSON.nodes,t=this._gltfJSON.scenes;this._osgjsScene=[];for(var n=0;n<t.length;n++){for(var i=t[n].nodes,r=[],a=0;a<i.length;a++){var o=e[i[a]];this._linkNodes(o),r.push(o.osgjsNode)}var s=r[0];if(r.length>1){s=new Ge.a;for(var u=0;u<r.length;u++)s.addChild(r[u])}this._osgjsScene.push(s)}},_assignGeometryAttributes:function(e,t,n){var i=this._gltfJSON.accessors;for(var r in t){var a=i[t[r]],o=Ta.ATTRIBUTE_OSGJS_TABLE[r];void 0!==n&&(o+="_"+n.toString()),e.getVertexAttributeList()[o]=a.data,a.data._target=z.a.ARRAY_BUFFER}},_assignGeometryPrimitives:function(e,t){var n=this._gltfJSON.accessors[t.indices];n.data._target=z.a.ELEMENT_ARRAY_BUFFER;var i=void 0!==t.mode?t.mode:Mn.a.TRIANGLES,r=new Vn.a(i,n.data);e.getPrimitiveSetList().push(r)},_getMorphTargetName:function(e,t){return e.osgjsNodeName+"_target_"+t.toString()},_computeAbsoluteMorphData:function(e,t){var n=this._gltfJSON.accessors;for(var i in t){var r=n[t[i]];if(!r.morphAbsoluteComputed){r.morphAbsoluteComputed=!0;for(var a=n[e[i]].data.getElements(),o=r.data.getElements(),s=a.length,u=0;u<s;u++)o[u]+=a[u]}}},_processMorphGeometry:function(e,t){var n=e.primitives[t],i=new q.a,r=new K;r.setName(e.osgjsNodeName),i.setName(e.osgjsNodeName);for(var a=0;a<n.targets.length;a++){this._computeAbsoluteMorphData(n.attributes,n.targets[a]);var o=this._getMorphTargetName(e,a),s=new Re.a;s.setName(o),r.addTarget(o,a),this._assignGeometryAttributes(s,n.targets[a]),i.getMorphTargets().push(s)}this._assignGeometryAttributes(i,n.attributes),this._assignGeometryPrimitives(i,n),i.mergeChildrenVertexAttributeList(),e.osgjsMorphGeometry=i,e.osgjsUpdateMorph=r},loadMeshes:function(){for(var e=this._gltfJSON.meshes,t=this._gltfJSON.materials,n=0;n<e.length;n++){for(var i=e[n],r=i.name,a=[],o=0;o<i.primitives.length;o++){var s=void 0,u=i.primitives[o],l=void 0;if(u.targets&&u.targets.length&&(this._processMorphGeometry(i,o),s=i.osgjsMorphGeometry,l=i.osgjsUpdateMorph),u.attributes.JOINTS_0){var c=new W.a;s||(s=new Re.a,this._assignGeometryAttributes(s,u.attributes),this._assignGeometryPrimitives(s,u));var h=new Vi.a;s.computeBoundingBox(h),c.setBound(h),c.setSourceGeometry(s),c.mergeChildrenData(),s=c}s||(s=new Re.a,this._assignGeometryAttributes(s,u.attributes),this._assignGeometryPrimitives(s,u)),r&&s.setName(r),l&&s.addUpdateCallback(l);var d=t[u.material].osgjsStateSet;s.setStateSet(d),s.setUserData(d.getUserData()),a.push(s)}if(a.length>1){for(var f=new Ge.a,p=0;p<a.length;p++)f.addChild(a[p]);s=f}i.osgjsGeometry=s}},loadImages:function(){var e=this._gltfJSON.images;if(!e)return Te.a.resolve();for(var t=[],n=0;n<e.length;n++){var i=e[n],r=window.decodeURI(i.uri),a=this.loadURI(r).then(function(e){var t=new ya.a;t.setImage(e),this.osgjsImage=t}.bind(i));t.push(a)}return Te.a.all(t)},_texture:function(e){var t=this._gltfJSON.textures,n=this._gltfJSON.images,i=t[e.index],r=n[i.source];if(i.osgjsTexture)return i.osgjsTexture;var a=new Ue.default;if(i.osgjsTexture=a,a.setFlipY(!1),a.setWrapS("REPEAT"),a.setWrapT("REPEAT"),r.osgjsImage){var o=Ta.TEXTURE_FORMAT[i.format];a.setImage(r.osgjsImage,o)}return a},_pbrMetallicRoughnessTextureUniforms:function(){var e=this._rootStateSet;if(!e.getUniformList()[Ta.ALBEDO_UNIFORM]){var t=fn.a.createInt(Ta.ALBEDO_TEXTURE_UNIT,Ta.ALBEDO_UNIFORM),n=fn.a.createInt(Ta.METALLIC_ROUGHNESS_TEXTURE_UNIT,Ta.METALLIC_ROUGHNESS_UNIFORM);e.addUniform(t),e.addUniform(n)}},_pbrMetallicRoughness:function(e,t){var n;if(t.setUserData({pbrWorklow:Ta.PBR_METAL_MODE}),this._pbrMetallicRoughnessTextureUniforms(),e.baseColorTexture)n=this._texture(e.baseColorTexture),t.setTextureAttributeAndModes(Ta.ALBEDO_TEXTURE_UNIT,n);else if(e.baseColorFactor){var i=fn.a.createFloat4(e.baseColorFactor,"uBaseColorFactor");t.addUniform(i)}if(void 0!==e.metallicFactor){var r=fn.a.createFloat1(e.metallicFactor,"uMetallicFactor");t.addUniform(r)}if(void 0!==e.roughnessFactor){var a=fn.a.createFloat1(e.roughnessFactor,"uRoughnessFactor");t.addUniform(a)}e.metallicRoughnessTexture&&(n=this._texture(e.metallicRoughnessTexture),t.setTextureAttributeAndModes(Ta.METALLIC_ROUGHNESS_TEXTURE_UNIT,n))},_KHR_materials_pbrSpecularGlossinessTextureUniforms:function(){if(!this._extensions.KHR_materials_pbrSpecularGlossinessTextureUniforms){this._extensions.KHR_materials_pbrSpecularGlossinessTextureUniforms=!0;var e=this._rootStateSet,t=fn.a.createInt(Ta.DIFFUSE_TEXTURE_UNIT,Ta.ALBEDO_UNIFORM),n=fn.a.createInt(Ta.SPECULAR_GLOSSINESS_TEXTURE_UNIT,Ta.METALLIC_ROUGHNESS_UNIFORM),i=fn.a.createInt(Ta.SPECULAR_TEXTURE_UNIT,Ta.SPECULAR_UNIFORM);e.addUniform(t),e.addUniform(n),e.addUniform(i)}},_KHR_materials_pbrSpecularGlossiness:function(e,t){var n,i;if(t.setUserData({pbrWorklow:Ta.PBR_SPEC_MODE}),this._KHR_materials_pbrSpecularGlossinessTextureUniforms(),e.diffuseTexture?(n=this._texture(e.diffuseTexture),t.setTextureAttributeAndModes(Ta.DIFFUSE_TEXTURE_UNIT,n)):e.diffuseFactor&&(i=fn.a.createFloat4(e.diffuseFactor,"uBaseColorFactor"),t.addUniform(i)),e.specularFactor&&(i=fn.a.createFloat3(e.specularFactor,"uSpecularFactor"),t.addUniform(i)),void 0!==e.glossinessFactor){var r=fn.a.createFloat(e.glossinessFactor,"uGlossinessFactor");t.addUniform(r)}e.specularGlossinessTexture&&(n=this._texture(e.specularGlossinessTexture),t.setTextureAttributeAndModes(Ta.SPECULAR_GLOSSINESS_TEXTURE_UNIT,n))},loadMaterials:function(){var e=this._gltfJSON.materials,t=!1,n=!1,i=this._rootStateSet;i.addUniform(fn.a.createInt(Ta.EMISSIVE_TEXTURE_UNIT,Ta.EMISSIVE_UNIFORM)),i.addUniform(fn.a.createInt(Ta.AO_TEXTURE_UNIT,Ta.AO_UNIFORM)),i.addUniform(fn.a.createInt(Ta.NORMAL_TEXTURE_UNIT,Ta.NORMAL_UNIFORM)),i.addUniform(fn.a.createFloat3(o.f.ZERO,"uEmissiveFactor"));for(var r=0;r<e.length;r++){var a,s=e[r],u=new pn.a;s.osgjsStateSet=u,s.pbrMetallicRoughness?this._pbrMetallicRoughness(s.pbrMetallicRoughness,u):s.extensions.KHR_materials_pbrSpecularGlossiness&&this._KHR_materials_pbrSpecularGlossiness(s.extensions.KHR_materials_pbrSpecularGlossiness,u),s.normalTexture&&(a=this._texture(s.normalTexture),u.setTextureAttributeAndModes(Ta.NORMAL_TEXTURE_UNIT,a)),s.occlusionTexture&&(a=this._texture(s.occlusionTexture),u.setTextureAttributeAndModes(Ta.AO_TEXTURE_UNIT,a)),s.emissiveTexture&&(a=this._texture(s.emissiveTexture),u.setTextureAttributeAndModes(Ta.EMISSIVE_TEXTURE_UNIT,a)),s.emissiveFactor&&u.addUniform(fn.a.createFloat3(s.emissiveFactor,"uEmissiveFactor")),"BLEND"===s.alphaMode&&(t=!0,u.setAttributeAndModes(this._transparentBlendFunc),u.setRenderingHint("TRANSPARENT_BIN")),s.doubleSided&&(n=!0,u.setAttributeAndModes(this._doubleSideCullFace))}t&&i.setAttributeAndModes(this._defaultBlendFunc),n&&i.setAttributeAndModes(this._defaultCullFace)},_createBone:function(e){var t=this._gltfJSON.nodes[e];t.usedAsBone=!0;var n=this._nodeAnimationTypes,i=new ie.a,r=t.osgjsNodeName;i.setName(r);var a=this._computeNodeMatrix(t)||o.c.IDENTITY;i.setMatrix(a);var s=new Q.a;if(s.setName(i.getName()),i.addUpdateCallback(s),n[e]){var u=s.getStackedTransforms();for(var l in n[e]){var c=new(0,Ta.TYPE_STACKED_TRANSFORMS[l])(l);u.push(c)}}return s.setMatrix(a),i},_createMatrixTransform:function(e){var t=this._gltfJSON.nodes[e],n=this._nodeAnimationTypes,i=new Ve.a,r=t.osgjsNodeName;i.setName(r);var a=this._computeNodeMatrix(t)||o.c.IDENTITY;if(i.setMatrix(a),n[e]){var s=new J.a;s.setName(i.getName()),i.addUpdateCallback(s),s.setMatrix(a);var u=s.getStackedTransforms();for(var l in n[e]){var c=new(0,Ta.TYPE_STACKED_TRANSFORMS[l])(l);u.push(c)}}return i},_processSkin:function(e){var t,n=this._gltfJSON.skins,i=this._gltfJSON.nodes,r=n[e],a=r.joints;void 0!==r.inverseBindMatrices&&(t=this._gltfJSON.accessors[r.inverseBindMatrices].data.getElements().buffer);var o,s=new oe.a;r.osgjsNode=s,s.setName("skin ID "+e);for(var u,l={},c={},h=0;h<a.length;h++){if(o=a[h],u=this._createBone(o),void 0!==r.inverseBindMatrices){var d=new Float32Array(t,16*h*4,16);u.setInvBindMatrixInSkeletonSpace(d)}l[o]=u,c[u.getName()]=h}for(var f in r.osgjsBoneMapID=c,l){var p=i[f].parent;if(u=l[f],void 0===p||-1===a.indexOf(p))s.addChild(u);else l[p].addChild(u)}},loadAnimations:function(){var e=this._gltfJSON.animations;if(e){for(var t=this._gltfJSON.accessors,n=this._nodeAnimationTypes,i=this._gltfJSON.nodes,r=this._gltfJSON.meshes,a=[],o=0;o<e.length;o++){for(var s=e[o].channels,u=e[o].samplers,l=[],c=0;c<s.length;c++){var h=s[c],d=u[h.sampler],f=t[d.input].data.getElements(),p=t[d.output],g=p.data.getElements(),m=h.target,v=Ta.TYPE_CHANNEL_PATH[m.path][p.type],_=void 0!==m.node?m.node:m.id,b=i[_],S=m.path,y=i[_].osgjsNodeName;if("weights"===S)for(var x=r[b.mesh],C=x.primitives[0].targets.length,w=f.length,M=0;M<C;M++){for(var E=new Float32Array(w),A=0;A<w;A++)E[A]=g[A*C+M];y=this._getMorphTargetName(x,M),l.push(v(E,f,y,M))}else l.push(v(g,f,y,S));n[_]||(n[_]={}),n[_][S]=!0}var O="animation-"+o.toString();a.push(T.createAnimation(l,O))}var R=new ne;R.init(a),this._animationManager=R}},loadURI:Te.a.method(function(e,t){if("data:"===e.substr(0,5))return function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=t.charCodeAt(r);return i.buffer}(e);var n=this._filesMap[e];return void 0!==n?n:Ye.a.requestURI(e,t)}),readNodeURL:function(e,t){var n=this;if(this.init(),t&&void 0!==t.filesMap&&Object.keys(t.filesMap).length>0){this._filesMap=t.filesMap;var i=this._filesMap[e];return this.readJSON(i,e)}var r=e.lastIndexOf("/");return this._localPath=-1===r?"":e.substr(0,r+1),Ye.a.requestURI(e).then(function(e){return n.readJSON(e)})},readJSON:Te.a.method(function(e,t){return this._gltfJSON=e,Te.a.all([this.loadBuffers(),this.loadImages()]).then(function(){this.loadBufferViews(),this.loadAccessors(),this._preProcessNodes(),this.loadMaterials(),this.loadMeshes(),this.loadAnimations(),this.loadSkins(),this.loadNodes(),this.loadScenes();var e=new Ve.a;return e.addChild(this._osgjsScene[0]),e.setName(t),this._animationManager&&e.addUpdateCallback(this._animationManager),e.setStateSet(this._rootStateSet),e}.bind(this))})},Xe.a.instance().addReaderWriter("gltf",new Ta);var Ma=Ta,Ea=window.JSZip,Aa=function(){this._options=void 0,this._filesMap={},this._fileName=""};Aa.prototype={readNodeURL:function(e,t){if(void 0===Ea)return A.a.error("You need to add JSZip as a dependency"),Te.a.reject(this);A.a.log("starting to read: "+e);var n=this;if(t&&void 0!==t.filesMap&&void 0!==t.filesMap[e]){var i=t.filesMap[e];return this.readZipFile(i).then(function(){return n._fileName?xe.default.readNodeURL(n._fileName,{filesMap:n._filesMap}):Te.a.reject(n)})}return Ye.a.requestURI(e,{responseType:"blob"}).then(function(e){n.readZipFile(e).then(function(){return xe.default.readNodeURL(n._fileName,{filesMap:n._filesMap})})})},readZipFile:function(e){Ye.a.unzip(e).then(function(e){for(var t in e){var n=Ye.a.getExtension(t);if(void 0!==Xe.a.instance().getReaderWriterForExtension(n)||"osgjs"===n){this._fileName=t;break}}}.bind(this))}},Xe.a.instance().addReaderWriter("zip",new Aa);var Oa=Aa,Ra={};Ra.ReaderWriterGLTF=Ma,Ra.ReaderWriterZIP=Oa;var Pa=Ra,Ia=n("4//o"),Na=i.a;Na.osg=r.default,Na.osgAnimation=Se,Na.osgDB=$e,Na.osgGA=cn,Na.osgUtil=_i,Na.osgViewer=kr,Na.osgShader=Dr.a,Na.osgShadow=ga,Na.osgStats=ma,Na.osgText=_a,Na.osgWrappers=Sa,Na.osgPlugins=Pa,Na.InputGroups=kr.InputGroups,Na.globalify=function(){window.osg=Na.osg,window.osgAnimation=Na.osgAnimation,window.osgDB=Na.osgDB,window.osgGA=Na.osgGA,window.osgUtil=Na.osgUtil,window.osgViewer=Na.osgViewer,window.osgShader=Na.osgShader,window.osgShadow=Na.osgShadow,window.osgStats=Na.osgStats,window.osgText=Na.osgText,window.osgWrappers=Na.osgWrappers,window.osgPlugins=Na.osgPlugins,window.InputGroups=Na.InputGroups},Object(Ia.b)(Na);var La=Na,ka=n("FOip");Object(ka.a)(),q.a.EFFECTIVE_EPS=Object(Or.a)().morphEpsilon;t.a=La},QVk6:function(e,t,n){"use strict";var i={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};t.a=i},QYQF:function(e,t,n){"use strict";var i=n("nzRv"),r=n("Ui7z");t.a=i.a.extend({displayName:"PureComponent",shouldViewUpdate:function(e,t){return!Object(r.g)(this.options,e)||!Object(r.g)(this.state,t)}})},Qavt:function(e,t,n){"use strict";var i=n("a3nb"),r=n("qRO0"),a=function(){r.a.call(this)};i.a.createPrototypeStateAttribute(a,i.a.objectInherit(r.a.prototype,{_attributeTypeIndex:void 0,getType:function(){return this.attributeType},getTypeMember:function(){return this.attributeType},apply:function(){},getHash:function(){return this.getType()}}),"osg","StateAttribute"),a.OFF=0,a.ON=1,a.OVERRIDE=2,a.PROTECTED=4,a.INHERIT=8,a.OVERRIDE_ON=a.OVERRIDE|a.ON,t.a=a},"Ql/c":function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),a=n("QILm"),o=n.n(a),s=n("q1tI"),u=n.n(s),l=n("a5AJ"),c=n("gPpI");t.a=function(e){var t=e.children,n=e.to,i=e.params,a=void 0===i?{}:i,s=e.queryParams,h=void 0===s?{}:s,d=e.hash,f=o()(e,["children","to","params","queryParams","hash"]),p="".concat(Object(c.e)(n,a,h,d));return u.a.createElement("a",r()({},f,{href:p,onClick:function(e){e.ctrlKey||e.metaKey||(e.preventDefault(),e.stopPropagation(),l.a.push(p))}}),t)}},QoPM:function(e,t,n){"use strict";var i=n("lSNA"),r=n.n(i),a=n("M4AY");t.a=function(e){return{name:"WithEntitiesUpdate",initialize:function(){var t=this,n=function(t){a.b.store.dispatch(a.a.entities.update(r()({},e,t.map(function(e){return e.toJSON()}))))};setTimeout(function(){return n(t.models)},16),this.on("afterAdd",n)}}}},QorK:function(e,t){e.exports="uniform sampler2D TextureInput;\nuniform sampler2D TextureRefraction;\n\nuniform vec2 uTextureRefractionSize;\nuniform vec2 uTextureRefractionRatio;\nuniform float uRGBMRange;\n\nvec4 combineRefraction() {\n    // manual fetch to check m value of rgba : we use m 0 (invalid of rgbm) as masking\n    vec2 uv = min(gTexCoord, 1.0 - 1.0 / uTextureRefractionSize.xy);\n    vec4 rgbmRefraction = texture2D(TextureRefraction, uv * uTextureRefractionRatio);\n\n    vec4 background = TEXTURE_2D_TextureInput(gTexCoord);\n    if (rgbmRefraction.a == 0.0) return background;\n    return vec4(decodeRGBM(rgbmRefraction, uRGBMRange), 1.0);\n}"},QtKT:function(e,t,n){"use strict";t.a={NO_LIMIT:0,LIMIT_ONE_PER_DRAWABLE:1,LIMIT_ONE:2,POINT_PRIMITIVES:1,LINE_PRIMITIVES:2,TRIANGLE_PRIMITIVES:4,ALL_PRIMITIVES:7}},QwJF:function(e,t){e.exports="varying vec3 vBonesColor;\n\nvoid main(void) {\n   gl_FragColor = vec4(vBonesColor, 1.0);\n}\n"},"R+tb":function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return h});var i,r,a=n("gRsq"),o=!1;if(document)for(var s=["hidden","mozHidden","msHidden","webkitHidden"],u=0,l=s.length;u<l;u++){var c=s[u];if(void 0!==document[c]){i=c,r=c.toLowerCase().split("hidden").shift()+"visibilitychange";break}}var h,d=function(){return r};h=Object(a.a)()?function(){return!1}:function(){return!(o||!i)&&document[i]}},"R/Z7":function(e,t){e.exports='#pragma include "utils/encodeDecode.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureDepth0;\nuniform sampler2D TextureDepth1;\nuniform sampler2D TextureDepth2;\nuniform sampler2D TextureDepth3;\nuniform sampler2D TextureDepth4;\nuniform sampler2D TextureDepth5;\nuniform vec2 uTextureOutputRatio;\n\nvec4 packMipmapDepth() {\n    vec4 result = vec4(0.0, 0.0, 0.0, 0.0);\n\n    // see _hookComposerResize in NodePostProcess.js (mipmap)\n    gTexCoord.y /= uTextureOutputRatio.y;\n\n    float levelLog = -log2(1.0 - gTexCoord.y) + 1.0;\n    float level = floor(levelLog) - 1.0;\n\n    float pLevel = pow(2.0, level + 1.0); // 2, 4, 8, 16...\n    gTexCoord.x = pLevel * gTexCoord.x * 0.5;\n    gTexCoord.y = pLevel * (1.0 - gTexCoord.y) - 1.0;\n\n    // unused part of the texture\n    if (gTexCoord.x > 1.0 || gTexCoord.y > 1.0) return result;\n\n    if (level < 0.1) result.rgba = vec4(encode24(decodeDepth(TEXTURE_2D_TextureDepth0(gTexCoord))), 1.0);\n    else if (level < 1.1) result.rgba = TEXTURE_2D_TextureDepth1(gTexCoord);\n    else if (level < 2.1) result.rgba = TEXTURE_2D_TextureDepth2(gTexCoord);\n    else if (level < 3.1) result.rgba = TEXTURE_2D_TextureDepth3(gTexCoord);\n    else if (level < 4.1) result.rgba = TEXTURE_2D_TextureDepth4(gTexCoord);\n    else if (level < 5.1) result.rgba = TEXTURE_2D_TextureDepth5(gTexCoord);\n\n    return result;\n}\n'},R3Hf:function(e,t,n){"use strict";var i=n("a3nb"),r=n("6JLc"),a=n("YVF9"),o=n("zWCM"),s=n("62xh"),u=n("7cZc"),l=n("czSk"),c=n("jq0H"),h=n("Ep1f"),d=n("LTZp"),f=n("b/No"),p=n("EnLC"),g=n("eBAO"),m=function(){return new u.a},v=function(){this._modelViewMatrixStack=new f.a,this._projectionMatrixStack=new f.a,this._viewportStack=new f.a,this._cullingSetStack=new f.a,this._frustumVolume=-1,this._bbCornerFar=0,this._bbCornerNear=0,this._pooledMatrix=new p.a(l.c.create),this._pooledCullingSet=new p.a(m),this._cameraIndexStack=new f.a,this._cameraModelViewIndexStack=new f.a,this._cameraMatrixInverse=new g.a,this._cameraMatrixInverseRoot=void 0};i.a.createPrototypeObject(v,i.a.objectInherit(s.a.prototype,{reset:function(){this._modelViewMatrixStack.reset(),this._projectionMatrixStack.reset(),this._cullingSetStack.reset(),this._pooledMatrix.reset(),this._pooledCullingSet.reset(),this._cameraModelViewIndexStack.reset(),this._cameraIndexStack.reset(),this._cameraMatrixInverse.reset(),this._cameraMatrixInverseRoot=void 0},getProjectionMatrixStack:function(){return this._projectionMatrixStack},getCurrentProjectionMatrix:function(){return this._projectionMatrixStack.back()},getCurrentModelViewMatrix:function(){return this._modelViewMatrixStack.back()},getCameraInverseMatrix:function(){if(!this._cameraIndexStack.getLength())return this._cameraMatrixInverseRoot;var e=this._cameraIndexStack.back(),t=this.getNodePath()[e].getInstanceID(),n=this._cameraMatrixInverse.getMap()[t];if(void 0===n){var i=this._cameraModelViewIndexStack.back(),r=this._modelViewMatrixStack.getArray()[i];n=this._pooledMatrix.getOrCreateObject(),l.c.invert(n,r),this._cameraMatrixInverse.set(t,n)}return n},getCurrentModelMatrix:function(){var e=this.getCameraInverseMatrix(),t=this._pooledMatrix.getOrCreateObject();return l.c.mul(t,e,this.getCurrentModelViewMatrix())},getCurrentViewMatrix:function(){var e=this._modelViewMatrixStack.getArray();return this._cameraIndexStack.getLength()?e[this._cameraModelViewIndexStack.back()]:e[0]},getViewport:function(){if(0!==this._viewportStack.getLength())return this._viewportStack.back()},getLookVectorLocal:function(e){var t=this.getCurrentModelViewMatrix();return l.f.set(e,-t[2],-t[6],-t[10])},pushViewport:function(e){this._viewportStack.push(e)},popViewport:function(){this._viewportStack.pop()},getFrustumPlanes:function(){var e=l.c.create();return function(t,n,i,r){l.c.mul(e,n,i);var a=!!r,o=t[0];o[0]=e[3]-e[0],o[1]=e[7]-e[4],o[2]=e[11]-e[8],o[3]=e[15]-e[12];var s=t[1];s[0]=e[3]+e[0],s[1]=e[7]+e[4],s[2]=e[11]+e[8],s[3]=e[15]+e[12];var u=t[2];u[0]=e[3]+e[1],u[1]=e[7]+e[5],u[2]=e[11]+e[9],u[3]=e[15]+e[13];var h=t[3];if(h[0]=e[3]-e[1],h[1]=e[7]-e[5],h[2]=e[11]-e[9],h[3]=e[15]-e[13],a){var d=t[4];d[0]=e[3]-e[2],d[1]=e[7]-e[6],d[2]=e[11]-e[10],d[3]=e[15]-e[14];var f=t[5];f[0]=e[3]+e[2],f[1]=e[7]+e[6],f[2]=e[11]+e[10],f[3]=e[15]+e[14]}for(var p=r?6:4,g=0;g<p;g++)c.a.normalizeEquation(t[g])}}(),pushCullingSet:function(){var e=this._pooledCullingSet.getOrCreateObject();this._enableFrustumCulling&&(l.c.getFrustumPlanes(e.getFrustum().getPlanes(),this.getCurrentProjectionMatrix(),this.getCurrentModelViewMatrix(),!1),e.getFrustum().setupMask(4)),this._cullingSetStack.push(e)},popCullingSet:function(){return this._cullingSetStack.pop()},getCurrentCullingSet:function(){return this._cullingSetStack.back()},pushCurrentMask:function(){var e=this.getCurrentCullingSet();e&&e.pushCurrentMask()},popCurrentMask:function(){var e=this.getCurrentCullingSet();e&&e.popCurrentMask()},isVerticesCulled:function(e){return!!this._enableFrustumCulling&&this.getCurrentCullingSet().isVerticesCulled(e)},isBoundingBoxCulled:function(e){return!!this._enableFrustumCulling&&(e.valid()&&this.getCurrentCullingSet().isBoundingBoxCulled(e))},isBoundingSphereCulled:function(e){return!!this._enableFrustumCulling&&(e.valid()&&this.getCurrentCullingSet().isBoundingSphereCulled(e))},isCulled:function(){var e=new r.a;return function(t,n){if(!this._enableFrustumCulling)return!1;if(t.isCullingActive()){if(0===this.getCurrentCullingSet().getCurrentResultMask())return!1;var i=this._pooledMatrix.getOrCreateObject();l.c.identity(i);var r=n.length;return t instanceof h.a&&r--,o.a.computeLocalToWorld(n,!0,i,r),t.getBound().transformMat4(e,i),this.getCurrentCullingSet().isBoundingSphereCulled(e)}return this.getCurrentCullingSet().resetCullingMask(),!1}}(),pushModelViewMatrix:function(){var e=l.f.create();return function(t){var n=this.getNodePath(),i=n.length;if(i){var r=i-1;n[r].getTypeID()===a.a.getTypeID()&&n[r].getReferenceFrame()===d.a.ABSOLUTE_RF&&(this._cameraIndexStack.push(r),this._cameraModelViewIndexStack.push(this._modelViewMatrixStack.getLength()))}else{var o=this._pooledMatrix.getOrCreateObject();l.c.invert(o,t),this._cameraMatrixInverseRoot=o}this._modelViewMatrixStack.push(t),this.getLookVectorLocal(e),this._bbCornerFar=(e[0]>=0?1:0)|(e[1]>=0?2:0)|(e[2]>=0?4:0),this._bbCornerNear=7&~this._bbCornerFar}}(),popModelViewMatrix:function(){var e=l.f.create();return function(){var t=this.getNodePath().length-1;this._cameraIndexStack.getLength()&&t===this._cameraIndexStack.back()&&(this._cameraIndexStack.pop(),this._cameraModelViewIndexStack.pop()),this._modelViewMatrixStack.pop(),this._modelViewMatrixStack.getLength()?this.getLookVectorLocal(e):l.f.set(e,0,0,-1),this._bbCornerFar=(e[0]>=0?1:0)|(e[1]>=0?2:0)|(e[2]>=0?4:0),this._bbCornerNear=7&~this._bbCornerFar}}(),pushProjectionMatrix:function(e){this._projectionMatrixStack.push(e),this._frustumVolume=-1,this.pushCullingSet()},popProjectionMatrix:function(){this._projectionMatrixStack.pop(),this._frustumVolume=-1,this.popCullingSet()}}),"osg","CullStack"),t.a=v},"R7V+":function(e,t){e.exports='uniform vec2 uNearFar;\n\n#define NO_JITTER\n#define HAS_VIEW_NORMAL\n#define INJECT_VERT gl_Position.z = -uNearFar.x;\n\n#pragma include "base.vert"\n'},R8W4:function(e,t,n){"use strict";var i=n("QVk6"),r=n("OZCL"),a=n("SoBM"),o=[],s=[];o[i.a.TRIANGLES]=function(e,t,n,i){for(var r=e+t,a=e;a<r;a+=3)i.operatorTriangle(n[a],n[a+1],n[a+2])},o[i.a.TRIANGLE_STRIP]=function(e,t,n,i){for(var r=2,a=e;r<t;++r,++a)r%2?i.operatorTriangle(n[a],n[a+2],n[a+1]):i.operatorTriangle(n[a],n[a+1],n[a+2])},o[i.a.TRIANGLE_FAN]=function(e,t,n,i){for(var r=n[e],a=2,o=e+1;a<t;++a,++o)i.operatorTriangle(r,n[o],n[o+1])},o[i.a.POINTS]=function(e,t,n,i){for(var r=e+t,a=e;a<r;++a)i.operatorPoint(n[a])},o[i.a.LINES]=function(e,t,n,i){for(var r=e+t,a=e;a<r;a+=2)i.operatorLine(n[a],n[a+1])},o[i.a.LINE_STRIP]=function(e,t,n,i){for(var r=e+t,a=e;a<r;++a)i.operatorLine(n[a],n[a+1])},o[i.a.LINE_LOOP]=function(e,t,n,i){for(var r=e+t,a=e;a<r;++a)i.operatorLine(n[a],n[a+1]);i.operatorLine(n[n.length-1],n[0])},s[i.a.TRIANGLES]=function(e,t,n){for(var i=2,r=e;i<t;i+=3,r+=3)n.operatorTriangle(r,r+1,r+2)},s[i.a.TRIANGLE_STRIP]=function(e,t,n){for(var i=2,r=e;i<t;++i,++r)i%2?n.operatorTriangle(r,r+2,r+1):n.operatorTriangle(r,r+1,r+2)},s[i.a.TRIANGLE_FAN]=function(e,t,n){for(var i=2,r=e+1;i<t;++i,++r)n.operatorTriangle(e,r,r+1)},s[i.a.POINTS]=function(e,t,n){for(var i=0,r=e;i<t;++i,++r)n.operatorPoint(r)},s[i.a.LINES]=function(e,t,n){for(var i=1,r=e;i<t;i+=2,r+=2)n.operatorLine(r,r+1)},s[i.a.LINE_STRIP]=function(e,t,n){for(var i=1,r=e;i<t;++i,++r)n.operatorLine(r,r+1)},s[i.a.LINE_LOOP]=function(e,t,n){for(var i=1,r=e;i<t;++i,++r)n.operatorLine(r,r+1);n.operatorLine(e+t-1,e)};t.a=function(e,t){var n=e.getPrimitiveSetList();if(n)for(var i,u=n.length,l=0;l<u;l++){var c=n[l];if(c instanceof r.a){if(i=o[c.getMode()]){var h=c.indices.getElements();i(c.getFirst()/h.BYTES_PER_ELEMENT,c.getCount(),h,t)}}else c instanceof a.a&&(i=s[c.getMode()])&&i(c.getFirst(),c.getCount(),t)}}},RGp6:function(e,t){e.exports='#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureSSSColor;\nuniform sampler2D TextureDepth;\nuniform vec2 uTextureSSSColorSize;\n\nuniform vec4 uHalton;\n\n#pragma include "sssCommon.glsl"\n\n// hacky line to force the composerPostprocess to\n// hook texture funciton in sssCommon because pragma defines\n// aren\'t handled directly\n\n// TEXTURE_2D_TextureSSSColor(whatever)\nvec4 sssExtract() {\n    vec4 pack = TEXTURE_2D_TextureDepth(gTexCoord);\n    vec3 specular;\n    vec3 diffuse;\n    uncheckerboard(diffuse, specular);\n\n    // force depth "0" to tell sss blur to skip the pixel when blurring\n    float bgOrNotSSS = decodeProfile(pack) == 0 || pack.x == 1.0 ? 0.0 : 1.0;\n\n    return vec4(diffuse, bgOrNotSSS * decodeDepth(pack));\n}\n'},RPqA:function(e,t,n){"use strict";var i=function(e,t){return"core_"+t},r=function(e,t){return"#define "+t},a="(GL_EXT_shader_texture_lod|GL_OES_standard_derivatives|GL_EXT_draw_buffers|GL_EXT_frag_depth;)",o=new RegExp("#\\s*extension\\s+"+a+".*","g"),s=new RegExp(a,"g"),u=[],l=function(e,t){var n="glFragData_"+t;return u[t]="layout(location = "+t+") out vec4 "+n+";",n};t.a=function(e,t){return e=function(e){return e=(e=e.replace(o,r)).replace(s,i)}(e=(e=(e=(e=e.replace(/attribute\s+/g,"in ")).replace(/varying\s+/g,t?"in ":"out ")).replace(/(texture2D|textureCube)\s*\(/g,"texture(")).replace(/(textureCubeLodEXT)\s*\(/g,"textureLod(")),t&&(u.length=0,e=e.replace(/gl_FragData\s*\[\s*(\d+)\s*\]/g,l),u.length||u.push("out vec4 glFragColor_0;"),e=(e=e.replace(/gl_FragColor/g,"glFragColor_0")).replace(/void\s+main\s*\(/g,u.join("\n")+"\nvoid main(")),e}},RTFJ:function(e,t,n){"use strict";n.r(t);var i=n("icjm"),r=n("a3nb"),a=n("/QLk"),o=n("v+9t"),s=n("wwkN"),u=n("D1Qd"),l=n("QVk6"),c=n("SoBM"),h=n("OZCL"),d=n("vQSd"),f=n("Vx0a"),p=n("czSk"),g=n("GhR1"),m=n("QD80"),v=n("+vQk"),_={ObjectWrapper:{}};_.ObjectWrapper.serializers={},_.readImage=function(e,t){return _.registry().readImageURL(e,t)},_.readImageURL=_.readImage,_.readBinaryArrayURL=function(e,t){return _.registry().readBinaryArrayURL(e,t)},_.readNodeURL=function(e,t){var n=e.substr(e.lastIndexOf(".")+1),i=v.a.instance().getReaderWriterForExtension(n);return void 0!==i?i.readNodeURL(e,t):_.registry().readNodeURL(e,t)},_.registry=function(){var e=n("zeFU").default;return void 0===_.registry._input&&(_.registry._input=new e),_.registry._input},_.parseSceneGraph=function(e,t){if(!(void 0!==e.Version&&e.Version>0)){r.a.time("osgjs.metric:ReaderParser.parseSceneGraphDeprecated",i.a.INFO);var n=_.parseSceneGraphDeprecated(e);return r.a.timeEnd("osgjs.metric:ReaderParser.parseSceneGraphDeprecated",i.a.INFO),n}var a;for(var o in r.a.time("osgjs.metric:ReaderParser.parseSceneGraph",i.a.INFO),e)if("Generator"!==o&&"Version"!==o){a=o;break}if(a){var s={};s[a]=e[a];var u=_.registry().clone();u.setJSON(s);var l=r.a.objectMix(r.a.objectMix({},_.registry().getOptions()),t||{});u.setOptions(l);var c=u.readObject();return r.a.timeEnd("osgjs.metric:ReaderParser.parseSceneGraph",i.a.INFO),c}i.a.log("can't parse scenegraph "+e,i.a.INFO)},_.parseSceneGraphDeprecated=function(e){var t,v=function(e,t){var n=t[e];return void 0===n&&(n=t[e.toLowerCase()]),n},b=function(e,t){var n=v("Name",t);n&&void 0!==e.setName&&e.setName(n)},S=function(e,t){var n=t.MagFilter||t.mag_filter||void 0;n&&e.setMagFilter(n);var r=t.MinFilter||t.min_filter||void 0;r&&e.setMinFilter(r);var a=t.WrapT||t.wrap_t||void 0;a&&e.setWrapT(a);var o=t.WrapS||t.wrap_s||void 0;o&&e.setWrapS(o);var s=v("File",t);_.readImage(s).then(function(t){e.setImage(t)}).catch(function(){i.a.log("Can't read image")})},y=e.children,x=e._primitives||e.primitives||e.Primitives||void 0,C=e._attributes||e.attributes||e.Attributes||void 0;if(x||C){var w=new s.a;b(w,e),w.stateset=e.stateset,e=w;for(var T=0,M=x.length;T<M;T++){var E=x[T].mode;if(x[T].indices){var A=x[T].indices;A=new u.a(u.a[A.type],A.elements,A.itemSize),E=E?l.a[E]:"TRIANGLES",w.getPrimitiveSetList().push(new h.a(E,A))}else{E=l.a[E];var O=x[T].first,R=x[T].count;w.getPrimitiveSetList().push(new c.a(E,O,R))}}for(var P in C){var I=C[P];w.getVertexAttributeList()[P]=new u.a(I.type,I.elements,I.itemSize)}}var N=v("StateSet",e);if(N){var L=new d.a;!function(e,t){b(e,t);var r=v("Textures",t)||v("TextureAttributeList",t)||void 0;if(r)for(var s=0,u=r.length;s<u;s++)if(v("File",r[s])){var l=new(0,n("ULzY").default);S(l,r[s]),e.setTextureAttributeAndModes(s,l),e.addUniform(a.a.createInt1(s,"Texture"+s))}else i.a.log("no texture on unit "+s+" skip it");var c=v("BlendFunc",t);if(c){var h=new o.a;!function(e,t){b(e,t),e.setSourceRGB(t.SourceRGB),e.setSourceAlpha(t.SourceAlpha),e.setDestinationRGB(t.DestinationRGB),e.setDestinationAlpha(t.DestinationAlpha)}(h,c),e.setAttributeAndModes(h)}var d=v("Material",t);if(d){var f=new(0,n("wDbS").default);!function(e,t){b(e,t),e.setAmbient(v("Ambient",t)),e.setDiffuse(v("Diffuse",t)),e.setEmission(v("Emission",t)),e.setSpecular(v("Specular",t)),e.setShininess(v("Shininess",t))}(f,d),e.setAttributeAndModes(f)}}(L,N),e.stateset=L}var k=e.matrix||e.Matrix||void 0;k&&(t=new g.a,b(t,e),r.a.extend(t,e),p.c.copy(t.getMatrix(),k),e=t);var D=e.projection||e.Projection||void 0;if(D&&(t=new m.a,b(t,e),r.a.extend(t,e),p.c.copy(t.setProjectionMatrix(),D),e=t),void 0===e.typeID&&(t=new f.a,b(t,e),r.a.extend(t,e),e=t),y){e.children=[];for(var F=0,V=y.length;F<V;F++)e.addChild(_.parseSceneGraphDeprecated(y[F]))}return e},t.default=_},RfQL:function(e,t,n){"use strict";(function(e){var i=n("YfG3"),r=n("RzKY");t.a={track:function(t,n){var a=this;return void 0===window.fbq?new e(function(e,i){var r=16,o=setInterval(function(){window.fbq&&(clearInterval(o),e(a.track(t,n))),--r||(clearInterval(o),i("Event skipped, fbq not loaded"))},250)}):Object(r.i)(1e3,new e(function(e){window.fbq("track",t,Object(i.a)({},n),function(){e()})})).catch(function(){})},trackAddToCart:function(e){return this.track("AddToCart",Object(i.a)({currency:"USD",content_type:"product"},e))},trackInitiateCheckout:function(e){return this.track("InitiateCheckout",Object(i.a)({currency:"USD",content_type:"product"},e))},trackPurchase:function(e){return this.track("Purchase",Object(i.a)({currency:"USD",content_type:"product"},e))},trackSearch:function(e){return this.track("Search",Object(i.a)({},e))},trackViewContent:function(e){return this.track("ViewContent",Object(i.a)({currency:"USD",content_type:"product"},e))}}}).call(this,n("CSL1"))},"Ru/i":function(e,t,n){e.exports=n.p+"static/assets/images/viewer/Hotspot-f705d389cfa9353c3ab7e6ce58f49b3f.png"},RwmW:function(e,t,n){"use strict";n("icjm");var i=function(){this._gl=void 0,this._onLostContextCallback=void 0};i.prototype={setGraphicContext:function(e){this._gl=e,i.addObject(this._gl,this)},getGraphicContext:function(){return this._gl},setLostContextCallback:function(e){this._onLostContextCallback=e},onLostContext:function(){this.invalidate&&"function"==typeof this.invalidate&&this.invalidate(),this._onLostContextCallback&&this._onLostContextCallback()}},i._sResourcesArrayCache=new window.Map,i.addObject=function(e,t){i._sResourcesArrayCache.has(e)||i._sResourcesArrayCache.set(e,[]);var n=i._sResourcesArrayCache.get(e);-1===n.indexOf(t)&&n.push(t)},i.removeObject=function(e,t){if(i._sResourcesArrayCache.has(e)){var n=i._sResourcesArrayCache.get(e),r=n.indexOf(t);-1!==r&&n.splice(r,1)}},i.onLostContext=function(e){if(i._sResourcesArrayCache.has(e))for(var t=i._sResourcesArrayCache.get(e),n=0,r=t.length;n<r;n++)t[n].onLostContext()},t.a=i},RzKY:function(e,t,n){"use strict";(function(e){n.d(t,"e",function(){return m}),n.d(t,"a",function(){return v}),n.d(t,"d",function(){return _}),n.d(t,"i",function(){return b}),n.d(t,"g",function(){return S}),n.d(t,"f",function(){return y}),n.d(t,"b",function(){return x}),n.d(t,"c",function(){return C}),n.d(t,"h",function(){return w});var i=n("J4zp"),r=n.n(i),a=n("RIqP"),o=n.n(a),s=n("lwsE"),u=n.n(s),l=n("W8MJ"),c=n.n(l),h=n("lSNA"),d=n.n(h),f=n("hbEN"),p=(n("K7TJ"),n("uPP5")),g=n("QKgc");function m(e){return!!e&&"function"==typeof e.then}var v=function(){function t(n){var i=this;u()(this,t),d()(this,"pointersCount",0),d()(this,"promise",void 0),d()(this,"cancel",void 0);var r=!1;this.cancel=function(){r=!0},this.promise=new e(function(e,t){var a=n(e,t),o=function(){i.pointersCount--,i.pointersCount||("function"==typeof a&&a(),t(new g.a))};i.cancel=o,r&&o()})}return c()(t,[{key:"then",value:function(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){throw e};return this.pointersCount++,new t(function(r,a){var o=function(){};return n.promise.then(function(n){var i=e(n);return i instanceof t&&(o=function(){return i.cancel()}),i},function(e){var n=i(e);return n instanceof t&&(o=function(){return n.cancel()}),n}).then(r,a),function(){return o()}})}},{key:"catch",value:function(e){var n=this;return this.pointersCount++,new t(function(i,r){var a=function(){};return n.promise.catch(function(n){var i=e(n);return i instanceof t&&(a=function(){return i.cancel()}),i}).then(i,r),function(){return a()}})}}],[{key:"fromPromise",value:function(e){return new t(function(t,n){var i=!1;return e.then(function(e){i||t(e)},function(e){i||n(e)}),function(){i=!0}})}}]),t}();function _(t,n){return new e(function(e){return setTimeout(function(){return e(n)},t)})}function b(e,t){var n=v.fromPromise(t);return _(e).then(function(){return n.cancel()}),n}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.interval,r=void 0===i?1e3:i,a=n.prevInterval,o=void 0===a?1e3:a;return new v(function(n,i){var a=!1;return function e(t,n,i){var r=i.interval,o=i.prevInterval;return n().catch(function(i){var s="function"==typeof r?r(o):r;if(i instanceof g.f&&t>0&&!a)return _(s).then(function(){return e(t-1,n,{interval:r,prevInterval:s})});throw i})}(e,t,{interval:r,prevInterval:o}).then(n,i),function(){a=!0}})}var y=function(e){var t;return function(){return t||(t=e.apply(void 0,arguments)).then(function(e){return t=void 0,e}).catch(function(e){throw t=void 0,e})}},x=function(e){var t;return function(){return t&&t.cancel(),(t=v.fromPromise(e.apply(void 0,arguments))).then(function(e){return t=void 0,e}).catch(function(e){throw t=void 0,e})}},C=function(e,t){var n=new p.a,i=Object(f.a)(function(t){var i=e.apply(void 0,o()(t));n.resolve(i),n=new p.a},t),r=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i(t),n};return r.cancel=function(){return i.cancel()},r},w=function(t,n){return e.all([_(t),n]).then(function(e){return r()(e,2)[1]})}}).call(this,n("CSL1"))},S4lS:function(e,t,n){"use strict";var i=n("MVZn"),r=n.n(i),a=["tag","user"];function o(e){return{tags:e.filter(function(e){return"tag"===e.command}).map(function(e){return e.term.trim()}),user:e.filter(function(e){return"user"===e.command}).map(function(e){return e.term.trim()})[0]}}function s(e){var t=/[^\s]+:[^\s]+/g;return{originalTerm:e,commands:(e.match(t)||[]).map(function(e){return{command:e.split(":")[0],term:e.split(":")[1]}}).filter(function(e){return a.includes(e.command)}),term:e.replace(t,function(e){return a.includes(e.split(":")[0])?" ":e}).trim()}}t.a={commandsToQueryParams:o,parseQuery:s,getSearchQueryParams:function(e){var t=s(e);return r()({},o(t.commands),{q:t.term})}}},S8iY:function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("J4zp"),o=n.n(a),s=n("q1tI"),u=n("gPpI"),l=n("wsGC"),c=n("dn3j"),h=n("5bbf"),d=r()(c.a,{});t.a=s.memo(function(e){var t=e.categories,n=e.className,i=s.useContext(h.a),a=s.useState(""),f=o()(a,2),p=f[0],g=f[1];return r()("ul",{className:Object(l.a)("c-navigation",n,{"--transparent":"transparent"===i})},void 0,r()("li",{className:"c-navigation__item c-page-header__col",onMouseEnter:function(){return g("explore")}},void 0,r()("a",{href:Object(u.e)("models:popular"),className:"c-navigation__link show-hover-menu"},void 0,"Explore"),r()("div",{className:"hover-menu",style:{display:"explore"===p?"":"none"}},void 0,r()(c.b,{categories:t}))),r()("li",{className:"c-navigation__item --store c-page-header__col",onMouseEnter:function(){return g("store")}},void 0,r()("a",{href:Object(u.e)("store:home",{},{ref:"header"}),className:"c-navigation__link show-hover-menu --store"},void 0,"Buy 3D models"),r()("div",{className:"hover-menu --store",style:{display:"store"===p?"":"none"}},void 0,r()(c.c,{categories:t}))),r()("li",{className:"c-navigation__item c-page-header__col",onMouseEnter:function(){return g("business")}},void 0,r()("a",{href:Object(u.e)("pages:enterprise",{},{ref:"header"}),className:"c-navigation__link show-hover-menu"},void 0,"For business"),r()("div",{className:"hover-menu --business",style:{display:"business"===p?"":"none"}},void 0,d)))})},SF8B:function(e,t,n){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/logo.jinja"]={root:function(e,t,i,r,a){var o=null,s=null,u="";try{var l=r.makeMacro([],["headerStyle"],function(a){var u=i;i=new r.Frame,(a=a||{}).hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("headerStyle",a.hasOwnProperty("headerStyle")?a.headerStyle:"normal");var l="";return l+='\n<div class="logo">\n    <a aria-label="Sketchfab Homepage" class="link" href="/">\n        ',l+="\n        ","transparent"==r.contextOrFrameLookup(t,i,"headerStyle")&&(l+='\n        <div class="logo__image --white">\n            <img src="',l+=r.suppressValue(n("/3JF"),e.opts.autoescape),l+='" width="121" height="30" class="svg-logo" alt="Sketchfab">\n            <img src="',l+=r.suppressValue(n("c4eT"),e.opts.autoescape),l+='" width="121" height="30" class="svg-logo --hover" alt="Sketchfab">\n        </div>\n        '),l+="\n        ",l+='\n        <div class="logo__image">\n            ',l+=r.suppressValue((o=12,s=17,r.callWrap(r.contextOrFrameLookup(t,i,"logo"),"logo",t,[121,30])),e.opts.autoescape),l+="\n        </div>\n    </a>\n</div>\n",i=u,new r.SafeString(l)});t.addExport("header_logo"),t.setVariable("header_logo",l),u+="\n\n\n";var c=r.makeMacro([],[],function(n){var a=i;i=new r.Frame,(n=n||{}).hasOwnProperty("caller")&&i.set("caller",n.caller);var u="";return u+='\n<div class="logo">\n    <a title="Sketchfab Homepage" href="/">\n        ',u+=r.suppressValue((o=22,s=13,r.callWrap(r.contextOrFrameLookup(t,i,"logo"),"logo",t,[96,20])),e.opts.autoescape),u+="\n    </a>\n</div>\n",i=a,new r.SafeString(u)});t.addExport("responsive_header_logo"),t.setVariable("responsive_header_logo",c),u+="\n\n";var h=r.makeMacro([],[],function(e){var t=i;i=new r.Frame,(e=e||{}).hasOwnProperty("caller")&&i.set("caller",e.caller);var n="";return n+='\n<svg viewBox="0 0 13 16" xmlns="http://www.w3.org/2000/svg">\n    <g fill-rule="nonzero">\n        <path class="shape1" d="M5.3029 8.1731L0 4.9864v5.8286l5.3029 3.1867z"/>\n        <path class="shape2" d="M5.9987 6.9902l5.8157-3.495L5.9987 0 .1829 3.4953z"/>\n        <path class="shape3" d="M6.6944 8.1731v5.8286l5.303-3.1867V4.9864z"/>\n    </g>\n</svg>\n',i=t,new r.SafeString(n)});t.addExport("sketchfab_spinner"),t.setVariable("sketchfab_spinner",h),u+="\n\n";var d=r.makeMacro([],[],function(e){var t=i;i=new r.Frame,(e=e||{}).hasOwnProperty("caller")&&i.set("caller",e.caller);var n="";return n+='\n<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" class="icon-hover">\n  <path d="M6.5942 13.577a2.2672 2.2672 0 01-1.5915-.6503L.4123 8.4022a1.3732 1.3732 0 010-1.9619c.5491-.5413 1.4408-.5415 1.99.0003L6.452 10.432 11.7802.7273c.3696-.6736 1.2224-.9246 1.9075-.5598.6837.3648.9379 1.2065.568 1.88L8.457 12.6095l-.063.083c-.3927.5134-.9908.8339-1.6415.8788a2.1584 2.1584 0 01-.1582.0058" fill-rule="nonzero"/>\n</svg>\n',i=t,new r.SafeString(n)});t.addExport("spinner_check"),t.setVariable("spinner_check",d),u+="\n\n";var f=r.makeMacro(["width","height"],["options"],function(n,a,o){var s=i;i=new r.Frame,(o=o||{}).hasOwnProperty("caller")&&i.set("caller",o.caller),i.set("width",n),i.set("height",a),i.set("options",o.hasOwnProperty("options")?o.options:{});var u,l="";return l+="\n\n    ",u=e.getFilter("merge").call(t,{brand:!0,color:"#555555",logo_color:"#FFFFFF",circle_color:"#1CAAD9"},r.contextOrFrameLookup(t,i,"options")),i.set("options",u,!0),i.topLevel&&t.setVariable("options",u),i.topLevel&&t.addExport("options",u),l+="\n\n    ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"brand")?(l+="\n        ",i.set("view_width",121,!0),i.topLevel&&t.setVariable("view_width",121),i.topLevel&&t.addExport("view_width",121),l+="\n    "):(l+="\n        ",i.set("view_width",25,!0),i.topLevel&&t.setVariable("view_width",25),i.topLevel&&t.addExport("view_width",25),l+="\n    "),l+='\n\n    <svg class="svg-logo" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve"\n         x="0" y="0" width="',l+=r.suppressValue(n,e.opts.autoescape),l+='" height="',l+=r.suppressValue(a,e.opts.autoescape),l+='"\n         viewBox="0 0 ',l+=r.suppressValue(r.contextOrFrameLookup(t,i,"view_width"),e.opts.autoescape),l+=' 25"\n         enable-background="new 0 0 ',l+=r.suppressValue(r.contextOrFrameLookup(t,i,"view_width"),e.opts.autoescape),l+=' 25">\n\n        ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"brand")&&(l+='\n            <g class="logo-text">\n                <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                    d="M36.471,7.719c-1.526,0-2.289,0.504-2.289,1.512c0,0.448,0.189,0.791,0.567,1.029\n                       c0.378,0.238,1.263,0.582,2.656,1.029c1.393,0.448,2.37,0.956,2.93,1.522c0.56,0.567,0.84,1.438,0.84,2.615\n                       c0,1.498-0.455,2.632-1.365,3.401c-0.911,0.771-2.1,1.155-3.57,1.155c-1.092,0-2.429-0.168-4.011-0.504l-0.756-0.147l0.294-2.247\n                       c1.876,0.253,3.311,0.379,4.305,0.379c1.484,0,2.226-0.616,2.226-1.849c0-0.447-0.171-0.798-0.515-1.05s-1.025-0.525-2.047-0.819\n                       c-1.624-0.462-2.769-1.011-3.434-1.648s-0.998-1.522-0.998-2.657c0-1.428,0.434-2.492,1.302-3.192c0.868-0.7,2.058-1.05,3.57-1.05\n                       c1.036,0,2.352,0.14,3.948,0.42l0.756,0.147L40.65,8.056C38.676,7.832,37.283,7.719,36.471,7.719z"\n                />\n                <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                    d="M46.068,19.731h-2.814v-14.7h2.814v8.358l1.071-0.189l2.079-3.969h3.15l-2.73,4.977l2.877,5.523h-3.171\n                       l-2.121-4.095l-1.155,0.188V19.731z"\n                />\n                <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                    d="M56.705,17.075c0.329,0.287,0.801,0.431,1.417,0.431c1.302,0,2.464-0.042,3.486-0.126l0.589-0.063\n                       l0.041,2.079c-1.61,0.392-3.066,0.588-4.368,0.588c-1.582,0-2.73-0.42-3.444-1.26c-0.714-0.84-1.071-2.205-1.071-4.095\n                       c0-3.766,1.547-5.649,4.641-5.649c3.052,0,4.578,1.582,4.578,4.746l-0.209,1.953H56.19C56.204,16.322,56.375,16.788,56.705,17.075z\n                       M59.802,13.536c0-0.84-0.133-1.424-0.399-1.753c-0.266-0.329-0.732-0.493-1.396-0.493c-0.666,0-1.134,0.171-1.407,0.514\n                       c-0.273,0.343-0.417,0.921-0.431,1.732H59.802z"\n                />\n                <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                    d="M70.407,11.625h-2.583v4.305c0,0.42,0.011,0.718,0.031,0.893c0.021,0.175,0.098,0.325,0.231,0.451\n                       c0.133,0.126,0.339,0.189,0.619,0.189l1.596-0.042l0.126,2.246c-0.938,0.211-1.651,0.315-2.142,0.315\n                       c-1.26,0-2.121-0.283-2.583-0.851c-0.462-0.566-0.693-1.613-0.693-3.14v-4.368h-1.238V9.231h1.238V6.312h2.814v2.919h2.583V11.625z"\n                />\n                <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                    d="M76.161,8.979c0.729,0,1.659,0.112,2.794,0.336l0.566,0.126l-0.084,2.226\n                       c-1.106-0.112-1.925-0.168-2.457-0.168c-0.966,0-1.606,0.207-1.921,0.62c-0.315,0.413-0.473,1.193-0.473,2.341\n                       c0,1.148,0.157,1.937,0.473,2.363c0.314,0.427,0.962,0.641,1.942,0.641l2.436-0.168l0.084,2.246\n                       c-1.498,0.295-2.639,0.441-3.423,0.441c-1.554,0-2.671-0.438-3.35-1.312s-1.019-2.278-1.019-4.211c0-1.932,0.35-3.328,1.05-4.189\n                       S74.607,8.979,76.161,8.979z"\n                />\n                <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                    d="M84.414,19.731H81.6v-14.7h2.814v4.704c0.966-0.504,1.834-0.756,2.604-0.756c1.4,0,2.366,0.413,2.898,1.239\n                       c0.531,0.826,0.798,2.1,0.798,3.822v5.691h-2.814v-5.628c0-0.882-0.104-1.536-0.314-1.963s-0.63-0.641-1.26-0.641\n                       c-0.546,0-1.093,0.084-1.639,0.252l-0.272,0.084V19.731z"\n                />\n                <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                    d="M96.531,11.625v8.106h-2.814v-8.106h-1.134V9.231h1.134V8.77c0-1.512,0.224-2.555,0.672-3.129\n                       s1.246-0.861,2.395-0.861c0.504,0,1.155,0.07,1.953,0.21l0.44,0.063l-0.042,2.289c-0.616-0.028-1.134-0.042-1.554-0.042\n                       s-0.7,0.112-0.84,0.336c-0.141,0.224-0.21,0.609-0.21,1.155v0.441h2.541v2.394H96.531z"\n                />\n                <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                    d="M108.753,12.507v4.368c0.028,0.337,0.084,0.571,0.168,0.704s0.259,0.228,0.525,0.283l-0.084,2.121\n                       c-0.714,0-1.285-0.049-1.712-0.146c-0.427-0.099-0.857-0.295-1.291-0.589c-1.008,0.49-2.037,0.735-3.087,0.735\n                       c-2.171,0-3.255-1.147-3.255-3.444c0-1.119,0.301-1.914,0.902-2.383c0.603-0.469,1.526-0.746,2.772-0.83l2.247-0.168v-0.651\n                       c0-0.434-0.099-0.731-0.294-0.893c-0.196-0.161-0.512-0.241-0.945-0.241l-3.948,0.168l-0.084-1.953\n                       c1.498-0.406,2.923-0.609,4.273-0.609c1.352,0,2.324,0.28,2.919,0.84C108.456,10.379,108.753,11.276,108.753,12.507z\n                       M104.028,15.279c-0.784,0.07-1.176,0.49-1.176,1.26c0,0.771,0.343,1.155,1.028,1.155c0.532,0,1.113-0.084,1.743-0.252l0.315-0.084\n                       v-2.247L104.028,15.279z"\n                />\n                <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                    d="M116.522,8.979c1.47,0,2.545,0.402,3.224,1.208s1.019,2.244,1.019,4.316c0,2.071-0.392,3.503-1.176,4.294\n                       s-2.136,1.187-4.053,1.187c-0.603,0-1.701-0.07-3.298-0.21l-0.798-0.084V5.031h2.814v4.515\n                       C115.15,9.168,115.906,8.979,116.522,8.979z M115.536,17.464c0.938,0,1.567-0.228,1.89-0.683s0.482-1.271,0.482-2.447\n                       c0-1.89-0.588-2.834-1.764-2.834c-0.56,0-1.092,0.07-1.596,0.21l-0.294,0.063v5.607C114.898,17.436,115.325,17.464,115.536,17.464z"\n                />\n            </g>\n        '),l+='\n\n        <g class="logo">\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"logo_color"),e.opts.autoescape),l+='"\n                  d="M12.5,0.833C6.056,0.833,0.834,6.057,0.834,12.5S6.056,24.167,12.5,24.167S24.167,18.943,24.167,12.5\n                     S18.944,0.833,12.5,0.833z" />\n        </g>\n\n        <g class="logo-circle">\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"circle_color"),e.opts.autoescape),l+='"\n                d="M12.5-0.029C5.596-0.029,0,5.568,0,12.472c0,6.904,5.596,12.501,12.5,12.501s12.5-5.597,12.5-12.501\n                   C25.001,5.568,19.405-0.029,12.5-0.029z M11.414,19.911L6.025,16.8v-6.276l5.389,2.911V19.911z M12.374,11.958l-6.376-3.38\n                   l6.376-3.682l6.377,3.682L12.374,11.958z M18.755,16.812l-5.369,3.1v-6.452l5.369-2.901V16.812z"\n            />\n        </g>\n\n    </svg>\n\n',i=s,new r.SafeString(l)});t.addExport("logo"),t.setVariable("logo",f),u+="\n\n\n";var p=r.makeMacro(["width","height"],["options"],function(n,a,o){var s=i;i=new r.Frame,(o=o||{}).hasOwnProperty("caller")&&i.set("caller",o.caller),i.set("width",n),i.set("height",a),i.set("options",o.hasOwnProperty("options")?o.options:{});var u,l="";return l+="\n\n    ",u=e.getFilter("merge").call(t,{color:"#FFFFFF"},r.contextOrFrameLookup(t,i,"options")),i.set("options",u,!0),i.topLevel&&t.setVariable("options",u),i.topLevel&&t.addExport("options",u),l+='\n\n    <svg class="svg-logo" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve"\n         x="0" y="0" width="',l+=r.suppressValue(n,e.opts.autoescape),l+='" height="',l+=r.suppressValue(a,e.opts.autoescape),l+='"\n         viewBox="0 0 ',l+=r.suppressValue(n,e.opts.autoescape),l+=" ",l+=r.suppressValue(a,e.opts.autoescape),l+='"\n         enable-background="new 0 0 ',l+=r.suppressValue(n,e.opts.autoescape),l+=" ",l+=r.suppressValue(a,e.opts.autoescape),l+='">\n\n        <g>\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M16.3,0a16.4,16.4,0,1,0,.2,0ZM15.2,26.4,7.9,21.9V13.7l7.3,4.5ZM8.3,11.3l8-4.7,8,4.7-8,5ZM24.8,21.9l-7.5,4.5V18.1l7.5-4.5Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M46.9,10.9q-2.7,0-2.7,1.8a1.39,1.39,0,0,0,.7,1.2,17.55,17.55,0,0,0,3.2,1.2,7.82,7.82,0,0,1,3.5,1.8,4.45,4.45,0,0,1,1,3.1A5,5,0,0,1,51,24a7.06,7.06,0,0,1-4.2,1.4,19.73,19.73,0,0,1-4.8-.6l-.9-.2.4-2.7a44,44,0,0,0,5.1.5c1.8,0,2.6-.7,2.6-2.2a1.43,1.43,0,0,0-.6-1.2,12.23,12.23,0,0,0-2.4-1,9.26,9.26,0,0,1-4.1-2,4.14,4.14,0,0,1-1.2-3.2A4.48,4.48,0,0,1,42.5,9a6.29,6.29,0,0,1,4.2-1.2,37.48,37.48,0,0,1,4.7.5l.9.2L52,11.2Q48.25,10.9,46.9,10.9Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M58.3,25.2H54.9V7.6h3.4v10l1.3-.2,2.5-4.7h3.8l-3.2,5.9,3.4,6.6H62.3l-2.5-4.9-1.4.2-.1,4.7Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M70.9,22a3.37,3.37,0,0,0,1.7.5c1.5,0,2.9,0,4.1-.1l.7-.1v2.5a18.13,18.13,0,0,1-5.2.7A5.26,5.26,0,0,1,68.1,24c-.9-1-1.3-2.6-1.3-4.9,0-4.5,1.8-6.7,5.5-6.7s5.4,1.9,5.4,5.6l-.2,2.3H70.1A3.81,3.81,0,0,0,70.9,22Zm3.7-4.2a3.14,3.14,0,0,0-.5-2.1,2.71,2.71,0,0,0-3.4,0,3.14,3.14,0,0,0-.5,2.1Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M87.3,15.5H84.2v6.2a.55.55,0,0,0,.3.5,1.85,1.85,0,0,0,.7.2h1.9l.1,2.7a21.66,21.66,0,0,1-2.5.4,3.91,3.91,0,0,1-3.1-1,6.71,6.71,0,0,1-.8-3.7V15.6H79.3V12.8h1.5V9.3h3.4v3.5h3.1Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M94.1,12.4a12.42,12.42,0,0,1,3.3.4l.7.2L98,15.7c-1.3-.1-2.3-.2-2.9-.2-1.2,0-1.9.2-2.3.7a4.46,4.46,0,0,0-.6,2.8,4.46,4.46,0,0,0,.6,2.8,2.86,2.86,0,0,0,2.3.8l2.9-.2.1,2.7a28.68,28.68,0,0,1-4.1.5c-1.9,0-3.2-.5-4-1.6a8.37,8.37,0,0,1-1.2-5c0-2.3.4-4,1.2-5A5.21,5.21,0,0,1,94.1,12.4Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M103.9,25.2h-3.4V7.6h3.4v5.6a6.58,6.58,0,0,1,3.1-.9,4,4,0,0,1,3.5,1.5,8.75,8.75,0,0,1,1,4.5v6.8h-3.4V18.4a4.49,4.49,0,0,0-.4-2.3,1.56,1.56,0,0,0-1.5-.8,6.45,6.45,0,0,0-2,.3l-.3.1Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M118.4,15.5v9.7H115V15.5h-1.4V12.7H115v-.5a6.71,6.71,0,0,1,.8-3.7,3.28,3.28,0,0,1,2.8-1c.6,0,1.4.1,2.3.2l.5.1-.1,2.7h-1.8a1,1,0,0,0-1,.4,2.2,2.2,0,0,0-.2,1.4v.5h3v2.8l-2.9-.1Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M132.9,16.6v5.2a1.08,1.08,0,0,0,.2.8.71.71,0,0,0,.6.3l-.1,2.5a13.55,13.55,0,0,1-2-.2,2.63,2.63,0,0,1-1.5-.7,7.79,7.79,0,0,1-3.7.9c-2.6,0-3.9-1.4-3.9-4.1a3.25,3.25,0,0,1,1.1-2.8,5.58,5.58,0,0,1,3.3-1l2.7-.2v-.8a1.19,1.19,0,0,0-.4-1.1,2,2,0,0,0-1.1-.3l-4.7.2-.1-2.3a17.92,17.92,0,0,1,5.1-.7,4.84,4.84,0,0,1,3.5,1A4.36,4.36,0,0,1,132.9,16.6Zm-5.6,3.3a1.37,1.37,0,0,0-1.4,1.4v.1c0,.9.4,1.4,1.2,1.4a7.61,7.61,0,0,0,2.1-.3l.4-.1V19.7Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M142.2,12.4a4.89,4.89,0,0,1,3.8,1.4c.8.9,1.2,2.7,1.2,5.1s-.5,4.2-1.4,5.1-2.5,1.4-4.8,1.4c-.7,0-2-.1-3.9-.2l-1-.1V7.6h3.4V13A6.6,6.6,0,0,1,142.2,12.4Zm-1.2,10a2.65,2.65,0,0,0,2.2-.8,4.92,4.92,0,0,0,.6-2.9c0-2.2-.7-3.4-2.1-3.4a12.25,12.25,0,0,0-1.9.2l-.3.1v6.8Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M160.7,10.9q-2.7,0-2.7,1.8a1.39,1.39,0,0,0,.7,1.2,17.55,17.55,0,0,0,3.2,1.2,7.82,7.82,0,0,1,3.5,1.8,4.45,4.45,0,0,1,1,3.1,5,5,0,0,1-1.6,4,7.06,7.06,0,0,1-4.2,1.4,19.73,19.73,0,0,1-4.8-.6l-.9-.2.3-2.7a44,44,0,0,0,5.1.5c1.8,0,2.7-.7,2.7-2.2a1.43,1.43,0,0,0-.6-1.2,12.23,12.23,0,0,0-2.4-1,9.26,9.26,0,0,1-4.1-2,4.14,4.14,0,0,1-1.2-3.2A4.64,4.64,0,0,1,156.2,9a6.29,6.29,0,0,1,4.2-1.2,37.48,37.48,0,0,1,4.7.5l.9.2-.3,2.7C163.4,11,161.7,10.9,160.7,10.9Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M175.6,15.5h-3.1v6.2a.55.55,0,0,0,.3.5,1.85,1.85,0,0,0,.7.2h1.9l.2,2.7a21.66,21.66,0,0,1-2.5.4,3.91,3.91,0,0,1-3.1-1,6.71,6.71,0,0,1-.8-3.7V15.6h-1.5V12.8h1.5V9.3h3.4v3.5h3.1l-.1,2.7Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M178.5,14.1a5.59,5.59,0,0,1,4.4-1.7,5.16,5.16,0,0,1,4.4,1.7,7.44,7.44,0,0,1,1.3,4.8c0,4.4-1.9,6.6-5.8,6.6s-5.8-2.2-5.8-6.6A8.27,8.27,0,0,1,178.5,14.1Zm2.5,7.6a2.25,2.25,0,0,0,3.6,0,6.63,6.63,0,0,0,.5-2.8,6.63,6.63,0,0,0-.5-2.8,2.25,2.25,0,0,0-3.6,0,6.63,6.63,0,0,0-.5,2.8A6.63,6.63,0,0,0,181,21.7Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M191.1,25.2V12.6h3.3v1.3a11.59,11.59,0,0,1,4-1.6v3.4c-1.3.3-2.5.6-3.5.9l-.5.2v8.4Z"\n            />\n            <path fill="',l+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"color"),e.opts.autoescape),l+='"\n                d="M203.7,22a3.37,3.37,0,0,0,1.7.5c1.6,0,2.9,0,4.2-.1l.7-.1v2.5a18.13,18.13,0,0,1-5.2.7A5.26,5.26,0,0,1,201,24c-.9-1-1.3-2.6-1.3-4.9,0-4.5,1.8-6.7,5.5-6.7s5.5,1.9,5.5,5.6l-.2,2.3h-7.4A2.72,2.72,0,0,0,203.7,22Zm3.7-4.2a3.14,3.14,0,0,0-.5-2.1,2.71,2.71,0,0,0-3.4,0,3.14,3.14,0,0,0-.5,2.1Z"\n            />\n        </g>\n    </svg>\n\n',i=s,new r.SafeString(l)});t.addExport("store_logo"),t.setVariable("store_logo",p),a(null,u+="\n")}catch(e){a(r.handleError(e,o,s))}}}},SoBM:function(e,t,n){"use strict";var i=n("QVk6"),r=function(e,t,n){this.mode=e,void 0!==e&&("string"==typeof e&&(e=i.a[e]),this.mode=e),this.first=t,this.count=n};r.prototype={draw:function(e){0!==this.count&&e.getGraphicContext().drawArrays(this.mode,this.first,this.count)},getMode:function(){return this.mode},setCount:function(e){this.count=e},getCount:function(){return this.count},setFirst:function(e){this.first=e},getFirst:function(){return this.first},getNumIndices:function(){return this.count},index:function(e){return this.first+e}},t.a=r},Sru3:function(e,t){e.exports='#pragma include "utils/functions.glsl"\n#pragma include "utils/encodeDecode.glsl"\n#pragma include "utils/rand.glsl"\n\nuniform sampler2D TextureMipmapDepth;\nuniform vec2 uTextureMipmapDepthSize;\nuniform vec2 uTextureMipmapDepthRatio;\n\nuniform float uQuality; // mipmap usage\n\nuniform vec2 uTextureOutputSize;\n\nuniform float uSsaoRadius;\nuniform float uSsaoIntensity;\nuniform float uSsaoBias;\nuniform vec4 uSsaoProjectionInfo;\nuniform float uSsaoProjectionScale;\n\nuniform vec2 uNearFar;\n\nuniform float uFrameModTaaSS;\n\n// Constant used to scale the depth view value that is given to the blur pass\n#define MIN_RADIUS 1.0\n#define NB_SPIRAL_TURNS 3.0\n\nvec4 fetchDepthPackLevel(const in vec2 uv, const in float level){\n    float maxLod = 5.0;\n    float powLevel = pow(2.0, min(maxLod, floor(level)) + 1.0);\n    vec2 pixelSize = 2.0 * powLevel / uTextureMipmapDepthSize;\n\n    vec2 uvFetch = max(pixelSize, min(1.0 - pixelSize, uv));\n    uvFetch = vec2(2.0 * uvFetch.x, powLevel - 1.0 - uvFetch.y) * uTextureMipmapDepthRatio.xy / powLevel;\n\n    return texture2D(TextureMipmapDepth, uvFetch);\n}\n\nfloat fetchDepthLevel(const in vec2 uv, const in float level){\n    return decode24(fetchDepthPackLevel(uv, level).xyz);\n}\n\nfloat zValueFromScreenSpacePosition(const in float depth) {\n    return uNearFar.x + (uNearFar.y - uNearFar.x) * depth;\n}\n\nvec3 reconstructCSPosition(const in vec2 ssP, const in float z) {\n    return vec3((ssP.xy * uSsaoProjectionInfo.xy + uSsaoProjectionInfo.zw) * z, z);\n}\n\nvec3 getPosition(const in vec2 uv) {\n    return reconstructCSPosition(uv * uTextureOutputSize, zValueFromScreenSpacePosition(fetchDepthLevel(uv, 0.0)));\n}\n\n#define MAX_MIP_LEVEL 5\n// Determines at which point we should switch mip level\n// if number is too small (~3) will lead to flashing (bad variance as many taps give same pixel)\n// if number is too high, mip level are not used well and the cache is not used efficiently\n#define LOG_MAX_OFFSET 3\n\nvec3 getOffsetedPixelPos(\n    const in vec2 uv,\n    const in vec2 unitOffset,\n    const in float screenSpaceRadius) {\n\n    float mipLevel = clamp(floor(log2(screenSpaceRadius)) - float(LOG_MAX_OFFSET), 0.0, float(MAX_MIP_LEVEL));\n    vec2 uvOff = uv + floor(screenSpaceRadius * unitOffset) / uTextureOutputSize;\n\n    float d = zValueFromScreenSpacePosition(fetchDepthLevel(uvOff, mipLevel));\n    return reconstructCSPosition(uvOff * uTextureOutputSize, d);\n}\n\n#define PIOVER8 0.39269908169\nvec3 unpackNormal1(const in float pack1) {\n    float pack8 = floor(pack1 * 255.0);\n    float th = PIOVER8 * float(pack8 / 16.0);\n    float len = sqrt(mod(float(pack8), 16.0) / 15.001);\n    vec2 nv = vec2(cos(th), sin(th)) * len;\n    return -vec3(nv.x, nv.y, sqrt(max(0.0, 1.0 - nv.x * nv.x - nv.y * nv.y)));\n}\n\nvec3 unpackNormal2(const in vec2 pack2) {\n    vec3 nv = pack2.rgg * 2.0 - 1.0;\n    return -vec3(nv.x, nv.y, sqrt(max(0.0, 1.0 - nv.x * nv.x - nv.y * nv.y)));\n}\n\n#define SSAO_TAP_EXTRACT(id) screenSpaceRadius = (float(id) + 0.5) * (1.0 / nbSamples); \\\n    angle = screenSpaceRadius * (NB_SPIRAL_TURNS * 6.28) + randomAngle; \\\n    screenSpaceRadius = max(0.75, screenSpaceRadius * ssRadius); \\\n    offsetUnitVec = vec2(cos(angle), sin(angle)); \\\n    occludingPoint = getOffsetedPixelPos(uv, offsetUnitVec, screenSpaceRadius); \\\n    occludingPoint -= cameraSpacePosition; \\\n    vv = dot(occludingPoint, occludingPoint); \\\n    vn = dot(occludingPoint, normal); \\\n    contrib += max(1.0 - vv * invRadius2, 0.0) * max((vn - uSsaoBias) * inversesqrt(vv), 0.0); \\\n\n#define SSAO_DO_TAPS(void) SSAO_TAP_EXTRACT(offset + 0); \\\n    SSAO_TAP_EXTRACT(offset + 1); \\\n    SSAO_TAP_EXTRACT(offset + 2); \\\n    SSAO_TAP_EXTRACT(offset + 3); \\\n    SSAO_TAP_EXTRACT(offset + 4); \\\n    SSAO_TAP_EXTRACT(offset + 5); \\\n    SSAO_TAP_EXTRACT(offset + 6); \\\n    SSAO_TAP_EXTRACT(offset + 7); \\\n    SSAO_TAP_EXTRACT(offset + 8); \\\n    SSAO_TAP_EXTRACT(offset + 9); \\\n    SSAO_TAP_EXTRACT(offset + 10); \\\n    offset += 11; \\\n\n\nvec4 ssaoExtract() {\n    vec2 uv = gTexCoord;\n\n    vec3 depthPacked = fetchDepthPackLevel(uv, 0.0).xyz;\n\n    vec3 cameraSpacePosition = getPosition(uv);\n    float ssRadius = -uSsaoProjectionScale * uSsaoRadius / cameraSpacePosition.z;\n\n#ifdef SSAO_NORMAL\n    vec3 normal = unpackNormal2(TEXTURE_2D_TextureDepth(uv).ba); // g buffer normal 2 component on ba\n#elif defined(GL_OES_standard_derivatives) && !defined(MOBILE)\n    vec3 normal = cross(dFdy(cameraSpacePosition), dFdx(cameraSpacePosition));\n#else\n    vec2 offDepth = vec2(1.0, 0.0);\n    vec3 depthLeft = getPosition(uv - offDepth.xy / uTextureMipmapDepthSize);\n    vec3 depthRight = getPosition(uv + offDepth.xy / uTextureMipmapDepthSize);\n    vec3 depthBottom = getPosition(uv - offDepth.yx / uTextureMipmapDepthSize);\n    vec3 depthTop = getPosition(uv + offDepth.yx / uTextureMipmapDepthSize);\n    vec3 normal = cross(depthLeft - depthRight, depthTop - depthBottom);\n#endif\n\n    // early returns should be done derivatives usage to avoid bad edges\n\n    // early return background\n    if (depthPacked.x == 1.0) {\n        return vec4(depthPacked, 1.0);\n    }\n\n    // early return radius too small (note: needs to be in separate conditional because of nvidia/osx bug)\n    if (ssRadius < MIN_RADIUS) {\n        return vec4(depthPacked, 1.0);\n    }\n\n    normal = normalize(normal);\n    float nFalloff = mix(1.0, max(0.0, 1.5 * normal.z), 0.35);\n\n     // needs to be > 2PI\n    float randomAngle = 6.28 * interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS);\n    float invRadius2 = 1.0 / (uSsaoRadius * uSsaoRadius);\n    float contrib = 0.0;\n\n    float vv;\n    float vn;\n    float screenSpaceRadius;\n    float angle;\n    vec3 occludingPoint;\n    vec2 offsetUnitVec;\n    int offset = 0;\n\n    float nbSamples = 11.0;\n\n    if (uQuality > 0.33) nbSamples += 11.0;\n#ifndef MOBILE\n    if (uQuality > 0.66) nbSamples += 11.0;\n#endif\n\n    SSAO_DO_TAPS();\n    if (uQuality > 0.33) { SSAO_DO_TAPS(); }\n#ifndef MOBILE\n    if (uQuality > 0.66) { SSAO_DO_TAPS(); }\n#endif\n\n    float aoValue = max(0.0, 1.0 - sqrt(contrib * nFalloff / nbSamples));\n    aoValue = pow(aoValue, 10.0 * uSsaoIntensity);\n\n    vec4 aoDepth;\n    aoDepth.rgb = depthPacked;\n    aoDepth.a = mix(1.0, aoValue, clamp(ssRadius - MIN_RADIUS, 0.0, 1.0));\n\n    return aoDepth;\n}\n'},SyQS:function(e,t){e.exports='#pragma include "utils/functions.glsl"\r\n\r\n#extension GL_EXT_shader_texture_lod : enable\r\nvec3 prefilterEnvMapCube(const in float rLinear, const in vec3 R) {\r\n    vec3 dir = R;\r\n    float lod = min(uTextureEnvironmentSpecularPBRLodRange.x, linRoughnessToMipmap(rLinear) * uTextureEnvironmentSpecularPBRLodRange.y);\r\n\r\n    // http://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/\r\n    float scale = 1.0 - exp2(lod) / uTextureEnvironmentSpecularPBRTextureSize.x;\r\n    vec3 absDir = abs(dir);\r\n    float M = max(max(absDir.x, absDir.y), absDir.z);\r\n\r\n    if (absDir.x != M) dir.x *= scale;\r\n    if (absDir.y != M) dir.y *= scale;\r\n    if (absDir.z != M) dir.z *= scale;\r\n\r\n    return LUVToRGB(textureCubeLodEXT(sSpecularPBR, dir, lod));\r\n}\r\n'},SzI9:function(e,t){e.exports='#ifdef VR_DISTORTION\nuniform vec2 uDistortion;\nuniform vec4 uProjectionLeft;\nuniform vec4 uUnprojectionLeft;\n\n#pragma include "distortion.glsl"\n#endif\n\n#ifdef ASCII_FOOL\n#pragma include "ascii.glsl"\n#endif\n\nuniform sampler2D TextureInput;\nuniform vec2 uTextureInputSize;\n\n// G3D version of FXAA\n// green (y) as luma\n// Quality 12\nvec4 fxaa() {\n#ifdef VR_DISTORTION\n    gTexCoord = distortion(gTexCoord);\n#endif\n\n    vec2 fxaaQualityRcpFrame = 1.0 / uTextureInputSize;\n    float fxaaQualitySubpix = 0.75;\n    float fxaaQualityEdgeThreshold = 0.125;\n    float fxaaQualityEdgeThresholdMin = 0.0625;\n\n    vec2 posM = gTexCoord;\n    vec4 rgbyM = TEXTURE_2D_TextureInput(posM);\n    float lumaM = rgbyM.y;\n\n    // Swizzler Offseter Util\n    vec4 sw = vec4(-1.0, 1.0, 1.0, -1.0) * fxaaQualityRcpFrame.xxyy;\n\n    float lumaS = TEXTURE_2D_TextureInput(posM + vec2(0.0, sw.z)).y;\n    float lumaE = TEXTURE_2D_TextureInput(posM + vec2(sw.y, 0.0)).y;\n    float lumaN = TEXTURE_2D_TextureInput(posM + vec2(0.0, sw.w)).y;\n    float lumaW = TEXTURE_2D_TextureInput(posM + vec2(sw.x, 0.0)).y;\n\n    float maxSM = max(lumaS, lumaM);\n    float minSM = min(lumaS, lumaM);\n\n    float maxESM = max(lumaE, maxSM);\n    float minESM = min(lumaE, minSM);\n\n    float maxWN = max(lumaN, lumaW);\n    float minWN = min(lumaN, lumaW);\n\n    float rangeMax = max(maxWN, maxESM);\n    float rangeMin = min(minWN, minESM);\n\n    float rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    float range = rangeMax - rangeMin;\n    float rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n\n    bool earlyExit = range < rangeMaxClamped;\n\n    if (earlyExit) {\n#ifdef ASCII_FOOL\n    return ascii(posM);\n#else\n    return rgbyM;\n#endif\n    }\n\n    float lumaNW = TEXTURE_2D_TextureInput(posM + sw.xw).y;\n    float lumaSE = TEXTURE_2D_TextureInput(posM + sw.yz).y;\n    float lumaNE = TEXTURE_2D_TextureInput(posM + sw.yw).y;\n    float lumaSW = TEXTURE_2D_TextureInput(posM + sw.xy).y;\n\n    float lumaNS = lumaN + lumaS;\n    float lumaWE = lumaW + lumaE;\n    float subpixRcpRange = 1.0/range;\n    float subpixNSWE = lumaNS + lumaWE;\n    float edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    float edgeVert1 = (-2.0 * lumaM) + lumaWE;\n\n    float lumaNESE = lumaNE + lumaSE;\n    float lumaNWNE = lumaNW + lumaNE;\n    float edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    float edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n\n    float lumaNWSW = lumaNW + lumaSW;\n    float lumaSWSE = lumaSW + lumaSE;\n    float edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    float edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    float edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    float edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    float edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    float edgeVert = abs(edgeVert3) + edgeVert4;\n\n    float subpixNWSWNESE = lumaNWSW + lumaNESE;\n    float lengthSign = fxaaQualityRcpFrame.x;\n    bool horzSpan = edgeHorz >= edgeVert;\n    float subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    float subpixB = (subpixA * (1.0/12.0)) - lumaM;\n\n    float gradientN = lumaN - lumaM;\n    float gradientS = lumaS - lumaM;\n    float lumaNN = lumaN + lumaM;\n    float lumaSS = lumaS + lumaM;\n    bool pairN = abs(gradientN) >= abs(gradientS);\n    float gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    float subpixC = clamp(abs(subpixB) * subpixRcpRange, 0.0, 1.0);\n\n    vec2 posB = posM.xy;\n    vec2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n\n    vec2 posN;\n    posN.x = posB.x - offNP.x;\n    posN.y = posB.y - offNP.y;\n    vec2 posP;\n    posP.x = posB.x + offNP.x;\n    posP.y = posB.y + offNP.y;\n    float subpixD = ((-2.0)*subpixC) + 3.0;\n    float lumaEndN = TEXTURE_2D_TextureInput(posN).y;\n    float subpixE = subpixC * subpixC;\n    float lumaEndP = TEXTURE_2D_TextureInput(posP).y;\n\n    if(!pairN) lumaNN = lumaSS;\n    float gradientScaled = gradient * 1.0/4.0;\n    float lumaMM = lumaM - lumaNN * 0.5;\n    float subpixF = subpixD * subpixE;\n    bool lumaMLTZero = lumaMM < 0.0;\n\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    bool doneN = abs(lumaEndN) >= gradientScaled;\n    bool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * 1.5;\n    if(!doneN) posN.y -= offNP.y * 1.5;\n    bool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * 1.5;\n    if(!doneP) posP.y += offNP.y * 1.5;\n\n    if(doneNP) {\n        if(!doneN) lumaEndN = TEXTURE_2D_TextureInput(posN.xy).y;\n        if(!doneP) lumaEndP = TEXTURE_2D_TextureInput(posP.xy).y;\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * 2.0;\n        if(!doneN) posN.y -= offNP.y * 2.0;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * 2.0;\n        if(!doneP) posP.y += offNP.y * 2.0;\n\n        if(doneNP) {\n            if(!doneN) lumaEndN = TEXTURE_2D_TextureInput(posN.xy).y;\n            if(!doneP) lumaEndP = TEXTURE_2D_TextureInput(posP.xy).y;\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * 4.0;\n            if(!doneN) posN.y -= offNP.y * 4.0;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * 4.0;\n            if(!doneP) posP.y += offNP.y * 4.0;\n\n            if(doneNP) {\n                if(!doneN) lumaEndN = TEXTURE_2D_TextureInput(posN.xy).y;\n                if(!doneP) lumaEndP = TEXTURE_2D_TextureInput(posP.xy).y;\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * 12.0;\n                if(!doneN) posN.y -= offNP.y * 12.0;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * 12.0;\n                if(!doneP) posP.y += offNP.y * 12.0;\n\n            }\n\n        }\n\n    }\n\n    float dstN = posM.x - posN.x;\n    float dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n\n    bool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    float spanLength = (dstP + dstN);\n    bool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    float spanLengthRcp = 1.0/spanLength;\n\n    bool directionN = dstN < dstP;\n    float dst = min(dstN, dstP);\n    bool goodSpan = directionN ? goodSpanN : goodSpanP;\n    float subpixG = subpixF * subpixF;\n    float pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    float subpixH = subpixG * fxaaQualitySubpix;\n\n    float pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    float pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n\n \n#ifdef ASCII_FOOL\n    return ascii(posM);\n#else\n    return TEXTURE_2D_TextureInput(posM);\n#endif\n}\n'},T1IQ:function(e,t,n){"use strict";var i=n("QLQS"),r=n("6xPH"),a=n("fgaA"),o=n("yLV6"),s=n.n(o),u={initGestures:function(e){var t=e.getInputSource("TouchScreen");if(t){var n=t.getHammer();n.get("pan").set({enable:!1});var i=new s.a.Pinch({enable:!0,threshold:.1}),r=new s.a.Pan({event:"panh",direction:s.a.DIRECTION_HORIZONTAL}),a=new s.a.Pan({event:"panv",direction:s.a.DIRECTION_VERTICAL});a.requireFailure(r),r.requireFailure(i),n.add(r),n.add(a),n.add(i)}}},l=i.a.InputGroups;l.GLOBAL_ACTIONS=l.SCENE+".globalactions",l.GLOBAL_FOCUS="focuscanvas",l.SCENE_VIEWERAPI=l.SCENE+".viewerapi",l.SCENE_VIEWERAPI_1_4=l.SCENE+".viewerapi_1_4",l.FOCUS_INSPECTOR="focus.inspector",l.SCENE_INSPECTOR=l.SCENE+".inspector",l.UI_INSPECTOR=l.UI+".inspector",l.SCENE_INSPECTOR_ZOOM=l.SCENE_INSPECTOR+".zoom",l.UI_INSPECTOR_ZOOM=l.UI_INSPECTOR+".zoom",l.ENVIRONMENT=l.SCENE+".environment",l.DEBUG="debug",l.DEBUG_TRIPICK="debug.tripick",l.DEBUG_GEOMPICK="debug.geompick",l.AUTOSPIN=l.SCENE+".autospin",l.HOTSPOT=l.SCENE+".hotspot",l.HOTSPOT_VIEWER=l.HOTSPOT+".viewer",l.HOTSPOT_EDITOR=l.HOTSPOT+".editor",l.CAMERA=l.SCENE+".camera",l.CAMERA_GIZMO=l.CAMERA+".gizmo",l.SOUND=l.SCENE+".sound",l.SOUND_GIZMO=l.SOUND+".gizmo",l.WEBVR=l.SCENE+".webvr",l.WEBVREDITOR=l.SCENE+"webvreditor",l.WEBVR_NAVIGATION=l.WEBVR+".navigation",l.WEBVR_DISPLAY=l.WEBVR+".display",l.AR="ar",l.AR_DEBUG=l.AR+".debug";var c={init:function(e){this._manager=e},initGlobalClickEvents:function(e,t){var n=0,i=0,r=0;this._manager.group(l.GLOBAL_ACTIONS).addMappings({onDoubleClick:["doubletap","doubletap2fingers","dblclick"],onSingleClick:"singletap"},e),this._manager.group(l.GLOBAL_ACTIONS).addMappings({preventclick:"mousedown"},function(e){r=0,n=e.clientX,i=e.clientY}),this._manager.group(l.GLOBAL_ACTIONS).addMappings({preventmousemove:"mousemove"},function(e){var t=Math.abs(n-e.clientX)+Math.abs(i-e.clientY);r=Math.max(r,t)}),this._manager.group(l.GLOBAL_ACTIONS).addMappings({fallbacksingleclick:"mouseup"},function(t){r<2&&e.onSingleClick(t)}),this._manager.group("focuscanvas").addMappings({focus:"mousedown"},function(){t.focus({preventScroll:!0})}),this._manager.setPriority("focuscanvas",0)},initViewerAPI:function(e){this._manager.group(l.SCENE_VIEWERAPI).addMappings({onMouseMove:"mousemove",onCursorUp:["mouseup","singletap"]},e)},initViewerAPI_1_4:function(e){this._manager.group(l.SCENE_VIEWERAPI_1_4).addMappings({onMouseMove:"mousemove",onCursorUp:["mouseup","singletap"],onCursorDown:["mousedown"]},e)},initInspector:function(e){this._manager.group(l.FOCUS_INSPECTOR).addMappings({focusCheck:["mousedown","touchstart","wheel","mousemove","touchend","mouseup"],onCursorDown:["mousedown","touchstart"],onCursorUp:["touchend","touchcancel","mouseout","mouseup"]},e),this._manager.group(l.SCENE_INSPECTOR).addMappings({onMouseMove:"mousemove"},e),this._manager.group(l.SCENE_INSPECTOR_ZOOM).addMappings({onMouseWheel:"wheel"},e),this._manager.setPriority(l.FOCUS_INSPECTOR,this._manager.getHigherPriority(l.SCENE_INSPECTOR)),this._manager.setPriority(l.FOCUS_INSPECTOR+":onCursorUp",this._manager.getHigherPriority(l.FOCUS_INSPECTOR))},initInspectorCamera2D:function(e){this._manager.group(l.UI_INSPECTOR).addMappings({onEventStart:["pinchstart","panstart","mousedown"],onEventEnd:["pinchend","panend","mouseup","mouseout"],onEventUpdate:["pinch","pan","mousemove"]},e),this._manager.group(l.UI_INSPECTOR_ZOOM).addMappings({onMouseWheel:"wheel"},e),this._manager.setPriority(l.UI_INSPECTOR+":onEventEnd",this._manager.getHigherPriority(l.FOCUS_INSPECTOR))},setInspectorInputsEnable:function(e){this._manager.setEnable(l.SCENE_INSPECTOR,e),this._manager.setEnable(l.SCENE_INSPECTOR_ZOOM,e)},initEnvironment:function(e){this._manager.group(l.ENVIRONMENT).addMappings({startRotate:["mousedown alt","touchstart 3"],rotateLight:["mousemove alt ctrl !shift"],rotateEnv:["mousemove alt shift !ctrl"],rotateEnvAndLight:["mousemove alt !shift !ctrl","panmove 3"],endRotate:["mouseup","mouseout","touchend","touchcancel"]},e),this._manager.setPriority(l.ENVIRONMENT,this._manager.getHigherPriority(l.MANIPULATORS))},initDebug3D:function(e){this._manager.group(l.DEBUG_TRIPICK).addMappings({onTrianglePick:"dblclick"},e),this._manager.group(l.DEBUG_GEOMPICK).addMappings({onPickSelect:"dblclick"},e),this._manager.setPriority(l.DEBUG,1)},initAutospin:function(e,t){this._manager.group(l.AUTOSPIN).addMappings({pause:["mousedown","touchstart"],resume:["mouseup","mouseout","touchend","touchcancel"]},e),this._manager.setPriority(l.AUTOSPIN,this._manager.getHigherPriority(l.MANIPULATORS)),this._manager.setEnable(l.AUTOSPIN,t)},initHotspot:function(e){this._manager.group(l.HOTSPOT).addMappings({hoverHotspot:"mousemove"},e),Object(r.a)()?(this._manager.group(l.HOTSPOT_EDITOR).addMappings({createHotspot:"dblclick",startDrag:["mousedown","touchstart"],dragHotspot:["mousemove","touchmove"],stopDrag:["touchend","mouseup"],cancelDrag:["touchcancel","mouseout"]},e),this._manager.setPriority(l.HOTSPOT,this._manager.getHigherPriority(l.MANIPULATORS))):this._manager.group(l.HOTSPOT_VIEWER).addMappings({selectHotspot:["mousedown","singletap"]},e)},initCamera:function(e){this._manager.group(l.CAMERA_GIZMO).addMappings({motion:"mousemove",startDrag:"mousedown",endDrag:["mouseleave","mouseup"]},e),this._manager.setPriority(l.CAMERA_GIZMO,this._manager.getHigherPriority(l.MANIPULATORS))},initSound:function(e){this._manager.group(l.SOUND_GIZMO).addMappings({onDragMove:"mousemove",onDragStart:"mousedown",onDragEnd:["mouseleave","mouseup"],onDoubleClick:"dblclick"},e),this._manager.setEnable(l.SOUND_GIZMO,!1),this._manager.setPriority(l.SOUND_GIZMO,this._manager.getHigherPriority(l.MANIPULATORS))},initWebVR:function(e){this._manager.group(l.WEBVR).addMappings({scaleUp:"keydown o",scaleDown:"keydown p"},e),this._manager.group(l.WEBVR_DISPLAY).addMappings({onPoseChange:["vrdisplayposechanged"]},e),this._manager.setEnable(l.WEBVR,!1),Object(r.a)()&&this._manager.group(l.WEBVREDITOR).addMappings({savePosition:"mousemove"},e)},initWebVRNavigation:function(e){this._manager.group(l.WEBVR_NAVIGATION).addMappings({onPointerDown:"touchstart 1",onPointerUp:["touchend 1","mouseup 0","mouseup 1"],displayMenu:["mouseup 2","touchend 2"],onMouseDown:"mousedown"},e),this._manager.setEnable(l.WEBVR_NAVIGATION,!1)},initAR:function(e){Object(a.a)().arkitDebug&&(this._manager.group(l.AR_DEBUG).addMappings({startMotion:["mousedown 1","mousedown 2"],startRotate:"mousedown 1 !ctrl",startElevate:"mousedown ctrl 1",startScale:"mousedown 2",motion:"mousemove",endMotion:["mouseup","mouseout"]},e),this._manager.setPriority(l.AR_DEBUG,this._manager.getHigherPriority(l.MANIPULATORS))),u.initGestures(this._manager),this._manager.group(l.AR).addMappings({startScale:"pinchstart",endScale:"pinchend",scale:"pinch",endRotate:"panhend",endElevate:"panvend",rotate:"panh",elevate:"panv"},e)}};t.a=c},T5Q4:function(e,t){e.exports="attribute vec3 Vertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},TCxt:function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("12sq"),o=n("q1tI"),s=n("wsGC"),u=n("P1HB"),l=n("gPpI"),c=n("OD5+"),h=n("Ql/c");t.a=function(e){var t=e.user,n=e.target,i=e.withAvatar,d=void 0!==i&&i,f=e.noLink,p=void 0!==f&&f,g=e.noBadgeLink,m=void 0!==g&&g,v=e.withoutBadge,_=void 0!==v&&v,b=e.tag,S=void 0!==b&&b,y=e.withSummary,x=void 0===y||y,C=e.by,w=void 0!==C&&C,T=e.className;return r()("div",{className:Object(s.a)("user-name",T,{"--no-link":p,"--no-badge-link":m})},void 0,r()(h.a,{to:"users:profile_summary",params:{username:t.username},target:n,className:"user-name__link"},void 0,d&&o.createElement("span",x?{"data-action":"show-user-summary","data-user":t.uid}:{},r()(c.a,{user:t})),r()("div",{className:"text"},void 0,w?"by":"",r()("span",{"data-selenium":"username",className:"username-wrapper",itemProp:"name",title:t.displayName},void 0,t.displayName))),_?null:function(e){return e.hasOwnProperty("planDetail")&&Boolean(e.planDetail)}(t)&&t.planDetail.badge?r()("a",{className:"user-name__flag",href:"staff"===t.planDetail.badge?Object(l.e)("pages:careers")+"#team":"master"===t.planDetail.badge?a.a.hosts.discourse+"/g/Sketchfab-Masters?utm_source=website&utm_campaign=master-badge":Object(l.e)("pages:plans",{},{ref:"plan-badge"}),target:"_blank",rel:"noopener noreferrer"},void 0,r()("span",{className:"flag --".concat(t.planDetail.badge)},void 0,t.planDetail.title)):"basic"===t.account?null:r()("a",{className:"user-name__flag",href:Object(l.e)("pages:plans",{},{ref:"plan-badge"}),target:"_blank",rel:"noopener noreferrer"},void 0,r()("span",{className:"flag --".concat(t.account)},void 0,Object(u.k)(t.account))),S&&r()("span",{className:"user-name__tag"},void 0," (@",t.username,")"))}},TMnl:function(e,t,n){"use strict";var i=n("a3nb"),r=n("r7P/"),a=n("czSk"),o=n("EnLC"),s=n("b/No"),u=n("LTZp"),l=function(){r.a.call(this),this._intersector=void 0,this._projectionStack=new s.a,this._modelStack=new s.a,this._viewStack=new s.a,this._windowStack=new s.a,this._pooledMatrix=new o.a(a.c.create),this.reset()};i.a.createPrototypeObject(l,i.a.objectInherit(r.a.prototype,{reset:function(){this._pooledMatrix.reset(),this._viewStack.reset(),this._modelStack.reset(),this._projectionStack.reset(),this._windowStack.reset(),this._viewStack.push(a.c.IDENTITY),this._modelStack.push(a.c.IDENTITY),this._projectionStack.push(a.c.IDENTITY),this._windowStack.push(a.c.IDENTITY)},setIntersector:function(e){this._intersector=e},getIntersector:function(){return this._intersector},pushModelMatrix:function(e){this._modelStack.push(e)},getModelMatrix:function(){return this._modelStack.back()},popModelMatrix:function(){return this._modelStack.pop()},pushViewMatrix:function(e){this._viewStack.push(e)},getViewMatrix:function(){return this._viewStack.back()},popViewMatrix:function(){return this._viewStack.pop()},pushProjectionMatrix:function(e){this._projectionStack.push(e)},getProjectionMatrix:function(){return this._projectionStack.back()},popProjectionMatrix:function(){return this._projectionStack.pop()},pushWindowMatrix:function(e){this._windowStack.push(e)},pushWindowMatrixUsingViewport:function(e){this._windowStack.push(e.computeWindowMatrix(this._pooledMatrix.getOrCreateObject()))},getWindowMatrix:function(){return this._windowStack.back()},popWindowMatrix:function(){return this._windowStack.pop()},getTransformation:function(){var e=a.c.create64();return function(){return a.c.copy(e,this.getWindowMatrix()),a.c.mul(e,e,this.getProjectionMatrix()),a.c.mul(e,e,this.getViewMatrix()),a.c.mul(e,e,this.getModelMatrix()),e}}(),enter:function(e){return this._intersector.enter(e)},apply:function(e){e.getViewMatrix?this.applyCamera(e):e.getMatrix?this.applyTransform(e):this.applyNode(e)},applyCamera:function(e){var t,n,i,r=e.getViewport();void 0!==r&&this.pushWindowMatrixUsingViewport(r),e.getReferenceFrame()===u.a.RELATIVE_RF&&this.getViewMatrix()&&this.getProjectionMatrix()?(t=a.c.mul(this._pooledMatrix.getOrCreateObject(),this.getProjectionMatrix(),e.getProjectionMatrix()),n=this.getViewMatrix(),i=a.c.mul(this._pooledMatrix.getOrCreateObject(),this.getModelMatrix(),e.getViewMatrix())):(t=e.getProjectionMatrix(),n=e.getViewMatrix(),i=a.c.identity(this._pooledMatrix.getOrCreateObject())),this.pushProjectionMatrix(t),this.pushViewMatrix(n),this.pushModelMatrix(i),this._intersector.setCurrentTransformation(this.getTransformation()),this.traverse(e),this.popModelMatrix(),this.popViewMatrix(),this.popProjectionMatrix(),void 0!==r&&this.popWindowMatrix(),this._intersector.setCurrentTransformation(this.getTransformation())},applyNode:function(e){this.enter(e)&&(e.getPrimitiveSetList?this._intersector.intersect(this,e):e.traverse&&this.traverse(e))},applyTransform:function(e){if(this.enter(e)){if(e.getReferenceFrame()===u.a.ABSOLUTE_RF){var t=this._pooledMatrix.getOrCreateObject();this.pushViewMatrix(a.c.identity(t)),this.pushModelMatrix(e.getMatrix())}else if(this._modelStack.getLength()>0){var n=a.c.copy(this._pooledMatrix.getOrCreateObject(),this.getModelMatrix());a.c.mul(n,n,e.getMatrix()),this.pushModelMatrix(n)}else this.pushModelMatrix(e.getMatrix());this._intersector.setCurrentTransformation(this.getTransformation()),this.traverse(e),this.popModelMatrix(),e.getReferenceFrame()===u.a.ABSOLUTE_RF&&this.popViewMatrix(),this._intersector.setCurrentTransformation(this.getTransformation())}}}),"osgUtil","IntersectionVisitor"),t.a=l},TObL:function(e,t){e.exports='#pragma include "utils/decodeDepth.glsl"\n#pragma include "utils/rand.glsl"\n\n#define SSR_STEPS 8\n\n#define LOD_COLOR 7.0\n#define LOD_DEPTH 5.0\n\nuniform int uDrawOpaque;\nuniform float uFrameModTaaSS;\nuniform float uQuality;\nuniform float uSsrFactor;\n\nuniform sampler2D uTextureToBeRefracted;\nuniform sampler2D uTextureMipmapDepth;\n\nuniform vec2 uTextureToBeRefractedSize;\nuniform vec2 uPreviousGlobalTexRatio;\nuniform vec2 uPreviousGlobalTexSize;\nuniform vec2 uNearFar;\nuniform vec2 uGlobalTexRatio;\nuniform vec4 uTaaCornersCSLeft[2];\n\nuniform mat4 uProjectionMatrix;\nuniform mat4 uReprojectViewProj;\nuniform mat4 uPreviousViewInvView;\nuniform mat4 uPreviousProjection; // DEPTH_MIPMAP\n\nvec3 computeLodNearestPixelSizePowLevel(const in float lodLevelIn, const in float maxLod, const in vec2 size) {\n    float lodLevel = min(maxLod - 0.01, lodLevelIn);\n    float lowerLevel = floor(lodLevel);\n    float higherLevel = min(maxLod, lowerLevel + 1.0);\n\n    float powLevel = pow(2.0, higherLevel);\n    vec2 pixelSize = 2.0 * powLevel / size;\n\n    if (lodLevel - lowerLevel > 0.5) powLevel *= 2.0;\n    return vec3(pixelSize, powLevel);\n}\n\n// lerping between 2 mipmap is too costly (with no notable quality gain in the end)\nvec2 computeLodUVNearest(const in vec2 uvIn, const in vec3 pixelSizePowLevel) {\n    // border pixel issue with bilinear...\n    vec2 uv = max(pixelSizePowLevel.xy, min(1.0 - pixelSizePowLevel.xy, uvIn));\n    return vec2(2.0 * uv.x, pixelSizePowLevel.z - 1.0 - uv.y) / pixelSizePowLevel.z;\n}\n\nfloat fetchDepthLod(const in vec2 uv, const in vec3 pixelSizePowLevel) {\n#ifdef DEPTH_MIPMAP\n    vec2 uvNearest = computeLodUVNearest(uv, pixelSizePowLevel);\n    float depth =  decodeDepth(texture2D(uTextureMipmapDepth, uvNearest * uPreviousGlobalTexRatio));\n#else\n    float depth = decodeDepth(texture2D(uTextureMipmapDepth, uv * uGlobalTexRatio));\n#endif\n\n    if (depth >= 1.0) return -uNearFar.y * 100.0; // very far so it won\'t reflect background\n    return -uNearFar.x - depth * (uNearFar.y - uNearFar.x);\n}\n\nvec4 fetchDepthLod(const in vec4 uv0, const in vec4 uv1, const in vec3 pixelSizePowLevel) {\n    vec4 result = vec4(0.0);\n    result.x = fetchDepthLod(uv0.xy, pixelSizePowLevel);\n    result.y = fetchDepthLod(uv0.zw, pixelSizePowLevel);\n    result.z = fetchDepthLod(uv1.xy, pixelSizePowLevel);\n    result.w = fetchDepthLod(uv1.zw, pixelSizePowLevel);\n    return result;\n}\n\nvec3 ssrViewToScreen(const in mat4 projection, const in vec3 viewVertex) {\n    vec4 projected = projection * vec4(viewVertex, 1.0);\n    return vec3(0.5 + 0.5 * projected.xy / projected.w, projected.w);\n}\n\nvec3 fetchColorLod(const in float level, const in vec2 uv) {\n    vec3 pixelSizePowLevel = computeLodNearestPixelSizePowLevel(LOD_COLOR * level, LOD_COLOR, uPreviousGlobalTexSize); \n    vec2 uvNearest = computeLodUVNearest(uv, pixelSizePowLevel);\n    return decodeRGBM(texture2D(uTextureToBeRefracted, uvNearest * uPreviousGlobalTexRatio), 7.0);\n}\n\n// #define HASHSCALE1 .1031\n// #define HASHSCALE3 vec3(.1031, .1030, .0973)\n// #define HASHSCALE4 vec4(.1031, .1030, .0973, .1099)\n\n// vec2 hash23(vec3 p3)\n// {\n//     p3 = fract(p3 * HASHSCALE3);\n//     p3 += dot(p3, p3.yzx + 19.19);\n//     return fract((p3.xx + p3.yz) * p3.zy);\n// }\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/ScreenSpaceReflections.usf#L143\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/MonteCarlo.ush#L169\nvec3 unrealImportanceSampling(const in float frameMod, const in vec3 tangentX, const in vec3 tangentY, const in vec3 tangentZ, const in vec3 eyeVector, const in float rough4) {\n    vec2 E;\n\n    // could be improved (visible patterns)\n    E.x = interleavedGradientNoise(gl_FragCoord.yx, frameMod);\n    E.y = fract(E.x * 52.9829189);\n    // E = hash23(vec3(gl_FragCoord.xy + frameMod * 150.2420, frameMod * 100.0));\n\n    // Reduces BRDF tail is noisy, we clamp it\n    // https://www.slideshare.net/DICEStudio/stochastic-screenspace-reflections#p=67\n    E.y = mix(E.y, 1.0, 0.7);\n\n    float phi = 2.0 * 3.14159 * E.x;\n    // float cosTheta = sqrt((1.0 - E.y) / (1.0 + (rough4 - 1.0) * E.y)); // ggx (long tail, more noisy)\n    float cosTheta = pow(max(E.y, 0.000001), rough4 / (2.0 - rough4)); // blinn\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\n    vec3 h = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\n    h = h.x * tangentX + h.y * tangentY + h.z * tangentZ;\n    return normalize((2.0 * dot(eyeVector, h)) * h - eyeVector);\n}\n\nfloat getStepOffset(const in float frameMod) {\n    return (interleavedGradientNoise(gl_FragCoord.xy, frameMod) - 0.5);\n}\n\nvec3 computeRayDirUV(const in vec3 rayOriginUV, const in float rayLen, const in vec3 rayDirView) {\n#ifdef DEPTH_MIPMAP\n    vec3 rayDirUV = ssrViewToScreen(uPreviousProjection, vViewVertex.xyz + rayDirView * rayLen);\n#else\n    vec3 rayDirUV = ssrViewToScreen(uProjectionMatrix, vViewVertex.xyz + rayDirView * rayLen);\n#endif\n\n    rayDirUV.z = 1.0 / rayDirUV.z;\n    rayDirUV -= rayOriginUV;\n\n    // clip the line to the viewport edges\n    // https://github.com/godotengine/godot/blob/master/drivers/gles3/shaders/screen_space_reflection.glsl#L124\n    float scaleMaxX = min(1.0, 0.99 * (1.0 - rayOriginUV.x) / max(1e-5, rayDirUV.x));\n    float scaleMaxY = min(1.0, 0.99 * (1.0 - rayOriginUV.y) / max(1e-5, rayDirUV.y));\n    float scaleMinX = min(1.0, 0.99 * rayOriginUV.x / max(1e-5, -rayDirUV.x));\n    float scaleMinY = min(1.0, 0.99 * rayOriginUV.y / max(1e-5, -rayDirUV.y));\n    return rayDirUV * min(scaleMaxX, scaleMaxY) * min(scaleMinX, scaleMinY);\n}\n\n#define SSR_RAY_FETCH(void) \\\nsampleUV = rayOriginUV + rayDirUV * diffSampleW.y; \\\ndepth = fetchDepthLod(sampleUV.xy, pixelSizePowLevel); \\\ndepthDiff = -1.0 / sampleUV.z - depth; \\\nhit = abs(depthDiff + depthTolerance) < depthTolerance; \\\ntimeLerp = clamp(diffSampleW.x / (diffSampleW.x - depthDiff), 0.0, 1.0); \\\nhitTime = hit ? (diffSampleW.y + timeLerp * invNumSteps - invNumSteps) : 1.0; \\\ndiffSampleW.z = min(diffSampleW.z, hitTime); \\\ndiffSampleW.x = depthDiff; \\\ndiffSampleW.y += invNumSteps; \\\n\n#define SSR_RAY_UNROLLED(void) \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\nSSR_RAY_FETCH() \\\n\nvec4 rayTraceUnrealSimple(\n    const in vec3 rayOriginUV,\n    const in float rayLen,\n    in float depthTolerance,\n    const in vec3 rayDirView,\n\n    const in float roughness,\n    const in float frameMod) {\n\n    vec3 pixelSizePowLevel = computeLodNearestPixelSizePowLevel(LOD_DEPTH * roughness, LOD_DEPTH, uTextureToBeRefractedSize); \n\n    float invNumSteps = 1.0 / float(SSR_STEPS);\n    if (uQuality > 1.0) invNumSteps /= 2.0;\n\n    depthTolerance *= invNumSteps;\n\n    vec3 rayDirUV = computeRayDirUV(rayOriginUV, rayLen, rayDirView);\n\n    float sampleTime = getStepOffset(frameMod) * invNumSteps + invNumSteps;\n    vec3 diffSampleW = vec3(0.0, sampleTime, 1.0);\n\n    vec3 sampleUV;\n    float depth, depthDiff, timeLerp, hitTime;\n    bool hit;\n\n    SSR_RAY_UNROLLED()\n    if (uQuality > 1.0) { SSR_RAY_UNROLLED() }\n\n    // alternative : ray refinement around the intersected cell\n    // if (uQuality > 1.0) {\n    //     rayOriginUV = rayOriginUV + rayDirUV * diffSampleW.z - rayDirUV * invNumSteps * 0.5;\n    //     diffSampleW = vec3(0.0, sampleTime, 1.0);\n    //     rayDirUV *= invNumSteps;\n    //     depthTolerance *= invNumSteps;\n    //     SSR_RAY_UNROLLED()\n    // }\n\n    return vec4(rayOriginUV + rayDirUV * diffSampleW.z, 1.0 - diffSampleW.z);\n}\n\nvec4 fetchColorContribution(\n    in vec4 resRay,\n    const in float maskSsr,\n    const in vec3 specularEnvironment,\n    const in vec3 specularColor,\n    const in float roughness) {\n\n    // reprojection\n    vec4 AB = mix(uTaaCornersCSLeft[0], uTaaCornersCSLeft[1], resRay.x);\n    resRay.xyz = vec3(mix(AB.xy, AB.zw, resRay.y), 1.0) * -1.0 / resRay.z;\n    resRay.xyz = (uReprojectViewProj * vec4(resRay.xyz, 1.0)).xyw;\n    resRay.xy /= resRay.z;\n\n    // fade edge of screen\n    float maskEdge = clamp(6.0 - 6.0 * max(abs(resRay.x), abs(resRay.y)), 0.0, 1.0);\n\n    resRay.xy = 0.5 + 0.5 * resRay.xy;\n\n    vec3 fetchColor = specularColor * fetchColorLod(roughness * (1.0 - resRay.w), resRay.xy);\n\n    // fade ray count\n    // maskEdge *= resRay.w;\n\n    return vec4(mix(specularEnvironment, fetchColor, maskSsr * maskEdge), 1.0);\n}\n\nvec3 ssr(const in vec3 specularEnvironment, const in vec3 specularColor, const in float roughness, const in vec3 normal, const in vec3 eyeVector) {\n\n#if (defined(HAS_OPACITY_BLEND_OR_ADDITIVE) || defined(HAS_OPACITY_REFRACTION)) && !defined(HAS_SSR_TRANSPARENT)\n    // no ssr for transparent pxiels for now (mainly performance reason)\n    if (uDrawOpaque == 0) return specularEnvironment;\n#endif\n\n    vec4 result = vec4(0.0);\n\n    // precompute importance sampling roughness^4\n    float rough4 = roughness * roughness;\n    rough4 = rough4 * rough4;\n\n    // precompute importance sampling basis tangent\n    vec3 upVector = abs(normal.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, normal));\n    vec3 tangentY = cross(normal, tangentX);\n\n    // fade ray that points toward camera\n    float maskSsr = uSsrFactor * clamp(-4.0 * dot(eyeVector, normal) + 3.8, 0.0, 1.0);\n    maskSsr *= clamp(4.7 - roughness * 5.0, 0.0, 1.0); // fade out ssr for high roughness values\n\n    // compute ray uv origin\n    vec3 rayOriginUV = ssrViewToScreen(uProjectionMatrix, vViewVertex.xyz);\n    rayOriginUV.z = 1.0 / rayOriginUV.z;\n\n    // direction of reflection\n    vec3 rayDirView = unrealImportanceSampling(uFrameModTaaSS, tangentX, tangentY, normal, eyeVector, rough4);\n\n    // if reflection is toward us, we cast [near, vertex], otherwise [vertex, far]\n    float rayLen = mix(uNearFar.y + vViewVertex.z, -vViewVertex.z - uNearFar.x, rayDirView.z * 0.5 + 0.5);\n    float depthTolerance = 0.5 * rayLen;\n\n    // ray under the surface (normalmap or inverted normal)\n    if (dot(rayDirView, normal) > 0.001 && maskSsr > 0.0) {\n        vec4 resRay = rayTraceUnrealSimple(rayOriginUV, rayLen, depthTolerance, rayDirView, roughness, uFrameModTaaSS);\n        if (resRay.w > 0.0) result += fetchColorContribution(resRay, maskSsr, specularEnvironment, specularColor, roughness);\n    }\n\n    // if (uQuality > 0.4) {\n    //     for (int i = 1; i < 4; ++i) {\n    //         float frameRay = frameMod + float(i) * 50.0;\n    //         rayDirView = unrealImportanceSampling(frameRay, tangentX, tangentY, normal, eyeVector, rough4);\n    //         rayLen = mix(uNearFar.y + vViewVertex.z, -vViewVertex.z - uNearFar.x, rayDirView.z * 0.5 + 0.5);\n    //         depthTolerance = 0.5 * rayLen;\n\n    //         if (dot(rayDirView, normal) > 0.001) {\n    //             vec4 resRay = rayTraceUnrealSimple(rayOriginUV, rayLen, depthTolerance, rayDirView, roughness, frameRay);\n    //             if (resRay.w > 0.0) result += fetchColorContribution(resRay, maskSsr, specularEnvironment, specularColor, roughness);\n    //         }\n    //     }\n    // }\n\n    return result.w > 0.0 ? result.rgb / result.w : specularEnvironment;\n}\n'},TYgF:function(e,t,n){"use strict";var i=n("YfG3"),r=n("Ui7z"),a=n("f5KD");n.d(t,"a",function(){return a.b}),t.b={name:"WithOptionTypes",optionTypes:{},initialize:function(){},setOptions:function(e){var t=Object(i.a)({},this.options,Object(r.b)(e));this.isMounted&&this.viewWillReceiveOptions(t),this.update(t,this.state,!1)},viewWillReceiveOptions:function(){},checkOptionTypes:function(){Object(a.a)(this.optionTypes,this.options,"option",this.displayName||"View")}}},ThTW:function(e,t,n){
/** @license URI.js v4.2.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length>1){t[0]=t[0].slice(0,-1);for(var i=t.length-1,r=1;r<i;++r)t[r]=t[r].slice(1,-1);return t[i]=t[i].slice(1),t.join("")}return t[0]}function n(e){return"(?:"+e+")"}function i(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function r(e){return e.toUpperCase()}function a(e){var i=t("[0-9]","[A-Fa-f]"),r=n(n("%[EFef]"+i+"%"+i+i+"%"+i+i)+"|"+n("%[89A-Fa-f]"+i+"%"+i+i)+"|"+n("%"+i+i)),a="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",o=t("[\\:\\/\\?\\#\\[\\]\\@]",a),s=e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",u=e?"[\\uE000-\\uF8FF]":"[]",l=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",s),c=n("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),h=n(n(r+"|"+t(l,a,"[\\:]"))+"*"),d=(n(n("25[0-5]")+"|"+n("2[0-4][0-9]")+"|"+n("1[0-9][0-9]")+"|"+n("[1-9][0-9]")+"|[0-9]"),n(n("25[0-5]")+"|"+n("2[0-4][0-9]")+"|"+n("1[0-9][0-9]")+"|"+n("0?[1-9][0-9]")+"|0?0?[0-9]")),f=n(d+"\\."+d+"\\."+d+"\\."+d),p=n(i+"{1,4}"),g=n(n(p+"\\:"+p)+"|"+f),m=n(n(p+"\\:")+"{6}"+g),v=n("\\:\\:"+n(p+"\\:")+"{5}"+g),_=n(n(p)+"?\\:\\:"+n(p+"\\:")+"{4}"+g),b=n(n(n(p+"\\:")+"{0,1}"+p)+"?\\:\\:"+n(p+"\\:")+"{3}"+g),S=n(n(n(p+"\\:")+"{0,2}"+p)+"?\\:\\:"+n(p+"\\:")+"{2}"+g),y=n(n(n(p+"\\:")+"{0,3}"+p)+"?\\:\\:"+p+"\\:"+g),x=n(n(n(p+"\\:")+"{0,4}"+p)+"?\\:\\:"+g),C=n(n(n(p+"\\:")+"{0,5}"+p)+"?\\:\\:"+p),w=n(n(n(p+"\\:")+"{0,6}"+p)+"?\\:\\:"),T=n([m,v,_,b,S,y,x,C,w].join("|")),M=n(n(l+"|"+r)+"+"),E=(n(T+"\\%25"+M),n(T+n("\\%25|\\%(?!"+i+"{2})")+M)),A=n("[vV]"+i+"+\\."+t(l,a,"[\\:]")+"+"),O=n("\\["+n(E+"|"+T+"|"+A)+"\\]"),R=n(n(r+"|"+t(l,a))+"*"),P=n(O+"|"+f+"(?!"+R+")|"+R),I=n("[0-9]*"),N=n(n(h+"@")+"?"+P+n("\\:"+I)+"?"),L=n(r+"|"+t(l,a,"[\\:\\@]")),k=n(L+"*"),D=n(L+"+"),F=n(n(r+"|"+t(l,a,"[\\@]"))+"+"),V=n(n("\\/"+k)+"*"),B=n("\\/"+n(D+V)+"?"),U=n(F+V),j=n(D+V),G="(?!"+L+")",H=(n(V+"|"+B+"|"+U+"|"+j+"|"+G),n(n(L+"|"+t("[\\/\\?]",u))+"*")),z=n(n(L+"|[\\/\\?]")+"*"),W=n(n("\\/\\/"+N+V)+"|"+B+"|"+j+"|"+G),q=n(c+"\\:"+W+n("\\?"+H)+"?"+n("\\#"+z)+"?"),X=n(n("\\/\\/"+N+V)+"|"+B+"|"+U+"|"+G),Y=n(X+n("\\?"+H)+"?"+n("\\#"+z)+"?");return n(q+"|"+Y),n(c+"\\:"+W+n("\\?"+H)+"?"),n(n("\\/\\/("+n("("+h+")@")+"?("+P+")"+n("\\:("+I+")")+"?)")+"?("+V+"|"+B+"|"+j+"|"+G+")"),n("\\?("+H+")"),n("\\#("+z+")"),n(n("\\/\\/("+n("("+h+")@")+"?("+P+")"+n("\\:("+I+")")+"?)")+"?("+V+"|"+B+"|"+U+"|"+G+")"),n("\\?("+H+")"),n("\\#("+z+")"),n(n("\\/\\/("+n("("+h+")@")+"?("+P+")"+n("\\:("+I+")")+"?)")+"?("+V+"|"+B+"|"+j+"|"+G+")"),n("\\?("+H+")"),n("\\#("+z+")"),n("("+h+")@"),n("\\:("+I+")"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",l,a),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",l,a),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",l,a),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",l,a),"g"),NOT_QUERY:new RegExp(t("[^\\%]",l,a,"[\\:\\@\\/\\?]",u),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",l,a,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",l,a),"g"),UNRESERVED:new RegExp(l,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",l,o),"g"),PCT_ENCODED:new RegExp(r,"g"),IPV4ADDRESS:new RegExp("^("+f+")$"),IPV6ADDRESS:new RegExp("^\\[?("+T+")"+n(n("\\%25|\\%(?!"+i+"{2})")+"("+M+")")+"?\\]?$")}}var o=a(!1),s=a(!0),u=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=2147483647,c=/^xn--/,h=/[^\0-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,g=String.fromCharCode;function m(e){throw new RangeError(f[e])}function v(e,t){var n=e.split("@"),i="";n.length>1&&(i=n[0]+"@",e=n[1]);var r=(e=e.replace(d,".")).split("."),a=function(e,t){for(var n=[],i=e.length;i--;)n[i]=t(e[i]);return n}(r,t).join(".");return i+a}function _(e){for(var t=[],n=0,i=e.length;n<i;){var r=e.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){var a=e.charCodeAt(n++);56320==(64512&a)?t.push(((1023&r)<<10)+(1023&a)+65536):(t.push(r),n--)}else t.push(r)}return t}var b=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:36},S=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},y=function(e,t,n){var i=0;for(e=n?p(e/700):e>>1,e+=p(e/t);e>455;i+=36)e=p(e/35);return p(i+36*e/(e+38))},x=function(e){var t=[],n=e.length,i=0,r=128,a=72,o=e.lastIndexOf("-");o<0&&(o=0);for(var s=0;s<o;++s)e.charCodeAt(s)>=128&&m("not-basic"),t.push(e.charCodeAt(s));for(var u=o>0?o+1:0;u<n;){for(var c=i,h=1,d=36;;d+=36){u>=n&&m("invalid-input");var f=b(e.charCodeAt(u++));(f>=36||f>p((l-i)/h))&&m("overflow"),i+=f*h;var g=d<=a?1:d>=a+26?26:d-a;if(f<g)break;var v=36-g;h>p(l/v)&&m("overflow"),h*=v}var _=t.length+1;a=y(i-c,_,0==c),p(i/_)>l-r&&m("overflow"),r+=p(i/_),i%=_,t.splice(i++,0,r)}return String.fromCodePoint.apply(String,t)},C=function(e){var t=[],n=(e=_(e)).length,i=128,r=0,a=72,o=!0,s=!1,u=void 0;try{for(var c,h=e[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){var d=c.value;d<128&&t.push(g(d))}}catch(e){s=!0,u=e}finally{try{!o&&h.return&&h.return()}finally{if(s)throw u}}var f=t.length,v=f;for(f&&t.push("-");v<n;){var b=l,x=!0,C=!1,w=void 0;try{for(var T,M=e[Symbol.iterator]();!(x=(T=M.next()).done);x=!0){var E=T.value;E>=i&&E<b&&(b=E)}}catch(e){C=!0,w=e}finally{try{!x&&M.return&&M.return()}finally{if(C)throw w}}var A=v+1;b-i>p((l-r)/A)&&m("overflow"),r+=(b-i)*A,i=b;var O=!0,R=!1,P=void 0;try{for(var I,N=e[Symbol.iterator]();!(O=(I=N.next()).done);O=!0){var L=I.value;if(L<i&&++r>l&&m("overflow"),L==i){for(var k=r,D=36;;D+=36){var F=D<=a?1:D>=a+26?26:D-a;if(k<F)break;var V=k-F,B=36-F;t.push(g(S(F+V%B,0))),k=p(V/B)}t.push(g(S(k,0))),a=y(r,A,v==f),r=0,++v}}}catch(e){R=!0,P=e}finally{try{!O&&N.return&&N.return()}finally{if(R)throw P}}++r,++i}return t.join("")},w={version:"2.1.0",ucs2:{decode:_,encode:function(e){return String.fromCodePoint.apply(String,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e))}},decode:x,encode:C,toASCII:function(e){return v(e,function(e){return h.test(e)?"xn--"+C(e):e})},toUnicode:function(e){return v(e,function(e){return c.test(e)?x(e.slice(4).toLowerCase()):e})}},T={};function M(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function E(e){for(var t="",n=0,i=e.length;n<i;){var r=parseInt(e.substr(n+1,2),16);if(r<128)t+=String.fromCharCode(r),n+=3;else if(r>=194&&r<224){if(i-n>=6){var a=parseInt(e.substr(n+4,2),16);t+=String.fromCharCode((31&r)<<6|63&a)}else t+=e.substr(n,6);n+=6}else if(r>=224){if(i-n>=9){var o=parseInt(e.substr(n+4,2),16),s=parseInt(e.substr(n+7,2),16);t+=String.fromCharCode((15&r)<<12|(63&o)<<6|63&s)}else t+=e.substr(n,9);n+=9}else t+=e.substr(n,3),n+=3}return t}function A(e,t){function n(e){var n=E(e);return n.match(t.UNRESERVED)?n:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,n).replace(t.NOT_USERINFO,M).replace(t.PCT_ENCODED,r)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_HOST,M).replace(t.PCT_ENCODED,r)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,n).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,M).replace(t.PCT_ENCODED,r)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,n).replace(t.NOT_QUERY,M).replace(t.PCT_ENCODED,r)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,n).replace(t.NOT_FRAGMENT,M).replace(t.PCT_ENCODED,r)),e}function O(e){return e.replace(/^0*(.*)/,"$1")||"0"}function R(e,t){var n=e.match(t.IPV4ADDRESS)||[],i=u(n,2),r=i[1];return r?r.split(".").map(O).join("."):e}function P(e,t){var n=e.match(t.IPV6ADDRESS)||[],i=u(n,3),r=i[1],a=i[2];if(r){for(var o=r.toLowerCase().split("::").reverse(),s=u(o,2),l=s[0],c=s[1],h=c?c.split(":").map(O):[],d=l.split(":").map(O),f=t.IPV4ADDRESS.test(d[d.length-1]),p=f?7:8,g=d.length-p,m=Array(p),v=0;v<p;++v)m[v]=h[v]||d[g+v]||"";f&&(m[p-1]=R(m[p-1],t));var _=m.reduce(function(e,t,n){if(!t||"0"===t){var i=e[e.length-1];i&&i.index+i.length===n?i.length++:e.push({index:n,length:1})}return e},[]),b=_.sort(function(e,t){return t.length-e.length})[0],S=void 0;if(b&&b.length>1){var y=m.slice(0,b.index),x=m.slice(b.index+b.length);S=y.join(":")+"::"+x.join(":")}else S=m.join(":");return a&&(S+="%"+a),S}return e}var I=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,N=void 0==="".match(/(){0}/)[1];function L(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},i=!1!==t.iri?s:o;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var r=e.match(I);if(r){N?(n.scheme=r[1],n.userinfo=r[3],n.host=r[4],n.port=parseInt(r[5],10),n.path=r[6]||"",n.query=r[7],n.fragment=r[8],isNaN(n.port)&&(n.port=r[5])):(n.scheme=r[1]||void 0,n.userinfo=-1!==e.indexOf("@")?r[3]:void 0,n.host=-1!==e.indexOf("//")?r[4]:void 0,n.port=parseInt(r[5],10),n.path=r[6]||"",n.query=-1!==e.indexOf("?")?r[7]:void 0,n.fragment=-1!==e.indexOf("#")?r[8]:void 0,isNaN(n.port)&&(n.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?r[4]:void 0)),n.host&&(n.host=P(R(n.host,i),i)),void 0!==n.scheme||void 0!==n.userinfo||void 0!==n.host||void 0!==n.port||n.path||void 0!==n.query?void 0===n.scheme?n.reference="relative":void 0===n.fragment?n.reference="absolute":n.reference="uri":n.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==n.reference&&(n.error=n.error||"URI is not a "+t.reference+" reference.");var a=T[(t.scheme||n.scheme||"").toLowerCase()];if(t.unicodeSupport||a&&a.unicodeSupport)A(n,i);else{if(n.host&&(t.domainHost||a&&a.domainHost))try{n.host=w.toASCII(n.host.replace(i.PCT_ENCODED,E).toLowerCase())}catch(e){n.error=n.error||"Host's domain name can not be converted to ASCII via punycode: "+e}A(n,o)}a&&a.parse&&a.parse(n,t)}else n.error=n.error||"URI can not be parsed.";return n}var k=/^\.\.?\//,D=/^\/\.(\/|$)/,F=/^\/\.\.(\/|$)/,V=/^\/?(?:.|\n)*?(?=\/|$)/;function B(e){for(var t=[];e.length;)if(e.match(k))e=e.replace(k,"");else if(e.match(D))e=e.replace(D,"/");else if(e.match(F))e=e.replace(F,"/"),t.pop();else if("."===e||".."===e)e="";else{var n=e.match(V);if(!n)throw new Error("Unexpected dot segment condition");var i=n[0];e=e.slice(i.length),t.push(i)}return t.join("")}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.iri?s:o,i=[],r=T[(t.scheme||e.scheme||"").toLowerCase()];if(r&&r.serialize&&r.serialize(e,t),e.host)if(n.IPV6ADDRESS.test(e.host));else if(t.domainHost||r&&r.domainHost)try{e.host=t.iri?w.toUnicode(e.host):w.toASCII(e.host.replace(n.PCT_ENCODED,E).toLowerCase())}catch(n){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+n}A(e,n),"suffix"!==t.reference&&e.scheme&&(i.push(e.scheme),i.push(":"));var a=function(e,t){var n=!1!==t.iri?s:o,i=[];return void 0!==e.userinfo&&(i.push(e.userinfo),i.push("@")),void 0!==e.host&&i.push(P(R(String(e.host),n),n).replace(n.IPV6ADDRESS,function(e,t,n){return"["+t+(n?"%25"+n:"")+"]"})),"number"==typeof e.port&&(i.push(":"),i.push(e.port.toString(10))),i.length?i.join(""):void 0}(e,t);if(void 0!==a&&("suffix"!==t.reference&&i.push("//"),i.push(a),e.path&&"/"!==e.path.charAt(0)&&i.push("/")),void 0!==e.path){var u=e.path;t.absolutePath||r&&r.absolutePath||(u=B(u)),void 0===a&&(u=u.replace(/^\/\//,"/%2F")),i.push(u)}return void 0!==e.query&&(i.push("?"),i.push(e.query)),void 0!==e.fragment&&(i.push("#"),i.push(e.fragment)),i.join("")}function j(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3],r={};return i||(e=L(U(e,n),n),t=L(U(t,n),n)),!(n=n||{}).tolerant&&t.scheme?(r.scheme=t.scheme,r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=B(t.path||""),r.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=B(t.path||""),r.query=t.query):(t.path?("/"===t.path.charAt(0)?r.path=B(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?r.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:r.path=t.path:r.path="/"+t.path,r.path=B(r.path)),r.query=t.query):(r.path=e.path,void 0!==t.query?r.query=t.query:r.query=e.query),r.userinfo=e.userinfo,r.host=e.host,r.port=e.port),r.scheme=e.scheme),r.fragment=t.fragment,r}function G(e,t){return e&&e.toString().replace(t&&t.iri?s.PCT_ENCODED:o.PCT_ENCODED,E)}var H={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){return e.port!==("https"!==String(e.scheme).toLowerCase()?80:443)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},z={scheme:"https",domainHost:H.domainHost,parse:H.parse,serialize:H.serialize},W={},q="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",X="[0-9A-Fa-f]",Y=n(n("%[EFef][0-9A-Fa-f]%"+X+X+"%"+X+X)+"|"+n("%[89A-Fa-f][0-9A-Fa-f]%"+X+X)+"|"+n("%"+X+X)),K=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),Q=new RegExp(q,"g"),J=new RegExp(Y,"g"),Z=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',K),"g"),$=new RegExp(t("[^]",q,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),ee=$;function te(e){var t=E(e);return t.match(Q)?t:e}var ne={scheme:"mailto",parse:function(e,t){var n=e,i=n.to=n.path?n.path.split(","):[];if(n.path=void 0,n.query){for(var r=!1,a={},o=n.query.split("&"),s=0,u=o.length;s<u;++s){var l=o[s].split("=");switch(l[0]){case"to":for(var c=l[1].split(","),h=0,d=c.length;h<d;++h)i.push(c[h]);break;case"subject":n.subject=G(l[1],t);break;case"body":n.body=G(l[1],t);break;default:r=!0,a[G(l[0],t)]=G(l[1],t)}}r&&(n.headers=a)}n.query=void 0;for(var f=0,p=i.length;f<p;++f){var g=i[f].split("@");if(g[0]=G(g[0]),t.unicodeSupport)g[1]=G(g[1],t).toLowerCase();else try{g[1]=w.toASCII(G(g[1],t).toLowerCase())}catch(e){n.error=n.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}i[f]=g.join("@")}return n},serialize:function(e,t){var n=e,i=function(e){return void 0!==e&&null!==e?e instanceof Array?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}(e.to);if(i){for(var a=0,o=i.length;a<o;++a){var s=String(i[a]),u=s.lastIndexOf("@"),l=s.slice(0,u).replace(J,te).replace(J,r).replace(Z,M),c=s.slice(u+1);try{c=t.iri?w.toUnicode(c):w.toASCII(G(c,t).toLowerCase())}catch(e){n.error=n.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}i[a]=l+"@"+c}n.path=i.join(",")}var h=e.headers=e.headers||{};e.subject&&(h.subject=e.subject),e.body&&(h.body=e.body);var d=[];for(var f in h)h[f]!==W[f]&&d.push(f.replace(J,te).replace(J,r).replace($,M)+"="+h[f].replace(J,te).replace(J,r).replace(ee,M));return d.length&&(n.query=d.join("&")),n}},ie=/^([^\:]+)\:(.*)/,re={scheme:"urn",parse:function(e,t){var n=e.path&&e.path.match(ie),i=e;if(n){var r=t.scheme||i.scheme||"urn",a=n[1].toLowerCase(),o=n[2],s=r+":"+(t.nid||a),u=T[s];i.nid=a,i.nss=o,i.path=void 0,u&&(i=u.parse(i,t))}else i.error=i.error||"URN can not be parsed.";return i},serialize:function(e,t){var n=t.scheme||e.scheme||"urn",i=e.nid,r=n+":"+(t.nid||i),a=T[r];a&&(e=a.serialize(e,t));var o=e,s=e.nss;return o.path=(i||t.nid)+":"+s,o}},ae=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,oe={scheme:"urn:uuid",parse:function(e,t){var n=e;return n.uuid=n.nss,n.nss=void 0,t.tolerant||n.uuid&&n.uuid.match(ae)||(n.error=n.error||"UUID is not valid."),n},serialize:function(e,t){var n=e;return n.nss=(e.uuid||"").toLowerCase(),n}};T[H.scheme]=H,T[z.scheme]=z,T[ne.scheme]=ne,T[re.scheme]=re,T[oe.scheme]=oe,e.SCHEMES=T,e.pctEncChar=M,e.pctDecChars=E,e.parse=L,e.removeDotSegments=B,e.serialize=U,e.resolveComponents=j,e.resolve=function(e,t,n){var i=function(e,t){var n=e;if(t)for(var i in t)n[i]=t[i];return n}({scheme:"null"},n);return U(j(L(e,i),L(t,i),i,!0),i)},e.normalize=function(e,t){return"string"==typeof e?e=U(L(e,t),t):"object"===i(e)&&(e=L(U(e,t),t)),e},e.equal=function(e,t,n){return"string"==typeof e?e=U(L(e,n),n):"object"===i(e)&&(e=U(e,n)),"string"==typeof t?t=U(L(t,n),n):"object"===i(t)&&(t=U(t,n)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?s.ESCAPE:o.ESCAPE,M)},e.unescapeComponent=G,Object.defineProperty(e,"__esModule",{value:!0})}(t)},U8Ad:function(e,t,n){"use strict";var i,r=n("eycI"),a=n("tNdj").a.extend({}),o=n("QoPM");i=r.a.extend({mixins:[Object(o.a)("categories")],model:a,endpoint:"/categories",defaultOptions:{pageSize:""},queryParams:function(){return{}}});t.a=i},UESx:function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/hotspot.jinja"]={root:function(e,t,n,i,r){var a=null,o=null;try{var s=i.makeMacro([],["options"],function(r){var s=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var u="";u+="\n",n.set("width_before",30,!0),n.topLevel&&t.setVariable("width_before",30),n.topLevel&&t.addExport("width_before",30),u+="\n",n.set("width_next",960,!0),n.topLevel&&t.setVariable("width_next",960),n.topLevel&&t.addExport("width_next",960),u+='\n        <div class="vr-hotspot-content" style="width:',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"widthContent"),e.opts.autoescape),u+='px;" id="hotspot',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"hotspotIndex"),e.opts.autoescape),u+='">\n            <div class="cell" id="default" style="width:1024px;height:576px;position:absolute;top:0;left:0"></div>',n=n.push();var l=(a=5,o=32,i.callWrap(i.contextOrFrameLookup(t,n,"range"),"range",t,[0,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"column")]));if(l)for(var c=l.length,h=0;h<l.length;h++){var d,f,p=l[h];n.set("column",p),n.set("loop.index",h+1),n.set("loop.index0",h),n.set("loop.revindex",c-h),n.set("loop.revindex0",c-h-1),n.set("loop.first",0===h),n.set("loop.last",h===c-1),n.set("loop.length",c),u+='<div class="page" id="column',u+=i.suppressValue(p,e.opts.autoescape),u+='" style="width:1024px;height:576px;position:absolute;top:0;left:',u+=i.suppressValue(1024*p,e.opts.autoescape),u+='px; overflow: visible">',p>0&&(u+='<div style="width:40px;height:40px;position:absolute;top:250px;left:30px" class="vr-icon vr-icon-arrow-left-white"></div>\n                        <button id="prevPage" style="opacity:0; height: 100%; width:10%; top:0; position: absolute; left: 0;"></button>'),d=i.contextOrFrameLookup(t,n,"width_before")+1024,n.set("width_before",d,!0),n.topLevel&&t.setVariable("width_before",d),n.topLevel&&t.addExport("width_before",d),u+='\n                    <div class="vr-hotspot-title">',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"title"),e.opts.autoescape),u+="</div>",p<1&&(u+='<div class="vr-hotspot-description" style="column-count:',u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"column"),e.opts.autoescape),u+=";width:",u+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"widthContent"),e.opts.autoescape),u+='px">',u+=i.suppressValue(e.getFilter("safe").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"description")),e.opts.autoescape),u+="</div>"),p+1<i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"column")&&(u+='<button id="nextPage" style="opacity:0; height: 100%; width:10%; top:0; position: absolute; right: 0;"></button>\n                        <div style="width:40px;height:40px;position:absolute;top:250px;left:960px" class="vr-icon vr-icon-arrow-right-white"></div>\n                        ',f=i.contextOrFrameLookup(t,n,"width_next")+1024,n.set("width_next",f,!0),n.topLevel&&t.setVariable("width_next",f),n.topLevel&&t.addExport("width_next",f)),u+='<div class="vr-hotspot-footer">\n                        <div class="vr-hotspot-container-button" >',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"displayNavigation")?u+='<button id="prevButton" class="vr-hotspot-button">Prev</button>\n                                <button id="closeButton" class="vr-hotspot-button">Close annotation</button>\n                                <button id="nextButton" class="vr-hotspot-button">Next</button>':u+='<button id="closeButton" class="vr-hotspot-button">Close annotation</button>',u+="</div>\n                    </div>\n                </div>"}return n=n.pop(),u+="</div>\n",n=s,new i.SafeString(u)});t.addExport("panel"),t.setVariable("panel",s),r(null,"")}catch(e){r(i.handleError(e,a,o))}}}},UIJo:function(e,t,n){"use strict";var i=n("OZf9"),r=n("gCTM");t.a=function(e){var t={fileTypes:function(e,t){var n=t.name.replace(/^.*\.([^.]*)$/,"$1").toLowerCase();if(!(-1!==e.indexOf(n)))return{type:"fileTypes",message:"<p>Unsupported format. Please upload a "+e.join(", ").toUpperCase()+".</p>"}},maxFileSize:function(e,t){if(!(t.size<e)){var n=Math.floor(e/1024/1024)+"MB",i=Math.ceil(t.size/1024/1024)+"MB";return{type:"maxFileSize",message:r.default.getFromString('<p>The {{ fileName | default("selected") }} image file size is too large. The maximum file size is {{ maxSizeLabel}} (your file is {{ currentSizeLabel }}).<p/>',{fileName:t.name,maxSizeLabel:n,currentSizeLabel:i})}}}},n={fileTypes:"<p>The file type you tried to upload is not currently supported by Sketchfab.</p>",maxFileSize:'        <p>To reduce your file size, you can:</p>        <ul class="--disc">            <li>resize your image to a lower resolution.</li>            <li>use a more efficient file format like JPEG.</li>            <li>reduce the JPEG quality.</li>        </ul>        '};return{name:"Validator",validateFile:function(n,r){if(null==e)return console.error("Ruleset not defined");var a,o=[];return Object(i.a)(e,function(e,i){(a=t[i](e,n))&&o.push(a)}),r?o.length>0?o:void 0:this.concatErrorMessages(o)},concatErrorMessages:function(e){return e.reduce(function(e,t){return e.concat(e,t.message)},"")},getExtraErrorInformation:function(e){return n[e]}}}},UKde:function(e,t){e.exports='#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureInput;\nuniform vec2 uTextureInputSize;\n\n#ifdef HAS_BACKGROUND\nuniform sampler2D TextureDepth;\n#endif\n\nuniform float uSharpFactor;\n\nuniform vec2 uPixelRatio;\n\nvec3 sharpColorFactor(const in vec3 color, const float sharp) {\n    vec2 off = uPixelRatio.xy / uTextureInputSize.xy;\n\n    // use useAA, 4 texFetch already in cache. perhaps we could cache ourself.\n    vec3 rgbNW = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(-1.0, -1.0)).rgb; \n    vec3 rgbSE = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(1.0, 1.0)).rgb;\n    vec3 rgbNE = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(1.0, -1.0)).rgb;\n    vec3 rgbSW = TEXTURE_2D_TextureInput(gTexCoord + off * vec2(-1.0, 1.0)).rgb;\n\n    return color + sharp * (4.0 * color - rgbNW - rgbNE - rgbSW - rgbSE);\n}\n\nvec4 sharpen(const in vec4 color) {\n#ifdef HAS_BACKGROUND\n\tfloat alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n\tif( alpha == 0.0 ) {\n\t\treturn vec4(color.rgb,1.0);\n    }\n#else\n\tfloat alpha = 1.0;\n#endif\n\n    return vec4(sharpColorFactor(color.rgb, uSharpFactor * alpha), color.a);\n}\n\nvec4 sharpen() {\n    return sharpen(TEXTURE_2D_TextureInput(gTexCoord));\n}'},ULzY:function(e,t,n){"use strict";n.r(t);var i=n("icjm"),r=n("a3nb"),a=n("Qavt"),o=n("/QLk"),s=n("HORL"),u=n("RwmW"),l=n("zP/P"),c=function(e,t,n,i){this._target=e,this._internalFormat=t,this._width=n,this._height=i,this._size=0,this.computeSize()};c.prototype={match:function(e){return e._target===this._target&&e._internalFormat===this._internalFormat&&e._width===this._width&&e._height===this._height},computeSize:function(){var e=n("ULzY").default,t=0;switch(this._internalFormat){case 1:case e.ALPHA:case e.LUMINANCE:t=8;break;case e.LUMINANCE_ALPHA:case 2:t=16;break;case e.RGB:case 3:t=24;break;case e.RGBA:case 4:t=32}var i=Math.ceil(this._width*this._height*t)/8;this._target===e.TEXTURE_CUBE_MAP&&(i*=6),i+=i/3,this._size=i},getSize:function(){return this._size}},c.getHash=function(){var e="";return Array.prototype.slice.call(arguments).forEach(function(t){e+=t}),e};var h=function(e,t,n){this._texture=e,this._id=t,this._textureSet=n};h.prototype={target:function(){return this._textureSet._profile._target},id:function(){return this._id},getTextureSet:function(){return this._textureSet},reset:function(){this._textureObject=null,this._texture=void 0},bind:function(e){e.bindTexture(this.target(),this._id)}};var d=function(e){this._profile=e,this._usedTextureObjects=[],this._orphanedTextureObjects=[]};d.prototype={getProfile:function(){return this._profile},getUsedTextureObjects:function(){return this._usedTextureObjects},getOrphanedTextureObjects:function(){return this._orphanedTextureObjects},takeOrGenerate:function(e,t){var n;if(this._orphanedTextureObjects.length>0)return(n=this.takeFromOrphans())._texture=t,this._usedTextureObjects.push(n),n;var i=e.createTexture();return n=new h(t,i,this),this._usedTextureObjects.push(n),n},takeFromOrphans:function(){if(this._orphanedTextureObjects.length)return this._orphanedTextureObjects.pop()},orphan:function(e){var t=this._usedTextureObjects.indexOf(e);-1!==t&&(this._orphanedTextureObjects.push(this._usedTextureObjects[t]),this._usedTextureObjects.splice(t,1))},flushDeletedTextureObjects:function(e,t){if(t<=0)return t;var n,i=this._orphanedTextureObjects.length,r=0,a=l.a.instance().tick();for(n=0;n<i&&r<t;n++)e.deleteTexture(this._orphanedTextureObjects[n].id()),this._orphanedTextureObjects[n].reset(),r=l.a.instance().deltaS(a,l.a.instance().tick());return this._orphanedTextureObjects.splice(0,n),t-r},flushAllDeletedTextureObjects:function(e){for(var t=this._orphanedTextureObjects.length,n=this.getProfile().getSize(),r=0,a=t;r<a;++r)e.deleteTexture(this._orphanedTextureObjects[r].id()),this._orphanedTextureObjects[r].reset();this._orphanedTextureObjects.length=0,i.a.info("TextureManager: released "+t+" with "+t*n/1048576+" MB")},onLostContext:function(){var e,t;for(t=this._orphanedTextureObjects.length,e=0;e<t;++e)this._orphanedTextureObjects[e].reset();for(this._orphanedTextureObjects.length=0,t=this._usedTextureObjects.length,e=0;e<t;++e)this._usedTextureObjects[e].reset();this._usedTextureObjects.length=0}};var f=function(){this._textureSetMap={}};f.prototype={generateTextureObject:function(e,t,n,i,r,a){var o=c.getHash(n,i,r,a);return void 0===this._textureSetMap[o]&&(this._textureSetMap[o]=new d(new c(n,i,r,a))),this._textureSetMap[o].takeOrGenerate(e,t)},updateStats:function(e,t){var n=0,i=0;for(var r in this._textureSetMap){var a=this._textureSetMap[r].getProfile().getSize();n+=this._textureSetMap[r].getUsedTextureObjects().length*a,i+=this._textureSetMap[r].getOrphanedTextureObjects().length*a}var o=1048576;t.getCounter("textureused").set(n/o),t.getCounter("texturereserved").set(i/o),t.getCounter("texturetotal").set((n+i)/o)},reportStats:function(){var e=0;for(var t in this._textureSetMap){var n=this._textureSetMap[t].getProfile(),r=n.getSize()/1048576,a=this._textureSetMap[t].getUsedTextureObjects().length;e+=r*=a,i.a.notice(String(r)+" MB with "+a+" texture of "+n._width+"x"+n._height+" "+n._internalFormat)}i.a.notice(String(e)+" MB in total")},flushAllDeletedTextureObjects:function(e){for(var t in this._textureSetMap)this._textureSetMap[t].flushAllDeletedTextureObjects(e)},onLostContext:function(e){for(var t in this._textureSetMap)this._textureSetMap[t].onLostContext(e)},flushDeletedTextureObjects:function(e,t){var n=t;for(var i in this._textureSetMap)if((n=this._textureSetMap[i].flushDeletedTextureObjects(e,n))<=0)break;return n},releaseTextureObject:function(e){e&&e.getTextureSet().orphan(e)}};var p=f,g=n("AwiE"),m=window.ImageBitmap||function(){},v=function(e){return 0!==e&&(e&1+~e)===e},_=function(){a.a.call(this),u.a.call(this),this.setDefaultParameters(),this._dirty=!0,this._dirtyMipmap=!0,this._applyTexImage2DCallbacks=[],this._textureObject=void 0,this._textureNull=!0},b=function(e,t){var n=_[e];return void 0===n?(i.a.warn("bad Texture enum argument "+e+"\nfallback to "+t),t):n};_.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,_.UNPACK_FLIP_Y_WEBGL=37440,_.BROWSER_DEFAULT_WEBGL=37444,_.NONE=0,_.DEPTH_COMPONENT=6402,_.DEPTH_COMPONENT16=33189,_.DEPTH_STENCIL=34041,_.DEPTH24_STENCIL8=35056,_.DEPTH_COMPONENT24=33190,_.DEPTH_COMPONENT32F=36012,_.COMPRESSED_RGB_S3TC_DXT1_EXT=33776,_.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777,_.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778,_.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779,_.COMPRESSED_RGB_ATC_WEBGL=35986,_.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987,_.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798,_.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840,_.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841,_.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842,_.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843,_.COMPRESSED_RGB_ETC1_WEBGL=36196,_.LINEAR=9729,_.NEAREST=9728,_.NEAREST_MIPMAP_NEAREST=9984,_.LINEAR_MIPMAP_NEAREST=9985,_.NEAREST_MIPMAP_LINEAR=9986,_.LINEAR_MIPMAP_LINEAR=9987,_.TEXTURE_MAX_ANISOTROPY_EXT=34046,_.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047,_.CLAMP_TO_EDGE=33071,_.REPEAT=10497,_.MIRRORED_REPEAT=33648,_.TEXTURE_2D=3553,_.TEXTURE_CUBE_MAP=34067,_.TEXTURE_BINDING_CUBE_MAP=34068,_.TEXTURE_CUBE_MAP_POSITIVE_X=34069,_.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,_.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,_.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,_.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,_.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,_.MAX_CUBE_MAP_TEXTURE_SIZE=34076,_.UNSIGNED_BYTE=5121,_.UNSIGNED_SHORT=5123,_.UNSIGNED_SHORT_4_4_4_4=32819,_.UNSIGNED_SHORT_5_5_5_1=32820,_.UNSIGNED_SHORT_5_6_5=33635,_.FLOAT=5126,_.HALF_FLOAT_OES=36193,_.HALF_FLOAT=5131,_.UNSIGNED_INT_10F_11F_11F_REV=35899,_.UNSIGNED_INT_24_8=34042,_.ALPHA=6406,_.RGB=6407,_.RGBA=6408,_.LUMINANCE=6409,_.LUMINANCE_ALPHA=6410,_.RED_INTEGER=36244,_.RGB_INTEGER=36248,_.RGBA_INTEGER=36249,_.RG_INTEGER=33320,_.RED=6403,_.R8=33321,_.R8UI=33330,_.RG8=33323,_.RG8UI=33336,_.RGB8=36758,_.RGB565=36194,_.RGB9_E5=35901,_.RGB8UI=36221,_.RGBA8=32856,_.RGB5_A1=32855,_.RGBA4=32854,_.RGBA8UI=36220,_.SRGB8_ALPHA8=35907,_.SRGB8=35905,_.R16F=33325,_.RG16F=33327,_.RGB16F=34843,_.RGBA16F=34842,_.R11F_G11F_B10F=35898,_.R32F=33326,_.RG32F=33328,_.RGB32F=34837,_.RGBA32F=34836;var S=function(){var e={};return e[_.R8]=_.LUMINANCE,e[_.R8UI]=_.LUMINANCE,e[_.R16F]=_.LUMINANCE,e[_.R32F]=_.LUMINANCE,e[_.SRGB8]=_.LUMINANCE,e[_.RG8]=_.RGB,e[_.RG8UI]=_.RGB,e[_.RG16F]=_.RGB,e[_.RG32F]=_.RGB,e[_.RGB8]=_.RGB,e[_.RGB565]=_.RGB,e[_.RGB9_E5]=_.RGB,e[_.RGB8UI]=_.RGB,e[_.RGB5_A1]=_.RGB,e[_.RGB16F]=_.RGB,e[_.RGB32F]=_.RGB,e[_.RGBA8]=_.RGBA,e[_.R11F_G11F_B10F]=_.RGBA,e[_.RGBA16F]=_.RGBA,e[_.RGBA32F]=_.RGBA,e[_.SRGB8_ALPHA8]=_.RGBA,e}(),y=function(){var e={},t={},n={},i={},r={},a={};return e[_.FLOAT]=t,e[_.HALF_FLOAT]=e[_.HALF_FLOAT_OES]=n,e[_.UNSIGNED_SHORT]=i,e[_.UNSIGNED_INT]=r,e[_.UNSIGNED_INT_24_8]=a,n[_.LUMINANCE]=_.R16F,n[_.RGB]=_.RGB16F,n[_.RGBA]=_.RGBA16F,t[_.LUMINANCE]=_.R32F,t[_.RGB]=_.RGB32F,t[_.RGBA]=_.RGBA32F,i[_.DEPTH_COMPONENT]=_.DEPTH_COMPONENT16,r[_.DEPTH_COMPONENT]=_.DEPTH_COMPONENT32F,a[_.DEPTH_STENCIL]=_.DEPTH24_STENCIL8,e}();_._sTextureManager=new window.Map,_.getTextureManager=function(e){return _._sTextureManager.has(e)||_._sTextureManager.set(e,new p),_._sTextureManager.get(e)},_.getEnumFromString=function(e){var t=e;return"string"==typeof t&&(t=b(t,e)),t},r.a.createPrototypeStateAttribute(_,r.a.objectInherit(u.a.prototype,r.a.objectInherit(a.a.prototype,{attributeType:"Texture",cloneType:function(){return new _},invalidate:function(){this._textureObject=void 0,this.dirty()},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty},isTextureNull:function(){return this._textureNull},getOrCreateUniforms:function(e){if(void 0===_.uniforms&&(_.uniforms=[]),void 0===_.uniforms[e]){var t=this.getType()+e;_.uniforms[e]={texture:o.a.createInt1(e,t)}}return _.uniforms[e]},setDefaultParameters:function(){this._image=void 0,this._magFilter=_.LINEAR,this._minFilter=_.LINEAR,this._maxAnisotropy=1,this._wrapS=_.CLAMP_TO_EDGE,this._wrapT=_.CLAMP_TO_EDGE,this._textureWidth=0,this._textureHeight=0,this._unrefImageDataAfterApply=!1,this._internalFormat=void 0,this._dirtyMipmap=!0,this._textureTarget=_.TEXTURE_2D,this.setInternalFormatType(_.UNSIGNED_BYTE),this._isCompressed=!1,this._flipY=!0,this._colorSpaceConversion=_.NONE},setColorSpaceConversion:function(e){this._colorSpaceConversion=e},setFlipY:function(e){this._flipY=e},getTextureTarget:function(){return this._textureTarget},getTextureObject:function(){return this._textureObject},setTextureSize:function(e,t){var n=g.a.instance().getWebGLParameter("MAX_TEXTURE_SIZE");e===this._textureWidth&&t===this._textureHeight||this.dirty(),void 0!==e&&(e>n?(i.a.error("width ("+e+') too big for GPU. Max Texture Size is "'+n+'"'),this._textureWidth=n):this._textureWidth=e),void 0!==t&&(t>n?(i.a.error("height ("+t+') too big for GPU. Max Texture Size is "'+n+'"'),this._textureHeight=n):this._textureHeight=t),this._textureNull=!1},init:function(e){this._gl||this.setGraphicContext(e.getGraphicContext()),this._textureObject||(this._textureObject=_.getTextureManager(this._gl).generateTextureObject(this._gl,this,this._textureTarget,this._internalFormat,this._textureWidth,this._textureHeight),this.dirty(),this._dirtyTextureObject=!1,this._textureNull=!1)},addApplyTexImage2DCallback:function(e){this._applyTexImage2DCallbacks.indexOf(e)<0&&this._applyTexImage2DCallbacks.push(e)},removeApplyTexImage2DCallback:function(e){var t=this._applyTexImage2DCallbacks.indexOf(e);t>=0&&this._applyTexImage2DCallbacks.splice(t,1)},getWidth:function(){return this._textureWidth},getHeight:function(){return this._textureHeight},releaseGLObjects:function(){void 0!==this._textureObject&&null!==this._textureObject&&void 0!==this._gl&&(_.getTextureManager(this._gl).releaseTextureObject(this._textureObject),u.a.removeObject(this._gl,this)),this.invalidate()},getWrapT:function(){return this._wrapT},getWrapS:function(){return this._wrapS},setWrapS:function(e){this._wrapS="string"==typeof e?b(e,_.CLAMP_TO_EDGE):e,this.dirtyTextureParameters()},setWrapT:function(e){this._wrapT="string"==typeof e?b(e,_.CLAMP_TO_EDGE):e,this.dirtyTextureParameters()},dirtyTextureParameters:function(){this.dirty(),this.dirtyMipmap(),this.dirtyTextureObject()},dirtyTextureObject:function(){this._dirtyTextureObject=!0,this.dirtyMipmap(),this.dirty()},getMinFilter:function(){return this._minFilter},getMagFilter:function(){return this._magFilter},setMaxAnisotropy:function(e){this._maxAnisotropy=e,this.dirtyTextureParameters()},getMaxAnisotropy:function(){return this._maxAnisotropy},setMinFilter:function(e){this._minFilter="string"==typeof e?b(e,_.LINEAR):e,this.dirtyTextureParameters()},setMagFilter:function(e){this._magFilter="string"==typeof e?b(e,_.LINEAR):e,this.dirtyTextureParameters()},setImage:function(e,t){var n=e;(e instanceof window.Image||e instanceof HTMLCanvasElement||e instanceof m||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Float32Array)&&(n=new s.a(e)),this._image=n,this.setImageFormat(t),n&&(n.getWidth&&n.getHeight?this.setTextureSize(n.getWidth(),n.getHeight()):n.width&&n.height&&this.setTextureSize(n.width,n.height)),this._textureNull=!1,this.dirty()},getImage:function(){return this._image},setImageFormat:function(e){var t=e;t?("string"==typeof t&&(t=_[t]),this._imageFormat=t):this._imageFormat=_.RGBA},setInternalFormatType:function(e){this._type="string"==typeof e?_[e]:e},getInternalFormatType:function(){return this._type},setUnrefImageDataAfterApply:function(e){this._unrefImageDataAfterApply=e},checkIsCompressed:function(e){switch(e||this._internalFormat){case _.COMPRESSED_RGB_S3TC_DXT1_EXT:case _.COMPRESSED_RGBA_S3TC_DXT1_EXT:case _.COMPRESSED_RGBA_S3TC_DXT3_EXT:case _.COMPRESSED_RGBA_S3TC_DXT5_EXT:case _.COMPRESSED_RGB_ATC_WEBGL:case _.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:case _.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:case _.COMPRESSED_RGB_PVRTC_4BPPV1_IMG:case _.COMPRESSED_RGB_PVRTC_2BPPV1_IMG:case _.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:case _.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:case _.COMPRESSED_RGB_ETC1_WEBGL:return!0;default:return!1}},setInternalFormat:function(e){var t=e;t?("string"==typeof t&&(t=_[t]),this._isCompressed=this.checkIsCompressed(t)):(this._isCompressed=!1,t=_.RGBA),this._internalFormat=t},getInternalFormat:function(){return this._internalFormat},isDirtyMipmap:function(){return this._dirtyMipmap},dirtyMipmap:function(){this._dirtyMipmap=!0},applyFilterParameter:function(e,t){if(v(this._textureWidth)&&v(this._textureHeight)||(this._wrapT=_.CLAMP_TO_EDGE,this._wrapS=_.CLAMP_TO_EDGE,this._minFilter!==_.LINEAR_MIPMAP_LINEAR&&this._minFilter!==_.LINEAR_MIPMAP_NEAREST||(this._minFilter=_.LINEAR)),e.texParameteri(t,e.TEXTURE_MAG_FILTER,this._magFilter),e.texParameteri(t,e.TEXTURE_MIN_FILTER,this._minFilter),this._maxAnisotropy>1&&_.ANISOTROPIC_SUPPORT_EXT){var n=this._maxAnisotropy<_.ANISOTROPIC_SUPPORT_MAX?this._maxAnisotropy:_.ANISOTROPIC_SUPPORT_MAX;e.texParameterf(t,_.TEXTURE_MAX_ANISOTROPY_EXT,n)}e.texParameteri(t,e.TEXTURE_WRAP_S,this._wrapS),e.texParameteri(t,e.TEXTURE_WRAP_T,this._wrapT)},generateMipmap:function(e,t){if(this._dirtyMipmap=!1,this.hasMipmapFilter()){var n=this._image;if(n&&n.hasMipmap())for(var i=this._getInternalFormatGL(),r=n.getMipmap(),a=1,o=r.length;a<o;a++){var s=r[a];this._isCompressed?this.applyTexImage2D(e,this._textureTarget,a,i,s.getWidth(),s.getHeight(),0,s.getImage()):this.applyTexImage2D(e,this._textureTarget,a,i,s.getWidth(),s.getHeight(),0,this._internalFormat,this._type,s.getImage())}else e.generateMipmap(t)}},hasMipmapFilter:function(){return this._minFilter===_.NEAREST_MIPMAP_NEAREST||this._minFilter===_.LINEAR_MIPMAP_NEAREST||this._minFilter===_.NEAREST_MIPMAP_LINEAR||this._minFilter===_.LINEAR_MIPMAP_LINEAR},applyTexImage2D:function(e){var t=Array.prototype.slice.call(arguments,1);e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,this._flipY),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._colorSpaceConversion),this._isCompressed?e.compressedTexImage2D.apply(e,t):e.texImage2D.apply(e,t);var n=this._applyTexImage2DCallbacks.length;if(n>0)for(var i=0,r=n;i<r;i++)this._applyTexImage2DCallbacks[i].call(this)},computeTextureFormat:function(){this._internalFormat?this._imageFormat=this._internalFormat:(this._internalFormat=this._imageFormat||_.RGBA,this._imageFormat=this._internalFormat)},applyImage:function(e){var t=this._getInternalFormatGL(),n=this._image||null,i=n&&this._image.getImage(),r=this._getTypeGL();this._isCompressed?this.applyTexImage2D(e,this._textureTarget,0,t,this._textureWidth,this._textureHeight,0,i):!i||n.isTypedArray()?this.applyTexImage2D(e,this._textureTarget,0,t,this._textureWidth,this._textureHeight,0,this._internalFormat,r,i):this.applyTexImage2D(e,this._textureTarget,0,t,this._internalFormat,r,i),n&&n.setDirty(!1)},apply:function(e){var t=e.getGraphicContext();if(this._dirtyTextureObject&&(this.releaseGLObjects(),this._dirtyTextureObject=!1,this.setGraphicContext(t)),void 0===this._textureObject||this.isDirty())if(this._textureNull)t.bindTexture(this._textureTarget,null);else{var n=this._image;if(void 0!==n)if(n.isReady()){this.computeTextureFormat();var i=n.getWidth()||this._textureWidth,r=n.getHeight()||this._textureHeight;this.setTextureSize(i,r),this._textureObject||this.init(e),this._textureObject.bind(t),this.applyImage(t),this.applyFilterParameter(t,this._textureTarget),this.generateMipmap(t,this._textureTarget),this._unrefImageDataAfterApply&&(this._image=void 0),this._dirty=!1}else t.bindTexture(this._textureTarget,null);else 0!==this._textureHeight&&0!==this._textureWidth&&(this.computeTextureFormat(),this._textureObject||this.init(e),this._textureObject.bind(t),this.applyImage(t),this.applyFilterParameter(t,this._textureTarget),this.generateMipmap(t,this._textureTarget),this._dirty=!1)}else this._textureObject.bind(t),void 0!==this._image&&this._image.isDirty()&&(this.applyImage(t),this.dirtyMipmap()),this.isDirtyMipmap()&&this.generateMipmap(t,this._textureTarget)},_getInternalFormatGL:function(){var e=this._internalFormat;if(!g.a.instance().isWebGL2())return S[e]||e;var t=y[this._type];return t&&t[e]||e},_getTypeGL:function(){return this._type!==_.HALF_FLOAT||g.a.instance().isWebGL2()?this._type:_.HALF_FLOAT_OES}})),"osg","Texture"),_.textureNull=new _,_.createFromImage=function(e,t){var n=new _;return n.setImage(e,t),n},_.createFromCanvas=function(e,t){return _.createFromImage(e,t)};t.default=_},UUlS:function(e,t){e.exports="// https://github.com/borismus/webvr-boilerplate/blob/master/src/distortion/barrel-distortion-fragment-v2.js\n\nvec2 barrel(const in vec2 v, const in vec4 projection, const in vec4 unprojection) {\n  vec2 w = (v + unprojection.zw) / unprojection.xy;\n  float val = dot(w, w);\n  // float poly = (showCenter == 1 && val < 0.00010) ? 10000.0 : 1.0 + (uDistortion.x + uDistortion.y * val) * val;\n  float poly = 1.0 + (uDistortion.x + uDistortion.y * val) * val;\n  return projection.xy * (poly * w) - projection.zw;\n}\n\nvec2 distortion(const in vec2 texCoord) {\n\n  if (abs(texCoord.x - 0.5) < .001) {\n    discard;\n  }\n\n  vec2 a;\n\n  if (texCoord.x < 0.5){\n    a = barrel(vec2(texCoord.x / 0.5, texCoord.y), uProjectionLeft, uUnprojectionLeft);\n  } else {\n    // right projections are shifted and vertically mirrored relative to left\n    const vec3 swi = vec3(1.0, -1.0, 0.0);\n    vec4 projectionRight = (uProjectionLeft + swi.zzxz) * swi.xxyx;\n    vec4 unprojectionRight = (uUnprojectionLeft + swi.zzxz) * swi.xxyx;\n    a = barrel(vec2((texCoord.x - 0.5) / 0.5, texCoord.y), projectionRight, unprojectionRight);\n  }\n\n  if (a.x < 0.0 || a.x > 1.0 || a.y < 0.0 || a.y > 1.0) {\n    discard;\n  }\n\n  return vec2(a.x * 0.5 + (texCoord.x < 0.5 ? 0.0 : 0.5), a.y);\n}"},UWrD:function(e,t,n){"use strict";(function(e){var i=n("q1z7"),r=n.n(i),a=n("9mpE"),o=n("dAuA"),s=n("qCPs"),u=n("12sq"),l=n("fgaA"),c=n("grIK"),h=function(e,t){var n=new r.a.Model;return n.url=e+t,n.fetch().then(function(e){return window.prefetchedData[t]=e,e})};t.a=function(){var t=function(){if("dev"!==u.a.buildMode){var e=!1;if(u.a.prodHookDomainsBlacklist.forEach(function(t){document.location.href.indexOf(t)>-1&&(e=!0)}),e)return}if(-1!==window.location.search.substr(1).indexOf("hook_")){for(var t,n="hook_".length,i=window.location.search.substr(1).split(o.a),r=0;r<i.length;++r){var s=i[r];if(-1!==s.indexOf("hook_")){t=s.substr(n,s.indexOf("=")-n);break}}if(t&&a.c.bool("hook_"+t)){var l="https://";return l+="prod"===t?"sketchfab.com":"fatvoxel"===t?"fatvoxel.com":t+".fatvoxel.com"}}}();if(t){var n=Object(l.a)().model;if(n){var i=function(t,n){for(var i=["","animations","backgrounds","environments","hotspots","matcaps","sounds","textures"],r=[],a=0;a<i.length;++a){var o=Object(c.a)(i[a],n);r.push(h(t,o))}return e.all(r).then(function(e){return new s.a(e[0])})}(t,n);s.a.get=function(){return i}}}}}).call(this,n("CSL1"))},Ui7z:function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"d",function(){return v}),n.d(t,"k",function(){return _}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return S}),n.d(t,"h",function(){return y}),n.d(t,"g",function(){return x}),n.d(t,"i",function(){return C}),n.d(t,"f",function(){return w}),n.d(t,"l",function(){return M}),n.d(t,"j",function(){return E}),n.d(t,"a",function(){return A});var i=n("cDf5"),r=n.n(i),a=n("lSNA"),o=n.n(a),s=n("MVZn"),u=n.n(s),l=n("0Uag"),c=n("ZGcR"),h=n("IzLi"),d=n("vJtL"),f=n("TSHB"),p=n("m8R6"),g=n("6uKY");function m(e,t){return Object.keys(e).reduce(function(n,i){return u()({},n,t(e[i],i))},{})}function v(e,t){return m(e,function(e,n){return t(e,n)?o()({},n,e):{}})}var _=Object(l.a)(function(e,t){return t[e]});function b(e){return v(e,function(e){return void 0!==e&&null!==e&&""!==e})}function S(e){return v(e,function(e){return void 0!==e})}function y(e,t){return function(){return u()({},e.call(this),t.call(this))}}function x(e,t){for(var n in e)if(!(n in t)||e[n]!==t[n])return!1;for(var i in t)if(!(i in e)||e[i]!==t[i])return!1;return!0}function C(e){return Object(c.a)(e,function(e,t){return Object(g.camelToSnakeCase)(t)})}var w=function(e){return Object(h.a)(e)&&!Object(d.a)(e)&&!Array.isArray(e)},T=function e(t){return Object(d.a)(t)?void 0:Array.isArray(t)?t.map(function(t){return e(t)}):Object(h.a)(t)?Object(f.a)(t,function(t){return e(t)}):t},M=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"obj";if(n&&"function"!=typeof t&&r()(t)!==r()(n))throw new Error("update error: ".concat(i," doesn't match between your updater and your value"));return void 0===n?T(t):Object(d.a)(t)?t(n):Array.isArray(n)?t.map(function(t,r){return e(t,n[r],"".concat(i,"[").concat(r,"]"))}):w(n)?Object.assign({},n,Object(f.a)(t,function(t,r){return e(t,n[r],"".concat(i,".").concat(r))})):T(t)},E=function e(t){return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return i.reduce(function(n,i){return 0!==t&&w(n)&&w(i)?1===t?u()({},n,i):u()({},Object(f.a)(n,function(n,r){return i.hasOwnProperty(r)?e(t-1)(n,i[r]):n}),Object(f.a)(Object(p.a)(i,Object.keys(n)),function(i,r){return e(t-1)(n[r],i)})):i},{})}},A=function e(t,n){return w(t)&&w(n)?u()({},m(t,function(t,i){return t!==n[i]?o()({},i,e(t,n[i])):{}}),m(n,function(n,i){return n!==t[i]?o()({},i,e(t[i],n)):{}})):n}},UpON:function(e,t,n){"use strict";var i=n("9oTK"),r=n.n(i),a=n("fgaA"),o={OSG_VERSION:-1},s=function(e){var t={},n=new r.a(function(e,n){t.resolve=e,t.reject=n});n.resolve=t.resolve,n.reject=t.reject,o["get"+e]=function(){return n},o["resolve"+e]=function(){!1===n.isFulfilled()&&n.resolve.apply(n,arguments)}};o.getInitialTextureBoundPromise=function(){return Object(a.a)().preload?o.getHighResBound():o.getLowResBound()},s("Polygon"),s("Wireframe"),s("WireframeOptimized"),s("WireframeOptimizedSplit"),s("WireframeOptimizedSplitCompressed"),s("ModelDisplayed"),s("FirstAnimation"),s("AllAnimations"),s("HasAnimation"),s("FirstCameraAnimation"),s("Material"),s("HasSound"),s("SoundsCanPlayTrough"),s("VrDisplayReady"),s("LowResLoaded"),s("HighResLoaded"),s("LowResBound"),s("HighResBound"),s("AsyncShaderCompilation"),s("DataSizeOSGJS"),s("DataSizePolygon"),s("DataSizeTextures"),s("DataSizeSound"),s("DataSizeEnvironment"),s("DataSizeWireframe"),s("DataSizeAllModel"),r.a.all([o.getDataSizeOSGJS(),o.getDataSizePolygon(),o.getDataSizeSound(),o.getDataSizeTextures(),o.getDataSizeEnvironment(),o.getDataSizeWireframe()]).then(function(e){for(var t=0,n=0,i=e.length;n<i;n++)t+=e[n];o.resolveDataSizeAllModel(t)}),o.allLoadingDone=window.sketchfabViewerLoaded=r.a.all([o.getHighResBound(),o.getAllAnimations(),o.getWireframeOptimizedSplitCompressed()]),document.createEvent&&window.dispatchEvent&&window.sketchfabViewerLoaded.then(function(){var e=document.createEvent("Event");e.initEvent("sketchfaballloadingdone",!0,!0),window.dispatchEvent(e)}),t.a=o},UpVh:function(e,t,n){"use strict";var i=n("uPP5"),r=n("KYKV"),a=n.n(r),o=n("9oTK"),s=n.n(o),u=function(){return{_viewer:void 0,version:"0.2",initialize:function(e,t){this._viewer=e,this._uid=t;var n=this;window.addEventListener("message",function(e){if(e.data&&e.data.command){var t=e.data;"initialize"!==t.command&&Object.prototype.hasOwnProperty.call(n,t.command)&&n[t.command].call(n,t)}},!1)},ready:function(){this.answer({status:"load"})},clientReady:function(){return s.a.resolve()},answer:function(e){e.source=this._uid,void 0!==window.parent&&window.parent.postMessage(e,"*")},start:function(){this._viewer.start(),this.answer({status:"start"})},stop:function(){this._viewer.stop(),this.answer({status:"stop"})},lookat:function(e){this._viewer.lookat&&(this._viewer.lookat(e.eye,e.target,e.duration),window.setTimeout(function(){this.answer({status:"lookat"})}.bind(this),1e3*e.duration),this.answer({status:"lookat start"}))},autospin:function(e){!1===e&&(e=0),this.answer({status:"autospin"})},getViewerAPI:function(){}}},l=n("tvnS"),c=n("ipT2"),h=n("QLQS"),d=n("Auie"),f=n("joy8"),p=n("PRjJ"),g=n("Kp3F"),m=n("par7"),v=n("eEbW"),_=h.a.osg,b=h.a.osgAnimation,S=function(){c.a.apply(this,arguments),this.updateDaemon=void 0};S.prototype=Object(p.a)(c.a.prototype,{setCameraEasing:function(e){this._getFeatureModel("camera").set("easingFunction",e)},hideAnnotation:function(e,t){this._getFeatureModel("hotspot").get("hotspots").at(e).set("visible",!1),m.a.draw(),t(null)},showAnnotation:function(e,t){this._getFeatureModel("hotspot").get("hotspots").at(e).set("visible",!0),m.a.draw(),t(null)},createAnnotation:function(e,t,n,i,r,a,o){var s=d.a.computeNearestIntersection3D(e,t);if(!s)return o(null);var u=this._getFeatureModel("hotspot"),l=u.createHotspot(s,!0);v.b.getMarkdownPreview(a).then(function(e){l.set({name:r,content:{raw:a,rendered:e.result},eye:n,target:i}),m.a.redrawShadow(),o(null,u.get("hotspots").length-1),m.a.draw()},function(){l.set({name:r,eye:n,target:i}),m.a.redrawShadow(),o(null,u.get("hotspots").length-1),m.a.draw()}.bind(this))},updateAnnotation:function(e){var t,n=this._getFeatureModel("hotspot").get("hotspots").at(e);if(3===arguments.length){var i=arguments[1],r={};if(i.title&&(r.name=i.title),i.content&&(r.content={raw:i.content}),i.eye&&(r.eye=i.eye),i.target&&(r.target=i.target),t=arguments[2],i.content)return void v.b.getMarkdownPreview(i.content).then(function(e){r.content.rendered=e.result;var i=n.toJSON();this._filterAnnotationModelMessage(i),t(null,i),n.set(r),m.a.draw()}.bind(this),function(){var e=n.toJSON();this._filterAnnotationModelMessage(e),t(null,e),n.set(r),m.a.draw()}.bind(this));n.set(r)}else t=arguments[1];var a=n.toJSON();this._filterAnnotationModelMessage(a),m.a.redrawShadow(),t(null,a)},getAnnotation:function(e,t){var n=this._getFeatureModel("hotspot").get("hotspots").at(e).toJSON();this._filterAnnotationModelMessage(n),t(null,n)},removeAnnotation:function(e,t){var n=this._getFeatureModel("hotspot").get("hotspots"),i=n.at(e);n.remove(i),m.a.redrawShadow(),t(null)},pickFromScreen:function(){var e=_.vec3.create(),t=_.vec3.create();return function(n,i){var r=d.a.computeNearestIntersection2D(n[0],n[1],this._pickMask.click);if(!r)return i(null);d.a.getWorldPositionFromHit(r,t,e);var a=this._getHitNodeID(r),o=this._getFeatureModel("material").findFirstMaterial(r._nodePath);i(null,{position3D:t,position2D:n,normal:e,instanceID:a,material:o?o.getJSON():null})}}(),pickFromScene:function(){var e=_.vec3.create(),t=_.vec3.create();return function(n,i,r){var a=d.a.computeNearestIntersection3D(n,i);if(!a)return r(null);d.a.getWorldPositionFromHit(a,t,e);var o=this._getHitNodeID(a),s=this._getFeatureModel("material").findFirstMaterial(a._nodePath);r(null,{position3D:t,normal:e,instanceID:o,material:s?s.getJSON():null})}}(),addVideoTexture:function(e,t,n){this._convertVideoDataUriToImage(e,void 0,t,n)},_convertVideoDataUriToImage:function(e,t,n,i){var r=this._getFeatureModel("material").getImageCollection();f.default.instance.getOrCreateImage(e).promise.then(function(a){var o=r.addNewImage({uid:t,url:e,width:a.getWidth(),height:a.getHeight(),name:e.slice(0,100)});void 0!==n&&a.getImage&&(a.getImage().loop=n),i(null,o.getUID())}).catch(function(){i("failed to add texture")})},translate:function(e,t,n){var i=arguments.length,r=arguments[i-1],a=0,o=b.easeOutQuad;i>2&&((n=arguments[2]).duration&&(a=n.duration),n.easing&&b[n.easing]&&(o=b[n.easing]));var s=this._getNodeFromUserNodeID(e);if(s)if(s.getTypeID()===_.MatrixTransform.typeID){if(a>0){var u=_.vec3.create();_.mat4.getTranslation(u,s.getMatrix());var l=new g.c(u,t,a,o,function(t){this.updateDaemon.removeTranslateUpdateCallback(e),r(null,t)}.bind(this));this.updateDaemon||this._initUpdateDaemon(),this.updateDaemon.addTranslateUpdateCallback(s,l,e)}else _.mat4.setTranslation(s.getMatrix(),t),s.dirtyBound(),r(null,t);m.a.redrawShadow()}else r("you can only translate MatrixTransform nodes");else r("node with id "+e.toString()+" not found")},rotate:function(){var e=_.vec3.create(),t=_.vec3.create();return function(n,i,r){var a=arguments.length,o=arguments[a-1],s=0,u=b.easeOutQuad;a>2&&((r=arguments[2]).duration&&(s=r.duration),r.easing&&b[r.easing]&&(u=b[r.easing]));var l=this._getNodeFromUserNodeID(n);if(l)if(l.getTypeID()===_.MatrixTransform.typeID){var c=_.quat.create(),h=_.mat4.create();if(_.mat4.fromRotation(h,-i[0],_.vec3.set(t,i[1],i[2],i[3])),_.mat4.getRotation(c,h),s>0){var d=_.quat.create();_.mat4.getRotation(d,l.getMatrix());var f=new g.a(d,c,s,u,function(e){this.updateDaemon.removeRotateUpdateCallback(n),o(null,e)}.bind(this));this.updateDaemon||this._initUpdateDaemon(),this.updateDaemon.addRotateUpdateCallback(l,f,n)}else _.mat4.fromQuat(h,c),_.mat4.getTranslation(e,l.getMatrix()),_.mat4.setTranslation(h,e),_.mat4.copy(l.getMatrix(),h),l.dirtyBound(),o(null,i);m.a.redrawShadow()}else o("you can only rotate MatrixTransform nodes");else o("node with id "+n.toString()+" not found")}}(),_initUpdateDaemon:function(){var e=this._getViewer().getRootModel();this.updateDaemon=new g.b(this._getRealNodeMap()),e.addUpdateCallback(this.updateDaemon)}});var y=S,x=h.a.osg,C=function(){x.NodeVisitor.apply(this,arguments),this.reset()};x.createPrototypeObject(C,x.objectInherit(x.NodeVisitor.prototype,{reset:function(){this._nodes=[],this._nodeMap={},this._nodeList={},this._dirty=!0,this._apiSceneID=0},isDirty:function(){return this._dirty},getRootNode:function(){return this._nodes[0]},getRealNodeMap:function(){return this._nodeList},getRepresentationNodeMap:function(){return this._nodeMap},createNodeEntry:function(e){this._dirty=!1;var t=e._uniqueID;this._nodeList[t]||(this._nodeList[t]=e);var n={name:e.getName(),instanceID:t,nodeMask:e.getNodeMask()};return this._nodeMap[t]||(this._nodeMap[t]=n),n},applyNode:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var n=this.createNodeEntry(e);n.children=this._nodes,n.type="Group",t.push(n),this._nodes=t},applyMatrixTransform:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var n=this.createNodeEntry(e);n.children=this._nodes,n.type="MatrixTransform",n.localMatrix=x.mat4.clone(e.getMatrix()),n.worldMatrix=e.getWorldMatrices()[0],t.push(n),this._nodes=t},applyGeometry:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var n=this.createNodeEntry(e);n.type=e.className(),t.push(n),this._nodes=t},apply:function(e){if(void 0!==e._uniqueID){var t=e.getTypeID();t===x.Node.typeID?this.applyNode(e):t===x.MatrixTransform.typeID?this.applyMatrixTransform(e):e instanceof x.Geometry?this.applyGeometry(e):this.traverse(e)}else this.traverse(e)}}));var w=C,T=n("T1IQ"),M=n("4ANv"),E=n("JQdh"),A=h.a.osg,O=function(){y.apply(this,arguments),this._sceneGraphVisitor=new w,this.updateDaemon=void 0,this._startDrag=!1,this._startCoord=A.vec2.create()};O.prototype=Object(p.a)(y.prototype,{addGlobalListener:function(e){E.a.getBoxReady().then(function(){T.a.initViewerAPI_1_4(this),this._getViewer().getInputManager().setEnable(M.a.SCENE_VIEWERAPI_1_4,!0)}.bind(this)),this._replayEmitter.subscribe(e)},onCursorUp:function(){var e=A.vec2.create();return function(t){var n=this._startDrag&&A.vec2.dist(A.vec2.set(e,t.glX,t.glY),this._startCoord)>5;this._startDrag=!1,n||c.a.prototype.onCursorUp.call(this,t)}}(),onCursorDown:function(e){A.vec2.set(this._startCoord,e.glX,e.glY),this._startDrag=!0},getFov:function(e){e(null,this._getFeatureModel("camera").get("fov"))},setCurrentAnimationByUID:function(e,t){l.a.prototype.setCurrentAnimationByUID.apply(this,arguments),m.a.redrawShadow(),t(null)},setLight:function(e,t,n){var i=this._getFeatureModel("lighting").get("lights")[e];t&&(void 0!==t.matrix&&i.set("matrix",t.matrix),void 0!==t.enabled&&i.set("enable",t.enabled),void 0!==t.type&&i.set("type",t.type),void 0!==t.shadowEnabled&&i.set("castShadows",t.shadowEnabled),void 0!==t.color&&i.set("color",t.color),void 0!==t.intensity&&i.set("intensity",t.intensity)),m.a.redrawShadow(),n(null)},getLight:function(e,t){var n=this._getFeatureModel("lighting").get("lights");(!n||e>=n.length)&&t("light with id "+e.toString()+" not found");var i=n[e];t(null,{matrix:i.get("matrix"),enabled:i.get("enable"),shadowEnabled:i.get("castshadows"),color:i.get("color"),intensity:i.get("intensity")})},setEnvironment:function(e,t){var n=this._getFeatureModel("environment");e&&(void 0!==e.enabled&&n.set("enable",e.enabled),void 0!==e.exposure&&n.set("exposure",e.exposure),void 0!==e.lightIntensity&&n.set("lightIntensity",e.lightIntensity),void 0!==e.rotation&&n.set("rotation",e.rotation),void 0!==e.shadowEnabled&&n.set("shadowEnable",e.shadowEnabled)),m.a.redrawShadow(),t(null)},getEnvironment:function(e){var t=this._getFeatureModel("environment");e(null,{enabled:t.get("enable"),exposure:t.get("exposure"),lightIntensity:t.get("lightIntensity"),rotation:t.get("rotation"),shadowEnabled:t.get("shadowEnable")})},setShadingStyle:function(e,t,n){var i=this._getFeatureModel("shadingStyle");try{i.set("renderer",e),t&&t.type&&i.set("type",t.type)}catch(e){return n(null)}m.a.redrawShadow(),n(null)},getShadingStyle:function(e){var t=this._getFeatureModel("shadingStyle");e(null,{shadingStyle:t.get("renderer"),type:t.get("type")})},setWireframe:function(e,t,n){var i=this._getFeatureModel("shadingStyle");try{i.set("wireframeEnable",e),t&&t.color&&i.set("wireframeColor",t.color)}catch(e){return n(null)}m.a.redrawShadow(),n(null)},getWireframe:function(e){var t=this._getFeatureModel("shadingStyle");e(null,{enabled:t.get("wireframeEnable"),color:t.get("wireframeColor")})},_getHitNodeID:function(e){if(e&&e._nodePath&&e._nodePath.length){var t=e._nodePath[e._nodePath.length-1];if(t)return t._uniqueID}},getRootMatrixNode:function(e){var t=this._getViewer().getRootModel();if(t||e("No scene loaded"),!this._nodeInTheMiddle){var n=this._sceneGraphVisitor;n.reset(),this._getViewer().getRootModel().accept(n);var i=0,r=n.getRepresentationNodeMap();for(var a in r){var o=parseInt(a,10);i=i>o?i:o}i++,this._nodeInTheMiddle=new A.MatrixTransform,this._nodeInTheMiddle.setName("NITM"),this._nodeInTheMiddle._uniqueID=i;for(var s=t.getChildren(),u=0,l=s.length;u<l;u++)this._nodeInTheMiddle.addChild(s[u]);t.removeChildren(),t.addChild(this._nodeInTheMiddle),n.reset(),this._getViewer().getRootModel().accept(n)}e(null,this._nodeInTheMiddle._uniqueID,this._nodeInTheMiddle.getMatrix())}});var R=O,P=h.a.osg,I=function(){w.apply(this,arguments)};P.createPrototypeObject(I,P.objectInherit(w.prototype,{setApiCore:function(e){this._apicore=e},createNodeEntry:function(e){this._dirty=!1;var t=e._uniqueID;this._nodeList[t]||(this._nodeList[t]=e);var n=this._apicore._getFeatureModel("material").findFirstMaterial(this.nodePath),i={name:e.getName(),instanceID:t,nodeMask:e.getNodeMask(),materialID:n?n.getJSON().id:null};return this._nodeMap[t]||(this._nodeMap[t]=i),i}}));var N=I,L=function(){this.actions=[],this.startedAt=0,this.recording=!1};L.prototype={addCamera:function(e){if(this.recording){if(this.lastCamera){var t=this.lastCamera;if(t&&t.position[0]===e.position[0]&&t.position[1]===e.position[1]&&t.position[2]===e.position[2]&&t.target[0]===e.target[0]&&t.target[1]===e.target[1]&&t.target[2]===e.target[2])return}this.lastCamera=e,e.type="camera",void 0===e.timeStamp&&(e.timeStamp=this.timeElapsed()),this.actions.push(e)}},addInputEvent:function(e,t){this.recording&&(t.type=e,t.timeStamp=this.timeElapsed(),this.actions.push(t))},start:function(){this.recording||(this.actions=[],this.startedAt=window.performance.now(),this.recording=!0)},stop:function(){this.recording=!1;for(var e=this.actions.length,t=new Float32Array(8*e),n=0,i=0;i<e;i++){var r=this.actions[i];switch(r.type){case"camera":t[n++]=r.timeStamp,t[n++]=1,t[n++]=r.position[0],t[n++]=r.position[1],t[n++]=r.position[2],t[n++]=r.target[0],t[n++]=r.target[1],t[n++]=r.target[2];break;case"click":t[n++]=r.timeStamp,t[n++]=2,t[n++]=r.clientX,t[n++]=r.clientY,t[n++]=r.ctrlKey,t[n++]=r.shiftKey,t[n++]=r.altKey,n++;break;case"wheel":t[n++]=r.timeStamp,t[n++]=3,t[n++]=r.clientX,t[n++]=r.clientY,t[n++]=r.ctrlKey,t[n++]=r.shiftKey,t[n++]=r.altKey,n++;break;case"mousemove":t[n++]=r.timeStamp,t[n++]=4,t[n++]=r.clientX,t[n++]=r.clientY,t[n++]=r.ctrlKey,t[n++]=r.shiftKey,t[n++]=r.altKey,n++;break;case"mousedown":t[n++]=r.timeStamp,t[n++]=5,t[n++]=r.clientX,t[n++]=r.clientY,t[n++]=r.ctrlKey,t[n++]=r.shiftKey,t[n++]=r.altKey,n++;break;case"mouseup":t[n++]=r.timeStamp,t[n++]=6,t[n++]=r.clientX,t[n++]=r.clientY,t[n++]=r.ctrlKey,t[n++]=r.shiftKey,t[n++]=r.altKey,n++;break;case"dblclick":t[n++]=r.timeStamp,t[n++]=7,t[n++]=r.clientX,t[n++]=r.clientY,t[n++]=r.ctrlKey,t[n++]=r.shiftKey,t[n++]=r.altKey,n++}}return this.actions=[],t.slice(0,n)},timeElapsed:function(){return window.performance.now()-this.startedAt}};var k=L,D=function(){R.apply(this,arguments),this._sceneGraphVisitor=new N,this._sceneGraphVisitor.setApiCore(this)};D.prototype=Object(p.a)(R.prototype,{setAnnotationsTexture:function(e,t){this._getFeatureModel("hotspot").set("textureOptions",e),m.a.redrawShadow(),t(null)},gotoAnnotation:function(e,t,n){var i=this._getFeatureModel("hotspot").get("hotspots"),r=i.at(e);if(!r)return i.trigger("select",r),void n(null,e);r.set("cameraPreventAnimation",t.preventCameraAnimation),r.set("cameraPreventMove",t.preventCameraMove),i.trigger("select",r),r.set("cameraPreventAnimation",!1),r.set("cameraPreventMove",!1),n(null,e)},_convertVideoDataUriToImage:function(e,t,n,i){var r=this._getFeatureModel("material").getImageCollection();f.default.instance.getOrCreateImage(e).promise.then(function(a){var o=r.addNewImage({uid:t,url:e,width:a.getWidth(),height:a.getHeight(),name:e.slice(0,100)});if(a.getImage&&n){var s=a.getImage();void 0!==n.loop&&(s.loop=n.loop),void 0!==n.mute&&(s.mute=n.mute)}i(null,o.getUID())}).catch(function(){i("failed to add texture")})},addVideoTexture:function(e,t,n){this._convertVideoDataUriToImage(e,void 0,t,n)},setBackground:function(e,t){var n=this._getFeatureModel("background");e.uid?(n.set("enable","fixed"),n.set("uid",e.uid)):e.color?(n.set("enable","color"),n.set("color",e.color)):e.enable?n.set("enable",e.enable):e.transparent&&n.set("enable","none"),t(null)},_getUserCollectionList:function(e,t){var n=new XMLHttpRequest;n.open("GET","https://api.sketchfab.com/v3/me/"+t,!0),n.responseType="json",n.onload=function(){if(4===n.readyState&&200===n.status){var t=n.response,i=[];for(var r in t.results){var a=t.results[r];a&&a.uid&&i.push({name:a.name,uid:a.uid})}e(i)}},n.onerror=function(){e(null)},n.send(null)},getBackgroundList:function(e){this._getUserCollectionList(e,"backgrounds")},setEnvironment:function(e,t){var n=this._getFeatureModel("environment");e&&(void 0!==e.enabled&&n.set("enable",e.enabled),void 0!==e.exposure&&n.set("exposure",e.exposure),void 0!==e.lightIntensity&&n.set("lightIntensity",e.lightIntensity),void 0!==e.rotation&&n.set("rotation",e.rotation),void 0!==e.shadowEnabled&&n.set("shadowEnable",e.shadowEnabled),void 0!==e.blur&&n.set("blur",e.blur),void 0!==e.uid&&n.set("uid",e.uid)),m.a.redrawShadow(),t(null)},getEnvironmentList:function(e){this._getUserCollectionList(e,"environments")},setCycleMode:function(e,t){var n,i=this._getFeatureModel("animation");switch(e){case"loopOne":n="one";break;case"loopAll":n="all";break;case"one":n="oneAndStop";break;case"all":n="";break;default:n=e}i.set("cycleMode",n),m.a.redrawShadow(),t(null)},_emitEvents:function(){var e={viewerready:"viewerready",started:"viewerstart",stopped:"viewerstop",animationChange:"animationChange",animationEnded:"animationEnded",animationPlay:"animationPlay",animationStop:"animationStop",annotationFocus:"annotationFocus",annotationBlur:"annotationBlur",annotationMouseEnter:"annotationMouseEnter",annotationMouseLeave:"annotationMouseLeave",annotationSelect:"annotationSelect",nodeMouseEnter:"nodeMouseEnter",nodeMouseLeave:"nodeMouseLeave",click:"click",cameraStart:"camerastart",cameraStop:"camerastop"},t=function(t,n){var i=e[t];i&&this._replayEmitter.emit(i,n)}.bind(this);this._partial.on("all",t),this._partial.scene.on("all",t),this._emitEvents=function(){}},_userProvidedEventDispatch:function(e,t,n){if(this.actionsRecorder&&this.actionsRecorder.addInputEvent(e,n),!this._getViewer()||!this._getViewer().getFeaturesManager())return!0;var i=!this._getViewer().getFeaturesManager().getCanvas().dispatchEvent(t);return m.a.redrawShadow(),i},_userProvidedMouseEventDispatch:function(e,t){var n=new MouseEvent(e,{view:window,bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey});return this._userProvidedEventDispatch(e,n,t)},mouseMove:function(e,t){t(this._userProvidedMouseEventDispatch("mousemove",e))},mouseDown:function(e,t){t(this._userProvidedMouseEventDispatch("mousedown",e))},mouseUp:function(e,t){t(this._userProvidedMouseEventDispatch("mouseup",e))},mouseClick:function(e,t){t(this._userProvidedMouseEventDispatch("mouseup",e))},mouseDblClick:function(e,t){t(this._userProvidedMouseEventDispatch("dblclick",e))},mouseWheel:function(e,t){var n=new WheelEvent("wheel",{view:window,bubbles:!0,cancelable:!0,deltaX:e.deltaX,deltaY:e.deltaY});t(this._userProvidedEventDispatch("wheel",n,e))},_getCameraInfo:function(){var e={target:[],position:[]};return this.manipulator.getTarget(e.target),this.manipulator.getEyePosition(e.position),e},_cameraRecord:function(){if(this.actionsRecorder){var e=this._getCameraInfo();this.actionsRecorder.addCamera(e),requestAnimationFrame(this._cameraRecordBinding)}},startRecord:function(e){this.actionsRecorder=new k,this.manipulator=this._getViewerOSG().getManipulator();var t=this._getCameraInfo();this.actionsRecorder.start(),t.timeStamp=0,this.actionsRecorder.addCamera(t),this._cameraRecordBinding=this._cameraRecord.bind(this),requestAnimationFrame(this._cameraRecordBinding),e("recording started")},endRecord:function(e){var t=this._getCameraInfo();this.actionsRecorder.addCamera(t),e(this.actionsRecorder.stop()),this.actionsRecorder=void 0}});var F=D,V=function(){F.apply(this,arguments)};V.prototype=Object(p.a)(F.prototype,{hideAnnotationTooltip:function(e){this._getFeatureModel("hotspot").get("proxyModel").set("annotationsVisible",!1),e(null)},showAnnotationTooltip:function(e){this._getFeatureModel("hotspot").get("proxyModel").set("annotationsVisible",!0),e(null)},setCameraConstraints:function(e,t){var n=this._getFeatureModel("camera"),i=n.setJSON(e,{validate:!0});n.trigger("change:enableCameraConstraints"),n.set("viewer-api-hotspots",!0),t(i)},setEnableCameraConstraints:function(e,t){this._getFeatureModel("camera").set("enableCameraConstraints",e),t(null)},setAnnotationCameraTransition:function(e,t,n){this._getFeatureModel("hotspot").preventHotspotCameraAction(e,t),n(null)},getAnimations:function(e){var t=this._getFeatureModel("animation").get("animations");if(!t.length)return e(null,[]);var n=new Array(t.length);return t.forEach(function(e){var t=[];t.push(e.get("uid")),t.push(e.get("name")),t.push(e.get("duration")),t.push(e.get("order")),n[e.get("order")]=t}),e(null,n)},_initializeAnnotationMarkdown:function(e,t,n,i,r,a,o){v.b.getMarkdownPreview(a).then(function(s){t.set({name:r,content:{raw:a,rendered:s.result},eye:n,target:i}),m.a.redrawShadow(),o(null,e.get("hotspots").length-1),m.a.draw()},function(){t.set({name:r,eye:n,target:i}),m.a.redrawShadow(),o(null,e.get("hotspots").length-1),m.a.draw()}.bind(this))},createAnnotationFromWorldPosition:function(e,t,n,i,r,a){var o=this._getFeatureModel("hotspot"),s=o.createHotspotFromWorldPosition(e,!0);this._initializeAnnotationMarkdown(o,s,t,n,i,r,a)},createAnnotationFromScenePosition:function(e,t,n,i,r,a){var o=this._getFeatureModel("hotspot"),s=o.createHotspotFromScenePosition(e,!0);this._initializeAnnotationMarkdown(o,s,t,n,i,r,a)},removeAllAnnotations:function(e){for(var t=this._getFeatureModel("hotspot").get("hotspots");t.length>0;)t.remove(t.at(0));m.a.redrawShadow(),e(null)},recenterCamera:function(e){this._getViewerOSG().getManipulator().computeHomePosition(),e(null)},setUserInteraction:function(e,t){this._getViewer().getInputManager().setEnable(M.a.SCENE,e),t(null)}});var B=V,U=function(){B.apply(this,arguments)};U.prototype=Object(p.a)(B.prototype,{setUVOffset:function(e,t,n,i,r){this._getFeatureModel("material").setUVOffset(e.stateSetID,t,n,i),r(null)},setUVRotation:function(e,t,n,i){this._getFeatureModel("material").setUVRotation(e.stateSetID,t,n),i(null)},setUVScale:function(e,t,n,i,r){this._getFeatureModel("material").setUVScale(e.stateSetID,t,n,i),r(null)},refreshDraw:function(){m.a.redrawShadow(),m.a.requestDrawHiddenDefered()},refreshCanvas:function(){var e=this._getViewer().getCanvas(),t=e.width;e.width=t+1,new s.a(function(e){e()}).finally(function(){e.width=t})},setHighlightOptions:function(e){var t=this._getFeatureModel("outline");void 0!==e.outlineWidth&&t.set("outlineWidth",e.outlineWidth),void 0!==e.outlineColor&&t.set("colorSelection",e.outlineColor),void 0!==e.highlightColor&&t.set("colorHover",e.highlightColor),void 0!==e.outlineDuration&&t.set("durationOutline",e.outlineDuration),void 0!==e.highlightDuration&&t.set("durationHighlight",e.highlightDuration)},highlightMaterial:function(e){var t=this._getFeatureModel("outline");if(void 0===e||null===e)return t.trigger("hideOutline"),void t.trigger("hideHighlight");var n=this._getFeatureModel("material"),i=e.stateSetID,r=n.getMaterialByStateSetID(i);t.trigger("displayOutlineNoFocus",r.get("stateSet"))},setEnableCameraConstraints:function(e,t){var n=this._getFeatureModel("camera");n.set("enableCameraConstraints",e),n.set("useCameraConstraints",e),t(null)}});var j=U,G=n("JoeM"),H=n("fgaA"),z=n("dZz+"),W={APICore1_0:l.a,APICore1_2:c.a,APICore1_3:y,APICore1_4:R,APICore1_5:F,APICore1_6:B,APICore1_7:j},q=function(e){this._definitions={},this._instance=void 0,this._instanceId=e,this._name=void 0,this._parentDomain=this.getMessageTargetDomain(document.referrer),this._defer=new i.a};q.create=function(e,t,n,i){var r;if(t){var o=t;r=new q(e);var s=a.a[t];if(!s){var l=Object.keys(a.a),c=l[l.length-1];s=a.a[c],console.warn("you requested api version "+t+" but this version is not available. Returned api version "+c+" instead"),o=c}var h=function(e,t){return new W[e](t)}("APICore"+s.ApiCoreVersion,n);r.register(o,s,h)}else(r=new u).initialize(n,i),console.warn("you are using a deprecated api, please update to the new one, read mode xxxx");return r},q.prototype={ready:function(){if(window.parent){var e=Object(H.a)().apiHookEnv;if(void 0!==e)if(z.a.me().get("isStaff")){var t=new XMLHttpRequest,n=function(e){if(t.readyState===XMLHttpRequest.DONE){var n=JSON.parse(e.target.response);if(n.domain){var i=n.domain;if(i===window.location.hostname);else{var r={type:"api.ready",instanceId:this._instanceId,results:[this._instanceId],options:{domain:i}};window.parent.postMessage(r,this._parentDomain)}}}}.bind(this);t.addEventListener("load",n),t.open("GET","/i/users/viewer-api/authorized-domains?domain="+e);var i=document.cookie.match(new RegExp("sb_csrftoken=([^;]+)"));i||console.error("CRSF cookie missing");var r=i[1];t.setRequestHeader("X-CSRFToken",r),t.send()}var a={type:"api.ready",instanceId:this._instanceId,results:[this._instanceId]};Object(G.a)()||(a.error="No Hardware Support for Webgl"),window.parent.postMessage(a,this._parentDomain)}},clientReady:function(){return this._defer.promise},register:function(e,t,n){this._name=e,this._members=Object.keys(t),this._membersMapping=t,this._instance=n,this.init()},getViewerAPI:function(){return this._instance},getMessageTargetDomain:function(e){if(!e||!e.length)return"*";var t=e.split("//");return t[0]+"//"+t[1].split("/")[0]},init:function(){this._defer.resolve();var e=["api.initialize","api.request"],t=Object.getPrototypeOf(this._instance);window.addEventListener("message",function(n){if((n.origin===this._parentDomain||"*"===this._parentDomain)&&n.data&&n.data.type){var i=n.data.type;if(-1!==e.indexOf(i)){var r="api.initialize"!==i;if(!r||n.data.instanceId&&n.data.instanceId===this._instanceId)try{if(r&&this._instanceId!==n.data.instanceId)throw"Invalid request : instance does not exists";if("api.request"===n.data.type){var a=this._membersMapping[n.data.member];if("-"===a&&(a=n.data.member),!a||!t[a])throw"Invalid request : member function does not exists: "+a;if("function"!=typeof t[a])throw"Invalid request : member function does not exists: "+a;for(var o=t[a],s=n.data.arguments.slice(),u=s.length-1;u>=0&&void 0===s[u];u--)s.splice(u,1);return o.length&&"function"==typeof s[o.length-1]&&(s.length=o.length-1),s.push(function(){n.source.postMessage({type:"api.request.result",instanceId:this._instanceId,requestId:n.data.requestId,results:Array.prototype.slice.call(arguments)},this._parentDomain)}.bind(this)),void o.apply(this._instance,s)}if("api.initialize"===n.data.type){if(this._name!==n.data.name)throw"No API named '"+n.data.name+"'";var l=this._members,c=this._instance;if(void 0!==c.addGlobalListener){var h=function(){var e={type:"api.event",instanceId:this._instanceId,results:Array.prototype.slice.call(arguments)};n.source.postMessage(e,this._parentDomain)}.bind(this);c.addGlobalListener(h)}return void n.source.postMessage({type:"api.initialize.result",instanceId:this._instanceId,requestId:n.data.requestId,results:[null,this._instanceId,l]},this._parentDomain)}}catch(e){console.error(e),n.source.postMessage({type:i+".result",instanceId:this._instanceId,requestId:n.data.requestId,results:[e.stack?e.stack:e]},this._parentDomain)}}}}.bind(this))}};t.a=q},Usex:function(e,t,n){"use strict";var i=n("Y6Ma"),r=[function(e,t,n,i,r){e.applyModelViewMatrix(t,n),e.applyProjectionMatrix(r)},function(e,t,n,i,r){var a=e.getGraphicContext(),o=e.applyModelViewMatrix(t,n);if(e.applyProjectionMatrix(r),o){var s=e._modelMatrix;s.setMatrix4(n),s.apply(a,this.modelUniform)}},function(e,t,n,i,r){var a=e.getGraphicContext(),o=e.applyModelViewMatrix(t,n);if(e.applyProjectionMatrix(r),o){var s=e._viewMatrix;s.setMatrix4(i),s.apply(a,this.viewUniform)}},function(e,t,n,i,r){var a=e.getGraphicContext(),o=e.applyModelViewMatrix(t,n);if(e.applyProjectionMatrix(r),o){var s=e._modelMatrix;s.setMatrix4(n),s.apply(a,this.modelUniform);var u=e._viewMatrix;u.setMatrix4(i),u.apply(a,this.viewUniform)}}],a=function(){this._parent=void 0,this._geometry=void 0,this._depth=0,this._projection=void 0,this._view=void 0,this._model=void 0,this._modelView=void 0};a.prototype={reset:function(){this._parent=void 0,this._geometry=void 0,this._depth=0,this._projection=void 0,this._view=void 0,this._model=void 0,this._modelView=void 0},init:function(e,t,n,i,r,a,o){this._parent=e,this._geometry=t,this._depth=o,this._projection=n,this._view=i,this._model=a,this._modelView=r},drawGeometry:function(e){var t=e.getLastProgramApplied(),n=t.getInstanceID(),i=e.getCacheUniformsApplyRenderLeaf(),a=i[n];a||(a=new function(e,t){this.modelUniform=t._uniformsCache[e._modelMatrix.getName()],this.viewUniform=t._uniformsCache[e._viewMatrix.getName()];var n=0;this.modelUniform&&(n=1),this.viewUniform&&(n|=2),this.apply=r[n]}(e,t),i[n]=a),a.apply(e,this._modelView,this._model,this._view,this._projection),this._geometry.drawImplementation(e)},render:function(){var e=0,t=-1;return function(n,r){var a,o,s=this._parent,u=s._parent,l=s._stateset;void 0!==r?(o=(a=r._parent)._parent)!==u?(i.a.moveStateGraph(n,o,u),n.applyStateSet(l)):s!==a?n.applyStateSet(l):n._stateSetStackChanged(e,t)&&n.applyStateSet(l):(i.a.moveStateGraph(n,void 0,u),n.applyStateSet(l)),n._setStateSetsDrawID(++e),t=n.getStateSetStackSize(),this.drawGeometry(n)}}()},t.a=a},UwbM:function(e,t,n){"use strict";n.r(t);var i=n("a3nb"),r=n("62xh"),a=n("zB1R"),o=n("qRO0"),s=n("05ve"),u=n("xVfI"),l=n("Y6Ma"),c=n("czSk"),h=n("nplI"),d=n("ff9x"),f=function(e){o.a.call(this),this._state=void 0,this._camera=e,this._renderStage=void 0,this._stateGraph=void 0,this._frameStamp=void 0,this._previousCullsettings=new r.a,this.setDefaults()};f.debugGraph=!1,i.a.createPrototypeObject(f,i.a.objectInherit(o.a.prototype,{setDefaults:function(){this._state=new u.a(new h.a.ShaderGeneratorProxy),this._cullVisitor=new a.a,this._cullVisitor.setRenderer(this),this._stateGraph=new l.a,this.getCamera().setClearColor(c.g.create()),this.setRenderStage(new s.a);var e=n("5mbm").default,t=this.getCamera().getOrCreateStateSet();t.setAttributeAndModes(new e.Material),t.setAttributeAndModes(new e.Depth),t.setAttributeAndModes(new e.BlendFunc),t.setAttributeAndModes(new e.CullFace)},getCullVisitor:function(){return this._cullVisitor},setCullVisitor:function(e){e&&!e.getRenderer()&&e.setRenderer(this),this._cullVisitor=e},setRenderStage:function(e){this._renderStage=e},getCamera:function(){return this._camera},setFrameStamp:function(e){this._frameStamp=e},getFrameStamp:function(){return this._frameStamp},getState:function(){return this._state},setState:function(e){this._state=e},setGraphicContext:function(e){this._state.setGraphicContext(e)},getGraphicContext:function(){return this._state.getGraphicContext()},cullAndDraw:function(){this.cull(),this.draw()},cull:function(){var e=this.getCamera(),t=e.getView();this._cullVisitor.setFrameStamp(this._frameStamp),this._cullVisitor.resetStats(),l.a.reset(),this._stateGraph.clean(),this._renderStage.reset(),this._cullVisitor.reset(),this._cullVisitor.setStateGraph(this._stateGraph),this._cullVisitor.setRenderStage(this._renderStage),this._cullVisitor.pushStateSet(e.getStateSet()),this._previousCullsettings.reset(),this._previousCullsettings.setCullSettings(this._cullVisitor),this._cullVisitor.setCullSettings(e),this._previousCullsettings.getSettingSourceOverrider()===this._cullVisitor&&this._previousCullsettings.getEnableFrustumCulling()&&this._cullVisitor.setEnableFrustumCulling(!0),this._cullVisitor.pushCameraModelViewProjectionMatrix(e,e.getViewMatrix(),e.getProjectionMatrix()),e.getBound();var i=t.getLight(),r=n("Gc7n").default;if(i)switch(t.getLightingMode()){case r.LightingMode.HEADLIGHT:this._cullVisitor.addPositionedAttribute(null,i);break;case r.LightingMode.SKY_LIGHT:this._cullVisitor.addPositionedAttribute(e.getViewMatrix(),i)}var a=e.getViewport(),o=e.getScissor();this._cullVisitor.pushViewport(a),this._renderStage.setClearDepth(e.getClearDepth()),this._renderStage.setClearColor(e.getClearColor()),this._renderStage.setClearMask(e.getClearMask()),this._renderStage.setViewport(a),this._renderStage.setScissor(o),this._cullVisitor.setDatabaseRequestHandler(this._camera.getView().getDatabasePager()),this._cullVisitor.handleCullCallbacksAndTraverse(e),this._cullVisitor.popCameraModelViewProjectionMatrix(e),this._cullVisitor.setCullSettings(this._previousCullsettings),this._cullVisitor.popViewport(),this._cullVisitor.popStateSet(),this._renderStage.sort()},draw:function(){var e=this.getState();e.resetCacheFrame(),e.resetStats(),this._renderStage.setCamera(this._camera),this._renderStage.draw(e),f.debugGraph&&(d.a.instance().createRenderGraph(this._renderStage),f.debugGraph=!1),this._renderStage.setCamera(void 0),e.applyDefault()}}),"osgViewer","Renderer"),t.default=f},V02I:function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("J4zp"),o=n.n(a),s=n("q1tI"),u=n("/MKj"),l=n("UXvI"),c=n("wsGC"),h=n("cQ/I"),d=n("M4AY"),f=n("ei2W"),p=s.lazy(function(){return Promise.all([n.e(60),n.e(146)]).then(n.bind(null,"mSf5"))}),g=Object(u.c)(function(e){return{isOpen:d.c.search.isOpen(e)}}),m=r()("div",{className:"spinner initial-spinner"});var v=s.memo(g(function(e){var t=e.isOpen,n=s.useRef(null);return s.useEffect(function(){document.body.classList.toggle("--prevent-scroll",t)},[t]),t?s.createElement("div",{ref:n,className:Object(c.a)("c-search-overlay",{visible:t})},r()(f.a,{},void 0,function(){return t?r()(s.Suspense,{fallback:m},void 0,r()(p,{isStandaloneSearch:!1,parentElement:n.current})):null})):null})),_=n("8/dv"),b=n("5bbf"),S=Object(u.c)(function(e){return{authUser:d.c.authUser.user(e),isSearchOpen:d.c.search.isOpen(e),categories:d.c.entities.allCategories(e)}}),y=r()(v,{}),x=r()(_.a,{});t.a=S(function(e){var t=e.authUser,n=e.isSearchOpen,i=e.children,a=e.isTransparent,u=e.categories,d=s.useState(!1),p=o()(d,2),g=p[0],m=p[1],v=s.useRef(window),S=s.useRef(g);s.useEffect(function(){S.current=g},[g]),Object(h.a)(v,"scroll",Object(l.a)(function(){var e=window.scrollY>50;S.current!==e&&m(e)},100),{passive:!0});var C=!a||g||n?"light":"transparent";return r()(_.b,{},void 0,r()(b.a.Provider,{value:C},void 0,r()("header",{className:Object(c.a)("c-page-header","responsive-navigation-slidable",{"--searching":n,"--scroll":g,"--transparent":"transparent"===C})},void 0,r()("div",{className:Object(c.a)("c-page-header__flex-container","container","--fullscreen")},void 0,i({theme:C,authUser:t,isSearchOpen:n,categories:u}))),y,r()(f.a,{},void 0,function(){return x})))})},V5OH:function(e,t,n){"use strict";(function(e){var i=n("EVdn"),r=n.n(i),a=n("hbEN"),o=n("MG+9"),s=n("vBtE"),u=n("QKgc"),l=n("RzKY"),c=n("uPP5"),h=n("oR1v"),d=n("f5KD"),f=n("xM9Z"),p=n("wsGC"),g=[];t.a=s.a.extend({parent:"body",el:'<div data-element="popup" />',optionTypes:{cleanOnClose:d.b.bool,shouldExitOnClickOutside:d.b.bool,shouldExitOnEscape:d.b.bool,shouldRejectOnCancel:d.b.bool,marginTop:d.b.number},defaultOptions:{cleanOnClose:!0,shouldExitOnClickOutside:!0,shouldExitOnEscape:!0,shouldRejectOnCancel:!1,marginTop:40},events:{"click .popup-container":"onClickOutside",'click [data-action="close"]':"cancel","click button:not([type])":h.f},constructor:function(){this.onKeyDown=this.onKeyDown.bind(this),this.debouncedCenter=Object(a.a)(this.center,50),this.resizeHandler=function(){r.a.each(g,function(e,t){t.setHeightForMobileResolution(),t.debouncedCenter()})}.bind(this),s.a.apply(this,arguments)},initialize:function(){s.a.prototype.initialize.apply(this,arguments),this.renderLayout()},setElement:function(){return s.a.prototype.setElement.apply(this,arguments),this.$container=this.$(".popup-container"),this},delegateEvents:function(){s.a.prototype.delegateEvents.apply(this,arguments),r()(window).on("resize",this.resizeHandler),document.addEventListener("keydown",this.onKeyDown,!0)},undelegateEvents:function(){s.a.prototype.undelegateEvents.apply(this,arguments),r()(window).off("resize",this.resizeHandler),document.removeEventListener("keydown",this.onKeyDown,!0)},getPromise:function(){return this._promise||(this._promise=new c.a),this._promise},open:function(){return-1!==g.indexOf(this)?(this.show(),this.setElement(this.$el),this.getPromise()):(this.render(),g.unshift(this),r()(Object(o.a)(this,"parent")).append(this.$el),this.setElement(this.$el),this.hide(),this.setHeightForMobileResolution(),this.center(),window.requestAnimationFrame(function(){this.show()}.bind(this)),this.autofocus(),this.center(),this.getPromise())},show:function(){this.$container.removeClass("hidden"),document.body.classList.add("--prevent-scroll")},hide:function(){this.$container.addClass("hidden"),g.filter(function(e){return!e.isHidden()}).length||document.body.classList.remove("--prevent-scroll")},setIsLoading:function(e){this.$container.toggleClass("popup-loading",e)},isHidden:function(){return this.$container.hasClass("hidden")},onKeyDown:function(e){27===e.keyCode&&this.options.shouldExitOnEscape&&0!==g.length&&g[0]===this&&this.cancel()},onClickOutside:function(e){e.target===e.currentTarget&&this.options.shouldExitOnClickOutside&&this.cancel()},cancel:function(e){return this._close(),this.options.shouldRejectOnCancel?this.getPromise().reject(new u.j(e)):this.getPromise().resolve()},continue:function(e){return this._close(),this.getPromise().resolve(e)},_close:function(t,n){return-1===g.indexOf(this)?this:this.$container.closest(".inline-popup").length>0?this:this.options.cleanOnClose||n?(-1!==g.indexOf(this)&&g.splice(g.indexOf(this),1),this.hide(),Object(l.i)(500,Object(f.a)(this.$el)).catch(function(){}).then(this.remove.bind(this))):(this.hide(),e.resolve())},close:function(e){return this._close(null,e)},replaceWith:function(e,t){return this.close(t),e.open()},setHeightForMobileResolution:function(){var e=this.$(".js-popup");Object(p.d)({width:window.innerWidth,breakpoint:"breakpointXSmall"})?e.css({height:window.innerHeight}):e[0]&&"auto"!==e[0].style.height&&e.css({height:"auto"})},center:function(){var e=this.$(".js-popup"),t=r()(window).width(),n=r()(window).height(),i=e.height(),a=e.width(),o=(t-a)/2,s=this.options.marginTop,u=n/2-i/2+(i<n?0:(i-n)/2+s);e.css({position:"absolute",left:"".concat(o,"px"),top:u});var l=o+a/2+"px"+" "+(u+i/2+"px");this.$container.css({perspectiveOrigin:l})},resize:function(e){var t=this.$(".js-popup");e.width&&t.width(e.width),e.height&&t.height(e.height)},autofocus:function(){var e=window.scrollX,t=window.scrollY;this.$(".form-input:visible").length>0?(this.$(".form-input").eq(0).focus(),window.scrollTo(e,t)):(this.$(".btn-primary, .submit").focus(),window.scrollTo(e,t))},_removeElement:function(){this.$el.remove()},remove:function(){return this.undelegateEvents(),s.a.prototype.remove.apply(this,arguments)},renderLayout:function(){this.$el.html(this.template()),this.$container=this.$(".popup-container")},afterRender:function(){s.a.prototype.afterRender.apply(this,arguments),this.renderChildren(),this.center()}})}).call(this,n("CSL1"))},VThJ:function(e,t){e.exports="uniform sampler2D TextureInput;\n\n#ifdef COLOR_WITH_COC\nuniform sampler2D TextureDofCoC;\n#endif\n\nvec4 dofDownsampleColor() {\n    vec2 uv = gTexCoord;\n\n    vec4 color = TEXTURE_2D_NEAREST_TextureInput(uv);\n\n// premult with coc buffer\n#ifdef COLOR_WITH_COC\n    color.a = abs(TEXTURE_2D_TextureDofCoC(uv).a * 2.0 - 1.0);\n    color.a *= color.a * color.a;\n    color.rgb *= color.a;\n#endif\n\n    return color;\n}"},ViC5:function(e,t,n){"use strict";var i=n("9mpE");t.a=function(e,t){if(window.parent){var n={type:"api.ready",instanceId:i.c.string("api_id",void 0),error:e,httpStatus:t};window.parent.postMessage(n,function(e){if(!e||!e.length)return"*";var t=e.split("//");return t[0]+"//"+t[1].split("/")[0]}(document.referrer))}}},Vq6u:function(e,t){e.exports="uniform vec2 uNearFar;\nuniform mat4 uProjectionMatrix;\nuniform mat4 uModelViewMatrix;\n\nuniform vec3 uStartPos;\nuniform vec3 uEndPos;\n\n#ifdef IS_IOS\ninvariant gl_Position;\n#endif\nattribute float BoneIndex;\n\nvoid main() {\n\n    vec3 localVertex = uStartPos * (1.0 - BoneIndex) + uEndPos * BoneIndex;\n    vec4 viewVertex = uModelViewMatrix * vec4(localVertex, 1.0);\n    gl_Position = uProjectionMatrix * viewVertex;\n    gl_Position.z = -uNearFar.x;\n\n}\n"},Vx0a:function(e,t,n){"use strict";var i=n("a3nb"),r=n("qRO0"),a=n("XKim"),o=n("6JLc"),s=n("vQSd"),u=n("r7P/"),l=n("czSk"),c=n("EnLC"),h=n("zWCM"),d=n("LTZp"),f=function(){r.a.call(this),this.children=[],this._parents=[],this.nodeMask=-1,this._boundingSphere=new o.a,this._boundingSphereComputed=!1,this._boundingBox=new a.a,this._boundingBoxComputed=!1,this._updateCallbacks=[],this._cullCallback=void 0,this._cullingActive=!0,this._numChildrenWithCullingDisabled=0,this._numChildrenRequiringUpdateTraversal=0,this._tmpBox=new a.a},p=new c.a(l.c.create),g=function(){var e=p.getOrCreateObject();return l.c.identity(e)},m=new o.a;i.a.createPrototypeNode(f,i.a.objectInherit(r.a.prototype,{getMinimumBound:function(){var e=this.getBoundingBox(),t=this.getBoundingSphere();return!e.valid()||t.volume()<e.volume()?t:(m.copyBoundingBox(e),m)},getOrCreateStateSet:function(){return this.stateset||this.setStateSet(new s.a),this.stateset},getStateSet:function(){return this.stateset},accept:function(e){e.validNodeMask(this)&&(e.pushOntoNodePath(this),e.apply(this),e.popFromNodePath())},dirtyBound:function(){if(!0===this._boundingSphereComputed||!0===this._boundingBoxComputed){this._boundingSphereComputed=!1,this._boundingBoxComputed=!1;for(var e=this._parents,t=0,n=e.length;t<n;t++)e[t].dirtyBound()}},setNodeMask:function(e){this.nodeMask=e},getNodeMask:function(){return this.nodeMask},setStateSet:function(e){if(this.stateset!==e){var t=0;this.stateset&&(this.stateset.requiresUpdateTraversal()&&t--,this.stateset.removeParent(this)),e&&(e.addParent(this),e.requiresUpdateTraversal()&&++t),0!==t&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()+t),this.stateset=e}},_updateNumChildrenRequeringUpdateTraversal:function(e){if(0===this._numChildrenRequiringUpdateTraversal&&this._parents.length)for(var t=0,n=this._parents.length;t<n;t++){var i=this._parents[t],r=i.getNumChildrenRequiringUpdateTraversal();i.setNumChildrenRequiringUpdateTraversal(r+e)}},setNumChildrenRequiringUpdateTraversal:function(e){if(this._numChildrenRequiringUpdateTraversal!==e){if(!this._updateCallbacks.length&&this._parents.length){var t=0;if(this._numChildrenRequiringUpdateTraversal>0&&--t,e>0&&++t,0!==t)for(var n=this._parents,i=0,r=n.length;i<r;i++){var a=n[i],o=a.getNumChildrenRequiringUpdateTraversal();a.setNumChildrenRequiringUpdateTraversal(o+t)}}this._numChildrenRequiringUpdateTraversal=e}},getNumChildrenRequiringUpdateTraversal:function(){return this._numChildrenRequiringUpdateTraversal},getUpdateCallback:function(){return this._updateCallbacks[0]},addUpdateCallback:function(e){var t=Boolean(this._updateCallbacks.length);this._updateCallbacks.push(e),t||this._updateNumChildrenRequeringUpdateTraversal(1)},removeUpdateCallback:function(e){var t=this._updateCallbacks.indexOf(e);-1!==t&&(this._updateCallbacks.splice(t,1),this._updateCallbacks.length||this._updateNumChildrenRequeringUpdateTraversal(-1))},getUpdateCallbackList:function(){return this._updateCallbacks},setCullCallback:function(e){this._cullCallback=e},getCullCallback:function(){return this._cullCallback},hasChild:function(e){for(var t=0,n=this.children.length;t<n;t++)if(this.children[t]===e)return!0;return!1},addChild:function(e){if(-1===this.children.indexOf(e))return this.children.push(e),e.addParent(this),this.dirtyBound(),(e.getNumChildrenRequiringUpdateTraversal()>0||e.getUpdateCallbackList().length)&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()+1),(e.getNumChildrenWithCullingDisabled()>0||!1===e.getCullingActive())&&this.setNumChildrenWithCullingDisabled(this.getNumChildrenWithCullingDisabled()+1),e},getChildren:function(){return this.children},getNumChildren:function(){return this.children.length},getChild:function(e){return this.children[e]},getParents:function(){return this._parents},addParent:function(e){this._parents.push(e)},removeParent:function(e){var t=this._parents.indexOf(e);-1!==t&&this._parents.splice(t,1)},removeChildren:function(){var e=this.children,t=e.length;if(t){for(var n=0,i=0;i<t;i++){var r=e[i];r.removeParent(this),(r.getNumChildrenRequiringUpdateTraversal()>0||r.getUpdateCallbackList().length)&&++n}e.length=0,n&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()-n),this.dirtyBound()}},removeChild:function(e){var t=this.children,n=t.indexOf(e);-1!==n&&(e.removeParent(this),t.splice(n,1),this.dirtyBound(),(e.getNumChildrenRequiringUpdateTraversal()>0||e.getUpdateCallbackList().length)&&this.setNumChildrenRequiringUpdateTraversal(this.getNumChildrenRequiringUpdateTraversal()-1))},traverse:function(e){for(var t=this.children,n=0,i=t.length;n<i;n++){t[n].accept(e)}},ascend:function(e){for(var t=this._parents,n=0,i=t.length;n<i;n++){t[n].accept(e)}},getBoundingBox:function(){return this._boundingBoxComputed||(this.computeBoundingBox(this._boundingBox),this._boundingBoxComputed=!0),this._boundingBox},computeBoundingBox:function(e){var t=n("oDhZ").default,i=t.instance=t.instance||new t;return i.setNodeMaskOverride(-1),i.reset(),i.apply(this),e.copy(i.getBoundingBox()),e},getBoundingSphere:function(){return this.getBound()},getBound:function(){return this._boundingSphereComputed||(this.computeBoundingSphere(this._boundingSphere),this._boundingSphereComputed=!0),this._boundingSphere},computeBoundingSphere:function(e){var t,n,i=this.children,r=i.length;if(e.init(),0===r)return e;var a=this._tmpBox;for(a.init(),n=0;n<r;n++)(t=i[n]).referenceFrame!==d.a.ABSOLUTE_RF&&a.expandByBoundingSphere(t.getBound());if(!a.valid())return e;for(e.set(a.center(e.center()),0),n=0;n<r;n++)(t=i[n]).referenceFrame!==d.a.ABSOLUTE_RF&&e.expandRadiusBySphere(t.getBound());return e},getWorldMatrices:function(){var e=function(){this.nodePaths=[],this.halt=void 0,u.a.call(this,u.a.TRAVERSE_PARENTS)};e.prototype=i.a.objectInherit(u.a.prototype,{reset:function(){this.nodePath.length=0,this.nodePaths.length=0},apply:function(e){0===e._parents.length||e===this.halt||e.referenceFrame===d.a.ABSOLUTE_RF?this.nodePaths.push(this.nodePath.slice(0)):this.traverse(e)}});var t=new e;return t.setNodeMaskOverride(-1),function(e,n){t.reset(),t.halt=e,this.accept(t);for(var i=[],r=n||l.c.create,a=0,o=t.nodePaths.length;a<o;a++){var s=t.nodePaths[a],u=r();0!==s.length&&h.a.computeLocalToWorld(s,!0,u),i.push(u)}return i}}(),getWorldMatrix:function(e,t){var n=this.getWorldMatrices(e,g);return 0===n.length?l.c.identity(t):l.c.copy(t,n[0]),p.reset(),t},setCullingActive:function(e){if(this._cullingActive!==e){if(0===this._numChildrenWithCullingDisabled&&this._parents.length>0){var t=0;if(this._cullingActive||--t,e||++t,0!==t)for(var n=0,i=this._parents.length;n<i;n++)this._parents[n].setNumChildrenWithCullingDisabled(this._parents[n].getNumChildrenWithCullingDisabled()+t)}this._cullingActive=e}},getCullingActive:function(){return this._cullingActive},isCullingActive:function(){return 0===this._numChildrenWithCullingDisabled&&this._cullingActive&&this.getBound().valid()},setNumChildrenWithCullingDisabled:function(e){if(this._numChildrenWithCullingDisabled!==e){if(this._cullingActive&&this._parents.length>0){var t=0;if(this._numChildrenWithCullingDisabled>0&&--t,e>0&&++t,0!==t)for(var n=0,i=this._parents.length;n<i;n++)this._parents[n].setNumChildrenWithCullingDisabled(this._parents[n].getNumChildrenWithCullingDisabled()+t)}this._numChildrenWithCullingDisabled=e}},getNumChildrenWithCullingDisabled:function(){return this._numChildrenWithCullingDisabled},releaseGLObjects:function(){void 0!==this.stateset&&this.stateset.releaseGLObjects()}}),"osg","Node"),t.a=f},W3fT:function(e,t){e.exports="uniform vec3 uColorDebug;\n\nvoid main(void) {\n   gl_FragColor = vec4(uColorDebug, 1.0);\n}\n"},W8Lp:function(e,t,n){"use strict";var i=n("icjm"),r=n("a3nb"),a=n("RwmW"),o=n("Qavt"),s=n("zP/P"),u=n("AwiE"),l=function(){a.a.call(this),o.a.call(this),this._fbo=void 0,this._rbo=void 0,this._attachments=[],this._buffers=[],this._dirty=!0,this._hasMRT=u.a.instance().getWebGLExtension("WEBGL_draw_buffers")};l.COLOR_ATTACHMENT0=36064,l.DEPTH_ATTACHMENT=36096,l.DEPTH_COMPONENT16=33189,l._sDeletedGLFrameBufferCache=new window.Map,l.deleteGLFrameBuffer=function(e,t){l._sDeletedGLFrameBufferCache.has(e)||l._sDeletedGLFrameBufferCache.set(e,[]),l._sDeletedGLFrameBufferCache.get(e).push(t)},l.flushDeletedGLFrameBuffers=function(e,t){if(t<=0)return t;if(!l._sDeletedGLFrameBufferCache.has(e))return t;var n=l._sDeletedGLFrameBufferCache.get(e);if(0===n.length)return t;for(var i=0,r=s.a.instance().tick(),a=n.length-1;a>=0&&i<t;a--)e.deleteFramebuffer(n[a]),n.splice(a,1),i=s.a.instance().deltaS(r,s.a.instance().tick());return t-i},l.flushAllDeletedGLFrameBuffers=function(e){if(l._sDeletedGLFrameBufferCache.has(e)){var t=l._sDeletedGLFrameBufferCache.get(e);if(0!==t.length)for(var n=t.length-1;n>=0;n--)e.deleteFramebuffer(t[n]),t.splice(n,1)}},l._sDeletedGLRenderBufferCache=new window.Map,l.deleteGLRenderBuffer=function(e,t){l._sDeletedGLRenderBufferCache.has(e)||l._sDeletedGLRenderBufferCache.set(e,[]),l._sDeletedGLRenderBufferCache.get(e).push(t)},l.flushDeletedGLRenderBuffers=function(e,t){if(t<=0)return t;if(!l._sDeletedGLRenderBufferCache.has(e))return t;for(var n=0,i=s.a.instance().tick(),r=l._sDeletedGLRenderBufferCache.get(e),a=r.length-1;a>=0&&n<t;a--)e.deleteRenderbuffer(r[a]),r.splice(a,1),n=s.a.instance().deltaS(i,s.a.instance().tick());return t-n},l.flushAllDeletedGLRenderBuffers=function(e){if(l._sDeletedGLRenderBufferCache.has(e))for(var t=l._sDeletedGLRenderBufferCache.get(e),n=t.length-1;n>=0;n--)e.deleteRenderbuffer(t[n]),t.splice(n,1)},l.onLostContext=function(e){if(l._sDeletedGLFrameBufferCache.has(e)){var t=l._sDeletedGLFrameBufferCache.get(e);t.length=0,l._sDeletedGLRenderBufferCache.has(e)&&((t=l._sDeletedGLRenderBufferCache.get(e)).length=0)}},r.a.createPrototypeStateAttribute(l,r.a.objectInherit(a.a.prototype,r.a.objectInherit(o.a.prototype,{attributeType:"FrameBufferObject",cloneType:function(){return new l},invalidate:function(){if(this._rbo&&this._attachments){for(var e=0,t=this._attachments.length;e<t;++e){var n=this._attachments[e];n.texture||(n.renderBufferObject=void 0)}this._rbo=void 0}this._fbo=void 0,this._buffers.length=0,this._dirty=!0},dirty:function(){this._buffers.length=0,this._dirty=!0},isDirty:function(){return this._dirty},setAttachment:function(e){this._attachments.push(e)},getAttachment:function(e){if(this._attachments)for(var t=0,n=this._attachments.length;t<n;++t){var i=this._attachments[t];if(i.attachment===e)return i}},releaseGLObjects:function(){void 0!==this._fbo&&void 0!==this._gl&&l.deleteGLFrameBuffer(this._gl,this._fbo),this._fbo=void 0,void 0!==this._rbo&&void 0!==this._gl&&l.deleteGLRenderBuffer(this._gl,this._rbo),this.invalidate()},_reportFrameBufferError:function(e){switch(e){case 36054:i.a.debug("FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case 36055:i.a.debug("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case 36057:i.a.debug("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case 36061:i.a.debug("FRAMEBUFFER_UNSUPPORTED");break;default:i.a.debug("FRAMEBUFFER unknown error "+e.toString(16))}},reset:function(){this.releaseGLObjects(),this._attachments=[]},getFrameBufferObject:function(){return this._fbo},getRenderBufferObject:function(){return this._rbo},createFrameBufferObject:function(e){this.setGraphicContext(e.getGraphicContext()),this._fbo=this._gl.createFramebuffer()},setFrameBufferObject:function(e,t){this.setGraphicContext(e.getGraphicContext()),this._fbo=t},createRenderBuffer:function(e,t,n){var i=this._gl,r=i.createRenderbuffer();return i.bindRenderbuffer(i.RENDERBUFFER,r),i.renderbufferStorage(i.RENDERBUFFER,e,t,n),r},framebufferRenderBuffer:function(e,t){var n=this._gl;n.bindRenderbuffer(n.RENDERBUFFER,t),n.framebufferRenderbuffer(n.FRAMEBUFFER,e,n.RENDERBUFFER,t)},framebufferTexture2D:function(e,t,n,i){var r=this._gl;if(e.applyTextureAttribute(1,i),i.isDirty()||!i.getTextureObject())return!1;var a=r.DRAW_FRAMEBUFFER||r.FRAMEBUFFER;return r.framebufferTexture2D(a,t,n,i.getTextureObject().id(),0),!0},bindFrameBufferObject:function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._fbo)},checkStatus:function(){var e=this._gl,t=e.checkFramebufferStatus(e.FRAMEBUFFER);t!==e.FRAMEBUFFER_COMPLETE&&this._reportFrameBufferError(t)},_checkAllowedSize:function(e,t){var n=u.a.instance().getWebGLParameter("MAX_RENDERBUFFER_SIZE");return!(0===e||0===t||t>n||e>n)||(i.a.error("width ("+e+") or height ("+e+') makes frame buffer not bindable. Max RenderBuffer is "'+n+'"'),!1)},apply:function(e){this._gl||this.setGraphicContext(e.getGraphicContext());var t=this._gl,n=this._attachments,r=n.length;if(0!==r||this._fbo){var a=0;if(!this.isDirty()){for(a=0;a<r;++a){var o=n[a].texture;o&&o.isDirty()&&e.applyTextureAttribute(1,o)}return t.bindFramebuffer(t.FRAMEBUFFER,this._fbo),void(!0===i.a.reportWebGLError&&this.checkStatus())}this._fbo||this.createFrameBufferObject(e),this.bindFrameBufferObject();var s=this._hasMRT?this._buffers:void 0,u=!1;for(a=0;a<r;++a){var l=n[a];if(l.texture){var c=l.texture;if(!this._checkAllowedSize(c.getWidth(),c.getHeight()))return void this.releaseGLObjects();if(this._hasMRT&&l.attachment>=t.COLOR_ATTACHMENT0&&l.attachment<=t.COLOR_ATTACHMENT15&&-1===s.indexOf(l.attachment)&&s.push(l.attachment),!this.framebufferTexture2D(e,l.attachment,l.textureTarget,c))return void this.releaseGLObjects()}else{if(!this._checkAllowedSize(l.width,l.height))return void this.releaseGLObjects();l.renderBufferObject?this._rbo=l.renderBufferObject:(this._rbo=this.createRenderBuffer(l.format,l.width,l.height),l.renderBufferObject=this._rbo),this.framebufferRenderBuffer(l.attachment,this._rbo),u=!0}}s&&s.length>0&&t.drawBuffers(s),this.checkStatus(),u&&t.bindRenderbuffer(t.RENDERBUFFER,null),this._dirty=!1}else t.bindFramebuffer(t.FRAMEBUFFER,null)}})),"osg","FrameBufferObject"),t.a=l},WDex:function(e,t,n){"use strict";var i,r=n("icjm"),a=n("a3nb"),o=n("fgaA"),s=function(){var e={antialias:!0,fullscreen:!0,enableFrustumCulling:!1,scrollwheel:!0,webgl2:Object(o.a)().webgl2,powerPreference:"high-performance",shaderStats:!1,stats:!1};for(var t in e)this[t]=e[t]};s.getOptionsURL=function(){if(i)return i;if(i={},!window.location.search)return i;for(var e,t=[],n=window.location.search.slice(1).split("&"),a=0;a<n.length;a++){var o=(e=n[a].split("="))[0];t.push(o);var s=e[1];"0"!==s&&"false"!==s&&(void 0===s&&(s="1"),i[o]=s)}if(void 0!==i.log)switch(i.log.toLowerCase()){case"debug":r.a.setNotifyLevel(r.a.DEBUG);break;case"info":r.a.setNotifyLevel(r.a.INFO);break;case"notice":r.a.setNotifyLevel(r.a.NOTICE);break;case"warn":r.a.setNotifyLevel(r.a.WARN);break;case"error":r.a.setNotifyLevel(r.a.ERROR);break;case"html":var u=[],l=document.createElement("div"),c=document.createElement("pre");document.addEventListener("DOMContentLoaded",function(){document.body.insertBefore(l,document.body.firstChild),l.appendChild(c)});var h=function(e){u.unshift(e),c.innerHTML=u.join("\n")};l.style.overflow="hidden",l.style.position="absolute",l.style.zIndex="10000",l.style.height="100%",l.style.maxWidth="600px",l.style.pointerEvents="none",c.style.overflow="scroll",c.style.width="105%",c.style.height="100%",c.style.fontSize="10px",c.style.pointerEvents="none",["log","error","warn","info","debug"].forEach(function(e){window.console[e]=h})}return i},s.prototype={extend:function(e){return a.a.objectMix(this,e),this},get:function(e){return this[e]},getBoolean:function(e){var t=this.getString(e);if(t)return"false"!==t&&"0"!==t},getNumber:function(e){var t=this[e];if(t)return Number(t)},getString:function(e){if(void 0!==this[e])return this[e].toString()},extendWithOptionsURL:function(){this.extend(s.getOptionsURL())}},t.a=s},WIUU:function(e,t){e.exports="attribute vec3 Vertex;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);\n}\n"},WJzN:function(e,t){e.exports='uniform float uRGBMRange;\nuniform int uOutputLinear;\n\n// stuffs (ssr, opacity, scattering)\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\nuniform float uDisplay2D;\nuniform int uInspectorView; // see globalUniforms\n\nuniform float uInspectorFactor;\nuniform int uInspectorInvert;\nuniform float uInspectorMaskThreshold;\nuniform vec3 uInspectorColor;\n\nuniform vec2 uHoverUV;\nuniform int uInspectorSelected;\nuniform int uInspectorWireframe;\n\n#ifdef FEEDBACK_UV\n    vec3 colorHoverUV(const in vec3 frag) {\n        if (uInspectorSelected == 0) return frag;\n        return mix(vec3(1.0, 0.0, 0.0), frag, smoothstep(0.01, 0.02, distance(FEEDBACK_UV, uHoverUV)));\n    }\n#endif\n\n#pragma include "utils/functions.glsl"\n#pragma include "utils/material.glsl"\n#pragma include "utils/rand.glsl"\n\nvoid main() {\n    //////////////////\n    // OPACITY DISCARD\n    //////////////////\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    if (uDisplay2D == 0.0) ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    float alpha = 1.0;\n    float alphaFinal = 1.0;\n\n    if (uDisplay2D == 0.0) {\n        alpha = getMaterialOpacity();\n        alphaFinal = alpha * float(1 - uOpacityAdditive);\n    }\n\n    if (alpha == 0.0 || (uDrawOpaque == 1 && alphaFinal < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaFinal >= EPSILON_ALPHA)) discard;\n#endif\n\n    ///////////\n    // MATERIAL\n    ///////////\n    vec3 frag = vec3(0.0);\n#ifdef HAS_INSPECTOR\n    frag = uInspectorFactor * COLOR_CONVERT_INSPECTOR(texture2D(SAMPLER_INSPECTOR, UV_INSPECTOR).PACK_INSPECTOR);\n    if (uInspectorInvert == 1) frag = 1.0 - frag;\n\n    if (uInspectorMaskThreshold > 0.0 && uDisplay2D == 0.0) frag = frag.x < uInspectorMaskThreshold ? vec3(0.0) : vec3(1.0);\n\n    #ifdef HAS_VERTEX_COLOR\n        #ifdef HAS_VERTEX_ALPHA\n            frag *= getVertexColor();\n        #else\n            frag *= uInspectorView == 1 ? sRGBToLinear(vColor.aaa) : getVertexColor();\n        #endif\n    #endif\n\n    // we want to display the linear textures as srgb textures, see comment in channelFactoryViewModel\n    #ifdef CONVERT_INSPECTOR_TO_LINEAR\n        frag = sRGBToLinear(frag);\n    #endif\n\n    #ifdef HAS_INSPECTOR_TEXTURE\n        frag *= uInspectorColor;\n    #endif\n\n    frag = colorHoverUV(frag);\n#endif\n\n    // premult\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    frag *= alpha;\n#endif\n\n    if (uOutputLinear != 1) frag = linearTosRGB(frag);\n\n    if (uDisplay2D == 1.0) {\n        gl_FragColor = vec4(frag, 1.0);\n        return;\n    }\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    gl_FragColor = uDrawOpaque == 1 ? encodeRGBM(frag, uRGBMRange) : vec4(frag, alphaFinal);\n#else\n    gl_FragColor = encodeRGBM(frag, uRGBMRange);\n#endif\n}\n'},WRMX:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"e",function(){return o}),n.d(t,"k",function(){return s}),n.d(t,"d",function(){return u}),n.d(t,"j",function(){return l}),n.d(t,"f",function(){return c}),n.d(t,"c",function(){return h}),n.d(t,"g",function(){return d}),n.d(t,"i",function(){return f}),n.d(t,"h",function(){return p}),n.d(t,"a",function(){return E});var i=n("XiPH"),r=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).id,n=void 0===t?"uid":t;return new i.c.Entity(e,{},{idAttribute:n})},a=r("categories"),o=r("licenses"),s=r("users"),u=r("comments"),l=r("reviews"),c=r("models"),h=r("collections"),d=r("orgs"),f=r("orgProjects"),p=r("orgMembers"),g=r("uploadActivities"),m=r("collectionActivities"),v=r("collectActivities"),_=r("commentActivities"),b=r("mentionActivities"),S=r("followActivities"),y=r("subscribeActivities"),x=r("likeActivities"),C=r("staffpickActivities"),w=r("reviewActivities"),T=r("reviewReplyActivities"),M=r("blogpostActivities");g.define({obj:c,actor:s}),m.define({obj:h,actor:s}),v.define({actor:s,obj:c,target:h}),_.define({obj:u,actor:s,target:c}),b.define({obj:u,actor:s,target:c}),S.define({actor:s,target:s}),y.define({actor:s,target:h}),x.define({actor:s,target:c}),C.define({obj:c,actor:s}),w.define({obj:l,actor:s,target:c}),T.define({obj:l,actor:s,target:c}),s.define({models:[c]}),u.define({user:s}),l.define({user:s}),c.define({user:s,license:o,categories:[a]}),h.define({user:s});var E=new i.c.Union({upload:g,collection:m,collect:v,comment:_,mention:b,follow:S,subscribe:y,like:x,staffpick:C,review:w,reviewReply:T,blogpost:M},"verb")},WefB:function(e,t,n){"use strict";var i=n("YfG3"),r=n("QYQF"),a=n("gCTM"),o=n("f5KD");t.a=r.a.extend({displayName:"Spinner",optionTypes:{type:o.b.oneOf(["small","slow","inverted","small-slow"]),style:o.b.object},defaultOptions:{style:{}},template:function(){var e=Object(i.a)({},this.options.attrs,{classNames:Object(i.a)(["c-spinner","--"+this.options.type].reduce(function(e,t){return e[t]=!0,e},{})),style:Object(i.a)({},this.options.style)});return a.default.getFromString(["<div {{ attrs | attributes }}>","</div>"].join("\n"),{attrs:e})}})},WqyB:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Q7Tl"),a=n("icjm"),o=n("czSk"),s=n("wwkN"),u=n("vQSd"),l=n("djFS"),c=n("Qavt"),h=n("XKim"),d=function(){s.a.call(this),this._shape=null,this._targets=[],this._stateSetAnimation=new u.a,this._targetWeights=new Float32Array(d.MAX_MORPH_GPU),this._morphAttribute=void 0,this._morphTargetNames=void 0,this._maxMorphGPU=d.MAX_MORPH_GPU,this._isInitialized=!1};d.MAX_MORPH_GPU=4,i.a.createPrototypeNode(d,i.a.objectInherit(s.a.prototype,{init:function(){return this._morphAttribute?(this._isInitialized=!0,!1):(this._morphAttribute=new l.a(Math.min(this._maxMorphGPU,this.getMorphTargets().length)),this.getStateSetAnimation().setAttributeAndModes(this._morphAttribute,c.a.ON),this._morphAttribute.setTargetWeights(this.getTargetsWeight()),this._targets[0]?(this._morphTargetNames=window.Object.keys(this._targets[0].getVertexAttributeList()),this._morphAttribute.copyTargetNames(this._morphTargetNames)):(this._morphTargetNames=[],a.a.error("No Targets in the MorphGeometry !")),this._isInitialized=!0,!0)},getMaximumPossibleMorphGPU:function(){return this._maxMorphGPU},setMaximumPossibleMorphGPU:function(e){this._maxMorphGPU=e,this._isInitialized=!1,this._morphAttribute&&this._morphAttribute.setNumTargets(e)},getMorphTargetNames:function(){return this._morphTargetNames},getStateSetAnimation:function(){return this._stateSetAnimation},getMorphTargets:function(){return this._targets},isInitialized:function(){return this._isInitialized},getTargetsWeight:function(){return this._targetWeights},computeBoundingBox:function(){var e=new h.a;return function(t){s.a.prototype.computeBoundingBox.call(this,t);for(var n=0,i=this._targets.length;n<i;n++)t.expandByBoundingBox(this._targets[n].computeBoundingBox(e));return t}}(),mergeChildrenVertexAttributeList:function(){for(var e=0,t=this._targets.length;e<t;e++){var n=this._targets[e],i=n.getVertexAttributeList();for(var a in i){var o=i[a];o&&!o.getBufferArray&&(i[a]=new r.a(o))}s.a.appendVertexAttributeToList(n.getVertexAttributeList(),this.getVertexAttributeList(),e)}},_computeEffectiveSumWeights:function(){for(var e=0,t=this._targetWeights,n=0,i=t.length;n<i;++n){var r=t[n];Math.abs(r)<=d.EFFECTIVE_EPS||(e+=r)}return Math.abs(e)>1e-5?e:e<0?-1e-5:1e-5},computeTransformedVertex:function(e,t){t=t||o.f.create();var n=3*e,i=this._targetWeights,r=this.getVertexAttributeList(),a=r.Vertex.getElements(),s=1-this._computeEffectiveSumWeights();t[0]=s*a[n],t[1]=s*a[n+1],t[2]=s*a[n+2];for(var u=0,l=i.length;u<l;++u){var c=i[u];if(!(Math.abs(c)<=d.EFFECTIVE_EPS)){var h=r["Vertex_"+u].getElements();t[0]+=c*h[n],t[1]+=c*h[n+1],t[2]+=c*h[n+2]}}return t},computeTransformedVertices:function(){for(var e=this._targetWeights,t=this.getVertexAttributeList(),n=t.Vertex.getElements(),i=n.length,r=this._morphedVerts=this._morphedVerts||new Float32Array(i),a=1-this._computeEffectiveSumWeights(),o=0;o<i;++o)r[o]=a*n[o];for(var s=0,u=e.length;s<u;++s){var l=e[s];if(!(Math.abs(l)<=d.EFFECTIVE_EPS))for(var c=t["Vertex_"+s].getElements(),h=0;h<i;++h)r[h]+=l*c[h]}return r}}),"osgAnimation","MorphGeometry"),t.a=d},Ws5y:function(e,t){e.exports='#define HAS_VERTEX_COLOR\n#define HAS_VIEW_VERTEX\n#define HAS_VIEW_NORMAL\n#pragma include "base.vert"\n'},Wx9w:function(e,t,n){"use strict";var i=n("a3nb"),r=n("JNWj"),a=n("r7P/"),o=n("czSk"),s=function(){r.a.call(this),this._perRangeDataList=[],this._loading=!1,this._expiryTime=0,this._expiryFrame=0,this._centerMode=r.a.USER_DEFINED_CENTER,this._frameNumberOfLastTraversal=0,this._databasePath="",this._numChildrenThatCannotBeExpired=0},u=function(){this.filename="",this.function=void 0,this.loaded=!1,this.timeStamp=0,this.frameNumber=0,this.frameNumberOfLastTraversal=0,this.dbrequest=void 0};i.a.createPrototypeNode(s,i.a.objectInherit(r.a.prototype,{setRange:function(e,t,n){if(e>=this._range.length){var i=[];i.push([t,t]),this._range.push(i)}this._range[e][0]=t,this._range[e][1]=n},setExpiryTime:function(e){this._expiryTime=e},setDatabasePath:function(e){this._databasePath=e},getDatabasePath:function(){return this._databasePath},setFileName:function(e,t){if(e>=this._perRangeDataList.length){var n=new u;n.filename=t,this._perRangeDataList.push(n)}else this._perRangeDataList[e].filename=t},setFunction:function(e,t){if(e>=this._perRangeDataList.length){var n=new u;n.function=t,this._perRangeDataList.push(n)}else this._perRangeDataList[e].function=t},addChild:function(e,t,n){r.a.prototype.addChild.call(this,e,t,n),this._perRangeDataList.push(new u)},addChildNode:function(e){r.a.prototype.addChildNode.call(this,e)},setFrameNumberOfLastTraversal:function(e){this._frameNumberOfLastTraversal=e},getFrameNumberOfLastTraversal:function(){return this._frameNumberOfLastTraversal},setTimeStamp:function(e,t){this._perRangeDataList[e].timeStamp=t},setFrameNumber:function(e,t){this._perRangeDataList[e].frameNumber=t},setNumChildrenThatCannotBeExpired:function(e){this._numChildrenThatCannotBeExpired=e},getNumChildrenThatCannotBeExpired:function(){return this._numChildrenThatCannotBeExpired},getDatabaseRequest:function(e){return this._perRangeDataList[e].dbrequest},removeExpiredChildren:function(e,t,n){if(!(this.children.length<=this._numChildrenThatCannotBeExpired)){var i,r,a=this.children.length-1;i=this._perRangeDataList[a].timeStamp+this._expiryTime,r=this._perRangeDataList[a].frameNumber+this._expiryFrame,i<e&&r<t&&(this._perRangeDataList[a].filename.length>0||void 0!==this._perRangeDataList[a].function)&&(n.push(this.children[a]),this.removeChild(this.children[a]),this._perRangeDataList[a].loaded=!1,void 0!==this._perRangeDataList[a].dbrequest&&(this._perRangeDataList[a].dbrequest._groupExpired=!0))}},traverse:function(){var e=o.f.create(),t=o.f.create(),n=o.c.create();return function(i){var s=i.traversalMode,u=!1;switch(i.getVisitorType()===a.a.CULL_VISITOR&&(this._frameNumberOfLastTraversal=i.getFrameStamp().getFrameNumber(),u=!0),s){case a.a.TRAVERSE_ALL_CHILDREN:for(var l=0;l<this.children.length;l++)this.children[l].accept(i);break;case a.a.TRAVERSE_ACTIVE_CHILDREN:var c=0,h=i.getCurrentModelViewMatrix();if(o.c.invert(n,h),this._rangeMode===r.a.DISTANCE_FROM_EYE_POINT){o.f.transformMat4(t,e,n),c=o.f.distance(this.getBound().center(),t)*i.getLODScale()}else{var d=i.getCurrentProjectionMatrix();(c=(c=this.projectBoundingSphere(this.getBound(),h,d[0]))*i.getViewport().width()*i.getViewport().width()*.25/i.getLODScale())<0&&(c=this._range[this._range.length-1][0])}for(var f=!1,p=-1,g=0;g<this._range.length;++g)this._range[g][0]<=c&&c<this._range[g][1]&&(g<this.children.length?(u&&(this._perRangeDataList[g].timeStamp=i.getFrameStamp().getSimulationTime(),this._perRangeDataList[g].frameNumber=i.getFrameStamp().getFrameNumber()),this.children[g].accept(i),p=g):f=!0);if(f){var m=this.children.length;if(m>0&&m-1!==p&&(u&&(this._perRangeDataList[m-1].timeStamp=i.getFrameStamp().getSimulationTime(),this._perRangeDataList[m-1].frameNumber=i.getFrameStamp().getFrameNumber()),this.children[m-1].accept(i)),m<this._perRangeDataList.length){var v=(this._range[m][0]-c)/(this._range[m][1]-this._range[m][0]);this._rangeMode===r.a.PIXEL_SIZE_ON_SCREEN&&(v=-v);var _=i.nodePath[i.nodePath.length-1];if(!1===this._perRangeDataList[m].loaded){this._perRangeDataList[m].loaded=!0;var b=i.getDatabaseRequestHandler();this._perRangeDataList[m].dbrequest=b.requestNodeFile(this._perRangeDataList[m].function,this._databasePath+this._perRangeDataList[m].filename,_,i.getFrameStamp().getSimulationTime(),v)}else void 0!==this._perRangeDataList[m].dbrequest?(this._perRangeDataList[m].dbrequest._timeStamp=i.getFrameStamp().getSimulationTime(),this._perRangeDataList[m].dbrequest._priority=v):this._perRangeDataList[m].loaded=!1}}}}}()}),"osg","PagedLOD"),t.a=s},Wzgv:function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("J4zp"),o=n.n(a),s=n("12sq"),u=n("q1tI"),l=n("/MKj"),c=n("gPpI"),h=n("wsGC"),d=n("P1HB"),f=n("IOyo"),p=n("M4AY"),g=n("M+Bz"),m=n("yOYh"),v=n("TCxt"),_=n("fx2a"),b=n("ei2W"),S=n("5bbf"),y=n("KbKu"),x=r()("br",{}),C=r()("br",{}),w=r()("li",{className:"separator"}),T=r()("li",{className:"separator"}),M=r()("li",{className:"separator"}),E=r()("li",{className:"separator"}),A=r()("button",{type:"submit",className:"button btn-textified","data-selenium":"logout"},void 0,"Logout");t.a=function(e){var t=e.authUser,n=e.anchor,i=void 0===n?"":n,a=e.className,O=Object(l.d)(),R=Object(g.a)(function(e){return e.preventDefault(),O(p.a.authUser.logout())}),P=u.useContext(S.a),I=u.useState(!1),N=o()(I,2),L=N[0],k=N[1];return r()("div",{"data-selenium":"header-user-menu",className:Object(h.a)("c-user-menu",a,{"--transparent":"transparent"===P}),onMouseEnter:function(){return k(!0)}},void 0,r()("a",{className:"c-user-menu__info show-hover-menu",href:t.profileUrl},void 0,r()("div",{className:"c-user-menu__avatar","data-selenium":"header-avatar"},void 0,r()(m.a,{alt:"Avatar of ".concat(t.username),deferred:!1,avatars:t.avatars}))),r()("ul",{className:"hover-menu"},void 0,r()("li",{},void 0,r()(v.a,{noBadgeLink:!0,user:t,className:"c-user-menu__name hover-menu__prevent-style"}),r()(b.a,{},void 0,function(){return"limited"===t.viewOnlyLimit.type?r()("div",{"data-selenium":"remaining-credits","data-value":t.viewOnlyLimit.remaining,className:"hover-menu__prevent-style c-user-menu__view-only-limit"},void 0,r()("strong",{},void 0,t.viewOnlyLimit.remaining," ",r()(_.c,{text:"upload credit".concat(1===t.viewOnlyLimit.remaining?"":"s")})," ","left"),x,"until the reset on"," ",Object(f.b)(t.viewOnlyLimit.renews_at,"MMM Do"),".",C,r()(_.a,{currentPlan:t.account,className:"skfb-link",urlRef:"user_menu"},void 0,"Upgrade to increase your limit")):null})),w,r()("li",{},void 0,r()("a",{href:Object(c.e)("feeds:following")},void 0,"Newsfeed")),r()("li",{},void 0,r()("a",{href:t.modelsUrl},void 0,"Models")),r()("li",{},void 0,r()("a",{href:t.collectionsUrl},void 0,"Collections")),r()("li",{},void 0,r()("a",{href:t.likesUrl},void 0,"Likes")),T,r()(y.a,{authUser:t,className:"c-user-menu__organizations",isDisplayed:L}),r()("li",{},void 0,r()("a",{href:Object(c.e)("users:profile_purchases",{username:t.username})},void 0,"Purchases")),r()("li",{},void 0,r()("a",{href:Object(c.e)("users:profile_sales",{username:t.username})},void 0,"Sales")),M,r()("li",{},void 0,r()("a",{href:Object(c.e)("users:settings_profile")},void 0,"Settings")),!t.isAnonymous&&Object(d.l)(t)?r()("li",{},void 0,r()("a",{id:"hover-menu__upgrade-account",href:Object(c.e)("pages:plans",{},{ref:"upgrade-button"})},void 0,"Upgrade")):null,r()("li",{},void 0,r()("a",{href:"".concat(s.a.hosts.faq).concat(i),target:"_blank"},void 0,"Help Center")),E,r()("li",{},void 0,r()("form",{action:Object(c.e)("users:signout"),method:"post",onClick:R},void 0,A))))}},X2EN:function(e,t,n){"use strict";n.d(t,"b",function(){return o});var i=n("MG+9"),r=n("G++S"),a=n.n(r),o=Symbol("instanceKey"),s=function(e){var t=e[o];return!t||t.shouldUpdate};t.a={name:"WithTemplate",template:function(){return""},renderDiff:function(e){var t=this.el.cloneNode();t.innerHTML=e,a()(this.el,t,{onBeforeElUpdated:s,onBeforeElChildrenUpdated:s,childrenOnly:!0})},render:function(){this.renderDiff(Object(i.a)(this,"template"))}}},X9vd:function(e,t,n){"use strict";n.r(t),n.d(t,"all",function(){return pe}),n.d(t,"any",function(){return ge}),n.d(t,"collect",function(){return me}),n.d(t,"contains",function(){return ve}),n.d(t,"detect",function(){return be}),n.d(t,"foldl",function(){return Se}),n.d(t,"foldr",function(){return ye}),n.d(t,"include",function(){return _e}),n.d(t,"indexBy",function(){return xe}),n.d(t,"inject",function(){return Ce}),n.d(t,"pairs",function(){return we}),n.d(t,"select",function(){return Te}),n.d(t,"extend",function(){return fe});var i=n("YfG3"),r=n("m8R6"),a=n("c8Bs"),o=n("lCmp"),s=n("zmn3"),u=n("NFsq"),l=n("CpTu"),c=n("owWc"),h=n("NzoX"),d=n("3/My"),f=n("Z4nq"),p=n("Z0Cl"),g=n("+Umg"),m=n("dYt1"),v=n("+eoN"),_=n("PRjJ"),b=n("4kdM"),S=n("syB0"),y=n("Wy5O"),x=n("4Ok1"),C=n("OZf9"),w=n("Dpjh"),T=n("HI9p"),M=n("3ftV"),E=n("F294"),A=n("etdC"),O=n("pHS2"),R=n("vFlG"),P=n("ukIz"),I=n("zWJI"),N=n("OL4R"),L=n("JpOH"),k=n("/1FC"),D=n("fujP"),F=n("Muja"),V=n("vJtL"),B=n("IzLi"),U=n("Zo4r"),j=n("gSGL"),G=n("CqBn"),H=n("mkut"),z=n("qAkX"),W=n("t0K5"),q=n("MwDg"),X=n("ZP0B"),Y=n("uKXT"),K=n("MXQz"),Q=n("S1sa"),J=n("Bw5p"),Z=n("uXhx"),$=n("Y0Bi"),ee=n("MG+9"),te=n("1Apa"),ne=n("cdPG"),ie=n("Fsnq"),re=n("1myf"),ae=n("F0Ax"),oe=n("wBxZ"),se=n("WgRr"),ue=n("fp5s"),le=n("TGBA"),ce=n("OtLZ");n.d(t,"bind",function(){return g.a}),n.d(t,"clone",function(){return m.a}),n.d(t,"countBy",function(){return v.a}),n.d(t,"create",function(){return _.a}),n.d(t,"defaults",function(){return b.a}),n.d(t,"defer",function(){return S.a}),n.d(t,"difference",function(){return y.a}),n.d(t,"drop",function(){return x.a}),n.d(t,"each",function(){return C.a}),n.d(t,"escape",function(){return w.a}),n.d(t,"every",function(){return a.a}),n.d(t,"filter",function(){return p.a}),n.d(t,"find",function(){return l.a}),n.d(t,"findIndex",function(){return T.a}),n.d(t,"findLastIndex",function(){return M.a}),n.d(t,"first",function(){return E.a}),n.d(t,"forEach",function(){return C.a}),n.d(t,"functions",function(){return A.a}),n.d(t,"groupBy",function(){return O.a}),n.d(t,"has",function(){return R.a}),n.d(t,"head",function(){return E.a}),n.d(t,"includes",function(){return u.a}),n.d(t,"indexOf",function(){return P.a}),n.d(t,"initial",function(){return I.a}),n.d(t,"invert",function(){return N.a}),n.d(t,"invoke",function(){return L.a}),n.d(t,"isArray",function(){return k.a}),n.d(t,"isEmpty",function(){return D.a}),n.d(t,"isEqual",function(){return F.a}),n.d(t,"isFunction",function(){return V.a}),n.d(t,"isObject",function(){return B.a}),n.d(t,"isRegExp",function(){return U.a}),n.d(t,"isString",function(){return j.a}),n.d(t,"iteratee",function(){return G.a}),n.d(t,"keys",function(){return H.a}),n.d(t,"last",function(){return z.a}),n.d(t,"lastIndexOf",function(){return W.a}),n.d(t,"map",function(){return s.a}),n.d(t,"matches",function(){return q.a}),n.d(t,"max",function(){return X.a}),n.d(t,"min",function(){return Y.a}),n.d(t,"omit",function(){return r.a}),n.d(t,"once",function(){return K.a}),n.d(t,"partition",function(){return Q.a}),n.d(t,"pick",function(){return J.a}),n.d(t,"reduce",function(){return c.a}),n.d(t,"reduceRight",function(){return h.a}),n.d(t,"reject",function(){return Z.a}),n.d(t,"rest",function(){return $.a}),n.d(t,"result",function(){return ee.a}),n.d(t,"sample",function(){return te.a}),n.d(t,"shuffle",function(){return ne.a}),n.d(t,"size",function(){return ie.a}),n.d(t,"some",function(){return o.a}),n.d(t,"sortBy",function(){return re.a}),n.d(t,"tail",function(){return ae.a}),n.d(t,"take",function(){return oe.a}),n.d(t,"toArray",function(){return se.a}),n.d(t,"uniqueId",function(){return ue.a}),n.d(t,"values",function(){return le.a}),n.d(t,"without",function(){return ce.a});var he=n("Qcqf"),de=n.n(he);n.d(t,"chain",function(){return de.a});const fe=(e,...t)=>"function"==typeof e?Object(i.a)(e,...t.map(e=>Object(r.a)(e,["name"]))):Object(i.a)(e,...t),pe=a.a,ge=o.a,me=s.a,ve=u.a,_e=u.a,be=l.a,Se=c.a,ye=h.a,xe=d.a,Ce=c.a,we=f.a,Te=p.a,Me={all:pe,any:ge,bind:g.a,chain:de(),clone:m.a,collect:me,contains:ve,countBy:v.a,create:_.a,defaults:b.a,defer:S.a,detect:be,difference:y.a,drop:x.a,each:C.a,escape:w.a,every:a.a,filter:p.a,find:l.a,findIndex:T.a,findLastIndex:M.a,first:E.a,foldl:Se,foldr:ye,forEach:C.a,functions:A.a,groupBy:O.a,has:R.a,head:E.a,include:_e,includes:u.a,indexBy:xe,indexOf:P.a,initial:I.a,inject:Ce,invert:N.a,invoke:L.a,isArray:k.a,isEmpty:D.a,isEqual:F.a,isFunction:V.a,isObject:B.a,isRegExp:U.a,isString:j.a,iteratee:G.a,keys:H.a,last:z.a,lastIndexOf:W.a,map:s.a,matches:q.a,max:X.a,min:Y.a,omit:r.a,once:K.a,pairs:we,partition:Q.a,pick:J.a,reduce:c.a,reduceRight:h.a,reject:Z.a,rest:$.a,result:ee.a,sample:te.a,select:Te,shuffle:ne.a,size:ie.a,some:o.a,sortBy:re.a,tail:ae.a,take:oe.a,toArray:se.a,uniqueId:ue.a,values:le.a,without:ce.a,extend:fe};t.default=Me},XKim:function(e,t,n){"use strict";var i=n("icjm"),r=n("a3nb"),a=n("czSk"),o=function(){this._min=a.f.create(),this._max=a.f.create(),this.init()};r.a.createPrototypeObject(o,{init:function(){a.f.copy(this._min,a.f.INFINITY),a.f.copy(this._max,a.f.NEGATIVE_INFINITY)},volume:function(){var e=this._max[0]-this._min[0];return e*=this._max[1]-this._min[1],e*=this._max[2]-this._min[2]},copy:function(e){a.f.copy(this._min,e._min),a.f.copy(this._max,e._max)},valid:function(){return this._max[0]>=this._min[0]&&this._max[1]>=this._min[1]&&this._max[2]>=this._min[2]},expandByBoundingSphere:function(e){if(e.valid()){var t=this._max,n=this._min,i=e._radius,r=e._center[0],a=e._center[1],o=e._center[2];n[0]=Math.min(n[0],r-i),n[1]=Math.min(n[1],a-i),n[2]=Math.min(n[2],o-i),t[0]=Math.max(t[0],r+i),t[1]=Math.max(t[1],a+i),t[2]=Math.max(t[2],o+i)}},expandByvec3:function(e){i.a.warn("deprecated, use expandByVec3"),this.expandByVec3(e)},expandByVec3:function(e){var t=this._min,n=this._max;t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),n[0]=Math.max(n[0],e[0]),n[1]=Math.max(n[1],e[1]),n[2]=Math.max(n[2],e[2])},expandByBoundingBox:function(e){if(e.valid()){var t=this._min,n=this._max,i=e._min,r=e._max;i[0]<t[0]&&(t[0]=i[0]),r[0]>n[0]&&(n[0]=r[0]),i[1]<t[1]&&(t[1]=i[1]),r[1]>n[1]&&(n[1]=r[1]),i[2]<t[2]&&(t[2]=i[2]),r[2]>n[2]&&(n[2]=r[2])}},center:function(e){var t=this._min,n=this._max;return e[0]=.5*(t[0]+n[0]),e[1]=.5*(t[1]+n[1]),e[2]=.5*(t[2]+n[2]),e},radius:function(){return Math.sqrt(this.radius2())},radius2:function(){var e=this._min,t=this._max,n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return.25*(n*n+i*i+r*r)},getMin:function(){return this._min},getMax:function(){return this._max},setMin:function(e){return a.f.copy(this._min,e),this},setMax:function(e){return a.f.copy(this._max,e),this},xMax:function(){return this._max[0]},yMax:function(){return this._max[1]},zMax:function(){return this._max[2]},xMin:function(){return this._min[0]},yMin:function(){return this._min[1]},zMin:function(){return this._min[2]},corner:function(e,t){return t[0]=1&e?this._max[0]:this._min[0],t[1]=2&e?this._max[1]:this._min[1],t[2]=4&e?this._max[2]:this._min[2],t},transformMat4:function(){var e=a.f.create(),t=a.f.create();return function(n,i){var r=this.getMin(),o=this.getMax();a.c.getTranslation(e,i),a.f.copy(t,e);for(var s=0;s<3;++s)for(var u=4*s,l=r[s],c=o[s],h=0;h<3;++h){var d=i[u+h],f=d*c,p=d*l;f<p?(e[h]+=f,t[h]+=p):(e[h]+=p,t[h]+=f)}var g=n.getMax(),m=n.getMin();return g[0]=t[0],g[1]=t[1],g[2]=t[2],m[0]=e[0],m[1]=e[1],m[2]=e[2],n}}()},"osg","BoundingBox"),t.a=o},XZvc:function(e,t){e.exports='#pragma include "utils/functions.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\n#ifdef HEMI\nuniform vec4 uGround;\nvarying vec3 vLocalVertex;\nuniform float uRadius;\n#endif\n\n#ifdef ICON\nuniform sampler2D uTextureIcon;\nvarying vec2 vTexCoord0;\nuniform int uEnable;\n#endif\n\nvarying vec4 vViewPos;\nuniform vec2 uNearFar;\nuniform sampler2D uTextureDepth;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\n\nuniform vec4 uColor;\n\nvoid main(void) {\n  float distDepth = distanceToDepth(uTextureDepth, uGlobalTexRatio * gl_FragCoord.xy / uGlobalTexSize, vViewPos, uNearFar);\n  float alpha = distDepth < 0.0 ? 1.0 : 0.1;\n\n  // handles colors with values higher than 1\n  vec3 normColor = uColor.rgb / max(max(1.0, uColor.r), max(uColor.g, uColor.b));\n\n#ifdef HEMI\n  gl_FragColor = vec4(mix(uGround.rgb, normColor, vLocalVertex.z / uRadius), alpha);\n#endif\n\n#ifdef LINE\n  gl_FragColor = vec4(normColor, alpha);\n#endif\n\n#ifdef ICON\n  gl_FragColor = vec4(float(uEnable) * normColor, alpha) * texture2D(uTextureIcon, vTexCoord0);\n#endif\n\n  gl_FragColor.rgb *= gl_FragColor.a;\n\n  gl_FragColor.rgb = sRGBToLinear(gl_FragColor.rgb);\n}\n'},"XjS/":function(e,t,n){"use strict";var i=n("o0o1"),r=n.n(i),a=n("yXPU"),o=n.n(a),s=n("pVnL"),u=n.n(s),l=n("gcR/"),c=n.n(l),h=n("q1tI"),d=n("/MKj"),f=n("M4AY"),p=function(e){var t=e.level,n=e.uid,i=e.children,r=Object(d.d)(),a=h.useCallback(function(){return r(f.a.messages.remove(n))},[n,r]);return c()("div",{className:"flashmessage notification ".concat(t)},void 0,c()("div",{className:"inner"},void 0,c()("button",{className:"flashmessage-close",onClick:a,title:"Close"}),c()("div",{className:"message"},void 0,i)))},g=n("2UZc"),m=n("gPpI"),v=c()("br",{}),_=function(e){var t=e.uid,n=e.level,i=void 0===n?"warning":n;return c()(p,{level:i,uid:t},void 0,"Important: your email hasn","'","t been confirmed yet. ",v,c()("a",{href:Object(m.e)("users:settings_email")},void 0,"Confirm now"))},b=function(e){var t=e.uid,n=e.level,i=void 0===n?"error":n;return c()(p,{level:i,uid:t},void 0,"Sketchfab is undergoing maintenance. Your changes may not be saved.")},S=function(){var e=Object(d.e)(f.c.messages.messages);return c()("div",{className:"flashmessage-container"},void 0,e.map(function(e){return Object(g.b)(e)?"confirmEmail"===e.type?h.createElement(_,u()({key:e.uid},e)):h.createElement(b,u()({key:e.uid},e)):h.createElement(p,u()({key:e.uid},e),e.message)}))};S.prepare=function(){var e=o()(r.a.mark(function e(t){var n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.services,i=t.props.messages,e.next=3,n.dispatch(f.a.authUser.getFromPrefetched());case 3:i&&n.dispatch(f.a.messages.addMultiple(i));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();t.a=S},"Xr/U":function(e,t){e.exports="attribute vec3 Vertex;\n\nattribute vec2 TexCoord0;\nvarying vec2 vTexCoord0;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xyz, 1.0));\n}\n"},XsDm:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"b",function(){return d});var i=n("lwsE"),r=n.n(i),a=n("W8MJ"),o=n.n(a),s=n("lSNA"),u=n.n(s),l=function(){function e(){r()(this,e),u()(this,"tag","None")}return o()(e,[{key:"map",value:function(e){return h}},{key:"caseOf",value:function(e){return e.None()}},{key:"reduce",value:function(e,t){return t}},{key:"chain",value:function(e){return h}},{key:"withDefault",value:function(e){return e}}]),e}(),c=function(){function e(t){r()(this,e),this.value=t,u()(this,"tag","Some")}return o()(e,[{key:"map",value:function(e){return d(e(this.value))}},{key:"caseOf",value:function(e){return e.Some(this.value)}},{key:"reduce",value:function(e,t){return e(t,this.value)}},{key:"chain",value:function(e){return e(this.value)}},{key:"withDefault",value:function(e){return this.value}}]),e}(),h=new l,d=function(e){return new c(e)}},Y14P:function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),a=n("YfG3"),o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.expires,a=void 0===i?31536e6:i,o=n.domain,s=void 0===o?"":o,u=n.path,l=void 0===u?"/":u,c=a instanceof Date?a:new Date(Date.now()+a);return["".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t)),"expires=".concat(c.toUTCString())].concat(r()(s?["domain=".concat(s)]:[]),["path=".concat(l),"secure"]).join(";")},s={remove:function(e,t){document.cookie=o(e,"",Object(a.a)({},t,{expires:new Date("01/01/1970 00:00+0000")}))},get:function(e,t){var n;try{n=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.cookie).split(/; */g).reduce(function(e,t){var n=t.indexOf("="),i=decodeURIComponent(t.substr(0,n)),r=decodeURIComponent(t.substr(n+1));return e[i]=r,e},{})}(document.cookie)[e]}catch(e){console.warn("The cookies could not be read, most likely due to sandboxing issues.")}return void 0!==n?n:t},set:function(e,t,n){try{document.cookie=o(e,t,n)}catch(e){console.warn("The cookies could not be set, most likely due to sandboxing issues.")}}};t.a=s},Y6Ma:function(e,t,n){"use strict";var i=n("a3nb"),r=n("b/No"),a=n("eBAO"),o=n("EnLC"),s=function(){this._depth=0,this._children=new a.a,this._leafs=new r.a,this._stateset=void 0,this._parent=void 0};s.pooledStateGraph=new o.a(function(){return new s}),s.statsNbMoveStateGraph=0,s.reset=function(){s.pooledStateGraph.reset(),s.statsNbMoveStateGraph=0},i.a.createPrototypeObject(s,{clean:function(){this._leafs.reset(),this._children.reset(),this._depth=0,this._stateset=void 0,this._parent=void 0},getStateSet:function(){return this._stateset},getLeafs:function(){return this._leafs},getParent:function(){return this._parent},findOrInsert:function(e){var t=e.getInstanceID(),n=this._children.getMap()[t];return n||((n=s.pooledStateGraph.getOrCreateObject()).clean(),n._parent=this,n._depth=this._depth+1,n._stateset=e,this._children.set(t,n)),n}},"osg","StateGraph"),s.moveStateGraph=function(){var e=new r.a,t=e.getArray();return function(n,i,r){s.statsNbMoveStateGraph++,e.reset();var a,o,u=r,l=i;if(u!==l&&void 0!==u)if(void 0!==l){if(l._parent===u._parent)return void 0!==l._stateset&&n.popStateSet(),void(void 0!==u._stateset&&n.pushStateSet(u._stateset));for(;l._depth>u._depth;)void 0!==l._stateset&&n.popStateSet(),l=l._parent;for(e.reset();u._depth>l._depth;)void 0!==u._stateset&&e.push(u._stateset),u=u._parent;for(;l!==u;)void 0!==l._stateset&&n.popStateSet(),l=l._parent,void 0!==u._stateset&&e.push(u._stateset),u=u._parent;for(a=e._length-1,o=0;a>=o;--a)n.pushStateSet(t[a])}else{do{void 0!==u._stateset&&e.push(u._stateset),u=u._parent}while(u);for(a=e._length-1,o=0;a>=o;--a)n.pushStateSet(t[a])}}}(),t.a=s},YBiY:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"b",function(){return M}),n.d(t,"c",function(){return E}),n.d(t,"d",function(){return A}),n.d(t,"a",function(){return P});var i,r,a=n("o0o1"),o=n.n(a),s=n("yXPU"),u=n.n(s),l=n("QILm"),c=n.n(l),h=n("J4zp"),d=n.n(h),f=n("lSNA"),p=n.n(f),g=n("MVZn"),m=n.n(g),v=n("Wy5O"),_=n("Muja"),b=n("XiPH"),S=n("NpZ0"),y=n("wHZf"),x=n("WRMX"),C=n("9mpE"),w=n("S4lS"),T=n("4WAW");!function(e){e.UPDATE_QUERY="orgSearch.UPDATE_QUERY",e.UPDATE_DISPLAY="orgSearch.UPDATE_DISPLAY",e.UPDATE_FILTERS="orgSearch.UPDATE_FILTERS",e.LOAD_INITIAL_QUERY="orgSearch.LOAD_INITIAL_QUERY",e.LOAD_INITIAL_DISPLAY="orgSearch.LOAD_INITIAL_DISPLAY",e.FIRST="orgSearch.FIRST",e.NEXT="orgSearch.NEXT",e.PREVIOUS="orgSearch.PREVIOUS",e.DELETE="orgSearch.DELETE",e.ADD_MODEL="orgSearch.ADD_MODEL"}(r||(r={}));var M={query:"",filters:{sortBy:"-createdAt",animated:!1,rigged:!1,pbr:!1,minFaceCount:0,maxFaceCount:25e4,fileFormats:[],visibility:[],users:[]},pagination:T.c,display:"grid"},E=Object(S.b)(M,(i={},p()(i,r.UPDATE_QUERY,function(e,t){return m()({},e,{query:t.query})}),p()(i,r.UPDATE_DISPLAY,function(e,t){return m()({},e,{display:t.display})}),p()(i,r.UPDATE_FILTERS,function(e,t){return m()({},e,{filters:m()({},e.filters,t.filters)})}),p()(i,r.LOAD_INITIAL_QUERY,function(e,t){return t.effect.caseOf({Pending:function(){return m()({},e,{query:t.query,filters:t.filters})},Rejected:function(){return e},Resolved:function(t){return m()({},e,{pagination:T.f(e.pagination,T.b.firstResolved(t))})}})}),p()(i,r.LOAD_INITIAL_DISPLAY,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){var n=t.display;return m()({},e,{display:n})}})}),p()(i,r.FIRST,function(e,t){return m()({},e,{pagination:T.e(T.h.FIRST,e.pagination,t.effect)})}),p()(i,r.NEXT,function(e,t){return m()({},e,{pagination:T.e(T.h.NEXT,e.pagination,t.effect)})}),p()(i,r.PREVIOUS,function(e,t){return m()({},e,{pagination:T.e(T.h.PREVIOUS,e.pagination,t.effect)})}),p()(i,r.DELETE,function(e,t){var n=t.uid;return m()({},e,{pagination:m()({},e.pagination,{list:e.pagination.list.filter(function(e){return e!==n})})})}),p()(i,r.ADD_MODEL,function(e,t){var n=t.modelUid;return m()({},e,{pagination:T.f(e.pagination,T.b.prepend(n))})}),i)),A={query:function(e){return e.orgSearch.query},display:function(e){return e.orgSearch.display},filters:function(e){return e.orgSearch.filters},filtersCount:function(e){return Object.entries(A.filters(e)).reduce(function(e,t){var n=d()(t,2),i=n[0],r=n[1];return e+(Array.isArray(r)?Object(v.a)(r,M.filters[i]).length:Object(_.a)(r,M.filters[i])?0:1)},0)},models:function(e){return Object(b.a)(T.g.list(e.orgSearch.pagination),[x.f],e.entities)},cursors:function(e){return T.g.cursors(e.orgSearch.pagination)},isLoading:function(e){return T.g.isLoading(e.orgSearch.pagination)},loading:function(e){return T.g.loading(e.orgSearch.pagination)},hasNextPage:function(e){return T.g.hasNextPage(e.orgSearch.pagination)},hasPreviousPage:function(e){return T.g.hasPreviousPage(e.orgSearch.pagination)}},O=function(e,t){var n=t.animated,i=t.pbr,r=t.rigged,a=t.maxFaceCount,o=t.minFaceCount,s=t.sortBy,u=c()(t,["animated","pbr","rigged","maxFaceCount","minFaceCount","sortBy"]);return m()({},u,{q:e,maxFaceCount:25e4===a?void 0:a,minFaceCount:0===o?void 0:o,count:24,sortBy:s,animated:n||void 0,pbr:i||void 0,rigged:r||void 0})},R=function(){var e=u()(o.a.mark(function e(t,n,i){var r,a,s,u,l,h,d,f,p,g,v,_=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=_.length>3&&void 0!==_[3]?_[3]:null,a=A.filters(i),s=w.a.getSearchQueryParams(A.query(i)),u=s.q,l=c()(s,["q"]),e.next=5,n.getOrgModels(t,m()({},O(u,a),l,{cursor:r}));case 5:return h=e.sent,d=h.results,f=h.cursors,p=Object(b.b)(d,[x.f]),g=p.entities,v=p.result,e.abrupt("return",{entities:g,list:v,cursors:f});case 10:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),P={loadInitialQuery:function(e){var t=e.split("?"),n=d()(t,2)[1],i=void 0===n?"":n,a=Object(C.e)("sort_by",M.filters.sortBy,i),o=Object(C.e)("user","",i),s=Object(C.f)("tags",[],i),u=[o?"user:".concat(o," "):"",s.map(function(e){return"tag:".concat(e)}).join(" "),Object(C.e)("q","",i)].filter(Boolean).join(" "),l={sortBy:a,animated:Object(C.a)("animated",M.filters.animated,i),rigged:Object(C.a)("rigged",M.filters.rigged,i),pbr:Object(C.a)("pbr",M.filters.pbr,i),minFaceCount:Object(C.d)("min_face_count",0,i),maxFaceCount:Object(C.d)("max_face_count",25e4,i),fileFormats:Object(C.f)("file_formats",M.filters.fileFormats,i),visibility:Object(C.f)("visibility",M.filters.visibility,i),users:Object(C.f)("users",M.filters.users,i)};return{type:r.LOAD_INITIAL_QUERY,payload:{query:u,filters:l,effect:function(t){var n=t.Prefetching.get(e);if(!n)throw new Error('No search response in prefetchedData for query "'.concat(e,'"'));var i=n.results,r=void 0===i?[]:i,a=n.cursors,o=void 0===a?{next:null,previous:null}:a,s=Object(b.b)(r,[x.f]);return{entities:s.entities,list:s.result,cursors:o}}}}},loadInitialDisplay:function(){return{type:r.LOAD_INITIAL_DISPLAY,payload:{effect:function(e){return{display:e.CookieBag.get("org-models-display",M.display)}}}}},loadFirstPage:function(e){return{type:r.FIRST,payload:{effect:function(t){var n=t.Api,i=t.getState;return R(e,n,i())}}}},loadNextPage:function(e){return{type:r.NEXT,payload:{effect:function(t){var n=t.Api,i=t.getState,r=A.cursors(i()).next;return R(e,n,i(),r)}}}},loadPreviousPage:function(e){return{type:r.PREVIOUS,payload:{effect:function(t){var n=t.Api,i=t.getState,r=A.cursors(i()).previous;return R(e,n,i(),r)}}}},updateQuery:function(e){return{type:r.UPDATE_QUERY,payload:{query:e}}},updateDisplay:function(e){return{type:r.UPDATE_DISPLAY,payload:{display:e,effect:Object(y.clientOnly)(function(t){t.CookieBag.set("org-models-display",e)},r.UPDATE_DISPLAY)}}},updateFilters:function(e){return{type:r.UPDATE_FILTERS,payload:{filters:e}}},resetFilters:function(){return P.updateFilters(M.filters)},delete:function(e){return{type:r.DELETE,payload:{uid:e,effect:Object(y.clientOnly)(function(e){e.Prefetching.invalidateAllMatchRegExp(/^\/i\/orgs\/\w*\/models.*/)},r.DELETE)}}},addModel:function(e){return{type:r.ADD_MODEL,payload:{modelUid:e}}}}},YE5Z:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return u});var i=n("12sq"),r=n("F2y5"),a=Object(r.a)(i.a.modelMinPrice,-2),o=5e4,s=0,u=25e4},YL90:function(e,t,n){"use strict";t.a={initialize:function(e){!function(e,t,n,i,r){e[i]=e[i]||[],e[i].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],o=t.createElement(n);o.defer=!0,o.src="//www.googletagmanager.com/gtm.js?id="+r,a.parentNode.insertBefore(o,a)}(window,document,"script","dataLayer",e.uid)},triggerAllowsGdprEvent:function(){this.triggerCustomEvent("gpdrApproved")},triggerCustomEvent:function(e){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:e})}}},YO6B:function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("MVZn"),o=n.n(a),s=n("J4zp"),u=n.n(s),l=n("G9Ht"),c=n.n(l),h=n("q1tI"),d=n("+lWh"),f=n("wsGC"),p=n("Ui7z"),g=new Map,m=function(e){return Boolean(!Object(d.j)()&&e.url&&g.has(e.url))},v=function(e,t){return e.width*e.height>=t.width*t.height},_=function(e,t,n,i){return function(e,t,n,i){var r=Math.abs(n-e.width),a=Math.abs(n-t.width);return r+Math.abs(i-e.height)<=a+Math.abs(i-t.height)}(e,t,n,i)&&(v(e,{width:n,height:i})||v(e,t))&&!(v(t,e)&&m(t)&&!m(e))},b=function(e,t){var n=h.useState({isLoaded:m(t),width:function(e){return!Object(d.j)()&&e.url&&g.has(e.url)?g.get(e.url).width:0}(t),height:function(e){return!Object(d.j)()&&e.url&&g.has(e.url)?g.get(e.url).height:0}(t)}),i=u()(n,2),r=i[0],a=i[1];return h.useEffect(function(){var n=function(e){g.set(t.url,{width:e.width,height:e.height}),a({isLoaded:!0,width:e.width,height:e.height})};if(r.isLoaded!==m(t)&&a(function(e){return o()({},e,{isLoaded:m(t)})}),!r.isLoaded&&t.url){if(c.a.any&&e.current){var i=Object(d.m)(e.current,function(e){e&&Object(d.l)(t.url).then(function(e){n(e),i&&i(),i=null}).catch(function(e){var t=e.target;console.error("Couldn't load ".concat(t.src)),i&&i(),i=null})});return function(){i&&i()}}Object(d.l)(t.url).then(function(e){n(e)}).catch(function(e){var t=e.target;return console.error("Couldn't load ".concat(t.src))})}},[t,r.isLoaded,e]),[r.isLoaded,r.width,r.height]},S=function(e,t,n,i){var r=function(e,t,n){return e.length?e.reduceRight(function(e,i){return _(i,e,t,n)?i:e},e[0]):{url:"",width:1/0,height:1/0,size:0}}(t,n,i),a=b(e,r),o=u()(a,3);return[r,o[0],o[1],o[2]]};t.a=function(e){var t=e.images,n=e.alt,i=e.width,a=e.height,o=e.deferred,s=void 0===o||o,l=e.className,c=h.useRef(null),g=S(c,Array.isArray(t)?t:Object(p.f)(t)?t.images:[],i,a),m=u()(g,2),v=m[0],_=m[1],b=s&&!_,y=Object(d.h)();return h.createElement("div",{ref:c,className:Object(f.a)("image-container",l,{"--loading":!_,"--cover":y})},r()("div",{style:{paddingTop:"".concat(a/i*100,"%")}}),y?r()("div",{"data-selenium":"image",className:"image-container__image","aria-label":n,style:{backgroundImage:b?void 0:"url(".concat(v.url,")")}}):r()("img",{"data-selenium":"image",className:"image-container__image",alt:n,src:b?void 0:v.url}))}},YVF9:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Ep1f"),a=n("62xh"),o=n("czSk"),s=n("ULzY"),u=n("LTZp"),l=function(){r.a.call(this),a.a.call(this),this.viewport=void 0,this._graphicContext=void 0,this._scissor=void 0,this.setClearColor(o.g.fromValues(0,0,0,1)),this.setClearDepth(1),this.setClearMask(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),this.setViewMatrix(o.c.create()),this.setProjectionMatrix(o.c.create()),this.renderOrder=l.NESTED_RENDER,this.renderOrderNum=0,this._view=void 0,this._renderer=void 0,this._attachments={}};l.PRE_RENDER=0,l.NESTED_RENDER=1,l.POST_RENDER=2,l.COLOR_BUFFER_BIT=16384,l.DEPTH_BUFFER_BIT=256,l.STENCIL_BUFFER_BIT=1024,i.a.createPrototypeNode(l,i.a.objectInherit(a.a.prototype,i.a.objectInherit(r.a.prototype,{getView:function(){return this._view},setView:function(e){this._view=e},getRenderer:function(){return this._renderer},setRenderer:function(e){this._renderer=e},setFinalDrawCallback:function(e){this._finalDrawCallback=e},getFinalDrawCallback:function(){return this._finalDrawCallback},setInitialDrawCallback:function(e){this._initialDrawCallback=e},getInitialDrawCallback:function(){return this._initialDrawCallback},getAttachments:function(){return this._attachments},setGraphicContext:function(e){this._graphicContext=e},getGraphicContext:function(){return this._graphicContext},setClearDepth:function(e){this.clearDepth=e},getClearDepth:function(){return this.clearDepth},setClearMask:function(e){this.clearMask=e},getClearMask:function(){return this.clearMask},setClearColor:function(e){this.clearColor=e},getClearColor:function(){return this.clearColor},setViewport:function(e){this.viewport=e,this.getOrCreateStateSet().setAttributeAndModes(e)},getViewport:function(){return this.viewport},setScissor:function(e){this._scissor=e,this.getOrCreateStateSet().setAttributeAndModes(this._scissor)},getScissor:function(){return this._scissor},setViewMatrix:function(e){this.modelviewMatrix=e},setViewMatrixAsLookAt:function(e,t,n){o.c.lookAt(this.getViewMatrix(),e,t,n)},setProjectionMatrix:function(e){this.projectionMatrix=e},setProjectionMatrixAsOrtho:function(e,t,n,i,r,a){o.c.ortho(this.getProjectionMatrix(),e,t,n,i,r,a)},isRenderToTextureCamera:function(){return window.Object.keys(this._attachments).length>0},getViewMatrix:function(){return this.modelviewMatrix},getProjectionMatrix:function(){return this.projectionMatrix},getRenderOrder:function(){return this.renderOrder},setRenderOrder:function(e,t){this.renderOrder=e,this.renderOrderNum=t},getFrameBufferObject:function(){return this.frameBufferObject},setFrameBufferObject:function(e){this.frameBufferObject=e},detachAll:function(){this._attachments={},this.frameBufferObject&&this.frameBufferObject.dirty()},resetAttachments:function(){this.frameBufferObject&&(this.frameBufferObject.reset(),this.frameBufferObject=0),this._attachments={}},attachTexture:function(e,t,n){this.frameBufferObject&&this.frameBufferObject.dirty(),n||(n=s.default.TEXTURE_2D),this._attachments[e]={attachment:e,texture:t,textureTarget:n}},attachRenderBuffer:function(e,t){this.frameBufferObject&&this.frameBufferObject.dirty(),this._attachments[e]={format:t,attachment:e}},computeLocalToWorldMatrix:function(e){return this.referenceFrame===u.a.RELATIVE_RF?o.c.mul(e,e,this.modelviewMatrix):o.c.copy(e,this.modelviewMatrix),!0},computeWorldToLocalMatrix:function(){var e=o.c.create();return function(t){return o.c.invert(e,this.modelviewMatrix),this.referenceFrame===u.a.RELATIVE_RF?o.c.mul(t,e,t):o.c.copy(t,e),!0}}()})),"osg","Camera"),t.a=l},YVvG:function(e,t){e.exports='varying vec3 vLocalVertex;\n\n// common stuffs\nuniform int uOutputLinear;\nuniform float uRGBMRange;\n\nuniform float uEnvironmentExposure;\nuniform float uBackgroundExposure;\n\nuniform vec3 uDiffuseSPH[9];\nuniform samplerCube uTexture0;\nuniform float uSize;\nuniform int uAmbient;\n\nuniform float uFrameModTaaSS;\n\n#pragma include "utils/functions.glsl"\n#pragma include "utils/cubemap.glsl"\n#pragma include "utils/rand.glsl"\n\n// sph env\nvec3 evaluateDiffuseSphericalHarmonics(const in vec3 s[9], const in vec3 n) {\n    // https://github.com/cedricpinson/envtools/blob/master/Cubemap.cpp#L523\n    vec3 result = (s[0]+s[1]*n.y+s[2]*n.z+s[3]*n.x+s[4]*n.y*n.x+s[5]*n.y*n.z+s[6]*(3.0*n.z*n.z-1.0)+s[7]*(n.z*n.x)+s[8]*(n.x*n.x-n.y*n.y));\n    return max(result, vec3(0.0));\n}\n\nvoid main(void) {\n\n    vec3 color;\n    if (uAmbient == 1) {\n        vec3 normal = normalize(vLocalVertex + mix(-0.5/255.0, 0.5/255.0, pseudoRandom(gl_FragCoord.xy))*2.0);\n        // vec3 normal = normalize(vLocalVertex + (interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS) - 0.5) * 0.4);\n        color = evaluateDiffuseSphericalHarmonics(uDiffuseSPH, normal);\n    } else {\n        color = textureCubeFixed(uTexture0, normalize(vLocalVertex), uSize);\n    }\n\n    color *= uEnvironmentExposure * uBackgroundExposure;\n\n    if (uOutputLinear == 0 ) color = linearTosRGB(color);\n\n    gl_FragColor = encodeRGBM(color, uRGBMRange);\n}\n'},YysQ:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var i=n("dZz+"),r=function(e){switch(e.name){case"SecurityError":return console.warn('Add "allow-same-origin" flag to your iframe if you want it to use the service worker.');case"NotSupportedError":return console.warn("Please allow 3rd party cookies if you want the website to use the service worker.");default:return e}};function a(){return i.a.me().canAccessFeature("ff_service_worker")?"serviceWorker"in navigator?navigator.serviceWorker.controller?"controlled":"supported":"unsupported":"closed"}t.a=function(){"serviceWorker"in navigator&&window.addEventListener("load",function(){try{i.a.me().canAccessFeature("ff_service_worker")?navigator.serviceWorker.register("/service-worker.js").then(function(){console.log("Registered service workers.")}).catch(r).catch(function(e){return console.error("ServiceWorker registration failed: ",e)}):function(e){return e&&"function"==typeof e}(navigator.serviceWorker.getRegistrations)&&navigator.serviceWorker.getRegistrations().then(function(e){return e.map(function(e){return e.unregister()})}).then(function(){console.log("Deleted service workers.")}).catch(r).catch(function(e){return console.error("ServiceWorker uneregistration failed: ",e)})}catch(e){r(e)}})}},"Z+Lw":function(e,t,n){"use strict";t.a=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/");return(t>=0||n>=0)&&(document.all&&!window.atob)}},"ZE7+":function(e,t){e.exports='#pragma include "utils/decodeDepth.glsl"\n#pragma include "utils/rand.glsl"\n\nuniform vec2 uLensRadius;\nuniform float uFrameMod;\n\nfloat vignetteDithered() {\n    vec2 lens = uLensRadius;\n    // smoothesp is not realiable with edge0 == edge1\n    lens.y = min(lens.y, lens.x - 1e-4);\n\n    float jitter = interleavedGradientNoise(gl_FragCoord.xy, uFrameMod);\n\n    // jitter a bit the uv to remove the banding in some cases\n    // (lens.x - lens.y) reduce flickering when the vignette is harder (hardness)\n    // (lens.x + lens.y) reduce the flickering when the vignette has a strong radius\n    jitter = (lens.x - lens.y) * (lens.x + lens.y) * 0.07 * (jitter - 0.5);\n    return smoothstep(lens.x, lens.y, jitter + distance(gTexCoord, vec2(0.5)));\n}\n\nvec4 vignette(const in vec4 color) {\n    float factor = vignetteDithered();\n    return vec4(linearTosRGB(sRGBToLinear(color.rgb) * factor), clamp(color.a + (1.0 - factor), 0.0, 1.0));\n}'},ZLu7:function(e,t,n){"use strict";var i=n("qRO0"),r=n("jq0H"),a=n("a3nb"),o=n("czSk"),s=n("b/No"),u=function(){this._clippingMask=0,this._planeList=[r.a.create(),r.a.create(),r.a.create(),r.a.create(),r.a.create(),r.a.create()],this._vertexList=[],this._maskStack=new s.a,this._resultMask=0,this._maskStack.push(this._resultMask)};a.a.createPrototypeObject(u,a.a.objectInherit(i.a.prototype,{getPlanes:function(){return this._planeList},setPlanes:function(e){this._planeList=e,this.setupMask()},clear:function(){if(this._clippingMask=0,this._planeList)for(var e=0,t=this._planeList.length;e<t;++e)r.a.init(this._planeList[e]);this._vertexList=[],this.setupMask()},setToUnitFrustum:function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this._planeList.length=0,this._planeList.push(o.g.set(r.a.create(),1,0,0,1)),this._planeList.push(o.g.set(r.a.create(),-1,0,0,1)),this._planeList.push(o.g.set(r.a.create(),0,1,0,1)),this._planeList.push(o.g.set(r.a.create(),0,-1,0,1)),e&&this._planeList.push(o.g.set(r.a.create(),0,0,1,1)),t&&this._planeList.push(o.g.set(r.a.create(),0,0,-1,1)),this.setupMask()},setToBoundingBox:function(e){this._planeList.length=0,this._planeList.push(o.g.set(r.a.create(),1,0,0,-e.getMin()[0])),this._planeList.push(o.g.set(r.a.create(),-1,0,0,e.getMax()[0])),this._planeList.push(o.g.set(r.a.create(),0,1,0,-e.getMin()[1])),this._planeList.push(o.g.set(r.a.create(),0,-1,0,e.getMax()[1])),this._planeList.push(o.g.set(r.a.create(),0,0,1,-e.getMin()[2])),this._planeList.push(o.g.set(r.a.create(),0,0,-1,e.getMax()[2])),this.setupMask()},setAndTransformProvidingInverse:function(e,t){this._referenceVertexList=e._referenceVertexList;var n=this._maskStack.getLength()-1,i=e._maskStack[n];if(0===i)return this._maskStack.getArray()[n]=0,this._resultMask=0,void(this._planeList.length=0);var a,o=1,s=0;for(a=0;a!==e._planeList.length;++a)i&o&&++s,o<<=1;this._planeList.length=s,this._resultMask=0,o=1;var u=0;for(a=0;a!==e._planeList.length;++a)i&o&&(this._planeList[u]=e._planeList[a],r.a.transformProvidingInverse(this._planeList[u++],t),this._resultMask=this._resultMask<<1|1),o<<=1;this._maskStack.getArray()[n]=this._resultMask},voidset:function(e){this._planeList=e,this.setupMask()},add:function(e){this._planeList.push(e),this.setupMask()},empty:function(){return 0===this._planeList.length},setReferenceVertexList:function(e){this._referenceVertexList=e},getReferenceVertexList:function(){return this._referenceVertexList},setupMask:function(e){this._resultMask=0;for(var t=void 0!==e?e:this._planeList.length,n=0;n<t;++n)this._resultMask=this._resultMask<<1|1;this._maskStack.reset(),this._maskStack.push(this._resultMask)},getCurrentMask:function(){return this._maskStack.back()},setResultMask:function(e){this._resultMask=e},getResultMask:function(){return this._resultMask},getMaskStack:function(){return this._maskStack},pushCurrentMask:function(){this._maskStack.push(this._resultMask)},popCurrentMask:function(){return this._maskStack.pop()},containsVertex:function(e){var t=this._maskStack.back();if(!t)return!0;for(var n=1,i=0;i<this._planeList.length;++i){if(t&n&&r.a.distanceToPlane(this._planeList[i],e)<0)return!1;n<<=1}return!0},containsVertices:function(e){var t=this._maskStack.back();if(!t)return!0;this._resultMask=t;for(var n=0;n<e.length;++n){for(var i=e[n],a=!1,o=1,s=0;!a&&s<this._planeList.length;++s)t&o&&r.a.distanceToPlane(this._planeList[s],i)<0&&(a=!0),o<<=1;if(!a)return!0}return!1},containsBoundingSphere:function(e){var t=this._maskStack.back();if(!t||!e.valid())return!0;this._resultMask=t;for(var n=1,i=0;i<this._planeList.length;++i){if(this._resultMask&n){var a=r.a.intersectsOrContainsBoundingSphere(this._planeList[i],e);if(r.a.OUTSIDE===a)return!1;r.a.INSIDE===a&&(this._resultMask^=n)}n<<=1}return!0},containsBoundingBox:function(e){var t=this._maskStack.back();if(!t)return!0;this._resultMask=t;for(var n=1,i=0;i<this._planeList.length;++i){if(this._resultMask&n){var a=r.a.intersectsOrContainsBoundingBox(this._planeList[i],e);if(r.a.OUTSIDE===a)return!1;r.a.INSIDE===a&&(this._resultMask^=n)}n<<=1}return!0},containsAllOfVertices:function(e){var t=this._maskStack.back();if(!t)return!1;this._resultMask=t;for(var n=1,i=0;i<this._planeList.length;++i){if(this._resultMask&n){if(r.a.intersectsOrContainsVertices(this._planeList[i],e)<1)return!1;this._resultMask^=n}n<<=1}return!0},containsAllOfBoundingSphere:function(e){var t=this._maskStack.back();if(!t)return!1;this._resultMask=t;for(var n=1,i=0;i<this._planeList.length;++i){if(this._resultMask&n){if(r.a.intersectsOrContainsBoundingSphere(this._planeList[i],e)<1)return!1;this._resultMask^=n}n<<=1}return!0},containsAllOfBoundingBox:function(e){var t=this._maskStack.back();if(!t)return!1;this._resultMask=t;for(var n=1,i=0;i<this._planeList.length;++i){if(this._resultMask&n){if(r.a.intersectsOrContainsBoundingBox(this._planeList[i],e)<1)return!1;this._resultMask^=n}n<<=1}return!0},transformProvidingInverse:function(e){var t=this._maskStack.back();if(t){this._resultMask=t;for(var n=1,i=0;i<this._planeList.length;++i)t&n&&r.a.transformProvidingInverse(this._planeList[i],e),n<<=1}}}),"osg","Polytope"),t.a=u},ZjUL:function(e,t,n){var i,r;!function(a,o){"use strict";void 0===(r="function"==typeof(i=function(){var e={};return e.sanitize=function(e,t){var n=["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr","svg","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","switch","symbol","text","textpath","title","tref","tspan","view","vkern","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","#text"],i=!0,r=["accept","action","align","alt","autocomplete","bgcolor","border","checked","cite","class","color","cols","colspan","coords","datetime","default","dir","disabled","download","enctype","for","headers","height","hidden","high","href","hreflang","id","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","novalidate","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","rows","rowspan","spellcheck","scope","selected","shape","size","span","srclang","start","src","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns","accent-height","accumulate","additivive","alignment-baseline","ascent","azimuth","baseline-shift","bias","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dy","dy","direction","display","divisor","dur","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","front-weight","image-rendering","in","in2","k1","k2","k3","k4","kerning","letter-spacing","lighting-color","local","marker-end","marker-mid","marker-start","max","mask","mode","min","operator","opacity","order","overflow","paint-order","path","points","r","rx","ry","radius","restart","scale","seed","shape-rendering","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","transform","text-anchor","text-decoration","text-rendering","u1","u2","viewbox","visibility","word-spacing","wrap","writing-mode","x","x1","x2","y","y1","y2","z","accent","accentunder","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","display","displaystyle","fence","frame","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","xlink:href","xml:id","xlink:title","xml:space"],a=!1,o=!1,s=!1,u=!0,l=!0,c=["a","abbr","acronym","address","article","aside","b","bdi","bdo","big","blink","blockquote","caption","center","cite","code","col","dd","del","details","dfn","dir","div","dl","dt","em","figcaption","figure","footer","h1","h2","h3","h4","h5","h6","header","i","ins","kbd","label","legend","li","main","mark","marquee","nav","ol","output","p","pre","q","rp","rt","ruby","s","samp","section","small","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var"],h=function(e){return document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,function(){return NodeFilter.FILTER_ACCEPT},!1)},d=function(e){if(function(e){return!(e instanceof Text||!(e.children&&!(e.children instanceof HTMLCollection)||e.attributes instanceof NodeList||"string"!=typeof e.nodeName||"string"!=typeof e.textContent||"number"!=typeof e.nodeType||"number"!=typeof e.COMMENT_NODE||"function"!=typeof e.setAttribute||"function"!=typeof e.cloneNode||"function"!=typeof e.removeAttributeNode||"function"!=typeof e.insertAdjacentHTML||"function"!=typeof e.attributes.item))}(e)){try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}return!0}if(e.nodeType===e.COMMENT_NODE||-1===n.indexOf(e.nodeName.toLowerCase())){if(l&&e.insertAdjacentHTML&&e.nodeName.toLowerCase&&-1!==c.indexOf(e.nodeName.toLowerCase()))try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return e.parentNode.removeChild(e),!0}return s&&!e.firstElementChild&&(e.textContent=e.textContent.replace(/</g,"&lt;")),!1},f=function(e){var t,n,a=/^(\w+script|data):/gi,o=e.cloneNode(!0);if(e.attributes)for(var s=e.attributes.length-1;s>=0;s--)t=o.attributes[s],n=!1,e.removeAttribute(e.attributes[s].name),t instanceof Attr&&(u&&("id"===t.name&&window[t.value]&&(n=!0),"name"===t.name&&document[t.value]&&(n=!0)),!(r.indexOf(t.name.toLowerCase())>-1||i&&t.name.match(/^data-[\w-]+/i))||t.value.replace(/[\x00-\x20]/g,"").match(a)&&("src"!==t.name||0!==t.value.indexOf("data:")||"IMG"!==t.ownerElement.nodeName)||n||e.setAttribute(t.name,t.value))},p=function(e){for(var t,n=h(e);t=n.nextNode();)d(t)||(t.content instanceof DocumentFragment&&p(t.content),f(t))};t&&function(e){e.ALLOWED_ATTR&&(r=e.ALLOWED_ATTR),e.ALLOWED_TAGS&&(n=e.ALLOWED_TAGS),e.ALLOW_DATA_ATTR&&(i=e.ALLOW_DATA_ATTR),e.SAFE_FOR_JQUERY&&(s=e.SAFE_FOR_JQUERY),e.WHOLE_DOCUMENT&&(a=e.WHOLE_DOCUMENT),e.RETURN_DOM&&(o=e.RETURN_DOM),e.SANITIZE_DOM&&(u=e.SANITIZE_DOM),e.KEEP_CONTENT&&(l=e.KEEP_CONTENT),e.ADD_ATTR&&(r=r.concat(e.ADD_ATTR)),e.ADD_TAGS&&(n=n.concat(e.ADD_TAGS)),l&&n.push("#text")}(t);var g,m=function(e){var t=document.implementation.createHTMLDocument("");t.body.parentNode.removeChild(t.body.parentNode.firstElementChild),t.body.outerHTML=e,null===t.body&&(t.body.innerHTML=e);var n=a?t.body.parentNode:t.body;if(!(t.body instanceof HTMLBodyElement&&t.body instanceof HTMLHtmlElement)){var i=document.implementation.createHTMLDocument("");n=a?i.getElementsByTagName.call(t,"html")[0]:i.getElementsByTagName.call(t,"body")[0]}return n}(e);if(void 0===m)return"";for(var v=h(m);g=v.nextNode();)d(g)||(g.content instanceof DocumentFragment&&p(g.content),f(g));return o?m:a?m.outerHTML:m.innerHTML},e})?i.call(t,n,t,e):i)||(e.exports=r)}()},a1dx:function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/components/atoms/switch-button.jinja"]={root:function(e,t,n,i,r){var a="";try{var o=i.makeMacro([],["options"],function(r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var o,s="";return s+="\n    ",o=e.getFilter("merge").call(t,{name:"",isChecked:!1,disabled:!1},i.contextOrFrameLookup(t,n,"options")),n.set("options",o,!0),n.topLevel&&t.setVariable("options",o),n.topLevel&&t.addExport("options",o),s+='\n    <div class="form-onoff-wrapper ',s+=i.suppressValue(e.getFilter("class_names").call(t,{"--checked":i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"isChecked")}),e.opts.autoescape),s+='">\n        <input\n            id="',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"name"),e.opts.autoescape),s+='"\n            class="form-onoff"\n            type="checkbox"\n            name="',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"name"),e.opts.autoescape),s+='"\n            data-ref="input"\n            ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"isChecked")&&(s+=' checked="checked"'),s+=' />\n        <label\n            class="',s+=i.suppressValue(e.getFilter("class_names").call(t,{"form-onoff-actor":!0,disabled:i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"disabled")}),e.opts.autoescape),s+='"\n            for="',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"name"),e.opts.autoescape),s+='"></label>\n    </div>\n',n=a,new i.SafeString(s)});t.addExport("switch_button"),t.setVariable("switch_button",o),r(null,a+="\n")}catch(e){r(i.handleError(e,null,null))}}}},a3nb:function(e,t,n){"use strict";var i=n("9oTK"),r=n.n(i),a=n("zP/P"),o=n("icjm"),s={extend:function(){var e,t,n,i,r=window.Object.prototype.toString,a=window.Object.prototype.hasOwnProperty,o=s.isArray,u=function(e){if(!e||"[object Object]"!==r.call(e)||e.nodeType||e.setInterval)return!1;if(e.constructor&&!a.call(e,"constructor")&&!a.call(e.constructor.prototype,"isPrototypeOf"))return!1;var t;for(t in e);return void 0===t||a.call(e,t)},l=arguments[0]||{},c=1,h=arguments.length,d=!1;for("boolean"==typeof l&&(d=l,l=arguments[1]||{},c=2),"object"==typeof l||function(e){return"[object Function]"===r.call(e)}(l)||(l={}),h===c&&(l=this,--c);c<h;c++)if(null!==(e=arguments[c]))for(t in e)if(n=l[t],l!==(i=e[t]))if(d&&i&&(u(i)||o(i))){var f=n&&(u(n)||o(n))?n:o(i)?[]:{};l[t]=s.extend(d,f,i)}else void 0!==i&&(l[t]=i);return l},objectInherit:function(e){function t(){}t.prototype=e;for(var n=new t,i=1;i<arguments.length;i++)s.objectMix(n,arguments[i],!1);return n},objectMix:function(e,t,n){for(var i in t)n&&e[i]||(e[i]=t[i]);return e},objectType:{}};s.objectType.type=0,s.arrayDense=function(e,t,n){var i=t.length;if(e>=i)for(var r=i;r<=e;r++)t.push(n?n():null)},s.objectLibraryClass=function(e,t,n){e.className=function(){return n},e.libraryName=function(){return t};var i=t+"::"+n;return e.libraryClassName=function(){return i},e},s.setTypeID=function(e){var t=e.prototype.libraryClassName(),n=s.generateId(s.objectType,t);e.typeID=e.prototype.typeID=n,e.getTypeID=e.prototype.getTypeID=function(){return n}},s.createPrototypeObject=function(e,t,n,i){t.hasOwnProperty("getTypeID")&&(t=s.objectInherit(t,{})),e.prototype=t,t.constructor=e,n&&i&&(s.objectLibraryClass(t,n,i),s.setTypeID(e))},s.generateId=function(e,t){if(void 0!==e[t])return o.a.error(t+" is already defined, change class name or library name"),-1;var n=e.type;return e[n]=t,e[t]=n,e.type+=1,n},s.objectNodeType={},s.objectNodeType.type=0,s.setNodeTypeID=function(e){var t=e.prototype.libraryClassName(),n=s.generateId(s.objectNodeType,t);e.nodeTypeID=e.prototype.nodeTypeID=n,e.getNodeTypeID=e.prototype.getNodeTypeID=function(){return n}},s.createPrototypeNode=function(e,t,i,r){var a=n("olBt").default,o=t.nodeTypeID;if(s.createPrototypeObject(e,t,i,r),i&&r){s.setNodeTypeID(e);var u=e.nodeTypeID;s.arrayDense(u,a.applyFunctionArray),a.registerApplyFunction(u,a.getApplyFunction(o))}};var u=0,l=0,c={},h={},d=0,f={};s.getStateAttributeTypeNameToTypeId=function(){return f},s.createPrototypeStateAttribute=function(e,t,n,i){s.createPrototypeObject(e,t,n,i);var r=s.getOrCreateStateAttributeTypeId(e);e.prototype.attributeTypeId=r},s.getMaxStateAttributeTypeID=function(){return d},s.getOrCreateStateAttributeTypeId=function(e){var t=e.prototype.getType();if(f[t])return f[t];var n=d++;return f[t]=n,n},s.getOrCreateStateAttributeTypeMemberIndex=function(e){if(void 0!==e._attributeTypeIndex)return e._attributeTypeIndex;var t=e.getTypeMember();return e._attributeTypeIndex=s.getOrCreateStateAttributeTypeMemberIndexFromName(t),e._attributeTypeIndex},s.getOrCreateStateAttributeTypeMemberIndexFromName=function(e){var t=c[e];return void 0!==t?t:(t=u++,c[e]=t,t)},s.getOrCreateTextureStateAttributeTypeMemberIndex=function(e){if(void 0!==e._attributeTypeIndex)return e._attributeTypeIndex;var t=e.getTypeMember();return e._attributeTypeIndex=s.getOrCreateTextureStateAttributeTypeMemberIndexFromName(t),e._attributeTypeIndex},s.getOrCreateTextureStateAttributeTypeMemberIndexFromName=function(e){var t=h[e];return void 0!==t?t:(t=l++,h[e]=t,t)},s.getIdFromTypeMember=function(e){return c[e]},s.getTextureIdFromTypeMember=function(e){return h[e]},s.Int8Array=window.Int8Array,s.Uint8Array=window.Uint8Array,s.Uint8ClampedArray=window.Uint8ClampedArray,s.Int16Array=window.Int16Array,s.Uint16Array=window.Uint16Array,s.Int32Array=window.Int32Array,s.Uint32Array=window.Uint32Array,s.Float32Array=window.Float32Array,s.Float64Array=window.Float64Array;var p={},g={};s.logTime=(o.a.console.time||function(e){p[e]=a.a.instance().tick()}).bind(o.a.console),s.logTimeEnd=(o.a.console.timeEnd||function(e){if(void 0!==p[e]){var t=a.a.instance().deltaM(p[e],a.a.instance().tick());o.a.log(e+": "+t+"ms"),p[e]=void 0}}).bind(o.a.console),s.time=function(e,t){var n=t;void 0===n&&(n=o.a.NOTICE),n>o.a.getNotifyLevel()||(g[e]=1,s.logTime(e))},s.timeEnd=function(e){void 0!==g[e]&&s.logTimeEnd(e)},s.profile=(o.a.console.profile||function(){}).bind(o.a.console),s.profileEnd=(o.a.console.profileEnd||function(){}).bind(o.a.console),s.arrayUniq=function(e){for(var t=e.length,n={},i=[],r=0,a=0;a<t;a++){var o=e[a];1!==n[o]&&(n[o]=1,i[r++]=o)}return i},s.rejectObject=function(e,t){return t&&(e="Invalid json "+e+" "+Object.keys(t)),o.a.warn(e),r.a.reject(e)},s.setStateAttributeConfig=function(e,t){e.stateAttributeConfig=t,t.attribute.forEach(s.getOrCreateStateAttributeTypeMemberIndexFromName),t.textureAttribute.forEach(s.getOrCreateTextureStateAttributeTypeMemberIndexFromName),e.validAttributeTypeMember=t.attribute,e.validTextureAttributeTypeMember=t.textureAttribute},t.a=s},a5AJ:function(e,t,n){"use strict";var i=n("MVZn"),r=n.n(i),a=n("QILm"),o=n.n(a),s=n("lwsE"),u=n.n(s),l=n("W8MJ"),c=n.n(l),h=n("lSNA"),d=n.n(h),f=n("gPpI"),p=new(function(){function e(){var t=this;u()(this,e),d()(this,"listeners",[]),d()(this,"currentUrl",void 0),d()(this,"shouldConfirmNavigation",!1),this.currentUrl=this.getWindowUrl(),window.addEventListener("popstate",function(){if(t.confirmNavigation())window.location.hash||(t.hasPrevious()?t.onBack():t.push(t.getWindowUrl(),{force:!0}));else{var e={isBack:!1,previousUrl:t.getWindowUrl()};window.history.pushState(e,"",Object(f.a)(t.currentUrl))}}),window.addEventListener("beforeunload",function(e){t.shouldConfirmNavigation&&(e.returnValue="preventPageReload")})}return c()(e,[{key:"callListeners",value:function(e,t){var n=t.isBack,i=void 0!==n&&n,a=o()(t,["isBack"]);this.listeners.forEach(function(t){return t(e,r()({},a,{isBack:i}))})}},{key:"onBack",value:function(){var e=this.currentUrl,t=this.getWindowUrl();this.callListeners(t,r()({},window.history.state,{previousUrl:e,isBack:!0})),this.currentUrl=t}},{key:"setCurrentUrl",value:function(e){this.currentUrl=e}},{key:"shouldUpdate",value:function(e){return this.getWindowUrl()!==e}},{key:"confirmNavigation",value:function(){if(!this.shouldConfirmNavigation)return!0;var e=confirm("This page is asking you to confirm that you want to leave - data you have entered may not be saved.");return e&&this.disableConfirmNavigation(),e}},{key:"enableConfirmNavigation",value:function(){this.shouldConfirmNavigation=!0}},{key:"disableConfirmNavigation",value:function(){this.shouldConfirmNavigation=!1}},{key:"getWindowUrl",value:function(){return window.location.pathname+window.location.search}},{key:"hasPrevious",value:function(){return window.history.length>2}},{key:"listen",value:function(e){var t=this;this.listeners.push(e);return function(){t.listeners=t.listeners.filter(function(t){return t!==e})}}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((!!t.silent||this.confirmNavigation())&&(this.setCurrentUrl(e),t.force||this.shouldUpdate(e))){var n=r()({},t,{isBack:!1,previousUrl:this.getWindowUrl()});window.history.pushState(n,"",Object(f.a)(e)),t.silent||this.callListeners(e,n)}}},{key:"pushRoute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object(f.e)(e,t);i&&this.push(i,n)}},{key:"replace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.setCurrentUrl(e),this.shouldUpdate(e)){var n=r()({},t,{isBack:!1,previousUrl:this.getWindowUrl()});window.history.replaceState(n,"",Object(f.a)(e)),t.silent||this.callListeners(e,n)}}},{key:"replaceRoute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object(f.e)(e,t);i&&this.replace(i,n)}},{key:"back",value:function(){this.confirmNavigation()&&window.history.back()}}]),e}());t.a=p},a5Z4:function(e,t,n){"use strict";n.r(t);var i=n("QLQS").a.osg,r=!0,a=i.Timer.prototype.tick,o=function(){this.children=[],this.message="",this.parent=this},s={},u={},l=new o,c=l,h=function(e){console.log("%c"+e,"color:purple")};i.time=function(e){var t=new o;s[e]=t,t.start=a(),r&&(c.children.push(t),t.parent=c,c=t,t.timerMessage=e)},i.timeEnd=function(e){var t=s[e],n=e+" : "+(a()-t.start).toFixed(2)+"ms";r?(c=t.parent||l,t.message=n):u.logMessage(n)};var d=function(e,t){var n=!e.message,i=e.children,r="";e!==l&&i.length>0&&(r=t+e.timerMessage+(n?"(pending)\n\n":"\n"));for(var a=e===l||n?"":"  |  ",o=0;o<i.length;++o)r+=d(i[o],t+a)+"\n";var s=(e.parent===l||!e.parent.message)&&e.timerMessage?"\n":"";return r+(t+e.message)+s};u.showMessage=function(){var e=d(l,"");e=e.replace(/(\n*$)/,"");var t=window.performance&&window.performance.now?(window.performance.now()/1e3).toString():"";h(e+="\n\n<<<<< Model Displayed! "+t+">>>>>"),r=!1},u.logBound=function(e){var t=e.center(i.vec3.create()),n="Bound center : [ "+t[0]+", "+t[1]+", "+t[2]+" ]\n";n+="Bound radius : "+e.radius()+"\n";var r=e.getMin(),a=e.getMax();n+="Bbox min : [ "+r[0]+", "+r[1]+", "+r[2]+" ]\n",n+="Bbox max : [ "+a[0]+", "+a[1]+", "+a[2]+" ]\n",u.logMessage(n)},u.logMessage=function(e){if(!r)return h(e);var t=new o;t.message=e,c.children.push(t),t.parent=c},t.default=u},aRm7:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"get",function(){return i}),n.d(t,"set",function(){return r}),n.d(t,"remove",function(){return a}),n.d(t,"getJSON",function(){return o}),n.d(t,"setJSON",function(){return s});var i=function(e){return localStorage.getItem(e)},r=function(e,t){return localStorage.setItem(e,t)},a=function(e){return localStorage.removeItem(e)},o=function(t){return new e(function(e){return e(JSON.parse(i(t)))})},s=function(e,t){return r(e,JSON.stringify(t))}}.call(this,n("CSL1"))},aUsF:function(e,t,n){"use strict";var i=Array.isArray,r=Object.keys,a=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;var o,s,u,l=i(t),c=i(n);if(l&&c){if((s=t.length)!=n.length)return!1;for(o=0;o<s;o++)if(!e(t[o],n[o]))return!1;return!0}if(l!=c)return!1;var h=t instanceof Date,d=n instanceof Date;if(h!=d)return!1;if(h&&d)return t.getTime()==n.getTime();var f=t instanceof RegExp,p=n instanceof RegExp;if(f!=p)return!1;if(f&&p)return t.toString()==n.toString();if(t instanceof Object&&n instanceof Object){var g=r(t);if((s=g.length)!==r(n).length)return!1;for(o=0;o<s;o++)if(!a.call(n,g[o]))return!1;for(o=0;o<s;o++)if(!e(t[u=g[o]],n[u]))return!1;return!0}return!1}},aabx:function(e,t){e.exports="\n// white vs interleaved vs blue noise\n// https://blog.demofox.org/2017/10/31/animating-noise-for-integration-over-time/\n\n// to test in a shadertoy\n// https://www.shadertoy.com/view/lsdfD4\n\n// https://www.shadertoy.com/view/4djSRW\n// most combinations are possible : in[1,2,3] -> out[1,2,3]\n#define INT_SCALE1 .1031\nfloat pseudoRandom(const in vec2 fragCoord) {\n    vec3 p3  = fract(vec3(fragCoord.xyx) * INT_SCALE1);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/Random.ush#L27\nfloat interleavedGradientNoise(const in vec2 fragCoord, const in float frameMod) {\n    vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);\n    return fract(magic.z * fract(dot(fragCoord.xy + frameMod * vec2(47.0, 17.0) * 0.695, magic.xy)));\n}\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/MaterialTemplate.ush#L1863\n// we slighty change it by multiplying by 1.2 (to match with other noise), otherwise the range seems to be between [0 - 0.83]\nfloat ditheringNoise(const in vec2 fragCoord, const in float frameMod) {\n    // float fm = mod(frameMod, 2.0) == 0.0 ? 1.0 : -1.0;\n    float fm = frameMod;\n    float dither5 = fract((fragCoord.x + fragCoord.y * 2.0 - 1.5 + fm) / 5.0);\n    float noise = fract(dot(vec2(171.0, 231.0) / 71.0, fragCoord.xy));\n    return (dither5 * 5.0 + noise) * (1.2 / 6.0);\n}\n\nvoid ditheringMaskingDiscard(\n    const in vec4 fragCoord,\n    const in int dithering,\n    const in float alpha,\n    const in float factor,\n\n    const in float thinLayer,\n\n    const in float frameMod,\n    const in vec2 nearFar,\n\n    const in vec4 halton) {\n\n    if (dithering != 1) {\n        if (alpha < factor) discard;\n        return;\n    }\n\n    float rnd;\n\n    if (thinLayer == 0.0) {\n        float linZ = (1.0 / fragCoord.w - nearFar.x) / (nearFar.y - nearFar.x);\n        float sliceZ = floor(linZ * 500.0) / 500.0;\n        rnd = interleavedGradientNoise(fragCoord.xy + sliceZ, frameMod);\n    } else {\n        rnd = pseudoRandom(fragCoord.xy + halton.xy * 1000.0 + fragCoord.z * (abs(halton.z) == 2.0 ? 1000.0 : 1.0));\n    }\n\n    if (alpha * factor < rnd) discard;\n}\n"},alNo:function(e,t){e.exports='attribute float Offset;\nuniform float uScale;\n\n#define HAS_MODEL_VERTEX\n#define HAS_MODEL_TANGENT\n\n#define INJECT_VERT gl_Position = uProjectionMatrix * uViewMatrix * vec4(Offset == 1.0 ? vModelVertex + normalize(vModelTangent) * uScale : vModelVertex, 1.0);\n\n#pragma include "base.vert"\n'},apoH:function(e,t){e.exports="uniform float uVrFadeFactor;\r\n\r\nvec4 fadeVr(const in vec4 color) {\r\n\treturn vec4(mix(color.rgb, vec3(0.0), clamp(uVrFadeFactor, 0.0, 1.0)), color.a);\r\n}"},"b/No":function(e,t,n){"use strict";var i=function(){this._pool=[],this._length=0};i.prototype={clean:function(){this._length=0,this._pool.length=0},reset:function(){this._length=0},getLength:function(){return this._length},getArray:function(){return this._pool},back:function(){return this._pool[this._length-1]},pop:function(){return this._length--,this._pool[this._length]},push:function(e){this._length===this._pool.length?this._pool.push(e):this._pool[this._length]=e,this._length++},forEach:function(e){for(var t=0;t<this._length;t++)e(this._pool[t])}},t.a=i},bLLl:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("+lWh"),r=function(e){return{getInitialPropsOf:function(t){var n=e.ssrProps;return(void 0===n?{}:n)[t]||{}},hasInitialPropsOf:function(t){var n=e.ssrProps;return Boolean((void 0===n?{}:n)[t])},get:function(t){return e[t]},register:function(t,n){e[t]=n},invalidate:function(t){var n=t.replace(/\?.*$/,"");Object.keys(e).forEach(function(t){var i=t.replace(/\?.*$/,"");n===i&&(e[t]=void 0)})},invalidateAllMatchRegExp:function(t){Object.keys(e).forEach(function(n){t.test(n)&&(e[n]=void 0)})}}},a=r((window.prefetchedData||(window.prefetchedData=Object(i.o)("prefetched-data","json")),window.prefetchedData));t.b=a},bXkX:function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),a=n("J4zp"),o=n.n(a),s=n("q1tI"),u=n("XiPH"),l=n("M4AY"),c=n("fujP"),h=n("Muja"),d=n("vJtL"),f=n("wHZf"),p=n("rC6e"),g=n("NpZ0");t.a=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=Object(s.useContext)(f.EffectContext),m=Object(s.useState)(t),v=o()(m,2),_=v[0],b=v[1],S=Object(s.useRef)(t),y=Object(s.useRef)({}),x=Object(s.useRef)(!0),C=Object(s.useCallback)(function(e){var t=Object(u.b)(e,n).entities;Object(c.a)(t)||Object(h.a)(t,y.current)||(y.current=t,x.current=!0,l.b.store.dispatch(l.a.entities.update(t)),x.current=!1)},[n]),w=Object(s.useCallback)(function(){return S.current},[]),T=Object(s.useCallback)(function(e){S.current=Object(d.a)(e)?e(S.current):e,b(S.current),C(S.current)},[C]);Object(s.useEffect)(function(){return Object(g.c)(l.b.store,l.c.entities.all,function(e){x.current||function(e){var t=Object(u.b)(S.current,n).result,i=Object(u.a)(t,n,e);S.current=i,b(i)}(e)})},[n]);var M=Object(s.useMemo)(function(){return[Object(f.createEffectMiddleware)(a)].concat(r()(i))},[a]),E=Object(p.a)(w,T,e,M);return[_,o()(E,2)[1]]}},bd6H:function(e,t,n){"use strict";n.d(t,"c",function(){return m}),n.d(t,"b",function(){return v}),n.d(t,"a",function(){return _});var i,r=n("cDf5"),a=n.n(r),o=n("lwsE"),s=n.n(o),u=n("W8MJ"),l=n.n(u),c=n("lSNA"),h=n.n(c),d=n("MVZn"),f=n.n(d),p=n("a5AJ");!function(e){e.Push="push",e.Replace="replace",e.Reload="reload",e.NoOp="noOp"}(i||(i={}));var g=function(e){var t=e.name,n=e.test,i=e.onCreate,r={type:e.type,name:t,test:n,lifecycle:{onRemove:function(){},onUpdate:function(){return!1},onStartHandling:function(){},onStopHandling:function(){},onCreate:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){r.lifecycle=f()({},r.lifecycle,i.apply(void 0,arguments)||{})})}};return r},m={push:function(e){return{type:i.Push,onCreate:e}},replace:function(e){return{type:i.Replace,onCreate:e}},reload:function(){return{type:i.Reload}},noOp:function(){return{type:i.NoOp}}},v=function(){window.scrollTo(0,0),window.location.reload()},_=function(){function e(){var t=this;s()(this,e),h()(this,"isInit",!0),h()(this,"routes",[]),h()(this,"activeRoutesStack",[]),h()(this,"handlingRoute",null),h()(this,"onHistoryChange",void 0);var n=function(e){t.handlingRoute!==e&&e.lifecycle.onStartHandling(),t.handlingRoute=e},r=function(e){var i=t.activeRoutesStack[0];i&&function(e){t.handlingRoute===e&&e.lifecycle.onStopHandling(),t.handlingRoute=null}(i),t.activeRoutesStack.unshift(e),e.lifecycle.onCreate(),n(e)},o=function(e){e.lifecycle.onRemove(),t.activeRoutesStack=t.activeRoutesStack.filter(function(t){return t!==e})};this.onHistoryChange=function(e,s){var u=t.isInit;t.isInit=!1;var l=!0,c=!1,h=void 0;try{for(var d,p=function(){var a=d.value,l=a.name,c=a.test,h=a.handler;if(c(e).caseOf({None:function(){return!1},Some:function(e){var a=f()({},s,{isInit:u,activeRoutes:t.activeRoutesStack}),d=h(e,a);switch(d.type){case i.Replace:case i.Push:return function(e,a,s){var u=!0,l=!1,c=void 0;try{for(var h,d=t.activeRoutesStack[Symbol.iterator]();!(u=(h=d.next()).done);u=!0){var f=h.value;if(f.test===e.test&&f.lifecycle.onUpdate(a,s))return void n(f);(e.type===i.Replace||f.type===i.Push&&s.isBack)&&o(f)}}catch(e){l=!0,c=e}finally{try{u||null==d.return||d.return()}finally{if(l)throw c}}r(e)}(g({type:d.type,name:l,test:c,onCreate:d.onCreate}),e,a),!0;case"reload":return v(),!0;case"noOp":return!0}}}))return{v:void 0}},m=t.routes[Symbol.iterator]();!(l=(d=m.next()).done);l=!0){var _=p();if("object"===a()(_))return _.v}}catch(e){c=!0,h=e}finally{try{l||null==m.return||m.return()}finally{if(c)throw h}}s.isBack&&v()},p.a.listen(this.onHistoryChange)}return l()(e,[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i=0;i<t.length;i++){var r=t[i];this.routes.push(r)}return this}},{key:"start",value:function(){this.onHistoryChange(p.a.getWindowUrl(),{isBack:!1})}}]),e}()},bjo4:function(e,t){e.exports='#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureSSSColor;\nuniform vec2 uTextureSSSColorSize;\n\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uProjFactor;\nuniform float uScatteringFactorPacker;\n\n#pragma include "sssCommon.glsl"\n\nuniform sampler2D TextureSSSBlur;\nuniform sampler2D TextureDepth;\n\nvec4 sssCombine() {\n    // full res - not SSS\n    vec4 pack = TEXTURE_2D_TextureDepth(gTexCoord);\n    int profile = decodeProfile(pack);\n    // black pixels for background or non sss surfaces\n    if (pack.x == 1.0 || profile == 0) {\n        return TEXTURE_2D_TextureSSSColor(gTexCoord);\n    }\n\n    vec3 specular;\n    vec3 diffuse;\n    uncheckerboard(diffuse, specular);\n\n    // try to retain high res detail as much as possible (same ad dof)\n    // make sure to use a factor that is independent from bounding box\n    float scatterWorld = decodeScatter(pack) / uScatteringFactorPacker;\n    float worldPos = uNearFar.x + (uNearFar.y - uNearFar.x) * decodeDepth(pack);\n    float factor = uProjFactor * scatterWorld / worldPos;\n    \n    // magic factor 10 (can be tweaked, e.g: if sss effects disappears too fast when we are far away)\n    factor = smoothstep(0.05, 0.3, factor * 10.0);\n    // return vec4(vec3(factor), 1.0);\n\n    diffuse = mix(diffuse, TEXTURE_2D_TextureSSSBlur(gTexCoord).rgb, factor);\n\n    return vec4(diffuse + specular, 1.0);\n}\n'},bud1:function(e,t,n){"use strict";(function(e){var i=n("cDf5"),r=n.n(i),a=n("q1z7"),o=n.n(a),s=n("xjMu"),u=n("12sq"),l=n("UIJo"),c=n("oaNE"),h=n("yktj");t.a=s.a.extend({getModelOptionPath:function(){return"#.definitions.soundtrack"},getName:function(){return"Soundtrack"},initDefaults:function(e){var t=this._flattenObject(e,this._typeMap);this.set(Object(c.a)(t,this.attributes)),this.get("uid")||this.set("uid","tmp_"+this.get("cid"))},defaults:function(){return{cid:this.cid,lastComputedScenePosition:[0,0,0],lastComputedWorldPosition:[0,0,0]}},isNew:function(){var e=this.get("uid");return void 0===e||!(!e||!e.toString().startsWith("tmp_"))},makeUrl:function(){return h.a.domain+"/sounds".concat(this.isNew()?"":"/".concat(this.get("uid")))},duplicate:function(){var e=new this.constructor;return e.setJSON(this.getJSON()),e.set("name",this.get("name")),e.set("url",this.get("url")),e.set("files",this.get("files")),e},save:function(t,n){if(!this.isNew())return e.resolve();null!=t&&"object"!==r()(t)||(n=t);var i=new FormData;i.append("soundFile",this.get("files")[0]),i.append("name",this.get("name")),i.append("model",n.modelUID);var a=this;return e.resolve(o.a.ajax({type:"POST",url:this.makeUrl(),data:i,processData:!1,contentType:!1})).then(function(e){a.set("uid",e.uid)})}},Object(l.a)({fileTypes:u.a.soundFiletypes,maxFileSize:u.a.maxSoundFilesize}))}).call(this,n("CSL1"))},bx6R:function(e,t,n){"use strict";(function(e){n.d(t,"g",function(){return g}),n.d(t,"c",function(){return v}),n.d(t,"d",function(){return _}),n.d(t,"e",function(){return S}),n.d(t,"f",function(){return y}),n.d(t,"b",function(){return x}),n.d(t,"a",function(){return C});var i=n("MVZn"),r=n.n(i),a=n("Muja"),o=n("bLLl"),s=n("RzKY"),u=n("bd6H"),l=n("q1tI"),c=n.n(l),h=n("i8i4"),d=n("M4AY"),f=n("gPpI"),p=n("XsDm"),g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.b,n="string"==typeof e?[e]:e;return function(e){return n.reduce(function(n,i){return n.caseOf({Some:function(e){return Object(p.b)(e)},None:function(){var n=t(i,e);return n?Object(p.b)(n):p.a}})},p.a)}},m=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.a;return function(i,r){return u.c.replace(function(){if(r.isInit){var a=e.resolve(t(i));return{onStartHandling:function(){a.then(function(e){return e.setOptions({isCurrentRoute:!0})})},onStopHandling:function(){a.then(function(e){return e.setOptions({isCurrentRoute:!1})})},onUpdate:function(e){if(n(i,e))return!0;Object(u.b)()},onRemove:function(){}}}Object(u.b)()})}},v=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).hasUpdated;return{name:("string"==typeof e?[e]:e).join(","),test:g(e),handler:m(t,n)}},_=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).hasUpdated;return{name:e,test:g(e,f.c),handler:m(t,n)}},b=function(e){return function(t){return u.c.replace(function(){return e(t),{onUpdate:function(t){return e(t),!0}}})}},S=function(e,t){return{name:("string"==typeof e?[e]:e).join(","),test:g(e),handler:b(t)}},y=function(e,t){return{name:e,test:g(e,f.c),handler:b(t)}},x=function(t,n){return function(i,a){return u.c.replace(function(){var l={routeParams:i,isCurrentRoute:!0},f=s.a.fromPromise(a.isInit&&o.b.hasInitialPropsOf(n)?e.resolve(o.b.getInitialPropsOf(n)):t.prepare?t.prepare({services:r()({},d.b.services,{dispatch:d.b.store.dispatch,getState:d.b.store.getState}),props:l,isServer:!1}):e.resolve({})),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l=r()({},l,e),f.then(function(e){var i=document.getElementById("root");if(!i)return console.error("renderReactPage Error: no '#root' element found on page ".concat(name," coming from ").concat(a.previousUrl,". Reloading")),Object(u.b)();n&&Object(h.unmountComponentAtNode)(i),Object(h.render)(c.a.createElement(d.b.Provider,null,c.a.createElement(t,r()({},l,e))),i)}).catch(function(e){return console.error("renderReactPage error:",e)})};return p({},!0),{onUpdate:function(e){return p({routeParams:e}),!0},onStartHandling:function(){p({isCurrentRoute:!0})},onStopHandling:function(){p({isCurrentRoute:!1})},onRemove:function(){f.cancel()}}})}},C=function(e,t,n){return{name:("string"==typeof e?[e]:e).join(","),test:g(e),handler:x(t,n)}}}).call(this,n("CSL1"))},c1T2:function(e,t,n){"use strict";var i=n("nzRv"),r=n("gCTM"),a=n("89mf"),o=n("77vZ"),s=n("f5KD"),u=n("nPtx"),l=i.a.extend({displayName:"MessagePopupContent",template:function(){var e=this.options,t=e.buttons,n=void 0===t?[]:t,i=e.children,a=void 0===i?[]:i;return r.default.getFromString('\n                <div class="c-message-popup">\n                    <div class="c-message-popup__content">\n                        {{ options.html | safe }}\n                        {% if options.text %}\n                            <p class="c-message-popup__text">{{ options.text }}</p>\n                        {% endif %}\n                        {{ components.children | component }}\n                    </div>\n                    {% if components.buttons.length %}\n                        <div class="c-message-popup__buttons">\n                            {{ components.buttons | component }}\n                        </div>\n                    {% endif %}\n                </div>\n                ',{options:this.options,components:this.createChildrenComponents({buttons:n,children:a})})}});t.a=Object(o.a)(i.a.extend({displayName:"MessagePopup",optionTypes:{title:s.b.string.isRequired,popup:s.b.object.isRequired,text:s.b.string,html:s.b.string,children:s.b.component,width:s.b.number,renderButtons:s.b.func},defaultOptions:{title:"",text:"",html:"",width:450,shouldRejectOnCancel:!0,renderButtons:a.d},template:function(){return r.default.getFromString("{{ components.popup | component }}",{components:this.createChildrenComponents({popup:{viewClass:u.a,options:{title:this.options.title,width:this.options.width,child:{viewClass:l,options:{html:this.options.html,text:this.options.text,children:this.options.children,buttons:this.options.renderButtons(this.options.popup)}}}}})})}}))},c2bz:function(e,t,n){n("jWd+"),(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/popups/message.jinja"]={b_popup_content:function(e,t,n,i,r){var a="";try{n=n.push(!0),a+="\n\n    ",i.contextOrFrameLookup(t,n,"safe")?(a+="\n        ",a+=i.suppressValue(e.getFilter("safe").call(t,i.contextOrFrameLookup(t,n,"text")),e.opts.autoescape),a+="\n    "):(a+="\n        ",a+=i.suppressValue(i.contextOrFrameLookup(t,n,"text"),e.opts.autoescape),a+="\n    "),r(null,a+="\n\n")}catch(e){r(i.handleError(e,null,null))}},b_popup_footer:function(e,t,n,i,r){var a="";try{n=n.push(!0),a+='\n    <div class="actions">\n\n        ',a+="\n        ",a+="\n\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"cancel")&&(a+='\n            <button class="button btn-medium btn-tertiary cancel',i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"cancelClass")&&(a+=" ",a+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"cancelClass"),e.opts.autoescape)),a+='" type="reset">',a+=i.suppressValue(e.getFilter("default").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"cancelLabel"),"Cancel"),e.opts.autoescape),a+="</button>\n        "),a+="\n\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"close")&&(a+='\n            <button class="button btn-medium btn-tertiary',i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"cancelClass")&&(a+=" ",a+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"closeClass"),e.opts.autoescape)),a+='" type="reset" data-action="close">',a+=i.suppressValue(e.getFilter("default").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"closeLabel"),"Close"),e.opts.autoescape),a+="</button>\n        "),a+="\n\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"continue")&&(a+='\n            <button class="button btn-medium btn-primary submit',i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"continueClass")&&(a+=" ",a+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"continueClass"),e.opts.autoescape)),a+='" type="submit">',a+=i.suppressValue(e.getFilter("default").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"continueLabel"),"Continue"),e.opts.autoescape),a+="</button>\n        "),a+="\n\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"ok")&&(a+='\n            <button class="button btn-medium btn-primary submit',i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"okClass")&&(a+=" ",a+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"okClass"),e.opts.autoescape)),a+='" type="submit">',a+=i.suppressValue(e.getFilter("default").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"okLabel"),"OK"),e.opts.autoescape),a+="</button>\n        "),a+="\n\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"delete")&&(a+='\n            <button class="button btn-medium btn-danger submit',i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"deleteClass")&&(a+=" ",a+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"deleteClass"),e.opts.autoescape)),a+='" type="submit">',a+=i.suppressValue(e.getFilter("default").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"buttons"),"deleteLabel"),"Delete"),e.opts.autoescape),a+="</button>\n        "),r(null,a+="\n\n    </div>\n")}catch(e){r(i.handleError(e,null,null))}},root:function(e,t,n,i,r){var a="";try{var o=null;e.getTemplate("skfb_front/layouts/popup.jinja",!0,"skfb_front/popups/message.jinja",!1,function(s,u){if(s)r(s);else{for(var l in(o=u).blocks)t.addBlock(l,o.blocks[l]);var c,h;a+="\n\n",c=i.contextOrFrameLookup(t,n,"title"),n.set("popupTitle",c,!0),n.topLevel&&t.setVariable("popupTitle",c),n.topLevel&&t.addExport("popupTitle",c),a+="\n\n",i.contextOrFrameLookup(t,n,"popupClass")||(a+="\n    ",h="popup-message",n.set("popupClass",h,!0),n.topLevel&&t.setVariable("popupClass",h),n.topLevel&&t.addExport("popupClass",h),a+="\n"),a+="\n\n",(o?function(e,t,n,i,r){r("")}:t.getBlock("popup_content"))(e,t,n,i,function(s,u){s?r(s):(a+=u,a+="\n\n",(o?function(e,t,n,i,r){r("")}:t.getBlock("popup_footer"))(e,t,n,i,function(s,u){s?r(s):(a+=u,a+="\n",o?o.rootRenderFunc(e,t,n,i,r):r(null,a))}))})}})}catch(e){r(i.handleError(e,null,null))}}}},c4eT:function(e,t,n){e.exports=n.p+"static/assets/images/sketchfab-blue-white-c2ea5d067dbe2a711f547cb07163e424.svg"},cAcU:function(e,t,n){e.exports=n.p+"static/assets/images/editor/Point-7493691bc0625a4c8a09393c65c39e5c.png"},cC4W:function(e,t,n){"use strict";(function(e){var i=n("o0o1"),r=n.n(i),a=n("yXPU"),o=n.n(a),s=n("QILm"),u=n.n(s),l=n("gcR/"),c=n.n(l),h=n("q1tI"),d=n("wsGC"),f=n("gPpI"),p=n("MBd8"),g=n("8tOx"),m=n("AGoD"),v=n("S8iY"),_=n("p4E/"),b=n("xTlW"),S=n("PvUo"),y=n("Wzgv"),x=n("V02I"),C=n("8/dv"),w=n("M4AY"),T=n("/MKj"),M=c()(C.c,{className:"c-page-header__menu-icon"}),E=c()(m.a,{className:"c-page-header__logo"}),A=c()(_.b,{}),O=c()(_.a,{className:"c-page-header__search-icon c-page-header__col"});function R(e){var t=e.isTransparent,n=void 0!==t&&t;return c()(x.a,{isTransparent:n},void 0,function(e){var t=e.isSearchOpen,n=e.authUser,i=e.categories;return h.createElement(h.Fragment,null,M,E,t?null:c()(v.a,{categories:i}),A,t?null:c()("div",{className:"c-page-header__flex-container --right"},void 0,O,c()(p.a,{className:Object(d.a)("c-page-header__col")}),n.isAnonymous?h.createElement(h.Fragment,null,c()(b.b,{className:Object(d.a)("c-page-header__auth-button","c-page-header__col")}),c()(b.c,{className:Object(d.a)("c-page-header__auth-button","c-page-header__col")}),c()(S.a,{className:Object(d.a)("c-page-header__cta-button","c-page-header__col"),gaEvent:"headerUploadSignupButtonClicked",href:Object(f.e)("users:signup",{},{next:"/feed#upload"})})):h.createElement(h.Fragment,null,c()(g.a,{authUser:n,className:Object(d.a)("c-page-header__col")}),c()(S.a,{className:Object(d.a)("c-page-header__cta-button","c-page-header__col"),gaEvent:"headerUploadSignupButtonClicked",href:Object(f.e)("users:signup",{},{next:"/feed#upload"})}),c()(y.a,{authUser:n,className:Object(d.a)("c-page-header__col")}))))})}var P=c()(C.c,{className:"c-page-header__menu-icon"}),I=c()(m.a,{className:"c-page-header__logo"});function N(e){var t=e.isTransparent,n=void 0!==t&&t,i=Object(T.e)(w.c.authUser.isSeller);return c()(x.a,{isTransparent:n},void 0,function(e){var t=e.authUser,n=e.categories;return h.createElement(h.Fragment,null,P,I,c()(v.a,{categories:n}),c()("div",{className:"c-page-header__flex-container --right"},void 0,c()(p.a,{className:Object(d.a)("c-page-header__col")}),t.isAnonymous?h.createElement(h.Fragment,null,c()(b.b,{className:Object(d.a)("c-page-header__col")}),c()(b.c,{redirectUrl:Object(f.e)("users:onboarding"),className:Object(d.a)("c-page-header__col")}),c()(b.a,{className:Object(d.a)("c-page-header__cta-button","c-page-header__col")})):h.createElement(h.Fragment,null,i?null:c()(b.a,{className:Object(d.a)("c-page-header__cta-button","c-page-header__col")}),c()(y.a,{authUser:t,className:Object(d.a)("c-page-header__col")}))))})}function L(e){var t=e.isStore,n=u()(e,["isStore"]);return t?h.createElement(N,n):h.createElement(R,n)}var k=function(){var t=o()(r.a.mark(function t(n){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.isServer){t.next=5;break}return t.next=3,e.all([n.services.dispatch(w.a.entities.getCategories()),n.services.dispatch(w.a.authUser.getFromPrefetched())]);case 3:t.next=6;break;case 5:n.props.isSearchOpen?n.services.dispatch(w.a.search.open()):e.resolve();case 6:if(!n.props.isStore){t.next=9;break}return t.next=9,n.services.dispatch(w.a.authUser.getIsSeller());case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();L.prepare=k,t.a=L}).call(this,n("CSL1"))},"cQ/I":function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),a=n("q1tI");t.a=function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];a.useEffect(function(){if(e.current){var r=e.current;return r.addEventListener(t,n,i),function(){return r.removeEventListener(t,n,i)}}},[e.current,t].concat(r()(o)))}},cRML:function(e,t){e.exports="float getLuminance(const in vec3 color) {\n    // http://stackoverflow.com/questions/596216/formula-to-determine-brightness-of-rgb-color\n    const vec3 colorBright = vec3(0.2126, 0.7152, 0.0722);\n    return dot(color, colorBright);\n}\n"},cVj4:function(e,t){e.exports='uniform float uDisplay2D;\nuniform float uPointSize;\n\nuniform vec2 uGlobalTexRatio;\nuniform vec2 uGlobalTexSize;\nuniform vec4 uHalton;\n\nuniform mat3 uModelNormalMatrix;\nuniform mat3 uModelViewNormalMatrix;\n\nuniform mat4 uProjectionMatrix;\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uModelViewMatrix;\n\n// in case of srgbToLinear texfetch\n#ifdef HAS_DISPLACEMENT\n#pragma include "utils/functions.glsl"\n#endif\n\n#ifdef IS_IOS\ninvariant gl_Position;\n#endif\n\n\n#if defined(HAS_COMPRESSION) && !defined(HAS_MORPHING)\n    #define HAS_POSITION_COMPRESSION\n#endif\n\n/////////////////////////////////////\n// ATTRIBUTES (NORMAL/VERTEX/TANGENT)\n/////////////////////////////////////\n\n#ifdef HAS_ZW_COMPRESSION\n    attribute vec4 Vertex;\n#else\n    attribute vec3 Vertex;\n#endif\n\n// need normal to displace vertex\n#if defined(HAS_VIEW_NORMAL) || defined(HAS_MODEL_NORMAL) || defined(HAS_SKETCHFAB_DISPLACEMENT)\n\n    #ifdef HAS_POSITION_COMPRESSION\n        attribute vec2 Normal;\n    #else\n        attribute vec3 Normal;\n    #endif\n\n    #define NEED_LOCAL_NORMAL\n#endif\n\n// if no normalmap, correct the normal with displacement (as bump)\n#if defined(HAS_DISPLACEMENT) && !defined(HAS_NORMALMAP) && (defined(HAS_MODEL_NORMAL) || defined(HAS_VIEW_NORMAL))\n    #define CORRECT_BUMP_NORMAL\n#endif\n\n// need tangent to correct normal\n#if defined(HAS_VIEW_TANGENT) || defined(HAS_MODEL_TANGENT) || defined(CORRECT_BUMP_NORMAL)\n\n    #ifdef HAS_POSITION_COMPRESSION\n        attribute vec3 Tangent;\n    #else\n        attribute vec4 Tangent;\n    #endif\n\n    #define NEED_LOCAL_TANGENT\n#endif\n\n#ifdef HAS_VERTEX_COLOR\n    attribute vec4 Color;\n#endif\n\n////////////////////\n// VARYING/VARIABLES\n////////////////////\n\n// view\n#ifdef HAS_VIEW_VERTEX\n    varying vec4 vViewVertex;\n#else\n    vec4 vViewVertex;\n#endif\n\n#ifdef HAS_VIEW_NORMAL\n    varying vec3 vViewNormal;\n#endif\n\n#ifdef HAS_VIEW_TANGENT\n    varying vec4 vViewTangent;\n#endif\n\n// model\n#if defined(HAS_MODEL_VERTEX)\n    varying vec3 vModelVertex;\n#elif defined(HAS_DISPLACEMENT)\n    vec3 vModelVertex;\n#endif\n\n#if defined(HAS_MODEL_NORMAL)\n    varying vec3 vModelNormal;\n#elif defined(HAS_SKETCHFAB_DISPLACEMENT)\n    vec3 vModelNormal;\n#endif\n\n#if defined(HAS_MODEL_TANGENT)\n    varying vec3 vModelTangent;\n#endif\n\n#ifdef HAS_VERTEX_COLOR\n    varying vec4 vColor;\n    uniform float uArrayColorEnabled;\n#endif\n\n////////////\n// ANIMATION\n////////////\n\n#ifdef HAS_MORPHING\n    uniform vec4 uTargetWeights;\n\n%UNROLL 4%\n    #if NUM_TARGETS > %ID%\n        attribute vec3 Vertex_%ID%;\n        #define ARG_MORPH_VERTEX_%ID% , Vertex_%ID%\n\n        #ifdef HAS_MORPHING_NORMAL\n            attribute vec3 Normal_%ID%;\n            #define ARG_MORPH_NORMAL_%ID% , Normal_%ID%\n        #endif\n\n        #ifdef HAS_MORPHING_TANGENT\n            attribute vec3 Tangent_%ID%;\n            #define ARG_MORPH_TANGENT_%ID% , Tangent_%ID%.xyz\n        #endif\n    #else\n        #define ARG_MORPH_VERTEX_%ID%\n        #define ARG_MORPH_NORMAL_%ID%\n        #define ARG_MORPH_TANGENT_%ID%\n    #endif\n%%\n\n    #pragma include "utils/morphing.glsl"\n#endif\n\n#ifdef HAS_SKINNING\n    #ifndef NUM_BONES\n        #define NUM_BONES 1\n    #endif\n\n    attribute vec4 Bones;\n    attribute vec4 Weights;\n    uniform vec4 uBones[NUM_BONES];\n\n    #pragma include "utils/skinning.glsl"\n#endif\n\n#ifdef HAS_DISPLACEMENT\n    uniform float uDisplacementFactor;\n#endif\n\n#ifdef CORRECT_BUMP_NORMAL\n    uniform float uDisplacementNormal;\n    uniform vec2 uDisplacementSize;\n    #pragma include "utils/normalBump.glsl"\n#endif\n\n#ifdef HAS_POSITION_COMPRESSION\n    uniform vec3 uQVT;\n    uniform vec3 uQVS;\n\n    #ifdef HAS_OCT_COMPRESSION\n        #define UNCOMPRESS_DIR(n) n.z = 1.0 - abs(n.x) - abs(n.y); n.xy = n.z >= 0.0 ? n.xy : (1.0 - abs(n.yx)) * sign(n.xy);\n    #else\n        #define UNCOMPRESS_DIR(n) n.z = dot(n.xy, n.xy); n.xyz = vec3(2.0 * n.xy * sqrt(1.0 - n.z), 1.0 - 2.0 * n.z);\n    #endif\n#endif\n\n// attribute -> morph -> skin -> model -> displace -> view -> screen\n// localVertex = skin(morph(Vertex))\n// modelVertex = displacement(modelMatrix * localVertex)\n// viewVertex = viewMatrix * modelVertex\n\nvoid main() {\n#ifdef ASSIGN_UV\n    ASSIGN_UV\n#endif\n\n#ifdef HAS_VERTEX_COLOR\n    vColor = uArrayColorEnabled == 1.0 ? Color : vec4(1.0);\n#endif\n\n#ifdef HAS_SKINNING\n    mat4 boneMatrix = skinning(Weights, Bones);\n#endif\n\n    /////////////////////\n    // LOCAL/MODEL VERTEX\n    /////////////////////\n    vec3 localVertex = Vertex.xyz;\n#ifdef HAS_POSITION_COMPRESSION\n    #ifdef HAS_ZW_COMPRESSION\n        localVertex += Vertex.w;\n    #endif\n    localVertex = localVertex * uQVS RAND_SCALE + uQVT;\n#endif\n\n#ifdef HAS_MORPHING\n    localVertex = morphing(uTargetWeights, localVertex ARG_MORPH_VERTEX_0 ARG_MORPH_VERTEX_1 ARG_MORPH_VERTEX_2 ARG_MORPH_VERTEX_3);\n#endif\n\n#ifdef HAS_SKINNING\n    localVertex = (vec4(localVertex, 1.0) * boneMatrix).xyz;\n#endif\n\n#if defined(HAS_MODEL_VERTEX) || defined(HAS_DISPLACEMENT)\n    vModelVertex = (uModelMatrix * vec4(localVertex, 1.0)).xyz;\n#endif\n\n#if (defined(NEED_LOCAL_NORMAL) && defined(HAS_MORPHING_NORMAL)) || (defined(NEED_LOCAL_TANGENT) && defined(HAS_MORPHING_TANGENT))\n    // normalize weights for direction morphing\n    vec4 nTargetWeights = abs(uTargetWeights);\n    nTargetWeights = uTargetWeights / max(1.0, nTargetWeights.x + nTargetWeights.y + nTargetWeights.z + nTargetWeights.w);\n#endif\n\n    /////////\n    // NORMAL\n    /////////\n#ifdef NEED_LOCAL_NORMAL\n    #ifdef HAS_POSITION_COMPRESSION\n        vec3 localNormal = Normal.xyy;\n        UNCOMPRESS_DIR(localNormal);\n    #else\n        vec3 localNormal = Normal;\n    #endif\n\n    #ifdef HAS_MORPHING_NORMAL\n        localNormal = morphing(nTargetWeights, localNormal ARG_MORPH_NORMAL_0 ARG_MORPH_NORMAL_1 ARG_MORPH_NORMAL_2 ARG_MORPH_NORMAL_3);\n    #endif\n\n    #ifdef HAS_SKINNING\n        localNormal = (vec4(localNormal, 0.0) * boneMatrix).xyz;\n    #endif\n\n    #if defined(HAS_MORPHING) || defined(HAS_SKINNING)\n        localNormal.xyz = normalize(localNormal);\n    #endif\n\n    #if defined(HAS_MODEL_NORMAL) || defined(HAS_SKETCHFAB_DISPLACEMENT)\n        vModelNormal = uModelNormalMatrix * localNormal;\n    #endif\n\n    // view normal computed later if we need to correct it (displacement)\n    #if defined(HAS_VIEW_NORMAL) && !defined(CORRECT_BUMP_NORMAL)\n        vViewNormal = uModelViewNormalMatrix * localNormal;\n    #endif\n#endif\n\n    //////////\n    // TANGENT\n    //////////\n#ifdef NEED_LOCAL_TANGENT\n    #ifdef HAS_POSITION_COMPRESSION\n        vec4 localTangent = Tangent.xyzz;\n        UNCOMPRESS_DIR(localTangent);\n    #else\n        vec4 localTangent = Tangent;\n    #endif\n\n    #ifdef HAS_MORPHING_TANGENT\n        localTangent.xyz = morphing(nTargetWeights, localTangent.xyz ARG_MORPH_TANGENT_0 ARG_MORPH_TANGENT_1 ARG_MORPH_TANGENT_2 ARG_MORPH_TANGENT_3);\n    #endif\n\n    #ifdef HAS_SKINNING\n        localTangent.xyz = (vec4(localTangent.xyz, 0.0) * boneMatrix).xyz;\n    #endif\n\n    #if defined(HAS_MORPHING) || defined(HAS_SKINNING)\n        localTangent.xyz = normalize(localTangent.xyz);\n    #endif\n\n    #ifdef HAS_MODEL_TANGENT\n        vModelTangent = vec4(uModelNormalMatrix * localTangent.xyz, localTangent.w).xyz;\n    #endif\n\n    #ifdef HAS_VIEW_TANGENT\n        vViewTangent = vec4(uModelViewNormalMatrix * localTangent.xyz, localTangent.w);\n    #endif\n#endif\n\n    //////////////////\n    // DISPLACE VERTEX\n    //////////////////\n#ifdef HAS_DISPLACEMENT\n    float displacement = (COLOR_CONVERT_DISPLACEMENT(texture2D(SAMPLER_DISPLACEMENT, UV_DISPLACEMENT).PACK_DISPLACEMENT) - 0.5) * uDisplacementFactor;\n    #ifdef HAS_SKETCHFAB_DISPLACEMENT\n        vModelVertex += normalize(vModelNormal) * displacement;\n    #else\n        vModelVertex += vec3(0.0, 0.0, 1.0) * (vModelVertex.z > 0.01 ? displacement : 0.0);\n    #endif\n    vViewVertex = uViewMatrix * vec4(vModelVertex, 1.0);\n#else\n    vViewVertex = uModelViewMatrix * vec4(localVertex, 1.0);\n#endif\n\n    //////////////////\n    // DISPLACE NORMAL\n    //////////////////\n#ifdef CORRECT_BUMP_NORMAL\n    // if there is no normal map, use displacement to correct normal\n    vec3 invSize = vec3(1.0 / uDisplacementSize, 0.0);\n    vec2 gradient = vec2(COLOR_CONVERT_DISPLACEMENT(texture2D(SAMPLER_DISPLACEMENT, UV_DISPLACEMENT - invSize.xz).PACK_DISPLACEMENT)\n                        - COLOR_CONVERT_DISPLACEMENT(texture2D(SAMPLER_DISPLACEMENT, UV_DISPLACEMENT + invSize.xz).PACK_DISPLACEMENT),\n                        COLOR_CONVERT_DISPLACEMENT(texture2D(SAMPLER_DISPLACEMENT, UV_DISPLACEMENT - invSize.zy).PACK_DISPLACEMENT)\n                        -COLOR_CONVERT_DISPLACEMENT(texture2D(SAMPLER_DISPLACEMENT, UV_DISPLACEMENT + invSize.zy).PACK_DISPLACEMENT));\n\n    localNormal = bumpMap(localTangent, localNormal, uDisplacementNormal * gradient);\n\n    #if defined(HAS_VIEW_NORMAL)\n        vModelNormal = uModelNormalMatrix * localNormal;\n    #endif\n\n    #ifdef HAS_VIEW_NORMAL\n        vViewNormal = uModelViewNormalMatrix * localNormal;\n    #endif\n#endif\n\n    ///////////////////////\n    // PROJECTION JITTERING (could be done on the CPU)\n    ///////////////////////\n    mat4 jitteredProjection = uProjectionMatrix;\n#if defined(WIREFRAME)\n    vViewVertex.w += 0.005 / uProjectionMatrix[1][1];\n#elif defined(SHADOW_CAST)\n    float doPersp = jitteredProjection[3][3] == 0.0 ? 1.0 : 0.0;\n    vec2 jitter = (abs(uHalton.z) == 2.0 ? 1.0 : 0.0) * (uHalton.xy / uShadowMapSize.xy);\n    jitteredProjection[2].xy += doPersp * jitter;\n    jitteredProjection[3].xy += (1.0 - doPersp) * jitter;\n#elif !defined(NO_JITTER)\n    jitteredProjection[2].xy += (1.0 - uDisplay2D) * (uHalton.xy * uGlobalTexRatio.xy / uGlobalTexSize.xy);\n#endif\n\n    gl_Position = jitteredProjection * vViewVertex;\n\n#ifdef HAS_POINT_SIZE\n    gl_PointSize = min(64.0, max(1.0, -uPointSize / vViewVertex.z));\n#else\n    gl_PointSize = 1.0;\n#endif\n\n// probably not the best solution (in case you need custom things while including base.vert)\n#ifdef INJECT_VERT\n    INJECT_VERT\n#endif\n}\n'},cXxc:function(e,t){e.exports='#pragma include "utils/common.glsl"\n#pragma include "utils/lightCommon.glsl"\n\nvec4 precomputeGGX(const in vec3 normal, const in vec3 eyeVector, const in float roughness) {\n    float NoV = saturate(dot(normal, eyeVector));\n    float r2 = roughness * roughness;\n    return vec4(r2, r2 * r2, NoV, NoV * (1.0 - r2));\n}\n\n// Walter et al. 2007, "Microfacet models for refraction through rough surfaces"\nfloat D_GGX(const vec4 precomputeGGX, const float NoH) {\n    float a2 = precomputeGGX.y;\n    float d = (NoH * a2 - NoH) * NoH + 1.0;\n    return a2 / (PI * d * d);\n}\n\n// Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"\nvec3 F_Schlick(const vec3 f0, const float f90, const in float VoH) {\n    float VoH5 = pow(1.0 - VoH, 5.0);\n    return f90 * VoH5 + (1.0 - VoH5) * f0;\n}\n\n// greyscale f0 version (clearcoat)\nfloat F_Schlick(const float f0, const float f90, const in float VoH) {\n    return f0 + (f90 - f0) * pow(1.0 - VoH, 5.0);\n}\n\n// Heitz 2014, "Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs"\nfloat V_SmithCorrelated(const vec4 precomputeGGX, const float NoL) {\n    float a = precomputeGGX.x;\n    float smithV = NoL * (precomputeGGX.w + a);\n    float smithL = precomputeGGX.z * (NoL * (1.0 - a) + a);\n    return 0.5 / (smithV + smithL);\n    // same as\n    // Hammon 2017, "PBR Diffuse Lighting for GGX+Smith Microsurfaces"\n    // return 0.5 / mix(2.0 * NoL * NoV, NoL + NoV, precomputeGGX.y)\n}\n\nvec3 specularLobe(const vec4 precomputeGGX, const vec3 normal, const vec3 eyeVector, const vec3 eyeLightDir, const vec3 specular, const float NoL, const float f90) {\n    vec3 H = normalize(eyeVector + eyeLightDir);\n    float NoH = saturate(dot(normal, H));\n    float VoH = saturate(dot(eyeLightDir, H));\n\n    // distribution / visibility / fresnel\n    float D = D_GGX(precomputeGGX, NoH);\n    float V = V_SmithCorrelated(precomputeGGX, NoL);\n    vec3 F = F_Schlick(specular, f90, VoH);\n\n    return (D * V * PI) * F; // we multipy by PI because our diffuse is not divided by PI\n}\n\n// pure compute Light PBR\nvoid computeLightLambertGGX(\n    const in vec3 normal,\n    const in vec3 eyeVector,\n    const in float NoL,\n    const in vec4 precomputeGGX,\n\n    const in vec3 diffuse,\n    const in vec3 specular,\n\n    const in float attenuation,\n    const in vec3 lightColor,\n    const in vec3 eyeLightDir,\n    const in float f90,\n\n    out vec3 diffuseOut,\n    out vec3 specularOut,\n    out bool lighted) {\n\n    lighted = NoL > 0.0;\n    if (lighted == false) {\n        specularOut = diffuseOut = vec3(0.0);\n        return;\n    }\n\n    vec3 colorAttenuate = attenuation * NoL * lightColor;\n    specularOut = colorAttenuate * specularLobe(precomputeGGX, normal, eyeVector, eyeLightDir, specular, NoL, f90);\n    diffuseOut = colorAttenuate * diffuse;\n}\n\n/////////////\n// ANISOTROPY\n/////////////\n\nfloat V_SmithGGXCorrelated_Anisotropic(float at, float ab, float ToV, float BoV, float ToL, float BoL, float NoV, float NoL) {\n    // Heitz 2014, "Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs"\n    // UE4 version : https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/BRDF.ush#L270-L286\n    float lambdaV = NoL * length(vec3(at * ToV, ab * BoV, NoV));\n    float lambdaL = NoV * length(vec3(at * ToL, ab * BoL, NoL));\n    return 0.5 / (lambdaV + lambdaL);\n}\n\nfloat D_GGX_Anisotropic(const float at, const float ab, const float ToH, const float BoH, const float NoH) {\n    // Burley 2012, "Physically-Based Shading at Disney"\n    // https://github.com/google/filament/blob/master/shaders/src/brdf.fs#L81\n    // similar to UE4 version https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/BRDF.ush#L232-L238\n    float a2 = at * ab;\n    vec3 d = vec3(ab * ToH, at * BoH, a2 * NoH);\n    float x = a2 / dot(d, d);\n    return a2 * (x * x) / PI;\n}\n\nvec3 anisotropicLobe(\n    const vec4 precomputeGGX,\n    const vec3 normal,\n    const vec3 eyeVector,\n\n    const vec3 eyeLightDir,\n    const vec3 specular,\n    const float NoL,\n    const float f90,\n\n    const in vec3 anisotropicT,\n    const in vec3 anisotropicB,\n    const in float anisotropy) {\n\n    vec3 H = normalize(eyeVector + eyeLightDir);\n    float NoH = saturate(dot(normal, H));\n    float NoV = saturate(dot(normal, eyeVector));\n    float VoH = saturate(dot(eyeLightDir, H));\n\n    float ToV = dot(anisotropicT, eyeVector);\n    float BoV = dot(anisotropicB, eyeVector);\n    float ToL = dot(anisotropicT, eyeLightDir);\n    float BoL = dot(anisotropicB, eyeLightDir);\n    float ToH = dot(anisotropicT, H);\n    float BoH = dot(anisotropicB, H);\n\n    // slide 26, Disney 2012, "Physically Based Shading at Disney"\n    // https://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\n    float aspect = sqrt(1.0 - abs(anisotropy) * 0.9);\n    if (anisotropy > 0.0) aspect = 1.0 / aspect;\n    float at = precomputeGGX.x * aspect;\n    float ab = precomputeGGX.x / aspect;\n\n    // slide 24, Kulla 2017, "Revisiting Physically Based Shading at Imageworks"\n    // https://blog.selfshadow.com/publications/s2017-shading-course/imageworks/s2017_pbs_imageworks_slides_v2.pdf\n    // float at = max(0.002025, precomputeGGX.x * (1.0 + anisotropy));\n    // float ab = max(0.002025, precomputeGGX.x * (1.0 - anisotropy));\n\n    // specular anisotropic BRDF\n    float D = D_GGX_Anisotropic(at, ab, ToH, BoH, NoH);\n    float V = V_SmithGGXCorrelated_Anisotropic(at, ab, ToV, BoV, ToL, BoL, NoV, NoL);\n    vec3 F = F_Schlick(specular, f90, VoH);\n\n    return (D * V * PI) * F;\n}\n\nvoid computeLightLambertGGXAnisotropy(\n    const in vec3 normal,\n    const in vec3 eyeVector,\n    const in float NoL,\n    const in vec4 precomputeGGX,\n\n    const in vec3 diffuse,\n    const in vec3 specular,\n\n    const in float attenuation,\n    const in vec3 lightColor,\n    const in vec3 eyeLightDir,\n    const in float f90,\n\n    const in vec3 anisotropicT,\n    const in vec3 anisotropicB,\n    const in float anisotropy,\n\n    out vec3 diffuseOut,\n    out vec3 specularOut,\n    out bool lighted) {\n\n    lighted = NoL > 0.0;\n    if (lighted == false) {\n        specularOut = diffuseOut = vec3(0.0);\n        return;\n    }\n\n    vec3 colorAttenuate = attenuation * NoL * lightColor;\n    specularOut = colorAttenuate * anisotropicLobe(precomputeGGX, normal, eyeVector, eyeLightDir, specular, NoL, f90, anisotropicT, anisotropicB, anisotropy);\n    diffuseOut = colorAttenuate * diffuse;\n}\n'},cdhJ:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),a=n("gcR/"),o=n.n(a),s=n("QILm"),u=n.n(s),l=n("q1tI"),c=n("wsGC");t.a=function(e){var t=e.message,n=e.className,i=e.direction,a=void 0===i?"up":i,s=u()(e,["message","className","direction"]);return l.createElement("a",r()({target:"_blank",className:Object(c.a)("help","fa","fa-question-circle",n)},s),o()("span",{className:"tooltip tooltip-".concat(a)},void 0,t))}},ceKg:function(e,t){e.exports="// approximation such as http://chilliant.blogspot.fr/2012/08/srgb-approximations-for-hlsl.html\n// introduced slightly darker colors and more slight banding in the darks.\n\n// so we stick with the reference implementation (except we don't check if color >= 0.0):\n// https://www.khronos.org/registry/gles/extensions/EXT/EXT_sRGB.txt\n#define LIN_SRGB(x) x < 0.0031308 ? x * 12.92 : 1.055 * pow(x, 1.0/2.4) - 0.055\n#define SRGB_LIN(x) x < 0.04045 ? x * (1.0 / 12.92) : pow((x + 0.055) * (1.0 / 1.055), 2.4)\n\nfloat linearTosRGB(const in float color) { return LIN_SRGB(color); }\nvec3 linearTosRGB(const in vec3 color) { return vec3(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b)); }\nvec4 linearTosRGB(const in vec4 color) { return vec4(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b), color.a); }\n\nfloat sRGBToLinear(const in float color) { return SRGB_LIN(color); }\nvec3 sRGBToLinear(const in vec3 color) { return vec3(SRGB_LIN(color.r), SRGB_LIN(color.g), SRGB_LIN(color.b)); }\nvec4 sRGBToLinear(const in vec4 color) { return vec4(SRGB_LIN(color.r), SRGB_LIN(color.g), SRGB_LIN(color.b), color.a); }\n\n//http://graphicrants.blogspot.fr/2009/04/rgbm-color-encoding.html\nvec3 RGBMToRGB( const in vec4 rgba ) {\n    const float maxRange = 8.0;\n    return rgba.rgb * maxRange * rgba.a;\n}\n\nconst mat3 LUVInverse = mat3( 6.0013, -2.700, -1.7995, -1.332, 3.1029, -5.7720, 0.3007, -1.088, 5.6268 );\n\nvec3 LUVToRGB( const in vec4 vLogLuv ) {\n    float Le = vLogLuv.z * 255.0 + vLogLuv.w;\n    vec3 Xp_Y_XYZp;\n    Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n    Xp_Y_XYZp.z = Xp_Y_XYZp.y / vLogLuv.y;\n    Xp_Y_XYZp.x = vLogLuv.x * Xp_Y_XYZp.z;\n    vec3 vRGB = LUVInverse * Xp_Y_XYZp;\n    return max(vRGB, 0.0);\n}\n\n// http://graphicrants.blogspot.fr/2009/04/rgbm-color-encoding.html\nvec4 encodeRGBM(const in vec3 color, const in float range) {\n    if(range <= 0.0) return vec4(color, 1.0);\n    vec4 rgbm;\n    vec3 col = color / range;\n    rgbm.a = clamp( max( max( col.r, col.g ), max( col.b, 1e-6 ) ), 0.0, 1.0 );\n    rgbm.a = ceil( rgbm.a * 255.0 ) / 255.0;\n    rgbm.rgb = col / rgbm.a;\n    return rgbm;\n}\n\nvec3 decodeRGBM(const in vec4 color, const in float range) {\n    if(range <= 0.0) return color.rgb;\n    return range * color.rgb * color.a;\n}\n"},cohD:function(e,t){if(window.Set&&window.Map&&window.Uint8ClampedArray){if(Math.sign||(Math.sign=function(e){return e>0?1:e<0?-1:0}),Math.log2||(Math.log2=function(e){return Math.log(e)*Math.LOG2E}),Math.log10||(Math.log10=function(e){return Math.log(e)*Math.LOG10E}),String.prototype.endsWith||(String.prototype.endsWith=function(e){return this.slice(-e.length)===e}),String.prototype.startsWith||(String.prototype.startsWith=function(e){return this.slice(0,e.length)===e}),!Float32Array.prototype.slice){var n=function(e,t){return new this.constructor(this.subarray(e,t))};Int8Array.prototype.slice=n,Uint8Array.prototype.slice=n,Uint8ClampedArray.prototype.slice=n,Int16Array.prototype.slice=n,Uint16Array.prototype.slice=n,Int32Array.prototype.slice=n,Uint32Array.prototype.slice=n,Float32Array.prototype.slice=n,Float64Array.prototype.slice=n}if(!new window.Set(["test"]).has("test")){var i=window.Set;window.Set=function(e){var t=new i;if(e)for(var n=0;n<e.length;++n)t.add(e[n]);return t}}if("object"==typeof window.Event){function r(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}r.prototype=window.Event.prototype,window.Event=r}}},cuuI:function(e,t,n){"use strict";var i=n("a3nb"),r=n("qRO0"),a=n("DkmK"),o=function(){r.a.call(this),this._databasePager=new a.a,this._sceneData=void 0};i.a.createPrototypeObject(o,i.a.objectInherit(r.a.prototype,{getSceneData:function(){return this._sceneData},setSceneData:function(e){this._sceneData=e},setDatabasePager:function(e){this._databasePager=e},getDatabasePager:function(){return this._databasePager},updateSceneGraph:function(e){this._databasePager&&this._databasePager.updateSceneGraph(e.getFrameStamp()),this._sceneData&&this._sceneData.accept(e)}}),"osgViewer","Scene"),t.a=o},cvIH:function(e,t){e.exports='#define WIREFRAME\n#pragma include "base.vert"\n'},czSk:function(e,t,n){"use strict";var i=n("KL/6"),r=n("/Jg8"),a=n.n(r),o={ArrayType:Float64Array};n.d(t,"b",function(){return h}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return s}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return l}),n.d(t,"a",function(){return a.a}),a.a.glMatrix.setMatrixArrayType(o.ArrayType),a.a.glMatrix.EPSILON=1e-9;var s=a.a.vec2,u=a.a.vec3,l=a.a.vec4,c=a.a.mat4,h=a.a.mat3,d=a.a.quat;u.create32=function(){return new Float32Array(3)},u.create64=function(){return new Float64Array(3)},u.fromValues32=function(e,t,n){var i=new Float32Array(3);return i[0]=e,i[1]=t,i[2]=n,i},u.fromValues64=function(e,t,n){var i=new Float64Array(3);return i[0]=e,i[1]=t,i[2]=n,i},u.init=function(e){return u.set(e,0,0,0)},u.transformMat4Rotate=function(e,t,n){var i=t[0],r=t[1],a=t[2];return e[0]=n[0]*i+n[1]*r+n[2]*a,e[1]=n[4]*i+n[5]*r+n[6]*a,e[2]=n[8]*i+n[9]*r+n[10]*a,e},u.valid=function(e){return!i.a.isNaN(e[0])&&(!i.a.isNaN(e[1])&&!i.a.isNaN(e[2]))},u.neg=u.negate,u.ZERO=u.create(),u.ONE=u.fromValues(1,1,1),u.INFINITY=u.fromValues(1/0,1/0,1/0),u.NEGATIVE_INFINITY=u.fromValues(-1/0,-1/0,-1/0),s.create32=function(){return new Float32Array(2)},s.create64=function(){return new Float64Array(2)},s.fromValues32=function(e,t){var n=new Float32Array(2);return n[0]=e,n[1]=t,n},s.fromValues64=function(e,t){var n=new Float64Array(2);return n[0]=e,n[1]=t,n},s.init=function(e){return s.set(e,0,0)},s.valid=function(e){return!i.a.isNaN(e[0])&&!i.a.isNaN(e[1])},s.ZERO=s.create(),s.ONE=s.fromValues(1,1),s.INFINITY=s.fromValues(1/0,1/0),s.NEGATIVE_INFINITY=s.fromValues(-1/0,-1/0),l.create32=function(){return new Float32Array(4)},l.create64=function(){return new Float64Array(4)},l.fromValues32=function(e,t,n,i){var r=new Float32Array(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},l.fromValues64=function(e,t,n,i){var r=new Float64Array(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},l.init=function(e){return l.set(e,0,0,0,0)},l.valid=function(e){return!i.a.isNaN(e[0])&&(!i.a.isNaN(e[1])&&(!i.a.isNaN(e[2])&&!i.a.isNaN(e[3])))},l.neg=l.negate,l.ZERO=l.create(),l.ONE=l.fromValues(1,1,1,1),l.INFINITY=l.fromValues(1/0,1/0,1/0,1/0),l.NEGATIVE_INFINITY=l.fromValues(-1/0,-1/0,-1/0,-1/0),d.IDENTITY=d.create(),d.zeroRotation=function(e){return 0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]},d.create32=function(){var e=new Float32Array(4);return e[3]=1,e},d.create64=function(){var e=new Float64Array(4);return e[3]=1,e},d.fromValues32=l.fromValues32,d.fromValues64=l.fromValues64,d.init=d.identity,d.nlerp=function(e,t,n,i){var r,a,o,s,u=t[0],l=t[1],c=t[2],h=t[3],d=n[0],f=n[1],p=n[2],g=n[3],m=1-i;u*d+l*f+c*p+h*g<0?(r=u*m-d*i,a=l*m-f*i,o=c*m-p*i,s=h*m-g*i):(r=u*m+d*i,a=l*m+f*i,o=c*m+p*i,s=h*m+g*i);var v=1/Math.sqrt(r*r+a*a+o*o+s*s);return e[0]=r*v,e[1]=a*v,e[2]=o*v,e[3]=s*v,e},h.IDENTITY=h.create(),h.create32=function(){var e=new Float32Array(9);return e[0]=e[4]=e[8]=1,e},h.create64=function(){var e=new Float64Array(9);return e[0]=e[4]=e[8]=1,e},c.IDENTITY=c.create(),c.create32=function(){var e=new Float32Array(16);return e[0]=e[5]=e[10]=e[15]=1,e},c.create64=function(){var e=new Float64Array(16);return e[0]=e[5]=e[10]=e[15]=1,e},c.setTranslation=function(e,t){return e[12]=t[0],e[13]=t[1],e[14]=t[2],e},c.getFrustum=function(e,t){var n,i,r,a,o,s;if(0!==t[3]||0!==t[7]||-1!==t[11]||0!==t[15])return!1;var u=t[14]/(t[10]-1),l=t[14]/(1+t[10]);return i=u*(t[8]-1)/t[0],n=u*(1+t[8])/t[0],r=u*(1+t[9])/t[5],a=u*(t[9]-1)/t[5],o=u,s=l,e.left=i,e.right=n,e.top=r,e.bottom=a,e.zNear=o,e.zFar=s,!0},c.getPerspective=function(){var e={right:0,left:0,top:0,bottom:0,zNear:0,zFar:0};return function(t,n){return c.getFrustum(e,n)&&(t.fovy=180/Math.PI*(Math.atan(e.top/e.zNear)-Math.atan(e.bottom/e.zNear)),t.aspectRatio=(e.right-e.left)/(e.top-e.bottom)),t.zNear=e.zNear,t.zFar=e.zFar,t}}(),c.getLookAt=function(){var e=c.create(),t=u.create(),n=u.fromValues(0,1,0),i=u.fromValues(0,0,-1);return function(r,a,o,s,l){var h=void 0!==l?l:1;c.invert(e,s),c.getTranslation(r,e),u.transformMat4Rotate(o,n,s),u.transformMat4Rotate(a,i,s),u.normalize(a,a),u.add(a,u.scale(t,a,h),r)}}(),c.getFrustumPlanes=function(){var e=c.create();return function(t,n,i,r){c.mul(e,n,i);var a=!!r,o=t[0];o[0]=e[3]-e[0],o[1]=e[7]-e[4],o[2]=e[11]-e[8],o[3]=e[15]-e[12];var s=t[1];s[0]=e[3]+e[0],s[1]=e[7]+e[4],s[2]=e[11]+e[8],s[3]=e[15]+e[12];var u=t[2];u[0]=e[3]+e[1],u[1]=e[7]+e[5],u[2]=e[11]+e[9],u[3]=e[15]+e[13];var l=t[3];l[0]=e[3]-e[1],l[1]=e[7]-e[5],l[2]=e[11]-e[9],l[3]=e[15]-e[13];var h=4;if(a){h=6;var d=t[4];d[0]=e[3]-e[2],d[1]=e[7]-e[6],d[2]=e[11]-e[10],d[3]=e[15]-e[14];var f=t[5];f[0]=e[3]+e[2],f[1]=e[7]+e[6],f[2]=e[11]+e[10],f[3]=e[15]+e[14]}for(var p=0;p<h;p++){var g=t[p],m=1/Math.sqrt(g[0]*g[0]+g[1]*g[1]+g[2]*g[2]);g[0]*=m,g[1]*=m,g[2]*=m,g[3]*=m}}}(),c.infiniteFrustum=function(e,t,n,i,r,a){var o=2*a/(n-t),s=2*a/(r-i),u=(n+t)/(n-t),l=(r+i)/(r-i);return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=u,e[9]=l,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=-2*a,e[15]=0,e},c.lookAtDirection=function(){var e=u.create(),t=u.create(),n=u.create();return function(i,r,a,o){var s=a;return u.cross(e,s,o),u.normalize(e,e),u.cross(t,e,s),u.normalize(t,t),i[0]=e[0],i[1]=t[0],i[2]=-s[0],i[3]=0,i[4]=e[1],i[5]=t[1],i[6]=-s[1],i[7]=0,i[8]=e[2],i[9]=t[2],i[10]=-s[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,c.translate(i,i,u.neg(n,r))}}(),c.getScale=function(){var e=u.create(),t=u.create(),n=u.create();return function(i,r){return e[0]=r[0],e[1]=r[4],e[2]=r[8],t[0]=r[1],t[1]=r[5],t[2]=r[9],n[0]=r[2],n[1]=r[6],n[2]=r[10],i[0]=u.length(e),i[1]=u.length(t),i[2]=u.length(n),i}}(),c.getSqrScale=function(){var e=u.create(),t=u.create(),n=u.create();return function(i,r){return e[0]=r[0],e[1]=r[4],e[2]=r[8],t[0]=r[1],t[1]=r[5],t[2]=r[9],n[0]=r[2],n[1]=r[6],n[2]=r[10],i[0]=u.sqrLen(e),i[1]=u.sqrLen(t),i[2]=u.sqrLen(n),i}}();var f=c.rotate;c.rotate=function(e,t,n,i){return f(e,t,n,i)||c.identity(e)};var p=c.fromRotation;c.fromRotation=function(e,t,n){return p(e,t,n)||c.identity(e)}},d1qz:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"e",function(){return p}),n.d(t,"b",function(){return g}),n.d(t,"c",function(){return v}),n.d(t,"d",function(){return _});var i,r=n("QLQS"),a=n("OZ7T"),o=n("Auie"),s=n("1qke"),u=n("fgaA"),l=r.a.osg,c=r.a.osgAnimation,h=function(e){i=e.getViewerWebGL().getRootModel()},d=null!==Object(u.a)().apiVersion,f=function(){var e=l.vec3.create(),t=l.mat4.create();return function(n){var r=n.get("lastComputedScenePosition"),o=function(e){var t=e.get("sticky");if(void 0!==t)return t;var n=e.get("geometryUid");if(n<0)return e.set("sticky",null),null;var i=a.a.uidGeometryMap[n];return i?d?(e.set("sticky",i),i):i instanceof c.RigGeometry||i instanceof c.MorphGeometry||Object(s.a)(i)?(e.set("sticky",i),i):(e.set("sticky",null),null):(e.set("sticky",null),null)}(n);if(!o)return l.vec3.copy(r,n.get("position"));var u=n.get("indices"),h=u[0],f=u[1],p=u[2];if(o.getWorldMatrix(i,t),h<0||!o.computeTransformedVertex)return l.vec3.transformMat4(r,n.get("localPosition"),t);var g=o.getVertexAttributeList().Vertex.getElements().length/3;if(h>=g||f>=g||p>=g)return l.vec3.copy(r,n.get("position"));var m=n.get("barycentricWeights"),v=m[0],_=m[1],b=m[2];return l.vec3.init(r),o.computeTransformedVertex(h,e),l.vec3.scaleAndAdd(r,r,e,v),f>=0&&(o.computeTransformedVertex(f,e),l.vec3.scaleAndAdd(r,r,e,_)),p>=0&&(o.computeTransformedVertex(p,e),l.vec3.scaleAndAdd(r,r,e,b)),l.vec3.transformMat4(r,r,t),r}}(),p=function(e){f(e);var t=e.get("lastComputedScenePosition"),n=e.get("lastComputedWorldPosition");return o.a.getWorldPositionFromScenePoint(t,n)},g=function(e,t){o.a.getScenePositionFromHit(t,e.get("position"));var n=t._nodePath[t._nodePath.length-1],i=void 0!==n._uniqueID?n._uniqueID:-1;e.set("geometryUid",i);var r=e.get("localPosition");r[0]=t._localIntersectionPoint[0],r[1]=t._localIntersectionPoint[1],r[2]=t._localIntersectionPoint[2];var a=e.get("indices");a[0]=t._i1,a[1]=t._i2,a[2]=t._i3;var s=e.get("barycentricWeights");s[0]=t._r1,s[1]=t._r2,s[2]=t._r3},m=function(e){e.set("geometryUid",-1),l.vec3.set(e.get("indices"),-1,-1,-1),l.vec3.init(e.get("barycentricWeights")),l.vec3.init(e.get("localPosition"))},v=function(e,t){l.vec3.copy(e.get("position"),t),l.vec3.copy(e.get("lastComputedScenePosition"),t);var n=e.get("lastComputedWorldPosition");o.a.getWorldPositionFromScenePoint(n,t),m(e)},_=function(e,t){var n=e.get("position");o.a.getScenePositionFromWorldPoint(t,n),l.vec3.copy(e.get("lastComputedScenePosition"),n),l.vec3.copy(e.get("lastComputedWorldPosition"),t),m(e)}},dAuA:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var i=n("cDf5"),r=n.n(i),a=/[&|;]+/g;function o(e){var t={};return Object.keys(e).forEach(function(n){t[n]=Array.isArray(e[n])?e[n]:[e[n]]}),t}function s(e){return"object"===r()(e)?o(e):("?"===e[0]&&(e=e.substr(1)),e.split(a).reduce(function(e,t){if(0===t.length)return e;var n=t.indexOf("=");-1===n&&(n=t.length);var i=decodeURIComponent(t.substr(0,n).replace(/\+/g,"%20")),r=decodeURIComponent(t.substr(n+1).replace(/\+/g,"%20"));return void 0===e[i]&&(e[i]=[]),e[i].push(r),e},{}))}},dERi:function(e,t,n){"use strict";(function(e){var i=n("cDf5"),r=n.n(i),a=n("q1z7"),o=n.n(a),s=n("EVdn"),u=n.n(s),l=n("tNdj");t.a=l.a.extend({defaults:function(){return{name:"",content:"",position:[0,0,0],eye:[0,0,0],target:[0,0,0],lastComputedScenePosition:[0,0,0],lastComputedWorldPosition:[0,0,0],uidImage:void 0,imageFile:void 0,preview:"",hovered:!0,geometryUid:-1,indices:[-1,-1,-1],barycentricWeights:[0,0,0],localPosition:[0,0,0],visible:!0}},endpoint:function(){return"/hotspots".concat(this.isNew()?"":"/".concat(this.get("uid")))},remove:function(){return e.resolve(o.a.ajax({type:"DELETE",url:this.url()}))},appendArray:function(e,t,n){for(var i=0,r=n.length;i<r;++i)e.append(t,n[i])},_dumpOptions:function(){return{eye:this.get("eye").toString(),target:this.get("target").toString(),position:this.get("position").toString(),content:this.get("content").raw,name:this.get("name"),imFile:this.get("imFile")}},registerOptions:function(){this._lastOptions=this._dumpOptions()},hasChangedOptions:function(){if(!this._lastOptions)return!0;var e=this._dumpOptions(),t=this._lastOptions;for(var n in t)if(t[n]!==e[n])return!0;return!1},save:function(t,n){var i=this._lastOptions;if(!this.hasChangedOptions())return e.resolve();this.registerOptions(),null!=t&&"object"!==r()(t)||(n=t);var a=this.isNew(),o=new FormData,s=this.get("imageFile");void 0===this.get("uidImage")&&s&&o.append("imageFile",s),o.append("model",n.modelUID),o.append("name",this.get("name"));var l=this.get("content").raw;o.append("content",null!==l?l:""),this.appendArray(o,"eye",this.get("eye")),this.appendArray(o,"target",this.get("target")),this.appendArray(o,"position",this.get("position"));var c=this,h=u.a.ajax({type:a?"POST":"PATCH",url:this.url(),data:o,cache:!1,contentType:!1,processData:!1,success:function(e){a&&(c.set("uid",e.uid),e.images.length>0&&c.set("uidImage",e.images[0].uid))},error:function(e){this._lastOptions=i,console.error(e.stack)}.bind(this)});return e.resolve(h)},_validate:function(e,t){return(t=t||{}).validate=!0,l.a.prototype._validate.call(this,e,t)},validate:function(e){var t=e.eye,n=e.target,i=n[0]-t[0],r=n[1]-t[1],a=n[2]-t[2],o=Math.sqrt(i*i+r*r+a*a);if(o<=1e-8)return n[0]=e.position[0],n[1]=e.position[1],n[2]=e.position[2],!1;if(o<=.001){var s=.01/o;n[0]=t[0]+i*s,n[1]=t[1]+r*s,n[2]=t[2]+a*s}return!1}})}).call(this,n("CSL1"))},dPYE:function(e,t,n){"use strict";t.a=function(e,t){var n,i,r=e.length,a=t.length,o=[];if(!r)return a;if(!a)return r;for(n=0;n<=r;n++)o[n]=[n];for(i=0;i<=a;i++)o[0][i]=i;for(i=1;i<=a;i++)for(n=1;n<=r;n++)e[n-1]===t[i-1]?o[n][i]=o[n-1][i-1]:o[n][i]=Math.min(o[n-1][i],o[n][i-1],o[n-1][i-1])+1;return o[r][a]}},"dZz+":function(e,t,n){"use strict";(function(e){var i=n("lSNA"),r=n.n(i),a=n("MVZn"),o=n.n(a),s=n("YfG3"),u=n("NFsq"),l=n("a5K3"),c=n("tNdj"),h=n("bLLl"),d=n("QKgc"),f=n("eEbW"),p=n("M4AY"),g=n("dqY5"),m=c.a.extend({defaults:{likes:{},followings:{},subscriptions:{},reviewUpvotes:{},purchases:{}},mixins:[Object(g.a)(function(e){return{likes:p.c.authUser.likes(e)}})],endpoint:function(){return this.options.me&&!this.get("uid")?"/users/me":this.isNew()||null!==this.get("uid")?this.isNew()?"/users":"/users/".concat(this.get("uid")):"/users/@".concat(this.get("username"))},isAuthenticated:function(){return!this.get("isAnonymous")},isInflated:function(){return void 0!==this.get("account")&&Object.keys(this.attributes).length>Object.keys(this.defaults).length+1},followUsers:function(t){var n=this;return Array.isArray(t)?(t.forEach(function(e){return n.addFollowing(e,!0)}),m.authenticate(function(){return f.b.followUsers(t)})):e.reject("First argument should be an array of user UIDs.")},isProfileFilled:function(){return"avatar-blue"!==this.get("avatars").name&&(this.get("biography")||this.get("tagline")||this.get("city")||this.get("country"))&&(this.get("website")||this.get("twitterUsername")||this.get("linkedinUsername")||this.get("unityConnectUrl")||this.get("facebookUsername"))},follow:function(e){return this.addFollowing(e,!0),f.b.followUser(e)},unfollow:function(e){return this.addFollowing(e,!1),m.authenticate(function(){return f.b.unfollowUser(e)})},addFollowing:function(e,t){var n={},i=this.get("followingCount")||0;n[e]=t,this.addFollowings(n),this.set("followingCount",Math.max(i+(t?1:-1),0))},addFollowings:function(e){this.set("followings",Object(s.a)({},this.get("followings"),e))},doesFollow:function(e){return!!this.get("followings")[e]},getDoesFollow:function(t){var n=this;return this.isAuthenticated()?f.b.doesCurrentUserFollow(t).then(function(e){return n.addFollowing(t,e),e}):e.resolve(!1)},getSummary:function(){var e=this;return f.b.getUserSummary(this.get("uid")).then(function(t){return e.set(t),t})},canViewPrivateModelsOf:function(e){return!!this.isAuthenticated()&&(!0===this.get("isStaff")||void 0!==e&&this.get("uid")===e)},canUpgradePlan:function(){return!1===Object(u.a)(["ent"],this.get("account"))},doesLike:function(e){return p.c.authUser.doesLike(e,p.b.store.getState())},getDoesLike:function(t){return this.isAuthenticated()?p.b.store.dispatch(p.a.authUser.getDoesLike(t)):e.resolve(!1)},getReviewOnModel:function(t){var n=this;return f.b.getCurrentUserReview(t).then(function(i){return Object.keys(i).length?i:e.reject(new d.g("no review found for user ".concat(n.get("uid")," on model ").concat(t)))})},setPurchase:function(e,t){this.set("purchases",o()({},this.get("purchases"),r()({},e,t)))},getHasPurchased:function(t){var n=this;return this.isAuthenticated()?f.b.hasCurrentUserPurchased(t).then(function(e){return n.setPurchase(t,e),e}):e.resolve(!1)},hasPurchased:function(e){return this.get("purchases")[e]||!1},fetchPrivateLimits:function(){return this.isAuthenticated()?this.get("privateLimits")?e.resolve(this.get("privateLimits")):f.b.getCurrentUserPrivateLimits().then(function(t){return this.set("privateLimits",Object(s.a)({},this.get("privateLimits"),t)),e.resolve(t)}.bind(this)):e.reject("User is not authenticated.")},hasSubscribed:function(e){return!!this.get("subscriptions")[e]},getHasSubscribed:function(t){var n=this;return this.isAuthenticated()?f.b.hasCurrentUserSubscribed(t).then(function(e){return n.updateSubscription(t,e),e}):e.resolve(!1)},updateSubscription:function(e,t){this.updateSubscriptions(r()({},e,t))},updateSubscriptions:function(e){this.set("subscriptions",o()({},this.get("subscriptions"),e))},updateEmailSettings:function(e){return f.b.updateUserEmailSettings(this.get("uid"),e)},setAllowsRestricted:function(e){return p.b.store.dispatch(p.a.authUser.setAllowsRestricted(e))},doAllowRestricted:function(){return p.c.authUser.allowsRestricted(p.b.store.getState())},isMe:function(){return m.me().get("uid")===this.get("uid")},canAccessFeature:function(e){return Object(u.a)(this.get("features").map(l.a),Object(l.a)(e))},getThumbnails:function(){var e=this;return f.b.getUserThumbnails(this.get("uid")).then(function(t){return e.set("thumbnails",t),t})}},{login:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).next;return f.b.login({email:e,password:t,next:n}).then(function(e){return m.clear(),e.result})},authenticate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1?arguments[1]:void 0;return p.b.store.dispatch(p.a.authUser.authenticate(function(t){var n=m.me();return n.set(t),e(n)},t))},getMeSingleton:function(){if(!this._me){var e=p.c.authUser.user(p.b.store.getState());this._me=new m(e,{me:!0})}return this._me},fetchMe:function(){return p.b.store.dispatch(p.a.authUser.get({allowPrefetching:!1})).then(function(){return m.getMeSingleton()})},me:function(){return p.c.authUser.isInflated(p.b.store.getState())||p.b.store.dispatch(p.a.authUser.getFromPrefetched()),m.getMeSingleton()},getByAttributes:function(e,t){t=Object(s.a)({},t);var n=new this(e=Object(s.a)({uid:null},e),Object(s.a)({},t.userOptions)),i=function(e){return e.set({}),e};return t.immediate?(n.fetch(t),i(n)):n.fetch(t).then(i)},getByUid:function(e,t){return this.getByAttributes({uid:e},t)},clear:function(){h.b.invalidate("/i/users/me"),this._me=void 0}});t.a=m}).call(this,n("CSL1"))},dhQu:function(module,__webpack_exports__,__webpack_require__){"use strict";var osg_notify__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("icjm"),osg_WebGLCaps__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("AwiE"),viewer_getOptions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("fgaA"),osgShader_gl2convert__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("RPqA"),shaderProcessor={},cbFilterDuplicate=function(e,t,n){return!t||e!==n[t-1]};shaderProcessor.getSortedUnique=function(e){return e.sort().filter(cbFilterDuplicate)};var isStringInteger=function(e){return/^[\+|\-]?\d+$/.test(e)},getFinalDefinedValue=function(e,t){for(;e[t]&&t!==e[t];)t=e[t];return t},testIf=function(defines,line){if(line.startsWith("#ifdef"))return void 0!==defines[line.substr(7-line.length)];if(line.startsWith("#ifndef"))return void 0===defines[line.substr(8-line.length)];if(line.startsWith("#else"))return!0;for(var txt=line.match(/[#elif|#if]\s+(.*)/)[1],tokens=txt.split(/\b\d+\b|\W+|defined+/g),i=0;i<tokens.length;++i){var tok=tokens[i];if(tok){var value=getFinalDefinedValue(defines,defines[tok]);void 0===value||isStringInteger(value)||(value=!0),txt=txt.replace(tok,value)}}return eval("var defined = function(x) { return x !== undefined | 0; };\n"+txt)},processBranch=function(e,t,n,i){for(var r=[1],a=t;a<e.length;++a){var o=e[a].trim();if(o.startsWith("#endif"))r.length--;else if(o.startsWith("#el")){var s=r.length-1;0===r[s]?r[s]=testIf(n,o)?1:0:1===r[s]&&(r[s]=2)}else if(o.startsWith("#if"))r.push(testIf(n,o)?1:0);else{for(var u=!0,l=r.length;l--;)u=u&&1===r[l];if(u)if(o.startsWith("#"))if(o.startsWith("#extension"))i.push(o);else if(o.startsWith("#undef"))n[o.match(/#undef\s+(\w+)/)[1]]=void 0,i.push(o);else if(o.startsWith("#define")){var c=o.match(/#define\s+(\w+)\s*(.*)/);-1!==o.indexOf(c[1]+"(")?n[c[1]]={args:o.match(/\(.*?\)/)[0].match(/\w+/g),body:o.match(/\)(.*)/)[1]}:n[c[1]]=c[2]}else console.error("unknown preprocessor line: "+o);else i.push(o)}}},fixIndent=function(e){for(var t=(e=e.replace(/(\n\s*\n)+/g,"\n\n")).split("\n"),n="",i=0;i<t.length;++i){var r=t[i].trim(),a=-1!==r.indexOf("{"),o=-1!==r.indexOf("}");!a&&o&&(n=n.substr(4)),t[i]=n+r,a&&!o&&(n+="    ")}return t.join("\n")},cleanDeclarations=function(e,t){for(var n=0;n<t.length;++n)e=e.replace(t[n],""),t[n]=t[n].replace(/\s+/g," ").replace(/\s+;/,";");return e},handleVaryings=function(e){var t=e.match(/varying\s.*?;/g);if(!t)return e;e=cleanDeclarations(e,t),t=shaderProcessor.getSortedUnique(t);for(var n=0;n<t.length;++n)if(-1!==t[n].indexOf("vViewNormal;")){var i=t[0];t[0]=t[n],t[n]=i;break}return"\n"+t.join("\n")+"\n"+e},handleUniforms=function(e){var t=e.match(/uniform\s.*?;/g);return t?(e=cleanDeclarations(e,t),"\n"+(t=shaderProcessor.getSortedUnique(t)).join("\n")+"\n"+e):e},handleAttributes=function(e){var t=e.match(/attribute\s.*?;/g);if(!t)return e;e=cleanDeclarations(e,t),t=shaderProcessor.getSortedUnique(t);for(var n=0;n<t.length;++n)if(-1!==t[n].indexOf(" Vertex;")){t.unshift(t[n]),t.splice(n+1,1);break}return"\n"+t.join("\n")+"\n"+e},handlePrecision=function(e){var t=e.match(/precision\s+(high|low|medium)p\s+float\s*;/);return t?t[0]+"\n"+e.replace(t[0],""):"precision "+osg_WebGLCaps__WEBPACK_IMPORTED_MODULE_1__.a.instance().getShaderMaxPrecisionFloat()+"p float;\n"+e},addExtensions=function(e){var t=e.match(/#extension\s(\w+)\s:\s(\w+)/g);if(!t)return e;t=shaderProcessor.getSortedUnique(t);for(var n=0;n<t.length;++n)e=e.replace(t[n],"");return t.join("\n")+"\n"+e},addVersion=function(e){return(osg_WebGLCaps__WEBPACK_IMPORTED_MODULE_1__.a.instance().isWebGL2()?"#version 300 es\n":"#version 100\n")+e},hasVersion=function(e){return e.match(/^#\s*version/m)},cbUnroll=function(e,t,n){t=parseInt(t);for(var i="",r=0;r<t;++r)i+=n.replace(/%ID%/g,r);return i},unrollReplace=function(e){return e.replace(/%UNROLL ([0-9]+)%([\s\S]+?)%%/g,cbUnroll)},glslPreprocessShader=function(e){return window.glslesPreprocessor(e,{debugExperimental:!1,defines:[],doStats:!1,extensions:[],pruneComments:!0,logCounts:!1,minify:!1,output:0,preprocess:!0,profileTimeEach:!1,profileTimeGlobal:!1,pruneUnused:!0,pruneDefines:!0,replaceDefine:!0,optimize:!0,tabs:4,whitespace:!0})},extractArguments=function(e,t){for(var n=[""],i=0,r=t;r<e.length;++r){if("("===e[r])i++;else if(")"===e[r]){if(0===i)return[n,r+1];if(0===--i){n[n.length-1]+=e[r];continue}}","!==e[r]||0!==i?n[n.length-1]+=e[r]:n.push("")}},replaceRange=function(e,t,n,i){return e.substring(0,t)+i+e.substring(n)},resolveDefineFunction=function(e,t,n){var i=new RegExp("\\b"+t+"\\b\\s*\\(","g"),r=e.match(i);if(!r)return e;for(var a=n.args,o=n.body,s=0;s<r.length;++s){var u=r[s],l=e.indexOf(u),c=l+u.length,h=extractArguments(e,c),d=h[0],f=o.replace(/\w+/g,function(e){var t=a.indexOf(e);return-1!==t?d[t]:e});e=replaceRange(e,l,h[1],f)}return e},resolveDefines=function(e,t){for(var n=Object.keys(t),i=0;i<n.length;++i){for(var r=n[i],a=t[r],o="object"==typeof a,s=!o&&new RegExp("\\b"+r+"\\b","g"),u=i+1;u<n.length;++u){var l=n[u],c=t[l];void 0!==c&&("object"==typeof c?c.body=o?resolveDefineFunction(c.body,r,a):c.body.replace(s,a):t[l]=o?resolveDefineFunction(c,r,a):c.replace(s,a))}e=o?resolveDefineFunction(e,r,a):e.replace(s,a)}return e},extensions=["EXT_shader_texture_lod","EXT_draw_buffers","EXT_frag_depth","OES_standard_derivatives"],getDefaultDefines=function(){for(var e={},t=osg_WebGLCaps__WEBPACK_IMPORTED_MODULE_1__.a.instance(),n=t.getWebGLExtensions(),i=0;i<extensions.length;++i){var r=extensions[i];n[r]&&(e["GL_"+r]="GL_"+r)}return"high"===t.getShaderMaxPrecisionFloat()&&(e.GL_FRAGMENT_PRECISION_HIGH="GL_FRAGMENT_PRECISION_HIGH"),e},fastPreprocess=function(e){e=e.replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"");var t=getDefaultDefines(),n=[];return processBranch(e.split("\n"),0,t,n,!0),resolveDefines(n.join("\n"),t)},preprocess=function(e){var t=e.match("#define SHADER_NAME .*");return e=Object(viewer_getOptions__WEBPACK_IMPORTED_MODULE_2__.a)().cleanShader&&window.glslesPreprocessor?glslPreprocessShader(e):fastPreprocess(e),t?t[0]+"\n"+e:e};shaderProcessor.processIncludes=function(e,t){return e.replace(/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,function(e,n){var i=n.split(" ")[0].replace(/"/g,"");return-1!==t.indexOf(i)?"":(t.push(i),shaderProcessor.processIncludes(shaderProcessor.getShaderTextPure(i),t))})},shaderProcessor.processShader=function(e){if(hasVersion(e))return e;var t=shaderProcessor.processIncludes(e,[]),n=-1===t.indexOf("gl_Position");return t=t.replace(/\\\n/g,""),t=unrollReplace(t),t=preprocess(t),t=handleVaryings(t),t=handleUniforms(t),t=handleAttributes(t),t=fixIndent(t),osg_WebGLCaps__WEBPACK_IMPORTED_MODULE_1__.a.instance().isWebGL2()&&(t=Object(osgShader_gl2convert__WEBPACK_IMPORTED_MODULE_3__.a)(t,n)),t=handlePrecision(t),t=addExtensions(t),t=addVersion(t)};var shadersText={};shaderProcessor.addShaders=function(e){for(var t in e)shadersText[t]&&console.warn("Shader already added : "+t),shadersText[t]=e[t]},shaderProcessor.hasShader=function(e){return void 0!==shadersText[e]},shaderProcessor.getShaderTextPure=function(e){var t=shadersText[e];return t||osg_notify__WEBPACK_IMPORTED_MODULE_0__.a.error("shader file/text: "+e+" not registered"),t},shaderProcessor.getShader=function(e){var t=shaderProcessor.getShaderTextPure(e);return shaderProcessor.processShader(t)},__webpack_exports__.a=shaderProcessor},djFS:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Qavt"),a=n("/QLk"),o=function(e,t){r.a.call(this),this._nbTarget=e,this._enable=!t,this._targetNames={},this._hashNames="",this._hash="",this._dirtyHash=!0};o.uniforms={},i.a.createPrototypeStateAttribute(o,i.a.objectInherit(r.a.prototype,{attributeType:"Morph",cloneType:function(){return new o(void 0,!0)},hasTarget:function(e){return!!this._targetNames[e]},copyTargetNames:function(e){for(var t=this._targetNames,n="",i=t.length=e.length,r=0;r<i;++r){var a=e[r];t[a]=!0,n+=a}this._hashNames=n,this._dirtyHash=!0},getOrCreateUniforms:function(){var e=o,t=this.getNumTargets();return e.uniforms[t]?e.uniforms[t]:(e.uniforms[t]={uTargetWeights:a.a.createFloat4("uTargetWeights")},e.uniforms[t])},setNumTargets:function(e){this._nbTarget=e,this._dirtyHash=!0},getNumTargets:function(){return this._nbTarget},setTargetWeights:function(e){this._targetWeights=e},getTargetWeights:function(){return this._targetWeights},isEnabled:function(){return this._enable},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+this._hashNames+this.getNumTargets()+this.isEnabled()},apply:function(){this._enable&&this.getOrCreateUniforms().uTargetWeights.setFloat4(this._targetWeights)}}),"osgAnimation","MorphAttribute"),t.a=o},dn3j:function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"c",function(){return h}),n.d(t,"b",function(){return x}),n.d(t,"a",function(){return C});var i=n("gcR/"),r=n.n(i),a=n("12sq"),o=(n("q1tI"),n("wsGC")),s=n("gPpI"),u=[{title:"Best selling",icon:"custom-icons icon-best-selling",value:Object(s.e)("store:search",{},{sort_by:"-orderCount",ref:"header"})},{title:"Animated",icon:"fa fa-film",value:Object(s.e)("store:search",{},{animated:!0,ref:"header"})},{title:"PBR",icon:"custom-icons icon-pbr",value:Object(s.e)("store:search",{},{pbr:!0,ref:"header"})},{title:"Low poly",icon:"custom-icons icon-low-poly",value:Object(s.e)("store:search",{},{min_face_count:"0",max_face_count:"10000",ref:"header"})},{title:"High poly",icon:"custom-icons icon-high-poly",value:Object(s.e)("store:search",{},{min_face_count:"100000",ref:"header"})},{title:"3D Printable",icon:"custom-icons icon-d-printing",value:Object(s.e)("store:search",{},{file_formats:["stl"],ref:"header"})},{title:"3D Scan",icon:"custom-icons icon-D-Scan",value:Object(s.e)("store:search",{},{q:["scan"],sort_by:"-orderCount",ref:"header"})}],l=r()("span",{className:"categories-navigation__title title"},void 0,"Highlights"),c=r()("span",{className:"categories-navigation__title title"},void 0,"Browse by category");function h(e){var t=e.categories,n=e.withDropdown,i=e.onToggle,a=e.className,h=e.highLights,d=void 0===h?u:h;return r()("div",{className:Object(o.a)({"categories-navigation__dropdown-container":n},a),onClick:i},void 0,r()("div",{className:Object(o.a)("categories-navigation","--store",{"--dropdown":n})},void 0,r()("div",{className:"categories-navigation__highlights-container"},void 0,r()("ul",{className:"highlights-list --store"},void 0,l,d.map(function(e){return r()("li",{className:"navigation-item"},e.title,r()("a",{title:"".concat(e.title," 3D models"),href:e.value},void 0,r()("i",{className:Object(o.a)("icon  --translucent",e.icon)}),r()("span",{},void 0,e.title)))}))),r()("div",{className:"categories-navigation__menu"},void 0,c,r()("ul",{className:"categories-navigation__list"},void 0,t.map(function(e){return r()("li",{className:"navigation-item"},e.slug,r()("a",{title:"".concat(e.name," 3D models"),href:Object(s.e)("store:search_by_keyword",{keyword:e.slug},{ref:"header"})},void 0,r()("i",{className:Object(o.a)("icon","custom-icons","icon-category-".concat(e.slug))}),r()("span",{},void 0,e.name)))})))))}var d=r()("span",{className:"categories-navigation__title title"},void 0,"Highlights"),f=r()("i",{className:"icon --translucent custom-icons icon-popular"}),p=r()("span",{},void 0,"Popular"),g=r()("i",{className:"icon --translucent custom-icons icon-staffpicks-icon"}),m=r()("span",{},void 0,"Staff picks"),v=r()("i",{className:"icon --translucent fa fa-download"}),_=r()("span",{},void 0,"Downloadable"),b=r()("i",{className:"icon --translucent custom-icons icon-collection"}),S=r()("span",{},void 0,"Collections"),y=r()("span",{className:"categories-navigation__title title"},void 0,"Browse by category");function x(e){var t=e.categories,n=e.anchor,i=void 0===n?"?ref=header":n,u=e.subdomainAnchor,l=void 0===u?"?utm_source=website&utm_campaign=header":u;return r()("div",{className:"categories-navigation"},void 0,r()("div",{className:"categories-navigation__highlights-container"},void 0,r()("ul",{className:"highlights-list --search"},void 0,d,r()("li",{className:"navigation-item"},void 0,r()("a",{title:"Popular 3D models",href:Object(s.e)("models:popular")},void 0,f,p)),r()("li",{className:"navigation-item"},void 0,r()("a",{title:"Staff picks 3D models",href:Object(s.e)("models:staffpicks")},void 0,g,m)),r()("li",{className:"navigation-item"},void 0,r()("a",{title:"Downloadable 3D models",href:Object(s.e)("models:explore",{},{features:"downloadable",date:"week",sort_by:"-likeCount"})},void 0,v,_)),r()("li",{className:"navigation-item"},void 0,r()("a",{title:"Collections 3D models",href:Object(s.e)("collections:popular")},void 0,b,S))),r()("ul",{className:"highlights-list"},void 0,r()("li",{className:"navigation-item"},void 0,r()("a",{href:a.a.hosts.communityBlog+i,title:"Community Blog",target:"_blank"},void 0,"Blog")),r()("li",{className:"navigation-item"},void 0,r()("a",{href:a.a.hosts.discourse+l,title:"Community Forum",target:"_blank"},void 0,"Forum")),r()("li",{className:"navigation-item"},void 0,r()("a",{href:Object(s.e)("users:explore_users"),title:"Community Members"},void 0,"Community members")))),r()("div",{className:"categories-navigation__menu"},void 0,y,r()("ul",{className:"categories-navigation__list"},void 0,t.map(function(e){return r()("li",{className:"navigation-item"},e.slug,r()("a",{title:"".concat(e.name," 3D models"),href:Object(s.e)("models:explore_by_category",{category:e.slug},{date:"week",sort_by:"-likeCount"})},void 0,r()("i",{className:Object(o.a)("icon","custom-icons","icon-category-".concat(e.slug))}),r()("span",{},void 0,e.name)))}))))}function C(e){var t=e.anchor,n=void 0===t?"?ref=header":t,i=[{title:"Enterprise Solutions",href:Object(s.e)("pages:enterprise"),anchor:n},{title:"Sketchfab for Teams",href:Object(s.e)("pages:features_teams"),anchor:n},{title:"3D Viewer",href:Object(s.e)("pages:viewer"),anchor:n},{title:"3D eCommerce",href:Object(s.e)("pages:ecommerce"),anchor:n},{title:"3D Configurators",href:Object(s.e)("pages:configurator"),anchor:n},{title:"Pricing",href:Object(s.e)("pages:plans"),anchor:n},{title:"Customer Stories",href:a.a.hosts.enterpriseBlog,anchor:n}];return r()("div",{className:"community-navigation"},void 0,r()("div",{className:"community-navigation__col"},void 0,r()("div",{className:"community-navigation__list"},void 0,i.map(function(e,t){return r()("div",{className:"navigation-item"},t,r()("a",{href:e.href+e.anchor,title:e.title},void 0,e.title))}))))}},dqY5:function(e,t,n){"use strict";var i=n("lSNA"),r=n.n(i),a=n("MVZn"),o=n.n(a),s=n("hbEN"),u=n("Ui7z"),l=n("M4AY"),c=Symbol("WithGlobalState");t.a=function(e){return{name:"WithGlobalState",initialize:function(){var t=this;this.set(e(l.b.store.getState(),this)),this[c]={unsubscribe:l.b.store.subscribe(Object(s.a)(function(){var n=e(l.b.store.getState(),t),i=Object.keys(n).reduce(function(e,n){return o()({},e,r()({},n,t.get(n)))},{});Object(u.g)(i,n)||t.set(n)},16))}},destroy:function(){this[c].unsubscribe()}}}},drU4:function(e,t,n){"use strict";var i=n("dYt1"),r=n("9oTK"),a=n.n(r),o=n("QLQS"),s=n("gUpJ"),u=n("3rl3"),l=n("UpON"),c=n("par7"),h=n("a5Z4"),d=n("JBIC"),f=n("fgaA"),p=n("GpBa"),g=n.n(p),m=n("47H3"),v=n.n(m),_=o.a.osg,b=_.StateAttribute.OVERRIDE_ON,S=_.createTexturedFullScreenFakeQuadGeometry(),y=function(e,t){_.Camera.call(this),this.addChild(S),this.setNodeMask(0),this._outTexture=e,this._packedTextures=Object(i.a)(t.getPackedTextures()),this._channels=t.getOrderedChannels().slice(),this._lastHash="",this.initPacking()};y.AUTO_RELEASE_GL=!1;var x,C=function(e){for(var t in x)for(var n=x[t].get("stateSet"),i=n.getNumTextureAttributeLists(),r=0;r<i;++r){var a=n.getTextureAttribute(r,"Texture");if(a&&a.getTexture&&a.getTexture()===e)return!1}return!0};_.createPrototypeNode(y,_.objectInherit(_.Camera.prototype,{getNbChannels:function(){return this._channels.length},disablePacking:function(){this.setNodeMask(0);for(var e=this.getStateSet(),t=this.getNbChannels(),n=0;n<t;++n){var i=e.getTextureAttribute(n,"Texture");i&&i!==s.a.dummyTexture&&C(i)&&i.releaseGLObjects()}if(y.AUTO_RELEASE_GL){var r=this.frameBufferObject;r&&r.releaseGLObjects()}},initPacking:function(){var e=this.getOrCreateStateSet(),t=this._packedTextures,n=0,i=this._channels,r=i.length,a=_.Uniform.createInt4("uReadPacking"),o=a.getInternalArray();for(n=0;n<r;++n){var u=i[n],l=t[u].texture.getInternalFormat()===_.Texture.ALPHA,c=d.a.getDefaultComponentCount(u);o[n]=2===c?4:3===c?l?3:2:l?1:0}for(n=0;n<4;++n)e.setTextureAttributeAndModes(n,s.a.dummyTexture,b);this._outTexture.setTextureSize(1,1),this.setRenderOrder(_.Camera.PRE_RENDER,0),this.attachTexture(_.FrameBufferObject.COLOR_ATTACHMENT0,this._outTexture,_.Texture.TEXTURE_2D);var h=new _.Viewport(0,0,1,1);this.setReferenceFrame(_.Transform.ABSOLUTE_RF),this.setViewport(h),e.addUniform(_.Uniform.createInt(0,"uTexture0"),b),e.addUniform(_.Uniform.createInt(1,"uTexture1"),b),e.addUniform(_.Uniform.createInt(2,"uTexture2"),b),e.addUniform(_.Uniform.createInt(3,"uTexture3"),b),e.addUniform(a,b)},updatePacking:function(e){var t,n=this._packedTextures,i=this._channels,r=i.length,a=0,o="";for(a=0;a<r;++a)o+=""+(t=n[i[a]].texture).getWidth()+t.getHeight();if(o===this._lastHash)return 0;var s=0,u=0;for(a=0;a<r;++a){if(!(t=n[i[a]].texture).apply(e))return-1;s=Math.max(s,t.getWidth()),u=Math.max(u,t.getHeight())}if(!c.a.requestTextureBudget(s*u))return-1;this._lastHash=o,this.setNodeMask(-1);var l=this.getStateSet();for(a=0;a<r;++a)t=n[i[a]].texture,l.setTextureAttributeAndModes(a,t,b);return this._outTexture.setTextureSize(s,u),this._outTexture.dirtyMipmap(),this._outTexture._rttPass=!0,this.setRenderOrder(_.Camera.PRE_RENDER,0),this.resetAttachments(),this.attachTexture(_.FrameBufferObject.COLOR_ATTACHMENT0,this._outTexture,_.Texture.TEXTURE_2D),this.getViewport().setViewport(0,0,s,u),(this._packedTextures.Opacity||this._packedTextures.Displacement)&&c.a.redrawShadowNextFrame(),s*u}}),"osgSketchfab","TexturePacker");var w=function(){_.Node.call(this),this.setCullCallback(this),this._program=u.a.getOrCreateShader(g.a,v.a,"material-packer","MaterialPacker"),this._dirtyPackedTextures=[],this._cacheCameras={},this._currentPackingCameras=[],this._frameCount=-1,this._lowResDone=!1,this._highResDone=!1,this._canResolveHighRes=!1,this._allMaterialsPackingCalled=!1};_.createPrototypeNode(w,_.objectInherit(_.Node.prototype,{initReadyForHighResBound:function(){(Object(f.a)().preload?l.a.getHighResLoaded():a.a.all([l.a.getHighResLoaded(),l.a.getFirstCameraAnimation()])).then(function(){this._canResolveHighRes=!0}.bind(this))},addPackedTexture:function(e){this._allMaterialsPackingCalled&&this._dirtyPackedTextures.push(e)},removePackedTexture:function(e){var t=this._dirtyPackedTextures.indexOf(e);t>=0&&(this._dirtyPackedTextures[t]=void 0)},packAllMaterialsTextures:function(e){for(var t in e)for(var n=e[t].get("stateSet"),i=n.getNumTextureAttributeLists(),r=0;r<i;++r){var a=n.getTextureAttribute(r,"Texture");a&&a.getTexture&&a.getTexture()}this._allMaterialsPackingCalled=!0},resetCaches:function(){var e=this.frameBufferObject;e&&e.releaseGLObjects(),this._cacheCameras={},this._currentPackingCameras=[]},deleteUnusedCameras:function(e){var t={};for(var n in e)for(var i=e[n].get("stateSet"),r=i.getNumTextureAttributeLists(),a=0;a<r;++a){var o=i.getTextureAttribute(a,"Texture");if(o&&o.getTexture)t[this._getHash(o)]=!0}var s=this._cacheCameras;for(var u in s)if(!t[u]){var l=s[u];l.disablePacking(),l.getParents()[0].removeChild(l),delete this._cacheTextures[u]}},packTextures:function(e){var t=e.getPackedTextures(),n=e.getOrderedChannels();if(0===n.length)return _.Texture.textureNull;var i=t[n[0]].texture;if(1===n.length)return i;var r=this._getHash(e);if(this._cacheCameras[r])return this._cacheCameras[r]._outTexture;var a=new s.a;a.setForceUpload(!0),function(e){e.generateMipmap=function(){this._rttPass||_.Texture.prototype.generateMipmap.apply(this,arguments),this._rttPass=!1}}(a),a.setImageFormat(_.Texture.RGBA),a.setWrapS(i.getWrapS()),a.setWrapT(i.getWrapT()),a.setMagFilter(i.getMagFilter());var o=i.getMinFilter();a.setMinFilter(o),o===_.Texture.LINEAR_MIPMAP_LINEAR&&Object(f.a)().anisotropy&&a.setMaxAnisotropy(16);var u=new y(a,e);return u.getOrCreateStateSet().setAttributeAndModes(this._program,b),this._cacheCameras[r]=u,this.addChild(u),a},_getHash:function(e){var t="";if(e.getOrderedChannels().length<=1)return t;for(var n=e.getPackedTextures(),i=e.getOrderedChannels(),r=0;r<i.length;++r){var a=i[r],o=n[a].texture,s=d.a.getDefaultComponentCount(a);t+=o.getInstanceID()+"-"+s+"-"}return t},_createNewJobs:function(){var e=this._dirtyPackedTextures,t=e.length;if(t){for(var n=0;n<t;++n)e[n]&&e[n].getTexture();e.length=0}},_disableOldJobs:function(){var e=this._currentPackingCameras,t=e.length;if(!t)return 0;for(var n=0;n<t;++n)e[n].disablePacking();return e.length=0,c.a.draw(),t},_updateNewJobs:function(e){for(var t=this._currentPackingCameras,n=this.getChildren(),i=n.length,r=0;r<i;++r){var a=n[r].updatePacking(e);if(0!==a){if(a<0)return t.length||-1;t.push(n[r])}}return t.length},_checkResolveHighResBound:function(){if(this._canResolveHighRes&&!this._highResDone){this._highResDone=!0,l.a.resolveHighResBound(),Object(f.a)().textureFrameBudget=1/0;var e=this.getChildren(),t=e.length;h.default.logMessage("Texture packing FBO Count : "+t),y.AUTO_RELEASE_GL=!0;for(var n=0;n<t;++n){var i=e[n].frameBufferObject;i&&i.releaseGLObjects()}}},_checkResolveLowResBound:function(){this._lowResDone||(this._lowResDone=!0,l.a.resolveLowResBound())},cull:function(e,t){if(this._frameCount++,0===this._frameCount)return!0;this._createNewJobs();var n=this._disableOldJobs(),i=this._updateNewJobs(t.getRenderer().getState());return this._frameCount>1&&!n&&!i&&(this._checkResolveLowResBound(),this._checkResolveHighResBound()),!0}}));var T=new w;T.setMaterials=function(e){x=e},t.a=T},dtSa:function(e,t,n){"use strict";var i=n("QLQS"),r=n("yWLT"),a=n("Hi2/"),o=n("PnIl"),s=i.a.osg,u=s.Uniform.createFloat4("uColor"),l=new r.a(u.getInternalArray(),1),c=function(){s.StateSet.call(this),this.init()};c.updateCallback=l,s.createPrototypeObject(c,s.objectInherit(s.StateSet.prototype,{setRenderBinVR:function(e){var t=e?a.a.TRANSPARENT_NO_EARLYZ_POST:a.a.WIREFRAME;this.setRenderBinDetails(t,"RenderBin")},init:function(){this.setRenderBinDetails(a.a.WIREFRAME,"RenderBin"),this.setAttributeAndModes(o.a.DEPTH_LEQUAL_WRITE),this.setAttributeAndModes(o.a.BLEND_SUBSTRACTIVE),this.setShaderGeneratorName("wireframe"),this.addUniform(u),this.addUpdateCallback(l)},setWireframeColorSmooth:function(e){l.setColorTarget(e)},setWireframeColor:function(e){u.setFloat4(e)},setWireframeEnable:function(e,t){e?(!0===l._finished&&(u.setFloat3(t),u.getInternalArray()[3]=0),l.show(t[3])):l.hide()}})),t.a=c},dvlG:function(e,t,n){"use strict";var i=n("q1tI"),r=n("+lWh");t.a=function(e,t){i.useEffect(function(){var n=function(n){Object(r.g)(e.current,n.target)||t()};return window.addEventListener("click",n),function(){return window.removeEventListener("click",n)}},[t])}},eAaX:function(e,t,n){e.exports=n.p+"static/assets/images/viewer/UVChecker-9d678cb42a024068a573165fa538bb4d.png"},eBAO:function(e,t,n){"use strict";var i=n("b/No"),r=function(){this._keys=new i.a,this._map={}};r.prototype={reset:function(){for(var e=this._keys.getArray(),t=this._keys.getLength(),n=0;n<t;n++){var i=e[n];this._map[i]=void 0}this._keys.reset()},set:function(e,t){this._keys.push(e),this._map[e]=t},hasKey:function(e){return void 0!==this._map[e]},getMap:function(){return this._map},getKeys:function(){return this._keys},forEach:function(e){for(var t=this._keys.getArray(),n=this._keys.getLength(),i=0;i<n;i++){var r=t[i];e(r,this._map[r])}}},t.a=r},eEbW:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return E});var i=n("o0o1"),r=n.n(i),a=n("yXPU"),o=n.n(a),s=n("QILm"),u=n.n(s),l=n("MVZn"),c=n.n(l),h=n("J4zp"),d=n.n(h),f=n("12sq"),p=n("vDqi"),g=n.n(p),m=n("/0FW"),v=n("ZBlo"),_=n("fujP"),b=n("9mpE"),S=n("89mf"),y=n("Ui7z"),x=n("RzKY"),C=n("QKgc"),w=function(e,t,n){n instanceof File?e.append(t,n,n.name):n instanceof Blob?e.append(t,n,n.name):void 0!==n&&e.append(t,n)},T=function(e){return Object.entries(e).reduce(function(e,t){var n=d()(t,2),i=n[0],r=n[1];return Array.isArray(r)?r.forEach(function(t){return w(e,i,t)}):w(e,i,r),e},new FormData)},M=function(t){return function(n){return e.all(Object(v.a)(n,f.a.apiPageSize).map(function(e){return t(e)})).then(function(e){return e.reduce(function(e,t){return c()({},e,t)},{})})}},E=function(t){var n=Object(S.a)(M(function(e){return t.get("".concat("/i","/users/me/followings").concat(Object(b.b)("?",{user_uids:e}))).then(function(e){return e.results})})),i=Object(S.a)(M(function(e){return t.get("".concat("/i","/users/me/likes").concat(Object(b.b)("?",{model_uids:e}))).then(function(e){return e.results})})),a=Object(S.a)(M(function(e){return t.get("".concat("/i","/users/me/upvotes").concat(Object(b.b)("?",{review_uids:e}))).then(function(e){return e.results})})),s=Object(S.a)(M(function(e){return t.get("".concat("/i","/users/me/purchases").concat(Object(b.b)("?",{model_uids:e}))).then(function(e){return e.results})})),l=Object(S.a)(M(function(e){return t.get("".concat("/i","/collections/subscribed").concat(Object(b.b)("?",{uid:e}))).then(function(e){return e.results})})),h=Object(S.a)(M(function(e){return t.get("".concat("/i","/collections/thumbnails").concat(Object(b.b)("?",{uids:e,count:4})))})),d=Object(S.a)(M(function(e){return t.get("".concat("/i","/users/thumbnails").concat(Object(b.b)("?",{uids:e,count:2})))})),f={login:function(e){var n=e.email,i=e.password,r=e.recaptcha,a=e.next;return t.post("/login",Object(b.b)({email:n,password:i,recaptcha:r,next:a})).then(function(e){return e.result})},signup:function(e){var n=e.username,i=e.email,r=e.password,a=e.gdprConsent,o=e.recaptcha;return t.post("".concat("/i","/users"),Object(y.i)({username:n,email:i,password:r,gdprConsent:a,recaptcha:o}))},logout:function(){return t.post("/logout")},deleteAccount:function(){return t.delete("".concat("/i","/users/me"))},finalizeConnect:function(e){var n=e.email,i=e.password,r=e.gdprConsent;return t.post("/signup/connect",Object(b.b)(Object(y.i)({email:n,password:i,gdprConsent:r})))},finalizeSignup:function(e){var n=e.email,i=e.username,r=e.gdprConsent;return t.post("/signup/finalize",Object(b.b)({email:n,username:i,gdprConsent:r}))},getCurrentUser:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).allowPrefetching;return t.get("".concat("/i","/users/me"),{allowPrefetching:e})},getCurrentUserFollowings:n,doesCurrentUserFollow:function(e){return n([e]).then(function(t){return t[e]})},getCurrentUserLikes:i,doesCurrentUserLike:function(e){return i([e]).then(function(t){return t[e]})},getCurrentUserUpvotes:a,hasCurrentUserUpvoted:function(e){return a([e]).then(function(t){return t[e]})},getCurrentUserPurchases:s,hasCurrentUserPurchased:function(e){return s([e]).then(function(t){return t[e]})},getCurrentUserSubscriptions:l,hasCurrentUserSubscribed:function(e){return l([e]).then(function(t){return t[e]})},getCurrentUserPrivateLimits:function(){return t.get("".concat("/i","/users/me/account"),{allowPrefetching:!1})},getCurrentUserReview:function(e){return t.get("".concat("/i","/users/me/review").concat(Object(b.b)("?",{model:e})))},getCurrentUserBillingAddress:function(){return t.get("".concat("/i","/users/me/billing"))},updateCurrentUserBillingAddress:function(e){return t.patch("".concat("/i","/users/me/billing"),e)},provideCurrentUserGdprConsent:function(){return t.post("".concat("/i","/users/me/gdpr"))},getUserByName:function(e){return t.get("".concat("/i","/users/@").concat(e))},getUserSummary:function(e){return t.get("".concat("/i","/users/").concat(e,"/summary"))},getUsersThumbnails:d,getUserThumbnails:function(e){return d([e]).then(function(t){return t[e]||[]})},getUsersAutoComplete:function(e,n){return t.get("".concat("/i","/users/autocomplete").concat(Object(b.b)("?",n?{q:e,org_uid:n}:{q:e})))},getSeller:function(e){return t.get("".concat("/i","/store/sellers/").concat(e))},becomeASeller:function(){return t.post("".concat("/i","/store/sellers"))},removeSeller:function(e){return t.delete("".concat("/i","/store/sellers/").concat(e))},followUsers:function(e){return t.post("".concat("/i","/users/follow"),{uids:e})},followUser:function(e){return t.post("".concat("/i","/users/").concat(e,"/followers"))},unfollowUser:function(e){return t.delete("".concat("/i","/users/").concat(e,"/followers"))},isCurrentUserSeller:function(){return t.get("".concat("/i","/users/me/is-seller")).then(function(e){return e.isSeller})},updateCurrentUserAvatar:function(e){return t.post("".concat("/i","/avatars"),T({imageFile:e}))},updateCurrentUserEmail:function(e,n){return t.patch("".concat("/i","/users/me/email"),{email:e,password_confirmation:n})},updateCurrentUserPassword:function(e,n){return t.patch("".concat("/i","/users/me/password"),{password:e,password_confirmation:n})},updateUserEmailSettings:function(e,n){return t.patch("".concat("/i","/users/").concat(e,"/email_settings"),n)},updateUserUsageType:function(e,n){return t.patch("".concat("/i","/users/").concat(e),{usageType:n})},sendAccountConfirmationMail:function(e){var n=e.after;return t.get("".concat("/i","/users/email_confirmation").concat(Object(b.b)("?",{after:n})))},patchAppsSettings:function(e,n){return t.patch("".concat("/i","/users/").concat(e,"/apps_settings"),n)},disconnectSocialAuth:function(e){return t.post("/social/disconnect/".concat(e,"/"))},updateUserAllowsRestriced:function(e,n){return t.patch("".concat("/i","/users/").concat(e),{allowsRestricted:n})},getUserSkills:function(){return t.get("".concat("/i","/skills"))},getUserSegments:function(){return t.get("".concat("/i","/segments"))},pollAvatars:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;return t.get("".concat("/i","/avatars/").concat(e),{allowPrefetching:!1}).then(function(e){return e&&!Object(_.a)(e.images)?e:Object(x.d)(n).then(function(){return f.pollAvatars(e.uid)})})},getESUserLikes:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.get("".concat("/i","/models").concat(Object(b.b)("?",c()({},i,{liked_by:e,sort_by:"-liked_at",cursor:n}))))},getUserLikes:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.get("".concat("/i","/search").concat(Object(b.b)("?",c()({},i,{liked_by:e,sort_by:"-likedBy.likedAt",type:"models",cursor:n}))))},getUserFollowers:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.get("".concat("/i","/users/").concat(Object(b.b)("?",c()({},i,{following:e,cursor:n}))))},getUserFollowings:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.get("".concat("/i","/users/").concat(Object(b.b)("?",c()({},i,{followed_by:e,cursor:n}))))},getUserCollections:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.get("".concat("/i","/collections").concat(Object(b.b)("?",c()({},i,{user:e,sort_by:"-created_at",cursor:n}))))},getUserSubscribedCollections:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.get("".concat("/i","/collections").concat(Object(b.b)("?",c()({},i,{subscribed_by:e,cursor:n}))))},getUserModels:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.get("".concat("/i","/models").concat(Object(b.b)("?",c()({},i,{user:e,cursor:n}))))},getCurrentUserModels:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.get("".concat("/i","/me/models").concat(Object(b.b)("?",c()({},n,{processing_status:"succeeded",cursor:e}))))},getModel:function(e,n){return t.get("".concat("/i","/models/").concat(e),n)},getModelLikes:function(e,n){return t.get("".concat("/i","/likes").concat(Object(b.b)("?",{model:e,count:24})),n)},getModelManagement:function(e,n){return t.get("".concat("/i","/models/").concat(e,"/management"),n)},getModelStatus:function(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowPrefetching,i=void 0!==n&&n;return t.get("".concat("/i","/models/").concat(e,"/status"),{allowPrefetching:i})},getModelSharing:function(e){return t.get("".concat("/i","/models/").concat(e,"/sharing"))},getModelCollections:function(e,n){return t.get("".concat("/i","/models/").concat(e,"/collections").concat(Object(b.b)("?",{uid:n})))},getModelRelatedCollections:function(e){return t.get("".concat("/i","/models/").concat(e,"/related-collections").concat(Object(b.b)("?",{count:3})))},getModelRelatedModels:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.get("".concat("/i","/models/").concat(e,"/related").concat(Object(b.b)("?",{count:6,cursor:n})))},getModelExtraArchive:function(e){return t.get("".concat("/i","/archives/extra").concat(Object(b.b)("?",{model:e})))},getModelRatings:function(e){return t.get("".concat("/i","/models/").concat(e,"/ratings"))},getModelFallback:function(e){return t.get("".concat("/i","/models/").concat(e,"/fallback"))},updateModelExtraArchive:function(e,n,i){return t.post("".concat("/i","/archives/extra"),T({model:e,extraFile:n}),{onUploadProgress:i})},removeModelExtraArchive:function(e){return t.delete("".concat("/i","/archives/extra"),T({model:e}))},getModelDownload:function(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{allowPrefetching:!1}).allowPrefetching;return t.get("".concat("/i","/models/").concat(e,"/download"),{allowPrefetching:n})},getModelVersions:function(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowPrefetching,i=void 0!==n&&n;return t.get("".concat("/i","/models/").concat(e,"/versions"),{allowPrefetching:i})},getLatestModelVersion:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowPrefetching,n=void 0!==t&&t;return f.getModelVersions(e,{allowPrefetching:n}).then(function(e){var t=e.results;if(!t.length)throw new Error("this model has no versions");return t.reduce(function(e,t){return new Date(t.createdAt).getTime()>new Date(e.createdAt).getTime()?t:e})})},getModelComments:function(e,n){return t.get("".concat("/i","/comments").concat(Object(b.b)("?",c()({model:e,count:24,sort_by:"-createdAt"},n))))},postComment:function(e){var n=e.body,i=e.modelUid,r=e.visibility;return t.post("".concat("/i","/comments"),{body:n,model:i,visibility:r})},deleteComment:function(e){return t.delete("".concat("/i","/comments/").concat(e))},getModelReviews:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.sortBy,a=void 0===r?"-createdAt":r,o=u()(i,["sortBy"]);return t.get("".concat("/i","/reviews").concat(Object(b.b)("?",Object(y.i)(c()({count:24},o,{model:e,offset:n,sortBy:a})))))},reprocessModel:function(e){return t.post("".concat("/i","/models/").concat(e,"/reprocess"))},duplicateModel:function(e){return t.post("".concat("/i","/models/").concat(e,"/duplicate"))},viewModel:function(e){return t.post("".concat("/i","/models/").concat(e,"/views"))},likeModel:function(e){return t.post("".concat("/i","/models/").concat(e,"/likes"))},unlikeModel:function(e){return t.delete("".concat("/i","/models/").concat(e,"/likes"))},canReviewModel:function(e){return t.get("".concat("/i","/models/").concat(e,"/can-review"))},upvoteReview:function(e){return t.post("".concat("/i","/reviews/").concat(e,"/upvotes"))},downvoteReview:function(e){return t.delete("".concat("/i","/reviews/").concat(e,"/upvotes"))},patchModel:function(e,n){return t.patch("".concat("/i","/models/").concat(e),n)},patchReview:function(e,n){return t.patch("".concat("/i","/reviews/").concat(e),n)},patchAnimation:function(e,n){return t.patch("".concat("/i","/animations/").concat(e),n)},patchModelOptions:function(e,n){return t.patch("".concat("/i","/models/").concat(e,"/options"),n)},createThumbnail:function(e){var n=e.imageFile,i=e.source,r=e.modelUid;return t.post("".concat("/i","/thumbnails"),T({imageFile:n,source:i,modelUid:r}))},getSuggestionsNewsfeed:function(e){return t.get("".concat("/i","/models/suggestions").concat(Object(b.b)("?",e)))},getNewsfeed:function(e,n){return t.get("".concat("/i","/feeds").concat(Object(b.b)("?",e)),n)},getBlogpost:function(){return t.poll("".concat("/i","/feeds/blog"))},getModelArEnterprise:function(e,n){return t.get("".concat("/i","/archives/ar/").concat(Object(b.b)("?",{platform:e,model:n})))},getCurrentUserCollections:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.get("".concat("/i","/me/collections").concat(Object(b.b)("?",Object(y.i)(c()({},e)))))},getCollectionsThumbnails:h,getCollectionThumbnails:function(e){return h([e]).then(function(t){return t[e]||[]})},getCollectionSharing:function(e){return t.get("".concat("/i","/collections/").concat(e,"/sharing"))},getCollectionModels:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.get("".concat("/i","/collections/").concat(e,"/models").concat(Object(b.b)("?",c()({},i,{sort_by:"-collectedAt",cursor:n}))))},getCurrentUserCollectionModels:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.get("".concat("/i","/me/collections/").concat(e,"/models").concat(Object(b.b)("?",c()({},i,{sort_by:"-collectedAt",cursor:n}))))},createCollection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.name,i=void 0===n?"":n,r=e.models,a=void 0===r?[]:r;return t.post("".concat("/i","/collections"),{name:i,models:a})},addModelsToCollection:function(e,n){return t.post("".concat("/i","/collections/").concat(e,"/models"),{models:n})},removeModelsFromCollection:function(e,n){return t.delete("".concat("/i","/collections/").concat(e,"/models"),{models:n})},subscribeToCollection:function(e){return t.post("".concat("/i","/collections/").concat(e,"/subscribe"))},unsubscribeFromCollection:function(e){return t.post("".concat("/i","/collections/").concat(e,"/unsubscribe"))},payOrder:function(e,n){return t.post("".concat("/i","/store/orders/").concat(e,"/pay"),{buyerId:n})},cancelOrder:function(e){return t.post("".concat("/i","/store/orders/").concat(e,"/cancel"))},getOrderStatus:function(e){return t.get("".concat("/i","/store/orders/").concat(e,"/status"),{allowPrefetching:!1})},getCart:function(){return t.get("".concat("/i","/store/cart"))},addModelsToCart:function(e){return t.post("".concat("/i","/store/cart"),{models:e})},removeModelsFromCart:function(e){return t.delete("".concat("/i","/store/cart"),{models:e})},validateCoupon:function(e){return t.get("".concat("/i","/store/coupons/").concat(e.toUpperCase(),"/validate"))},getUnseenActivitiesCount:function(){return t.get("".concat("/i","/feeds/unseen"),{allowPrefetching:!1}).then(function(e){return e.count})},seeActivities:function(){return t.post("".concat("/i","/feeds/seen"))},readActivities:function(e){return t.post("".concat("/i","/feeds/read"),{uids:e})},searchModels:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowPrefetching,i=void 0===n||n,r=e.category,a=void 0===r?void 0:r,o=e.categories,s=void 0===o?[]:o,l=u()(e,["category","categories"]);return t.get("".concat("/i","/search").concat(Object(b.b)("?",Object(y.i)(c()({},l,{type:"models",maxFaceCount:l.maxFaceCount&&isFinite(l.maxFaceCount)?l.maxFaceCount:void 0,categories:s.concat(a?[a]:[])})))),{allowPrefetching:i})},searchCollections:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowPrefetching,i=void 0===n||n;return t.get("".concat("/i","/search").concat(Object(b.b)("?",Object(y.i)(c()({},e,{type:"collections"})))),{allowPrefetching:i})},searchUsers:function(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowPrefetching,i=void 0===n||n;return t.get("".concat("/i","/search").concat(Object(b.b)("?",Object(y.i)(c()({},e,{type:"users"})))),{allowPrefetching:i})},searchCurrentUserCollections:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowPrefetching,i=void 0===n||n;return t.get("".concat("/i","/me/search").concat(Object(b.b)("?",Object(y.i)(c()({},e,{type:"collections"})))),{allowPrefetching:i})},getPublicOrgByName:function(e){return t.get("".concat("/i","/orgs/@").concat(e))},getPrivateOrgByName:function(e){return t.get("".concat("/i","/users/me/orgs/@").concat(e))},getOrgModels:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allowPrefetching,r=void 0===i||i;return t.get("".concat("/i","/orgs/").concat(e,"/models").concat(Object(b.b)("?",Object(y.i)(c()({},n)))),{allowPrefetching:r})},getCurrentUserMemberships:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.get("".concat("/i","/users/me/memberships").concat(Object(b.b)("?",c()({},n,{cursor:e}))))},getCurrentUserOrgMember:function(e){return t.get("".concat("/i","/orgs/").concat(e,"/members/me"))},updateOrg:function(e,n){return t.patch("".concat("/i","/orgs/").concat(e),n)},updateOrgAvatar:function(e,n){return t.post("".concat("/i","/orgs/").concat(e,"/avatars"),T({imageFile:n}))},searchOrgMembers:function(){var e=o()(r.a.mark(function e(n){var i,a,o,s,l,h,d,f,p,g,m,v,_=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=_.length>1&&void 0!==_[1]?_[1]:{},a=_.length>2&&void 0!==_[2]?_[2]:{},o=a.allowPrefetching,s=void 0===o||o,l=i.q,h=void 0===l?"":l,d=i.sortBy,f=void 0===d?"status":d,p=i.minModelCount,g=i.cursor,m=void 0===g?null:g,v=u()(i,["q","sortBy","minModelCount","cursor"]),e.abrupt("return",t.get("".concat("/i","/orgs/").concat(n,"/members").concat(Object(b.b)("?",Object(y.i)(c()({},v,{q:h,sortBy:f,minModelCount:p,cursor:m})))),{allowPrefetching:s}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),searchOrgProjects:function(){var e=o()(r.a.mark(function e(n){var i,a,o,s,l,h,d,f,p,g,m,v=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=v.length>1&&void 0!==v[1]?v[1]:{},a=v.length>2&&void 0!==v[2]?v[2]:{},o=a.allowPrefetching,s=void 0===o||o,l=i.q,h=void 0===l?"":l,d=i.sortBy,f=void 0===d?"-updatedAt":d,p=i.cursor,g=void 0===p?null:p,m=u()(i,["q","sortBy","cursor"]),e.abrupt("return",t.get("".concat("/i","/orgs/").concat(n,"/projects").concat(Object(b.b)("?",Object(y.i)(c()({},m,{q:h,sortBy:f,cursor:g})))),{allowPrefetching:s}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),addOrgMember:function(e,n,i){return t.post("".concat("/i","/orgs/").concat(e,"/members"),{invite_email:n,role:i})},updateOrgMember:function(e,n,i){return t.patch("".concat("/i","/orgs/").concat(e,"/members/").concat(n),i)},sendOrgInvite:function(){var e=o()(r.a.mark(function e(n,i){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.post("".concat("/i","/orgs/").concat(n,"/members/").concat(i,"/send-invite")));case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),deleteOrgMember:function(e,n){return t.delete("".concat("/i","/orgs/").concat(e,"/members/").concat(n))},acceptOrgInvite:function(e,n){return t.post("".concat("/i","/orgs/").concat(e,"/accept-invite"),{token:n})},requestOrgSeats:function(){var e=o()(r.a.mark(function e(n,i){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.post("".concat("/i","/orgs/").concat(n,"/request-seats"),{requested_seat_count:i}));case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),trackMixpanelEvent:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.post("".concat("/t","/mp"),c()({key:e},n))},registerUTM:function(){return t.post("".concat("/t","/camp"))},getLicenses:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.get("".concat("/i","/licenses").concat(Object(b.b)("?",e)))},getCategories:function(){return t.get("".concat("/i","/categories"))},getMarkdownPreview:function(n){return n.trim()?t.post("".concat("/i","/markdown/preview"),{text:n}):e.resolve({result:""})},revokeApp:function(e){return t.post("/oauth2/revoke_app/",Object(b.b)({app_id:e}))},getCsrf:function(){return t.get("".concat("/i","/csrf"))},getEnvironmentProcessingStatus:function(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowPrefetching,i=void 0===n||n;return t.get("".concat("/i","/environments/").concat(e,"/status"),{allowPrefetching:i})},getVersion:function(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowPrefetching,i=void 0===n||n;return t.get("".concat("/i","/version/").concat(e),{allowPrefetching:i})},pollModelExtraFileProcessingStatus:function(n){return t.retry(1/0,function(){return f.getModelManagement(n,{allowPrefetching:!1}).then(function(t){return t.extraFile&&["processing","pending"].includes(t.extraFile.status)?e.reject(new C.f):t})},{interval:1e4})},getOngoingBanner:function(){return t.get("".concat("/i","/banners/ongoing"))},getTagSuggestions:function(){return t.get("".concat("/i","/users/me/tag_suggestions"))},getTagAutocomplete:function(e){return t.get("".concat("/i","/tags/autocomplete").concat(Object(b.b)("?",{q:e})))},uploadModel:function(e){var n=e.modelFile,i=e.source,r=e.onUploadProgress,a=e.org;return new x.a(function(e,o){var s=g.a.CancelToken.source();return t.post("".concat("/i","/models"),T({modelFile:n,source:i,isPublished:"false",org:a}),{onUploadProgress:r,cancelToken:s.token}).then(e,o),function(){return s.cancel()}})},reuploadModel:function(e){var n=e.uid,i=e.name,r=e.modelFile,a=e.isPublished,o=e.source,s=e.onUploadProgress;return new x.a(function(e,u){var l=g.a.CancelToken.source();return t.post("".concat("/i","/models/").concat(n,"/versions"),T({modelFile:r,source:o,isPublished:"".concat(a),name:i}),{onUploadProgress:s,cancelToken:l.token}).then(e,u),function(){return l.cancel()}})}};return f},A=E(m.b);t.b=A}).call(this,n("CSL1"))},ei2W:function(e,t,n){"use strict";n.d(t,"a",function(){return _});var i=n("lwsE"),r=n.n(i),a=n("W8MJ"),o=n.n(a),s=n("a1gu"),u=n.n(s),l=n("Nsbk"),c=n.n(l),h=n("PJYZ"),d=n.n(h),f=n("7W2i"),p=n.n(f),g=n("lSNA"),m=n.n(g),v=n("q1tI"),_=function(e){function t(){var e,n;r()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=u()(this,(e=c()(t)).call.apply(e,[this].concat(a))),m()(d()(n),"state",{isMounted:!1}),n}return p()(t,e),o()(t,[{key:"componentDidMount",value:function(){this.setState({isMounted:!0})}},{key:"render",value:function(){return(this.state.isMounted?this.props.children():this.props.fallback)||null}}]),t}(v.Component)},eycI:function(e,t,n){"use strict";var i,r=n("YfG3");i=n("j3Bp").a.extend({},{get:function(e){e=Object(r.a)({},e);var t=new this;return!1!==e.allowPrefetching?(void 0===this.singleton&&(this.singleton=t),this.singleton.fetch(e),this.singleton):t.fetch(e)}}),t.a=i},"f/27":function(e,t,n){"use strict";var i=n("a3nb"),r=n("icjm"),a=n("JLE6"),o=n("czSk"),s=n("r7P/"),u=function(){a.a.call(this)};i.a.createPrototypeObject(u,i.a.objectInherit(a.a.prototype,{update:function(e,t){if(t.getVisitorType()===s.a.UPDATE_VISITOR){if(e.className&&"Bone"!==e.className())return r.a.warn("Warning: UpdateBone set on non-Bone object."),!1;var n=e;a.a.prototype.update.call(this,e),n.setMatrix(n.getMatrix());var i=n.getMatrix(),u=n.getBoneParent();u?o.c.mul(n.getMatrixInSkeletonSpace(),u.getMatrixInSkeletonSpace(),i):n.setMatrixInSkeletonSpace(i)}return!0}}),"osgAnimation","UpdateBone"),t.a=u},f4Fj:function(e,t){e.exports='#pragma include "utils/decodeDepth.glsl"\r\n\r\nuniform sampler2D TextureFixed;\r\nuniform vec2 uFixedScale;\r\n\r\nuniform sampler2D TextureDepth;\r\nuniform vec2 uTextureOutputSize;\r\n\r\nuniform vec4 uHalton;\r\nuniform float uSplitView;\r\n\r\nvec4 composeBackground(const in vec3 color, const in float alpha) {\r\n    vec2 jitter = uHalton.xy * 0.5 / uTextureOutputSize;\r\n    vec2 uv = (gTexCoord - 0.5 + jitter) * uFixedScale + 0.5;\r\n\r\n    // we recenter and unstretch the background\r\n    if (uSplitView == 1.0) uv.x = uv.x * 0.5 + 0.25;\r\n\r\n    // composer can\'t guess based on user data, so SRGBToLinear should be defined (or not) by TEXTURE_2D_XXXXXXX\r\n    vec3 backgroundColor = sRGBToLinear(texture2D(TextureFixed, uv).rgb);\r\n    return vec4(color.rgb + backgroundColor * (1.0 - alpha), 1.0);\r\n}\r\n\r\nuniform sampler2D TextureInput;\r\nuniform vec2 uTextureInputSize;\r\nuniform vec2 uTextureInputRatio;\r\n\r\nuniform sampler2D TextureRefraction;\r\nuniform vec2 uTextureRefractionSize;\r\nuniform vec2 uTextureRefractionRatio;\r\nuniform float uRGBMRange;\r\n\r\nvec4 composeFixedBackground(const in vec4 color) {\r\n#ifdef REFRACTION_COMPOSITING_EXCLUSION\r\n    // detect if we are on a refraction pixel\r\n    vec2 uvRef = min(gTexCoord, 1.0 - 1.0 / uTextureRefractionSize.xy);\r\n    if (texture2D(TextureRefraction, uvRef * uTextureRefractionRatio).a > 0.0) return color;\r\n#endif\r\n\r\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\r\n    return composeBackground(color.rgb, alpha);\r\n}\r\n\r\nvec4 composeFixedBackgroundRefraction() {\r\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\r\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\r\n    return composeBackground(color.rgb, alpha);\r\n}'},f4yh:function(e,t,n){"use strict";var i=n("J4zp"),r=n.n(i),a=n("q1tI");t.a=function(){var e=Object(a.useState)([window.innerWidth,window.innerHeight]),t=r()(e,2),n=t[0],i=t[1];return Object(a.useEffect)(function(){var e=function(){return i([window.innerWidth,window.innerHeight])};return window.addEventListener("resize",e,{passive:!0}),function(){return window.removeEventListener("resize",e,{passive:!0})}},[]),n}},f5KD:function(e,t,n){"use strict";n.d(t,"a",function(){return _});var i=n("cDf5"),r=n.n(i),a=n("YfG3"),o=n("q1z7"),s=n.n(o),u=n("17x9"),l=n.n(u),c=n("WbBG"),h=n.n(c);function d(e){function t(t,n,i,r,a,o){var s=n[i];return o=o||i,null===s||void 0===s?t?new Error("Required "+a+" `"+o+"` was not specified in `"+r+"`."):null:e(n,i,r,a,o,h.a)}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function f(e){return Array.isArray(e)?"array":r()(e)}function p(e){return d(function(t,n,i,r,a){var o=t[n],u=f(o);if(!function(e){return e instanceof s.a.Model}(o))return new Error("Invalid "+r+" `"+a+"` of type `"+u+"` supplied to `"+i+"`, expected `Backbone.Model`.");for(var l in e){var c=e[l];if(c){var d=c(o.attributes,l,i,r,n+".get('"+l+"')",h.a);if(d)return d}}return null})}var g=p({}),m=d(function(e,t,n,i,r){var a=e[t],o=f(a);return function(e){return e instanceof s.a.Collection}(a)?null:new Error("Invalid "+i+" `"+r+"` of type `"+o+"` supplied to `"+n+"`, expected `Backbone.Collection`.")}),v=Object(a.a)({},l.a);v.valuesOf=function(e){return d(function(t,n,i,r,a){var o=function(e,t,n,i){if("function"!=typeof e)return new Error("Property `"+t+"` of `"+n+"` has invalid OptionType notation inside "+i+".")}(e,a,i,"valuesOf");if(o)return o;var s=t[n],u=f(s);if("object"!==u)return new Error("Invalid "+r+" `"+a+"` of type `"+u+"` supplied to `"+i+"`, expected an object.");for(var l in s){var c=e(s,l,i,r,a+"."+l,h.a);if(c instanceof Error)return c}return null})},v.modelShape=p,v.model=g,v.collection=m,v.numberBetween=function(e,t){return d(function(n,i,r,a,o){var s=l.a.number(n,i,r,a,o,h.a);if(s)return s;var u=n[i];return u<e||u>t?new Error("Invalid "+a+" `"+i+"` of value `"+u+"` supplied to `"+r+"`, expected number between "+e+" and "+t+"."):null})},v.component=v.oneOfType([v.shape({viewClass:v.func.isRequired,options:v.object}).isRequired,v.arrayOf(v.shape({viewClass:v.func.isRequired,options:v.object})).isRequired]),v.selectOptionListOf=function(e){return v.arrayOf(v.shape({title:v.string.isRequired,value:e,default:v.bool}).isRequired)},t.b=v;var _=l.a.checkPropTypes},ff9x:function(e,t,n){"use strict";var i=n("a3nb"),r=n("r7P/"),a=n("WqyB"),o=function(e){r.a.call(this,r.a.TRAVERSE_ALL_CHILDREN),this._selectables=e,this._nodeList=[],this._linkList=[],this._uniqueNodes=new window.Set,this._uniqueEdges=new window.Set};i.a.createPrototypeObject(o,i.a.objectInherit(r.a.prototype,{getColorFromClassName:function(e){switch(e){case"ShadowedScene":return"#3D3D3D";case"Camera":return"#AB7BCF";case"RenderBin":return"#59778B";case"LightSource":return"#53967D";case"RenderStage":return"#DDCC55";case"RenderLeaf":case"Geometry":return"#FFCC55";case"RigGeometry":return"#DD8800";case"MorphGeometry":return"#AA5500";case"MatrixTransform":return"#CE697E";case"StateSet":return"#0099FF";case"StateGraph":case"Skeleton":return"#96999E";case"Bone":return"#A9DEAA";case"Node":return"#FFFFFF";default:return"#FF00AA"}},createGraph:function(e){this.reset(),e.accept(this)},reset:function(){this._nodeList.length=0,this._linkList.length=0,this._uniqueNodes.clear(),this._uniqueEdges.clear()},apply:function(e){if(!e._isNormalDebug){if(this._uniqueNodes.has(e.getInstanceID())||(this._uniqueNodes.add(e.getInstanceID()),this._nodeList.push(e)),this.nodePath.length>=2){var t=this.nodePath[this.nodePath.length-2].getInstanceID(),n=e.getInstanceID(),i=t+"+"+n;this._uniqueEdges.has(i)||(this._linkList.push({parentNode:t,childrenNode:n}),this._uniqueEdges.add(i))}this.traverse(e)}},createMatrixGrid:function(e,t){var n="";return n+="<table><tr><td>"+t[0]+"</td>",n+="<td>"+t[4]+"</td>",n+="<td>"+t[8]+"</td>",n+="<td>"+t[12]+"</td></tr>",n+="<tr><td>"+t[1]+"</td>",n+="<td>"+t[5]+"</td>",n+="<td>"+t[9]+"</td>",n+="<td>"+t[13]+"</td></tr>",n+="<tr><td>"+t[2]+"</td>",n+="<td>"+t[6]+"</td>",n+="<td>"+t[10]+"</td>",n+="<td>"+t[14]+"</td></tr>",n+="<tr><td>"+t[3]+"</td>",n+="<td>"+t[7]+"</td>",n+="<td>"+t[11]+"</td>",n+="<td>"+t[15]+"</td></tr></table>"},getLabel:function(e){var t=e.className()+" ("+e.getInstanceID()+")";return e.getName&&e.getName()&&(t+="\n"+e.getName()),t},generateNode:function(e,t){var n="";t.getMatrix&&t.getMatrix()&&(n+="<br /><br />"+this.createMatrixGrid(t,t.getMatrix())),this._selectables.set(t.getInstanceID().toString(),t),e.addNode(t.getInstanceID(),{label:this.getLabel(t),description:n,style:"fill: "+this.getColorFromClassName(t.className())+";stroke-width: 0px;"})},generateStateSet:function(e,t){var n=t.getStateSet(),i=n.getInstanceID(),r=this.getLabel(n);r+="\nNbTexture : "+n.getNumTextureAttributeLists(),e.hasNode(i)||(this._selectables.set(i.toString(),n),e.addNode(i,{label:r,style:"fill: "+this.getColorFromClassName(n.className())+";stroke-width: 0px;"})),e.addEdge(null,t.getInstanceID(),i,{style:"stroke: "+this.getColorFromClassName(n.className())+";"})},generateSourceGeometry:function(e,t){var n=t.getSourceGeometry(),i=n.getInstanceID();this._selectables.set(i.toString(),n),e.addNode(i,{label:this.getLabel(n),style:"fill: "+this.getColorFromClassName(n.className())+";stroke-width: 0px;"}),e.addEdge(null,t.getInstanceID(),i,{style:"stroke: "+this.getColorFromClassName(n.className())+";"})},generateNodeAndLink:function(e){for(var t=0,n=this._nodeList.length;t<n;t++){var i=this._nodeList[t];this.generateNode(e,i),i.getStateSet()&&this.generateStateSet(e,i),i.getSourceGeometry&&i.getSourceGeometry()instanceof a.a&&this.generateSourceGeometry(e,i)}for(var r=0,o=this._linkList.length;r<o;r++)e.addEdge(null,this._linkList[r].parentNode,this._linkList[r].childrenNode)}}),"osgUtil","DisplayGraphNode");var s=o,u=n("jYW0"),l=function(e){this._selectables=e,this._nodeList=[],this._linkList=[],this._renderBinMap=new window.Map,this._renderBinStack=[],this._generatorID=0,this._refID=0,this._uniqueEdges=new window.Set};l.prototype={getColorFromClassName:s.prototype.getColorFromClassName,createGraph:function(e){this.reset(),this.apply(e)},reset:function(){this._renderBinMap.clear(),this._renderBinStack.length=0,this._generatorID=0,this._refID++,this._nodeList.length=0,this._linkList.length=0,this._uniqueEdges.clear()},apply:function(e){var t=e.getInstanceID();if(this._renderBinMap.has(t)||this._renderBinMap.set(t,e),this._renderBinStack.push(e),e.getPreRenderStageList)for(var n=e.getPreRenderStageList(),i=0,r=n.length;i<r;++i)this.apply(n[i].renderStage);if(this.registerNode(e),e.getPostRenderStageList)for(var a=e.getPostRenderStageList(),o=0,s=a.length;o<s;++o)this.apply(a[o].renderStage);this._renderBinStack.pop()},registerNode:function(e){var t=e.getInstanceID();if(this._nodeList.push(e),e._bins.forEach(function(e,t){this.apply(t)}.bind(this)),e._leafs.length)for(var n=0,i=e._leafs.length;n<i;n++)this.createNodeAndSetID(t,e._leafs[n]);var r=this,a={},o=function(e){r.createNodeAndSetID(this.stateGraphID,e)}.bind(a);if(e.getStateGraphList().forEach(function(e){r.createNodeAndSetID(t,e);var n=e._instanceID,i=e.getLeafs();a.stateGraphID=n,i.forEach(o)}),!(this._renderBinStack.length<2)){var s=this._renderBinStack[this._renderBinStack.length-2].getInstanceID();this.createLink(s,t)}},createLink:function(e,t){var n=e+"+"+t;this._uniqueEdges.has(n)||(this._linkList.push({parentNode:e,childrenNode:t}),this._uniqueEdges.add(n))},createNodeAndSetID:function(e,t){this._nodeList.push(t),(void 0===t._instanceID||t._instanceID<0&&t._refID!==this._refID)&&(t._instanceID=-1-this._generatorID++,t._refID=this._refID),this.createLink(e,t._instanceID)},generateRenderLeaf:function(e,t){var n=t._instanceID,i=t._geometry&&t._geometry.getName()?"\n"+t._geometry.getName():"Geometry",r="RenderLeaf ( "+t._instanceID+" )";r+="\n"+i+" ( "+t._geometry.getInstanceID()+" )",this._selectables.set(n.toString(),t),e.addNode(n,{label:r,description:"",style:"fill: "+this.getColorFromClassName("RenderLeaf")+";stroke-width: 0px;"})},generateStateGraph:function(e,t){var n=t._instanceID,i="StateGraph ( "+t._instanceID+" )";i+="\n"+t._leafs._length+" leafs",this._selectables.set(n.toString(),t),e.addNode(n,{label:i,description:"",style:"fill: "+this.getColorFromClassName("StateGraph")+";stroke-width: 0px;"})},generateRenderStage:function(e,t){var n=t.className()+" ( "+t._instanceID+" )";t.getName()&&(n+="\n"+t.getName()),n+="\nViewport ( "+t.getViewport().width()+" x "+t.getViewport().height()+" )",this._selectables.set(t.getInstanceID().toString(),t),e.addNode(t.getInstanceID(),{label:n,description:"",style:"fill: "+this.getColorFromClassName(t.className())+";stroke-width: 0px;"})},generateRenderBin:function(e,t){var n=t.className()+" ( "+t.getInstanceID()+" )";t.getName()&&(n+="\n"+t.getName());var i="";t.getSortMode()===u.a.SORT_BACK_TO_FRONT&&(i="SortMode: BackToFront");var r="BinNumber: "+t.getBinNumber()+"\n"+i;this._selectables.set(t.getInstanceID().toString(),t),e.addNode(t.getInstanceID(),{label:n,description:r,style:"fill: "+this.getColorFromClassName(t.className())+";stroke-width: 0px;"})},generateNodeAndLink:function(e){for(var t=0,n=this._nodeList.length;t<n;t++){var i=this._nodeList[t];i._geometry&&void 0!==i._depth?this.generateRenderLeaf(e,i):"StateGraph"===i.className()?this.generateStateGraph(e,i):"RenderStage"===i.className()?this.generateRenderStage(e,i):this.generateRenderBin(e,i)}for(var r=0,a=this._linkList.length;r<a;r++)e.addEdge(null,this._linkList[r].parentNode,this._linkList[r].childrenNode)}};var c,h=l,d=n("icjm"),f=function(e){this.options=e;var t=document.createElement("style");t.type="text/css",t.innerHTML=[".osgDebugSimpleTooltip {","display: none;","position: absolute;","margin-left: 10px;","border-radius: 4px;","padding: 10px;","background: rgba(0,0,0,.9);","color: #ffffff;","}",".osgDebugSimpleTooltip:before {","content: ",";","position: absolute;","left: -10px;","top: 8px;","border: 10px solid transparent;","border-width: 10px 10px 10px 0;","border-right-color: rgba(0,0,0,.9);","}"].join("\n"),document.getElementsByTagName("head")[0].appendChild(t),this.el=document.createElement("div"),this.el.className="osgDebugSimpleTooltip",document.body.appendChild(this.el);for(var n=document.querySelectorAll(this.options.selector),i=0;i<n.length;i++)n[i].addEventListener("mouseover",this.showTooltip.bind(this),!1),n[i].addEventListener("mouseout",this.hideTooltip.bind(this),!1)};f.prototype={showTooltip:function(e){if(c){var t=e.currentTarget;this.el.innerHTML=t.getAttribute("title"),this.el.style.display="block",this.el.style.left=c(t).position().left+c(t).get(0).getBoundingClientRect().width+"px",this.el.style.top=c(t).position().top+"px"}},hideTooltip:function(){this.el.style.display="none"}};var p=function(){!function(){try{c=n("EVdn")}catch(e){d.a.warn("You will not be able to use osgUtil.DisplayGraph until you add jQuery in your page")}}(),c&&(this._selectables=new window.Map,this._graphNode=new s(this._selectables),this._graphRender=new h(this._selectables),this._displayNode=!0,this._displayRenderer=!1,this._cbSelect=void 0,this._focusedElement="graph",this._idToDomElement=new window.Map,this._$svg=c("<svg width=100% height=100%></svg>"),c("body").append(this._$svg),this._css=".node {text-align: center;cursor: pointer;}.node rect {stroke: #FFF;}.edgePath path {stroke: #FFF;fill: none;}table {text-align: right;}svg {position: absolute;left: 0px;top: 0px;}.osgDebugButton {position: absolute;left: 15px;top: 15px;z-index: 5;border: 0;background: #65a9d7;background: -webkit-gradient(linear, left top, left bottom, from(#3e779d), to(#65a9d7));background: -webkit-linear-gradient(top, #3e779d, #65a9d7);background: -moz-linear-gradient(top, #3e779d, #65a9d7);background: -ms-linear-gradient(top, #3e779d, #65a9d7);background: -o-linear-gradient(top, #3e779d, #65a9d7);padding: 5px 10px;-webkit-border-radius: 7px;-moz-border-radius: 7px;border-radius: 7px;-webkit-box-shadow: rgba(0,0,0,1) 0 1px 0;-moz-box-shadow: rgba(0,0,0,1) 0 1px 0;box-shadow: rgba(0,0,0,1) 0 1px 0;text-shadow: rgba(0,0,0,.4) 0 1px 0;color: white;font-size: 15px;font-family: Helvetica, Arial, Sans-Serif;text-decoration: none;vertical-align: middle;}.osgDebugButton:hover {border-top-color: #28597a;background: #28597a;color: #ccc;}.osgDebugButton:active {border-top-color: #1b435e;background: #1b435e;}.osgDebugSimpleTooltip .osgDebugName {font-weight: bold;color: #60b1fc;margin: 0;}.osgDebugSimpleTooltip .osgDebugDescription {margin: 0;}")};p.instance=function(){return p._instance||(p._instance=new p),p._instance},p.prototype={getColorFromClassName:s.prototype.getColorFromClassName,setCallbackSelect:function(e){this._cbSelect=e},reset:function(){c&&(this._selectables.clear(),this._$svg.empty(),this._focusedElement="scene",c(".osgDebugButton").hide())},setDisplayGraphRenderer:function(e){this._displayRenderer=e},createRenderGraph:function(e){this._graphRender.createGraph(e),this.displayGraph()},createGraph:function(e){c&&(this.reset(),this._displayNode=!!e,e&&this._graphNode.createGraph(e),this._displayRenderer?n("UwbM").default.debugGraph=!0:this.displayGraph())},displayGraph:function(){if(c)if(window.d3&&window.dagreD3)this._createGraphApply();else{var e=this._createGraphApply.bind(this);c.getScript("//cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js").done(function(){c.getScript("//cdn.jsdelivr.net/dagre-d3/0.2.9/dagre-d3.min.js").done(e)})}},_createGraphApply:function(){var e=new window.dagreD3.Digraph;this._displayNode&&this._graphNode.generateNodeAndLink(e),this._displayRenderer&&this._graphRender.generateNodeAndLink(e),this.injectStyleElement(),c(".osgDebugButton").show();var t=this.renderer=new window.dagreD3.Renderer,n=window.d3.select(this._$svg.get(0)).append("g"),i=t.zoom();t.zoom(function(e,t){var n=i(e,t);return n.scale(.75).event(t),n});var r=this._idToDomElement,a=t.drawNodes();t.drawNodes(function(e,t){var n=a(e,t);return n.attr("title",function(t){return r.set(t,this),function(e,t){return'<p class="osgDebugName">'+e+'</p><pre class="osgDebugDescription">'+t+"</pre>"}(t,e.node(t).description||"")}),n}),t.run(e,n),this.tooltip=new f({selector:".node"}),c(".node").click(this.onNodeSelect.bind(this)),this.focusOnGraph()},selectNode:function(e){var t=e.getInstanceID(),n=this._idToDomElement.get(t);n&&c(n).click()},onNodeSelect:function(e){var t=e.currentTarget,n=c(t.getAttribute("title"))[0].innerHTML,i=this._selectables;this.lastNode&&(this.lastNode.style.fill=this.lastColor);var r=i.get(n);r&&(this.lastNode=t.childNodes[0],this.lastColor=this.lastNode.style.fill,t.childNodes[0].style.fill="#f00",window.activeNode=r,d.a.info("window.activeNode is set with the node below !"),d.a.log(window.activeNode),d.a.log("\n"),this._cbSelect&&this._cbSelect(r))},focusOnScene:function(){c(".osgDebugButton").text("Access to the graph"),this._$svg.css("zIndex","-2"),this._focusedElement="scene"},focusOnGraph:function(){c(".osgDebugButton").text("Access to the scene"),this._$svg.css("zIndex","2"),c(".osgDebugSimpleTooltip").css("zIndex","3"),this._focusedElement="graph"},injectStyleElement:function(){if(!this._cssInjected){this._cssInjected=!0,c("body").append('<button class="osgDebugButton">Access to the scene</button>'),c(".osgDebugButton").click(function(){"scene"===this._focusedElement?this.focusOnGraph():this.focusOnScene()}.bind(this));var e=document.createElement("style");e.type="text/css",e.innerHTML=this._css,document.getElementsByTagName("head")[0].appendChild(e)}}};t.a=p},fgaA:function(e,t,n){"use strict";var i,r=n("12sq"),a=n("xnu4"),o=n("9HIO"),s=n("nZll"),u=n("6xPH"),l=n("9mpE"),c=n("LlpJ"),h=n("h/Nh"),d=n("jiW3"),f=n("dZz+"),p=function(e){if(null!==e&&void 0!==e)return"+Infinity"===e||"Infinity"===e?1/0:"-Infinity"===e?-1/0:e};t.a=function(){if(i)return i;if(window.prefetchedData.embedOptions)for(var e in i=window.prefetchedData.embedOptions)i[e]=p(i[e]);else i=function(){var e={};for(var t in o){var n=o[t],i=p(n.defaultValue),r=void 0;if(void 0!==n.alias)for(var s in n.alias)if(void 0!==(r=l.c[n.type](s)))break;e[Object(a.a)(t)]=void 0!==r?r:l.c[n.type](t,i)}return e}();try{f.a.me().get("isStaff")&&void 0===i.webgl2&&(i.webgl2=!0)}catch(e){console.warn("Prefetching failure while trying to reach User.me(). This is probably because this code has been run in a non web context where prefetchdata are unusable.")}if(i.apiId=l.c.string("api_id",void 0),i.uiInspector){var t=Object(s.a)();i.uiInspector=-1===r.a.inspectorBlacklist.indexOf(t)}i.annotationCycleAutostart=void 0!==i.annotationCycle,i.annotationCycleDuration=5e3,void 0!==i.annotationCycle&&(i.annotationCycleDuration=1e3*i.annotationCycle,delete i.annotationCycle),(i.cardboard||i.annotation||Object(u.a)())&&(i.camera=!1),i.stats&&(i.continuousRender=!0),i.processOptions&&Object(h.a)(!0),i.processOptions&&(i.processMaterial=!0),i.stats&&(i.webglTimerGpu=!1);var n=!(i.apiVersion&&"1.1.0"!==i.apiVersion||i.materialShowcase),g=!Object(h.a)()&&!Object(u.a)()&&n;return void 0===i.mergeMaterials&&(i.mergeMaterials=g),void 0===i.graphOptimizer&&(i.graphOptimizer=g),void 0===i.materialPacking&&(i.materialPacking=n),void 0===i.imageCompression&&(i.imageCompression=!Object(u.a)()),i.shadowAtlas=i.shadowAtlas&&!Object(u.a)(),void 0===i.vrQuality&&navigator&&/OculusBrowser/i.test(navigator.userAgent)&&(/Quest/i.test(navigator.userAgent)&&(i.vrQuality=1.5),console.log("forcing VR quality to",i.vrQuality)),void 0!==i.vrQuality&&(i.vrScaleRtt=1,i.maxDevicePixelRatio=i.vrQuality),Object(d.a)(i.maxDevicePixelRatio),void 0===i.drsMin&&(i.drsMin=1/Object(d.a)()),i.sssKernel%2==0&&i.sssKernel++,i.sssHalfKernel=1+(i.sssKernel>>1),Object(c.a)(i),void 0===i.zz&&(i.zz=!Object(u.a)()),void 0===i.forceTriangles&&(i.forceTriangles=-1!==navigator.userAgent.indexOf("Firefox/62.0")),i}},fsbH:function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/components/atoms/dropdown.jinja"]={root:function(e,t,n,i,r){var a="";try{var o=i.makeMacro([],["options"],function(r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var o,s="";return s+="\n    ",o=e.getFilter("merge").call(t,{labelTitle:"",labelValue:"",className:"",longestLabelValue:"",placeholder:"",theme:"",color:"",components:{},disabled:!1,isOpen:!1,withBackground:!1,grey:!1},i.contextOrFrameLookup(t,n,"options")),n.set("options",o,!0),n.topLevel&&t.setVariable("options",o),n.topLevel&&t.addExport("options",o),s+='\n    <div\n        class="c-dropdown ',s+=i.suppressValue(e.getFilter("class_names").call(t,{"--disabled":i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"disabled"),"--open":i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"isOpen"),"--with-background":i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"withBackground"),"--grey":i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"grey")}),e.opts.autoescape),s+=" ",s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"className"),e.opts.autoescape),s+=" ",s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"theme")?"--"+i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"theme")+"-theme":"",e.opts.autoescape),s+='">\n        <div\n            class="c-dropdown__label"\n            data-action="toggle-menu"\n            data-disabled="',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"disabled"),e.opts.autoescape),s+='">\n            <span\n                data-ref="labelTitle"\n                class="c-dropdown__label-title">\n                ',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"labelTitle")?i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"labelTitle"):"",e.opts.autoescape),s+='\n            </span>\n\n            <span\n                class="',s+=i.suppressValue(e.getFilter("class_names").call(t,{"c-dropdown__label-value":!0,"--placeholder":!i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"labelValue")}),e.opts.autoescape),s+='"\n                style="',s+=i.suppressValue(e.getFilter("style").call(t,{color:i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"labelValue")?i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"color"):""}),e.opts.autoescape),s+='">\n                <span class="c-dropdown__label-value__text ',s+=i.suppressValue(e.getFilter("class_names").call(t,{"--absolute":i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"longestLabelValue")}),e.opts.autoescape),s+='">\n                    ',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"labelValue")?i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"labelValue"):i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"placeholder"),e.opts.autoescape),s+='\n                </span>\n\n                <span class="c-dropdown__label-value__hidden">',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"longestLabelValue"),e.opts.autoescape),s+='</span>\n            </span>\n        </div>\n        <div\n            data-ref="menu"\n            class="c-dropdown__menu ',s+=i.suppressValue(e.getFilter("class_names").call(t,{"--open":i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"isOpen")}),e.opts.autoescape),s+='">\n            ',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"isOpen")?e.getFilter("component").call(t,i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"components"),"child")):"",e.opts.autoescape),s+="\n        </div>\n    </div>\n",n=a,new i.SafeString(s)});t.addExport("dropdown"),t.setVariable("dropdown",o),r(null,a+="\n")}catch(e){r(i.handleError(e,null,null))}}}},ftdA:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("q1tI"),r=n.n(i),a=n("wHZf");function o(){return r.a.useContext(a.EffectContext)}},fv4G:function(e,t,n){"use strict";n("12sq");var i=n("9oTK"),r=n.n(i),a=n("+lWh");window.webpackManifest=Object(a.o)("webpack-manifest","json");n("FDfc"),n("mGy5"),n("a4TK"),n("lgaY");var o=n("QFwy"),s=n("FOip"),u=n("8eYQ"),l=n("YysQ"),c=n("Ja3s"),h=n("NG5u"),d=n("gBaA"),f=n("YL90"),p=Object(a.o)("trackers-options","json");n.p=Object(a.o)("webpack-public-path"),r.a.config({warnings:!1,longStackTraces:!1,cancellation:!0,monitoring:!1}),Object(o.a)(),Object(s.a)(),Object(l.a)(),p&&p.googleAnalytics&&d.a.initialize(p.googleAnalytics),p&&p.googleTagManager&&f.a.initialize(p.googleTagManager),u.a.install(),c.a.initializeCookies(),Object(h.a)(),window.editorModels=window.editorModels||{}},fw8H:function(e,t,n){"use strict";(function(e){var i=n("RIqP"),r=n.n(i),a=n("RzKY"),o=n("q1tI"),s=n.n(o),u=n("UXvI"),l=n("hbEN"),c=n("M+Bz");t.a=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window,h=s.a.useRef(1/0),d=Object(c.a)(s.a.useCallback(function(){return function(e){return e===window?window.scrollY:e.scrollTop}(o)>h.current?n().then(function(){return Object(a.d)(300)}):e.resolve()},[o].concat(r()(i))));s.a.useEffect(function(){if(o){var e=Object(u.a)(d,200);return o.addEventListener("scroll",e,{passive:!0}),function(){o.removeEventListener("scroll",e)}}},[o,d]);var f=s.a.useMemo(function(){return Object(l.a)(function(){if(t.current){var e=o?function(e){return e===window?document.documentElement.scrollHeight:e.scrollHeight}(o):0,n=e-(t.current.offsetTop+t.current.offsetHeight);h.current=e-(n+2*window.innerHeight)}},100)},[o,t]);s.a.useEffect(function(){return f(),window.addEventListener("resize",f),function(){return window.removeEventListener("resize",f)}})}}).call(this,n("CSL1"))},fx2a:function(e,t,n){"use strict";n.d(t,"a",function(){return v}),n.d(t,"c",function(){return _}),n.d(t,"b",function(){return b});var i=n("gcR/"),r=n.n(i),a=n("12sq"),o=n("/MKj"),s=n("q1tI"),u=n("M4AY"),l=n("IOyo"),c=n("gPpI"),h=n("cdhJ"),d=n("6xf5"),f=n("/f4T"),p=n("P1HB"),g=r()("br",{}),m=function(e){var t=e.viewOnlyLimit,n="".concat(a.a.hosts.faq,"/articles/360031770411-Upload-Limits?utm_source=website&utm_campaign=view-only-warning");return r()(h.a,{className:"c-view-only-limit__understand-limits",direction:"up",message:"unlimited"===t.type?"Learn more about the credit system":s.createElement(s.Fragment,null,"Your monthly limit will reset on"," ",r()("strong",{},void 0,Object(l.b)(t.renews_at,"MMM Do")),".",g,"Click to learn more about the credit system."),href:n})},v=function(e){var t=e.children,n=e.currentPlan,i=e.urlRef,a=e.className,o={ref:i};return r()("a",{className:a,href:Object(p.j)(n,"prem")?Object(c.e)("pages:plans",{},o):Object(c.e)("pages:plans_by_usecase",{usecase:"individuals"},o)},void 0,t)},_=function(e){var t=e.text;return r()("span",{className:"help c-view-only-limit__view-only-tooltip"},void 0,r()("span",{className:"c-view-only-limit__dotted"},void 0,t),r()("span",{className:"tooltip tooltip-up",style:{width:220}},void 0,"A model that is downloadable or in the Store doesn't count against this limit."))},b=function(e){var t=e.viewOnlyLimit;return r()("p",{className:"c-view-only-limit__left"},void 0,"unlimited"===t.type?s.createElement(s.Fragment,null,"You can upload an unlimited number of models."):s.createElement(s.Fragment,null,t.remaining," ",r()(_,{text:"upload credit".concat(1===t.remaining?"":"s")})," ","left")," ",r()(m,{viewOnlyLimit:t}))},S=r()("p",{},void 0,"Models set to downloadable do not count towards your upload limit."),y=r()(f.a,{size:"small",type:"important",text:"upgrade your account"});t.d=function(e){var t=e.isPublished,n=Object(o.e)(function(e){return u.c.authUser.user(e)});if(!n.viewOnlyLimit||"unlimited"===n.viewOnlyLimit.type)return null;var i=n.viewOnlyLimit;return r()(d.a,{center:!0,type:i.remaining?"warning":"error"},void 0,s.createElement(s.Fragment,null,r()("strong",{},void 0,r()(b,{viewOnlyLimit:i})),i.remaining?s.createElement(s.Fragment,null,S,r()("p",{},void 0,r()(v,{currentPlan:n.account,urlRef:"manage_model"},void 0,"Upgrade to increase your limit"))):s.createElement(s.Fragment,null,r()("p",{},void 0,t?"To make this model not publicly downloadable":"To publish this model",", you must wait until"," ",r()("strong",{},void 0,function(e){return Math.abs(Date.now()-new Date(e).getTime())<864e5}(i.renews_at)?"today at ".concat(Object(l.b)(i.renews_at,"h:mm A")):Object(l.b)(i.renews_at,"MMM Do")),", set it to downloadable or upgrade your account."),r()("p",{},void 0,r()(v,{currentPlan:n.account,urlRef:"manage_model"},void 0,y)))))}},"g+9p":function(e,t,n){n("QF8f"),n("p7hb"),n("SF8B"),(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/viewer.jinja"]={root:function(e,t,i,r,a){var o=null,s=null,u="";try{e.getTemplate("skfb_front/macros/model.jinja",!1,"skfb_front/macros/viewer.jinja",!1,function(l,c){l?a(l):c.getExported(function(l,c){if(l)a(l);else if(c.hasOwnProperty("model_name")){var h=c.model_name;t.setVariable("model_name",h),u+="\n",e.getTemplate("skfb_front/macros/user.jinja",!1,"skfb_front/macros/viewer.jinja",!1,function(l,c){l?a(l):c.getExported(function(l,c){if(l)a(l);else if(c.hasOwnProperty("user_avatar")){var h=c.user_avatar;t.setVariable("user_avatar",h),u+="\n",e.getTemplate("skfb_front/macros/logo.jinja",!1,"skfb_front/macros/viewer.jinja",!1,function(l,c){l?a(l):c.getExported(function(l,c){if(l)a(l);else if(c.hasOwnProperty("logo")){var h=c.logo;if(t.setVariable("logo",h),c.hasOwnProperty("sketchfab_spinner")){var d=c.sketchfab_spinner;t.setVariable("sketchfab_spinner",d),u+="\n\n";var f=r.makeMacro(["model"],["options"],function(n,a){var u=i;i=new r.Frame,(a=a||{}).hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("model",n),i.set("options",a.hasOwnProperty("options")?a.options:{});var l="";return l+='\n\n    <div class="titlebar">\n\n        <div class="summary">\n            ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiInfos")&&(l+='\n                <div class="avatar">\n                    ',r.memberLookup(n,"org")?(l+='\n                        <a target="_blank" href="',l+=r.suppressValue(r.memberLookup(n,"viewerUrl"),e.opts.autoescape),l+='">',l+=r.suppressValue((o=12,s=80,r.callWrap(r.contextOrFrameLookup(t,i,"user_avatar"),"user_avatar",t,[r.memberLookup(r.memberLookup(n,"org"),"avatars"),{size:32}])),e.opts.autoescape),l+="</a>\n                    "):(l+='\n                        <a target="_blank" href="',l+=r.suppressValue(r.memberLookup(n,"viewerUrl"),e.opts.autoescape),l+='">',l+=r.suppressValue((o=14,s=80,r.callWrap(r.contextOrFrameLookup(t,i,"user_avatar"),"user_avatar",t,[r.memberLookup(r.memberLookup(n,"user"),"avatars"),{size:32}])),e.opts.autoescape),l+="</a>\n                    "),l+='\n                </div>\n                <div class="model-info">\n                    <h1 class="title">',l+=r.suppressValue((o=18,s=49,r.callWrap(r.contextOrFrameLookup(t,i,"model_name"),"model_name",t,[n,{target:"_blank",withRestrictedFlag:!1}])),e.opts.autoescape),l+='</h1>\n                    <h2>by <a target="_blank" href="',l+=r.suppressValue(r.memberLookup(n,"viewerUrl"),e.opts.autoescape),l+='">',l+=r.suppressValue(r.memberLookup(r.memberLookup(n,"user"),"displayName"),e.opts.autoescape),l+="</a></h2>\n                </div>\n            "),l+='\n        </div>\n\n        <div class="actions">\n\n            ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiInfos")&&r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"inStore")?(l+='\n                <a class="help tooltip tooltip-down in-store" data-tooltip="Available on Store" target="_blank" href="',l+=r.suppressValue(r.memberLookup(n,"viewerUrl"),e.opts.autoescape),l+='">\n                    <i class="icon fa fa-usd"></i>\n                </a>\n            '):r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiInfos")&&r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"allowDownload")&&(l+='\n                <a class="help tooltip tooltip-down download" data-tooltip="Download" target="_blank" href="',l+=r.suppressValue(r.memberLookup(n,"viewerUrl"),e.opts.autoescape),l+='#download">\n                    <i class="icon fa fa-download"></i>\n                </a>\n            '),l+="\n\n            ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiInfos")&&(l+='\n                <a class="help tooltip tooltip-down share" data-tooltip="Share" data-action="open-share-overlay">\n                    <i class="custom-icons icon-ion-android-share-alt-icon"></i>\n                </a>\n            '),l+="\n\n            ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiStop")&&(l+='\n                <a class="help tooltip tooltip-down close hidden" data-tooltip="Stop" data-action="stop">\n                    <i class="custom-icons icon-ion-close-round-icon"></i>\n                </a>\n            '),l+="\n\n        </div>\n\n    </div>\n\n",i=u,new r.SafeString(l)});t.addExport("viewer_infos"),t.setVariable("viewer_infos",f),u+="\n\n";var p=r.makeMacro(["message","model"],["options"],function(n,a,u){var l=i;i=new r.Frame,(u=u||{}).hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("message",n),i.set("model",a),i.set("options",u.hasOwnProperty("options")?u.options:{});var c="";return c+='\n    <div class="viewer">\n        <div class="osd active">\n            <div class="controls">\n                ',c+=r.suppressValue((o=58,s=26,r.callWrap(r.contextOrFrameLookup(t,i,"watermark"),"watermark",t,[a,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),c+='\n            </div>\n            <div class="content">\n                <div class="panel">\n                    <p class="panel__box">',c+=r.suppressValue(n,e.opts.autoescape),c+="</p>\n                </div>\n            </div>\n        </div>\n    </div>\n",i=l,new r.SafeString(c)});t.addExport("viewer_message"),t.setVariable("viewer_message",p),u+="\n\n";var g=r.makeMacro(["model","options"],[],function(n,a,u){var l=i;i=new r.Frame,(u=u||{}).hasOwnProperty("caller")&&i.set("caller",u.caller),i.set("model",n),i.set("options",a);var c="";return c+='\n    <div class="viewer">\n        <div class="osd active">\n            <div class="controls">\n                ',c+=r.suppressValue((o=73,s=26,r.callWrap(r.contextOrFrameLookup(t,i,"watermark"),"watermark",t,[n,a])),e.opts.autoescape),c+='\n            </div>\n            <div class="content">\n                <div class="panel">\n                    <div class="panel__box --centered">\n                        <p>\n                        This Sketchfab 3D model has been disabled.\n                        <br/>\n                        <a class="skfb-link" target="_blank" href="https://help.sketchfab.com/hc/en-us/articles/360016172711-Disabled-Models?utm_source=website&utm_campaign=disabled_embed">\n                            Read more.\n                        </a>\n                        </p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n',i=l,new r.SafeString(c)});t.addExport("disabled_model_message"),t.setVariable("disabled_model_message",g),u+="\n\n";var m=r.makeMacro(["model"],["options"],function(n,a){var u=i;i=new r.Frame,(a=a||{}).hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("model",n),i.set("options",a.hasOwnProperty("options")?a.options:{});var l,c="";return c+="\n    ",l=r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"displayStatus")||r.memberLookup(n,"displayStatus"),i.set("display_status",l,!0),i.topLevel&&t.setVariable("display_status",l),i.topLevel&&t.addExport("display_status",l),c+="\n    ","deleted"==r.contextOrFrameLookup(t,i,"display_status")?(c+="\n        ",c+=r.suppressValue((o=95,s=23,r.callWrap(r.contextOrFrameLookup(t,i,"viewer_message"),"viewer_message",t,["This Sketchfab 3D model has been deleted.",n,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),c+="\n\n    "):"disabled"==r.contextOrFrameLookup(t,i,"display_status")?(c+="\n        ",c+=r.suppressValue((o=98,s=31,r.callWrap(r.contextOrFrameLookup(t,i,"disabled_model_message"),"disabled_model_message",t,[n,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),c+="\n\n    "):"unsupported"==r.contextOrFrameLookup(t,i,"display_status")?(c+="\n        ",c+=r.suppressValue((o=101,s=23,r.callWrap(r.contextOrFrameLookup(t,i,"viewer_message"),"viewer_message",t,["Password-protected 3D models are not supported through the Viewer API.",n,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),c+="\n\n    "):"draft"==r.contextOrFrameLookup(t,i,"display_status")?(c+="\n        ",c+=r.suppressValue((o=104,s=23,r.callWrap(r.contextOrFrameLookup(t,i,"viewer_message"),"viewer_message",t,["This Sketchfab 3D model has not been published yet.",n,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),c+="\n\n    "):"ok"==r.contextOrFrameLookup(t,i,"display_status")&&(c+="\n        ",c+=r.suppressValue((o=107,s=20,r.callWrap(r.contextOrFrameLookup(t,i,"show_viewer"),"show_viewer",t,[n,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),c+="\n\n    "),c+="\n\n",i=u,new r.SafeString(c)});t.addExport("viewer"),t.setVariable("viewer",m),u+="\n\n";var v=r.makeMacro(["model"],["options"],function(n,a){var u=i;i=new r.Frame,(a=a||{}).hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("model",n),i.set("options",a.hasOwnProperty("options")?a.options:{});var l="";return l+='\n\n    <div class="viewer has-model ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"transparent")&&(l+=" transparent"),r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"autostart")&&(l+=" started"),l+='">\n\n        ',l+=r.suppressValue((o=117,s=21,r.callWrap(r.contextOrFrameLookup(t,i,"viewer_infos"),"viewer_infos",t,[n,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),l+='\n\n        <div class="landing" data-action="start">\n\n            ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"autostart")?r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiStop")&&(l+='\n                <div class="preview">\n                    ',l+=r.suppressValue(e.getFilter("image_container").call(t,r.memberLookup(n,"thumbnails"),1024,768,!0,!0,r.makeKeywordArgs({defer_images:!0})),e.opts.autoescape),l+="\n                </div>\n            "):(l+='\n                <div class="preview">\n                    ',l+=r.suppressValue(e.getFilter("image_container").call(t,r.memberLookup(n,"thumbnails"),1024,768,!0,!0),e.opts.autoescape),l+="\n                </div>\n            "),l+='\n\n            <div class="start-button">\n                <button class="play-button">\n                    <i class="fa fa-play"></i>\n                    <span class="label">3D</span>\n                </button>\n            </div>\n\n            ',l+=r.suppressValue((o=138,s=22,r.callWrap(r.contextOrFrameLookup(t,i,"watermark"),"watermark",t,[n,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),l+='\n\n        </div>\n\n        <div class="overlays">\n            ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"restricted")&&(l+='\n                <div class="overlay restricted">\n                    <div>\n                        <h3 class="heading">Restricted Content</h3>\n                        <p>\n                            This 3D model contains restricted content.<br/>\n                            You need to enable restricted content to view this.\n                        </p>\n                        <button type="submit" class="button btn-input btn-primary submit btn-medium" data-action="allowRestricted">Enable restricted content</button>\n                        ',l+=r.suppressValue((o=152,s=29,r.callWrap(r.contextOrFrameLookup(t,i,"logo"),"logo",t,[121,25,{color:"#ffffff"}])),e.opts.autoescape),l+="\n                    </div>\n                </div>\n            "),l+='\n            <div class="overlay help hidden">\n                <a href="#" class="close custom-icons icon-ion-close-round-icon"></a>\n                <div class="inner">\n                    <ul class="tabs">\n                        <li class="active"><a href="#" data-target="basic">Navigation basics</a></li>\n                        <li><a href="#" data-target="all">All controls</a></li>\n                    </ul>\n                    <div class="tabs-container">\n                        <div class="tab active" data-tab="basic">\n                            <div class="tip">\n                                <div>\n                                    <i class="fa fa-refresh"></i>\n                                </div>\n                                <div>\n                                    <b>Orbit around</b>\n                                    <div>\n                                        Left click + drag or<br>\n                                        One finger drag (touch)\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="tip">\n                                <div>\n                                    <i class="fa fa-search-plus"></i>\n                                </div>\n                                <div>\n                                    <b>Zoom</b>\n                                    <div>\n                                        Double click on model<br>\n                                        or scroll anywhere or<br>\n                                        Pinch (touch)\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="tip">\n                                <div>\n                                    <i class="fa fa-arrows"></i>\n                                </div>\n                                <div>\n                                    <b>Pan</b>\n                                    <div>\n                                        Right click + drag or<br />\n                                        Two fingers drag (touch)\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="tab" data-tab="all">\n                            <div>\n                                <div class="section">\n                                    <span class="title">Orbit navigation</span>\n                                    <b>Move camera:</b> 1 finger drag or Left Mouse Button<br>\n                                    <b>Pan:</b> 2-finger drag or Right Mouse Button or <kbd>SHIFT</kbd>+ Left Mouse Button<br>\n                                    <b>Zoom on object:</b> Double-tap or Double-click on object<br>\n                                    <b>Zoom out:</b> Double-tap or Double-click on background<br>\n                                    <b>Zoom:</b> Pinch in/out or Mousewheel or <kbd>CTRL</kbd> + Left Mouse Button<br>\n                                </div>\n                                <div class="section rendering-shortcuts"></div>\n                                <div class="section inspector-shortcuts"></div>\n                                <div class="section general-shortcuts"></div>\n                                <div class="section">\n                                    <span class="title">Lighting</span>\n                                    <b>Rotate lighting:</b> 3-finger drag or <kbd>ALT</kbd> + Left Mouse Button<br>\n                                    <b>Rotate env. only:</b> <kbd>ALT</kbd> + <kbd>SHIFT</kbd> + Left Mouse Button<br>\n                                </div>\n                                <div class="section annotation-shortcuts"></div>\n                                <div class="section animation-shortcuts"></div>\n                                <div class="section sound-shortcuts"></div>\n                                <div class="section">\n                                   <span class="title">First-person navigation</span>\n                                   <b>Move:</b> <kbd></kbd>,<kbd></kbd>,<kbd></kbd>,<kbd></kbd> (or <kbd>W</kbd>,<kbd>A</kbd>,<kbd>S</kbd>,<kbd>D</kbd>)<br>\n                                   <b>Look around:</b> 1-finger drag or Left Mouse Button<br>\n                                   <b>Adjust speed:</b> Mousewheel<br>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="action">\n                        <button class="button" data-action="reset-camera">Reset camera view</button>\n                    </div>\n\n                </div>\n            </div>\n            <div class="overlay share hidden">\n                <a href="#" class="close custom-icons icon-ion-close-round-icon"></a>\n                <div class="inner">\n                    <div class="share-link">\n                        <div class="text-field">\n                            <label>Link</label>\n                            <input type="text" class="text" value="" readonly>\n                            <button data-clipboard-target=".text-field .text">copy</button>\n                        </div>\n                    </div>\n                    <div class="share-social">\n                        <a data-action="share-on-facebook" target="_blank"><i class="fa fa-facebook"></i></a>\n                        <a data-action="share-on-twitter" target="_blank"><i class="fa fa-twitter"></i></a>\n                        <a data-action="share-on-reddit" target="_blank"><i class="fa fa-reddit"></i></a>\n                        <a data-action="share-on-tumblr" target="_blank"><i class="fa fa-tumblr"></i></a>\n                        <a data-action="share-on-linkedin" target="_blank"><i class="fa fa-linkedin"></i></a>\n                        <a data-action="share-on-pinterest" target="_blank"><i class="fa fa-pinterest"></i></a>\n                        <a class="share-mail" target="_blank"><i class="fa fa-envelope"></i></a>\n                    </div>\n                    <div class="share-embed">\n                        <a class="button" href="" target="_blank">\n                            <i class="fa fa-code"></i> Embed\n                        </a>\n                    </div>\n                </div>\n            </div>\n            <div class="overlay hotspots-overlay hidden">\n                <a href="#" class="close custom-icons icon-ion-close-round-icon"></a>\n                <div class="inner">\n                    <h4 class="hotspot-title"></h4>\n                    <div class="hotspot-content js-scrollable markdown-rendered-content"></div>\n                </div>\n            </div>\n            <div class="overlay ar ar-overlay-mobile hidden">\n                <i class="custom-icons icon-ion-close-round-icon close"></i>\n                <div class="inner custom-scrollbar">\n                     <div class="header-helper">\n                        <p class=\'title\'>\n                        Your device is not compatible\n                        </p>\n                    </div>\n                    <div class="content-helper">\n                        <div class="row-helper">\n                            <div class="content-row">\n                                <div class="info">\n                                    <p>\n                                        Your version of\n                                        <span class=\'mobilePlatform\'> </span>\n                                        is too old to display models in AR.\n                                    </p>\n                                    <p>\n                                        <span class=\'mobilePlatform\'> </span>\n                                        <span class=\'minVersion\'> </span>\n                                        or newer is required.\n                                    </p>\n                                    <p>\n                                        <strong>\n                                            Update your device or try on another device.\n                                        </strong>\n                                    </p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="overlay ar ar-overlay-desktop hidden">\n                <i class="custom-icons icon-ion-close-round-icon close"></i>\n                <div class="inner custom-scrollbar">\n                    <div class="header-helper">\n                        <p class="title">\n                            Augmented Reality is only available on mobile or tablet devices\n                        </p>\n                        <p class="subtitle">\n                            Supported devices: iPhone 6S+ & iPad 5+ on iOS 12+ and Android 8.0+ with ARCore 1.9 support\n                        </p>\n                    </div>\n                    <div class="content-helper">\n                        <div class="row-helper">\n                            <div class="content-row">\n                                <canvas id="qrCode" ></canvas>\n                            </div>\n                        </div>\n                        <div class="row-helper ">\n                            <div class="content-row">\n                                <div class="text">\n                                    <p class="title">Open with QR Code </p>\n                                    <p>Scan this code to open the model on your device, then, tap on the AR icon</p>\n                                    <p class="title">Or, open this link with your mobile:</p>\n                                    <a class="url overlay-link" target="_blank" href="#"></a>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="overlay ar ar-overlay-loading hidden">\n                <i class="custom-icons icon-ion-close-round-icon close"></i>\n                <div class="inner">\n                    <div class=\'sketchfab-spinner\'>\n                        ',l+=r.suppressValue((o=340,s=41,r.callWrap(r.contextOrFrameLookup(t,i,"sketchfab_spinner"),"sketchfab_spinner",t,[])),e.opts.autoescape),l+="\n                    </div>\n                    <div class='text'>\n                        LOADING...\n                    </div>\n                    <div class='subText'>\n                     If the loading takes too long, you can learn more\n                     <a class=\"overlay-link\" href=\"",l+=r.suppressValue(r.contextOrFrameLookup(t,i,"SKFB_FAQ_HOST"),e.opts.autoescape),l+='/articles/360040824252-Augmented-Reality-AR-" target=\'_blank\'> here </a>\n                    </div>\n                </div>\n            </div>\n            <div class="overlay ar ar-overlay-error hidden">\n                <i class="custom-icons icon-ion-close-round-icon close"></i>\n                <div class="inner">\n                    <div class="content-helper">\n                        <div class="row-helper">\n                            <div class="content-row">\n                                <div class="info">\n                                    <p>\n                                        AR is not available for this model yet.\n                                    </p>\n                                    <p>\n                                        Please try again later or contact us if the problem persists.\n                                    </p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="overlay helper-vr-overlay hidden">\n                <i class="custom-icons icon-ion-close-round-icon close"></i>\n                <div class="inner custom-scrollbar">\n                     <div class="header-helper">\n                        To view this model in virtual reality:\n                    </div>\n                    <div class="content-helper">\n                        <div class="row-helper">\n                            <div class="content-row">\n                                <div class="image"><i class="fa fa-mobile"></i></div>\n                                <div class="text">\n                                    <div class="title">on mobile phone</div>\n                                    <div>with Cardboard or similar</div>\n                                </div>\n                            </div>\n                            <ul class="info">\n                                <li>On your mobile, open this link: <a class="url overlay-link" target="_blank" href="#"></a></li>\n                                <li>Press the VR icon</li>\n                                <li>Insert your mobile in a Cardboard headset</li>\n                            </ul>\n                        </div>\n                        <div class="row-helper">\n                            <div class="content-row">\n                                <div class="image"><i class="fa fa-desktop"></i></div>\n                                <div class="text">\n                                    <div class="title">on desktop PC </div>\n                                    <div>with a VR headset</div>\n                                </div>\n                            </div>\n                            <ul class="info">\n                                <li><a href="https://immersiveweb.dev/" target="_blank" rel="noopener noreferrer nofollow" class=\'overlay-link\'>Learn more on the immersive web</a></li>\n                                <li>On Chrome, follow the instructions <a href="https://immersiveweb.dev/chrome-support.html" target="_blank" rel="noopener noreferrer nofollow" class=\'overlay-link\'>here</a></li>                                \n                                <li>Open this model</li>\n                                <li>Click on the VR icon</li>\n                            </ul>\n                        </div>\n                    </div>\n                    <div class="footer-helper">\n                        <a href="',l+=r.suppressValue(r.contextOrFrameLookup(t,i,"SKFB_FAQ_HOST"),e.opts.autoescape),l+='/articles/204777439-Desktop-WebVR-Vive-Oculus-?utm_source=website&amp;utm_campaign=vr_hints" target="_blank">\n                        More info on Virtual reality.\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="webgl">\n\n            <canvas class="canvas" data-modelUid="',l+=r.suppressValue(r.memberLookup(n,"uid"),e.opts.autoescape),l+='" data-action="create-hotspot">\n            </canvas>\n\n            <div class="loading-container">\n                <div class="secondary-progress">\n                    <div class="secondary-progress-percentage"></div>\n                    <div class="secondary-progress-display"></div>\n                </div>\n                <div class="main-progress">\n                    <img alt="Loading 3D Model" src="',l+=r.suppressValue(e.getFilter("best_fit").call(t,r.memberLookup(n,"thumbnails"),64,36),e.opts.autoescape),l+='" class="loading-thumbnail" />\n                    <div class="main-progress-wrapper">\n                        <div class="main-progress-percentage loading-percentage">0%</div>\n                        <p>Loading 3D model</p>\n                        <div class="main-progress-display">\n                            <div class="main-progress-display__progress"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="hotspots"></div>\n\n            <div class="gui">\n\n                <div class="animation-not-supported hidden">\n                    <a href="#" class="close"></a>\n                    <p>Model is too heavy for your device and can not be rendered properly</p>\n                </div>\n\n                ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiControls")&&r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiAnnotations")&&(l+='\n                    <div class="hotspot-controls-responsive">\n                        <div data-title="Previous Annotation" data-action="prev-annotation">\n                            <div class="icon fa fa-caret-left"></div>\n                        </div>\n                        <div data-title="Next Annotation" data-action="next-annotation">\n                            <div class="icon fa fa-caret-right"></div>\n                        </div>\n                    </div>\n                '),l+="\n\n                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiInspector")&&(l+='\n                    <div class="model-inspector">\n                        <div class="model-inspector__menu">\n                            <div class="model-inspector__minimize"><i class="fa fa-caret-down" aria-hidden="true"></i>Model Inspector</div>\n                            <div class="model-inspector__content">\n                                <div class="model-inspector__modes custom-scrollbar js-scrollable">\n                                    ',l+='\n                                </div>\n                            </div>\n                        </div>\n                        <div class="model-inspector__2D-options">\n                            <div class="model-inspector__UV-options"></div>\n                            <div class="model-inspector__material-options"></div>\n                        </div>\n                        <div class="model-inspector__empty-2d-view">\n                        </div>\n                    </div>\n                '),l+='\n\n\n                <div class="controls">\n                    ',l+=r.suppressValue((o=479,s=30,r.callWrap(r.contextOrFrameLookup(t,i,"watermark"),"watermark",t,[n,r.contextOrFrameLookup(t,i,"options")])),e.opts.autoescape),l+="\n\n                    ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiControls")&&(l+="\n\n                        ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiAnimations")&&(l+='\n                            <div class="animation-controls widget ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiFadeout")||(l+="no-fadeout"),l+='">\n                                <div class="timeline">\n                                    <div class="timeline-wrapper">\n                                        <div class="track">\n                                            <div class="bar">\n                                            </div>\n                                            <div class="knob">\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <a href="#" class="control play fa"></a>\n                                <a href="#" class="control next fa"></a>\n                                <div class="animation-timer control progress help" data-unit="time">00:00.00</div>\n                                <div class="animation-list control has-menu">\n                                    <p class="animation-name"></p>\n                                    <div class="control-menu list">\n                                        <div class="animation__options">\n                                            <div class="toggle-button">\n                                                <span class="toggle-button__option tooltip" data-tooltip="Repeat one">\n                                                    <input type="radio" name="animation-cycle" data-value="one" id="animation-cycle-one">\n                                                    <label for="animation-cycle-one"><i class="custom-icons icon-cycle-repeat-one"></i></label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Repeat all">\n                                                    <input type="radio" name="animation-cycle" data-value="all" id="animation-cycle-all">\n                                                    <label for="animation-cycle-all"><i class="custom-icons icon-cycle-repeat-all"></i></label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="No repeat">\n                                                    <input type="radio" name="animation-cycle" data-value="none" id="animation-cycle-none">\n                                                    <label for="animation-cycle-none"><i class="custom-icons icon-cycle-no-repeat"></i></label>\n                                                </span>\n                                            </div>\n                                            <div class="toggle-button">\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x0.1">\n                                                    <input type="radio" name="animation-speed" data-value="0.1" id="animation-speed-point-one">\n                                                    <label for="animation-speed-point-one">x0.1</label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x0.5">\n                                                    <input type="radio" name="animation-speed" data-value="0.5" id="animation-speed-point-five">\n                                                    <label for="animation-speed-point-five">x0.5</label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x1">\n                                                    <input type="radio" name="animation-speed" data-value="1" id="animation-speed-one">\n                                                    <label for="animation-speed-one">x1</label>\n                                                </span>\n                                                <span class="toggle-button__option tooltip" data-tooltip="Speed x2">\n                                                    <input type="radio" name="animation-speed" data-value="2" id="animation-speed-two">\n                                                    <label for="animation-speed-two">x2</label>\n                                                </span>\n                                            </div>\n                                        </div>\n                                        <ul class="js-scrollable"></ul>\n                                    </div>\n                                </div>\n                            </div>\n                        '),l+="\n\n                        ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiAnnotations")&&(l+='\n                            <div class="hotspot-controls widget has-menu ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiFadeout")||(l+="no-fadeout"),l+='">\n\n                                <div data-title="Previous Annotation" data-action="prev-annotation">\n                                    <div class="icon fa fa-caret-left"></div>\n                                </div>\n\n                                <div class="hotspot-name default" data-action="toggle-annotation-list">\n                                    Select an annotation\n                                </div>\n\n                                <div data-title="Next Annotation" data-action="next-annotation">\n                                    <div class="icon fa fa-caret-right"></div>\n                                </div>\n\n                                <div class="list hotspots-list"></div>\n\n                            </div>\n                        '),l+='\n\n                            <div class="general-controls widget ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiFadeout")||(l+="no-fadeout"),l+='">\n                            ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiGeneralControls")&&(l+="\n\n                                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiHelp")&&(l+='\n                                    <a class="control tooltip help" data-tooltip="Help">\n                                        <i class="fa fa-question"></i>\n                                    </a>\n                                '),l+="\n                                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiSound")&&(l+='\n                                    <a class="control volume" title="Volume (M)" draggable="false">\n                                        <i class="fa fa-volume-up"></i>\n                                        <div class="volume-menu">\n                                        </div>\n                                    </a>\n                                '),l+="\n                                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiSettings")&&(l+='\n                                    <a class="control tooltip settings has-menu" data-tooltip="Settings">\n                                        <i class="fa fa-gear"></i>\n                                        <div class="control-menu settings-menu">\n                                            <div class="control-menu-wrapper">\n                                                <div class="control-menu-list"></div>\n                                                <div class="control-menu-pane"></div>\n                                            </div>\n                                        </div>\n                                        <span class="control-badge"></span>\n                                    </a>\n                                '),l+="\n                                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiInspector")&&(l+='\n                                    <a class="control tooltip inspector" data-tooltip="Model Inspector (i)" data-action="inspector">\n                                        <i class="custom-icons icon-inspector"></i>\n                                    </a>\n                                '),l+="\n                                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiAr")&&(l+='\n                                    <a class="control tooltip ar" data-tooltip="View in AR">\n                                        <i class="custom-icons  icon-ar"></i>\n                                    </a>\n                                '),l+="\n                                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiVr")&&(l+='\n                                    <a class="control tooltip vr ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiTheatre")||r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiFullscreen")||(l+="tooltip-right-bound"),l+='" data-tooltip="View in VR">\n                                        <i class="custom-icons icon-vr-icon"></i>\n                                    </a>\n                                '),l+="\n                                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiTheatre")&&(l+='\n                                    <a class="control tooltip theatre" data-tooltip="Theatre Mode">\n                                        <i class="custom-icons icon-theatre-icon"></i>\n                                    </a>\n                                '),l+="\n                                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiFullscreen")&&(l+='\n                                    <a class="control tooltip tooltip-right-bound fullscreen" data-tooltip="Fullscreen (f)">\n                                        <i class="custom-icons icon-fullscreen-icon"></i>\n                                    </a>\n                                '),l+="\n                            "),l+="\n                            </div>\n                    "),l+="\n                </div>\n\n                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiSnapshots")&&(l+='\n                    <div class="snapshot-guides">\n                    </div>\n                    <div class="snapshot widget">\n                        <a class="button help">\n                            <span class="normal"><i class="icon fa fa-camera"></i> Save view</span>\n                            <span class="progress"><i class="icon fa fa-camera"></i> Saving&hellip;</span>\n                            <span class="success"><i class="icon fa fa-check"></i>Saved</span>\n                            <div class="tooltip tooltip-right">Save thumbnail and initial camera view</div>\n                        </a>\n                        <div class="img-container invisible"></div>\n                    </div>\n                    <div class="snapshot-flash">\n                    </div>\n                '),l+='\n\n                <div class="viewer-hint widget disabled">\n                    <div class="viewer-movehint">\n                        <i class="icon"></i>\n                        <span class="label"></span>\n                    </div>\n                </div>\n\n            </div>\n\n        </div>\n\n        <div class="osd widget">\n            <div class="osd-content">\n            </div>\n        </div>\n\n        <div class="fallback" style="display: none">\n\n            <div class="fallback-viewport">\n                <img src="" alt="" class="fallback-sprite">\n            </div>\n\n            <div class="fallback-warning">\n                <div class="inner">\n                    For compatibility reasons, 3D is not available (<a href="',l+=r.suppressValue(r.contextOrFrameLookup(t,i,"SKFB_FAQ_HOST"),e.opts.autoescape),l+='/articles/203059088-Compatibility?utm_source=website&amp;utm_campaign=error_fallback" target="_blank">see requirements</a>).<br>\n                    You are seeing a 360&deg; image instead.\n                </div>\n            </div>\n\n            <div class="fallback-error fallback-error-loading">\n                <div class="inner">\n                    <p>Connection error. Please try again.</p>\n                </div>\n            </div>\n\n            <div class="fallback-error fallback-error-nofallback">\n                <div class="inner">\n                    <p>Sorry, the model can\'t be displayed.</p>\n                    <p>Please check out <a href="',l+=r.suppressValue(r.contextOrFrameLookup(t,i,"SKFB_FAQ_HOST"),e.opts.autoescape),l+='/articles/203059088-Compatibility?utm_source=website&amp;utm_campaign=error_fallback" target="_blank">our FAQ</a> to learn how to fix this issue.</p>\n                </div>\n            </div>\n\n            <div class="progress-bar">\n                <div class="progress-bar-percentage"></div>\n                <div class="progress-bar-display"></div>\n            </div>\n\n            <div class="progress-circle">\n                <div class="progress-circle-percentage loading-percentage"></div>\n                <svg class="progress-circle-display" version="1.1">\n                    <path class="progress-circle-path" fill="none" stroke="#1caad9" stroke-width="6" />\n                </svg>\n            </div>\n\n            ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiControls")&&(l+='\n                <div class="controls">\n                    <div class="control control-fullscreen fullscreen tooltip tooltip-left" data-tooltip="Fullscreen (f)" data-action="fullscreen">\n                        <div class="icon custom-icons icon-fullscreen-icon"></div>\n                    </div>\n                </div>\n            '),l+='\n\n        </div>\n\n        <div class="embed-sandboxed-message">\n            <p>It looks like your browser or this site is blocking some scripts or cookies necessary to properly display the viewer.</p>\n            <p>View this model on Sketchfab :<br /><a href="',l+=r.suppressValue(r.memberLookup(n,"embedUrl"),e.opts.autoescape),l+='?utm_source=website&utm_campaign=blocked_scripts_error">',l+=r.suppressValue(r.memberLookup(n,"embedUrl"),e.opts.autoescape),l+='?utm_source=website&utm_campaign=blocked_scripts_error</a></p>\n            <p>Or visit the Help Center for more information:<br /><a href="',l+=r.suppressValue(r.contextOrFrameLookup(t,i,"SKFB_FAQ_HOST"),e.opts.autoescape),l+='/articles/203059088-Compatibility?utm_source=website&utm_campaign=blocked_scripts_error#troubleshooting-scripts">https://help.sketchfab.com/hc/en-us/articles/203059088-Compatibility?utm_source=website&utm_campaign=blocked_scripts_error#troubleshooting-scripts</a></p>\n        </div>\n    </div>\n\n',i=u,new r.SafeString(l)});t.addExport("show_viewer"),t.setVariable("show_viewer",v),u+="\n\n";var _=r.makeMacro(["mode"],[],function(e,t){var n=i;i=new r.Frame,(t=t||{}).hasOwnProperty("caller")&&i.set("caller",t.caller),i.set("mode",e);var a="";return a+="\n\n    ","orbit"==e&&(a+='\n\n        <div class="viewer-mode-help">\n            <h2>Orbit mode</h2>\n            <ul class="help-shortcuts">\n                <li class="mouse-left">Rotate</li>\n                <li class="mouse-wheel">Zoom <small class="hint">also works with CTRL+left click</small></li>\n                <li class="mouse-right">Pan <small class="hint">also works with SHIFT+left click</small></li>\n            </ul>\n        </div>\n\n    '),a+="\n\n    ","fps"==e&&(a+='\n\n        <div class="viewer-mode-help">\n            <h2>First person mode</h2>\n            <ul class="help-shortcuts">\n                <li class="mouse-left">Look around</li>\n                <li class="mouse-wheel">Walking speed</li>\n                <li class="kbd-wasd">Walk <small class="hint">also works with arrows or Z,Q,S,D</small></li>\n            </ul>\n        </div\n\n    '),a+="\n\n",i=n,new r.SafeString(a)});t.addExport("help_viewer_mode"),t.setVariable("help_viewer_mode",_),u+="\n\n";var b=r.makeMacro(["hotspots"],[],function(n,a){var o=i;i=new r.Frame,(a=a||{}).hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("hotspots",n);var s="";s+='\n<a href="#" data-action="toggle-visibility" class="annotations-visibility --hide"></a>\n<a href="#" data-action="toggle-autopilot" class="annotations-autopilot --stopped"></a>\n<ul class="js-scrollable">\n    ',i=i.push();var u=n;if(u)for(var l=u.length,c=0;c<u.length;c++){var h=u[c];i.set("hotspot",h),i.set("loop.index",c+1),i.set("loop.index0",c),i.set("loop.revindex",l-c),i.set("loop.revindex0",l-c-1),i.set("loop.first",0===c),i.set("loop.last",c===l-1),i.set("loop.length",l),s+='\n        <li class="link"><a data-hotspot-target="',s+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"loop"),"index0"),e.opts.autoescape),s+='" title="',s+=r.suppressValue(r.memberLookup(h,"name"),e.opts.autoescape),s+='"><span class="index">',s+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"loop"),"index"),e.opts.autoescape),s+="</span> ",s+=r.suppressValue(r.memberLookup(h,"name"),e.opts.autoescape),s+="</a></li>\n    "}return i=i.pop(),s+="\n</ul>\n",i=o,new r.SafeString(s)});t.addExport("hotspots_list"),t.setVariable("hotspots_list",b),u+="\n\n";var S=r.makeMacro(["hasFullscreen"],[],function(t,a){var o=i;i=new r.Frame,(a=a||{}).hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("hasFullscreen",t);var s="";return s+='\n\n    <div class="vr-mode-help">\n        ',s+='\n        <img src="',s+=r.suppressValue(n("iz85"),e.opts.autoescape),s+='" width="96" height="116" alt="Place your landscape oriented phone in front of lenses">\n\n        <p>\n            ',s+=t?'\n                <button class="button btn-textified" data-action="fullscreen">Switch to fullscreen</button><br>\n                then place your phone into your Cardboard viewer\n            ':"\n                Place your phone into your Cardboard viewer\n            ",s+="\n        </p>\n    </div>\n\n",i=o,new r.SafeString(s)});t.addExport("help_vr_mode"),t.setVariable("help_vr_mode",S),u+="\n\n";var y=r.makeMacro(["model"],["options"],function(n,a){var o=i;i=new r.Frame,(a=a||{}).hasOwnProperty("caller")&&i.set("caller",a.caller),i.set("model",n),i.set("options",a.hasOwnProperty("options")?a.options:{});var s="";return s+="\n    ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiWatermark")&&(s+='\n        <div class="watermark',s+=r.suppressValue(r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiWatermarkLink")?"":" tooltip tooltip-left-bound",e.opts.autoescape),s+='"\n            ',r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiWatermarkLink")||(s+='\n                data-tooltip="Powered by Sketchfab.com"\n            '),s+="\n        >\n            <a\n                ",r.memberLookup(r.contextOrFrameLookup(t,i,"options"),"uiWatermarkLink")&&(s+='\n                    title="View on Sketchfab"\n                    data-action="watermark" href="',s+=r.suppressValue(r.memberLookup(n,"viewerUrl"),e.opts.autoescape),s+='" target="_blank"\n                '),s+="\n            ></a>\n        </div>\n    "),s+="\n",i=o,new r.SafeString(s)});t.addExport("watermark"),t.setVariable("watermark",y),a(null,u+="\n")}else a(new Error("cannot import 'sketchfab_spinner'"))}else a(new Error("cannot import 'logo'"))})})}else a(new Error("cannot import 'user_avatar'"))})})}else a(new Error("cannot import 'model_name'"))})})}catch(e){a(r.handleError(e,o,s))}}}},g8iT:function(e,t){e.exports="#extension GL_OES_standard_derivatives : enable\n\nuniform float uMatcapCurvature;\nuniform mat4 uProjectionMatrix;\n\n// http://madebyevan.com/shaders/curvature/\nfloat getCurvature(const in vec3 normal) {\n#ifndef GL_OES_standard_derivatives\n    return 1.0;\n#else\n  if (uMatcapCurvature == 0.0) return 1.0;\n\n  // Compute curvature\n  vec3 dx = dFdx(normal);\n  vec3 dy = dFdy(normal);\n  vec3 xneg = normal - dx;\n  vec3 xpos = normal + dx;\n  vec3 yneg = normal - dy;\n  vec3 ypos = normal + dy;\n\n  float factor =  uMatcapCurvature / (length(vViewVertex.xyz) * atan(-1.0 / uProjectionMatrix[2][3]));\n  float curvature = (cross(xneg, xpos).y - cross(yneg, ypos).x) * factor;\n\n  float curvDirt = clamp(-curvature * 1.5, 0.0, 1.0);\n  float curvEdge = clamp(curvature * 2.5, 0.0, 1.0);\n\n  float factorDirt = mix(1.0, 0.3, curvDirt);\n  float factorEdge = 2.0;\n\n  return mix(factorDirt, factorEdge, curvEdge);\n#endif\n}\n"},gB9P:function(e,t,n){e.exports=n("tvqq")},gBF6:function(e,t){e.exports='#pragma include "base.vert"\n'},gBaA:function(e,t,n){"use strict";(function(e){var i,r,a=n("lSNA"),o=n.n(a),s=n("RzKY"),u=n("dZz+"),l=n("9mpE"),c=n("bLLl"),h=n("Y14P"),d=n("89mf"),f=n("Kult"),p=n("+lWh"),g=n("22T1"),m=n("YysQ"),v=[];!function(e){e.PLAN="dimension1",e.OPTIMIZELY_EXPERIMENTS="dimension2",e.DATE_JOINED="dimension3",e.BILLING_CYCLE="dimension4",e.USER_SEGMENT_NAME="dimension5",e.USER_SEGMENT_KIND="dimension6",e.SERVICE_WORKER_STATUS="dimension7"}(i||(i={})),function(e){e.MODEL_COUNT="metric1",e.LIKE_COUNT="metric2",e.FOLLOWING_COUNT="metric3"}(r||(r={}));var _,b=!1,S=function(){return _||(_=Object(p.o)("trackers-options","json")),_},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=u.a.me().toJSON(),i={};b||(b=!0,function(e,t,n,i,r,a,o){e.GoogleAnalyticsObject=r,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,a=t.createElement(n),o=t.getElementsByTagName(n)[0],a.async=1,a.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(a,o)}(window,document,"script",0,"ga")),v.indexOf(t)>-1||!e||(n&&!n.isAnonymous&&(i.userId=n.uid),t&&(i.name=t),v.push(t),window.ga("create",e,i))},x=function(t){return void 0===window.ga?(console.info("Tracking event skipped : "+JSON.stringify(t)),e.resolve()):Object(s.i)(1e3,function(t){return new e(function(e){for(var n=0,i=0;i<v.length;i++){var r=v[i];window.ga.apply(window,[(r?r+".":"")+"send"].concat(t,{hitCallback:function(){return++n===v.length&&e()}}))}})}(t)).catch(d.d)},C={initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.uid,n=void 0===t?"":t,a=e.trackPageview,s=void 0===a||a,l=u.a.me().toJSON();if(l&&l.isStaff&&(window["ga-disable-"+n]=!0),Object(g.default)()){var h=document.location.pathname.match(/models\/(.*?)\/embed/);if(h&&h[1]){var d=h[1],p=c.b.get("/i/models/"+d);if(p&&"ent"===p.user.account&&!p.hasEnterpriseTracking)return void console.warn("GA tracking disabled.")}}y(S().googleAnalytics.uid);var v=Object(f.a)();if(!1!==v&&window.ga("set","referrer",v),l&&!l.isAnonymous){var _,b,x;l.segment?(b=l.segment.name,x=l.segment.kind):(b="None",x="None");var C=(_={},o()(_,i.PLAN,l.account),o()(_,i.DATE_JOINED,l.createdAt),o()(_,i.BILLING_CYCLE,l.billingCycle),o()(_,i.USER_SEGMENT_NAME,b),o()(_,i.USER_SEGMENT_KIND,x),o()(_,i.SERVICE_WORKER_STATUS,Object(m.b)()),o()(_,r.MODEL_COUNT,l.modelCount),o()(_,r.LIKE_COUNT,l.likeCount),o()(_,r.FOLLOWING_COUNT,l.followingCount),_);window.ga("set",C)}s&&window.ga("send","pageview")},initializeEnterprise:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];y(S().googleAnalyticsEnterprise.uid,S().googleAnalyticsEnterprise.trackerName),e&&window.ga(S().googleAnalyticsEnterprise.trackerName+".send","pageview")},removeEnterprise:function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";v.splice(v.indexOf(e),1),window.ga(e?e+".remove":"remove")}(S().googleAnalyticsEnterprise.trackerName)},wrapLink:function(e,t){var n=e.currentTarget,i=n.target,r=n.href;"_blank"===i||e.metaKey||e.ctrlKey||(e.preventDefault(),Object(s.i)(800,t).catch(d.d).then(function(){window.location.href=r}))},saveCurrentReferrer:function(){var e=document.referrer,t=document.location.href,n=l.c.string("utm_source"),i=h.a.get("utm_source"),r=new Date;return r.setSeconds(240),-1===t.indexOf(e)&&n&&(e=n),-1===t.indexOf(e)&&i&&(e=i),h.a.set("skfb_referrer_override",e,{expires:r}),e},setSegment:function(e){var t;void 0!==window.ga&&window.ga("set",(t={},o()(t,i.USER_SEGMENT_NAME,e?e.get("name"):"None"),o()(t,i.USER_SEGMENT_KIND,e?e.get("kind"):"None"),t))},pageView:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.pathname+window.location.search;return x(["pageview",e])},userRegistered:function(e){return x(["event","user","registered",e])},userUnregistrationSurveyNotCompleted:function(e){return x(["event","user","unregistrationSurveyNotCompleted",e])},userUnregistrationSurveyCompleted:function(e,t){return x(["event","user","unregistrationSurveyCompleted",e,t])},userUpgraded:function(e){return x(["event","user","upgraded",e])},userAllowedGdpr:function(e){return x(["event","user","allowedGdpr",e])},userUpgradeCanceled:function(e){return x(["event","user","upgradeCanceled",e])},userSettingsAvatarUpdated:function(e){return x(["event","userSettings","avatarUpdated",e])},userSettingsNotificationsUpdated:function(e){return x(["event","userSettings","notificationsUpdated",e])},userSettingsPasswordUpdated:function(e){return x(["event","userSettings","passwordUpdated",e])},userSettingsProfileUpdated:function(e){return x(["event","userSettings","profileUpdated",e])},userSettingsAppConnected:function(e){return x(["event","userSettings","appConnected",e])},userSettingsAppDisconnected:function(e){return x(["event","userSettings","appDisconnected",e])},userSummaryFollowButtonClicked:function(e,t){return x(["event","userSummary","followButtonClicked",e,t?1:0])},userProfileFollowButtonClicked:function(e,t){return x(["event","userProfile","followButtonClicked",e,t?1:0])},userProfileContactButtonClicked:function(e){return x(["event","userProfile","contactButtonClicked",e])},userProfileWebsiteLinkClicked:function(e){return x(["event","userProfile","websiteLinkClicked",e])},userProfileSocialLinkClicked:function(e,t){return x(["event","userProfile","socialLinkClicked",t])},followSuggestionsSuggestFollowButtonClicked:function(e,t){return x(["event","followSuggestionsPopupSuggest","followButtonClicked",e,t?1:0])},followSuggestionsSearchFollowButtonClicked:function(e,t){return x(["event","followSuggestionsPopupSearch","followButtonClicked",e,t?1:0])},followSuggestionsSuggestFollowAllButtonClicked:function(e){return x(["event","followSuggestionsPopupSuggest","followAllButtonClicked",e])},followSuggestionsSearchFollowAllButtonClicked:function(e){return x(["event","followSuggestionsPopupSearch","followAllButtonClicked",e])},modelPageFollowButtonClicked:function(e,t){return x(["event","modelPage","followButtonClicked",e,t?1:0])},modelPageSettingsButtonClicked:function(e){return x(["event","modelPage","settingsButtonClicked",e])},modelPage3dSettingsButtonClicked:function(e){return x(["event","modelPage","3dSettingsButtonClicked",e])},modelPageAnnotationsButtonClicked:function(e){return x(["event","modelPage","AnnotationsButtonClicked",e])},modelPageAddToCollectionButtonClicked:function(e){return x(["event","modelPage","addToCollectionButtonClicked",e])},modelPageCreateCollectionButtonClicked:function(e){return x(["event","modelPage","createCollectionButtonClicked",e])},modelPageReuploadButtonClicked:function(e){return x(["event","modelPage","reuploadButtonClicked",e])},modelPageDeleteButtonClicked:function(e){return x(["event","modelPage","deleteButtonClicked",e])},modelPageEmbedButtonClicked:function(e){return x(["event","modelPage","embedButtonClicked",e])},modelPageShareButtonClicked:function(e){return x(["event","modelPage","shareButtonClicked",e])},modelPageFavoriteButtonClicked:function(e,t){return x(["event","modelPage","favoriteButtonClicked",e,t?1:0])},modelPageDownloadButtonClicked:function(e){return x(["event","modelPage","downloadButtonClicked",e])},modelPageNewCommentPosted:function(e,t){return x(["event","modelPage","newCommentPosted",e,t?1:0])},modelPageCommentDeleted:function(e,t){return x(["event","modelPage","commentDeleted",e,t?1:0])},modelPageExporterLinkClicked:function(e){return x(["event","modelPage","exporterLinkClicked",e])},modelPageModelInformationClicked:function(){return x(["event","modelPage","modelInformationClicked"])},modelRipperBlocked:function(e,t){return x(["event","modelRipper",e+"Blocked",t])},modelCardSettingsButtonClicked:function(e){return x(["event","modelCard","settingsButtonClicked",e])},modelCardReuploadButtonClicked:function(e){return x(["event","modelCard","reuploadButtonClicked",e])},modelCardDeleteButtonClicked:function(e){return x(["event","modelCard","deleteButtonClicked",e])},modelCard3dSettingsButtonClicked:function(e){return x(["event","modelCard","3dSettingsButtonClicked",e])},modelCardAnnotationsButtonClicked:function(e){return x(["event","modelCard","AnnotationsButtonClicked",e])},modelCardAddToCollectionButtonClicked:function(e){return x(["event","modelCard","addToCollectionButtonClicked",e])},modelCardPreviewButtonClicked:function(e){return x(["event","modelCard","previewButtonClicked",e])},modelCardFavoriteButtonClicked:function(e,t){return x(["event","modelCard","favoriteButtonClicked",e,t?1:0])},modelListCardFavoriteButtonClicked:function(e,t){return x(["event","modelListCard","favoriteButtonClicked",e,t?1:0])},modelListCardCommentsButtonClicked:function(e,t){return x(["event","modelListCard","commentsButtonClicked",e,t])},modelPreviewClosePopupButtonClicked:function(e){return x(["event","modelPreview","closePopupButtonClicked",e])},modelPreviewViewModelButtonClicked:function(e){return x(["event","modelPreview","viewModelButtonClicked",e])},modelPreviewShareButtonClicked:function(e){return x(["event","modelPreview","shareButtonClicked",e,status?1:0])},modelPreviewFavoriteButtonClicked:function(e,t){return x(["event","modelPreview","favoriteButtonClicked",e,t?1:0])},modelPreviewCommentsButtonClicked:function(e,t){return x(["event","modelPreview","commentsButtonClicked",e,t])},modelPreviewDownloadButtonClicked:function(e){return x(["event","modelPreview","downloadButtonClicked",e])},modelPreviewCollectionButtonClicked:function(e){return x(["event","modelPreview","collectionButtonClicked",e])},modelSettingsDownloadButtonClicked:function(e,t){return x(["event","modelSettings","downloadButtonClicked",e,t])},modelDownloadFavoriteButtonClicked:function(e,t){return x(["event","modelDownload","favoriteButtonClicked",e,t?1:0])},modelSettingsLicenseChanged:function(e){return x(["event","modelSettings","licenseChanged",e])},modelSettingsSaveButtonClicked:function(e){return x(["event","modelSettings","saveButtonClicked",e])},modelSettingsCancelButtonClicked:function(e){return x(["event","modelSettings","cancelButtonClick",e])},modelEmbedDownloadButtonClicked:function(e){return x(["event","modelEmbed","downloadButtonClicked",e])},modelEmbedFavoriteButtonClicked:function(e,t){return x(["event","modelEmbed","favoriteButtonClicked",e,t?1:0])},modelEmbedShareButtonClicked:function(e){return x(["event","modelEmbed","shareButtonClicked",e])},modelEmbedInfosButtonClicked:function(e,t){return x(["event","modelEmbed","infosButtonClicked",e,t?1:2])},modelEmbedAutostart:function(e){return x(["event","modelEmbed","autostart",e])},modelEmbedPlayButtonClicked:function(e){return x(["event","modelEmbed","playButtonClicked",e])},modelEmbedStopButtonClicked:function(e){return x(["event","modelEmbed","stopButtonClicked",e])},modelEmbedModelInteraction:function(e,t){return x(["event","modelEmbed","modelInteraction"+t,e])},modelEmbedViewModelButtonClicked:function(e){return x(["event","modelEmbed","viewModelButtonClicked",e])},modelEmbedWatermarkClicked:function(e){return x(["event","modelEmbed","watermarkClicked",e])},modelViewerRenderingOptionsButtonClicked:function(){return x(["event","modelViewer","renderingOptionsButtonClicked"])},modelViewerViewerModeButtonClicked:function(){return x(["event","modelViewer","viewerModeButtonClicked"])},modelViewerFullscreenButtonClicked:function(e){return x(["event","modelViewer","fullscreenButtonClicked",e?1:0])},modelViewerTheatreModeButtonClicked:function(e){return x(["event","modelViewer","theatreButtonClicked",e?1:0])},modelViewerVrButtonClicked:function(e){return x(["event","modelViewer","vrButtonClicked",e])},modelViewerInspectorShortcut:function(){return x(["event","modelViewer","inspectorShortcut"])},modelViewerInspectorButtonClicked:function(){return x(["event","modelViewer","inspectorButtonShortcut"])},modelViewerViewerModeSelected:function(e){return x(["event","modelViewer","viewerModeSelected",e])},modelViewerShadingSelected:function(e){return x(["event","modelViewer","shadingSelected",e])},modelViewerAnnotationsToggled:function(e,t){return x(["event","modelViewer","annotationsToggled",e,t?1:0])},modelViewerAnnotationListClicked:function(e){return x(["event","modelViewer","annotationListClicked",e])},modelViewerAnnotationsCycleToggled:function(e,t){return x(["event","modelViewer","annotationsCycleToggled",e,t?1:0])},modelViewerWireframeToggleClicked:function(e){return x(["event","modelViewer","wireframeEnable",e])},modelViewerWireframeColorSelected:function(e){return x(["event","modelViewer","wireframeColorSelected",e])},modelViewerWireframeShortcut:function(e){return x(["timing","modelViewer","wireframeEnable",e])},modelViewerTextureQualitySelected:function(e){return x(["event","modelViewer","textureQualitySelected",e])},modelViewerPolygonLoaded:function(e){return x(["timing","modelViewer","polygonLoaded",e])},modelViewerWireframeLoaded:function(e){return x(["timing","modelViewer","wireframeLoaded",e])},modelViewerHighResTexturesLoaded:function(e,t){return x(["timing","modelViewer","highResTexturesLoaded",e,{metric2:t}])},modelViewerLowResTexturesLoaded:function(e,t){return x(["timing","modelViewer","lowResTexturesLoaded",e,{metric2:t}])},modelViewerModelDisplayed:function(e){return x(["timing","modelViewer","modelDisplayed",e])},modelViewerNextAnnotationClicked:function(e){return x(["event","modelViewer","nextAnnotationClicked",e])},modelViewerPreviousAnnotationClicked:function(e){return x(["event","modelViewer","previousAnnotationClicked",e])},modelViewerAnnotationClicked:function(e){return x(["event","modelViewer","annotationClicked",e])},modelViewerAnimationPlayClicked:function(e){return x(["event","modelViewer","animationPlayClicked",e])},modelViewerAnimationPauseClicked:function(e){return x(["event","modelViewer","animationPauseClicked",e])},modelViewerAnimationSpeedSelected:function(e){return x(["event","modelViewer","animationSpeedSelected",e])},modelViewerAnimationRepeatModeSelected:function(e){return x(["event","modelViewer","animationRepeatModeSelected",e])},modelViewerAnimationListClicked:function(e){return x(["event","modelViewer","animationListClicked",e])},modelViewerAnimationNoAnimationClicked:function(e){return x(["event","modelViewer","animationNoAnimationClicked",e])},modelViewerAnimationSeeked:function(e,t){return x(["event","modelViewer","animationSeeked",e,t])},modelViewerFallbackDisplayed:function(e){return x(["event","modelViewer","fallbackDisplayed",e])},modelViewerHelpButtonCliked:function(e){return x(["event","modelViewer","helpButtonClicked",e])},modelViewerResetCameraButtonClicked:function(){return x(["event","modelViewer","resetCameraButtonClicked"])},modelViewerHelpTabClicked:function(e){return x(["event","modelViewer","helpTabClicked",e])},modelViewerMuteButtonClicked:function(e){return x(["event","modelViewer","muteButtonClicked",e])},headerSearchInitiated:function(e){return x(["event","header","searchInitiated",e])},headerUploadButtonClicked:function(){return x(["event","header","uploadButtonClicked",window.location.pathname+window.location.search])},headerUploadSignupButtonClicked:function(){return x(["event","header","uploadSignupButtonClicked"])},headerStoreSellerSignupButtonClicked:function(){return x(["event","header","storeSellerSignupButtonClicked"])},embedPopupEmbedFormatSelected:function(e){return x(["event","embedPopup","embedFormatSelected",e])},embedPopupShowOptionsButtonClicked:function(){return x(["event","embedPopup","showOptionsButtonClicked"])},embedPopupOptionToggleChanged:function(e,t){return x(["event","embedPopup","optionToggleChanged",e,t?1:0])},collectionEmbedPopupShowOptionsButtonClicked:function(){return x(["event","collectionEmbedPopup","showOptionsButtonClicked"])},collectionEmbedPopupOptionToggleChanged:function(e,t){return x(["event","collectionEmbedPopup","optionToggleChanged",e,t?1:0])},modelBrowseTagFilterAdded:function(e){return x(["event","modelBrowse","tagFilterAdded",e])},modelBrowseDateFilterChanged:function(e){return x(["event","modelBrowse","dateFilterChanged",e])},modelBrowseSortFilterChanged:function(e){return x(["event","modelBrowse","sortFilterChanged",e])},modelBrowseFaceCountFilterChanged:function(e){return x(["event","modelBrowse","faceCountFilterChanged",e])},modelBrowseFeaturesFilterChanged:function(e){return x(["event","modelBrowse","featuresFilterChanged",e])},modelBrowseCategoryFilterChanged:function(e){return x(["event","modelBrowse","categoryFilterChanged",e])},modelBrowseFlagFilterChanged:function(e){return x(["event","modelBrowse","flagFilterChanged",e])},modelUploadStarted:function(){return x(["event","modelUpload","started"])},modelUploadCanceled:function(){return x(["event","modelUpload","canceled"])},modelUploadProcessed:function(e){return x(["event","modelUpload","processed",e?1:0])},collectionCardDeleteButtonClicked:function(e){return x(["event","collectionCard","deleteButtonClicked",e])},collectionCardPreviewButtonClicked:function(e){return x(["event","collectionCard","previewButtonClicked",e])},collectionSettingsSaveButtonClicked:function(e){return x(["event","collectionSettings","saveButtonClicked",e])},collectionSettingsCancelButtonClicked:function(e){return x(["event","collectionSettings","cancelButtonClicked",e])},collectionPageDeleteButtonClicked:function(e){return x(["event","collectionPage","deleteButtonClicked",e])},collectionPageEmbedButtonClicked:function(e){return x(["event","collectionPage","embedCollectionButtonClicked",e])},collectionPageShareButtonClicked:function(e){return x(["event","collectionPage","shareCollectionButtonClicked",e])},collectionPreviewViewCollectionButtonClicked:function(e){return x(["event","collectionPreview","viewCollectionButtonClicked",e])},collectionPreviewShareButtonClicked:function(e){return x(["event","collectionPreview","shareButtonClicked",e])},collectionPreviewClosePopupButtonClicked:function(e){return x(["event","collectionPreview","closePopupButtonClicked",e])},landingVideoTourButtonClicked:function(){return x(["event","landing","videoTourButtonClicked"])},studentsPageCheckEligibilitySucceeded:function(e){return x(["event","studentsPage","eligibilityCheckSucceeded",e])},studentsPageCheckEligibilityFailed:function(e){return x(["event","studentsPage","eligibilityCheckFailed",e])},studentsPageContactUsButtonClicked:function(){return x(["event","studentsPage","contactUsButtonClicked"])},annotationEditorCreateButtonClicked:function(e){return x(["event","annotationEditor","createButtonClicked",e])},annotationEditorDeleteButtonClicked:function(e){return x(["event","annotationEditor","deleteButtonClicked",e])},annotationEditorPositionMoved:function(e){return x(["event","annotationEditor","positionMoved",e])},annotationEditorListReordered:function(e){return x(["event","annotationEditor","listReordered",e])},annotationEditorCameraButtonClicked:function(e){return x(["event","annotationEditor","cameraButtonClicked",e])},annotationEditorTooltipEdited:function(e){return x(["event","annotationEditor","tooltipEdited",e])},annotationEditorWidgetDoneButtonClicked:function(e){return x(["event","annotationEditor","widgetDoneButtonClicked",e])},annotationEditorLimitReachedUpgradeButtonClicked:function(e){return x(["event","annotationEditor","annotationEditorLimitReachedUpgradeButtonClicked",e.get("uid")])},soundEditorSoundAdded:function(){return x(["event","soundEditor","soundAdded"])},soundEditorSoundRemoved:function(){return x(["event","soundEditor","soundRemoved"])},soundEditorPreviewSoundButtonClicked:function(){return x(["event","soundEditor","previewSoundButtonClicked"])},soundEditorChangeSoundButtonClicked:function(){return x(["event","soundEditor","changeSoundButtonClicked"])},soundEditor3DSoundButtonClicked:function(){return x(["event","soundEditor","3DSoundButtonClicked"])},soundEditorLoopButtonClicked:function(){return x(["event","soundEditor","LoopButtonClicked"])},postProcessEditorEffectToggled:function(e,t){return x(["event","postProcessEditor","effectToggled",e,t?1:0])},categoryPageFollowSuggestionsButtonClicked:function(e,t){return x(["event","categoryPage","followSuggestionsFollowButtonClicked",e,t?1:0])},tagPageFollowSuggestionsButtonClicked:function(e,t){return x(["event","tagPage","followSuggestionsFollowButtonClicked",e,t?1:0])},shareButtonClicked:function(e,t,n){return x(["event",e,t,n])},invitePageSendEmailClicked:function(e){return e=parseInt(e),x(["event","invitePage","sendEmailClicked","",e])},invitePageTwitterButtonClicked:function(){return x(["event","invitePage","twitterButtonClicked"])},invitePageFacebookButtonClicked:function(){return x(["event","invitePage","facebookButtonClicked"])},modelIssueReported:function(e,t){return x(["event","modelIssueReported",e,t])},newsfeedFollowCardFollowButtonClicked:function(e,t){return x(["event","newsfeedFollowCard","followButtonClicked",e,t?1:0])},newsfeedPageFollowSuggestionsButtonClicked:function(e,t){return x(["event","newsfeedPage","followSuggestionsFollowButtonClicked",e,t?1:0])},newsfeedCardFollowButtonClicked:function(e,t){return x(["event","newsfeedCard","followButtonClicked",e,t?1:0])},newsfeedCardModelPreviewButtonClicked:function(e){return x(["event","newsfeedCard","modelPreviewButtonClicked",e])},newsfeedCardFavoriteButtonClicked:function(e,t){return x(["event","newsfeedCard","favoriteButtonClicked",e,t?1:0])},onboardingUsageType:function(e){return x(["event","onboarding","usageType",e])},onboardingPlansStepGoBack:function(){return x(["event","onboarding","plansGoBackClicked"])},newsfeedUsersFollowed:function(e){return x(["event","newsfeed","usersFollowed",e])},newsfeedInterestsSelected:function(e){return x(["event","newsfeed","interestsSelected",e])},playlistNextButtonClicked:function(){return x(["event","playlist","nextButtonClicked"])},playlistPreviousButtonClicked:function(){return x(["event","playlist","previousButtonClicked"])},playlistItemClicked:function(){return x(["event","playlist","tocItemClicked"])},profileWizardGeolocationClicked:function(){return x(["event","profileWizard","geolocationClicked"])},uploadCardCollectionCreated:function(e){return x(["event","uploadCard","collectionCreated",e])},uploadCardCollectionEnabled:function(e){return x(["event","uploadCard","collectionEnabled",e])},uploadCardCollectionDisabled:function(e){return x(["event","uploadCard","collectionDisabled",e])},uploadCardSettingsButtonClicked:function(e){return x(["event","uploadCard","settingsButtonClicked",e])},uploadCardReuploadButtonClicked:function(e){return x(["event","uploadCard","reuploadButtonClicked",e])},uploadCardDeleteButtonClicked:function(e){return x(["event","uploadCard","deleteButtonClicked",e])},uploadCard3dSettingsButtonClicked:function(e){return x(["event","uploadCard","3dSettingsButtonClicked",e])},uploadCardAnnotationsButtonClicked:function(e){return x(["event","uploadCard","AnnotationsButtonClicked",e])},inspectorDisplayViewClicked:function(e,t){return x(["event","inspector","displayViewClicked",e+":"+t])},inspectorModeShortcut:function(e,t){return x(["event","inspector","displayViewShortcut",e+":"+t])},inspectorSplitTypeClicked:function(e){return x(["event","inspector","splitTypeClicked",e])},inspectorUIVisibilityToggleClicked:function(){return x(["event","inspector","UIVisibilityToggleClicked"])},storeCheckoutInitiated:function(e,t){return x(["event","store","InitiateCheckout",e,t])},storeModelAddedToCart:function(e,t){return x(["event","store","AddToCart",e,t])},storePurchaseCompleted:function(e,t){return x(["event","store","Purchase",e,t])},orgHeaderUploadButtonClicked:function(){return x(["event","orgHeader","headerUploadButtonClicked"])},orgHeaderInviteButtonClicked:function(){return x(["event","orgHeader","inviteButtonClicked"])},orgModelListUploadButtonClicked:function(){return x(["event","orgModelList","uploadButtonClicked"])},orgModelListPropertiesButtonClick:function(e){return x(["event","orgModelList","propertiesButtonClicked",e])},orgModelListDownloadButtonClick:function(e){return x(["event","orgModelList","downloadButtonClicked",e])},orgModelListDuplicateButtonClick:function(e){return x(["event","orgModelList","duplicateButtonClicked",e])},orgModelListDeleteButtonClick:function(e){return x(["event","orgModelList","deleteButtonClicked",e])},orgModelPageEmbedButtonClicked:function(e){return x(["event","orgModelPage","embedButtonClicked",e])},orgModelDownloadButtonClicked:function(e){return x(["event","orgModelPage","downloadButtonClicked",e])},orgModelShareButtonClicked:function(e){return x(["event","orgModelPage","shareButtonClicked",e])},orgModelCommentPosted:function(e){return x(["event","orgModelPage","newCommentPosted",e])},orgModelCommentDeleted:function(e){return x(["event","orgModelPage","commentDeleted",e])},orgModelInspectButtonClicked:function(e){return x(["event","orgModelPage","inspectButtonClicked",e])},orgModel3dSettingsButtonClicked:function(e){return x(["event","orgModelPage","3dSettingsButtonClicked",e])},orgModelPropertiesButtonClicked:function(e){return x(["event","orgModelPage","propertiesButtonClicked",e])}};t.a=C}).call(this,n("CSL1"))},gCTM:function(e,t,n){"use strict";n.r(t);var i,r,a=n("MVZn"),o=n.n(a),s=n("EVdn"),u=n.n(s),l=n("r+JM"),c=n.n(l),h=n("m8R6"),d=n("Uu/N"),f=n("Dpjh"),p=n("NFsq"),g=n("0Uag"),m=n("U8Ad"),v=n("9MMX"),_=n("DWw0"),b=n("skoe"),S=n("9mpE"),y=n("x2jA"),x=n("IOyo"),C=n("Ui7z"),w=n("P1HB"),T=n("+lWh"),M=n("gPpI"),E=n("6uKY"),A=c.a.Loader.extend({getSource:function(e){return{src:{type:"code",obj:window.nunjucksPrecompiled[e]},path:e}}}),O=new c.a.Environment([new A],{autoescape:!0});O.addGlobal("url",function(e,t){return Object(M.e)(e,Object(h.a)(t,["__keywords"]))}),O.addFilter("log",function(e){return console.log("[Nunjucks] : ",e),e}),O.addFilter("urlize",function(e,t,n,i){var r=Array.prototype.slice.call(arguments,0);if(r.length&&r[r.length-1].__keywords){var a=r.pop(),o=r[1],s=r[2],u=r[3];t=o||a.trim_url_limit,n=s||a.nofollow,i=u||a.target}return"string"==typeof e&&(e=E.escapeHTML(e)),c.a.runtime.markSafe(E.urlize(e,{trimUrlLimit:t,noFollow:n,target:i}))}),O.addFilter("best_fit",b.a),O.addFilter("iterable",function(e){return Array.isArray(e)?e:[e]}),O.addFilter("slugify",E.slugify),O.addFilter("call_macro_by_name",function(e){var t=this.ctx[e],n=Array.prototype.slice.call(arguments,1);if(!t)throw new Error('Missing macro "'+e+'"');return t.apply(this,n)}),O.addFilter("user_profile_filled",function(e){return"avatar-blue"!==e.avatars.name&&"avatar-orange"!==e.avatars.name&&"avatar-grey"!==e.avatars.name&&(e.biography||e.tagline||e.city||e.country)&&(e.website||e.twitterUsername||e.linkedinUsername||e.facebookUsername||e.unityConnectUrl)}),O.addFilter("has_plan_type",w.g),O.addFilter("badge_label",w.k),O.addFilter("is_private",function(e){return Object(_.u)(e.visibility)}),O.addFilter("print_suggestion_verb",function(e,t){var n="";return 0===e&&(n=t.displayName+" is a <b>popular</b> user"),10===e&&(n="You <b>liked</b> their models :"),20===e&&(n="You share a common <b>skill</b> :"),30===e&&(n="You share a common <b>interest</b> :"),40===e&&(n="Your profiles are similar."),c.a.runtime.markSafe(n)}),O.addFilter("print_suggestion_target",function(e,t){if(0===t)return"";if(10===t){var n=[];return e.forEach(function(e){var t=u()('<a href="'.concat(Object(M.e)("models:view_without_slug",{model_id:e.uid}),'">').concat(e.name,"</a>"));n.push(u()("<div>").append(t).html())}),c.a.runtime.markSafe(n.join(", "))}return 20===t?e.name:30===t?e.name:40===t?"":void 0}),O.addFilter("skill_slug_to_name",function(e){return i||(i=new v.a).fetch({immediate:!0}),i.findWhere({slug:e}).get("name")}),O.addFilter("category_uid_to_name",function(e){r||(r=new m.a).fetch({immediate:!0});var t=r.findWhere({uid:e}),n=t.get("name");return t.get("parent")&&(n=r.findWhere({uid:t.get("parent")}).get("name ")+"/"+n),n}),O.addFilter("underscorify",E.underscorify),O.addFilter("image_container",function(e,t,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",s=Object(b.a)(e,t,n),u=a&&!Object(T.i)(s)?"--loading":"",l=a?'data-background="'.concat(s,'"'):"",h=a?"":'style="background-image: url('.concat(s,');"');return c.a.runtime.markSafe('\n        <div\n            class="image-container --cover '.concat(o," ").concat(u,'"\n            style="width: ').concat(i?"100%":t+"px",';"\n        >\n            <div class="image-container__image" ').concat(l," ").concat(h,'></div>\n            <div style="padding-top: ').concat(n/t*100,'%"></div>\n        </div>\n    '))}),O.addFilter("query_string",function(e,t){var n=document.createElement("a");return n.href=e,Object.keys(t).length&&(n.search="?"+S.c.craft(S.c.reset(n.search,t))),n.href}),O.addFilter("first_n",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.slice(0,t)}),O.addFilter("fill_null",function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=e.slice();n.length<t;)n.push(null);return n}),O.addFilter("prettify_text",function(e,t){var n=O.getFilter("striptags")(e);return O.getFilter("urlize")(n,t)}),O.addFilter("paragraphy",function(){return c.a.runtime.markSafe(E.paragraphy.apply(E,arguments))}),O.addFilter("striptags",function(){return c.a.runtime.markSafe(E.stripTags.apply(E,arguments))}),O.addFilter("humanize_number",y.k),O.addFilter("humanize_file_size",y.j),O.addFilter("format_order_uid",E.formatOrderUid),O.addFilter("format_price",y.g),O.addFilter("format_rating",y.h),O.addFilter("comma_formatted_number",y.e),O.addFilter("pluralize",E.pluralize),O.addFilter("markdown",function(e){return e}),O.addFilter("pretty_slug",function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("-").map(d.a).join(" ")}),O.addFilter("merge",function(e,t){return o()({},e,t)}),O.addFilter("json_data",function(e){return JSON.stringify(e).replace(/<\//g,"<\\/")}),O.addFilter("format_date",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MMM. Do YYYY",n="full"===t?"YYYY/MM/DD HH:mm":t;return x.a.utc(e).format(n)}),O.addFilter("max",function(e){return Math.max.apply(Math,e)}),O.addFilter("min",function(e){return Math.min.apply(Math,e)}),O.addFilter("time_ago",x.c),O.addFilter("seconds_to_duration",function(e){return x.a.utc(1e3*parseFloat(e)).format("mm:ss")}),O.addFilter("can_upgrade_to_pro",function(e){return Object(w.a)(e)}),O.addFilter("humanize_date",function(e){return x.a.utc(e).format("MMM[.] Do[,] YYYY")});var R=O.getFilter("trim");O.addFilter("trim",function(e){return null===e?"":R(e)}),O.addFilter("map",function(e,t){return e.map(function(e){return e[t]})});var P=function(e,t){return new Error("\n\n"+e+(t?" with `"+t+"` className":"")+" is not a Component. \nThe `component` filter only accepts component elements.\nYou can get a component element by calling `Component#createChildrenComponents(childrenConfigs)`, or `Component#createChildComponent(childName, childConfig)`.\n/!\\ Note that this is different from Component instances.\n")};function I(e,t,n){if(!e)return n?"<div data-component ".concat(t?'class="'.concat(t,'"'):"",">").concat(n,"</div>"):"";if("function"!=typeof e)throw P(e,t);var i=e();if(!i.isComponentElement)throw P(e,t);var r="";try{r=i.template()}catch(e){throw new Error("\n\nError while getting the template of Component `"+i.displayName+"`:\n\n"+e.stack+"\n\n")}return'<div data-component id="'.concat(i.cid,'" ').concat(t?'class="'.concat(t,'"'):"",">").concat(r,"</div>")}function N(e){return Object.keys(e).filter(function(t){return e[t]}).join(" ")}function L(e){return Object.keys(Object(C.c)(e)).map(function(t){return E.camelToKebabCase(t)+": "+e[t]+";"}).join(" ")}function k(e,t){return Object(f.a)(e)+'="'+Object(f.a)(t)+'"'}O.addFilter("component",function(e,t,n){return c.a.runtime.markSafe(Array.isArray(e)?function(e,t,n){return e.map(function(e){return I(e,t,n)}).join("")}(e,t,n):I(e,t,n))}),O.addFilter("class_names",N),O.addFilter("style",L),O.addFilter("attributes",function(e){return c.a.runtime.markSafe(Object.keys(Object(C.c)(e)).map(function(t){return Object(p.a)(["disabled","checked","selected","readonly","multiple"],t)?e[t]?k(t,!0):"":k(t.match(/^classNames?$/)?"class":E.camelToKebabCase(t),"style"===t?L(e[t]):"classNames"===t?N(e[t]):e[t])}).join(" "))}),t.default={get:Object(g.a)(function(e,t){return O.render(e+".jinja",t)}),getFromString:Object(g.a)(function(e,t){return O.renderString(e,t)}),getFromMacro:function(e,t,n){Array.isArray(e)&&(n=t,t=e[1],e=e[0]);var i=function(n){return O.renderString(["{%- from source import "+t+" -%}","{{ "+t+"("+n.map(function(e,t){return"parameters[ "+t+" ]"}).join(",")+") }}"].join("\n"),{source:e+".jinja",parameters:n})};return n?i(n):i}}},gHdx:function(e,t,n){"use strict";var i=n("a3nb"),r=n("czSk"),a=n("XKim"),o=n("GhR1"),s=n("f/27"),u=function(e){void 0!==e&&this.setName(e),o.a.call(this),this._invBindInSkeletonSpace=r.c.create(),this._boneInSkeletonSpace=r.c.create(),this._boneBoundingBox=new a.a};i.a.createPrototypeNode(u,i.a.objectInherit(o.a.prototype,{getOrCreateDebugColor:function(){return this._boneColor?this._boneColor:(this.isSkinning()?this._boneColor=r.f.fromValues(Math.random(),Math.random(),Math.random()):this._boneColor=r.f.fromValues(.8,.8,.8),this._boneColor)},isSkinning:function(){return void 0!==this.userDataMap.rigIndex},getBoneBoundingBox:function(){return this._boneBoundingBox},setBoneBoundingBox:function(e){this._boneBoundingBox=e},getMatrixInSkeletonSpace:function(){return this._boneInSkeletonSpace},getInvBindMatrixInSkeletonSpace:function(){return this._invBindInSkeletonSpace},setMatrixInSkeletonSpace:function(e){r.c.copy(this._boneInSkeletonSpace,e)},setInvBindMatrixInSkeletonSpace:function(e){r.c.copy(this._invBindInSkeletonSpace,e)},getBoneParent:function(){for(var e=this.getParents(),t=0,n=e.length;t<n;t++){if(e[t].getTypeID()===u.getTypeID())return e[t]}},setDefaultUpdateCallback:function(e){this.addUpdateCallback(new s.a(void 0!==e?e:this.getName()))}}),"osgAnimation","Bone"),t.a=u},gLrx:function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\nvarying vec4 vViewPos;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec2 uHotspotTextureSize;\nuniform float uHotspotCol;\n\nuniform float uHotspotIndex;\nuniform float uHotspotSize;\nuniform float uHotspotPadding;\n\n\nvoid main(void) {\n  // icon size uHotspotSize (48) pixel width\n  // uHotspotPadding (2) pixel padding between them (mipmapping)\n  vec2 ICON_SIZE = uHotspotSize / vec2(uHotspotTextureSize.x, -uHotspotTextureSize.y);\n  vec2 ICON_AND_PADDING = ICON_SIZE + uHotspotPadding / vec2(uHotspotTextureSize.x, -uHotspotTextureSize.y);\n\n  vec2 offset = vec2(mod(uHotspotIndex, uHotspotCol), floor(uHotspotIndex / uHotspotCol));\n  vTexCoord0 = vec2(TexCoord0.x, 1.0 - TexCoord0.y) * ICON_SIZE + offset * ICON_AND_PADDING;\n\n  vViewPos = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  gl_Position = uProjectionMatrix * vViewPos;\n} \n"},gPpI:function(e,t,n){"use strict";n.d(t,"d",function(){return w}),n.d(t,"a",function(){return T}),n.d(t,"c",function(){return O}),n.d(t,"e",function(){return R}),n.d(t,"b",function(){return P});var i=n("lSNA"),r=n.n(i),a=n("MVZn"),o=n.n(a),s=n("J4zp"),u=n.n(s),l=n("VkAN"),c=n.n(l),h=n("12sq"),d=n("KhKb"),f=n("9mpE");function p(){var e=c()(["^(?:/)?","(?:",")?(?:",")?$"]);return p=function(){return e},e}function g(){var e=c()(["(",")"]);return g=function(){return e},e}function m(){var e=c()(["",""]);return m=function(){return e},e}function v(){var e=c()(["<",">"]);return v=function(){return e},e}function _(){var e=c()(["(","):(",")"]);return _=function(){return e},e}var b=/[-_a-z0-9]+/,S=/\?[^\s]+/,y=/#[^\s]+/,x=Object(d.a)("i")(_(),b,b),C=Object(d.a)("gi")(v(),x),w={int:/[0-9]+/,str:/[^/]+/,uid:/[a-f0-9]{32}|[a-zA-Z0-9]{24,27}/,username:/[a-zA-Z0-9._-]{2,}/,slug:/[-a-zA-Z0-9_]+/,path:/.+/},T=function(e){return function(e){return!!e.match(/^https?:\/\//)}(e)?e:function(e){return"/"===e[0]}(e)?e:"/".concat(e)},M=function(e){return e%2},E=function(e){var t=e.split(/<|>/).map(function(e,t){if(!M(t))return Object(d.a)(m(),e);var n=e.match(x),i=u()(n,2)[1];return Object(d.a)(g(),w[i])});return Object(d.a)(p(),t,S,y)},A=function(e){return e.split(/<|>/).filter(function(e,t){return M(t)}).map(function(e){var t=e.match(x);return u()(t,3)[2]})},O=function(e,t){var n=t.match(E(e));if(!n)return null;var i=A(e);return n.slice(1).reduce(function(e,t,n){return o()({},e,r()({},i[n],t))},{})},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(void 0===h.a.routes[e])return console.error('Routing.url error: Named route "'.concat(e,"\" doesn't exist.")),"";var r=A(h.a.routes[e]).sort().join(", "),a=Object.keys(t).sort().join(", ");return a!==r?(console.error('\n            Routing.url error: Wrong params for route "'.concat(e,'".\n            Expected "').concat(r,'", but received "').concat(a,'".\n        ')),""):"".concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return T(e.replace(C,function(e){var n=e.match(x),i=u()(n,3)[2];return t[i]||""}))}(h.a.routes[e],t)).concat(n?Object(f.b)("?",n):"").concat(i?"#".concat(i):"")},P=function(e,t){return void 0===h.a.routes[e]?(console.error('Routing.match error: Named route "'.concat(e,"\" doesn't exist.")),null):O(h.a.routes[e],t)}},gRsq:function(e,t,n){"use strict";var i="undefined"!=typeof global;t.a=function(){return i}},gSZ1:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return l});var i=n("gcR/"),r=n.n(i),a=n("q1tI"),o=n("wsGC"),s=n("/f4T"),u=n("fw8H");function l(t){var n=t.className,i=t.cards,l=t.onLoadPrevious,c=t.onLoadNext,h=t.scrollableElement,d=void 0===h?window:h,f=t.gridSize,p=void 0===f?"normal":f,g=t.loading,m=void 0===g?"none":g,v=t.isLoading,_=void 0!==v&&v,b=t.hasPreviousPage,S=void 0!==b&&b,y=t.hasNextPage,x=void 0!==y&&y,C=t.maxAutoLoadedPages,w=void 0===C?3:C,T=t.emptyState,M=void 0===T?null:T,E=t.itemProp,A=t.itemScope,O=t.itemType,R=a.useRef(null),P=a.useRef(i.length?1:0),I=a.useCallback(function(){return x&&P.current<w&&c?(P.current++,c()):e.resolve()},[c,x,w]);Object(u.a)(R,I,[I],d),function(e,t){var n=a.useRef(e);a.useEffect(function(){var i=n.current;n.current=e,t(i,e)},[e])}(i,function(e,t){e.length>t.length&&(P.current=0)});var N="refresh"===m,L=!_&&x,k=!_&&S,D=!i.length;return a.createElement("div",{ref:R,className:Object(o.a)("grid","grid-cards","c-grid",n,"--".concat(p)),itemProp:E,itemScope:A,itemType:O},k&&r()("div",{className:"c-grid__button --previous"},void 0,r()(s.a,{text:"load previous",onClick:l,size:"large",loading:"previous"===m})),D?r()("div",{className:"c-grid__empty-state"},void 0,M):r()("div",{className:"c-grid__items items ".concat(N?"--refresh":"")},void 0,i),L&&r()("div",{className:"c-grid__button --next"},void 0,r()(s.a,{text:"load more",size:"large",onClick:function(){P.current=0,I()},loading:"next"===m})))}}).call(this,n("CSL1"))},gUpJ:function(e,t,n){"use strict";var i=n("9oTK"),r=n.n(i),a=n("QLQS"),o=n("zmn3"),s=n("0iCP"),u=n("mbgM"),l=n("UpON"),c=n("par7"),h=n("fgaA"),d=a.a.osg,f=function(){d.Texture.call(this),this._isVideo=!1,this._requireOriginalCompression=!1,this._imageModel=void 0,this._convertNPOT=!0,this._truePackingRead=void 0},p=d.ImageStream.prototype.play;d.ImageStream.prototype.play=function(){this._status!==d.ImageStream.PLAYING&&(c.a.draw(),p.call(this))};var g=-1===navigator.userAgent.indexOf("Firefox/46");d.createPrototypeStateAttribute(f,d.objectInherit(d.Texture.prototype,{isVideo:function(){return this._isVideo},getOriginalFormat:function(){return this._truePackingRead||this.getInternalFormat()},_resizeToNearestPowerOf2:function(e){var t=document.createElement("canvas"),n=t.width=u.a.floorPowerOf2(e.getWidth()),i=t.height=u.a.floorPowerOf2(e.getHeight()),r=t.getContext("2d");r.drawImage(e.getImage(),0,0,n,i);var a=this._internalFormat;if(a===d.Texture.RGB||a===d.Texture.RGBA)return t;for(var o=r.getImageData(0,0,n,i).data,s=a===d.Texture.ALPHA?3:0,l=n*i,c=new Uint8Array(l),h=0;h<l;++h)c[h]=o[4*h+s];return this.setTextureSize(n,i),c},setImage:function(e,t){var n=e instanceof d.Image;if(!n||e.isDirty()||e!==this.getImage()&&e!==this._lastSetImage){this._lastSetImage=e;var i=e instanceof d.ImageStream;this._convertNPOT&&n&&!i&&(u.a.isPowerOf2(e.getWidth())&&u.a.isPowerOf2(e.getHeight())||(e.setDirty&&e.setDirty(!1),e=this._resizeToNearestPowerOf2(e))),!g&&this.hasMipmapFilter()&&this.setMinFilter(this.getMagFilter()),d.Texture.prototype.setImage.call(this,e,t),c.a.draw()}},applyTexImage2D:function(){d.Texture.prototype.applyTexImage2D.apply(this,arguments),c.a.draw()},getResourceManager:function(){return this._resourceManager||n("joy8").default.instance},setImageModel:function(e){this._imageModel=e,this._isVideo=e.isVideo(),this.updateRequireOriginalCompression();var t=this.getImageJSONMaxSupported();t.options&&"A"===t.options.format?(this._truePackingRead=d.Texture.ALPHA,this.setInternalFormat(d.Texture.LUMINANCE)):this._truePackingRead=void 0},getImageModel:function(){return this._imageModel},getImageCount:function(){var e=this._imageModel;return e&&e.getImages?e.getImages().length:this._image?1:0},setImageSmallest:function(){var e=this.getImageSmallest();if(e)return!0===e.promise.isFulfilled()&&e.image?this.setImage(e.image):this._setEntryImage(e,e.promise),e},setImageMaxSupported:function(){var e=this.getImageMaxSupported();if(e){var t=Object(h.a)().preload?r.a.resolve():l.a.getFirstCameraAnimation(),n=r.a.all(Object(o.a)([t,e.promise,l.a.getLowResBound()],function(e){return e.reflect()}));return this._setEntryImage(e,n),e}},_setEntryImage:function(e,t){this._lastEntry=e,e.promise=t.then(function(){return this._lastEntry!==e?this._lastEntry.promise:(this.setImage(e.image),e.image)}.bind(this))},getImageSmallest:function(){if(this._imageModel){var e=this._requireOriginalCompression?void 0:this.getOriginalFormat(),t=this._imageModel.findImageNearestToResolution(128,128,e);return this.getResourceImage(t)}},updateRequireOriginalCompression:function(){var e=Object(s.a)(),t=this._imageModel.findImageNearestPowerOfTwoUpToResolution(e,e,this.getOriginalFormat()),n=this._imageModel.findImageNearestPowerOfTwoUpToResolution(e,e),i=Math.min(e,u.a.floorPowerOf2(n.width)),r=Math.min(e,u.a.floorPowerOf2(n.height));return this._requireOriginalCompression=t.width<i||t.height<r,this._requireOriginalCompression},getImageJSONMaxSupported:function(e){e=Object(s.a)(e);var t=this._requireOriginalCompression?void 0:this.getOriginalFormat();return this._imageModel.findImageNearestPowerOfTwoUpToResolution(e,e,t)},getImageMaxSupported:function(){if(this._imageModel)return this.getResourceImage(this.getImageJSONMaxSupported())},getImageWidget:function(){if(this._imageModel){var e=this._imageModel.findImageWidget();return e.options?e.options.widget=!0:e.options={widget:!0},this.getResourceImage(e,!0)}},getResourceImage:function(e,t){!t&&e.url&&e.width*e.height>1048576&&(e.options=e.options||{},e.options.decodeAsync=!0);var n=this.getResourceManager().getOrCreateImage(e.url,e.options);return n.promise.progressSize=e.size,n},_shouldBindNull:function(){return!!this._textureNull||(this._image?!this._image.isReady():0===this._textureHeight||0===this._textureWidth)},_requestUploadBudget:function(e){var t=this._textureWidth*this._textureHeight,n=this._forceUpload||c.a.requestTextureBudget(t);return n||c.a.draw(),n||e||this._gl.texImage2D(this._textureTarget,0,this._getInternalFormatGL(),1,1,0,this._internalFormat,this._getTypeGL(),null),n},setForceUpload:function(e){this._forceUpload=e},apply:function(e){var t=e.getGraphicContext();if(this._dirtyTextureObject&&(this.releaseGLObjects(),this._dirtyTextureObject=!1,this.setGraphicContext(t)),this._textureObject&&!this.isDirty())return this._textureObject.bind(t),void 0!==this._image&&this._image.isDirty()&&this.applyImage(t),this.isDirtyMipmap()&&this.generateMipmap(t,this._textureTarget),!0;if(this._shouldBindNull())return t.bindTexture(this._textureTarget,null),!0;if(this.computeTextureFormat(),this._image){var n=this._image.getWidth()||this._textureWidth,i=this._image.getHeight()||this._textureHeight;this.setTextureSize(n,i)}var r=!!this._textureObject;return this._textureObject||this.init(e),this._textureObject.bind(t),!!this._requestUploadBudget(r)&&(this.applyImage(t),this.applyFilterParameter(t,this._textureTarget),this.generateMipmap(t,this._textureTarget),this._unrefImageDataAfterApply&&(this._image=void 0),this._dirty=!1,!0)},getHash:function(){return"osgSketchfabTexture"}}),"osgSketchfab","MultiresTexture"),(f.dummyTexture=new f).setName("MultiresDummyTexture"),f.dummyTexture.setTextureSize(1,1),t.a=f},gkeB:function(e,t,n){"use strict";(function(e){n.d(t,"d",function(){return i}),n.d(t,"b",function(){return T}),n.d(t,"c",function(){return M}),n.d(t,"a",function(){return E});var i,r=n("J4zp"),a=n.n(r),o=n("o0o1"),s=n.n(o),u=n("yXPU"),l=n.n(u),c=n("lSNA"),h=n.n(c),d=n("MVZn"),f=n.n(d),p=n("XiPH"),g=n("wHZf"),m=n("Fhuz"),v=n("NcRr"),_=n("WRMX"),b=n("NpZ0"),S=n("IlCM"),y=n("wgeW"),x=n("DWw0"),C=n("QKgc"),w=n("RzKY");!function(e){e.UPDATE="models.UPDATE",e.PUBLISH="models.PUBLISH",e.TRY_PUBLISH="models.TRY_PUBLISH",e.GET_VERSIONS="models.GET_VERSIONS",e.POLL_VERSIONS="models.POLL_VERSIONS",e.POLL_PROCESSING_STATUS="models.POLL_PROCESSING_STATUS",e.POLL_EXTRA_FILE_PROCESSING_STATUS="models.POLL_EXTRA_FILE_PROCESSING_STATUS",e.REMOVE_EXTRA_FILE="models.REMOVE_EXTRA_FILE",e.UPDATE_EXTRA_FILE="models.UPDATE_EXTRA_FILE",e.UPDATE_EXTRA_FILE_UPLOAD_STATE="models.UPDATE_EXTRA_FILE_UPLOAD_STATE",e.REPROCESS="models.REPROCESS"}(i||(i={}));var T=Object(b.b)({extraFileUploads:{}},h()({},i.UPDATE_EXTRA_FILE_UPLOAD_STATE,function(e,t){var n=t.uid,i=t.uploadState;return f()({},e,{extraFileUploads:f()({},e.extraFileUploads,h()({},n,i))})})),M={extraFileUpload:function(e,t){return t.models.extraFileUploads[e]||{type:"idle"}}},E={update:function(e,t){return{type:i.UPDATE,payload:{effect:function(){var n=l()(s.a.mark(function n(i){var r,a,o,u,l,c,h,d,g,b,y;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=i.Api,a=i.Prefetching,o=i.getState,u=i.dispatch,l=v.c.model(e,o()),Object(S.a)(l,"visibility")){n.next=4;break}throw new Error("You must provide the visibility of the model in order to change it.");case 4:if(c=f()({},l,t),Object(x.e)(l,c,m.c.user(o()))){n.next=7;break}throw new Error("Publish limit exceeded");case 7:return n.next=9,r.patchModel(e,t);case 9:return h=n.sent,(d=Object(x.i)(l,h))&&u(m.a.updatePublishCredits(function(e){return e+d})),g=Object(p.b)(h,_.f),b=g.entities,y=g.result,t.categories&&(b.models[h.uid].categories=t.categories),t.tags&&(b.models[h.uid].tags=t.tags),n.next=17,u(v.a.update({models:[h]}));case 17:return l.visibility!==c.visibility&&a.invalidateAllMatchRegExp(new RegExp("^/i/models/".concat(l.uid,"/sharing"))),n.abrupt("return",{entities:b,result:y});case 19:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},tryPublish:function(t,n){return{type:i.TRY_PUBLISH,payload:{effect:Object(g.clientOnly)(function(){var i=l()(s.a.mark(function i(r){var o,u,l,c,h,d,p,g,_;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(o=r.dispatch,u=r.getState,l=r.Popups,c=m.c.user(u()),h=v.c.model(t,u()),Object(S.a)(h,"visibility")){i.next=5;break}throw new Error("You must provide the visibility of the model in order to change it.");case 5:if(c.isStaff||h.org||c.uid===h.user.uid){i.next=7;break}throw new Error("User doesn't own the model");case 7:if(!c.isLimited){i.next=12;break}return i.next=10,l.loadEmailConfirmationPopup();case 10:return d=i.sent,i.abrupt("return",new d({reason:"publish"}).open().then(function(){return Object(y.a)(new C.b("User need to confirm his email"))}));case 12:if(p=f()({},h,n,{isPublished:!0}),Object(x.e)(h,p,c)){i.next=15;break}throw new Error("Publish limit exceeded");case 15:return i.next=17,e.all([l.loadShareAfterPublishPopup(),o(E.update(t,f()({},n,{isPublished:!0})))]);case 17:return g=i.sent,_=a()(g,1),new(0,_[0])({model:h,hasUsedAViewOnlyCredit:Object(x.g)(h,f()({},h,{isPublished:!0}))}).open(),i.abrupt("return",Object(y.b)(void 0));case 22:case"end":return i.stop()}},i)}));return function(e){return i.apply(this,arguments)}}(),i.TRY_PUBLISH)}}},getVersions:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{type:i.GET_VERSIONS,payload:{effect:function(){var n=l()(s.a.mark(function n(i){var r,a,o;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.Api,n.next=3,r.getModelVersions(e,{allowPrefetching:t});case 3:return a=n.sent,o=a.results,n.abrupt("return",{versions:o,entities:{models:h()({},e,{versions:o})}});case 6:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},pollVersions:function(e){return{type:i.POLL_VERSIONS,payload:{effect:function(t){var n=t.dispatch;return t.Http.retry(1/0,function(){return n(E.getVersions(e,!1)).then(function(e){var t=e.versions;if(!t.length||t.some(function(e){return Object(x.v)(e)}))throw new C.f;return{versions:t}})},{interval:2e3}).then(function(t){var n=t.versions,i=Object(x.l)(n).caseOf({None:function(){throw new Error("Model ".concat(e," has no version"))},Some:function(e){return e.status}});return{status:i,entities:{models:h()({},e,{status:i,versions:n})},versions:n}})}}}},pollExtraFileProcessingStatus:function(e){return{type:i.POLL_EXTRA_FILE_PROCESSING_STATUS,payload:{entities:{models:h()({},e,{management:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return f()({},e,{extraFile:e.extraFile?f()({},e.extraFile,{status:"pending"}):null})})})},effect:function(t){return t.Api.pollModelExtraFileProcessingStatus(e).then(function(t){return{management:t,entities:{models:h()({},e,{management:t})}}})}}}},reprocess:function(e){return{type:i.REPROCESS,payload:{entities:{models:h()({},e,{management:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return f()({},e,{hasStats:!1})})})},effect:function(t){var n=t.Api,i=t.dispatch,r=t.getState;return w.a.fromPromise(n.reprocessModel(e)).then(function(){return i(E.pollVersions(e))}).then(function(t){switch(t.processing){case"SUCCEEDED":var n=v.c.model(e,r());return{entities:{models:h()({},e,{management:n.management?f()({},n.management,{hasStats:!0}):void 0})}};case"FAILED":throw new Error("Reprocess failed");default:return{}}})}}}},updateExtraFileUploadState:function(e,t){return{type:i.UPDATE_EXTRA_FILE_UPLOAD_STATE,payload:{uid:e,uploadState:t}}},removeExtraFile:function(e){return{type:i.REMOVE_EXTRA_FILE,payload:{entities:{models:h()({},e,{management:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return f()({},e,{extraFile:null})})})},effect:function(t){return t.Api.removeModelExtraArchive(e)}}}},updateExtraFile:function(e,t){return{type:i.UPDATE_EXTRA_FILE,payload:{effect:function(){var n=l()(s.a.mark(function n(i){var r,a,o;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.Api,a=i.dispatch,n.next=3,r.updateModelExtraArchive(e,t,function(t){a(E.updateExtraFileUploadState(e,{type:"uploading",total:t.total,loaded:t.loaded}))});case 3:return a(E.updateExtraFileUploadState(e,{type:"idle"})),n.next=6,r.getModelManagement(e,{allowPrefetching:!1});case 6:return o=n.sent,n.abrupt("return",{entities:{models:h()({},e,{management:o})}});case 8:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}}}}).call(this,n("CSL1"))},grIK:function(e,t,n){"use strict";var i=n("6xPH"),r=n("gRsq"),a="";Object(r.a)()||Object(i.a)()||(a+="?optimized=1");t.a=function(e,t,n){var i="/i/models/"+t;if(e&&(i+="/"+e+a),n&&!window.prefetchedData[i])throw console.error("Missing prefetch "+i),new Error("Missing prefetch "+i);return i}},gspP:function(e,t){e.exports="uniform vec4 uColor;\n\nvoid main(void) {\n  gl_FragColor = vec4(uColor.xyz * uColor.a, uColor.a);\n}\n"},gw1E:function(e,t,n){"use strict";(function(e){var i=n("cDf5"),r=n.n(i),a=n("EVdn"),o=n.n(a),s=n("tNdj"),u=n("vIRb"),l=n("UIJo"),c=n("12sq");t.a=s.a.extend({endpoint:function(){return"/matcaps".concat(this.isNew()?"":"/".concat(this.get("uid")))},save:function(t,n){null!=t&&"object"!==r()(t)||(n=t);var i=new FormData;return i.append("imageFile",this.get("imageFile"),this.get("name")),i.append("modelUid",n.modelUID),e.resolve(o.a.ajax({url:this.url(),data:i,processData:!1,contentType:!1,type:"POST"}))},getProxyImage:function(){var e=this.findImageSmallest();return e||console.error("MISSING IMAGE DATA!"),{label:this.get("name"),value:this.get("uid")||this.get("id"),image:e.url,imageModel:this,deletable:!this.get("isDefault")}}},Object(l.a)({fileTypes:c.a.matcapFiletypes,maxFileSize:c.a.maxMatcapFilesize})).extend(u.a)}).call(this,n("CSL1"))},gySG:function(e,t,n){"use strict";t.a=function(e){var t=Array.prototype.slice.call(arguments,1),n=e.bind.apply(e,t);return n(),n}},gzuT:function(e,t,n){"use strict";var i=n("vBtE"),r=n("MG+9"),a=n("syB0"),o=n("EVdn"),s=n.n(o),u=n("gCTM"),l=n("xM9Z"),c=n("f5KD");n("IZz7");t.a=i.a.extend({displayName:"Notification",optionTypes:{parent:c.b.string,class:c.b.string,content:c.b.string,delay:c.b.number},defaultOptions:{parent:".flashmessage-container"},events:{'click [data-action="close"]':"onClickClose"},template:function(){return u.default.getFromMacro("skfb_front/macros/notification","flashmessage",[this.options.class,this.options.content,{safecontent:"True"}])},initialize:function(){i.a.prototype.initialize.apply(this,arguments),this.render(),this.options.delay&&this.close(this.options.delay)},render:function(){this.$el.html(Object(r.a)(this,"template")),s()(this.options.parent).append(this.$el);var e=this.$el.find(".notification");e.addClass("hidden"),Object(a.a)(e.removeClass.bind(e,"hidden"))},onClickClose:function(e){e&&e.preventDefault&&e.preventDefault(),this.close(0)},close:function(e){var t=this;e=e||0;var n=this.$el.find(".notification");return setTimeout(function(){n.addClass("hidden"),Object(l.a)(n).then(function(){t.$el.parent()[0].removeChild(t.el)})},e),this}})},"h/Nh":function(e,t,n){"use strict";var i=!1;t.a=function(e){return void 0!==e&&(i=e),i}},h16v:function(e,t){},hIgY:function(e,t,n){"use strict";var i=n("9oTK"),r=n.n(i),a=n("RTFJ"),o=n("+vQk"),s=n("1nG6"),u=n("icjm"),l=function(e){return"string"==typeof e||e instanceof String},c=window.zip,h=new window.Map,d=function(e){return new r.a(function(t,n){var i=new window.Image;i.onerror=function(){n(i)},i.onload=function(){t(i)},i.src=e})},f=function(e){var t=window.URL.createObjectURL(e),n=d(t);return n.finally(function(){window.URL.revokeObjectURL(t)}),n},p=function(e){return new r.a(function(t,n){var i=new window.FileReader;i.onerror=function(){n(i)},i.onload=function(){t(this.result)},i.readAsArrayBuffer(e)})},g=function(e){return Object(s.a)(e,{responseType:"arraybuffer"})},m=function(e){return Object(s.a)(e).then(function(e){return JSON.parse(e)})},v=function(e){var t=JSON.parse(e);return r.a.resolve(t)},_={createJSONFromURL:m,createArrayBufferFromURL:g,createArrayBufferFromBlob:p,createImageFromBlob:f,createImageFromURL:d,requestURI:s.a,requestResource:function(e,t){var n=_.getExtension(e),i=_.getMimeType(n);if(t&&t.responseType?t.responseType.toLowerCase():void 0)return Object(s.a)(e,t);if(i){if(i.match("image"))return d(e);if(i.match("binary"))return g(e);if(i.match("json"))return m(e);if(i.match("text"))return Object(s.a)(e)}return Object(s.a)(e)},resolveData:function(e,t){var n,i=_.getExtension(e),a=_.getMimeType(i);return a&&(a.match("image")?l(t)?n=d:t instanceof window.Blob&&(n=f):a.match("json")?n=function(e){return!!l(e)&&(function(e){return"blob:http"===e.substr(0,9)}(e)||function(e){return"http://"===e.substr(0,7)||"https://"===e.substr(0,8)}(e))}(t)?m:v:a.match("binary")&&(l(t)?n=g:t instanceof window.Blob&&(n=p))),n?n(t):r.a.resolve(t)},resolveFilesMap:function(e){var t=[];for(var n in e){var i=e[n],a=_.resolveData(n,i).then(function(e,t){this[e]=t}.bind(e,n));t.push(a)}return r.a.all(t).then(function(){return e})},_unzipEntry:function(e){return new r.a(function(t){var n=e.filename,i=_.getExtension(n),r=_.getMimeType(i),a=c.BlobWriter;null===r.match("text")&&null===r.match("json")||(a=c.TextWriter),e.getData(new a(r),function(e){t({filename:n,data:e})})})},unzipBlob:function(e){return new r.a(function(t,n){var i={},a=[];c.createReader(new c.BlobReader(e),function(e){e.getEntries(function(n){for(var o=0;o<n.length;o++)if(!n[o].directory){var s=_._unzipEntry(n[o]);s.then(function(e){i[e.filename]=e.data}),a.push(s)}r.a.all(a).then(function(){e.close(),_.resolveFilesMap(i).then(function(e){t(e)})})})},function(){n(this)})})},unzip:function(e){if(!window.zip)return r.a.reject("missing deps to unzip, require https://github.com/gildas-lormeau/zip.js");if(l(e))return _.requestResource(e).then(function(e){var t=new window.Blob([e],{type:h.get("zip")});return _.unzipBlob(t)});if(e instanceof window.Blob)return _.unzipBlob(e);if(e instanceof window.ArrayBuffer){var t=new window.Blob([e],{type:h.get("zip")});return _.unzipBlob(t)}return r.a.reject("cant unzip input")},readFileList:function(e){var t,n,i={},u=[];for(n=0;n<e.length;++n){var l=_.getExtension(e[n].name);void 0===o.a.instance().getReaderWriterForExtension(l)&&"osgjs"!==l||(t=e[n].name);var c,h=_.getMimeType(l);c=h.match("image")?"blob":h.match("json")||h.match("text")?"string":"arraybuffer",u.push(Object(s.a)(e[n],{responseType:c}))}return r.a.all(u).then(function(r){for(n=0;n<r.length;++n)i[e[n].name]=r[n];return _.resolveFilesMap(i).then(function(e){return a.default.readNodeURL(t,{filesMap:e})})})},getMimeType:function(e){return h.get(e)},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1)},addMimeTypeForExtension:function(e,t){void 0!==h.has(e)&&u.a.warn("the '"+e+"' already has a mimetype: "+h.get(e)),h.set(e,t)}};h.set("bin","application/octet-binary"),h.set("b3dm","application/octet-binary"),h.set("glb","application/octet-binary"),h.set("zip","application/octet-binary"),h.set("gz","application/octet-binary"),h.set("png","image/png"),h.set("jpg","image/jpeg"),h.set("jpeg","image/jpeg"),h.set("gif","image/gif"),h.set("json","application/json"),h.set("gltf","application/json"),h.set("osgjs","application/json"),h.set("txt","text/plain"),h.set("glsl","text/plain"),t.a=_},hLWu:function(e,t,n){"use strict";var i=n("a3nb"),r=n("czSk"),a=n("wwkN"),o=n("icjm"),s=n("vQSd"),u=n("WqyB"),l=n("qRO0"),c=n("r7P/"),h=n("/pUn"),d=function(){c.a.call(this,c.a.TRAVERSE_PARENTS),this._root=void 0,this._pathToRoot=void 0};i.a.createPrototypeObject(d,i.a.objectInherit(c.a.prototype,{apply:function(e){if(!this._root)return e.typeID===h.a.typeID?(this._root=e,void(this._pathToRoot=this.nodePath.slice(1))):void this.traverse(e)}}),"osgAnimation","FindNearestParentSkeleton");var f=d,p=function(){l.a.call(this)};i.a.createPrototypeObject(p,i.a.objectInherit(l.a.prototype,{init:function(e){var t=new f;e.getParents().length>1&&o.a.warn("A RigGeometry should not have multi parent ( "+e.getName()+" )"),e.getParents()[0].accept(t),t._root?(e.setSkeleton(t._root),e.setPathToSkeleton(t._pathToRoot)):o.a.warn("A RigGeometry did not find a parent skeleton for RigGeometry ( "+e.getName()+" )")},update:function(e){if(e&&"RigGeometry"!==e.className())return!0;var t=e;return t.getSkeleton()||0===t.getParents().length||this.init(t),!t.getSkeleton()||(t.getNeedToComputeMatrix()&&t.computeMatrixFromRootSkeleton(),t.update(),!0)}}),"osgAnimation","UpdateRigGeometry");var g=p,m=n("Qavt"),v=n("vnIN"),_=n("gHdx"),b=function(){c.a.call(this,c.a.TRAVERSE_ALL_CHILDREN),this._boneMap={}};i.a.createPrototypeObject(b,i.a.objectInherit(c.a.prototype,{apply:function(e){if(e.typeID===_.a.typeID){var t=e.getName();t?this._boneMap[t]=e:o.a.warn("found Bone without name")}this.traverse(e)},getBoneMap:function(){return this._boneMap}}),"osgAnimation","CollectBoneVisitor");var S=b,y=function(){this._isInitialized=!1,this._bones=[]};y.prototype={computeBonePalette:function(e,t){var n=this._bones;for(var i in e){var r=t[i],a=e[i];void 0!==r&&(n[r]=a)}return n},init:function(e){var t=new S;e.getSkeleton().accept(t);var n=t.getBoneMap();this.computeBonePalette(n,e._boneNameID);var i=3*this._bones.length,r=this._skinningAttribute=new v.a;return r.setMatrixPalette(new Float32Array(4*i)),e.getStateSetAnimation().setAttributeAndModes(r,m.a.ON),this._isInitialized=!0,!0},computeMatrixPalette:function(){var e=r.c.create();return function(t,n){for(var i=this._bones,a=this._skinningAttribute.getMatrixPalette(),o=0,s=0,u=i.length;s<u;s++){var l=i[s],c=l.getInvBindMatrixInSkeletonSpace(),h=l.getMatrixInSkeletonSpace();r.c.mul(e,h,c),r.c.mul(e,n,e),r.c.mul(e,e,t),a[o++]=e[0],a[o++]=e[4],a[o++]=e[8],a[o++]=e[12],a[o++]=e[1],a[o++]=e[5],a[o++]=e[9],a[o++]=e[13],a[o++]=e[2],a[o++]=e[6],a[o++]=e[10],a[o++]=e[14]}}}(),update:function(e){this._isInitialized||this.init(e),this.computeMatrixPalette(e.getMatrixFromSkeletonToGeometry(),e.getInvMatrixFromSkeletonToGeometry())}};var x=y,C=n("7E8H"),w=n("zWCM"),T=function(){a.a.call(this),this._shape=null,this.addUpdateCallback(new g),this._root=void 0,this._pathToRoot=void 0,this._isAnimatedPath=!1,this._boneNameID={},this._matrixFromSkeletonToGeometry=r.c.create(),this._invMatrixFromSkeletonToGeometry=r.c.create(),this._rigTransformImplementation=new x,this._geometry=void 0,this._stateSetAnimation=new s.a,this._needToComputeMatrix=!0};i.a.createPrototypeNode(T,i.a.objectInherit(a.a.prototype,{getStateSetAnimation:function(){return this._stateSetAnimation},getSkeleton:function(){return this._root},setSkeleton:function(e){this._root=e},setPathToSkeleton:function(e){this._pathToRoot=e,this._isAnimatedPath=C.a.checkPathIsAnimated(e)},setNeedToComputeMatrix:function(e){this._needToComputeMatrix=e},getNeedToComputeMatrix:function(){return this._needToComputeMatrix},separateStaticBoxInGeometry:function(){var e=this.getBoundingBox();if(e.valid()&&!this._staticGeomAdded){this._staticGeomAdded=!0;var t=new a.a;t.setNodeMask(0),t.setName("staticBoxOf:"+this.getName());for(var n=this.getParents(),i=0;i<n.length;++i)n[i].addChild(t);t.getBoundingBox().copy(e),t.getBoundingSphere().copy(this.getBoundingSphere()),e.init(),this.getBoundingSphere().init()}},computeBoundingBox:function(e){e.init();var t=this.getVertexAttributeList().Vertex,n=this.getVertexAttributeList().Weights;if(t&&n&&t.getElements()&&t.getItemSize()>2){for(var i=n.getElements(),r=t.getElements(),a=t.getItemSize(),o=e.getMin(),s=e.getMax(),u=o[0],l=o[1],c=o[2],h=s[0],d=s[1],f=s[2],p=0,g=0,m=r.length;p<m;p+=a,g+=4)if(0===i[p]&&0===i[p+1]&&0===i[p+2]&&0===i[p+3]){var v=r[p],_=r[p+1],b=r[p+2];v<u&&(u=v),v>h&&(h=v),_<l&&(l=_),_>d&&(d=_),b<c&&(c=b),b>f&&(f=b)}o[0]=u,o[1]=l,o[2]=c,s[0]=h,s[1]=d,s[2]=f}return e},computeMatrixFromRootSkeleton:function(){this._root?(r.c.identity(this._matrixFromSkeletonToGeometry),w.a.computeLocalToWorld(this._pathToRoot,!0,this._matrixFromSkeletonToGeometry),r.c.invert(this._invMatrixFromSkeletonToGeometry,this._matrixFromSkeletonToGeometry),this._isAnimatedPath||(this._needToComputeMatrix=!1)):o.a.warn("Warning "+this.className()+".computeMatrixFromRootSkeleton if you have this message it means you miss to call buildTransformer( root ), or your RigGeometry ("+this.getName()+") is not attached to a Skeleton subgraph")},getMatrixFromSkeletonToGeometry:function(){return this._matrixFromSkeletonToGeometry},getInvMatrixFromSkeletonToGeometry:function(){return this._invMatrixFromSkeletonToGeometry},getSourceGeometry:function(){return this._geometry},setSourceGeometry:function(e){this._geometry=e},getBoneNameID:function(){return this._boneNameID},setBoneNameID:function(e){this._boneNameID=e},mergeChildrenVertexAttributeList:function(){this._geometry instanceof u.a&&this._geometry.mergeChildrenVertexAttributeList();var e=this._geometry.getVertexAttributeList();a.a.appendVertexAttributeToList(e,this.getVertexAttributeList())},mergeChildrenData:function(){this.mergeChildrenVertexAttributeList();var e=this._geometry.getPrimitiveSetList();this.getPrimitiveSetList().length=0;for(var t=0,n=e.length;t<n;t++)this.getPrimitiveSetList()[t]=e[t];this.getStateSet()&&console.error("A stateset in the rig is already present : "+this.getStateSet()),this.setStateSet(this._geometry.getStateSet())},update:function(){this._rigTransformImplementation.update(this)},computeTransformedVertex:function(e,t){t=t||r.f.create();var n=this.getVertexAttributeList(),i=n.Weights.getElements(),a=n.Bones.getElements(),o=0,s=0,u=0;if(this._geometry.computeTransformedVertex)this._geometry.computeTransformedVertex(e,t),o=t[0],s=t[1],u=t[2];else{var l=n.Vertex.getElements();o=l[3*e],s=l[3*e+1],u=l[3*e+2]}for(var c=4*e,h=this._rigTransformImplementation._skinningAttribute.getMatrixPalette(),d=0,f=0,p=0,g=0,m=0,v=0,_=0,b=0,S=0,y=0,x=0,C=0,w=0,T=!1,M=0;M<4;++M){var E=i[c+M];if(0!==E){var A=12*a[c+M];d+=h[A+0]*E,g+=h[A+1]*E,_+=h[A+2]*E,y+=h[A+3]*E,f+=h[A+4]*E,m+=h[A+5]*E,b+=h[A+6]*E,x+=h[A+7]*E,p+=h[A+8]*E,v+=h[A+9]*E,S+=h[A+10]*E,C+=h[A+11]*E,w+=E,T=!0}}T||(t[0]=o,t[1]=s,t[2]=u);var O=1/w;return t[0]=(d*o+g*s+_*u+y)*O,t[1]=(f*o+m*s+b*u+x)*O,t[2]=(p*o+v*s+S*u+C)*O,t},computeTransformedVertices:function(){for(var e=this.getVertexAttributeList(),t=this._geometry.computeTransformedVertices?this._geometry.computeTransformedVertices():e.Vertex.getElements(),n=e.Weights.getElements(),i=e.Bones.getElements(),r=this._riggedVerts||new Float32Array(t.length),a=this._rigTransformImplementation._skinningAttribute.getMatrixPalette(),o=0,s=0,u=t.length;o<u;o+=3,s+=4){var l,c=0,h=0,d=0,f=0,p=0,g=0,m=0,v=0,_=0,b=0,S=0,y=0,x=0,C=!1,w=n[s];0!==w&&(c+=a[(l=12*i[s])+0]*w,f+=a[l+1]*w,m+=a[l+2]*w,b+=a[l+3]*w,h+=a[l+4]*w,p+=a[l+5]*w,v+=a[l+6]*w,S+=a[l+7]*w,d+=a[l+8]*w,g+=a[l+9]*w,_+=a[l+10]*w,y+=a[l+11]*w,x+=w,C=!0),0!==(w=n[s+1])&&(c+=a[(l=12*i[s+1])+0]*w,f+=a[l+1]*w,m+=a[l+2]*w,b+=a[l+3]*w,h+=a[l+4]*w,p+=a[l+5]*w,v+=a[l+6]*w,S+=a[l+7]*w,d+=a[l+8]*w,g+=a[l+9]*w,_+=a[l+10]*w,y+=a[l+11]*w,x+=w,C=!0),0!==(w=n[s+2])&&(c+=a[(l=12*i[s+2])+0]*w,f+=a[l+1]*w,m+=a[l+2]*w,b+=a[l+3]*w,h+=a[l+4]*w,p+=a[l+5]*w,v+=a[l+6]*w,S+=a[l+7]*w,d+=a[l+8]*w,g+=a[l+9]*w,_+=a[l+10]*w,y+=a[l+11]*w,x+=w,C=!0),0!==(w=n[s+3])&&(c+=a[(l=12*i[s+3])+0]*w,f+=a[l+1]*w,m+=a[l+2]*w,b+=a[l+3]*w,h+=a[l+4]*w,p+=a[l+5]*w,v+=a[l+6]*w,S+=a[l+7]*w,d+=a[l+8]*w,g+=a[l+9]*w,_+=a[l+10]*w,y+=a[l+11]*w,x+=w,C=!0);var T=t[o],M=t[o+1],E=t[o+2];if(C){var A=1/x;r[o]=(c*T+f*M+m*E+b)*A,r[o+1]=(h*T+p*M+v*E+S)*A,r[o+2]=(d*T+g*M+_*E+y)*A}else r[o]=T,r[o+1]=M,r[o+2]=E}return r}}),"osgAnimation","RigGeometry");t.a=T},hZRv:function(e,t){e.exports='#define HAS_VIEW_VERTEX\n#pragma include "base.vert"\n'},hgfR:function(e,t){e.exports='#pragma include "utils/functions.glsl"\n#pragma include "utils/decodeDepth.glsl"\n#pragma include "utils/rand.glsl"\n\nuniform sampler2D TextureSSSBlur;\nuniform sampler2D TextureDepth;\nuniform sampler2D TextureSSSKernel;\n\nuniform vec2 uNearFar;\n\nuniform vec2 uBlurDir;\nuniform float uProjFactor;\nuniform float uScatteringFactorPacker;\nuniform float uFrameModTaaSS;\n\n#ifndef SSS_JITTER\n#define SSS_JITTER 1.0\n#endif\n\n#ifndef SSS_HALF_KERNEL_SIZE\n#define SSS_HALF_KERNEL_SIZE 11\n#endif\n\n#ifndef SSS_PROFILE_COUNT\n#define SSS_PROFILE_COUNT 1\n#endif\n\n#define SSS_FOLLOW_SURFACE\n\n// if we want to do it branchless\nvec3 sssFetchColorBranchless(const in vec2 uv, const in vec4 colorM, const in float depthNormBias){\n    vec4 fetch = TEXTURE_2D_TextureSSSBlur(uv);\n\n#ifdef SSS_FOLLOW_SURFACE\n    float mixer = smoothstep(0.0, 0.05, abs(colorM.a - fetch.a) * depthNormBias);\n    mixer = mix(mixer, 1.0, step(fetch.a, 0.0)); // force to 1 if fetch.a is 0 (background)\n    fetch.rgb = mix(fetch.rgb, colorM.rgb, mixer);\n#endif\n\n    // uv inside box\n    // https://stackoverflow.com/questions/12751080/glsl-point-inside-box-test\n    vec2 s = step(vec2(0.0), uv) - step(vec2(1.0), uv);\n    return mix(colorM.rgb, fetch.rgb, s.x * s.y);\n}\n\nvec3 sssFetchColor(const in vec2 uv, const in vec4 colorM, const in float depthNormBias){\n    if (uv.x < 0.0 || uv.y < 0.0 || uv.x > 1.0 || uv.y > 1.0) {\n        return colorM.rgb;\n    }\n\n    // ignore sss with big depth difference, original jimenez is clamp(dDiff, 0.0, 1.0)\n    // we use a much more aggressive function\n    vec4 fetch = TEXTURE_2D_TextureSSSBlur(uv);\n\n#ifdef SSS_FOLLOW_SURFACE\n    if (fetch.a == 0.0) return colorM.rgb;\n    return mix(fetch.rgb, colorM.rgb, smoothstep(0.0, 0.05, abs(colorM.a - fetch.a) * depthNormBias));\n#else\n    return fetch.rgb;\n#endif\n}\n\nvec4 sssBlur() {\n    vec4 colorM = TEXTURE_2D_TextureSSSBlur(gTexCoord);\n\n    vec4 pack = TEXTURE_2D_TextureDepth(gTexCoord);\n\n    // background or not sss stuffs\n    if (pack.x == 1.0) {\n        return colorM;\n    }\n\n    int profile = decodeProfile(pack);\n    float scatter = decodeScatter(pack);\n    if (scatter == 0.0) {\n        return colorM;\n    }\n\n    float scatterWorld = scatter / uScatteringFactorPacker;\n    float depthRange = (uNearFar.y - uNearFar.x);\n\n    // for follow surface\n    // factor to get a normalized depth difference depending of scatter but not of camera position\n    float depthNormBias = depthRange * 0.05 / scatterWorld;\n\n    float worldPos = uNearFar.x + depthRange * colorM.a;\n    // uScatteringFactorPacker is just a unpacking factor because subsurface factor \n    // is a world space value but written in 8 bit texture\n    vec2 finalStep = uBlurDir * uProjFactor * scatterWorld / worldPos;\n    finalStep *= 1.0 / 3.0;\n\n    float yProfile = 1.0 - (float(profile) - 0.5) / float(SSS_PROFILE_COUNT);\n    float xKernelSize = 1.0 / float(SSS_HALF_KERNEL_SIZE);\n\n    vec3 kernel0 = texture2D(TextureSSSKernel, vec2(xKernelSize * 0.5, yProfile)).rgb;\n    vec3 colorBlurred = colorM.rgb * kernel0;\n\n    // force nearest sample for sss texture kernel color\n    vec2 offKernelNearest = vec2(0.5 * xKernelSize, 0.0);\n\n    // randomize the sss texture alpha weight a bit\n    float rnd = interleavedGradientNoise(gl_FragCoord.xy, uFrameModTaaSS);\n    rnd = mix(0.5, rnd, SSS_JITTER);\n    vec2 offKernelJitter = vec2(rnd * xKernelSize, 0.0);\n\n    for (int i = 1; i < SSS_HALF_KERNEL_SIZE; i++) {\n        vec2 uvKernel = vec2(float(i) * xKernelSize, yProfile);\n\n        vec3 kernel = texture2D(TextureSSSKernel, uvKernel + offKernelNearest).rgb;\n        float kernelDither = texture2D(TextureSSSKernel, uvKernel + offKernelJitter).a;\n\n        vec2 offset = kernelDither * finalStep;\n\n        vec3 fetch = sssFetchColor(gTexCoord + offset, colorM, depthNormBias);\n        fetch += sssFetchColor(gTexCoord - offset, colorM, depthNormBias);\n\n        colorBlurred += kernel.rgb * fetch;\n    }\n\n    return vec4(colorBlurred, colorM.a);\n}\n'},htjh:function(e,t,n){var i=n("gB9P"),r=function(e){var t=e,n={};t.indexOf("#")>-1&&(t=t.slice(1));var i=t.split(":");return 1===i.length?n.data=i[0]:2===i.length?(n.from=i[0].toUpperCase(),n.data=i[1]):3===i.length&&(n.from=i[0].toUpperCase(),n.to=i[1].toUpperCase(),n.data=i[2]),n.data&&(n.stringData=n.data,n.data=function(e){e=e||"";var t={};return(e=decodeURIComponent(e)).split("&").forEach(function(e){if(e.indexOf("=")>-1){var n=e.split("=");t[n[0]]=n[1]}else t=e.indexOf(",")>-1?e.split(","):e}.bind(this)),t}(n.data)),n._originalString=e+";",n},a=function(e){var t=e;"string"==typeof e&&(t=r(e)),this._msg=t,this.from=t.from,this.to=t.to,this.data=o(t.data)},o=function(e){return"string"==typeof e?e=decodeURIComponent(e):Array.isArray(e)?e=e.map(decodeURIComponent):"object"===(typeof e).toLowerCase()&&Object.keys(e).forEach(function(t){"string"==typeof e[t]?e[t]=decodeURIComponent(e[t]):Array.isArray(e[t])&&(e[t]=e[t].map(decodeURIComponent))}.bind(this)),e};a.prototype._getStringifiedData=function(){var e="";if("string"==typeof this.data)return encodeURIComponent(this.data);if(Array.isArray(this.data))return this.data.map(encodeURIComponent).join(",");if("object"==typeof this.data)for(var t in this.data){var n;"string"==typeof this.data[t]?n=encodeURIComponent(this.data[t]):Array.isArray(this.data[t])&&(n=this.data[t].map(encodeURIComponent).join(",")),e+=t+"="+n}return e},a.prototype.toString=function(){var e="";return this.from&&(e+=this.from+":"),this.to&&(e+=this.to+":"),e+=this._getStringifiedData()+";"};var s=function(e){if(!(e=e||{}).device)throw new Error('ViewerHashAPI options need to contain the "device" identifier property');e.listen&&this.listen(e.listen),this.device=e.device};s.prototype.appendToHash=function(e,t){e instanceof a&&(e=e.toString()),"string"==typeof e&&-1===(t=u(t)).location.hash.indexOf(e)&&(t.location.hash=t.location.hash+e)},s.prototype.removeFromHash=function(e,t){if(!(e instanceof a))throw new Error("Please supply an instance of ViewerHashMessage");var n=(t=u(t)).location.hash;n=e._msg&&e._msg._originalString?n.replace(e._msg._originalString,""):n.replace(e.toString(),""),t.location.hash=n};var u=function(e){if((e=(!0===e?window:e)||window)&&e.tagName&&"iframe"===e.tagName.toLowerCase()&&(e=e.contentWindow),!e.addEventListener)throw new Error("Could not bind an event to supplied target. Please supply an instance of window or an iframe.");return e};s.prototype.listen=function(e){return(e=u(e)).addEventListener("hashchange",this._onHashChange.bind(this,e),!1)},s.prototype._onHashChange=function(e){(this.getMessages(e.location.hash).messages||[]).forEach(function(e){if(e)if(e.data&&!Array.isArray(e)){var t=e.data;if("object"==typeof e.data){var n=Object.keys(e.data);t=e.data._key?e.data._key:n[0]}t&&this.trigger("message:"+t,e)}else this.trigger("message",e)}.bind(this))},s.prototype.getMessages=function(e){var t=function(e,t){var n=e;n.indexOf("#")>-1&&(n=n.slice(1));var i=n.split(";"),o=[];for(var s in i){var u=new a(r(i[s]));u.from&&u.from===t||!u.data||o.push(u)}return o}(e,this.device),n=e;for(var i in t)n=t[i]._msg&&t[i]._msg._originalString?n.replace(t[i]._msg._originalString,""):n.replace(t[i].toString(),"");return{messages:t,hash:n}},s.prototype.createMessage=function(e){return(e=e||{}).from=this.device,new a(e)},i.mixin(s.prototype),a.prototype.removeFromHash=function(){s.prototype.removeFromHash.call(this,this)},a.prototype.appendToHash=function(){s.prototype.appendToHash.call(this,this)},e.exports=s},"i4v/":function(e,t,n){"use strict";var i=n("vBtE");t.a=i.a.extend({constructor:function(e){this.viewer=e.viewer,this.widgets=e.widgets,i.a.apply(this,arguments)},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},isEnabled:function(){return this.$el.hasClass("disabled")}})},i6dD:function(e,t,n){"use strict";var i=n("EVdn"),r=n.n(i),a=n("YfG3"),o=n("MG+9"),s=n("vJtL"),u=n("PteP"),l=n("TYgF"),c=n("3CzM");t.a=u.a.extend({mixins:[l.b,c.a],el:'<div class="widget"/>',constructor:function(e,t){this.environment=Object(a.a)({},e?e.environment:{},(t||{}).environment),this.options=t||{},this.collection=this.options.collection,this.model=this.options.model,u.a.call(this,t)},initialize:function(e){u.a.prototype.initialize.call(this,e),this.render(),void 0!==this.options.id&&(this.id=this.options.id,this.$el.attr("id",this.id)),void 0!==this.options.className&&(this.className=this.options.className,this.$el.addClass(this.className)),void 0!==this.options.title&&this.$el.attr("title",this.options.title)},$:function(e){var t=this.$el;return this.$el.find(e).filter(function(){return r()(this).parent().closest(".widget").is(t)})},delegateEvents:function(e){e||(e=Object(o.a)(this,"events")||{});var t=this.$el;return u.a.prototype.delegateEvents.call(this,Object.keys(e).reduce(function(n,i){var a=e[i];return Object(s.a)(a)||(a=this[e[i]]),a?(n[i]=function(e){e&&e.currentTarget&&!r()(e.currentTarget).closest(".widget").is(t)||a.apply(this,arguments)}.bind(this),n):n}.bind(this),{})),this.model&&this.model.on("change",this.modelChangeEvent,this),this},undelegateEvents:function(){return u.a.prototype.undelegateEvents.apply(this,arguments),this.model&&this.model.off("change",this.modelChangeEvent,this),this},modelChangeEvent:function(){var e=this.options.name,t=e+".",n=!e,i=Object.keys(this.model.changedAttributes()||{}).some(function(n){return n===e||0===n.indexOf(t)});(n||i)&&this.render()},change:function(e,t){1===arguments.length&&(t=e,e=void 0);var n=!0,i={target:this,which:e,value:t,preventDefault:function(){n=!1}};return this.trigger("change.before",i),!!n&&(this.defaultAction(e,t),this.trigger("change"),!0)},defaultAction:function(e,t){this.set(t)},field:function(e){return this.options.name+(e?"."+e:"")},get:function(e){return this.model.get(this.field(e))},set:function(e,t){return 1===arguments.length&&(t=e,e=void 0),this.model.set(this.field(e),t)},disable:function(){this._disabled=!0,this.$el.addClass("disabled")},enable:function(){this._disabled=!1,this.$el.removeClass("disabled")}},{reify:function(){var e=arguments,t=this,n=function(){t.apply(this,e)};return n.prototype=this.prototype,new n}})},iMQx:function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("q1tI"),o=n("6uKY"),s=n("wsGC");var u=r()("span",{},void 0,", "),l=r()("span",{},void 0,", "),c=r()("span",{},void 0,", "),h=r()("span",{},void 0," and ");t.a=function(e){var t=e.totalCount,n=e.names,i=e.othersHref,d=e.onOtherClick,f=e.maxDisplay,p=void 0===f?3:f,g=function(e,t){return t>e.length?e.slice(1,e.length-1):e.slice(1,t-1)}(n,p),m=t-p;return a.createElement(a.Fragment,null,n[0],g.map(function(e,t){return r()(a.Fragment,{},t,u,e)}),m>0?d||i?a.createElement(a.Fragment,null,l,n[p-1]," and ",r()("a",{className:Object(s.a)("other","skfb-link"),href:i,onClick:d},void 0,"".concat(m," other").concat(Object(o.pluralize)(m)))):a.createElement(a.Fragment,null,c,n[p-1],r()("span",{className:"others"},void 0," and ".concat(m," other").concat(Object(o.pluralize)(m)))):n.length>1?a.createElement(a.Fragment,null,h,n[n.length-1]):null)}},iXLb:function(e,t){e.exports="uniform sampler2D TextureRefractionBlur0;\nuniform sampler2D TextureRefractionBlur1;\nuniform sampler2D TextureRefractionBlur2;\nuniform sampler2D TextureRefractionBlur3;\nuniform sampler2D TextureRefractionBlur4;\nuniform sampler2D TextureRefractionBlur5;\nuniform sampler2D TextureRefractionBlur6;\nuniform sampler2D TextureRefractionBlur7;\nuniform vec2 uTextureOutputRatio;\n\nvec4 packMipmapRefraction() {\n    vec4 result = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // see _hookComposerResize in NodePostProcess.js (mipmap)\n    gTexCoord.y /= uTextureOutputRatio.y;\n\n    float levelLog = -log2(1.0 - gTexCoord.y) + 1.0;\n    float level = floor(levelLog) - 1.0;\n\n    float pLevel = pow(2.0, level + 1.0); // 2, 4, 8, 16...\n    gTexCoord.x = pLevel * gTexCoord.x * 0.5;\n    gTexCoord.y = pLevel * (1.0 - gTexCoord.y) - 1.0;\n\n    // unused part of the texture\n    if (gTexCoord.x > 1.0 || gTexCoord.y > 1.0) return result;\n\n    if (level < 0.1) result.rgb = TEXTURE_2D_TextureRefractionBlur0(gTexCoord).rgb;\n    else if (level < 1.1) result.rgb = TEXTURE_2D_TextureRefractionBlur1(gTexCoord).rgb;\n    else if (level < 2.1) result.rgb = TEXTURE_2D_TextureRefractionBlur2(gTexCoord).rgb;\n    else if (level < 3.1) result.rgb = TEXTURE_2D_TextureRefractionBlur3(gTexCoord).rgb;\n    else if (level < 4.1) result.rgb = TEXTURE_2D_TextureRefractionBlur4(gTexCoord).rgb;\n    else if (level < 5.1) result.rgb = TEXTURE_2D_TextureRefractionBlur5(gTexCoord).rgb;\n    else if (level < 6.1) result.rgb = TEXTURE_2D_TextureRefractionBlur6(gTexCoord).rgb;\n    else if (level < 7.1) result.rgb = TEXTURE_2D_TextureRefractionBlur7(gTexCoord).rgb;\n\n    return result;\n}\n"},ialn:function(e,t,n){"use strict";var i=e.exports=function(e,t,n){"function"==typeof t&&(n=t,t={}),function e(t,n,a,o,s,u,l,c,h){if(a&&"object"==typeof a&&!Array.isArray(a))for(var d in n(a,o,s,u,l,c,h),a){var f=a[d];if(Array.isArray(f)){if(d in i.arrayKeywords)for(var p=0;p<f.length;p++)e(t,n,f[p],o+"/"+d+"/"+p,s,o,d,a,p)}else if(d in i.propsKeywords){if(f&&"object"==typeof f)for(var g in f)e(t,n,f[g],o+"/"+d+"/"+r(g),s,o,d,a,g)}else(d in i.keywords||t.allKeys&&!(d in i.skipKeywords))&&e(t,n,f,o+"/"+d,s,o,d,a)}}(t,n,e,"",e)};function r(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}i.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},i.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},i.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},i.skipKeywords={enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},icjm:function(e,t,n){"use strict";var i={};function r(){var e=arguments[0];if(i.console&&!(e>i.currentNotifyLevel)){var t=arguments[1],n=Array.prototype.slice.call(arguments);n=n.splice(2,arguments.length),i.console[t].apply(i.console,n),i.traceLogCall&&e!==i.ERROR&&console.trace()}}function a(e,t,n,r){!i.console||e>i.currentNotifyLevel||(i.console.groupCollapsed&&i.console.groupCollapsed(n),i.console[t](r),i.traceLogCall&&e!==i.ERROR&&console.trace(),i.console.groupEnd&&i.console.groupEnd())}function o(e,t){return t?[e.slice(0,4),e.slice(4,8),e.slice(8,12),e.slice(12,16)]:[[e[0],e[4],e[8],e[12]],[e[1],e[5],e[9],e[13]],[e[2],e[6],e[10],e[14]],[e[3],e[7],e[11],e[15]]]}function s(e,t,n){e>i.currentNotifyLevel||i.console.table&&r("table",o(t,n))}function u(e,t,n,r){e>i.currentNotifyLevel||i.console.table&&a("table",t,o(n,r))}i.ALWAYS=0,i.FATAL=i.ERROR=1,i.WARN=2,i.NOTICE=i.LOG=3,i.INFO=4,i.DEBUG=5,i.currentNotifyLevel=i.LOG,i.console=window.console;for(var l=["error","warn","log","info","debug"],c=0;c<l.length;++c){var h=l[c],d=i[h.toUpperCase()];i[h]=r.bind(i,d,h),i[h+"Fold"]=a.bind(i,d,h),i[h+"Matrix"]=s.bind(i,d),i[h+"MatrixFold"]=u.bind(i,d)}i.group=r.bind(i,i.LOG,"group"),i.groupCollapsed=r.bind(i,i.LOG,"groupCollapsed"),i.groupEnd=i.console.groupEnd,i.notice=i.log,i.noticeFold=i.logFold,i.noticeMatrix=i.logMatrix,i.noticeMatrixFold=i.logMatrixFold,i.timeStamp=function(){},i.assert=function(e,t){void 0===this.console||e||this.console.assert(e,t)},i.setNotifyLevel=function(e,t){i.currentNotifyLevel=e,void 0!==t&&(i.traceLogCall=t)},i.getNotifyLevel=function(){return i.currentNotifyLevel},i.reportWebGLError=!1,i.setConsole=function(e){i.console=e},t.a=i},iffO:function(e,t){e.exports='#pragma include "utils/rand.glsl"\n\nuniform float uTimeGrain;\nuniform float uGrainFactor;\n\nfloat nrandTriangle() {\n    float nrnd0 = pseudoRandom(gl_FragCoord.xy + 1000.0 * fract(uTimeGrain));\n\n    // Convert uniform distribution into triangle-shaped distribution.\n    float orig = nrnd0 * 2.0 - 1.0;\n    nrnd0 = orig * inversesqrt(abs(orig));\n    nrnd0 = max(-1.0, nrnd0); // Nerf the NaN generated by 0 * rsqrt(0). Thanks @FioraAeterna!\n    nrnd0 = nrnd0 - sign(orig) + 0.5;\n\n    // Result is range [-0.5,1.5] which is useful for actual dithering. convert to [0,1] for histogram.\n    return (nrnd0 + 0.5) * 0.5;\n    // return nrnd0;\n}\n\nvec4 grain(const in vec4 color) {\n    float grainFactor = nrandTriangle();\n    return vec4(mix(color.rgb, color.rgb * (color.rgb + (1.0 - color.rgb) * 2.0 * grainFactor), uGrainFactor), color.a);\n}'},imBb:function(e,t,n){var i;!function(r,a,o){if(r){for(var s,u={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},l={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},c={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},h={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},d=1;d<20;++d)u[111+d]="f"+d;for(d=0;d<=9;++d)u[d+96]=d.toString();b.prototype.bind=function(e,t,n){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,n),this},b.prototype.unbind=function(e,t){return this.bind.call(this,e,function(){},t)},b.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},b.prototype.reset=function(){return this._callbacks={},this._directMap={},this},b.prototype.stopCallback=function(e,t){return!((" "+t.className+" ").indexOf(" mousetrap ")>-1)&&(!function e(t,n){return null!==t&&t!==a&&(t===n||e(t.parentNode,n))}(t,this.target)&&("INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable))},b.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},b.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(u[t]=e[t]);s=null},b.init=function(){var e=b(a);for(var t in e)"_"!==t.charAt(0)&&(b[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},b.init(),r.Mousetrap=b,e.exports&&(e.exports=b),void 0===(i=function(){return b}.call(t,n,t,e))||(e.exports=i)}function f(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function p(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return u[e.which]?u[e.which]:l[e.which]?l[e.which]:String.fromCharCode(e.which).toLowerCase()}function g(e,t){return e.sort().join(",")===t.sort().join(",")}function m(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function v(e,t,n){return n||(n=function(){if(!s)for(var e in s={},u)e>95&&e<112||u.hasOwnProperty(e)&&(s[u[e]]=e);return s}()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function _(e,t){var n,i,r,a=[];for(n=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),r=0;r<n.length;++r)i=n[r],h[i]&&(i=h[i]),t&&"keypress"!=t&&c[i]&&(i=c[i],a.push("shift")),m(i)&&a.push(i);return{key:i,modifiers:a,action:t=v(i,a,t)}}function b(e){var t=this;if(e=e||a,!(t instanceof b))return new b(e);t.target=e,t._callbacks={},t._directMap={};var n,i={},r=!1,o=!1,s=!1;function u(e){e=e||{};var t,n=!1;for(t in i)e[t]?n=!0:i[t]=0;n||(s=!1)}function l(e,n,r,a,o,s){var u,l,c=[],h=r.type;if(!t._callbacks[e])return[];for("keyup"==h&&m(e)&&(n=[e]),u=0;u<t._callbacks[e].length;++u)if(l=t._callbacks[e][u],(a||!l.seq||i[l.seq]==l.level)&&h==l.action&&("keypress"==h&&!r.metaKey&&!r.ctrlKey||g(n,l.modifiers))){var d=!a&&l.combo==o,f=a&&l.seq==a&&l.level==s;(d||f)&&t._callbacks[e].splice(u,1),c.push(l)}return c}function c(e,n,i,r){t.stopCallback(n,n.target||n.srcElement,i,r)||!1===e(n,i)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(n),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(n))}function h(e){"number"!=typeof e.which&&(e.which=e.keyCode);var n=p(e);n&&("keyup"!=e.type||r!==n?t.handleKey(n,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):r=!1)}function d(e,t,a,o){function l(t){return function(){s=t,++i[e],clearTimeout(n),n=setTimeout(u,1e3)}}function h(t){c(a,t,e),"keyup"!==o&&(r=p(t)),setTimeout(u,10)}i[e]=0;for(var d=0;d<t.length;++d){var f=d+1===t.length?h:l(o||_(t[d+1]).action);v(t[d],f,o,e,d)}}function v(e,n,i,r,a){t._directMap[e+":"+i]=n;var o,s=(e=e.replace(/\s+/g," ")).split(" ");s.length>1?d(e,s,n,i):(o=_(e,i),t._callbacks[o.key]=t._callbacks[o.key]||[],l(o.key,o.modifiers,{type:o.action},r,e,a),t._callbacks[o.key][r?"unshift":"push"]({callback:n,modifiers:o.modifiers,action:o.action,seq:r,level:a,combo:e}))}t._handleKey=function(e,t,n){var i,r=l(e,t,n),a={},h=0,d=!1;for(i=0;i<r.length;++i)r[i].seq&&(h=Math.max(h,r[i].level));for(i=0;i<r.length;++i)if(r[i].seq){if(r[i].level!=h)continue;d=!0,a[r[i].seq]=1,c(r[i].callback,n,r[i].combo,r[i].seq)}else d||c(r[i].callback,n,r[i].combo);var f="keypress"==n.type&&o;n.type!=s||m(e)||f||u(a),o=d&&"keydown"==n.type},t._bindMultiple=function(e,t,n){for(var i=0;i<e.length;++i)v(e[i],t,n)},f(e,"keypress",h),f(e,"keydown",h),f(e,"keyup",h)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},inCG:function(e,t,n){"use strict";n.d(t,"b",function(){return M}),n.d(t,"a",function(){return E});var i,r,a=n("pVnL"),o=n.n(a),s=n("J4zp"),u=n.n(s),l=n("o0o1"),c=n.n(l),h=n("yXPU"),d=n.n(h),f=n("lSNA"),p=n.n(f),g=n("MVZn"),m=n.n(g),v=n("q1tI"),_=n("jGmp"),b=n("NpZ0"),S=n("0IOc");!function(e){e.INIT="INIT",e.CLOSE="CLOSE"}(r||(r={}));var y={isClosed:!1},x=Object(b.b)(y,(i={},p()(i,r.INIT,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){return m()({},e,{isClosed:t})}})}),p()(i,r.CLOSE,function(e){return m()({},e,{isClosed:!0})}),i)),C=function(e){return{type:r.INIT,payload:{effect:function(t){return t.CookieBag.get("sb_banner_closed")===e}}}},w=function(e,t){return{type:r.CLOSE,payload:{effect:function(){var n=d()(c.a.mark(function n(i){return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i.CookieBag.set("sb_banner_closed",e,{expires:new Date(t)});case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},T=function(e){var t=e.uid,n=e.endsAt,i=Object(S.a)(x,y),r=u()(i,2),a=r[0].isClosed,s=r[1];v.useEffect(function(){s(C(t))},[t]);return a?null:v.createElement(_.a,o()({},e,{onClickClose:function(){return s(w(t,n))}}))};t.c=T;var M=function(e){var t=e.ongoingBanner,n=void 0===t?{hasBanner:!1,banner:void 0}:t;return v.createElement(v.Fragment,null,n.hasBanner&&"small"===n.banner.size?v.createElement(T,n.banner):null)},E=function(e){var t=e.ongoingBanner,n=void 0===t?{hasBanner:!1,banner:void 0}:t;return v.createElement(v.Fragment,null,n.hasBanner&&"big"===n.banner.size?v.createElement(T,n.banner):null)}},ip6O:function(e,t,n){"use strict";var i,r=n("a3nb"),a=n("icjm"),o=n("WDex"),s=n("RwmW"),u=n("Qavt"),l=n("dhQu"),c=n("zP/P"),h=o.a.getOptionsURL().shaderStats?{}:void 0,d=o.a.getOptionsURL().syncCompile,f=new Uint8Array(4),p=function(e){e.flush(),e.finish(),e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,f)},g=/uniform\s+\w+\s+(\w+)((\s)?\[(.*?)\])?/g,m=/(in|attribute)\s+\w+\s+(\w+)\s*;/g,v=function(e,t){s.a.call(this),u.a.call(this),this._program=null,this._nullProgram=!0,this._vertex=void 0,this._fragment=void 0,this._uniformsCache=void 0,this._attributesCache=void 0,this._activeUniforms=void 0,this._foreignUniforms=void 0,this._trackAttributes=void 0,this._asyncCompilation=void 0,this._compileClean=void 0,e&&this.setVertexShader(e),t&&this.setFragmentShader(t),this._dirty=!0};v._sDeletedGLProgramCache=new window.Map,v.deleteGLProgram=function(e,t){v._sDeletedGLProgramCache.has(e)||v._sDeletedGLProgramCache.set(e,[]),v._sDeletedGLProgramCache.get(e).push(t)},v.flushDeletedGLPrograms=function(e,t){if(t<=0)return t;if(!v._sDeletedGLProgramCache.has(e))return t;for(var n=0,i=c.a.instance().tick(),r=v._sDeletedGLProgramCache.get(e),a=r.length-1;a>=0&&n<t;a--)e.deleteProgram(r[a]),r.splice(a,1),n=c.a.instance().deltaS(i,c.a.instance().tick());return t-n},v.flushAllDeletedGLPrograms=function(e){if(v._sDeletedGLProgramCache.has(e))for(var t=v._sDeletedGLProgramCache.get(e),n=t.length-1;n>=0;n--)e.deleteProgram(t[n]),t.splice(n,1)},v.onLostContext=function(e){v._sDeletedGLProgramCache.has(e)&&(v._sDeletedGLProgramCache.get(e).length=0)},r.a.createPrototypeStateAttribute(v,r.a.objectInherit(s.a.prototype,r.a.objectInherit(u.a.prototype,{attributeType:"Program",cloneType:function(){return new v},setVertexShader:function(e){this._vertex=e,this._nullProgram=!1,e.setText(l.a.processShader(e.getText()))},setFragmentShader:function(e){this._fragment=e,this._nullProgram=!1,e.setText(l.a.processShader(e.getText()))},getVertexShader:function(){return this._vertex},getFragmentShader:function(){return this._fragment},getProgram:function(){return this._program},setActiveUniforms:function(e){this._activeUniforms=e},getActiveUniforms:function(){return this._activeUniforms},setForeignUniforms:function(e){this._foreignUniforms=e},getForeignUniforms:function(){return this._foreignUniforms},setUniformsCache:function(e){this._uniformsCache=e},getUniformsCache:function(){return this._uniformsCache},setAttributesCache:function(e){this._attributesCache=e},getAttributesCache:function(){return this._attributesCache},setTrackAttributes:function(e){this._trackAttributes=e},getTrackAttributes:function(){return this._trackAttributes},releaseGLObjects:function(){void 0!==this._vertex&&this._vertex.releaseGLObjects(),void 0!==this._fragment&&this._fragment.releaseGLObjects(),null!==this._program&&(void 0!==this._gl&&(v.deleteGLProgram(this._gl,this._program),s.a.removeObject(this._gl,this)),this.invalidate())},dirty:function(){this._program=void 0},invalidate:function(){this._cacheUniformId=void 0,this._uniformsCache=void 0,this._attributesCache=void 0,this._foreignUniforms=void 0,this._trackAttributes=void 0,this._compileClean=void 0,this._program=void 0},_rebuildProgramFromSpector:function(e,t,n,i){this._dirty=!0,this._vertex.invalidate(),this._fragment.invalidate(),this.invalidate(),this._vertex.setText(e),this._fragment.setText(t),this._program=null,this._spectorOnCompiled=n,this._spectorOnError=i,this._compileClean=void 0},_onErrorToSpector:function(e){return!!this._spectorOnError&&(this._spectorOnError(e),!0)},_onCompilationToSpector:function(){this._spectorOnCompiled&&this._spectorOnCompiled(this._program)},_bindProgramToSpector:function(){window&&window.spector&&!this._program.__SPECTOR_rebuildProgram&&(this._program.__SPECTOR_rebuildProgram=this._rebuildProgramFromSpector.bind(this))},_logDebugShaders:function(e,t){if("Failed to create D3D shaders.\n"===t){var n=void 0!==e.rawgl?e.rawgl:e;void 0!==n&&void 0===n.getExtension&&(n=n.getExtension("WEBGL_debug_shaders"))&&(a.a.error(n.getTranslatedShaderSource(this._vertex.shader)),a.a.error(n.getTranslatedShaderSource(this._fragment.shader)))}},_activateFailSafe:function(e){var t=e.createProgram();this._vertex.failSafe(e,this._vertex.getText()),this._fragment.failSafe(e,this._fragment.getText()),this._glAttachAndLink(e,t,this._vertex,this._fragment),a.a.warn("FailSafe shader Activated "),this._program=t},_glAttachAndLink:function(e,t,n,i){e.attachShader(t,n.shader),e.attachShader(t,i.shader),e.linkProgram(t)},_glShaderCompile:function(e,t){t.shader||(h&&(t===this._vertex?h.vert=c.a.tick():h.frag=c.a.tick()),t.compile(e,i))},_glShaderCompilationResult:function(e,t){var n=t.getCompilationResult(e,i);return h&&(void 0===this._asyncCompilation&&p(e),t===this._vertex?h.vert=c.a.tick()-h.vert:h.frag=c.a.tick()-h.frag),n},compile:function(){var e=this._gl,t=this._fragment.getText(),n=this._vertex.getText();this._attributeMap=function(e){for(var t,n={};null!==(t=m.exec(e));)n[t[2]]=!0;return n}(n),this._uniformMap=function(e){for(var t,n={};null!==(t=g.exec(e));)n[t[1]]=!0;return n}(t+"\n"+n),this._glShaderCompile(e,this._vertex),this._glShaderCompile(e,this._fragment)},getShaderName:function(){if(this._shaderName)return this._shaderName;if(this._fragment&&this._fragment.getText()){var e=this._fragment.getText().match(/^#define\s+SHADER_NAME\s+(.*)$/m);return this._shaderName=e&&e[1]?e[1]:"",this._shaderName}},getCompilationResultAndLink:function(e){return!!this._compileClean||(h&&(h.vert=0,h.frag=0,h.link=0,h.total=0,void 0===this._asyncCompilation&&p(e),h.total=c.a.tick(),a.a.log(this.getShaderName()+" start"),a.a.timeStamp(this.getShaderName()+" start")),this._compileClean=this._glShaderCompilationResult(e,this._vertex),this._compileClean=this._glShaderCompilationResult(e,this._fragment)&&this._compileClean,h&&(a.a.log(this.getShaderName()+" compilation"),a.a.timeStamp(this.getShaderName()+" compilation")),!!this._compileClean&&(this._program=e.createProgram(),this._attributeMap.Vertex&&e.bindAttribLocation(this._program,0,"Vertex"),this._glAttachAndLink(e,this._program,this._vertex,this._fragment),!0))},getAsyncCompiling:function(){return this._asyncCompilation},_logShaderStats:function(e){if(void 0===this._asyncCompilation&&p(e),h.link=c.a.tick()-h.link,h.link){h.total=c.a.tick()-h.total,this._placeHolder&&(h.total=h.vert+h.frag+h.link);var t=(this._placeHolder?"Async":"")+this.getShaderName()+" - "+h.total.toFixed(2)+"ms";a.a.group(t),a.a.log("vertex : "+h.vert.toFixed(2)+"ms"),a.a.log("fragment : "+h.frag.toFixed(2)+"ms"),a.a.log("link : "+h.link.toFixed(2)+"ms"),a.a.log("total : "+h.total.toFixed(2)+"ms"),a.a.groupEnd(t)}},getLinkResult:function(e){if(this._compileClean){h&&(h.link=c.a.tick(),a.a.log(this.getShaderName()+" link"),a.a.timeStamp(this.getShaderName()+" link"));var t=e.getProgramParameter(this._program,e.LINK_STATUS);if(h&&this._logShaderStats(e),t||e.isContextLost())this._onCompilationToSpector(this._program);else{var n=e.getProgramInfoLog(this._program);if(a.a.errorFold(n,"can't link program\nvertex shader:\n"+this._vertex.text+"\n fragment shader:\n"+this._fragment.text),this._logDebugShaders(e,n),i&&i(this._vertex.text,this._fragment.text,n),this._compileClean=!1,this._onErrorToSpector(n))return}}return this._dirty=!1,this._asyncCompilation=-1,this._placeHolder=void 0,this._uniformsCache={},this._attributesCache={},this._compileClean?(this.cacheAttributeList(e,window.Object.keys(this._attributeMap)),this.cacheUniformList(e,window.Object.keys(this._uniformMap))):this._activateFailSafe(e),this._bindProgramToSpector(),this._compileClean},enableAsyncCompilation:function(e,t){this._placeHolder=e,this._asyncCompilation=t},apply:function(e){if(!this._nullProgram)if(this._gl||this.setGraphicContext(e.getGraphicContext()),!this._program||this._dirty)if(this._placeHolder)this._placeHolder.apply(e);else{if(this.compile(),d||-1===this._fragment.getText().indexOf("#pragma compilationAsync"))return this.getCompilationResultAndLink(this._gl),this.getLinkResult(this._gl),e.applyProgram(this._program),void(this._dirty=!1);this._asyncCompilation=1}else e.applyProgram(this._program)},cacheUniformList:function(e,t){for(var n=this._uniformsCache,i=0,r=t.length;i<r;i++){var a=t[i],o=e.getUniformLocation(this._program,a);void 0!==o&&null!==o&&void 0===n[a]&&(n[a]=o)}},cacheAttributeList:function(e,t){for(var n=this._attributesCache,i=0,r=t.length;i<r;i++){var a=t[i],o=e.getAttribLocation(this._program,a);-1!==o&&void 0!==o&&void 0===n[a]&&(n[a]=o)}}})),"osg","Program"),v.registerErrorCallback=function(e){i=e},t.a=v},ipT2:function(e,t,n){"use strict";(function(e){var i=n("QLQS"),r=n("Auie"),a=n("T1IQ"),o=n("AhqU"),s=n("4ANv"),u=n("JQdh"),l=n("UpON"),c=n("tvnS"),h=n("par7"),d=n("PRjJ"),f=i.a.osg,p=function(){c.a.apply(this,arguments),this._displayed=!1,l.a.getModelDisplayed().then(function(){this._displayed=!0}.bind(this)),this._pickMask={click:o.a.PICK_GEOMETRY_FAST,mousemove:o.a.PICK_GEOMETRY_FAST}};p.prototype=Object(d.a)(c.a.prototype,{addGlobalListener:function(e){u.a.getBoxReady().then(function(){a.a.initViewerAPI(this),this._getViewer().getInputManager().setEnable(s.a.SCENE_VIEWERAPI,!0)}.bind(this)),this._replayEmitter.subscribe(e)},intersectPoint:void 0,_emitEvents:function(){var e={viewerready:"viewerready",started:"viewerstart",stopped:"viewerstop",annotationFocus:"annotationFocus",annotationBlur:"annotationBlur",annotationMouseEnter:"annotationMouseEnter",annotationMouseLeave:"annotationMouseLeave",annotationSelect:"annotationSelect",nodeMouseEnter:"nodeMouseEnter",nodeMouseLeave:"nodeMouseLeave",click:"click",cameraStart:"camerastart",cameraStop:"camerastop"},t=function(t,n){var i=e[t];i&&this._replayEmitter.emit(i,n)}.bind(this);this._partial.on("all",t),this._partial.scene.on("all",t),this._emitEvents=function(){}},onCursorUp:function(){var e=f.vec3.create(),t=f.vec3.create(),n=f.vec2.create();return function(i){if(this._displayed){n[0]=i.canvasX,n[1]=i.canvasY;var a=r.a.computeNearestIntersection2D(n[0],n[1],this._pickMask.click),o={position3D:null,position2D:n,normal:null,instanceID:null,material:null};if(a){r.a.getWorldPositionFromHit(a,t,e);var s=this._getFeatureModel("material").findFirstMaterial(a._nodePath);o.normal=e,o.position3D=t,o.instanceID=this._getHitNodeID(a),o.material=s?s.getJSON():null,this._replayEmitter.emit("click",o)}else this._replayEmitter.emit("click",o)}}}(),onMouseMove:function(){var e,t,n=f.vec3.create(),i=f.vec3.create(),a=f.vec2.create();return function(o){if(this._displayed){a[0]=o.canvasX,a[1]=o.canvasY;var s=r.a.computeNearestIntersection2D(a[0],a[1],this._pickMask.click);if(s){r.a.getWorldPositionFromHit(s,i,n);var u=this._getHitNodeID(s),l=this._getFeatureModel("material").findFirstMaterial(s._nodePath);if(t===u)return;return t&&this._replayEmitter.emit("nodeMouseLeave",{position3D:null,position2D:null,normal:n,instanceID:t,material:e}),t=u,e=l?l.getJSON():null,void this._replayEmitter.emit("nodeMouseEnter",{position3D:i,position2D:a,normal:n,instanceID:t,material:e})}t&&(this._replayEmitter.emit("nodeMouseLeave",{position3D:i,position2D:a,normal:n,instanceID:t,material:e}),t=void 0,e=void 0)}}}(),setListenerOptions:function(e){if(e&&"function"!=typeof e)switch(e.name){case"click":this._pickMask.click="slow"===e.pick?o.a.PICK_GEOMETRY_SLOW:o.a.PICK_GEOMETRY_FAST;break;case"nodeMouseEnter":case"nodeMouseLeave":this._pickMask.mousemove="slow"===e.pick?o.a.PICK_GEOMETRY_SLOW:o.a.PICK_GEOMETRY_FAST}},pickColor:function(){var t=new Uint8Array(4);return function(n,i){new e(function(e,i){var r=this._getViewerOSG().getCamera();r.setFinalDrawCallback(function(a){var o=a.getGraphicContext();if(o.checkFramebufferStatus(o.FRAMEBUFFER)===o.FRAMEBUFFER_COMPLETE){o.flush(),o.finish();var s=n[0]*(o.drawingBufferWidth/o.canvas.clientWidth),u=o.drawingBufferHeight*(1-n[1]/o.canvas.clientHeight);o.readPixels(s,u,1,1,o.RGBA,o.UNSIGNED_BYTE,t),e(t),r.setFinalDrawCallback(void 0)}else i()})}.bind(this)).then(function(){i(t)})}}(),unselectAnnotation:function(e){this.gotoAnnotation(-1,e)},requestRedraw:function(){h.a.redrawShadow()}}),t.a=p}).call(this,n("CSL1"))},irww:function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/popovers.jinja"]={root:function(e,t,n,i,r){var a="";try{var o=i.makeMacro([],["options"],function(r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var o="";return o+='\n\n    <div class="popover share-popover hidden',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"class")&&(o+=" ",o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"class"),e.opts.autoescape)),o+='">\n        <p>Thanks! Also share?</p>\n\n        <a data-action="share-on-facebook" class="share-popover-icon icons-facebook"></a>\n        <a data-action="share-on-twitter" class="share-popover-icon icons-twitter"></a>\n        <a data-action="share-on-pinterest" class="share-popover-icon icons-pinterest"></a>\n    </div>\n\n',n=a,new i.SafeString(o)});t.addExport("share_popover"),t.setVariable("share_popover",o),r(null,a+="\n")}catch(e){r(i.handleError(e,null,null))}}}},iz85:function(e,t,n){e.exports=n.p+"static/assets/images/viewer/cardboard-instructions-c04f2ea47a37bada5956a3e0acd288d3.svg"},j3Bp:function(e,t,n){"use strict";(function(e){var i=n("12sq"),r=n("YfG3"),a=n("u3oV"),o=n("hbEN"),s=n("MG+9"),u=n("q1z7"),l=n.n(u),c=n("P9l5"),h=n("yktj"),d=n("RzKY"),f=n("r28r"),p=n("BB+9"),g=n("9mpE"),m=n("Ui7z"),v=n("89mf"),_=n("prpr"),b=n("TYgF"),S=Object(c.a)(["initialize"])(l.a.Collection);t.a=S.extend({mixins:[b.b],optionsTypes:{offset:b.a.number,pageSize:b.a.number,paginationType:b.a.oneOf(["cursor","offset"]),lastPage:b.a.number,firstPage:b.a.number,minOffset:b.a.number,maxOffset:b.a.number,cursor:b.a.shape({previous:b.a.string,next:b.a.string})},defaultOptions:function(){return{pageSize:i.a.apiPageSize,paginationType:"cursor",offset:0,minOffset:0,maxOffset:1/0,cursor:{previous:null}}},backend:h.a,previousPromise:e.resolve(),constructor:function(){this.options=Object(r.a)({},this.defaultOptions(),Object(a.a)(arguments[1]||{},function(e){return void 0!==e})),S.apply(this,arguments)},initialize:function(){this.options.backend&&(this.backend=this.options.backend),this._loading="none",Object(_.a)("add","afterAdd",this),Object(_.a)("remove","afterRemove",this),this.triggerAfterRequest=Object(o.a)(this.triggerAfterRequest.bind(this),20),this.initializePagination(),S.prototype.initialize.apply(this,arguments)},at:function(e){return e<0?void 0:S.prototype.at.call(this,e)},domain:function(){return Object(s.a)(this.backend,"domain")},parse:function(e){return this.backend.parse(e)},queryParams:function(){return this.isCursorPagination()?{cursor:this._currentCursor,count:Object(s.a)(this.options,"pageSize")}:{offset:this.options.offset,count:Object(s.a)(this.options,"pageSize")}},url:function(){var e=Object(s.a)(this,"domain")+Object(s.a)(this,"endpoint")+g.c.craft("?",this.queryParams());return e=e.replace(/(?!^)\/{2,}/g,"/")},fetch:function(){this.triggerBeforeRequest();var t=this.previousPromise;return this.previousPromise=e.resolve(S.prototype.fetch.apply(this,arguments)).then(function(e){return Object(d.i)(1e3,t).catch(v.d).then(function(){return e})}),this.previousPromise.then(function(t){return this.previousPromise=e.resolve(),this.triggerAfterRequest(t),t}.bind(this))},reset:function(){S.prototype.reset.apply(this,arguments),this.pagination.reset()},triggerBeforeRequest:function(){this.trigger("beforeRequest")},triggerAfterRequest:function(e){this.trigger("afterRequest",e)},isCursorPagination:function(){return"cursor"===this.pagination.type},initializePagination:function(){"offset"===this.options.paginationType?this._initializeOffsetPagination():this._initializeCursorPagination()},_initializeCursorPagination:function(){var t=this.options.cursor;this.pagination=Object(p.a)(t,function(t,n){return this._currentCursor=t,e.resolve(this.fetch(Object(r.a)({},n,{reset:!1,add:!1,remove:!1})))}.bind(this))},_initializeOffsetPagination:function(){var t={lastPage:this.options.lastPage,firstPage:this.options.firstPage};this.pagination=Object(f.a)(t,function(t,n){return this.options.offset=this.options.minOffset+Object(s.a)(this.options,"pageSize")*t,e.resolve(this.fetch(Object(r.a)({},n,{reset:!1,add:!1,remove:!1})))}.bind(this))},loadPreviousPage:function(e){var t=this;this.setLoading("previous");var n=e||{};return this.pagination.loadPrevious(n).then(function(e){var i=t.parse(e);return n.setPrevious&&n.setNext?t.set(i):t.add(i,{at:0}),t.setLoading("none"),i}).catch(function(e){throw t.setLoading("none"),e})},loadNextPage:function(e){var t=this;this.setLoading("next");var n=e||{};return this.pagination.loadNext(n).then(function(e){var i=t.parse(e);return n.setPrevious&&n.setNext?t.set(i):t.add(i),t.setLoading("none"),i}).catch(function(e){throw t.setLoading("none"),e})},loadFirstPage:function(e){var t=this;return this.setLoading("refresh"),this.pagination.loadFirst(e||{}).then(function(e){var n=t.parse(e);return n.length||t.trigger("empty"),t.set(n),t.setLoading("none"),n}).catch(function(e){throw t.setLoading("none"),e})},loadLatestItems:function(){var e=this;return this.setLoading("refresh"),this.pagination.loadFirst({allowPrefetching:!1}).then(function(t){var n=e.parse(t);return e.add(n,{at:0}),e.setLoading("none"),n}).catch(function(t){throw e.setLoading("none"),t})},hasPreviousPage:function(){return this.pagination.hasPrevious()},hasNextPage:function(){return this.pagination.hasNext()},setLoading:function(e){this._loading=e,this.trigger("loadingChanged",e)},loading:function(){return this._loading},isLoading:function(){return"none"!==this._loading}},{extend:function(e,t){var n=Object(r.a)({},e,{defaultOptions:Object(m.h)(Object(v.g)(this.prototype.defaultOptions||{}),Object(v.g)(e.defaultOptions||{})),optionTypes:Object(r.a)({},this.prototype.optionTypes||{},e.optionTypes||{})});return S.extend.call(this,n,t)}})}).call(this,n("CSL1"))},j6Sw:function(e,t){e.exports="#extension GL_OES_standard_derivatives : enable\n\n%UNROLL 4%\n#ifdef HAS_SHADOW_%ID%\n    uniform float uShadowReceive%ID%_bias;\n    uniform float uStaticFrameNumShadow%ID%;\n    uniform vec2 uShadow_Texture%ID%_depthRange;\n    uniform vec3 uShadow_Texture%ID%_projection;\n    uniform vec4 uShadow_Texture%ID%_viewLook;\n    uniform vec4 uShadow_Texture%ID%_viewRight;\n    uniform vec4 uShadow_Texture%ID%_viewUp;\n\n    #ifdef _ATLAS_SHADOW\n        uniform vec4 uShadow_Texture%ID%_mapSize;\n    #else\n        uniform vec2 uShadow_Texture%ID%_renderSize;\n    #endif\n#endif // HAS_SHADOW\n%%\n\n// TODO rename sampler uniform to be better and sync with light number (e.g: sShadow0, sShadow1, etc)\n#ifdef _ATLAS_SHADOW\n    uniform vec2 uShadow_Texture0_renderSize;\n    uniform sampler2D Texture7;\n#else\n    #ifdef HAS_SHADOW_0\n        uniform sampler2D Texture12;\n        #define TEX_SHADOW_0 Texture12\n    #endif\n    #ifdef HAS_SHADOW_1\n        uniform sampler2D Texture13;\n        #define TEX_SHADOW_1 Texture13\n    #endif\n    #ifdef HAS_SHADOW_2\n        uniform sampler2D Texture14;\n        #define TEX_SHADOW_2 Texture14\n    #endif\n    #ifdef HAS_SHADOW_3\n        uniform sampler2D Texture15;\n        #define TEX_SHADOW_3 Texture15\n    #endif\n#endif // _ATLAS_SHADOW\n\n#ifdef _OUT_DISTANCE\n#define OPT_ARG_outDistance ,out float outDistance\n#define OPT_INSTANCE_ARG_outDistance ,outDistance\n#else\n#define OPT_ARG_outDistance\n#define OPT_INSTANCE_ARG_outDistance\n#endif\n\n#ifdef _ATLAS_SHADOW\n#define OPT_ARG_atlasSize ,const in vec4 atlasSize\n#else\n#define OPT_ARG_atlasSize\n#endif\n\n#ifdef _NORMAL_OFFSET\n#define OPT_ARG_normalBias ,const in float normalBias\n#else\n#define OPT_ARG_normalBias\n#endif\n\n#ifdef _JITTER_OFFSET\n#define OPT_ARG_jitter ,const in float jitter\n#define OPT_INSTANCE_ARG_jitter ,jitter\n#else\n#define OPT_ARG_jitter\n#define OPT_INSTANCE_ARG_jitter\n#endif\n\n#pragma include \"shadowing/tapPCF.glsl\"\n\nfloat shadowReceive(const in bool lighted,\n                    const in vec3 normalWorld,\n                    const in vec3 vertexWorld,\n\n                    const in sampler2D shadowTexture,\n\n                    const in vec2 shadowSize,\n                    const in vec3 shadowProjection,\n\n                    const in vec4 shadowViewRight,\n                    const in vec4 shadowViewUp,\n                    const in vec4 shadowViewLook,\n\n\n                    const in vec2 shadowDepthRange,\n                    const in float shadowBias\n                    OPT_ARG_atlasSize\n                    OPT_ARG_normalBias\n                    OPT_ARG_outDistance\n                    OPT_ARG_jitter) {\n\n    // 0 for early out\n    bool earlyOut = false;\n\n    // Calculate shadow amount\n    float shadow = 1.0;\n\n    if (!lighted) {\n        shadow = 0.0;\n#ifndef _OUT_DISTANCE\n        earlyOut = true;\n#endif // _OUT_DISTANCE\n    }\n\n    if (shadowDepthRange.x == shadowDepthRange.y) {\n        earlyOut = true;\n    }\n\n    vec4 shadowVertexEye;\n    vec4 shadowNormalEye;\n    float shadowReceiverZ = 0.0;\n    vec4 shadowVertexProjected;\n    vec2 shadowUV;\n    float N_Dot_L;\n    float invDepthRange;\n\n    if (!earlyOut) {\n\n        shadowVertexEye.x = dot(shadowViewRight.xyz, vertexWorld.xyz) + shadowViewRight.w;\n        shadowVertexEye.y = dot(shadowViewUp.xyz, vertexWorld.xyz) + shadowViewUp.w;\n        shadowVertexEye.z = dot(shadowViewLook.xyz, vertexWorld.xyz) + shadowViewLook.w;\n        shadowVertexEye.w = 1.0;\n\n\n        // derivated, only need z.\n        //vec3 shadowLightDir = vec3(0.0, 0.0, 1.0); // in shadow view light is camera\n        //shadowNormalEye =  shadowViewMatrix * normalFront;\n        //shadowNormalEye.x = dot(shadowViewRight.xyz, normalWorld.xyz);\n        //shadowNormalEye.y = dot(shadowViewUp.xyz, normalWorld.xyz);\n        shadowNormalEye.z = dot(shadowViewLook.xyz, normalWorld.xyz);\n        //shadowNormalEye.w = 0.0;\n\n        //N_Dot_L = dot(shadowNormalEye.xyz, shadowLightDir);\n        N_Dot_L = shadowNormalEye.z;\n\n        if (!earlyOut) {\n\n            invDepthRange = 1.0 / (shadowDepthRange.y - shadowDepthRange.x);\n\n#ifdef _NORMAL_OFFSET\n\n            // http://www.dissidentlogic.com/old/images/NormalOffsetShadows/GDC_Poster_NormalOffset.png\n            float normalOffsetScale = clamp(1.0  - N_Dot_L, 0.0 , 1.0);\n            normalOffsetScale *= abs((shadowVertexEye.z - shadowDepthRange.x) * invDepthRange);\n            normalOffsetScale *= max(shadowProjection.x, shadowProjection.y);\n            normalOffsetScale *= normalBias * invDepthRange;\n\n\n            vec4 shadowNormalShift =  vec4(normalWorld, 0.0) * normalOffsetScale;\n            shadowNormalEye.x = dot(shadowViewRight.xyz, shadowNormalShift.xyz);\n            shadowNormalEye.y = dot(shadowViewUp.xyz, shadowNormalShift.xyz);\n            shadowNormalEye.z = dot(shadowViewLook.xyz, shadowNormalShift.xyz);\n            shadowNormalEye.w = 0.0;\n\n            vec4 viewShadow = shadowVertexEye + shadowNormalEye;\n#else\n            vec4 viewShadow = shadowVertexEye;\n#endif\n\n\n            if (shadowProjection.z == 0.0){\n\n               // X, 0, 0, 0,\n               // 0, Y, 0, 0,\n               // 0, 0, -1, -1,\n               // 0, 0, -2.0*znear, 0\n               // mat4 shadowProjectionMatrix;\n               // shadowProjectionMatrix[0] = vec4(shadowProjection.x, 0.0, 0.0, 0.0 );\n               // shadowProjectionMatrix[1] = vec4(0.0, shadowProjection.y, 0.0, 0.0 );\n               // shadowProjectionMatrix[2] = vec4(0.0, 0.0, -1.0, -1.0 );\n               // shadowProjectionMatrix[3] = vec4(0.0, 0.0, -2.0*shadowDepthRange.x, 0.0 );\n               // shadowVertexProjected = shadowProjectionMatrix * shadowVertexEye;\n\n               // derivated optimisation\n               shadowVertexProjected.x = shadowProjection.x * viewShadow.x;\n               shadowVertexProjected.y = shadowProjection.y * viewShadow.y;\n\n               shadowVertexProjected.z = - viewShadow.z - (2.0 * shadowDepthRange.x * viewShadow.w);\n               shadowVertexProjected.w = - viewShadow.z;\n\n            }\n            else{\n                // lr = 1/(left-right);\n                // bt = 1/(bottom-top);\n                // nf = 1/(near-far);\n                // -2*lr,           0,               0,              0,\n                // 0,               -2*bt,           0,              0,\n                // 0,               0,               2*nf,           0.0,\n                // (left+right)*lr, (top+bottom)*bt, (far+near)*nf), 1\n                // here left = -right && top = -bottom\n                // float lr = 1.0 / (-2.0 * shadowProjection.x);\n                // float bt = 1.0 / (-2.0 * shadowProjection.y);\n                // float nf = 1.0 / (shadowDepthRange.x - shadowDepthRange.y);\n                float nfNeg = 1.0 / (shadowDepthRange.x - shadowDepthRange.y);\n                float nfPos = (shadowDepthRange.x + shadowDepthRange.y)*nfNeg;\n\n                //mat4 shadowProjectionMatrix;\n                //shadowProjectionMatrix[0] = vec4(1.0 / shadowProjection.x, 0.0,     0.0,  0.0 );\n                //shadowProjectionMatrix[1] = vec4(0.0,     1.0 / shadowProjection.y, 0.0,  0.0 );\n                //shadowProjectionMatrix[2] = vec4(0.0,     0.0, 2.0*nfNeg, 0.0 );\n                //shadowProjectionMatrix[3] = vec4(0.0,     0.0, nfPos, 1.0 );\n                //shadowdertexProjected = shadowProjectionMatrix * shadowVertexEye;\n\n                // derivated optimisation\n                shadowVertexProjected.x = viewShadow.x / shadowProjection.x;\n                shadowVertexProjected.y = viewShadow.y / shadowProjection.y;\n\n                shadowVertexProjected.z = 2.0 * nfNeg* viewShadow.z + nfPos * viewShadow.w;\n                shadowVertexProjected.w = viewShadow.w;\n\n            }\n\n\n            if (shadowVertexProjected.w < 0.0) {\n                earlyOut = true; // notably behind camera\n            }\n\n        }\n\n        if (!earlyOut) {\n\n            shadowUV.xy = shadowVertexProjected.xy / shadowVertexProjected.w;\n            shadowUV.xy = shadowUV.xy * 0.5 + 0.5;// mad like\n\n            if (any(bvec4 ( shadowUV.x > 1., shadowUV.x < 0., shadowUV.y > 1., shadowUV.y < 0.))) {\n                earlyOut = true;// limits of light frustum\n            }\n\n            // most precision near 0, make sure we are near 0 and in [0,1]\n            shadowReceiverZ = - shadowVertexEye.z;\n            shadowReceiverZ =  (shadowReceiverZ - shadowDepthRange.x) * invDepthRange;\n\n            if(shadowReceiverZ < 0.0) {\n                earlyOut = true; // notably behind camera\n            }\n\n        }\n    }\n\n    // pcf pbias to add on offset\n    vec2 shadowBiasPCF = vec2 (0.);\n\n#ifdef GL_OES_standard_derivatives\n#ifdef _RECEIVERPLANEDEPTHBIAS\n    vec2 biasUV;\n\n    vec3 texCoordDY = dFdx(shadowVertexEye.xyz);\n    vec3 texCoordDX = dFdy(shadowVertexEye.xyz);\n\n    biasUV.x = texCoordDY.y * texCoordDX.z - texCoordDX.y * texCoordDY.z;\n    biasUV.y = texCoordDX.x * texCoordDY.z - texCoordDY.x * texCoordDX.z;\n    biasUV *= 1.0 / ((texCoordDX.x * texCoordDY.y) - (texCoordDX.y * texCoordDY.x));\n\n    // Static depth biasing to make up for incorrect fractional sampling on the shadow map grid\n    float fractionalSamplingError = dot(vec2(1.0, 1.0) * shadowSize.xy, abs(biasUV));\n    float receiverDepthBias = min(fractionalSamplingError, 0.01);\n\n    shadowBiasPCF.x = biasUV.x;\n    shadowBiasPCF.y = biasUV.y;\n\n    shadowReceiverZ += receiverDepthBias;\n\n#else // _RECEIVERPLANEDEPTHBIAS\n    shadowBiasPCF.x = clamp(dFdx(shadowReceiverZ) * shadowSize.x, -1.0, 1.0 );\n    shadowBiasPCF.y = clamp(dFdy(shadowReceiverZ) * shadowSize.y, -1.0, 1.0 );\n#endif\n\n#endif // GL_OES_standard_derivatives\n\n\n    vec4 clampDimension;\n\n#ifdef _ATLAS_SHADOW\n    shadowUV.xy  = ((shadowUV.xy * atlasSize.zw ) + atlasSize.xy) * shadowSize.xy;\n\n    // clamp uv bias/filters by half pixel to avoid point filter on border\n    clampDimension.xy = atlasSize.xy + vec2(0.5);\n    clampDimension.zw = (atlasSize.xy + atlasSize.zw) - vec2(0.5);\n\n    clampDimension = clampDimension * shadowSize.xyxy;\n#else\n    clampDimension = vec4(0.0, 0.0, 1.0, 1.0);\n#endif // _RECEIVERPLANEDEPTHBIAS\n\n\n    // now that derivatives is done and we don't access any mipmapped/texgrad texture we can early out\n    // see http://teknicool.tumblr.com/post/77263472964/glsl-dynamic-branching-and-texture-samplers\n    if (earlyOut) {\n        // empty statement because of weird gpu intel bug\n    } else {\n\n        // depth bias: fighting shadow acne (depth imprecsion z-fighting)\n        // cosTheta is dot( n, l ), clamped between 0 and 1\n        // float shadowBias = 0.005*tan(acos(N_Dot_L));\n        // same but 4 cycles instead of 15\n        float depthBias = 0.05 * sqrt( 1.0 - N_Dot_L * N_Dot_L) / clamp(N_Dot_L, 0.0005, 1.0);\n\n        // That makes sure that plane perpendicular to light doesn't flicker due to\n        // selfshadowing and 1 = dot(Normal, Light) using a min bias\n        depthBias = clamp(depthBias, 0.00005, 2.0 * shadowBias);\n\n        // shadowZ must be clamped to [0,1]\n        // otherwise it's not comparable to shadow caster depth map\n        // which is clamped to [0,1]\n        // Not doing that makes ALL shadowReceiver > 1.0 black\n        // because they ALL becomes behind any point in Caster depth map\n        shadowReceiverZ = clamp(shadowReceiverZ, 0.0, 1.0 -depthBias) - depthBias;\n\n        // Now computes Shadow\n        float res = getShadowPCF(shadowTexture,\n                                 shadowSize,\n                                 shadowUV,\n                                 shadowReceiverZ,\n                                 shadowBiasPCF,\n                                 clampDimension\n                                 OPT_INSTANCE_ARG_outDistance\n                                 OPT_INSTANCE_ARG_jitter);\n#ifdef _OUT_DISTANCE\n        if (lighted) shadow = res;\n        outDistance *= shadowDepthRange.y - shadowDepthRange.x; // world space distance\n#else\n        shadow = res;\n#endif  // _OUT_DISTANCE\n    }\n\n    return shadow;\n\n}\n"},jA0E:function(e,t,n){"use strict";var i=n("cDf5"),r=n.n(i),a=n("EVdn"),o=n.n(a),s=n("tNdj"),u=n("vIRb"),l=n("UIJo"),c=n("12sq");t.a=s.a.extend({save:function(e,t){null!=e&&"object"!==r()(e)||(t=e);var n=new FormData;return n.append("imageFile",this.get("imageFile")),n.append("modelUid",t.modelUID),o.a.ajax({url:this.url(),data:n,processData:!1,contentType:!1,type:"POST"})},endpoint:function(){return"/backgrounds".concat(this.isNew()?"":"/".concat(this.get("uid")))}},Object(l.a)({fileTypes:c.a.backgroundFiletypes,maxFileSize:c.a.maxBackgroundFilesize})).extend(u.a)},jGmp:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),a=n("gcR/"),o=n.n(a),s=n("lSNA"),u=n.n(s),l=n("QILm"),c=n.n(l),h=n("q1tI"),d=n("wsGC"),f=n("J4zp"),p=n.n(f);var g=function(e,t){var n=Object(h.useRef)(e);Object(h.useEffect)(function(){n.current=e},[e]),Object(h.useEffect)(function(){if(null!==t){var e=setInterval(function(){n.current()},t);return function(){return clearInterval(e)}}},[t])},m=n("IOyo"),v=function(e){var t=Object(h.useState)(Object(m.d)(e)),n=p()(t,2),i=n[0],r=n[1];return g(function(){r(Object(m.d)(e))},1e3),i},_=function(e){var t=e.value,n=e.label;return o()("div",{className:"c-calendar-countdown__page"},void 0,o()("div",{className:"c-calendar-countdown__page-value"},void 0,t),o()("div",{className:"c-calendar-countdown__page-label"},void 0,n))},b=function(e){var t=e.endsAt,n=e.className,i=c()(e,["endsAt","className"]),a=v(t);return a?h.createElement("div",r()({className:Object(d.a)("c-calendar-countdown",n)},i),o()(_,{value:a.days,label:"days"}),o()(_,{value:a.hours,label:"hrs"}),o()(_,{value:a.mins,label:"mins"}),o()(_,{value:a.secs,label:"secs"})):null},S=o()("div",{className:"c-calendar-countdown__page-value"},void 0,""),y=function(e){var t=e.label;return o()("div",{className:"c-calendar-countdown__page"},void 0,S,o()("div",{className:"c-calendar-countdown__page-label"},void 0,t))},x=o()(y,{label:"days"}),C=o()(y,{label:"hrs"}),w=o()(y,{label:"mins"}),T=o()(y,{label:"secs"}),M=function(e){var t=e.className,n=c()(e,["className"]);return h.createElement("div",r()({className:Object(d.a)("c-calendar-countdown",t)},n),x,C,w,T)},E=function(e){var t=e.endsAt,n=e.className,i=c()(e,["endsAt","className"]),a=v(t);return a?h.createElement("div",r()({className:Object(d.a)("c-text-countdown",n)},i),"Ends in ",o()("strong",{},void 0,a.days),"d ",o()("strong",{},void 0,a.hours),"hrs"," ",o()("strong",{},void 0,a.mins),"mins ",o()("strong",{},void 0,a.secs),"secs"):null},A=function(e){var t=e.className,n=c()(e,["className"]);return h.createElement("div",r()({className:Object(d.a)("c-text-countdown",t)},n),"Ends in ...")},O=n("ei2W"),R=o()("i",{className:"icon fa fa-shopping-cart"});t.a=function(e){var t,n=e.title,i=e.description,a=e.ctaTitle,s=e.ctaUrl,l=e.endsAt,f=e.size,p=e.theme,g=e.hasCounter,m=e.onClickClose,v=e.responsiveClass,_=void 0===v?"":v,S=e.showCta,y=c()(e,["title","description","ctaTitle","ctaUrl","endsAt","size","theme","hasCounter","onClickClose","responsiveClass","showCta"]),x="big"===f?b:E,C="big"===f?M:A;return h.createElement("div",r()({className:Object(d.a)("c-banner",(t={},u()(t,"--".concat(p),!!p),u()(t,"--".concat(f),!!f),u()(t,_,!!_),t))},y),o()("div",{className:Object(d.a)("c-banner__content",{container:"small"===f})},void 0,o()("div",{className:"c-banner__info"},void 0,o()("div",{className:"c-banner__title"},void 0,n),o()("div",{className:"c-banner__description",dangerouslySetInnerHTML:{__html:i}})),o()("div",{className:"c-banner__action"},void 0,g&&o()(O.a,{fallback:o()(C,{className:Object(d.a)("c-banner__countdown",u()({},"--".concat(p),!!p))})},void 0,function(){return o()(x,{className:Object(d.a)("c-banner__countdown",u()({},"--".concat(p),!!p)),endsAt:l})}),S&&o()("a",{href:s,target:"store"!==p?"_blank":"_self",className:Object(d.a)("button c-banner__cta","big"===f?"btn-large":"btn-medium","store"===p?"btn-store":"btn-primary")},void 0,"store"===p&&R,a)),o()("button",{className:"c-banner__close","aria-label":"Close promotional banner"},void 0,o()("i",{className:"icon fa fa-times",onClick:m}))))}},jPMi:function(e,t,n){"use strict";var i=n("YfG3"),r=function(e){this._views=[],e&&(this._name=e.FeatureName,this._modelName=e.ModelName,this._modelType=e.ModelType,this._viewListType=e.ViewListType.slice(0))};r.prototype={getName:function(){return this._name},getModel:function(){return this._model},addView:function(e){e&&this._views.push(e)},init:function(e){if(this._model||(this._model=e.getModelByName(this._modelName)),!this._model){var t=this._modelType;this._model=new t,this._model.init&&this._model.init(e)}this._viewListType.forEach(function(t){(function(t){var n=new t({model:this._model,context:e});this.addView(n)}).call(this,t)},this),e.addFeature(this)},prepareForScreenShot:function(){var e=this.getWidgetNode();return!(!e||!e.getNodeMask())&&(this._oldMaskEditorWidget=e.getNodeMask(),e.setNodeMask(0),!0)},resetAfterScreenShot:function(){var e=this.getWidgetNode();e&&e.setNodeMask(this._oldMaskEditorWidget)},getWidgetNode:function(){}},r.create=function(e){var t=function(){r.call(this,t)};return t.prototype=Object(i.a)({},r.prototype),Object(i.a)(t,e),t.getName=function(){return e.FeatureName},t},t.a=r},jTTs:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Qavt"),a=function(e){r.a.call(this),this.setMode(void 0!==e?e:a.BACK)};a.DISABLE=0,a.FRONT=1028,a.BACK=1029,a.FRONT_AND_BACK=1032,i.a.createPrototypeStateAttribute(a,i.a.objectInherit(r.a.prototype,{attributeType:"CullFace",cloneType:function(){return new a},setMode:function(e){var t=e;"string"==typeof t&&(t=a[t]),this._mode=t},getMode:function(){return this._mode},apply:function(e){e.applyCullFace(this)}}),"osg","CullFace"),t.a=a},"jWd+":function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/layouts/popup.jinja"]={b_popup_header:function(e,t,n,i,r){var a="";try{n=n.push(!0),a+='\n                <div class="',a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupTitleStyle"),e.opts.autoescape),a+='">\n                    ',a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupTitle"),e.opts.autoescape),r(null,a+="\n                </div>\n            ")}catch(e){r(i.handleError(e,null,null))}},b_popup_content:function(e,t,n,i,r){var a="";try{n=n.push(!0),r(null,a+="\n            ")}catch(e){r(i.handleError(e,null,null))}},b_popup_footer:function(e,t,n,i,r){var a="";try{n=n.push(!0),r(null,a+="\n                ")}catch(e){r(i.handleError(e,null,null))}},root:function(e,t,n,i,r){var a="";try{var o,s,u,l,c,h,d,f,p,g,m,v,_,b;i.contextOrFrameLookup(t,n,"isWhiteBackground")?(a+="\n    ",o="c-popup c-popup__container",n.set("popupStyle",o,!0),n.topLevel&&t.setVariable("popupStyle",o),n.topLevel&&t.addExport("popupStyle",o),a+="\n    ",s="c-popup__header",n.set("popupHeaderStyle",s,!0),n.topLevel&&t.setVariable("popupHeaderStyle",s),n.topLevel&&t.addExport("popupHeaderStyle",s),a+="\n    ",u="c-popup__title",n.set("popupTitleStyle",u,!0),n.topLevel&&t.setVariable("popupTitleStyle",u),n.topLevel&&t.addExport("popupTitleStyle",u),a+="\n    ",l="c-popup__actions",n.set("popupActionsStyle",l,!0),n.topLevel&&t.setVariable("popupActionsStyle",l),n.topLevel&&t.addExport("popupActionsStyle",l),a+="\n    ",c="c-popup__close",n.set("popupCloseStyle",c,!0),n.topLevel&&t.setVariable("popupCloseStyle",c),n.topLevel&&t.addExport("popupCloseStyle",c),a+="\n    ",h="c-popup__content",n.set("popupContentStyle",h,!0),n.topLevel&&t.setVariable("popupContentStyle",h),n.topLevel&&t.addExport("popupContentStyle",h),a+="\n    ",d="c-popup__footer",n.set("popupFooterStyle",d,!0),n.topLevel&&t.setVariable("popupFooterStyle",d),n.topLevel&&t.addExport("popupFooterStyle",d),a+="\n"):(a+="\n    ",f="popup",n.set("popupStyle",f,!0),n.topLevel&&t.setVariable("popupStyle",f),n.topLevel&&t.addExport("popupStyle",f),a+="\n    ",p="popup-header",n.set("popupHeaderStyle",p,!0),n.topLevel&&t.setVariable("popupHeaderStyle",p),n.topLevel&&t.addExport("popupHeaderStyle",p),a+="\n    ",g="popup-title",n.set("popupTitleStyle",g,!0),n.topLevel&&t.setVariable("popupTitleStyle",g),n.topLevel&&t.addExport("popupTitleStyle",g),a+="\n    ",m="popup-actions",n.set("popupActionsStyle",m,!0),n.topLevel&&t.setVariable("popupActionsStyle",m),n.topLevel&&t.addExport("popupActionsStyle",m),a+="\n    ",v="popup-close",n.set("popupCloseStyle",v,!0),n.topLevel&&t.setVariable("popupCloseStyle",v),n.topLevel&&t.addExport("popupCloseStyle",v),a+="\n    ",_="popup-content",n.set("popupContentStyle",_,!0),n.topLevel&&t.setVariable("popupContentStyle",_),n.topLevel&&t.addExport("popupContentStyle",_),a+="\n    ",b="popup-footer",n.set("popupFooterStyle",b,!0),n.topLevel&&t.setVariable("popupFooterStyle",b),n.topLevel&&t.addExport("popupFooterStyle",b),a+="\n"),a+='\n\n<div class="popup-container',i.contextOrFrameLookup(t,n,"popupNeedsLoading")&&(a+=" popup-loading"),a+=" ",a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupClass"),e.opts.autoescape),a+='">\n    <form class="',a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupStyle"),e.opts.autoescape),a+=' js-popup" method="post"',i.contextOrFrameLookup(t,n,"allowAutocomplete")||(a+=' autocomplete="off"'),a+=" ",i.contextOrFrameLookup(t,n,"popupAction")&&(a+='action="',a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupAction"),e.opts.autoescape),a+='"'),a+=">\n\n        ",i.contextOrFrameLookup(t,n,"allowAutocomplete")||(a+="\n            ",a+='\n            <input type="text" style="display:none" />\n            <input type="password" style="display:none" />\n        '),a+='\n\n        <header class="',a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupHeaderStyle"),e.opts.autoescape),a+='">\n\n            ',t.getBlock("popup_header")(e,t,n,i,function(o,s){o?r(o):(a+=s,a+='\n\n            <div class="',a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupActionsStyle"),e.opts.autoescape),a+='">\n                ',i.contextOrFrameLookup(t,n,"popupClosable")&&(a+='\n                    <a class="',a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupCloseStyle"),e.opts.autoescape),a+='" data-action="close" data-selenium="close-popup">\n                        <i class="fa fa-times"></i>\n                    </a>\n                '),a+='\n            </div>\n\n        </header>\n\n        <div class="',a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupContentStyle"),e.opts.autoescape),a+=" ",a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupContentClass"),e.opts.autoescape),a+='">\n            ',t.getBlock("popup_content")(e,t,n,i,function(o,s){o?r(o):(a+=s,a+="\n        </div>\n\n        ",e.getFilter("default").call(t,i.contextOrFrameLookup(t,n,"withFooter"),!0)&&(a+='\n            <footer class="',a+=i.suppressValue(i.contextOrFrameLookup(t,n,"popupFooterStyle"),e.opts.autoescape),a+='">\n                ',t.getBlock("popup_footer")(e,t,n,i,function(e,t){e?r(e):(a+=t,a+="\n            </footer>\n        ")})),r(null,a+="\n\n    </form>\n\n</div>\n"))}))})}catch(e){r(i.handleError(e,null,null))}}}},jYW0:function(e,t,n){"use strict";var i=n("a3nb"),r=n("icjm"),a=n("qRO0"),o=n("KL/6"),s=n("EnLC"),u=n("b/No"),l=n("eBAO"),c=function(){return[null,null]},h=function(e){a.a.call(this),this._renderStage=void 0,this._parent=void 0,this._binNum=0,this._sorted=!1,this._sortMode=void 0!==e?e:h.defaultSortMode,this._drawCallback=void 0,this._leafs=[],this._pooledPositionedAttribute=new s.a(c),this._positionedAttribute=new u.a,this._stateGraphList=new u.a,this._bins=new l.a,h.prototype.init.call(this,e)};h.SORT_BY_STATE=0,h.SORT_BACK_TO_FRONT=1,h.SORT_FRONT_TO_BACK=2,h.defaultSortMode=h.SORT_BY_STATE;var d=new s.a(function(){return new h});h.BinPrototypes={RenderBin:function(){return d.getOrCreateObject().init()},DepthSortedBin:function(){return d.getOrCreateObject().init(h.SORT_BACK_TO_FRONT)}};var f=function(e,t){return t._depth-e._depth},p=function(e,t){return e._depth-t._depth},g=function(e,t){return e._binNum-t._binNum};i.a.createPrototypeObject(h,i.a.objectInherit(a.a.prototype,{init:function(e){return this._renderStage=void 0,this._parent=void 0,this._binNum=0,this._sortMode=void 0!==e?e:h.defaultSortMode,this._drawCallback=void 0,h.prototype._initInternal.call(this),this},_initInternal:function(){this._bins.reset(),this._stateGraphList.reset(),this._positionedAttribute.reset(),this._pooledPositionedAttribute.reset(),this._leafs.length=0,this._sorted=!1},_createRenderBin:function(e){var t=h.BinPrototypes.RenderBin;return e&&h.BinPrototypes[e]&&(t=h.BinPrototypes[e]),t()},addPositionAttribute:function(e,t){var n=this._pooledPositionedAttribute.getOrCreateObject();n[0]=e,n[1]=t,this._positionedAttribute.push(n)},getStateGraphList:function(){return this._stateGraphList},getPositionedAttribute:function(){return this._positionedAttribute},copyLeavesFromStateGraphListToRenderLeafList:function(){this._leafs.length=0;for(var e=!1,t=this._stateGraphList.getArray(),n=this._stateGraphList.getLength(),i=0;i<n;i++)for(var a=t[i]._leafs,s=a.getArray(),u=a.getLength(),l=0;l<u;l++){var c=s[l];o.a.isNaN(c._depth)?e=!0:this._leafs.push(c)}e&&r.a.debug("warning: RenderBin::copyLeavesFromStateGraphListToRenderLeafList() detected NaN depth values, database may be corrupted."),this._stateGraphList.reset()},getSortMode:function(){return this._sortMode},sortBackToFront:function(){this.copyLeavesFromStateGraphListToRenderLeafList(),this._leafs.sort(f)},sortFrontToBack:function(){this.copyLeavesFromStateGraphListToRenderLeafList(),this._leafs.sort(p)},sortImplementation:function(){var e=h;switch(this._sortMode){case e.SORT_BACK_TO_FRONT:this.sortBackToFront();break;case e.SORT_FRONT_TO_BACK:this.sortFrontToBack();break;case e.SORT_BY_STATE:}},sort:function(){if(!this._sorted){for(var e=this._bins.getKeys(),t=this._bins.getMap(),n=e.getArray(),i=e.getLength(),r=0;r<i;r++){t[n[r]].sort()}this.sortImplementation(),this._sorted=!0}},setParent:function(e){this._parent=e},getParent:function(){return this._parent},getBinNumber:function(){return this._binNum},findOrInsert:function(e,t){var n=this._bins.getMap()[e];return n||((n=this._createRenderBin(t))._parent=this,n._binNum=e,n._renderStage=this._renderStage,this._bins.set(e,n)),n},getStage:function(){return this._renderStage},addStateGraph:function(e){this._stateGraphList.push(e)},reset:function(){h.prototype._initInternal.call(this)},draw:function(e,t){var n=t;return n=this._drawCallback&&this._drawCallback.drawImplementation?this._drawCallback.drawImplementation(this,e,n):this.drawImplementation(e,n)},applyPositionedAttribute:function(e,t){for(var n=t.getArray(),i=0,r=t.getLength();i<r;i++){var a=n[i],o=a[1],s=a[0];e.setGlobalDefaultAttribute(o),o.apply(e),o.applyPositionedUniform(s,e),e.haveAppliedAttribute(o)}},drawImplementation:function(e,t){for(var n=t,i=[],r=this._bins.getMap(),a=this._bins.getKeys(),o=a.getLength(),s=a.getArray(),u=0;u<o;u++){var l=s[u];i.push(r[l])}i.sort(g);for(var c,h=0,d=i.length;h<d&&!((c=i[h]).getBinNumber()>0);h++)n=c.draw(e,n);for(n=this.drawLeafs(e,n);h<d;h++)n=(c=i[h]).draw(e,n);return n},drawLeafs:function(e,t){for(var n,i=this._stateGraphList.getArray(),r=this._stateGraphList.getLength(),a=this._leafs,o=t,s=0,u=a.length;s<u;s++)(n=a[s]).render(e,o),o=n;for(var l=0,c=r;l<c;l++)for(var h=i[l],d=h._leafs.getArray(),f=h._leafs.getLength(),p=0;p<f;p++)(n=d[p]).render(e,o),o=n;return o}}),"osg","RenderBin"),h.reset=function(){d.reset()},h.clean=function(){d.clean()},t.a=h},jge3:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var i=n("q1tI"),r=function(e){var t=e.dataset.uri||"",n=new Image;n.classList.add("lazyloaded"),n.onload=n.onerror=function(){var t=e.offsetWidth,i=n.naturalWidth>t?n.naturalHeight*(t/n.naturalWidth):n.naturalHeight;t?(["transitionend","webkittransitionend","moztransitionend"].forEach(function(t){return e.addEventListener(t,function(){return e.replaceWith(n)})},{once:!0}),i!==e.offsetHeight?e.style.minHeight="".concat(i,"px"):e.classList.add("loaded")):e.replaceWith(n)},n.src=t};function a(e,t){i.useEffect(function(){if(e.current){var t=Array.prototype.slice.call(e.current.getElementsByClassName("lazyload")),n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;if(!(u instanceof HTMLElement))break;r(u)}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}}},t)}},jiW3:function(e,t,n){"use strict";var i;t.a=function(e){if(i)return i;if(void 0!==e){var t=e,n=window.devicePixelRatio||1;return i=-1!==t?Math.min(t,n):n}return console.warn("getPixelRatio call before getOptions() "),1}},joy8:function(e,t,n){"use strict";n.r(t);var i=n("9oTK"),r=n.n(i),a=n("QLQS"),o=n("YfG3"),s=n("CpTu"),u=n("uPP5"),l=n("par7"),c=function(e,t,n){this._url=e,this._defer=new u.a,this._responseType=t,this._options=n};c.prototype={getPromise:function(){return this._defer},getURL:function(){return this._url},start:function(){this._xhr=new XMLHttpRequest,this._xhr.addEventListener("error",this.error.bind(this),!1),this._xhr.addEventListener("abort",this.abort.bind(this),!1),this._xhr.addEventListener("progress",this.progress.bind(this),!1),this._xhr.addEventListener("load",function(e){if(200!==this._xhr.status)return console.log("Error not loaded "+this._url),void this.error(e);this._xhr.response||(this._xhr.response=this._xhr.responseText),this.load.call(this),l.a.draw()}.bind(this),!1),this._xhr.open("GET",this._url,!0),this._xhr.responseType=this._responseType,this._xhr.send(null)},error:function(){console.error("Error when downloading url : "+this._url),this._defer.reject("Error when downloading url : "+this._url)},abort:function(){this._defer.cancel("Cancelling download of url : "+this._url)},progress:function(e){var t=this._options;if(t&&t.progress&&t.size){var n=e.loaded/t.size;t.progress(n,t.secondary,t.progressKey)}},load:function(){this._defer.resolve(this)},getXHR:function(){return this._xhr}};var h=c,d=function(){h.apply(this,arguments)};d.prototype=Object(o.a)({},h.prototype,{load:function(){this._model=this._xhr.response,this._defer.resolve(this._model)},getModel:function(){return this._model}});var f=d,p=n("vIRb"),g=n("fgaA"),m=n("Ji7B"),v=n.n(m),_=n("2lLB"),b=n.n(_),S=a.a.osg,y={},x={},C=parseInt((/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[0,0])[1],10),w=Object(g.a)().asyncImage;w&&(w=window.Worker&&window.fetch&&window.createImageBitmap&&C>=52);var T=[];window.closeBitmaps=function(){T.forEach(function(e){e.close()})};var M=function(e){var t=0,n=Math.max(2,Math.min(4,navigator.hardwareConcurrency||2)),i=[],r=URL.createObjectURL(new Blob([e],{type:"text/javascript"}));return function(){var e=i[t];return e||((e=i[t]=new Worker(r)).onmessage=function(e){var t=e.data,n=t.uid,i=x[n];t.bitmap?(i.setImage(t.bitmap),T.push(t.bitmap)):(i.setImage(t.img),i.setWidth(t.width),i.setHeight(t.height)),y[n]()}),t=(t+1)%n,e}},E=M(v.a),A=M(b.a),O=function(e,t){h.call(this,e,"blob",t),this._responseType="arraybuffer"};O.prototype=Object(o.a)({},h.prototype,{isVideo:function(e){return p.a.isVideoURL(e)},createVideo:function(){var e=document.createElement("video");return document.body.appendChild(e),e.style.display="none",e},start:function(){var e=this.getURL();if(this.isVideo(e)){var t=this.createVideo();return this._osgjsImage=new S.ImageStream(t),window.video=this._osgjsImage,t.preload="auto",t.crossOrigin="anonymous",t.src=e,void this._osgjsImage.whenReady().then(function(e){e.play(),this._defer.resolve(this._osgjsImage)}.bind(this))}this._osgjsImage=new S.Image;var n=this._options;if(!(n.panoramaLUV||n.integrateBRDFLUV||n.cubemapLUV))return l.a.draw(),this._url.endsWith(".astc.gz")?(n.astc=!0,void h.prototype.start.call(this)):this._url.endsWith(".svg")?(n.svg=!0,void this.loadImage()):void(n.decodeAsync&&w?this.loadImageAsync():this.loadImage());h.prototype.start.call(this)},load:function(){var e=this._options;e.panoramaLUV||e.integrateBRDFLUV?this.loadLUV():e.cubemapLUV?this.loadCubemapLUV():e.astc&&this.loadAstc()},loadImageAsync:function(){y[this._url]=this._defer.resolve.bind(this._defer,this._osgjsImage),x[this._url]=this._osgjsImage,A().postMessage({uid:this._url,url:this._url})},loadAstc:function(){var e=this._xhr.response;y[this._url]=this._defer.resolve.bind(this._defer,this._osgjsImage),x[this._url]=this._osgjsImage,E().postMessage({uid:this._url,buffer:e,swizzle:!0,nbComponents:3},[e])},svgToCanvas:function(){var e=document.createElement("canvas"),t=Object(g.a)().svgSize;e.width=t,e.height=t;var n=e.getContext("2d");this._htmlImage.width=t,this._htmlImage.height=t,n.drawImage(this._htmlImage,0,0,t,t),this._osgjsImage.setImage(e)},loadImage:function(){this._htmlImage=new Image,this._options.crossOrigin&&(this._htmlImage.crossOrigin=this._options.crossOrigin),this._htmlImage.addEventListener("load",function(){this._options.svg&&this.svgToCanvas(),this._defer.resolve(this._osgjsImage)}.bind(this)),this._htmlImage.onerror=function(){this._htmlImage._aborted?this._defer.cancel(this._osgjsImage):this._defer.reject(this._osgjsImage)}.bind(this),this._htmlImage.src=this._url,this._osgjsImage.setImage(this._htmlImage)},abort:function(){this._htmlImage?(this._htmlImage.src="",this._htmlImage._aborted=!0):h.prototype.abort.call(this)},loadLUV:function(){var e,t=this._xhr.response,n=Math.sqrt(t.byteLength/4);e=this._options.integrateBRDFLUV?new Uint8Array(t):this.deinterleaveImage4(n,new Uint8Array(t),new Uint8Array(t.byteLength));var i=this._osgjsImage;i.setImage(e),i.setWidth(n),i.setHeight(n),this._defer.resolve(this._osgjsImage)},loadCubemapLUV:function(){for(var e=this._xhr.response,t=Math.log(this._options.size)/Math.LN2,n=0,i={},r=0;r<=t&&!(n>=e.byteLength);r++)for(var a=Math.pow(2,t-r),o=0;o<6;o++){i[S.Texture.TEXTURE_CUBE_MAP_POSITIVE_X+o]||(i[S.Texture.TEXTURE_CUBE_MAP_POSITIVE_X+o]=[]);var s=a*a*4,u=new Uint8Array(s);this.deinterleaveImage4(a,new Uint8Array(e,n,s),u);var l=new S.Image;l.setImage(u),l.setWidth(a),l.setHeight(a),i[S.Texture.TEXTURE_CUBE_MAP_POSITIVE_X+o].push(l),n+=s}this._defer.resolve(i)},deinterleaveImage4:function(e,t,n){for(var i=e*e,r=2*e*e,a=3*e*e,o=0,s=0;s<i;s++)n[o++]=t[s],n[o++]=t[s+i],n[o++]=t[s+r],n[o++]=t[s+a];return n},getImage:function(){return this._osgjsImage}});var R=O,P=function(e,t){h.call(this,e,"arraybuffer",t)};P.prototype=Object(o.a)({},h.prototype,{load:function(){var e=this.getXHR().response;this._defer.resolve(e)}});var I=P,N=a.a.osg,L=function(e,t,n){n?N.error("ResourceLoader: "+e+" failed "+t+" error "+n):N.error("ResourceLoader: "+e+" failed "+t)},k=function(){this._nbThreads=5,this._processing=[],this._queue=[],this._finished=[],this._running=!1};k.prototype={checkResource:function(e){var t;return[this._processing,this._queue,this._finished].forEach(function(n){t||(t=Object(s.a)(n,function(t){return t._url===e}))}),t},run:function(){this._running=!0,this.runPendingProcess()},runPendingProcess:function(){for(;this._processing.length<this._nbThreads&&this._queue.length>0;){var e=this._queue.shift();this._processing.push(e),e.start()}},queue:function(e){e.start||(console.log(e.url),e=new h(e.url,e.response)),this._queue.push(e);var t=e.getPromise();return t.finally(function(){t.isFulfilled()&&this._finished.push(e),this._processing.splice(this._processing.indexOf(e),1),this.runPendingProcess()}.bind(this)),this._running&&this.runPendingProcess(),e},getModel:function(e,t){var n=this.checkResource(e);return n||((n=this.queue(new f(e,"text",t))).getPromise().catch(function(t){L(e,"model",t)}),n)},getImage:function(e,t){var n=this.checkResource(e);if(n)return n;var i=t||{};return"data:image"===e.substr(0,"data:image".length)||(i.crossOrigin="anonymous"),(n=this.queue(new R(e,i))).getPromise().catch(function(){L(e,"image")}),n},getBinaryArray:function(e,t){var n=this.checkResource(e);return n||((n=this.queue(new I(e,t))).getPromise().catch(function(t){L(e,"binary array",t)}),n)}};var D=k,F=n("B306"),V=n("mCLn"),B=n("j3Bp"),U=n("f5KD"),j=n("grIK"),G=B.a.extend({optionTypes:{modelUid:U.b.string},model:V.a,url:function(){return Object(j.a)("environments",this.options.modelUid,this.options.checkPrefetch)}}),H=n("jA0E"),z=B.a.extend({optionTypes:{modelUid:U.b.string},model:H.a,url:function(){return Object(j.a)("backgrounds",this.options.modelUid,this.options.checkPrefetch)}}),W=n("Bp/7"),q=n("gw1E"),X=n("n3DM"),Y=B.a.extend(Object(o.a)({optionTypes:{modelUid:U.b.string},model:q.a,url:function(){return Object(j.a)("matcaps",this.options.modelUid,this.options.checkPrefetch)}},X.a)),K=n("AwvW"),Q=n("Dnzz"),J=B.a.extend({optionTypes:{modelUid:U.b.string},comparator:"order",model:Q.a,_trashbin:[],url:function(){return Object(j.a)("animations",this.options.modelUid,this.options.checkPrefetch)}}),Z=n("bud1"),$=B.a.extend({optionTypes:{modelUid:U.b.string},comparator:"order",model:Z.a,url:function(){return Object(j.a)("sounds",this.options.modelUid,this.options.checkPrefetch)},modelId:function(e){return e.cid},triggerEditTrack:function(e){this.trigger("editTrack",e)},triggerDeleteTrack:function(e){this.trigger("removeTrack",e)},triggerDuplicateTrack:function(e){this.trigger("duplicateTrack",e)},triggerSelectTrack:function(e){this.trigger("select",e)}}),ee=n("gUpJ"),te=n("DWkk"),ne=n("UpON"),ie=n("OZ7T"),re=n("CAIV"),ae=function(e,t){for(var n=t||0,i=e.length,r=e[n],a=n+1;a<i;++a){var o=e[a];r=e[a]=r+(o>>1^-(1&o))}return e},oe=function(e,t,n,i){for(var r=e[oe.IMPLICIT_HEADER_EXPECTED_INDEX],a=e[oe.IMPLICIT_HEADER_MASK_LENGTH],o=new Uint32Array(e.subarray(oe.IMPLICIT_HEADER_LENGTH,a+oe.IMPLICIT_HEADER_LENGTH)),s=32*a-t.length,u=0;u<a;++u)for(var l=o[u],c=32*u,h=u===a-1?s:0;h<32;++h,++c)t[c]=l&1<<31>>>h?e[n++]:i?r:r++;return t};oe.IMPLICIT_HEADER_PRIMITIVE_LENGTH=0,oe.IMPLICIT_HEADER_MASK_LENGTH=1,oe.IMPLICIT_HEADER_EXPECTED_INDEX=2,oe.IMPLICIT_HEADER_LENGTH=3;var se=oe,ue=function(e,t,n){var i=e.length/t,r=new Uint8Array(i),a=n.length-1;r[n[0]]=1,r[n[1]]=1,r[n[2]]=1;for(var o=2;o<a;++o){var s=o-2,u=n[s],l=n[s+1],c=n[s+2],h=n[s+3];if(1!==r[h]){r[h]=1,u*=t,l*=t,c*=t,h*=t;for(var d=0;d<t;++d)e[h+d]=e[h+d]+e[l+d]+e[c+d]-e[u+d]}}return e},le=n("9PC4"),ce=n("LfNR"),he=function(e,t,n){for(var i=n[0],r=e.length,a=0;a<r;++a){var o=i-e[a];t[a]=o,i<=o&&(i=o+1)}return n[0]=i,t},de=a.a.osg,fe=a.a.osgWrappers.osg.functionSortAttributes,pe={Vertex:1,Normal:2,TexCoord:4,Color:8,Triangle:16,Tangent:32},ge=1,me=2,ve=1,_e=2,be=4,Se=function(e){return-1!==e.indexOf("TexCoord")?pe.TexCoord:pe[e]},ye=function(e,t,n,i,r){var a,o=t.vb,s=o.Offset?o.Offset:0,u=e.getIndices();1===(a=o.Encoding&&"varint"===o.Encoding?Object(ce.a)(new Uint8Array(r,s),u.getItemSize()*o.Size,t.type):new de[t.type](r,s,u.getItemSize()*o.Size)).BYTES_PER_ELEMENT&&(a=new Uint16Array(a));var l=n.attributes,c=Se("Triangle"),h=a,d=e.getMode()===de.primitiveSet.TRIANGLE_STRIP;if(0==(l&c)||!d&&e.getMode()!==de.primitiveSet.TRIANGLES)return a instanceof Uint16Array==!1&&(h=new Uint16Array(a.buffer,a.byteOffset,a.length)).set(a),u.setElements(h),void e.setIndices(u);var f=n.triangle_mode,p=0;if(f&be&&d&&(p=se.IMPLICIT_HEADER_LENGTH+a[se.IMPLICIT_HEADER_MASK_LENGTH],h=new Uint16Array(a[se.IMPLICIT_HEADER_PRIMITIVE_LENGTH])),f&ve&&ae(a,p),f&be&&d&&se(a,h,p,f&_e),f&_e&&he(h,h,i),h instanceof Uint16Array==!1){var g=h;(h=new Uint16Array(g.buffer,g.byteOffset,g.length)).set(g)}u.setElements(h),e.setIndices(u)},xe=de.vec3.create(),Ce=de.vec3.create(),we=function(e,t,n,i,r,a){var o,s=t.vb,u=e.getItemSize(),l=s.Size,c=s.Offset?s.Offset:0;if(o=s.Encoding&&"varint"===s.Encoding?Object(ce.a)(new Uint8Array(a,c),u*l,t.type):new de[t.type](a,c,u*l),0==(i.attributes&Se(n)))return"Color"===n?o=function(e,t){if(4===t.BYTES_PER_ELEMENT&&Object(g.a)().convertVertexColor8Bit){for(var n=t.length,i=new Uint8Array(t.buffer,t.byteOffset,n),r=0;r<n;++r)i[r]=Math.round(255*Math.max(0,Math.min(1,t[r])));t=i}return 1===t.BYTES_PER_ELEMENT&&e.setNormalize(!0),t}(e,o):"Bones"===n&&(o=function(e,t){if(1===t.BYTES_PER_ELEMENT)return t;for(var n=0,i=t.length;n<i;++n)if(t[n]>255)return t;var r=new Uint8Array(t.buffer,t.byteOffset,i);return r.set(t),r}(0,o)),void e.setElements(o);if("Normal"===n)return e.setElements(Object(re.a)(o,new Float32Array(3*l),3,i.epsilon,i.nphi)),void e.setItemSize(3);if("Tangent"===n)return e.setElements(Object(re.a)(o,new Float32Array(4*l),4,i.epsilon,i.nphi)),void e.setItemSize(4);var h=null;if("Vertex"===n)h=i.vertex_mode;else if(-1!==n.indexOf("TexCoord")){var d="uv_"+n.substr(8)+"_mode";h=void 0!==i[d]?i[d]:i.vertex_mode}h&me&&void 0!==r&&ue(o,u,r.getElements()),e.setElements(function(e,t,n,i,r){var a="Vertex"===i?"vtx_":"uv_"+i.substr(8)+"_",o=e&ge&&void 0!==r[a+"bbl_x"],s=t instanceof Float32Array==1;if(!o&&s)return t;var u=4===t.BYTES_PER_ELEMENT?new Float32Array(t.buffer,t.byteOffset,t.length):new Float32Array(t.length);return o?(xe[0]=r[a+"bbl_x"],xe[1]=r[a+"bbl_y"],Ce[0]=r[a+"h_x"],Ce[1]=r[a+"h_y"],3===n&&(xe[2]=r[a+"bbl_z"],Ce[2]=r[a+"h_z"]),Object(le.a)(t,u,xe,Ce,n)):(u.set(t),u)}(h,o,u,n,i))},Te=function(e,t,n){!function(e,t,n,i){var r=e.userDataMap,a=e.getVertexAttributeList(),o=Object.keys(a);o.sort(fe);for(var s=o.length,u=0;u<s;++u){var l=o[u],c=a[l];c.getInitialBufferArray&&(c=c.getInitialBufferArray());var h=t[c.getInstanceID()];if(!0!==h.visited)if(h.visited=!0,h.inlined)c.setElements(new Float32Array(h.inlined));else{var d=r,f=l.indexOf("_");-1!==f&&(d=r["morph_"+l.slice(f+1)],l=l.slice(0,f)),we(c,h,l,d,i,n)}}}(e,t,n,function(e,t,n){for(var i,r=e.userDataMap,a=e.getPrimitiveSetList(),o=[0],s=0,u=a.length;s<u;++s){var l=a[s];if(!(l instanceof de.DrawArrays||l instanceof de.DrawArrayLengths)){var c=l.getIndices();c.getInitialBufferArray&&(c=c.getInitialBufferArray());var h=t[c.getInstanceID()];!0!==h.visited&&(h.visited=!0,h.inlined?(c.setElements(new Uint16Array(h.inlined)),l.setIndices(c)):(ye(l,h,r,o,n),l.getMode()===de.primitiveSet.TRIANGLE_STRIP&&(i=c)))}}for(s=u-1;s>=0;s--)(l=a[s]).getCount()||a.splice(s,1);return i}(e,t,n))},Me=n("t8Ru"),Ee=a.a.osg,Ae=[Ee.primitiveSet.TRIANGLES,Ee.primitiveSet.TRIANGLE_STRIP,Ee.primitiveSet.TRIANGLE_FAN],Oe=[Ee.primitiveSet.LINES,Ee.primitiveSet.LINE_LOOP,Ee.primitiveSet.LINE_STRIP],Re=function(e,t){var n=t.getItemSize(),i=t.getElements(),r=1;1===i.BYTES_PER_ELEMENT?r=255:2===i.BYTES_PER_ELEMENT&&(r=65535);var a=!1,o=i.length,s=0;if(4===n){var u=!0,l=!0;for(s=3;s<o;s+=4){var c=i[s];if(0!==c&&(u=!1),c!==r&&(l=!1),!u&&!l)break}if(u&&4===n)for(s=3;s<o;s+=4)i[s]=r;a=!u&&!l}var h=!0;if(!a){var d=!0;for(s=0;s<o&&(i[s]!==r&&(d=!1),i[s+1]!==r&&(d=!1),i[s+2]!==r&&(d=!1),d);s+=n);d&&delete e.getVertexAttributeList().Color,h=!d}a&&(Me.a.hasVertexAlpha=e.userDataMap.hasVertexAlpha=!0),h&&(Me.a.hasVertexColor=!0)},Pe=function(e){for(var t=e.getPrimitiveSetList(),n=t.length,i=!1,r=!1,a=!1,o=void 0!==e.getVertexAttributeList().Normal,s=0;s<n;++s){var u=t[s].getMode();0!==t[s].getCount()&&(i||(i=u===Ee.primitiveSet.POINTS),a||(a=-1!==Ae.indexOf(u)),r||(r=-1!==Oe.indexOf(u)))}ie.a.hasPoints||(ie.a.hasPoints=i),ie.a.hasTriangles||(ie.a.hasTriangles=a),ie.a.hasLines||(ie.a.hasLines=r),ie.a.hasVertexNormals||(ie.a.hasVertexNormals=o),e.userDataMap.hasPoints=i,e.userDataMap.hasTriangles=a,e.userDataMap.hasLines=r},Ie=function(){for(var e in ie.a.instanceIDGeometryMap){var t=ie.a.instanceIDGeometryMap[e];if(!t.userDataMap.wireframe){var n=t.getVertexAttributeList().Color;n&&Re(t,n),Pe(t)}}ie.a.instanceIDGeometryMap={}},Ne=n("a5Z4"),Le=a.a.osg,ke={},De=function(e){for(var t=Le.vec3.create(),n=0,i=e.length;n<i;n+=3)if(isFinite(e[n])&&isFinite(e[n+1])&&isFinite(e[n+2])){t[0]=e[n],t[1]=e[n+1],t[2]=e[n+2];break}return t},Fe=function(e){if(function(e){var t=e.getVertexAttributeList().Vertex;if(void 0!==t.processedNaN)return t.processedNaN;t.processedNaN=!1;for(var n,i=t.getInstanceID(),r=t.getElements(),a=0,o=r.length;a<o;a+=3)isFinite(r[a])&&isFinite(r[a+1])&&isFinite(r[a+2])||(t.processedNaN=!0,n||(n=De(r)),r[a]=n[0],r[a+1]=n[1],r[a+2]=n[2],ke[i]||(ke[i]={}),ke[i][a/3]=!0);return t.processedNaN}(e)||Object(g.a)().forceTriangles){var t=e.getVertexAttributeList().Vertex,n=ke[t.getInstanceID()]||{},i=[],r=[],a=[],o={operatorPoint:function(e,t,n){e[n]||t.push(n)}.bind(this,n,i),operatorLine:function(e,t,n,i){e[n]||e[i]||t.push(n,i)}.bind(this,n,r),operatorTriangle:function(e,t,n,i,r){e[n]||e[i]||e[r]||t.push(n,i,r)}.bind(this,n,a)};Le.primitiveIndexFunctor(e,o);var s,u,l=e.getPrimitiveSetList();l.length=0,i.length&&(u=new Uint16Array(i),s=new Le.BufferArray(Le.BufferArray.ELEMENT_ARRAY_BUFFER,u,1),l.push(new Le.DrawElements(Le.primitiveSet.POINTS,s))),r.length&&(u=new Uint16Array(r),s=new Le.BufferArray(Le.BufferArray.ELEMENT_ARRAY_BUFFER,u,1),l.push(new Le.DrawElements(Le.primitiveSet.LINES,s))),a.length&&(u=new Uint16Array(a),s=new Le.BufferArray(Le.BufferArray.ELEMENT_ARRAY_BUFFER,u,1),l.push(new Le.DrawElements(Le.primitiveSet.TRIANGLES,s)))}},Ve=function(e){for(var t=!1,n=0,i=e.length;n<i;++n)t=Fe(e[n])||t;t&&Ne.default.logMessage("NaN values detected in vertices!")},Be=a.a.osg,Ue=a.a.osgDB,je=function(e,t){for(var n=e.getPrimitiveSetList(),i=0,r=n.length;i<r;++i){var a=n[i];if(!(a instanceof Be.DrawArrays||a instanceof Be.DrawArrayLengths)){var o=a.getIndices();o.getInitialBufferArray&&(o=o.getInitialBufferArray());var s=t[o.getInstanceID()];return s.inlined?"":s.vb.File}}var u=e.getVertexAttributeList().Vertex;u.getInitialBufferArray&&(u=u.getInitialBufferArray());var l=t[u.getInstanceID()];return l.inlined?"":l.vb.File},Ge="",He=function(e,t,n,i){var r="Uncompress "+i;Be.time(r);for(var a=0;a<e.length;++a)Te(e[a],t,n);Ve(e),Ie(),Be.timeEnd(r)},ze=function(e,t,n,i,r){var a=t.bufferMap,o=function(e,t){var n=t.wireframeOptions&&t.wireframeOptions.nodes,i=[],r=[],a=[],o="",s="",u=ie.a.instanceIDGeometryMap;for(var l in u){var c=u[l];0!==c.getPrimitiveSetList().length||Object(g.a)().keepEmptyGeometries?1!==c.userDataMap.wireframe?(r.push(c),o||(o=je(c,e))===Ge&&(o="")):(a.push(c),n&&n.push(c),c.setNodeMask(0),s||(s=je(c,e))):i.push(c)}Ge=o||Ge;for(var h=0,d=i.length;h<d;++h)for(var f=i[h],p=f.getParents(),m=p.length-1;m>=0;--m)p[m].removeChild(f);return{urlPolygon:t.prefixURL+o,urlWireframe:t.prefixURL+s,namePolygon:o,nameWireframe:s,polygons:r,wireframes:a}}(a,t);if(!o.namePolygon)return He(o.polygons,a,null,r),n.addChild(e),n;var s="Download "+o.namePolygon+" (Async)",u=i.getBinaryArray(o.urlPolygon,t).getPromise();return Be.time(s),u.then(function(r){return Be.timeEnd(s),He(o.polygons,a,r,o.namePolygon),function(e,t,n,i){if(i){var r="Download "+e.nameWireframe+" (Async)";i.startPromise.then(function(){var a=n.getBinaryArray(e.urlWireframe,i).getPromise();Be.time(r),a.then(function(n){Be.timeEnd(r),He(e.wireframes,t,n,e.nameWireframe),i.deferDownload.resolve()})})}}(o,a,i,t.wireframeOptions),n.addChild(e),n})},We=function(e,t,n,i,r){t.size=t.binarySize,t.progressKey=t.binaryKey;var a="JSON.parse "+r,o="osgDB.parseSceneGraph "+r+" (Async)";Be.time(a);var s=JSON.parse(e);return Be.timeEnd(a),ne.a.OSG_VERSION=s.Version,Be.time(o),Ue.parseSceneGraph(s,t).then(function(e){return Be.timeEnd(o),function(e,t){var n="UserDataVisitor "+t;Be.time(n);var i=new ie.a;e.accept(i),Be.timeEnd(n)}(e,r),ze(e,t,n,i,r)})},qe=function(e,t,n,i,r){n.size=n.osgjsSize,n.progressKey=n.osgjsKey;var a=t.split("/").pop(),o="Download "+a+" (Async)";return Be.time(o),e.then(function(e){return Be.timeEnd(o),We(e,n,i,r,a)})},Xe=a.a.osg,Ye=function(e){e=this.computeURL(e);var t=new Xe.Image;return t.setURL(e),r.a.resolve(t)},Ke=[],Qe={},Je=function(e,t){this.resource=e,this.promise=t},Ze=function(e){if(!e){if(Ze.instance)return Ze.instance;Ze.instance=this}return this._optPrefetch={modelUid:void 0,checkPrefetch:!0},this._maps={},this._collections={},this._resourceLoader=new D,this};Ze.Entry=Je,Ze.prototype={setModelUid:function(e){this._optPrefetch.modelUid=e},setStateContextOSG:function(e){this._state=e},getInstance:function(){return Ze.instance},register:function(e,t){this._maps[e]=t},exist:function(e){return this._maps[e]},hashTextureOptions:function(e){for(var t="",n=F.a.getValidOptions(),i=n.length,r=0;r<i;++r)t+=e[n[r]];return t},_getCollection:function(e,t){var n=this._collections[t];return n||(this._collections[t]=new e([],this._optPrefetch),window.RunningTests||this._collections[t].fetch(),this._collections[t])},getEnvironmentCollection:function(){return this._getCollection(G,"environment")},getBackgroundCollection:function(){return this._getCollection(z,"background")},getSoundCollection:function(){return this._getCollection($,"sound")},getHotspotCollection:function(){return this._getCollection(K.a,"hotspot")},getMatcapCollection:function(){return this._getCollection(Y,"matcap")},getAnimationCollection:function(){return this._getCollection(J,"animation")},getTextureCollection:function(){if(this._collections.texture)return this._collections.texture;var e=this._getCollection(W.a,"texture");return e.forEach(function(t){0===t.getImages().length&&e.remove(t)}),e.isValid(),e},getOrCreateMultiresTexture:function(e,t){var n=[e,this.hashTextureOptions(t)].join(""),i=this.exist(n);if(i)return i;var a=this.getTextureCollection().get(e)||this.getMatcapCollection().get(e);if(a){var o=new ee.a;return F.a.setOptions(t,o),o.setImageModel(a),i=new Je(o,r.a.resolve(o)),this.register(n,i),i}},getOrCreateImage:function(e,t){var n="image"+e;t&&t.widget&&(n+="widget");var i=this.exist(n);if(i)return i;var r=this._resourceLoader.getImage(e,t).getPromise();return(i=new Je).promise=r.then(function(e){return i.image=e,i.resource=e,e}),this.register(n,i),i},getOrCreateTexture:function(e,t){var n=function(e){!this._state||e._textureObject&&!e.isDirty()||this._state.applyTextureAttribute(0,e)}.bind(this),i=F.a.createValidOptions(t),r=[e,this.hashTextureOptions(i)].join(""),a=this.exist(r),o=!!(t&&t.transferToGPU&&this._state);if(a)return o&&(a.promise.isFulfilled()?n(a.texture):a._bindToGPU=!0),a;i.cubemap=t&&t.cubemap;var s=i.cubemap?new te.a:new ee.a;s.setTextureSize(1,1),F.a.setOptions(i,s),t&&void 0!==t.convertNPOT&&(s._convertNPOT=t.convertNPOT);var u=this._resourceLoader.getImage(e,t).getPromise();(a=new Je(s)).texture=s,a._bindToGPU=o;var l=this;return a.promise=u.then(function(e){if(i.cubemap)for(var t=0;t<6;t++){var r=Xe.Texture.TEXTURE_CUBE_MAP_POSITIVE_X+t;s.setImage(r,e[r],"RGBA")}else s.setImage(e);return s.dirty(),a._bindToGPU&&n(s),s}).finally(function(){return u.isFulfilled()||l.register(r,void 0),s}),this.register(r,a),a},getOrCreateModel:function(e,t){var n=e,i=this.exist(n);if(i)return i;var a=t&&t.node?t.node:new Xe.Node,s={};s.readImageURL=Ye,s.readBinaryArrayURL=function(e){return function(t,n){return t=n.currentAnimationUID?n.currentAnimationUID:this.computeURL(t),e.getBinaryArray(t,n).getPromise()}}(this._resourceLoader),s.bufferMap=Qe,s.readBufferArray=function(){var e=this.getJSON(),t=e.UniqueID,n=new Xe.BufferArray(Xe.BufferArray[e.Type]);n.setItemSize(e.ItemSize),n.setElements(Ke);var i=n.getInstanceID();if(Qe[i]={},e.Array){var a=Object.keys(e.Array)[0],o=e.Array[a];o.Elements?Qe[i].inlined=o.Elements:(Qe[i].vb=o,Qe[i].type=a)}else Qe[i].inlined=e.Elements;var s=r.a.resolve(n);return void 0!==t&&(this._identifierMap[t]=s),s};var u=Object(o.a)({},s,t),l=this._resourceLoader.getModel(e,u),c=e.split("/");c.length=c.length-1,c.length<=0&&Xe.error("getOrCreateModel: can't find prefix to load subdata");var h=c.join("/")+"/";u.prefixURL=h;var d=qe(l.getPromise(),e,u,a,this._resourceLoader);return(i=new Je(a,d)).node=a,this.register(n,i),i},run:function(){this._resourceLoader.run()}},new Ze;t.default=Ze},jq0H:function(e,t,n){"use strict";var i=n("a3nb"),r=n("czSk"),a=i.a.objectInherit(r.g,{INSIDE:1,INTERSECT:2,OUTSIDE:3,transformProvidingInverse:function(){var e=a.create();return function(t,n){var i=t[0],r=t[1],o=t[2],s=t[3];return e[0]=n[0]*i+n[1]*r+n[2]*o+n[3]*s,e[1]=n[4]*i+n[5]*r+n[6]*o+n[7]*s,e[2]=n[8]*i+n[9]*r+n[10]*o+n[11]*s,e[3]=n[12]*i+n[13]*r+n[14]*o+n[15]*s,a.normalizeEquation(e),a.copy(e,t),t}},normalizeEquation:function(e){var t=1/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t},getNormal:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},setNormal:function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2]},getDistance:function(e){return e[3]},setDistance:function(e,t){e[3]=t},distanceToPlane:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]},intersectsOrContainsBoundingSphere:function(e,t){if(!t.valid())return a.OUTSIDE;var n=t.center(),i=t.radius(),r=this.distanceToPlane(e,n);return r<-i?a.OUTSIDE:r<=i?a.INTERSECT:a.INSIDE},instersectsBoundingSphere:function(e,t){return this.intersectsOrContainsBoundingSphere(e,t)===a.INTERSECT},intersectsOrContainsBoundingBox:function(){var e=r.f.create();return function(t,n){var i=(t[0]>=0?1:0)|(t[1]>=0?2:0)|(t[2]>=0?4:0),r=7&~i;return this.distanceToPlane(t,n.corner(r,e))>0?a.INSIDE:this.distanceToPlane(t,n.corner(i,e))<0?a.OUTSIDE:a.INTERSECT}}(),intersectsBoundingBox:function(e,t,n){return this.intersectsOrContainsBoundingBox(e,t,n)===a.INTERSECT},intersectOrContainsVertices:function(e,t){for(var n=-1,i=0;i<t.length;i++){var r=this.distanceToPlane(e,t[i]);if(r<0){if(1===n)return a.INTERSECT;n=2}else{if(!(r>0))return a.INTERSECT;if(2===n)return a.INTERSECT;n=1}}return n>0?a.INSIDE:a.OUTSIDE},intersectVertices:function(e,t){return this.intersectOrContainsVertices(e,t)===a.INTERSECT}});t.a=a},kKFa:function(e,t,n){"use strict";var i=n("a3nb"),r=n("qRO0"),a=n("RwmW"),o=n("zP/P"),s=function(){a.a.call(this),this._instanceID=r.a.getInstanceID(),this._vaoObject=void 0,this.dirty()};s._sDeletedGLVertexArrayObjectCache=new window.Map,s.deleteGLVertexArrayObject=function(e,t){s._sDeletedGLVertexArrayObjectCache.has(e)||s._sDeletedGLVertexArrayObjectCache.set(e,[]),s._sDeletedGLVertexArrayObjectCache.get(e).push(t)},s.flushDeletedGLVertexArrayObjects=function(e,t){if(t<=0)return t;if(!s._sDeletedGLVertexArrayObjectCache.has(e))return t;for(var n=0,i=o.a.instance().tick(),r=s._sDeletedGLVertexArrayObjectCache.get(e),a=r.length-1;a>=0&&n<t;a--)e.deleteVertexArray(r[a]),r.splice(a,1),n=o.a.instance().deltaS(i,o.a.instance().tick());return t-n},s.flushAllDeletedGLVertexArrayObjects=function(e){if(s._sDeletedGLVertexArrayObjectCache.has(e))for(var t=s._sDeletedGLVertexArrayObjectCache.get(e),n=t.length-1;n>=0;n--)e.deleteVertexArray(t[n]),t.splice(n,1)},s.onLostContext=function(e){s._sDeletedGLVertexArrayObjectCache.has(e)&&(s._sDeletedGLVertexArrayObjectCache.get(e).length=0)},i.a.createPrototypeObject(s,i.a.objectInherit(a.a.prototype,{getInstanceID:function(){return this._instanceID},invalidate:function(){this._vaoObject=void 0,this.dirty()},releaseGLObjects:function(){void 0!==this._vaoObject&&void 0!==this._gl&&(s.deleteGLVertexArrayObject(this._gl,this._vaoObject),a.a.removeObject(this._gl,this)),this.invalidate()},create:function(e){this._vaoObject=e.createVertexArray(),this._dirty=!1},bind:function(e){this._gl||this.setGraphicContext(e),this._vaoObject&&e.bindVertexArray(this._vaoObject)},dirty:function(){this._dirty=!0},isDirty:function(){return this._dirty}}),"osg","VertexArrayObject"),t.a=s},kUJ5:function(e,t,n){"use strict";var i=n("QLQS").a.osg,r=[0,0],a={init:function(e,t,n){this._qualityModel=t,this._canvasPixelRatio=n,this._canvas=e,this._pixelRatio=[1,1]},getCanvasCoord:function(e,t){if(t=t||r,e.center||e.touches){if(e.center)t[0]=e.center.x,t[1]=e.center.y;else{t[0]=t[1]=0;for(var n=e.touches.length,i=0;i<n;++i)t[0]+=e.touches[i].clientX/n,t[1]+=e.touches[i].clientY/n}var a=e.target.getBoundingClientRect();t[0]+=-a.left,t[1]+=-a.top}else t[0]=void 0===e.offsetX?e.layerX:e.offsetX,t[1]=void 0===e.offsetY?e.layerY:e.offsetY;return t},getPixelRatio:function(){var e=this._qualityModel.get("dynamicResolutionScaling");return this._pixelRatio[0]=this._canvasPixelRatio*e[0],this._pixelRatio[1]=this._canvasPixelRatio*e[1],this._pixelRatio},canvasCoordToGL:function(e,t,n){var r=this._canvas,a=n||i.vec2.create(),o=this.getPixelRatio();return a[0]=e*o[0],a[1]=(r.clientHeight-t)*o[1],a},glCoordToCanvas:function(e,t,n){var r=this._canvas,a=n||i.vec2.create(),o=this.getPixelRatio();return a[0]=e/o[0],a[1]=r.clientHeight-t/o[1],a}};t.a=a},kZIE:function(e,t,n){"use strict";var i=new(n("tNdj").a);i.PBR_LIT=1,i.CLASSIC_LIT=2,i.PBR_SHADELESS=4,i.CLASSIC_SHADELESS=8,i.MATCAP=16,i.INSPECTOR=32,i.nameMatch={"shadeless-pbr":i.PBR_SHADELESS,"shadeless-classic":i.CLASSIC_SHADELESS,"lit-pbr":i.PBR_LIT,"lit-classic":i.CLASSIC_LIT,"shading-ar":i.PBR_LIT,"shading-vr":i.PBR_LIT,ground:i.INSPECTOR,inspector:i.INSPECTOR},i.LIT=i.PBR_LIT|i.CLASSIC_LIT,i.SHADELESS=i.PBR_SHADELESS|i.CLASSIC_SHADELESS,i.PBR=i.PBR_LIT|i.PBR_SHADELESS,i.CLASSIC=i.CLASSIC_LIT|i.CLASSIC_SHADELESS,i.set("mask",i.PBR_LIT),i.set("hasSsr",!1),i.on("change:mask",function(){var e=i.get("mask");switch(e){case i.PBR_LIT:case i.CLASSIC_LIT:case i.PBR_SHADELESS:case i.CLASSIC_SHADELESS:case i.INSPECTOR:case i.MATCAP:break;default:console.error("Invalid ShadingGlobal mask value !"+e)}}),t.a=i},kj78:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"b",function(){return E}),n.d(t,"c",function(){return A}),n.d(t,"d",function(){return O}),n.d(t,"a",function(){return I});var i,r,a=n("o0o1"),o=n.n(a),s=n("yXPU"),u=n.n(s),l=n("QILm"),c=n.n(l),h=n("J4zp"),d=n.n(h),f=n("lSNA"),p=n.n(f),g=n("MVZn"),m=n.n(g),v=n("BeL+"),_=n("Muja"),b=n("XiPH"),S=n("NpZ0"),y=n("WRMX"),x=n("9mpE"),C=n("S4lS"),w=n("4WAW"),T=n("YE5Z"),M=function(e){return m()({},e,{list:Object(v.a)(e.list)})};!function(e){e.UPDATE_QUERY="storeSearch.UPDATE_QUERY",e.UPDATE_FILTERS="storeSearch.UPDATE_FILTERS",e.LOAD_INITIAL_QUERY="storeSearch.LOAD_INITIAL_QUERY",e.FIRST="storeSearch.FIRST",e.NEXT="storeSearch.NEXT",e.PREVIOUS="storeSearch.PREVIOUS"}(r||(r={}));var E={query:"",filters:{sortBy:"-pertinence",animated:!1,rigged:!1,pbr:!1,restricted:!1,categories:[],minFaceCount:T.c,maxFaceCount:T.a,minRating:"",fileFormats:[],minPrice:T.d,maxPrice:T.b,licenses:[]},pagination:w.c},A=Object(S.b)(E,(i={},p()(i,r.UPDATE_QUERY,function(e,t){return m()({},e,{query:t.query})}),p()(i,r.UPDATE_FILTERS,function(e,t){return m()({},e,{filters:m()({},e.filters,t.filters)})}),p()(i,r.LOAD_INITIAL_QUERY,function(e,t){return t.effect.caseOf({Pending:function(){return m()({},e,{query:t.query,filters:t.filters})},Rejected:function(){return e},Resolved:function(t){return m()({},e,{pagination:w.f(e.pagination,w.b.firstResolved(t))})}})}),p()(i,r.FIRST,function(e,t){return m()({},e,{pagination:w.e(w.h.FIRST,e.pagination,t.effect)})}),p()(i,r.NEXT,function(e,t){return m()({},e,{pagination:M(w.e(w.h.NEXT,e.pagination,t.effect))})}),p()(i,r.PREVIOUS,function(e,t){return m()({},e,{pagination:M(w.e(w.h.PREVIOUS,e.pagination,t.effect))})}),i)),O={query:function(e){return e.storeSearch.query},filters:function(e){return e.storeSearch.filters},hasDefaultFilters:function(e){return Object.entries(O.filters(e)).every(function(e){var t=d()(e,2),n=t[0],i=t[1];return Object(_.a)(i,E.filters[n])})},models:function(e){return Object(b.a)(w.g.list(e.storeSearch.pagination),[y.f],e.entities)},cursors:function(e){return w.g.cursors(e.storeSearch.pagination)},isLoading:function(e){return w.g.isLoading(e.storeSearch.pagination)},loading:function(e){return w.g.loading(e.storeSearch.pagination)},hasNextPage:function(e){return w.g.hasNextPage(e.storeSearch.pagination)},hasPreviousPage:function(e){return w.g.hasPreviousPage(e.storeSearch.pagination)}},R=function(e,t){var n=t.animated,i=t.restricted,r=t.pbr,a=t.rigged,o=t.maxPrice,s=t.minPrice,u=t.maxFaceCount,l=t.minFaceCount,h=t.sortBy,d=c()(t,["animated","restricted","pbr","rigged","maxPrice","minPrice","maxFaceCount","minFaceCount","sortBy"]);return m()({},d,{q:e,maxPrice:o===T.b?void 0:o,minPrice:s===T.d?void 0:s,maxFaceCount:u===T.a?void 0:u,minFaceCount:l===T.c?void 0:l,count:24,sortBy:e||"-pertinence"!==h?h:"-likeCount",processingStatus:"succeeded",animated:n||void 0,restricted:i||void 0,pbr:r||void 0,rigged:a||void 0})},P=function(){var e=u()(o.a.mark(function e(t,n){var i,r,a,s,u,l,h,d,f,p,g,v=arguments;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=v.length>2&&void 0!==v[2]?v[2]:null,r=O.filters(n),a=C.a.getSearchQueryParams(O.query(n)),s=a.q,u=c()(a,["q"]),e.next=5,t.searchModels(m()({},R(s,r),u,{cursor:i,inStore:!0}));case 5:return l=e.sent,h=l.results,d=l.cursors,f=Object(b.b)(h,[y.f]),p=f.entities,g=f.result,e.abrupt("return",{entities:p,list:g,cursors:d});case 10:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),I={loadInitialQuery:function(e){var t=e.split("?"),n=d()(t,2)[1],i=void 0===n?"":n,a=Object(x.e)("sort_by",E.filters.sortBy,i),o=Object(x.e)("user","",i),s=Object(x.f)("tags",[],i),u=[o?"user:".concat(o," "):"",s.map(function(e){return"tag:".concat(e)}).join(" "),Object(x.e)("q","",i)].filter(Boolean).join(" "),l={sortBy:"-likeCount"===a?"-pertinence":a,animated:Object(x.a)("animated",E.filters.animated,i),rigged:Object(x.a)("rigged",E.filters.rigged,i),pbr:Object(x.a)("pbr",E.filters.pbr,i),restricted:Object(x.a)("restricted",E.filters.restricted,i),categories:Object(x.f)("categories",E.filters.categories,i),minFaceCount:Object(x.d)("min_face_count",T.c,i),maxFaceCount:Object(x.d)("max_face_count",T.a,i),minRating:Object(x.e)("min_rating",E.filters.minRating,i),fileFormats:Object(x.f)("file_formats",E.filters.fileFormats,i),minPrice:Object(x.d)("min_price",T.d,i),maxPrice:Object(x.d)("max_price",T.b,i),licenses:Object(x.f)("licenses",E.filters.licenses,i)};return{type:r.LOAD_INITIAL_QUERY,payload:{query:u,filters:l,effect:function(t){var n=t.Prefetching.get(e);if(!n)throw new Error('No search response in prefetchedData for query "'.concat(e,'"'));var i=n.results,r=void 0===i?[]:i,a=n.cursors,o=void 0===a?{next:null,previous:null}:a,s=Object(b.b)(r,[y.f]);return{entities:s.entities,list:s.result,cursors:o}}}}},loadFirstPage:function(){return{type:r.FIRST,payload:{effect:function(e){var t=e.Api,n=e.getState;return P(t,n())}}}},loadNextPage:function(){return{type:r.NEXT,payload:{effect:function(e){var t=e.Api,n=e.getState,i=O.cursors(n()).next;return P(t,n(),i)}}}},loadPreviousPage:function(){return{type:r.PREVIOUS,payload:{effect:function(e){var t=e.Api,n=e.getState,i=O.cursors(n()).previous;return P(t,n(),i)}}}},updateQuery:function(e){return{type:r.UPDATE_QUERY,payload:{query:e}}},updateFilters:function(e){return{type:r.UPDATE_FILTERS,payload:{filters:e}}},resetFilters:function(){return I.updateFilters(E.filters)}}},kjuc:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var i=n("gcR/"),r=n.n(i),a=n("pVnL"),o=n.n(a),s=n("QILm"),u=n.n(s),l=n("q1tI"),c=n("G9Ht"),h=n.n(c),d=n("a5AJ"),f=l.createContext([]),p=f.Consumer,g=f.Provider;t.b=function(e){var t=e.model,n=e.children,i=e.suffix,a=void 0===i?"":i,s=u()(e,["model","children","suffix"]);return r()(p,{},void 0,function(e){return l.createElement("a",o()({},s,{href:t.viewerUrl+a,onClick:function(n){var i=n.ctrlKey||n.metaKey;!e||i||h.a.any||(n.preventDefault(),n.stopPropagation(),d.a.push(function(e){return e.replace(window.location.origin,"").replace(/^\//,"")}(t.viewerUrl+a),{playlist:e}))}}),n)})}},ks9Z:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var i=n("gcR/"),r=n.n(i),a=n("q1tI"),o=n.n(a),s=n("/MKj"),u=n("gPpI"),l=n("/f4T"),c=n("M4AY"),h=n("ei2W"),d=function(e){var t=Object(s.d)(),n=Object(s.e)(c.c.authUser.allowsGdpr),i=o.a.useCallback(function(){t(c.a.authUser.allowGdpr())},[t]);return e.children({allowsGdpr:n,onAgree:i})},f=function(e){var t=e.allowsGdpr,n=e.onAgree,i=void 0===n?function(){}:n;return t?null:r()("div",{className:"c-gdpr-banner"},void 0,r()("p",{},void 0,"By continuing to browse Sketchfab, you agree to the use of cookies for advertising and audience measurement purposes. Learn more in our"," ",r()("a",{target:"_blank",href:Object(u.e)("pages:privacy")},void 0,"privacy policy"),"."),r()(l.a,{text:"I agree",size:"medium",onClick:i}))};function p(){return r()(h.a,{},void 0,function(){return r()(d,{},void 0,function(e){return o.a.createElement(f,e)})})}},kxvO:function(e,t,n){"use strict";var i=n("EVdn"),r=n.n(i),a=n("fujP"),o=n("vBtE"),s=n("9mpE"),u=n("dZz+"),l=n("a5AJ"),c=n("gzuT"),h=n("Y14P"),d=n("bLLl"),f=n("9U7P"),p=n("lSNA"),g=n.n(p),m=n("vJtL"),v=n("Ui7z"),_=n("oR1v"),b=Symbol("routeCallbackKey"),S={name:"WithRouteEvents",constructor:function(){var e=this;this[b]={hash:{},onHashChange:function(){window.location.hash&&e[b].hash[window.location.hash]&&e[b].hash[window.location.hash](window.location.hash)}},this.events=Object(v.e)(this.events,function(t,n){var i=Object(_.e)(n);if("route"!==i.eventName)return g()({},n,t);if("string"==typeof t&&!e[t])throw new Error("WithRouteEvents error: ".concat(e.displayName,". ").concat(t," is not defined."));if(!i.selector.match("#"))throw new Error("WithRouteEvents error: ".concat(e.displayName,". ").concat(i.selector," is not supported. Currently only #s are supported."));return e[b].hash[i.selector]=Object(m.a)(t)?t.bind(e):e[t].bind(e),{}})},initialize:function(){this[b].onHashChange()},viewDidMount:function(){window.addEventListener("hashchange",this[b].onHashChange,!1)},viewWillUnmount:function(){window.removeEventListener("hashchange",this[b].onHashChange,!1)}},y=n("sbnD"),x=n("FFzg"),C=o.a.extend({state:{unseenNotifCount:0,documentTitle:document.title},initialize:function(){this.unseenModel=x.a.getSingleton(),this.unseenModel.on("change:activitiesCount",this.updateUnseenNotifCount,this)},updateUnseenNotifCount:function(){this.setState({unseenNotifCount:this.unseenModel.get("activitiesCount")})},renderNotif:function(){var e=this.state.unseenNotifCount;return e&&u.a.me().canAccessFeature("ff_newsfeed_v2")?"("+e+") ":""},render:function(){document.title=this.renderNotif()+this.state.documentTitle}}),w=n("MAI5"),T=n("xM9Z"),M=n("QKgc"),E=n("o1A9"),A=n("XjS/"),O=n("cC4W"),R=n("8jpW"),P=n("ks9Z"),I=n("inCG"),N=Object(w.a)(A.a),L=Object(w.a)(I.c),k=Object(w.a)(O.a),D=Object(w.a)(R.a),F=Object(w.a)(P.a);t.a=o.a.extend({displayName:"Page",mixins:[f.a,y.a,S],isMounted:!0,children:{documentTitle:{selector:"body",viewClass:C},flashMessages:{selector:".js-flash-messages",viewClass:N,shouldCreateChild:function(){return!!document.querySelector(".js-flash-messages")},options:function(){return d.b.getInitialPropsOf("flashMessages")}},header:{selector:".js-header",viewClass:k,shouldCreateChild:function(){return!!document.querySelector(".js-header")},options:function(){return d.b.getInitialPropsOf("header")}},footer:{selector:".js-footer",shouldCreateChild:function(){return!!document.querySelector(".js-footer")},viewClass:D,options:function(){return d.b.getInitialPropsOf("footer")}},banner:{selector:".js-banner",viewClass:L,options:function(){return d.b.getInitialPropsOf("banner")},shouldCreateChild:function(){return!Object(a.a)(d.b.getInitialPropsOf("banner"))&&this.$(".js-banner").length}},gdprBanner:{selector:".js-gdpr-banner",viewClass:F,shouldCreateChild:function(){return!!r()(".js-gdpr-banner").length},options:function(){return d.b.getInitialPropsOf("gdprBanner")}}},events:{'click .flashmessage [data-action="close"]':"flashMessageClose","route #upload":"openUploadPopup"},initialize:function(){o.a.prototype.initialize.apply(this,arguments),s.c.bool("upload")&&this.openUploadPopup(),this.initializeChild("documentTitle"),this.initializeChild("footer"),this.initializeDragAndDrop(),function(){var e=u.a.me();if(e.isAuthenticated()){var t=h.a.get("sf_email_confirmed",void 0);if(void 0!==t){l.a.push(window.location.pathname);var n=!!t;n&&e.get("isEmailConfirmed")?new c.a({content:"Your e-mail has been confirmed.",class:"success",delay:5e3}):n||e.get("isEmailConfirmed")||new c.a({content:"Invalid code. Your current e-mail is "+e.get("email"),class:"error",delay:1e4}),h.a.remove("sf_email_confirmed")}}}(),this.renderChild("header"),this.renderChild("banner"),this.renderChild("gdprBanner"),this.renderChild("flashMessages")},openUploadPopup:function(){Object(E.loadUploadPopup)().then(function(e){return(new e).open()}).catch(Object(M.l)(M.j))},delegateEvents:function(){o.a.prototype.delegateEvents.apply(this,arguments),this.options.dragAndDrop&&this.delegateDragAndDrop(),this.delegateUserSummary()},undelegateEvents:function(){o.a.prototype.undelegateEvents.apply(this,arguments),this.getDragAndDropEnabled()&&this.undelegateDragAndDrop(),this.undelegateUserSummary()},flashMessageClose:function(e){var t=r()(e.target).parents(".notification");t.addClass("hidden"),Object(T.a)(t).then(function(){return t.parent()[0].removeChild(t[0])})},onFilesDrop:function(e){Object(E.loadUploadPopup)().then(function(t){return new t({files:e}).open()}).catch(Object(M.l)(M.j))},isDropPending:function(){return!!this.$("[class*=popup-upload]").not(".hidden").length}})},"l/Ry":function(e,t,n){"use strict";var i=n("a5Z4"),r=n("9oTK"),a=n.n(r),o=n("GWRS"),s=n("htjh"),u=n.n(s),l=n("QLQS"),c=n("12sq"),h=n("vBtE"),d=n("6xPH"),f=!1;window&&window.navigator&&(f=-1!==window.navigator.userAgent.indexOf("Edge"));var p=function(){return f},g=n("FDfc"),m=n("NNol"),v=n("+cEC"),_=n("fgaA"),b=n("par7"),S=n("1f5D"),y=l.a.osg,x=[[.263385,-.0252475],[-.38545,.054485],[-.139795,-.5379925],[-.2793775,.6875475],[.7139025,.4710925],[.90044,-.16422],[.4481775,-.82799],[-.9253375,-.2910625],[.3468025,1.02292],[-1.13742,.33522],[-.7676225,-.9123175],[-.2005775,-1.1774125],[-.926525,.96876],[1.12909,-.7500325],[.9603,1.14625]],C=function(e){return C.instance?C.instance:(this._canBeEnabled=Object(_.a)().supersample,this._viewer=e,this._sampleCount=15,this._isFakeSupersampling=!1,this._isSupersampling=!1,this._frameNum=1,this._frameNumTaa=0,this._switch=!0,this._jitter=S.a.uHalton.getInternalArray(),this._jitter[2]=1,C.instance=this,this)};y.createPrototypeObject(C,{getSampleCount:function(){return this._sampleCount},canBeEnabled:function(){return this._canBeEnabled},getSortedJitterTable:function(){return x},getBackgroundModel:function(){return this._viewer.getFeatures().background.getModel()},getAnimationModel:function(){return this._viewer.getFeatures().animation.getModel()},getWireframeAttenuation:function(){var e=this._viewer.getOrCreateScene().getWireframeNodes();if(!e.length||0===e[0].getNodeMask())return 1;var t=e[0].getStateSet().getUniform("uColor").getInternalArray()[3];return 1-t+.05*t},updateUniforms:function(e,t){var n=e%this._sampleCount,i=this.getSortedJitterTable()[n],r=t?.05:this.getWireframeAttenuation();this._jitter[0]=i[0]*r,this._jitter[1]=i[1]*r,this._jitter[3]=n},setSwitch:function(e){this._switch=e},isTaaJitter:function(){var e=this._postProcess.getModel(),t=e.get("taaEnable"),n="none"!==this.getBackgroundModel().get("enable"),i=void 0!==Object(_.a)().taaJitter?Object(_.a)().taaJitter:n,r=e.get("webVR"),a=this.getAnimationModel().canActivateTAA(),o=0===Object(_.a)().autospin||Object(_.a)().taaAnimation;return a&&t&&i&&!r&&o},updateFrame:function(){if(this._jitter[2]=-this._jitter[2],this._postProcess.getModel().trigger("pingPongTexture0",this._jitter[2]>0),!this._isSupersampling)return this._jitter[2]=Math.sign(this._jitter[2]),b.a._doJitter&&this.isTaaJitter()?(this.updateUniforms(this._frameNumTaa,!0),this._frameNumTaa++):(this._jitter[0]=0,this._jitter[1]=0,this._frameNum=1,this._frameNumTaa=0),b.a._doJitter=!0,!1;b.a._doJitter=!0;var e=this._frameNum%this._sampleCount;return this.updateUniforms(e),this._frameNum++,this.isSupersampled()&&(this._isSupersampling=!1),this._isFakeSupersampling=!1,this._isSupersampling},getFrameNumber:function(){return this._frameNum%this._sampleCount},update:function(e,t){if(!this._switch)return!0;var n=t.getFrameStamp().getFrameNumber();return this._lastUpdateFrame===n||(this._lastUpdateFrame=n,!this._postProcess&&(this._postProcess=this._viewer.getFeatures().postProcess,!this._postProcess)||(this.updateFrame()&&b.a.drawSameFrame(),!0))},isSupersampled:function(){return this._frameNum>=this._sampleCount},isEnabled:function(){return this._isSupersampling},isFakeEnabled:function(){return this._isFakeSupersampling},forceEnable:function(){this._isSupersampling=!0,this._jitter[0]=0,this._jitter[1]=0,this._jitter[2]=2*Math.sign(this._jitter[2]),this._jitter[3]=0,this._frameNum=1,b.a.drawSameFrame()},enable:function(){if(!this.canBeEnabled())return this._isFakeSupersampling||b.a.drawSameFrame(),void(this._isFakeSupersampling=!0);1===this._frameNum&&this.forceEnable()},reset:function(){this._jitter[2]=Math.sign(this._jitter[2]),this._frameNum=1,this._isSupersampling=!1,this._isFakeSupersampling=!1},setRoot:function(e){var t=new y.Node;e.addChild(t),t.addUpdateCallback(C.instance)}});var w=C,T=n("joy8"),M=n("KxLt"),E=n("OL4R"),A=n("JBIC"),O=l.a.osg,R=Object(E.a)(O.Texture),P=["magFilter","minFilter","wrapS","wrapT","textureTarget","internalFormat"],I=["NormalMap","SubsurfaceScattering","Opacity","Displacement","BumpMap","AOPBR","CavityPBR","MetalnessPBR","GlossinessPBR","RoughnessPBR","SpecularF0","SpecularHardness"],N=function(e){return Math.max(0,Math.min(1,e))},L=function(e,t,n){if(void 0!==e.factor){var i=0,r=1;n<=2&&("Opacity"===t?"alphaMask"===e.type?i=.01:"alphaBlend"===e.type&&e.factor>=.99&&(e.factor=1):e.factor<.01&&(e.factor=0)),"BumpMap"===t||"EmitColor"===t?r=10:"SpecularHardness"===t?r=1e4:"Displacement"!==t&&"SubsurfaceScattering"!==t||(r=1e15),e.factor=Math.max(i,Math.min(r,e.factor))}if(e.color)if(I.indexOf(t)>=0)delete e.color;else{var a=e.color;e.color=O.vec3.fromValues(N(a[0]),N(a[1]),N(a[2]))}void 0===e.enable&&(e.enable=!0);var o=e.texture;if(o){!function(e){e.image&&(e.url=e.image,delete e.image);for(var t=0,n=P.length;t<n;++t){var i=P[t];"number"==typeof e[i]&&(e[i]=R[e[i]])}void 0===e.texCoordUnit?e.texCoordUnit=0:"string"==typeof e.texCoordUnit&&(e.texCoordUnit=parseInt(e.texCoordUnit,10)),e.format&&delete e.format}(o);var s=A.a.getPossibleFormat(t);o.internalFormat&&1!==Object.keys(s).length?s[o.internalFormat]||(s.ALPHA?o.internalFormat="ALPHA":s.RGB?o.internalFormat="RGB":o.internalFormat="LUMINANCE"):o.internalFormat=A.a.getDefaultFormatString(t)}},k=function(e){var t=e.channels;t.Geometry&&(t.NormalMap=t.Geometry,delete t.Geometry),t.Reflection&&(void 0===e.reflection&&(e.reflection=t.Reflection.factor),delete t.Reflection),e.cullFace||e.cullFaceMode&&(e.cullFace=e.cullFaceMode,delete e.cullFaceMode),e.depthCheckMode&&(t.Opacity&&!t.Opacity.type&&(t.Opacity.type="alphaBlend"),delete e.depthCheckMode);var n=e.version||0;if(t)for(var i in t)L(t[i],i,n)},D=n("8eYQ"),F=l.a.osg,V=function(e,t,n){return Math.max(t,Math.min(n,e))},B=function(e,t){if("object"==typeof e){for(var n in t.textLog+=" { ",e){t.textLog+=n+": ";var i=e[n];void 0!==i?(B(i,t),t.textLog+=", "):t.textError+="\n "+n+"=> "+t.textLog.substring(Math.max(0,t.textLog.length-125),t.textLog.length)+" <= err"}t.textLog+=" } "}else t.textLog+=JSON.stringify(e)},U=function(e,t){return function(e){if(e.animation){var t=e.animation.autoplay;void 0!==e.animation.autoplay&&(e.animation.initializeWithRestPose=!t,delete e.animation.autoplay)}}(e),function(e){var t=e.camera,n=e.scene;t&&n&&(n.fov&&(t.fov=n.fov,delete n.fov),n.nearFarRatio&&(t.nearFarRatio=n.nearFarRatio,delete n.nearFarRatio))}(e),function(e){if(e.orientation.axis){var t=e.orientation.axis;t=F.vec3.fromValues(V(t[0],0,3),V(t[1],0,3),V(t[2],0,3)),delete e.orientation.axis,t[0]=(4-t[0])%4,t[1]=(4-t[1])%4,t[2]=(4-t[2])%4,e.orientation.matrix=F.mat4.fromRotation(F.mat4.create(),.5*Math.PI*(t[0]+t[1]+t[2]),t)}}(e),function(e){switch(e.shading.type){case"lit":case"matcap":case"shadeless":break;case"blending":case"default":case"default-shading":case"predefined-shading":case"shading":case void 0:e.shading.type="lit";break;default:case"no-shading":e.shading.type="shadeless"}e.shading.vertexColor||"pbr"!==e.shading.renderer||(e.shading.vertexColor={enable:!1,colorSpace:"linear"})}(e),function(e){var t=e.environment;void 0!==t.exposure&&(t.exposure*=void 0!==t.light&&t.light>0?t.light:1);var n=t.backgroundEnable;void 0!==n&&!0===t.enable?e.background.enable=!0===n?"environment":!0===e.background.enable?"fixed":"none":void 0!==e.background.enable&&(!0===e.background.enable?e.background.enable="fixed":!1===e.background.enable&&(e.background.enable="none"))}(e),function(e){var t=e.materials;for(var n in t){var i=t[n];"object"==typeof i?void 0===i.stateSetID?delete t[i.id]:k(i):delete t[n]}}(e),function(e){if(e.lighting.lights)for(var t=e.lighting.lights,n=e.version,i=0,r=t.length;i<r;++i){var a=t[i];a.hardness=Math.max(Math.min(a.hardness,1),0),(void 0===a.castShadows||n<1&&a.attachedToCamera)&&(a.castShadows=!1)}else e.lighting={}}(e),function(e){var t=e.scene&&e.scene.postProcess;if(t){var n=t.ssao;2===e.version&&t.enable&&n&&n.enable&&0===n.bias&&0===n.radius&&(n.ssaoBias=-1,n.ssaoRadius=-1,e.vr.scale=-1);var i=t.vignette;if(i&&i.lens){var r=i.lens;i.amount=1-.5*(r[0]+r[1]),i.hardness=1-.5*(r[0]-r[1]),delete i.lens}}}(e),function(e){var t=e.vr;t&&t.scale&&(t.worldFactor=t.scale)}(e),t?e:Object(o.a)(e,function(t){return void 0===t?(function(e){var t={textLog:"",textError:""};B(e,t),0!==t.textError.length&&D.a.client.captureMessage("Invalid CloneDeepWith: "+t.textError)}(e),[]):t.byteLength?Array.prototype.slice.call(t):void 0})},j=function(e){var t=e.toJSON();return void 0===e.get("vertexCount")&&e.set("vertexCount",t.nbVertexes),void 0===e.get("faceCount")&&e.set("faceCount",t.nbTriangles),void 0===t.options&&(t.options={}),e.set("options",U(t.options,!0)),e.set("files",t.files),e};j.readOptions=U;var G=j,H=n("XIp8"),z=n("owWc"),W=n("Muja"),q=n("UpON"),X=n("1qke"),Y=l.a.osg,K=l.a.osgUtil.NodeGizmo,Q=function(){K.apply(this,arguments),this._forcePicking=!1};Y.createPrototypeNode(Q,Y.objectInherit(K.prototype,{setForcePicking:function(e){this._forcePicking=e},onMouseUp:function(e){this.isEditing()&&b.a.draw();var t=this._attachedNode;K.prototype.onMouseUp.call(this,e),t!==this._attachedNode&&b.a.draw(),this._forcePicking&&!this._attachedNode&&(this._attachedNode=t)},onMouseMove:function(e){var t=this._hoverNode;K.prototype.onMouseMove.call(this,e),this.isEditing()&&b.a.redrawShadow(),(this.isEditing()||t!==this._hoverNode)&&b.a.draw()}}),"osgSketchfab","NodeGizmo");var J=Q,Z=n("EVdn"),$=n.n(Z),ee=n("Hi2/"),te=n("9D1Z"),ne=n("Auie"),ie=n("+vFx"),re=n("T1IQ"),ae=n("4ANv"),oe=l.a.osg,se=l.a.osgAnimation,ue=l.a.osgUtil,le=function(){oe.NodeVisitor.call(this,oe.NodeVisitor.TRAVERSE_PARENTS),this._paths=[],this._halt=void 0};oe.createPrototypeObject(le,oe.objectInherit(oe.NodeVisitor.prototype,{reset:function(){oe.NodeVisitor.prototype.reset.call(this),this._paths.length=0},setHalt:function(e){this._halt=e},apply:function(e){e===this._halt&&this._paths.push(this.nodePath.slice(1)),this.traverse(e)}}));var ce=function(e){oe.NodeVisitor.call(this),this._cullCallback=e?void 0:te.a.hideCullCallback};oe.createPrototypeObject(ce,oe.objectInherit(oe.NodeVisitor.prototype,{apply:function(e){e instanceof oe.Geometry&&e._isBoneBox&&e.setCullCallback(this._cullCallback),this.traverse(e)}}));var he=function(e,t){this._fManager=e,this._viewerWebGL=e.getViewerWebGL(),this._rootModel=this._viewerWebGL.getRootModel(),this._rootFeature=t,this._debugNormal=!1,this._debugTangent=!1,this._debugScale=.5,this._baseScale=.07*this._rootModel.getMinimumBound().radius(),this._normalVisitor=new ue.DisplayNormalVisitor,this._normalVisitor.setScale(this._baseScale*this._debugScale),this._geoColorVisitor=new ue.DisplayGeometryVisitor,this._geoColorVisitor._stCenter.setRenderBinDetails(ee.a.DEBUG_2,"RenderBin"),this._geoColorVisitor._stCenter.setAttribute(new ie.a(!0)),this._debugGeometry=!1,this._debugShadow=!1,this._useGizmo=!1,this._useSync=!1,this._protoUpdateWeights=se.UpdateMorph.prototype.updateWeights,this._protoComputeChannels=se.UpdateMatrixTransform.prototype.computeChannels,this._enableRig=!0,this._collectPathVisitor=new le,this._collectPathVisitor.setHalt(this._fManager.getWorldNode()),this._showBoneBoxes=!1,this._graphVisitor=ue.DisplayGraph.instance(),function(e){var t=Object(E.a)(ee.a);e._graphRender.generateRenderBin=function(e,n){var i=n.className()+" ( "+n.getInstanceID()+" )";n.getName()&&(i+="\n"+n.getName());var r=n.getBinNumber();i+="\n"+t[r]||!1,this._selectables.set(n.getInstanceID().toString(),n),e.addNode(n.getInstanceID(),{label:i,description:"",style:"fill: "+this.getColorFromClassName(n.className())+";stroke-width: 0px;"})}}(this._graphVisitor),this._debugGraphNode="Model",this._debugGraphRenderer=!1,this._displayGraph=!1;var n=this._fManager.getFeatures().camera.getModel();this._enabledConstraints=n.get("enableCameraConstraints"),this._showConstraintsWidget=!1,re.a.initDebug3D(this)};he.prototype={_getSaveAElement:function(){return this._aSave?this._aSave:(this._aSave=document.createElement("a"),document.body.appendChild(this._aSave),this._aSave.style.display="none",this._aSave)},_download:function(e,t){var n=this._fManager._context.getModel("uid").get("uid")+"_";n+=(new Date).toString().split(" ").splice(1,4).join("_").replace(/:/g,"_"),n+=".";var i=this._getSaveAElement();i.href=e,i.download=n+t,i.click()},_getCameraModel:function(){return this._fManager.getFeatures().camera.getModel()},onTakeScreenShot:function(){Object(m.a)(2048,2048,this._viewerWebGL).toBlob(function(e){this._download(URL.createObjectURL(e),"png")}.bind(this),"png",1)},onStartMovieRecord:function(){var e=document.getElementsByClassName("canvas")[0].captureStream(25);this._recorder=new window.MediaRecorder(e,{mimeType:"video/webm; codecs=vp9"});var t=[],n=function(e){var t=window.URL.createObjectURL(e);this._download(t,"webm")}.bind(this);this._recorder.ondataavailable=function(e){e.data&&e.data.size>0&&t.push(e.data)},this._recorder.onstop=function(){n(new Blob(t,{type:"video/webm"}))}.bind(this),this._recorder.start()},onEndMovieRecord:function(){this._recorder&&this._recorder.stop()},onTrianglePick:function(e){if(!this._displayGraph){var t=ne.a.computeNearestIntersection2D(e.canvasX,e.canvasY);if(t){window.hit=t;var n=t._nodePath[t._nodePath.length-1];console.log("Active hit : window.hit"),console.log("Name geometry : "+n.getName()),console.log("Vertex indices : "+t._i1+", "+t._i2+", "+t._i3),console.log("Unique id : "+n._uniqueID);var i={};i[t._i1]={},i[t._i2]={},i[t._i3]={};var r=n.getVertexAttributeList();for(var a in i){var o=i[a];for(var s in a=parseInt(a),r)for(var u=r[s],l=u.getItemSize(),c=u.getElements(),h=o[s]=[],d=0;d<l;++d)h[d]=c[a*l+d]}t.verts=i,console.log("\n")}}},onDebugScale:function(e){this._normalVisitor.setScale(this._baseScale*e),b.a.draw()},onDebugNormal:function(e){this._normalVisitor.setNormalVisibility(e,this._rootModel),b.a.draw()},onDebugTangent:function(e){this._normalVisitor.setTangentVisibility(e,this._rootModel),b.a.draw()},onDebugGeometry:function(){this._debugGeometry?this._geoColorVisitor.setGeometryDebug(this._rootModel):this._geoColorVisitor.disableDebug(this._rootModel),b.a.draw()},onEnableCamConstraints:function(){var e=this._getCameraModel();e.set("enableCameraConstraints",!e.get("enableCameraConstraints"))},onShowConstraintsWidget:function(){var e=this._getCameraModel();e.set("displayGizmo",!e.get("displayGizmo")),e.trigger("refreshConstraints"),b.a.draw()},resetGraph:function(){this._viewerWebGL.getInputManager().setEnable(ae.a.DEBUG_GEOMPICK,!1),this._graphVisitor.reset()},onDisplayGraph:function(){this.resetGraph(),this._displayGraph&&(this._viewerWebGL.getInputManager().setEnable(ae.a.DEBUG_GEOMPICK,!0),q.a.getModelDisplayed().then(this.createDebugGraph.bind(this)))},createDebugGraph:function(){var e;"Model"===this._debugGraphNode?e=this._rootModel:"Feature"===this._debugGraphNode&&(e=this._rootFeature),this._graphVisitor.setDisplayGraphRenderer(this._debugGraphRenderer),this._graphVisitor.createGraph(e),this._graphVisitor.setCallbackSelect(this.onNodeSelect.bind(this)),b.a.draw()},onDebugShadow:function(e){var t=this._fManager.getFeatures().lighting;if(t){t.getModel().set("forceShadowRedraw",e);for(var n=t.getModel().get("lights"),i=0,r=n.length;i<r;++i){var a=n[i];a.getShadowMap()&&(a.getShadowMap().setDebug(e),a.dirty())}b.a.draw()}},onPickSelect:function(e){var t=this._fManager.getWorldNode(),n=ne.a.computeNearestIntersection2D(e.glX,e.glY,void 0,t);n&&(this._graphVisitor.selectNode(n._nodePath[n._nodePath.length-1]),this._graphVisitor.focusOnGraph())},onNodeSelect:function(e){if(e instanceof oe.StateSet){var t=this._fManager.getFeatures().outline.getModel();return t.set("durationOutline",5),t.set("durationHighlight",2.5),void t.trigger("displayOutlineFocus",e,5,2.5)}for(var n=e.getBoundingBox(),i=e.getWorldMatrices(this._fManager.getWorldNode()),r=new oe.BoundingBox,a=0;a<i.length;++a){var o=new oe.BoundingBox;n.transformMat4(o,i[a]),r.expandByBoundingBox(o)}this._fManager.focusOnBound(r,1),this._collectPathVisitor.reset(),e.accept(this._collectPathVisitor);var s=this._collectPathVisitor._paths,u=this._fManager.getFeatures().outline.getNode();u.clearOutlineScene(),u.addPaths(s),u.showOutline()},_getCameraUrl:function(){var e=oe.vec3.create(),t=oe.vec3.create();this._fManager.getCameraWithoutAutospin(e,t);var n=window.location.href;return n+="&camera_eye="+e.join(",")+"&camera_target="+t.join(",")},cameraClipboard:function(){var e=this._getCameraUrl(),t=document.createTextNode(e);document.body.appendChild(t);var n=document.createRange();n.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(n),document.execCommand("copy"),document.body.removeChild(t)},cameraOpen:function(){window.open(this._getCameraUrl())},onEnableRig:function(e){se.UpdateMatrixTransform.prototype.computeChannels=e?this._protoComputeChannels:function(){this._dirty=!0;var e=this._matrix;oe.mat4.identity(e);for(var t=this._stackedTransforms,n=0,i=t.length;n<i;n++){var r=t[n];r.resetToDefaultValue(),r.applyToMatrix(e)}},b.a.draw()},onShowBoneBoxes:function(e){this._rootModel.accept(new ce(e)),b.a.draw()},onUseGizmo:function(e){this._gizmo||(this._gizmo=new J(this._fManager.getViewerOSGJS()),this._rootFeature.addChild(this._gizmo)),this._gizmo.attachToNode(null),this._gizmo.setAutoMatrixTransformInsertion(e),this._gizmo.setCorrectPivotOnAutoInsert(e),this._gizmo.setTraversalMask(e?1:0),b.a.draw()}};var de=function(e,t,n){var i=e.addFolder("Animation");return n._useRig=i.add(t,"_enableRig").name("Use rig"),n._useRig.onChange(t.onEnableRig.bind(t)),function(){var e=se.UpdateMorph.prototype.updateWeights;se.UpdateMorph.prototype.updateWeights=function(){if(void 0!==this._debugActiveTarget){var t=parseInt(this._debugActiveTarget,0);if(-2===t){var n=this._weights;return void(n[0]=n[1]=n[2]=n[3]=0)}if(-1!==t)for(var i=this._targets,r=0,a=i.length;r<a;++r)i[r].value=r===t?1:0}return e.call(this)}}(),function(e,t){var n=function(){oe.NodeVisitor.call(this,oe.NodeVisitor.TRAVERSE_ALL_CHILDREN)};oe.createPrototypeObject(n,oe.objectInherit(oe.NodeVisitor.prototype,{apply:function(t){for(var n=t.getUpdateCallbackList(),i=0,r=n.length;i<r;++i){var a=n[i];if(a instanceof se.UpdateMorph){for(var o={___DEFAULT:-1,"___NO MORPH":-2},s=a._targetNames,u=0,l=s.length;u<l;++u)o[s[u]]=u;a._debugActiveTarget=-1,e.add(a,"_debugActiveTarget",o).name("Name "+a.getName()).onChange(b.a.draw)}}this.traverse(t)}}));var i=new n;t._rootModel.accept(i)}(i,t),n._showBoxes=i.add(t,"_showBoneBoxes").name("Show boxes"),n._showBoxes.onChange(t.onShowBoneBoxes.bind(t)),i.open(),i},fe=function(e,t){var n=function(e){var t=new window.dat.GUI;t.domElement.style.paddingTop="50px";var n=new he(this,e),i={};!function(e,t,n){var i=e.addFolder("Debug graph");n._graphNode=i.add(t,"_debugGraphNode",{Model:"Model",Feature:"Feature",None:"None"}).name("Root"),n._graphNode.onChange(t.onDisplayGraph.bind(t)),n._graphRenderer=i.add(t,"_debugGraphRenderer").name("Renderer"),n._graphRenderer.onChange(t.onDisplayGraph.bind(t)),n._displayGraph=i.add(t,"_displayGraph").name("Display graph"),n._displayGraph.onChange(t.onDisplayGraph.bind(t)),i.open()}(t,n,i),function(e,t,n){var i=e.addFolder("Display vectors");n._showNormal=i.add(t,"_debugNormal").name("Display normal"),n._showNormal.onChange(t.onDebugNormal.bind(t)),n._showTangent=i.add(t,"_debugTangent").name("Display tangent"),n._showTangent.onChange(t.onDebugTangent.bind(t)),n._vectorScale=i.add(t,"_debugScale").min(0).max(2).name("Scale vectors"),n._vectorScale.onChange(t.onDebugScale.bind(t)),i.open()}(t,n,i),de(t,n,i),function(e,t,n){var i=e.addFolder("Camera");n._enableConstraints=i.add(t,"_enabledConstraints").name("Constraints"),n._enableConstraints.onChange(t.onEnableCamConstraints.bind(t)),n._showConstraintsWidget=i.add(t,"_showConstraintsWidget").name("Show widget"),n._showConstraintsWidget.onChange(t.onShowConstraintsWidget.bind(t)),n._cameraClipboard=i.add(t,"cameraClipboard").name("Copy clipboard"),n._cameraOpen=i.add(t,"cameraOpen").name("Open new tab"),i.open()}(t,n,i),function(e,t,n){var i=e.addFolder("Misc");n._showGeometry=i.add(t,"_debugGeometry").name("Display geometry"),n._showGeometry.onChange(t.onDebugGeometry.bind(t)),n._gizmo=i.add(t,"_useGizmo").name("Use gizmo"),n._gizmo.onChange(t.onUseGizmo.bind(t)),i.add(t,"_debugShadow").name("Debug Shadow").onChange(t.onDebugShadow.bind(t)),i.add({ScreenShot:t.onTakeScreenShot.bind(t)},"ScreenShot"),i.add({StartRec:t.onStartMovieRecord.bind(t)},"StartRec"),i.add({StopRec:t.onEndMovieRecord.bind(t)},"StopRec"),i.open()}(t,n,i)}.bind(e,t);$.a.getScript("https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5/dat.gui.min.js").done(n)},pe=n("AhqU"),ge=n("LlpJ"),me=n("h/Nh"),ve=l.a.osg,_e=l.a.osgAnimation,be=ve.BufferArray.randa,Se={},ye=function(e,t,n){e._listQuantUV||(e._listQuantUV=[]);var i="uQUV"+n.substr(8),r=t._objQUV;if(r)return-1===e._listQuantUV.indexOf(r)&&e._listQuantUV.push(r),void(r.uniformName!==i&&e._listQuantUV.push({uniformName:i,_QUV:r._QUV}));var a=t.computeMinMaxUV(Se),o=ve.vec4.fromValues(a.xmin,a.ymin,a.xmax-a.xmin,a.ymax-a.ymin);t._QUV=o,r={uniformName:i,_QUV:o},t._objQUV=r,e._listQuantUV.push(r),S.a[i]||(S.a[i]=ve.Uniform.createFloat4(i))},xe=function(){ve.ComputeBoundsVisitor.call(this),this.nodeMaskOverride=-1};ve.createPrototypeObject(xe,ve.objectInherit(ve.NodeVisitor.prototype,{apply:function(e){if(e instanceof ve.Geometry!=!1){var t=(e.getSourceGeometry?e.getSourceGeometry():e)instanceof _e.MorphGeometry;if(!e._qcomp){e._qcomp=!0;var n=e.getVertexAttributeList();if(!t){var i=n.Vertex;i&&function(e,t){if(t._QVT)return e._QVT=t._QVT,void(e._QVS=t._QVS);var n=t._minMax||t.computeMinMaxVertex(Se),i=ve.vec3.fromValues(n.xmax-n.xmin,n.ymax-n.ymin,n.zmax-n.zmin);ve.vec3.div(i,i,be);var r=ve.vec3.fromValues(n.xmin,n.ymin,n.zmin);t._QVT=r,t._QVS=i,e._QVT=r,e._QVS=i}(e,i);var r=n.Normal;r&&(r._QNOR=!0);var a=n.Tangent;a&&(a._QTAN=!0)}for(var o in n)o.startsWith("TexCoord")&&ye(e,n[o],o)}}else this.traverse(e)}}));var Ce=xe,we=n("drU4"),Te=n("kUJ5"),Me=n("dERi"),Ee=n("JQdh"),Ae=n("IKww"),Oe=n("d1qz"),Re=n("PnIl"),Pe=l.a.osg,Ie=function(e,t){this._viewerWebGL=e,this._viewerOSGJS=e.getViewerOSGJS(),this._urlOptions=e.options,this._features=e.getFeatures(),this._context=t,this._canvas=e.getCanvas(),this._nodeGizmo=null,Object(Oe.a)(this)};Ie.prototype={getFeatures:function(){return this._features},getCanvas:function(){return this._canvas},getViewerWebGL:function(){return this._viewerWebGL},getViewerOSGJS:function(){return this._viewerOSGJS},getRootModel:function(){return this._viewerWebGL.getRootModel()},getWorldNode:function(){return this._features.autospin.getNode()},getTextureDepth:function(){return this._features.postProcess.getCamera()._textureDepth},getViewport3d:function(){return this._features.postProcess.getCamera().getViewport()},getIconScaleFov:function(e){e||(e=this._viewerOSGJS.getCamera().getProjectionMatrix());var t=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]);return.02*this.getViewport3d().width()*t/Te.a.getPixelRatio()[0]},getResourceManager:function(){return this._resourceManager||T.default.instance},getCurrentTabName:function(){if(this._urlOptions.widgetAPI)return this._urlOptions.widgetAPI.getTabbedWidget().get()},getTargetAndEyeFocusFromBound:function(e,t,n){if(!e.valid())return!1;var i=this._viewerOSGJS.getManipulator(),r=i.getCurrentManipulator().getHomeBoundingSphere();r.volume()<e.volume()&&(e=r),Pe.vec3.copy(t,e.center(t));var a=i.getHomeDistance(e);return i.getEyePosition(n),Pe.vec3.sub(n,t,n),n[2]=0,Pe.vec3.normalize(n,n),Pe.vec3.scale(n,n,a),Pe.vec3.sub(n,t,n),!0},focusOnBound:function(){var e=Pe.vec3.create(),t=Pe.vec3.create();return function(n,i,r){return!!this.getTargetAndEyeFocusFromBound(n,e,t)&&this.focusOnTargetAndEye(e,t,i,r)}}(),focusOnTargetAndEye:function(){var e=Pe.vec3.create();return function(t,n,i,r){var a=this._features.camera;if(!a)return!1;var o=this._viewerOSGJS.getManipulator();if(!i||i<0)return o.setTargetAndEye(t,n),!0;var s=a.getModel();return t||(t=o.getTarget(e)),n||(n=o.getEyePosition(e)),s.setTargetAndEye(t,n,r),s.set("animationDuration",i),!0}}(),focusOnHomePosition:function(e){var t=this._features.camera;if(t&&t.getModel()){var n=t.getManipulator().getCurrentManipulator(),i=n.getHomeBoundingSphere(),r=i.center(),a=n.getEyePosition(Pe.vec3.create());Pe.vec3.sub(a,r,a),Pe.vec3.normalize(a,a),Pe.vec3.scale(a,a,n.getHomeDistance(i)),Pe.vec3.sub(a,r,a),this.focusOnTargetAndEye(r,a,e)}},focusOnSavedCamera:function(e){var t=this._context.getModel().get("options"),n=Object(_.a)(),i=this._viewerOSGJS.getManipulator(),r=n.cameraTarget||t.camera.target,a=n.cameraEye||t.camera.position,o=a&&null!==a[0];return o?o&&!this._features.camera.getModel().validateEyeTarget(a,r)?i.computeHomePosition():void this.focusOnTargetAndEye(r,a,e):i.computeHomePosition()},updateFocusOnAutoHit:function(){if(!this._autoHit.get("focus"))return!0;var e=Object(Oe.e)(this._autoHit),t=this._features.camera.getManipulator().getCurrentManipulator(),n=t.getEyePosition(Pe.vec3.create()),i=t.getTarget(Pe.vec3.create()),r=Pe.vec3.create(),a=Pe.vec3.create();return 1===Object(_.a)().cameraFollowBones?(Pe.vec3.sub(a,e,i),Pe.vec3.add(r,n,a),Pe.vec3.copy(a,e)):(Pe.vec3.sub(r,e,n),Pe.vec3.normalize(r,r),Pe.vec3.scale(r,r,Pe.vec3.dist(n,i)),Pe.vec3.sub(r,e,r),Pe.vec3.copy(a,e)),Pe.vec3.lerp(a,i,a,.25),Pe.vec3.lerp(r,n,r,.25),this.focusOnTargetAndEye(a,r,0),!0},setInitialAnimation:function(){if(this._features.camera.getModel().shouldPlayFirstCameraAnimation()){var e=Pe.vec3.create(),t=Pe.vec3.create(),n=this._viewerOSGJS.getManipulator();n.getEyePosition(t),n.getTarget(e);var i=[e[0]-t[0],e[1]-t[1],0],r=i[0]>i[1]?0:1,a=0===r?1:0,o=Pe.vec3.create();o[a]=1;var s=i[r]<0?-1:1;o[2]=.2*s;var u=1.5*Ee.a.getModelBoxWithDisplacement().radius();Pe.vec3.scale(o,o,10*u*s);var l=Pe.vec3.add(Pe.vec3.create(),t,o);n.setEyePosition(l),this.focusOnTargetAndEye(e,t,2.5);var c=this._features.autospin.getModel();c.set("speed",-c.get("speed")*s)}else q.a.resolveFirstCameraAnimation()},focusOnHit:function(e,t,n){var i=Pe.vec3.create();ne.a.getWorldPositionFromHit(e,i);var r=this._features.camera.getManipulator().getCurrentManipulator(),a=r.getEyePosition(Pe.vec3.create()),o=n*r.getHomeDistance(r.getHomeBoundingSphere());Pe.vec3.dist(i,a)>o&&(Pe.vec3.sub(a,i,a),Pe.vec3.normalize(a,a),Pe.vec3.scale(a,a,o),Pe.vec3.sub(a,i,a)),this.focusOnTargetAndEye(i,a,t,!0)},_focusDof:function(e,t){var n=this._features.postProcess.getModel();ne.a.getPixelDepth(e,t,function(e,t,i){if(!(e<0||e>=1)){var r=n.get("dofFocusPoint");ne.a.getWorldPositionFromDepthXY(e,t,i,r),n.trigger("change:dofFocusPoint",r)}})},onSingleClick:function(){var e=Pe.vec3.create(),t=Pe.vec3.create(),n=Pe.vec2.create();return function(i){var r=i.canvasX,a=i.canvasY,o=this._features.postProcess.getModel();o.get("enable")&&o.get("dofEnable")&&this._focusDof(i.glX,i.glY);var s="materials"===this.getCurrentTabName(),u="split"===this._features.inspector.getModel().get("splitType")||s,l=this._viewerWebGL.getViewerAPI(),c=l&&l.intersectPoint||u,h=this._features.ARKit.getModel();if(h.get("enable")&&h.trigger("pick",Pe.vec2.fromValues(r,a)),c){var d=ne.a.computeNearestIntersection2D(r,a);if(u&&this._singleClickOnInspector(d),d){var f=t,p=l&&l.intersectPoint?e:void 0;ne.a.getWorldPositionFromHit(d,f,p),l&&l.intersectPoint&&(n[0]=r,n[1]=a,l.intersectPoint(d,f,n,p))}}}}(),_singleClickOnInspector:function(e){var t=e&&ne.a.getMaterialFromHit(e);if(t){var n=this._features.inspector.getModel(),i=t.get("id");n.get("material")===i?n.trigger("change:material",n,i):n.set("material",i)}else this._features.outline.getModel().trigger("hideOutline")},onDoubleClick:function(e){if(Object(_.a)().doubleClick){var t=this._features.camera;if(!t.getModel().get("webVR")&&t.canMoveTarget())if(this._autoHit&&this._autoHit.get("focus")&&this._autoHit.set("focus",!1),e.pointers&&e.pointers.length>1)this.focusOnHomePosition(1);else{var n=ne.a.computeNearestIntersection2D(e.canvasX,e.canvasY);if(n){var i=this.getCurrentTabName();"virtual reality and augmented reality"!==i?"annotations"!==i&&"sound"!==i&&(Object(_.a)().cameraFollowBones&&Object(X.a)(n._nodePath)?(Object(Oe.b)(this._autoHit,n),this._autoHit.set("focus",!0)):(this._features.outline.getModel().trigger("clearFocusTimeout"),this.focusOnHit(n,1,.2))):this._features.webVR.getModel().trigger("doubleTap",n)}else this.focusOnHomePosition(1)}}},preloadMaxBackground:function(){var e=this._features.background;if(e){var t=e.getModel();if(t&&"fixed"===t.get("enable")){var n=t.getBackground();if(n){var i=n.findImageNearestUpToResolution(window.screen.width,window.screen.height);i&&this.getResourceManager().getOrCreateTexture(i.url,{minFilter:Pe.Texture.LINEAR,magFilter:Pe.Texture.LINEAR,transferToGPU:!1,convertNPOT:!1,internalFormat:Pe.Texture.RGB})}}}},applyAutospinToCamera:function(e,t){var n=this._features.autospin;if(n){var i=n.getNode().getMatrix();Pe.vec3.transformMat4(e,e,i),Pe.vec3.transformMat4(t,t,i)}},getCameraWithoutAutospin:function(){var e=Pe.mat4.create();return function(t,n){var i=this._viewerOSGJS.getManipulator();i.getEyePosition(t),i.getTarget(n);var r=this._features.autospin;r&&(Pe.mat4.invert(e,r.getNode().getMatrix()),Pe.vec3.transformMat4(t,t,e),Pe.vec3.transformMat4(n,n,e))}}(),createGizmoNode:function(){var e=new Pe.Camera;e.getOrCreateStateSet().setRenderBinDetails(ee.a.EDITOR_GIZMO,"RenderBin");var t=this._nodeGizmo=new J(this._viewerOSGJS);t.setTraversalMask(pe.a.PICK_GIZMO_LIGHT),e.addChild(t);var n=this._urlOptions.widgetAPI;if(n){var i=this._features.orientation;n.getTabbedWidget().model.on("change:value",function(){t.attachToNode(null),i&&i.getModel().set("showGizmo",!1)})}return e},setManipulatorNode:function(e){this._features.camera?this._features.camera.getModel().set("node",e):this._viewerOSGJS.getManipulator().setNode(e)},getNodeGizmo:function(){return this._nodeGizmo},initializePreciseBoundManager:function(){var e=this._features.orientation.getNode();Ee.a.computePreciseBox(e);var t=Ee.a.getModelBoxWithDisplacement();e.getBoundingBox().copy(t);var n=e.getBoundingSphere();n.set(t.center(n.center()),t.radius()),ne.a.init(this._context,this.getRootModel())},initGraph:function(e){var t=this._features,n=new Pe.Node;n.getOrCreateStateSet().setAttributeAndModes(Re.a.CULL_DISABLE),n.setName("FeatureManager - Root"),n.addChild(we.a),we.a.initReadyForHighResBound();var i=t.orientation,r=t.autospin,a=t.outline,o=t.ground,s=t.environment,u=t.lighting,l=t.camera,c=t.sound,h=t.hotspot,d=t.postProcess,f=t.webVR,p=t.ARKit,g=t.inspector,m=u.getNodeShadow(),v=n;d&&(n.addChild(d.getNodeIn()),v=d.getNodeOut()),v.addChild(this.createGizmoNode(v)),v.addChild(m),v=m;for(var _=[l,s,u,c,f,h,g,a,r,p,o,i],b=0,S=_.length;b<S;++b){var y=_[b];if(y){var x=y.getNodeIn?y.getNodeIn():y.getNode(),C=y.getNodeOut?y.getNodeOut():y.getNode();v.addChild(x),v=C}}return v.addChild(e),n},addGlobalUniforms:function(){var e=this._features.postProcess.getNodeIn().getOrCreateStateSet();for(var t in S.a)e.addUniform(S.a[t])},finished:function(e){var t=this._features,n=this.getRootModel();n.setNodeMask(pe.a.PICK_GEOMETRY_SHADOW),n.setName("Scene - RootModel"),v.a.nodeRootModel=n;var i=this._viewerOSGJS.getCamera();Ae.a.setCamera(i),n.addUpdateCallback(Ae.a);var r=this.initGraph(n);e.addChild(r),this.setManipulatorNode(this._features.orientation.getNode()),this.preloadMaxBackground();var a=t.lighting;a&&a.getModel().initLights(t.material.getSceneLights());var o=t.environment;o&&o.getNode().init(i,a.getNodeShadow());if(window.sketchfabViewerStats.shadows>1&&Pe.WebGLCaps.instance().getWebGLParameter("MAX_FRAGMENT_UNIFORM_VECTORS")<65)for(var s=a.getModel().get("lights"),u=window.sketchfabViewerStats.shadows-1,l=0;l<3&&0!==u;l++){var c=s[l];c.get("enable")&&c.isCastingShadows()&&(c._enableShadow=!1,u--)}return Te.a.init(this._canvas,this._features.quality.getModel(),this._viewerOSGJS.getCanvasPixelRatio()),this.focusOnSavedCamera(),this._features.camera&&this._features.camera.getModel().saveCameraPosition(),re.a.initGlobalClickEvents(this,this._canvas),this._viewerOSGJS.getInputManager().setEnable("global_click_events",!0),n.getOrCreateStateSet().setAttribute(new ie.a),Object(_.a)().zz?(n.accept(new Ce),q.a.getWireframeOptimizedSplit().then(function(){n.accept(new Ce),q.a.resolveWireframeOptimizedSplitCompressed()})):q.a.getWireframeOptimizedSplit().then(q.a.resolveWireframeOptimizedSplitCompressed),this.addGlobalUniforms(),Pe.time("drawFirstFrame"),this._viewerWebGL.drawFrame(),Pe.timeEnd("drawFirstFrame"),this.initializePreciseBoundManager(),t.webVR&&t.webVR.getModel().initAfterFirstFrame(),t.postProcess&&t.postProcess.getModel().initAfterFirstFrame(),t.camera&&t.camera.getModel().initAfterFirstFrame(),t.lighting&&t.lighting.getModel().set("forceShadowRedraw",!0),Pe.time("drawSecondFrame"),this._viewerWebGL.drawFrame(),Pe.timeEnd("drawSecondFrame"),t.lighting&&t.lighting.getModel().set("forceShadowRedraw",!1),Object(d.a)()&&(q.a.getFirstAnimation().then(function(){this.registerOptionsJSON(this._viewerWebGL.getOptionsJSON())}.bind(this)),window.addEventListener("beforeunload",this.onBeforeUnload.bind(this),!1)),!Object(me.a)()&&"onhashchange"in window&&window.addEventListener("hashchange",this._hashChanged.bind(this),!1),Object(_.a)().debug3D&&fe(this,r),Object(_.a)().cameraFollowBones&&(this._autoHit=new Me.a,r.addUpdateCallback({update:this.updateFocusOnAutoHit.bind(this)})),r},_registerCollection:function(e){e.each(function(e){e.registerOptions()})},registerOptionsJSON:function(e){this._lastOptions=Object(H.a)(e);var t=this._features;this._registerCollection(t.animation.getModel().get("animations")),this._registerCollection(t.hotspot.getModel().get("hotspots"))},getUnsavedChanges:function(){var e=this._viewerWebGL.getOptionsJSON();return Object(z.a)(this._lastOptions,function(t,n,i){return Object(W.a)(n,e[i])?t:t.concat(i)},[])},getUnsavedMessage:function(){var e=this.getUnsavedChanges();if(0!==e.length){var t="You have unsaved changes:\n";return t+="- "+e.join("\n- "),t+="\n\nYou might want to save your changes before leaving."}},onBeforeUnload:function(e){var t=this.getUnsavedMessage();return t&&(e.returnValue=t),t},_hashChanged:function(){var e={};e=Object(ge.a)(e),this._features.material.getModel().overrideMaterialChannels(e);var t=Object(_.a)();!t.debug3D&&Boolean(e.debug3D)&&(t.debug3D=!0,fe(this,this.getRootModel())),!t.stats&&Boolean(e.stats)&&(t.continuousRender=!0,t.stats=!0,this._viewerOSGJS.initStats({getBoolean:function(e){return"stats"===e}})),this._features.inspector.getModel().set("uiVisible",Boolean(e.inspector))},getShadowForcedUpdate:function(){return!!Object(_.a)().shadow&&(!!b.a.getShadowForcedUpdate()||(!!this._viewerWebGL.getSuperSample().isEnabled()||(!!this._features.lighting.getModel().get("forceShadowRedraw")||(!!this._features.autospin.getModel().get("enable")||!!this._features.animation.getModel().isPlaying()))))}};var Ne=Ie,Le=n("w3fr"),ke=n("t8Ru"),De=n("kZIE"),Fe=n("G9Ht"),Ve=n.n(Fe),Be=l.a.osg,Ue=l.a.osgShader.shaderProcessor,je=Math.random(),Ge=function(e,t){this._vertDefines=[],this._fragDefines=[],this._vertAssignUV=[],this._envBrdf,this._envSpecular,this._compression,this._material,this._skinning,this._morphing,this._pointSize,this._lights=[],this._shadows=[],this._shadowsTextures=[],this._targetByUnit=[],this.initAttributes(e),this.initTextureAttributes(t);var n=this._material?this._material.getMaterialModel():void 0;this._channels=n?n.getChannels():void 0,Ve.a.apple.device&&this._vertDefines.push("#define IS_IOS"),this.defineShaderName(),this.initDefines()};Be.setStateAttributeConfig(Ge,{attribute:["VertexCompression","SketchfabLight0","SketchfabLight1","SketchfabLight2","SketchfabLight3","ShadowReceive0","ShadowReceive1","ShadowReceive2","ShadowReceive3","SketchfabMaterial","Morph","Skinning","PointSize"],textureAttribute:["Texture"]}),Be.createPrototypeObject(Ge,{getCompilerName:function(){return"PBR"},getFragmentMain:function(){return"pbr.frag"},getVertexMain:function(){return"pbr.vert"},initAttributes:function(e){for(var t=this._lights,n=this._shadows,i=0,r=e.length;i<r;i++){var a=e[i].className();"Light"===a?t.push(e[i]):"Material"===a?this._material=e[i]:"ShadowReceiveAttribute"===a?n.push(e[i]):"SkinningAttribute"===a?this._skinning=e[i]:"MorphAttribute"===a?this._morphing=e[i]:"PointSizeAttribute"===a?this._pointSize=e[i]:"VertexCompression"===a&&(this._compression=e[i])}},initTextureAttributes:function(e){for(var t=e.length,n=0;n<t;n++){var i=e[n];if(i)for(var r=0,a=i.length;r<a;r++){var o=i[r];this._targetByUnit[n]=o;var s=o.className();if("TextureEnvironment"===s){var u=o.getChannel();"SpecularPBR"===u?this._envSpecular=o:"Specular"===u?this._envSpecular=o:"IntegrateBRDF"===u&&(this._envBrdf=o)}"ShadowTexture"!==s&&"ShadowTextureAtlas"!==s||this._shadowsTextures.push(o)}}},defineShaderName:function(){this._vertDefines.push("#define SHADER_NAME "+this.getVertexShaderName()),this._fragDefines.push("#define SHADER_NAME "+this.getFragmentShaderName());var e=(1-Object(_.a)().epsilonAlpha).toExponential();this._fragDefines.push("#define EPSILON_ALPHA "+e)},getFragmentShaderName:function(){var e=this.getCompilerName(),t=this._material&&this._material.getName();t&&(e+="("+(t=t.replace(/[^a-zA-Z0-9]+/g,"_").slice(0,20))+")");var n,i=this._channels&&this._channels.Opacity,r=i&&i.isEffective()&&i.get("type");if(n="alphaBlend"===r||"additive"===r?"Blend":"refraction"===r?"Refract":"alphaMask"===r||"dithering"===r?"MaskDither":"Opaque"){var a=this.getCompilerName();e=e.replace(a,a+"_"+n)}return e},getVertexShaderName:function(){return this.getFragmentShaderName()},getDebugIdentifier:function(){var e=this.getVertexShaderName(),t=this.getFragmentShaderName();return e===t?t:e+"|"+t},createShader:function(e){var t=e?this.getFragmentMain():this.getVertexMain(),n=e?this._fragDefines:this._vertDefines;e||n.push("#define ASSIGN_UV "+this._vertAssignUV.join(" ")),n=Ue.getSortedUnique(n);for(var i="",r=0;r<n.length;++r)n[r]&&(i+=n[r]+"\n");return i=(i="#define SHADER_NAME "+this.getFragmentShaderName()+"\n"+i)+'#pragma include "'+t+'"',Ue.processShader(i)},createFragmentShader:function(){return this.createShader(!0)},createVertexShader:function(){return this.createShader(!1)},declareAndAssignTexCoord:function(e,t){var n="TexCoord"+e;if(this._vertDefines.push("attribute vec2 "+n+";"),t&&!this._compression)return n;var i="vTexCoord"+e,r="varying vec2 "+i+";",a="vec2 "+i+";";if(t)-1===this._vertDefines.indexOf(r)&&this._vertDefines.push("vec2 "+i+";");else{this._fragDefines.push(r),this._vertDefines.push(r);var o=this._vertDefines.indexOf(a);-1!==o&&this._vertDefines.splice(o,1)}var s=i+" = ";if(this._compression){var u="uQUV"+e;this._vertDefines.push("uniform vec4 "+u+";"),s+=n+".xy * "+u+".zw + "+u+".xy;"}else s+=n+";";return-1===this._vertAssignUV.indexOf(s)&&this._vertAssignUV.push(s),i},_getTexCoordTransforms:function(e,t){var n="u"+t;return e="vec2( mat2("+n+"UVTransforms) * "+e,e+=" + "+n+"UVOffset)"},getChannelUV:function(e){var t=e.getName();if(!e.getTextureModel()){var n=A.a.getColorPacking(t);return 0===n?"vec2(0.125, 0.5)":1===n?"vec2(0.375, 0.5)":2===n?"vec2(0.625, 0.5)":"vec2(0.875, 0.5)"}var i="Displacement"===e.get("name"),r=this.declareAndAssignTexCoord(e.getTexCoordUnit(),i);return e.get("UVTransforms")&&(r=this._getTexCoordTransforms(r,e.get("name"))),r},defineOpacity:function(e){var t=e.get("type");"alphaBlend"!==t&&"additive"!==t?"alphaMask"!==t&&"dithering"!==t?(this._fragDefines.push("#define HAS_OPACITY_REFRACTION"),e.get("useNormalOffset")&&this._fragDefines.push("#define HAS_REFRACTION_NORMAL_OFFSET"),e.get("useAlbedoTint")&&this._fragDefines.push("#define HAS_REFRACTION_ALBEDO_TINT"),e.get("useMicrosurfaceTexture")&&this._fragDefines.push("#define HAS_REFRACTION_MICROSURFACE"),Object(_.a)().depthMipmap&&this._fragDefines.push("#define DEPTH_MIPMAP")):this._fragDefines.push("#define HAS_OPACITY_MASK_OR_DITHER"):this._fragDefines.push("#define HAS_OPACITY_BLEND_OR_ADDITIVE")},defineChannel:function(e){var t=e.getName();if(e.isEnableEffectiveHardware(this._material)){var n="Displacement"===t?this._vertDefines:this._fragDefines,i=t.toUpperCase();if(n.push("#define HAS_"+i),"NormalMap"!==t&&"Inspector"!==t||this._vertDefines.push("#define HAS_"+i),e.isEffective()){"NormalMap"!==t&&"BumpMap"!==t&&"ClearCoatNormalMap"!==t&&"Anisotropy"!==t||(this._fragDefines.push("#define HAS_VIEW_TANGENT"),this._vertDefines.push("#define HAS_VIEW_TANGENT")),"Opacity"===t&&this.defineOpacity(e),"Displacement"===t&&(Object(_.a)().substanceDisplacement?n.push("#define HAS_SUBSTANCE_DISPLACEMENT"):n.push("#define HAS_SKETCHFAB_DISPLACEMENT"));var r=A.a.getColorPacking(t);if(e.getTextureModel()||!(r<0)){var a=this._material.getChannelMapping(t);if(!(void 0===a||a<0)){var o=this._targetByUnit[a],s=o.getName(),u=o.getChannelPacking(t),l=e.getSRGB()?"sRGBToLinear":"",c=t.toUpperCase(),h=this.getChannelUV(e);n.push("uniform sampler2D "+s+";"),n.push("uniform vec4 u"+t+"UVTransforms;"),n.push("uniform vec2 u"+t+"UVOffset;"),n.push("#define SAMPLER_"+c+" "+s),n.push("#define PACK_"+c+" "+u),n.push("#define UV_"+c+" "+h),n.push("#define COLOR_CONVERT_"+c+" "+l)}}}}},defineVertexColorAndAlpha:function(){if(this._material&&this._material.getVertexColorEnable()){this._fragDefines.push("#define HAS_VERTEX_COLOR"),this._vertDefines.push("#define HAS_VERTEX_COLOR");var e="srgb"===this._material.getVertexColorColorSpace()?"sRGBToLinear":"";this._fragDefines.push("#define COLOR_CONVERT_VERTEX_COLOR "+e),this._material.getVertexAlphaEnable()&&(this._fragDefines.push("#define HAS_VERTEX_ALPHA"),this._vertDefines.push("#define HAS_VERTEX_ALPHA"))}},defineLights:function(){var e=this._lights;if(e.length){for(var t=0;t<e.length;++t){var n=e[t],i=n.getLightNumber(),r="LIGHT_"+n.getLightType();this._fragDefines.push("#define LIGHT_TYPE_"+i+" "+r)}this._fragDefines.push("#define HAS_LIGHT")}},defineShadows:function(){var e=this._shadows;if(e.length){for(var t=0;t<e.length;++t){var n=e[t];this._fragDefines.push("#define HAS_SHADOW_"+n.getLightNumber()),this._fragDefines.push.apply(this._fragDefines,n.getDefines())}this._fragDefines.push("#define HAS_SHADOW"),this._vertDefines.push("#define HAS_MODEL_VERTEX"),this._vertDefines.push("#define HAS_MODEL_NORMAL")}},defineEnvironment:function(){this._envSpecular&&(this._fragDefines.push("#define HAS_ENVIRONMENT"),this._envSpecular.getIsCubemap()?this._fragDefines.push("#define ENV_CUBEMAP"):this._fragDefines.push("#define ENV_PANORAMA")),this._envBrdf&&this._fragDefines.push("#define HAS_ENVIRONMENT_BRDF")},defineSsr:function(){De.a.get("hasSsr")&&(this._fragDefines.push("#define HAS_SSR"),Object(_.a)().ssrTransparent&&this._fragDefines.push("#define HAS_SSR_TRANSPARENT"),Object(_.a)().depthMipmap&&-1===this._fragDefines.indexOf("#define DEPTH_MIPMAP")&&this._fragDefines.push("#define DEPTH_MIPMAP"))},defineSkinning:function(){this._skinning&&(this._vertDefines.push("#define HAS_SKINNING"),this._vertDefines.push("#define NUM_BONES "+this._skinning.getBoneUniformSize()))},defineMorphing:function(){this._morphing&&this._morphing.hasTarget("Vertex")&&(this._vertDefines.push("#define HAS_MORPHING"),this._vertDefines.push("#define NUM_TARGETS "+this._morphing.getNumTargets()),this._morphing.hasTarget("Normal")&&this._vertDefines.push("#define HAS_MORPHING_NORMAL"),this._morphing.hasTarget("Tangent")&&this._vertDefines.push("#define HAS_MORPHING_TANGENT"))},defineChannels:function(){var e=this._channels;for(var t in e)this.defineChannel(e[t])},_randHardcodedScale:function(){var e,t=Be.BufferArray.randa,n=t[0],i=t[1],r=t[2];je>.5?e="* ":(e="/ ",n=1/n,i=1/i,r=1/r),n=n.toExponential(),i=i.toExponential(),r=r.toExponential();var a=Math.random();return a<.33?e+"vec3("+r+","+n+","+i+").yzx":a<.66?e+"vec3("+i+","+r+","+n+").zxy":e+"vec3("+r+","+n+","+i+").yzx"},defineCompression:function(){this._compression&&Object(_.a)().zz&&(this._vertDefines.push("#define RAND_SCALE "+this._randHardcodedScale()),this._vertDefines.push("#define HAS_COMPRESSION"),Object(_.a)().zoct&&this._vertDefines.push("#define HAS_OCT_COMPRESSION"),Object(_.a)().zw&&this._vertDefines.push("#define HAS_ZW_COMPRESSION"))},definePointSize:function(){this._pointSize&&(this._vertDefines.push("#define HAS_POINT_SIZE"),this._pointSize.isCircleShape()&&this._fragDefines.push("#define HAS_POINT_CIRCLE"))},initDefines:function(){this.defineChannels(),this.defineVertexColorAndAlpha(),this.defineLights(),this.defineShadows(),this.defineEnvironment(),this.defineSsr(),this.defineMorphing(),this.defineSkinning(),this.defineCompression(),this.definePointSize(),De.a.get("mask")&De.a.CLASSIC&&(this._fragDefines.push("#define HAS_LEGACY_CLASSIC"),"PBR"===this.getCompilerName()&&(this._fragDefines.push('#pragma include "utils/cubemap.glsl"'),this._fragDefines.push('#pragma include "utils/lights.glsl"')))}},"osgSketchfab","Compiler");var He=Ge,ze=l.a.osg,We=function(){He.apply(this,arguments)};ze.setStateAttributeConfig(We,{attribute:["VertexCompression","SketchfabMaterial","Morph","Skinning","PointSize"],textureAttribute:["Texture"]}),ze.createPrototypeObject(We,ze.objectInherit(He.prototype,{getCompilerName:function(){return"Shadeless"},getFragmentMain:function(){return"shadeless.frag"},getVertexMain:function(){return"shadeless.vert"},defineChannels:function(){var e=this._channels;this.defineChannel(e.AlbedoPBR),this.defineChannel(e.DiffusePBR),this.defineChannel(e.Opacity),this.defineChannel(e.Displacement),this.defineChannel(e.EmitColor),this.defineChannel(e.CavityPBR),this.defineChannel(e.AOPBR),this.defineChannel(e.DiffuseColor),this.defineChannel(e.DiffuseIntensity),-1!==this._fragDefines.indexOf("#define HAS_OPACITY_REFRACTION")&&(this._vertDefines.push("#define HAS_VIEW_NORMAL"),this._vertDefines.push("#define HAS_VIEW_VERTEX"))}}));var qe=We,Xe=l.a.osg,Ye=function(){He.apply(this,arguments)};Xe.setStateAttributeConfig(Ye,{attribute:["VertexCompression","SketchfabMaterial","Morph","Skinning","PointSize"],textureAttribute:["Texture"]}),Xe.createPrototypeObject(Ye,Xe.objectInherit(He.prototype,{getCompilerName:function(){return"Matcap"},getFragmentMain:function(){return"matcap.frag"},getVertexMain:function(){return"matcap.vert"},getChannelUV:function(e){return"Matcap"===e.getName()?"":He.prototype.getChannelUV.call(this,e)},defineChannels:function(){var e=this._channels;this.defineChannel(e.Opacity),this.defineChannel(e.Displacement),this.defineChannel(e.NormalMap),this.defineChannel(e.BumpMap),this.defineChannel(e.Matcap)}}));var Ke=Ye,Qe=l.a.osg,Je=function(){He.apply(this,arguments)};Qe.setStateAttributeConfig(Je,{attribute:["SketchfabLight0","SketchfabLight1","SketchfabLight2","SketchfabLight3","ShadowReceive0","ShadowReceive1","ShadowReceive2","ShadowReceive3","GroundStateAttribute"],textureAttribute:["Texture"]}),Qe.createPrototypeObject(Je,Qe.objectInherit(He.prototype,{getCompilerName:function(){return"Ground"},getFragmentMain:function(){return"ground/ground.frag"},getVertexMain:function(){return"ground/ground.vert"},initAttributes:function(e){for(var t=this._lights,n=this._shadows,i=0,r=e.length;i<r;i++){var a=e[i].className();"Light"===a?t.push(e[i]):"ShadowReceiveAttribute"===a?n.push(e[i]):"GroundStateAttribute"===a&&(this._groundState=e[i])}},initDefines:function(){var e=this._groundState.isUseBakedAo(),t=this._groundState.isDisplayPlane();e?this._fragDefines.push("#define BAKED_AO"):(this.defineLights(),this.defineShadows(),this._shadows.length&&this._lights.length?this._fragDefines.push("#define SHADOW_CATCHER"):this._fragDefines.push("#define PASS_THROUGH")),t&&this._fragDefines.push("#define DISPLAY_PLANE"),this._vertDefines.push("attribute vec2 TexCoord0;"),this._vertDefines.push("varying vec2 vTexCoord0;"),this._vertAssignUV.push("vTexCoord0 = TexCoord0;")}}));var Ze=Je,$e=l.a.osg,et=function(){He.apply(this,arguments)};$e.setStateAttributeConfig(et,{attribute:["VertexCompression","SketchfabMaterial","Morph","Skinning","PointSize"],textureAttribute:["Texture"]}),$e.createPrototypeObject(et,$e.objectInherit(He.prototype,{getCompilerName:function(){return"EarlyZ"},getFragmentMain:function(){return"earlyz.frag"},getVertexMain:function(){return"earlyz.vert"},defineChannels:function(){var e=this._channels;e&&(this.defineChannel(e.Opacity),this.defineChannel(e.Displacement),this.defineChannel(e.SubsurfaceScattering))}}));var tt=et,nt=l.a.osg,it=function(){tt.apply(this,arguments)};nt.setStateAttributeConfig(it,{attribute:["VertexCompression","SketchfabMaterial","Morph","Skinning","ShadowCast"],textureAttribute:["Texture"]}),nt.createPrototypeObject(it,nt.objectInherit(tt.prototype,{getCompilerName:function(){return"ShadowBakeAo"},getFragmentMain:function(){return"ground/bakeShadowMap.frag"},getVertexMain:function(){return"ground/bakeShadowMap.vert"},defineChannels:function(){var e=this._channels;e&&(this.defineChannel(e.Opacity),this.defineChannel(e.Displacement))}}));var rt=it,at=l.a.osg,ot=function(){tt.apply(this,arguments)};at.setStateAttributeConfig(ot,{attribute:["VertexCompression","SketchfabMaterial","Morph","Skinning","ShadowCast"],textureAttribute:["Texture"]}),at.createPrototypeObject(ot,at.objectInherit(tt.prototype,{getCompilerName:function(){return"ShadowCastSkfb"},getFragmentMain:function(){return"shadowing/shadowCast.frag"},getVertexMain:function(){return"shadowing/shadowCast.vert"},defineChannels:function(){var e=this._channels;e&&(this.defineChannel(e.Opacity),this.defineChannel(e.Displacement))}}));var st=ot,ut=l.a.osg,lt=function(){He.apply(this,arguments)};ut.setStateAttributeConfig(lt,{attribute:["VertexCompression","SketchfabMaterial","Morph","Skinning","PointSize"],textureAttribute:["Texture"]}),ut.createPrototypeObject(lt,ut.objectInherit(He.prototype,{getCompilerName:function(){return"Outline"},getFragmentMain:function(){return"outline.frag"},getVertexMain:function(){return"outline.vert"},defineChannels:function(){var e=this._channels;e&&this.defineChannel(e.Displacement)}}));var ct=lt,ht=l.a.osg,dt=function(){He.apply(this,arguments)};ht.setStateAttributeConfig(dt,{attribute:["VertexCompression","SketchfabMaterial","Morph","Skinning"],textureAttribute:["Texture"]}),ht.createPrototypeObject(dt,ht.objectInherit(He.prototype,{getCompilerName:function(){return"Wireframe"},getFragmentMain:function(){return"wireframe.frag"},getVertexMain:function(){return"wireframe.vert"},defineChannels:function(){var e=this._channels;e&&this.defineChannel(e.Displacement)}}));var ft=dt,pt=l.a.osg,gt=function(){He.apply(this,arguments)};pt.setStateAttributeConfig(gt,{attribute:["ShadowReceive0"],textureAttribute:["Texture"]}),pt.createPrototypeObject(gt,pt.objectInherit(He.prototype,{getCompilerName:function(){return"ShadowAr"},getFragmentMain:function(){return"ARKit/shadowAr.frag"},getVertexMain:function(){return"ARKit/shadowAr.vert"},initDefines:function(){this.defineShadows()}}));var mt=gt,vt=l.a.osg,_t=function(){He.apply(this,arguments)};vt.setStateAttributeConfig(_t,{attribute:["VertexCompression","SketchfabMaterial","Morph","Skinning","PointSize"],textureAttribute:["Texture"]}),vt.createPrototypeObject(_t,vt.objectInherit(He.prototype,{getCompilerName:function(){return"Inspector"},getFragmentMain:function(){return"inspector/inspector.frag"},getVertexMain:function(){return"inspector/inspector.vert"},defineChannels:function(){var e=this._channels;this.defineChannel(e.Opacity),this.defineChannel(e.Displacement),this.defineChannel(e.Inspector);var t=e.Inspector;if(t.getTextureModel()&&(this._fragDefines.push("#define HAS_INSPECTOR_TEXTURE"),this._vertDefines.push("#define HAS_INSPECTOR_TEXTURE"),e.Inspector.getSRGB()||this._fragDefines.push("#define CONVERT_INSPECTOR_TO_LINEAR")),t.isEnableEffectiveHardware(this._material))if(t.getTextureModel())this._fragDefines.push("#define FEEDBACK_UV UV_INSPECTOR");else{var n=t.get("selectUV");this.declareAndAssignTexCoord(n),this._fragDefines.push("#define FEEDBACK_UV vTexCoord"+n)}}}));var bt=_t,St=l.a.osg,yt=function(){He.apply(this,arguments)};St.setStateAttributeConfig(yt,{attribute:[],textureAttribute:[]}),St.createPrototypeObject(yt,St.objectInherit(He.prototype,{getCompilerName:function(){return"Controller"},getFragmentMain:function(){return"webVR/controller.frag"},getVertexMain:function(){return"webVR/controller.vert"},initDefines:function(){}}));var xt=yt,Ct=l.a.osg,wt=function(){He.apply(this,arguments)};Ct.setStateAttributeConfig(wt,{attribute:["Morph","Skinning","PointSize"],textureAttribute:[]}),Ct.createPrototypeObject(wt,Ct.objectInherit(He.prototype,{getCompilerName:function(){return"DebugNormal"},getFragmentMain:function(){return"debug/normal.frag"},getVertexMain:function(){return"debug/normal.vert"}}));var Tt=wt,Mt=l.a.osg,Et=function(){He.apply(this,arguments)};Mt.setStateAttributeConfig(Et,{attribute:["Morph","Skinning","PointSize"],textureAttribute:[]}),Mt.createPrototypeObject(Et,Mt.objectInherit(He.prototype,{getCompilerName:function(){return"DebugTangent"},getFragmentMain:function(){return"debug/tangent.frag"},getVertexMain:function(){return"debug/tangent.vert"}}));var At=Et,Ot=l.a.osg,Rt=function(){He.apply(this,arguments)};Ot.setStateAttributeConfig(Rt,{attribute:["VertexCompression","Morph","Skinning","PointSize"],textureAttribute:[]}),Ot.createPrototypeObject(Rt,Ot.objectInherit(He.prototype,{getCompilerName:function(){return"DebugGeometry"},getFragmentMain:function(){return"debug/geometry.frag"},getVertexMain:function(){return"debug/geometry.vert"}}));var Pt=Rt,It=l.a.osg,Nt=function(){He.apply(this,arguments)};It.setStateAttributeConfig(Nt,{attribute:["VertexCompression","Morph","Skinning","PointSize"],textureAttribute:[]}),It.createPrototypeObject(Nt,It.objectInherit(He.prototype,{getCompilerName:function(){return"DebugSkinning"},getFragmentMain:function(){return"debug/skinning.frag"},getVertexMain:function(){return"debug/skinning.vert"}}));var Lt=Nt,kt=l.a.osg,Dt=function(){He.apply(this,arguments)};kt.setStateAttributeConfig(Dt,{attribute:["VertexCompression"],textureAttribute:[]}),kt.createPrototypeObject(Dt,kt.objectInherit(He.prototype,{getCompilerName:function(){return"DebugBoneBox"},getFragmentMain:function(){return"debug/boneBox.frag"},getVertexMain:function(){return"debug/boneBox.vert"}}));var Ft=Dt,Vt=-1,Bt=function(){return Vt},Ut=function(e){Vt+=e},jt=Object(_.a)().asyncShader,Gt=l.a.osg,Ht=l.a.osgShader.ShaderGenerator,zt=function(e,t){Ht.call(this),this.setShaderCompiler(e),this._materialHashCompiler=t||ke.a.SHADING_COMPILER};Gt.createPrototypeObject(zt,Gt.objectInherit(Ht.prototype,{getOrCreateProgram:function(e){return ke.a.CURRENT_COMPILER=this._materialHashCompiler,Ht.prototype.getOrCreateProgram.call(this,e)},_getProgram:function(e,t,n,i){var r=this._cache[e];if(r&&-1===r.getAsyncCompiling())return r;if(r){var a=t._frameStamp._frame-r.getAsyncCompiling();return a<jt?(b.a.draw(),Ut(1),1===a&&r.getCompilationResultAndLink(t.getGraphicContext()),r._placeHolder):q.a.getInitialTextureBoundPromise().isFulfilled()?(r.getLinkResult(t.getGraphicContext()),n.length=0,i.length=0,this.getActiveAttributeList(t,n),this.getActiveTextureAttributeList(t,i),r.setActiveUniforms(this.getActiveUniforms(t,n,i)),r):(Ut(1),r._placeHolder)}},_createProgram:function(e,t,n,i){var r=Ht.prototype._createProgram.call(this,e,t,n,i);return-1!==r.getAsyncCompiling()?(this._waitingProgram||(this._waitingProgram=this._createWaitingProgram(t,n,i)),r.enableAsyncCompilation(this._waitingProgram,t._frameStamp._frame),this._waitingProgram):r}}));var Wt=function(e,t,n,i){e.addShaderGenerator(t,new zt(n,i))},qt={},Xt=!1;qt.register=function(e){Xt||(Xt=!0,Wt(e,"lit-classic",He),Wt(e,"lit-pbr",He),Wt(e,"shadeless-classic",qe),Wt(e,"shadeless-pbr",qe),Wt(e,"matcap",Ke),Wt(e,"ground",Ze),Wt(e,"shadow-ao-bake",rt),Wt(e,"earlyz",tt,ke.a.EARLYZ_COMPILER),Wt(e,"shadowcast",st,ke.a.SHADOWCAST_COMPILER),Wt(e,"outline",ct,ke.a.SHADOWCAST_COMPILER),Wt(e,"wireframe",ft,ke.a.WIREFRAME_COMPILER),Wt(e,"shadow-ar",mt),Wt(e,"inspector",bt),Wt(e,"controller",xt),Wt(e,"debugNormal",Tt),Wt(e,"debugTangent",At),Wt(e,"debugGeometry",Pt),Wt(e,"debugSkinning",Lt),Wt(e,"debugBoneBox",Ft))};var Yt=qt,Kt=n("93PM"),Qt=n("uPP5"),Jt=n("0iCP"),Zt=n("mbgM"),$t=function(e,t){this._key=e,this._progress=0,this._weight=0,this._active=!1,this._progressUpdate=t,this._promises,this._nbPromisesDone=0,this._lastSetPromiseId=0,this._cbFakeUpdate,this._refTime,this._totalBytes=0};$t.prototype={setPromises:function(e){this._progress=0,this._promises=e,this._nbPromisesDone=0,this._totalBytes=0,this._lastSetPromiseId++,this._cbFakeUpdate=this._onPromiseAutoUpdate.bind(this,this._lastSetPromiseId);for(var t=0;t<this._promises.length;++t){var n=this._promises[t];n.finally(this._onPromiseDone.bind(this,this._lastSetPromiseId,n.size||0)),this._totalBytes+=this._promises[t].progressSize||0}window.setTimeout(this._cbFakeUpdate,100),this._updateRefTime()},_updateRefTime:function(){this._refTime=(new Date).getTime()},_onPromiseDone:function(e,t){this._lastSetPromiseId===e&&(this._totalBytes-=t,this._updateRefTime(),this._nbPromisesDone++,this._progress=this._nbPromisesDone/this._promises.length,this._progressUpdate(this))},_onPromiseAutoUpdate:function(e){if(this._lastSetPromiseId===e){var t=this._promises.length;if(this._nbPromisesDone!==t){var n=2e-4*((new Date).getTime()-this._refTime),i=this._nbPromisesDone/t,r=(this._nbPromisesDone+1)/t;this._progress=r-(r-i)/(n*n+1),this._progressUpdate(this),window.setTimeout(this._cbFakeUpdate,100)}}}};var en=function(e){this._triggerProgress=e,this._primaryChannels=[],this._secondaryChannels=[],this._init()};en.prototype={_init:function(){var e=this._updateChannelProgress.bind(this,!1),t=this._primaryChannels;t.push(new $t("texture",e)),t.push(new $t("polygon",e)),t.push(new $t("osgjs",e)),t.push(new $t("wireframe",e));var n=this._updateChannelProgress.bind(this,!0),i=this._secondaryChannels;i.push(new $t("texture",n)),i.push(new $t("environment",n)),i.push(new $t("background",n)),i.push(new $t("wireframe",n))},initPrimaryProgress:function(e,t,n){var i=this._getProgressChannel("texture",!1),r=this._getProgressChannel("polygon",!1),a=this._getProgressChannel("osgjs",!1),o=this._getProgressChannel("wireframe",!1);i._totalBytes=this._estimateTexturesSize(),r._totalBytes=t,a._totalBytes=e,o._totalBytes=n,i._active=!0,r._active=!0,a._active=!0,o._active=n>0,this._autoComputeWeights()},_estimateTexturesSize:function(){var e,t=T.default.instance.getTextureCollection().models,n=t.length;if(!n)return 0;if(!Object(_.a)().preload)return 5e3*n;var i=0,r=0,a=Object(Jt.a)();for(e=0;e<n;++e){var o=t[e].findImageNearestPowerOfTwoUpToResolution(a,a);r+=o.width*o.height,i=Math.max(i,o.width,o.height)}var s=Object(_.a)().pixelBudget;void 0===s&&(s=Ve.a.any?6144:12288),s*=s;var u=Math.min(a,Math.sqrt(s/n));u=Zt.a.snapToPowerOf2(u,.75),(i<=a||r<=u*u)&&(u=a);var l=0;for(e=0;e<n;++e)l+=t[e].findImageNearestPowerOfTwoUpToResolution(u,u).size;return l},_getProgressChannel:function(e,t){for(var n=t?this._secondaryChannels:this._primaryChannels,i=0;i<n.length;++i)if(n[i]._key===e)return n[i]},_autoComputeWeights:function(e){var t=e?this._secondaryChannels:this._primaryChannels,n=0,i=0,r=0,a=0;for(i=0;i<t.length;++i)t[i]._active&&(n++,r+=t[i]._totalBytes,t[i]._totalBytes||a++);var o=1/n,s=1-o*a;for(i=0;i<t.length;++i)if(t[i]._active){var u=t[i]._totalBytes;t[i]._weight=u?s*u/r:o}else t[i]._weight=0},_updateChannelProgress:function(e,t){var n=e?this._secondaryChannels:this._primaryChannels;e&&!t._active&&(t._active=!0,this._autoComputeWeights(!0));var i=0,r=0;for(r=0;r<n.length;++r)i+=n[r]._progress*n[r]._weight;var a=e?"secondary-progress":"primary-progress";if(this._triggerProgress(a,{progress:i}),1===i)for(r=0;r<n.length;++r)n[r]._active=!1},updateProgress:function(e,t,n){var i=this._getProgressChannel(n,t);i._progress=e,this._updateChannelProgress(t,i)},setFakeProgress:function(e,t,n){var i=this._getProgressChannel(n,t);i?(void 0===e.length&&(e=[e]),i.setPromises(e),t||this._autoComputeWeights()):console.error("Unexpected progress channel key : "+n)}};var tn=en,nn=n("R+tb"),rn=n("dtSa"),an=n("gRsq"),on=n("jiW3"),sn=n("ViC5"),un=n("4//o"),ln=l.a.osg,cn=l.a.osgViewer,hn=new u.a({device:"VWR"}),dn=function(e){if(e.byteLength)return Array.prototype.slice.call(e)},fn=function(e){return Object(o.a)(e,dn)},pn=function(e){this._dataScene=e,this._modelFile=this.selectModelFile(),this._rootModel=new ln.Node,this._rootModel.setName("Scene - Root"),this._polygonNode=new ln.Node,this._polygonNode.setName("Scene - PolygonNode"),this._wireframeNodes=[],this._resourcePromises=[],this._cleanLegacyAbsoluteUrl()};pn.prototype={addResourcePromise:function(e){this._resourcePromises.push(e)},getJSON:function(){return this._dataScene},getPolygonURL:function(){return this._modelFile.osgjsUrl},getWireframeURL:function(){return this._modelFile.wireframeUrl},getOsgjsSize:function(){return this._modelFile.osgjsSize},getPolygonSize:function(){return this._modelFile.modelSize},getWireframeSize:function(){return this._modelFile.wireframeSize},getResourceManager:function(){return this._resourceManager||T.default.instance},getRootModel:function(){return this._rootModel},getWireframeNodes:function(){return this._wireframeNodes},createOptionDownload:function(e,t,n){return{node:n,progress:t,binarySize:"polygon"===e?this.getPolygonSize():this.getWireframeSize(),binaryKey:e,osgjsSize:this.getOsgjsSize(),osgjsKey:"osgjs",secondary:!1}},loadPolygon:function(e,t,n,i){var r=this.createOptionDownload("polygon",e,this._polygonNode);if(t){var a=i?e:void 0;r.wireframeOptions=this.createOptionDownload("wireframe",a),r.wireframeOptions.startPromise=n,r.wireframeOptions.deferDownload=new Qt.a,r.wireframeOptions.nodes=this.getWireframeNodes(),i&&this._resourcePromises.push(r.wireframeOptions.deferDownload);var o=ln.Timer.instance().tick();r.wireframeOptions.deferDownload.then(function(){q.a.resolveWireframe({time:ln.Timer.instance().tick()-o})})}var s=this.getResourceManager().getOrCreateModel(this.getPolygonURL(),r);return this.getRootModel().addChild(this._polygonNode),this.getResourceManager().run(),s.promise},loadWireframeLegacy:function(e){var t=this.createOptionDownload("wireframe",e,new ln.Node);t.node.setStateSet(new rn.a);var n=this.getResourceManager().getOrCreateModel(this.getWireframeURL(),t);return this.getWireframeNodes().push(t.node),this.getRootModel().addChild(t.node),n.promise},selectModelFile:function(){var e=Object(d.a)()||Object(_.a)().apiVersion||Object(me.a)()?0:1;void 0!==Object(_.a)().modelOptimization&&(e=Object(_.a)().modelOptimization?1:0);for(var t=this._dataScene.files,n=0;n<t.length;++n)if(t[n].flag===e)return t[n];return t[0]},_cleanLegacyAbsoluteUrl:function(){var e=this._dataScene.options&&this._dataScene.options.materials;if(e){var t=this.getPolygonURL(),n=t.substr(0,t.lastIndexOf("/")+1);for(var i in e){var r=e[i].channels;for(var a in r){var o=r[a].texture;o&&(o.image&&(o.image=n.concat(o.image)),o.url&&(o.url=n.concat(o.url)))}}}}};var gn=h.a.extend({initialize:function(){if(h.a.prototype.initialize.apply(this,arguments),!this.options.model)throw new Error("no model provided to ViewerWebGL");Object(_.a)().preferOriginalNormalMap=this.options.model.get("preferOriginalNormalMap"),D.a.client.configureScope(function(e){e.setTag("frontend","3d")}),this._root=null,this._features=this.options.features,this._widgetAPI=this.options.widgetAPI,this._viewerAPI=this.options.viewerAPI,this._progressManager=new tn(this.trigger.bind(this)),this._widgetAPI&&this._widgetAPI.getTabbedWidget().model.on("change",b.a.draw),T.default.instance.setModelUid(this.model.get("uid")),this._featuresInstancied={};var e=this.$(".canvas"),t=e[0];t.oncontextmenu=function(){return!1},this._initOptions(),ln.Geometry.enableVAO=Object(_.a)().useVao,(0===Object(_.a)().asyncShader||Object(an.a)())&&q.a.resolveAsyncShaderCompilation();var n=this._viewer=new cn.Viewer(t,{powerPreference:Object(_.a)().powerPreference,antialias:!1,depth:!1,stencil:!1,alpha:this._requireAlphaContext(),premultipliedAlpha:!0,fullscreen:!1,overrideDevicePixelRatio:Object(_.a)().pratio,preserveDrawingBuffer:Object(_.a)().preserveDrawingBuffer,enableFrustumCulling:!1,maxDevicePixelRatio:Object(on.a)(),InputSources:{Mouse:{scrollwheel:Object(_.a)().scrollwheel},Keyboard:{sourceElement:e[0]},WebVR:{pollInterval:-1},GamePad:{enable:!1}}});re.a.init(n.getInputManager()),n.getState().getExcludeUniforms().uDrawOpaque=!0,n.getState().getExcludeUniforms().uQVT=!0,n.getState().getExcludeUniforms().uQVS=!0,n.getState().getExcludeUniforms().uQW=!0,n.getViewerStats()&&n.getViewerStats().addConfig(this._createOptionStats());var i=ln.TimerGPU.instance();Object(_.a)().webglTimerGpu&&(i.setFrameAverageCount(20),i.enable()),Kt.a.setTimerGPU(i);var r=p();this._contextLostCount=r?0:Object(_.a)().webglRestore,this._restoreContextBinded=this.restoreContext.bind(this),n.setContextRestoreCallback(this.requestRestoreContext.bind(this)),n.setContextLostCallback(function(){return ln.warn("Context Lost"),Object(un.a)(!1),this._contextLostCount++,Object(sn.a)("Embed Lost WebGL Context"),!0}.bind(this)),Yt.register(n.getState().getShaderGeneratorProxy());for(var a=Object(Le.a)(),o=n.getState(),s=0;s<a;s++)o.setGlobalDefaultTextureAttribute(s,ln.Texture.textureNull);n.requestContinuousUpdate(Object(_.a)().continuousRender),e[0].setAttribute("tabindex","0"),n.init();var u=this.getCamera();u.getRenderer().setCullVisitor(new v.a),n.setupManipulator(),this._rootScene=new ln.MatrixTransform,this._rootScene.setName("Root scene"),u.setClearColor(ln.vec4.fromValues(.25,.3,.3,1)),n.setSceneData(this._rootScene),b.a.setViewer(n),this._superSample=new w(this),b.a.setSuperSample(this._superSample),this._superSample.setRoot(this._rootScene),n.getManipulator().computeHomePosition(),Object(_.a)().forceMs?n._requestAnimationFrame=function(e){window.setTimeout(e,Object(_.a)().forceMs)}:n._requestAnimationFrame=g.a.get(),Object(_.a)().asyncShader&&this._setShaderAsyncCompilation(),n.run(),this._currentScene=void 0,D.a.client.configureScope(function(e){e.setTag("frontend","web")})},_initOptions:function(){var e=this.options.model;void 0===e.get("options").version&&(e.get("options").version=c.a.optionsVersion),ln.time("processModelJSON"),G(e),ln.timeEnd("processModelJSON"),Object(_.a)().processOptions&&e.set("options",{version:c.a.optionsVersion,sound:{},orientation:{},ground:{},wireframe:{},scene:{},hotspot:{},materials:{},environment:{},vr:{},camera:{},lighting:{},background:{},shading:{},animation:{}})},updateProgress:function(e,t,n){this._progressManager.updateProgress(e,t,n)},setFakeSecondaryProgress:function(e,t){this._progressManager.setFakeProgress(e,!0,t)},setFakePrimaryProgress:function(e,t){this._progressManager.setFakeProgress(e,!1,t)},setFakeProgress:function(e,t,n){this._progressManager.setFakeProgress(e,t,n)},requestRestoreContext:function(){this._contextLostCount<3?this.restoreContext():new(0,n("uGjJ").default)({title:"3D/WebGL context error",text:"Your browser seems to have hit its 3D capability limit. The page needs to be reloaded to fix this. <br/>If the problems persists, you can try to close other tabs with 3D/WebGL or restart your browser entirely.",safe:!0,buttons:{continue:!0,continueLabel:"Reload Current Page",cancel:!1}}).open().then(function(){window.location.reload()}.bind(this))},restoreContext:function(){if(Object(nn.b)())document.addEventListener(Object(nn.a)(),this._restoreContextBinded);else if(this._featuresManager){var e=this._featuresManager._features;if(e){if(e.postProcess){var t=e.postProcess.getModel();t.set("enable",!1),t.set("enable",!0)}e.quality&&e.material&&(e.quality.getModel().trigger("updateTexelPolicy"),we.a.resetCaches(),we.a.packAllMaterialsTextures(e.material.getModel().getMaterials())),b.a.draw(),document.removeEventListener(Object(nn.a)(),this._restoreContextBinded)}}},getModelUID:function(){return this.model.get("uid")},_requireAlphaContext:function(){if(Object(d.a)()||Object(_.a)().transparent||Object(_.a)().arkit)return!0;var e=this.options.model.get("options");return"none"===(e&&e.background&&e.background.enable)},_getLower:function(e,t){for(var n=[],i=0,r=e.length;i<r;++i)n.push(e[i]),t[n[i]]={caption:e[i],average:!0};return n},_createOptionStats:function(){var e=["Total GL","Shading","PostProcess","ShadowMap"],t={};return{values:t,groups:[{name:e[0],caption:"GL Total (ms)",values:this._getLower(e,t)},{name:e[1],caption:"GL Shading (ms)",values:this._getLower(["EarlyOpaque","EarlyTransparency","ShadingOpaque","ShadingTransparency","ShadingRefraction","Extra"],t)},{name:e[2],caption:"GL PostProcess (ms)",values:[]},{name:e[3],caption:"GL ShadowMap (ms)",values:this._getLower(["ShadowMap0","ShadowMap1","ShadowMap2","ShadowMap3"],t)}]}},setOptionStatsPostProcess:function(e){var t={},n=[{name:"PostProcess",caption:"GL PostProcess (ms)",values:this._getLower(e,t)}],i=this._viewer.getViewerStats();i.addConfig({values:t,groups:n}),i.update()},getRootUserData:function(){return this._currentScene&&this.getRootModel().userDataMap||{}},getRootScene:function(){return this._rootScene},getRootModel:function(){return this._currentScene.getRootModel()},getWidth:function(){return this._viewer.getCanvasWidth()},getHeight:function(){return this._viewer.getCanvasHeight()},getOptions:function(){return this.options},isViewerReady:function(){return q.a.getModelDisplayed()},getViewerAPI:function(){return this._viewerAPI},createContext:function(e){return new M.a({model:e.model,viewer:this,scene:e.scene,widgetAPI:this._widgetAPI})},loadWireframeLegacy:function(e,t){var n=e.loadWireframeLegacy(t),i=ln.Timer.instance().tick();return n.then(function(){q.a.resolveWireframe({time:ln.Timer.instance().tick()-i})}),n},_dataSizePromisesResolve:function(e){q.a.resolveDataSizeOSGJS(e.getOsgjsSize()),q.a.resolveDataSizePolygon(e.getPolygonSize()),q.a.getHasSound().then(function(e){var t=0;e&&this.getFeatures().sound.getModel("soundtracks").get("soundtracks").each(function(e){var n=e.get("size");n&&(t+=n)});q.a.resolveDataSizeSound(t)}.bind(this))},hasIntegratedWireframe:function(){var e=this._currentScene;return!e._modelFile.wireframeUrl||!e._modelFile.wireframeSize},run:function(){var e=Object(_.a)(),t=this.options.model,i=this,r=this.getOrCreateScene(t.toJSON()),o=t.get("options"),s=r.getJSON().animationCount>0||Object(d.a)()&&o.animation&&o.animation.order&&t.get("options").animation.order.length>0;q.a.resolveHasAnimation(s),this._dataSizePromisesResolve(r);var u=this.createContext({model:t,scene:r}),l=r._resourcePromises,c=e.preload,h=r._modelFile,f=Object(_.a)().wireframePreload||!Object(an.a)()&&(e.uiInspector||!0===o.wireframe.enable)&&void 0!==h.wireframeSize&&h.wireframeSize>0,p=f&&!0===c,g=f&&this.hasIntegratedWireframe();q.a.resolveDataSizeWireframe(f?h.wireframeSize:0);var m=f&&!g&&!p,v=f?a.a.resolve():q.a.getHighResLoaded(),S=r.loadPolygon(this.updateProgress.bind(this),g,v,p);l.push(S);var y,x=ln.Timer.instance().tick();S.then(function(){q.a.resolvePolygon({time:ln.Timer.instance().tick()-x})}),!g&&p&&l.push(this.loadWireframeLegacy(r,this.updateProgress.bind(this))),e.cleanShader&&l.push(n.e(103).then(function(){window.glslesPreprocessor=n("IJSO")}.bind(null,n)).catch(n.oe)),ln.time("createAndInitFeatures"),i._features.forEach(function(e){i.addFeature(e,u)}),ln.timeEnd("createAndInitFeatures"),this._progressManager.initPrimaryProgress(r.getOsgjsSize(),r.getPolygonSize(),p?r.getWireframeSize():0),Object(nn.b)()&&(y=setInterval(function(){b.a.draw()},200),q.a.getInitialTextureBoundPromise().then(function(){clearInterval(y)})),a.a.all(l).then(this._launchViewer.bind(this,u,m,x)),this._featuresInstancied=u.getFeatures();var C=this._featuresInstancied.material.getModel().getMaterials();return we.a.setMaterials(C),q.a.getModelDisplayed()},_setShaderAsyncCompilation:function(){q.a.getMaterial().then(function(){var e=this._viewer.getCamera();e.setFinalDrawCallback(function(){if(Bt()>0)return Vt=0,void this._viewer.requestRedraw();Bt()<0?this._viewer.requestRedraw():(e.setFinalDrawCallback(void 0),q.a.resolveAsyncShaderCompilation())}.bind(this))}.bind(this))},_launchViewer:function(e,t,n){ln.time("featureFinished"),this.featureFinished(e,this._rootScene),ln.timeEnd("featureFinished"),t&&q.a.getHighResLoaded().then(this.loadWireframeLegacy.bind(this,this._currentScene,void 0)),ln.time("wait async"),(q.a.getAsyncShaderCompilation().isFulfilled()?q.a.getInitialTextureBoundPromise():a.a.all([q.a.getAsyncShaderCompilation(),q.a.getInitialTextureBoundPromise()])).then(function(){this.trigger("primary-progress",{progress:1}),ln.timeEnd("wait async"),i.default.logBound(Ee.a.getModelBoxWithoutDisplacement()),i.default.showMessage(),this._onViewerLaunched(n)}.bind(this))},_startAnimation:function(){this._featuresInstancied.animation.getModel().trigger("afterFirstVisibleFrame")},_afterTabVisible:function(){var e,t=Object(nn.a)();e=function(){this._featuresManager.setInitialAnimation(),this._startAnimation(),document.removeEventListener(t,e)}.bind(this),document.addEventListener(t,e)},_hasFocusTab:function(){var e=Object(nn.a)();return!Object(nn.b)()||!e},_onViewerLaunched:function(e){var t=this._hasFocusTab();(t&&this._featuresManager.setInitialAnimation(),this.drawFrame(),t?this._startAnimation():this._afterTabVisible(),q.a.resolveModelDisplayed({time:ln.Timer.instance().tick()-e}),this.trigger("success"),this.trigger("viewerready"),Object(_.a)().messaging)&&hn.createMessage({data:"ready"}).appendToHash()},onFail:function(e,t){ln.error(t.stack),e.reject(t),this.trigger("failure")},addFeature:function(e,t){if(!e)return console.warn("Feature undefined!"),!0;var n=new e;if(n.init(t),Object(d.a)()){var i=n.getModel(),r=n.getName();i.editorSetJSON&&!window.editorModels[r]&&(window.editorModels[r]={setJSON:this._makeCallbackSetJSON(i),getJSON:this._makeCallbackGetJSON(i)})}},_makeCallbackSetJSON:function(e){return function(t){var n=e.editorSetJSON(fn(t));return n&&n.then?n:n?a.a.reject(n):a.a.resolve()}},_makeCallbackGetJSON:function(e){return function(){var t=e.editorGetJSON();return a.a.resolve(fn(t))}},drawFrame:function(){this._viewer.requestRedraw(),this._viewer.frame()},getCanvas:function(){return this._viewer.getGraphicContext().canvas},getInputManager:function(){return this._viewer.getInputManager()},setTimeline:function(e){this._timeline=e},getTimeline:function(){return this._timeline},getScreenShot:function(e,t,n){return Object(m.a)(e,t,this,n)},getCamera:function(){return this._viewer.getCamera()},getFeatures:function(){return this._featuresInstancied},getSuperSample:function(){return this._superSample},getFeaturesManager:function(){return this._featuresManager},getViewerOSGJS:function(){return this._viewer},getOrCreateScene:function(e){if(this._currentScene)return this._currentScene;var t=new pn(e);return t.getResourceManager().setStateContextOSG(this._viewer.getState()),this._currentScene=t,t},featureFinished:function(e,t){return this._featuresManager=new Ne(this,e),this._featuresManager.finished(t)},getOptionsJSON:function(){var e=this.getFeatures(),t={};t.version=c.a.optionsVersion,t.background=e.background.getModel().getJSON(),t.environment=e.environment.getModel().getJSON(),t.lighting=e.lighting.getModel().getJSON(),t.materials=e.material.getModel().getJSON(),t.orientation=e.orientation.getModel().getJSON(),t.camera=e.camera.getModel().getJSON(),t.animation=e.animation.getModel().getJSON(),t.hotspot=e.hotspot.getModel().getJSON(),t.vr=e.webVR.getModel().getJSON(),t.scene=t.scene||{},t.scene.postProcess=e.postProcess.getModel().getJSON(),t.scene.sssProfiles=e.postProcess.getModel().getProfilesJSON(),t.sound=e.sound.getModel().getJSON(),t.ground=e.ground.getModel().getJSON();var n=e.shadingStyle.getModel().getJSON();return t.shading=n.shading,t.wireframe=n.wireframe,G.readOptions(t)}});t.a=gn},"l8+D":function(e,t,n){e.exports=n.p+"static/assets/images/editor/target-ff54e741c7266e6dc9a8c0538f99c6d0.png"},ljaD:function(e,t){},"m/V4":function(e,t,n){"use strict";(function(e){var i,r=n("12sq"),a=n("9mpE"),o=function(){return"".concat(r.a.recaptcha.baseUrl).concat(Object(a.b)("?",{render:r.a.recaptcha.key}))};var s={initialize:function(){return i=new e(function(e,t){if(!r.a.recaptcha.key)return t("Recaptcha disabled, no key");var n=document.createElement("script");n.type="text/javascript",n.src=o(),n.onload=function(){return e()},n.onerror=function(){return t("Recaptcha script failed to load.")},document.head.appendChild(n)})},generate:function(t){return i?i.then(function(){return new e(function(e,n){if(!grecaptcha)return n("grecaptcha not initialized properly. Skipping.");grecaptcha.ready(function(){return grecaptcha.execute(r.a.recaptcha.key,{action:t}).then(function(t){return e(t)},function(e){return n(e&&e.toString()||"Generating captcha failed")})})})}):new e(function(e,t){return t("grecaptcha not initialized. Try calling `initialize` first.")})}};t.a=s}).call(this,n("CSL1"))},"m/Zu":function(e,t){e.exports="uniform vec4 uColor;\n\nvoid main() {\n    gl_FragColor = vec4(uColor.rgb * uColor.a, uColor.a);\n}\n"},m5qG:function(e,t){e.exports="uniform vec3 uOutlineColor;\n\nvoid main() {\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n    gl_FragColor = vec4(uOutlineColor, 1.0);\n}\n"},mAxk:function(e,t){e.exports='// opacity\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\nuniform vec4 uShadowDepthRange;\n\nvarying vec4 vViewVertex;\n\n#ifdef HAS_OPACITY\n#pragma include "utils/material.glsl"\n#pragma include "utils/rand.glsl"\n#endif\n\nvec4 encodeFloatRGBA( float v ) {\n    vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * v;\n    enc = fract(enc);\n    enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n    return enc;\n}\n\nvoid main() {\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n#if defined(HAS_OPACITY_BLEND_OR_ADDITIVE) || defined(HAS_OPACITY_REFRACTION)\n    if (getMaterialOpacity() < EPSILON_ALPHA) discard;\n#endif\n\n    gl_FragColor = encodeFloatRGBA((-vViewVertex.z - uShadowDepthRange.x) / (uShadowDepthRange.y - uShadowDepthRange.x));\n}\n'},mCLn:function(e,t,n){"use strict";(function(e){var i=n("tNdj"),r=n("UIJo"),a=n("QKgc"),o=n("/0FW"),s=n("eEbW"),u=n("12sq");t.a=i.a.extend({endpoint:function(){return"/environments/".concat(this.get("uid"))},checkStatusAndRetry:function(){var t=this;return o.b.retry(1/0,function(){return s.b.getEnvironmentProcessingStatus(t.get("uid"),{allowPrefetching:!1}).then(function(t){return t||e.reject(new a.f)}).then(function(t){return["SUCCEEDED","FAILED"].includes(t.processing.toUpperCase())?t:e.reject(new a.f)})},{interval:2e3}).catch(function(){return{processing:"FAILED",error:"The server failed to answer in time"}})}},Object(r.a)({fileTypes:u.a.environmentFiletypes,maxFileSize:u.a.maxEnvironmentFilesize}))}).call(this,n("CSL1"))},mGy5:function(e,t){Array.prototype.find||(Array.prototype.find=function(e){for(var t=0,n=this.length;t<n;++t)if(e(this[t]))return this[t]}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;var r=0|t,a=Math.max(r>=0?r:i-Math.abs(r),0);function o(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}for(;a<i;){if(o(n[a],e))return!0;a++}return!1}}),Number.isNaN||(Number.isNaN=function(e){return e!=e}),Number.isInteger||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),Math.sign||(Math.sign=function(e){return(e>0)-(e<0)||+e}),Math.log2||(Math.log2=function(e){return Math.log(e)*Math.LOG2E}),Math.log10||(Math.log10=function(e){return Math.log(e)*Math.LOG10E}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>=this.length)&&(t=this.length),this.substr(t-e.length,e.length)===e}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e});var n=window.Image;delete window.Image,window.Image||(window.Image=n)},mHqZ:function(e,t){e.exports='#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureInput;\nuniform sampler2D TextureDepth;\n\nuniform sampler2D TextureRefraction;\nuniform vec2 uTextureRefractionSize;\nuniform vec2 uTextureRefractionRatio;\n\n// no background scenario\nvec4 setDepthAlpha(const in vec4 color) {\n#ifdef REFRACTION_FORCE_ALPHA_ONE\n    // detect if we are on a refraction pixel\n    vec2 uvRef = min(gTexCoord, 1.0 - 1.0 / uTextureRefractionSize.xy);\n    if (texture2D(TextureRefraction, uvRef * uTextureRefractionRatio).a > 0.0) return vec4(color.rgb, 1.0);\n#endif\n\n    float alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n    return vec4(color.rgb, alpha);\n}'},mN8o:function(e,t){e.exports='#pragma include "utils/encodeDepth.glsl"\nuniform vec2 uNearFar;\nvarying vec4 vViewVertex;\n\nuniform float uGroundFade;\nuniform float uGroundOpacity;\nuniform float uChanging;\n\nvarying vec2 vTexCoord0;\n\n#ifdef PASS_THROUGH\n    float getShadow(){\n       return 1.0;\n    }\n#endif\n\n#ifdef SHADOW_CATCHER\n\n    varying vec3 vModelNormal;\n    varying vec3 vModelVertex;\n\n    #define OPT_DISTANCE\n    #pragma include "shadowing/shadowReceive.glsl"\n\n    #pragma include "utils/getLuminance.glsl"\n\n    %UNROLL 4%\n    #ifdef LIGHT_TYPE_%ID%\n        uniform vec4 uSketchfabLight%ID%_diffuse;\n    #endif\n    %%\n\n\n    float getShadow(){\n        float shadow = 0.0;\n        vec3 modelNormal = normalize(gl_FrontFacing ? vModelNormal : -vModelNormal);\n        bool lighted = true;\n\n        float weight;\n        float sumWeights = 0.0;\n\n        %UNROLL 4%\n        #ifdef LIGHT_TYPE_%ID%\n            #ifdef HAS_SHADOW_%ID%\n                weight = getLuminance(uSketchfabLight%ID%_diffuse.rgb);\n                #ifdef _ATLAS_SHADOW\n                    shadow += weight * shadowReceive(lighted, modelNormal, vModelVertex, Texture7, uShadow_Texture0_renderSize, uShadow_Texture%ID%_projection, uShadow_Texture%ID%_viewRight, uShadow_Texture%ID%_viewUp, uShadow_Texture%ID%_viewLook, uShadow_Texture%ID%_depthRange, uShadowReceive%ID%_bias, uShadow_Texture%ID%_mapSize, OPT_DISTANCE uStaticFrameNumShadow%ID%);\n                #else\n                    shadow += weight * shadowReceive(lighted, modelNormal, vModelVertex, TEX_SHADOW_%ID%, uShadow_Texture%ID%_renderSize, uShadow_Texture%ID%_projection, uShadow_Texture%ID%_viewRight, uShadow_Texture%ID%_viewUp, uShadow_Texture%ID%_viewLook, uShadow_Texture%ID%_depthRange, uShadowReceive%ID%_bias, OPT_DISTANCE uStaticFrameNumShadow%ID%);\n                #endif // _ATLAS_SHADOW\n                sumWeights += weight;\n            #endif // HAS_SHADOW\n        #endif // LIGHT_TYPE\n        %%\n\n        #ifdef HAS_SHADOW\n            shadow /= sumWeights;\n        #else\n            shadow = 1.0;\n        #endif\n\n        return shadow;\n    }\n#endif\n\n#ifdef BAKED_AO\n    #pragma include "utils/encodeDecode.glsl"\n    uniform sampler2D uTexture;\n\n    float getShadow(){\n        return decode24(texture2D(uTexture, vTexCoord0).rgb);\n    }\n#endif\n\n#ifdef DISPLAY_PLANE\n    const float gridSize = 10.0;\n    const vec4 overlayColor = vec4(0.109,0.664,0.848,1.0);\n#endif\n\nuniform float uWidgetFade;\n\nvoid main() {\n    float shadow = getShadow();\n    #ifndef DISPLAY_PLANE\n\t    if (shadow >= 0.99) discard;\n    #endif\n    vec2 centerUV = vTexCoord0 * 2.0 - 1.0;\n    float fade = clamp(1.0 - dot(centerUV, centerUV) * (pow(10.0, uGroundFade) - 1.0) , 0.0, 1.0);\n\n    float alpha = (1.0 - shadow) * uGroundOpacity * fade;\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) * uGroundOpacity * fade * alpha;\n\n\n    #ifdef DISPLAY_PLANE\n        float gridValue = clamp(step(0.03,fract(vTexCoord0.x * gridSize))\n            * step(0.03,fract(vTexCoord0.y * gridSize)),0.0,1.0)\n            * step(vTexCoord0.x,0.997)\n            * step(vTexCoord0.y,0.997);\n\n        gl_FragColor = mix(overlayColor * fade, gl_FragColor, uWidgetFade) * vec4(gridValue,gridValue,gridValue,1.0);\n    #endif\n\n}\n'},mSVJ:function(e,t){e.exports="vec3 encode24(const in float x){\n    const vec3 code = vec3(1.0, 255.0, 65025.0);\n    vec3 pack = vec3(code * x);\n    pack.gb = fract(pack.gb);\n    pack.rg -= pack.gb * (1.0 / 256.0);\n    return pack;\n}\n\nfloat decode24(const in vec3 x) {\n    const vec3 decode = 1.0 / vec3(1.0, 255.0, 65025.0);\n    return dot(x, decode);\n}\n"},mbgM:function(e,t,n){"use strict";var i={isPowerOf2:function(e){return 0==(e&e-1)},floorPowerOf2:function(e){return 1<<Math.floor(Math.log2(e))},ceilPowerOf2:function(e){return 1<<Math.ceil(Math.log2(e))},snapToPowerOf2:function(e,t){if(i.isPowerOf2(e))return e;var n=i.floorPowerOf2(e);return e/n-1>(void 0===t?.5:t)?i.ceilPowerOf2(e):n}},r=new Uint32Array(1);i.hammersley=function(e,t){return[e/t,function(e){return r[0]=e,r[0]=(r[0]<<16|r[0]>>16)>>>0,r[0]=(1431655765&r[0])<<1|(2863311530&r[0])>>>1>>>0,r[0]=(858993459&r[0])<<2|(3435973836&r[0])>>>2>>>0,r[0]=(252645135&r[0])<<4|(4042322160&r[0])>>>4>>>0,r[0]=(16711935&r[0])<<8|(4278255360&r[0])>>>8>>>0,2.3283064365386963e-10*r[0]}(e)]},i.hemisphereSampleUniform=function(e,t){var n=i.hammersley(e,t),r=2*n[1]*Math.PI,a=1-n[0],o=Math.sqrt(1-a*a);return[Math.cos(r)*o,Math.sin(r)*o,a]},i.hemisphereSampleCos=function(e,t){var n=i.hammersley(e,t),r=2*n[1]*Math.PI,a=Math.sqrt(1-n[0]),o=Math.sqrt(1-a*a);return[Math.cos(r)*o,Math.sin(r)*o,a]},t.a=i},n3DM:function(e,t,n){"use strict";var i=n("fp5s");t.a={addNewImage:function(e){if(!this.model)throw new Error("This collection must implement a model.");var t,n=e.uid;n?t=n.replace(/tmp_/,""):n="tmp_"+(t=e.id||Object(i.a)());var r=new this.model({images:[{uid:n,url:e.url,width:e.width,height:e.height}],uid:n,id:t,name:e.name||"newImage",imageFile:e.imageFile,internal:e.internal});return this.set(r,{merge:!0,add:!0,remove:!1}),r}}},nLHx:function(e,t,n){"use strict";t.a=function(e){var t,n=window.WebKitBlobBuilder||window.MozBlobBuilder||window.BlobBuilder;t=e.split(",")[0].indexOf("base64")>=0?window.atob(e.split(",")[1]):window.decodeURI(e.split(",")[1]);for(var i,r=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),o=new Uint8Array(a),s=0;s<t.length;s++)o[s]=t.charCodeAt(s);if(void 0!==window.Blob)i=new Blob([o],{type:r});else if(void 0!==n){var u=new n;u.append(a),i=u.getBlob(r)}return i}},nPtx:function(e,t,n){"use strict";var i=n("nzRv"),r=n("gCTM"),a=n("f5KD");n("z206");t.a=i.a.extend({displayName:"Popup",optionTypes:{child:a.b.component.isRequired,title:a.b.string,className:a.b.string,isClosable:a.b.bool,width:a.b.number},defaultOptions:{className:"",isClosable:!0},state:{},events:{},template:function(){var e=this.options,t=e.width,n=e.className,i=e.isClosable,a=e.title,o=e.child;return r.default.getFromMacro("skfb_front/macros/components/molecules/popup","popup",[{className:n,isClosable:i,width:t,title:a,components:this.createChildrenComponents({child:o})}])}})},nSmV:function(e,t,n){"use strict";t.a=function(e){return(e=(e=(e=e.substring(e.lastIndexOf("/")+1)).split("."))[e.length>1?e.length-2:e.length-1]).split("_").pop().toLowerCase()}},nZll:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return u});var i=n("9mpE"),r=n("fgaA"),a=n("12sq");function o(){var e;try{if(!(e=window.location!==window.parent.location?document.referrer:document.location.href))throw new Error("url is not defined")}catch(t){e=document.referrer}var t=document.createElement("a");return t.href=e,t}function s(){return o().hostname.replace(/^www\./,"")}function u(e){var t=o().host,n=!1;t===window.location.host?n=!0:a.a.internalDomains.forEach(function(e){t===e.domain?n=!0:e.allowSubdomains&&t&&t.endsWith("."+e.domain)&&(n=!0)}),Object(r.a)().internal&&!n?document.location.replace(i.c.craft("?",i.c.reset(window.location.search.substr(1),{internal:null}))):e()}},ndRg:function(e,t){e.exports='#define MIN_ROUGHNESS 0.045\n\n#pragma include "utils/functions.glsl"\n\n#ifdef HAS_OPACITY_REFRACTION\n    float gRefractionRoughness; // global variable (simpler to handle in order to re-use rough/gloss fetch)\n#endif\n\n#ifdef HAS_VERTEX_COLOR\n    varying vec4 vColor;\n\n    vec3 getVertexColor() {\n        return COLOR_CONVERT_VERTEX_COLOR(vColor.rgb);\n    }\n#endif\n\n// METALNESS WORKFLOW\n#ifdef HAS_ALBEDOPBR\n    uniform float uAlbedoPBRFactor;\n    \n    vec3 getMaterialAlbedo() {\n        vec3 albedo;\n        #ifdef SAMPLER_ALBEDOPBR\n            albedo = uAlbedoPBRFactor * COLOR_CONVERT_ALBEDOPBR(texture2D(SAMPLER_ALBEDOPBR, UV_ALBEDOPBR).PACK_ALBEDOPBR);\n        #else\n            albedo = vec3(uAlbedoPBRFactor);\n        #endif\n\n        #ifdef HAS_VERTEX_COLOR\n            albedo *= getVertexColor();\n        #endif\n\n        return albedo;\n    }\n#endif\n\n#ifdef HAS_METALNESSPBR\n    uniform float uMetalnessPBRFactor;\n    \n    float getMaterialMetalness() {\n        #ifdef SAMPLER_METALNESSPBR\n            return uMetalnessPBRFactor * COLOR_CONVERT_METALNESSPBR(texture2D(SAMPLER_METALNESSPBR, UV_METALNESSPBR).PACK_METALNESSPBR);\n        #else\n            return uMetalnessPBRFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_SPECULARF0\n    uniform float uSpecularF0Factor;\n    \n    float getMaterialF0() {\n        #ifdef SAMPLER_SPECULARF0\n            return uSpecularF0Factor * COLOR_CONVERT_SPECULARF0(texture2D(SAMPLER_SPECULARF0, UV_SPECULARF0).PACK_SPECULARF0);\n        #else\n            return uSpecularF0Factor;\n        #endif\n    }\n#endif\n\n// SPECULAR WORKFLOW\n#ifdef HAS_DIFFUSEPBR\n    uniform float uDiffusePBRFactor;\n    \n    vec3 getMaterialDiffuse() {\n        vec3 diffuse;\n        #ifdef SAMPLER_DIFFUSEPBR\n            diffuse = uDiffusePBRFactor * COLOR_CONVERT_DIFFUSEPBR(texture2D(SAMPLER_DIFFUSEPBR, UV_DIFFUSEPBR).PACK_DIFFUSEPBR);\n        #else\n            diffuse = vec3(uDiffusePBRFactor);\n        #endif\n\n        #ifdef HAS_VERTEX_COLOR\n            diffuse *= getVertexColor();\n        #endif\n\n        return diffuse;\n    }\n#endif\n\n#ifdef HAS_SPECULARPBR\n    uniform float uSpecularPBRFactor;\n    \n    vec3 getMaterialSpecular() {\n        #ifdef SAMPLER_SPECULARPBR\n            return uSpecularPBRFactor * COLOR_CONVERT_SPECULARPBR(texture2D(SAMPLER_SPECULARPBR, UV_SPECULARPBR).PACK_SPECULARPBR);\n        #else\n            return vec3(uSpecularPBRFactor);\n        #endif\n    }\n#endif\n\n// MICROSURFACE\n#ifdef HAS_ROUGHNESSPBR\n    uniform float uRoughnessPBRFactor;\n    \n    float getMaterialRoughness() {\n        #ifdef SAMPLER_ROUGHNESSPBR\n            float fetch = COLOR_CONVERT_ROUGHNESSPBR(texture2D(SAMPLER_ROUGHNESSPBR, UV_ROUGHNESSPBR).PACK_ROUGHNESSPBR);\n\n            #ifdef HAS_REFRACTION_MICROSURFACE\n                gRefractionRoughness *= fetch;\n            #endif\n\n            return uRoughnessPBRFactor * fetch;\n        #else\n            return uRoughnessPBRFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_GLOSSINESSPBR\n    uniform float uGlossinessPBRFactor;\n    \n    float getMaterialGlossiness() {\n        #ifdef SAMPLER_GLOSSINESSPBR\n            float fetch = COLOR_CONVERT_GLOSSINESSPBR(texture2D(SAMPLER_GLOSSINESSPBR, UV_GLOSSINESSPBR).PACK_GLOSSINESSPBR);\n\n            #ifdef HAS_REFRACTION_MICROSURFACE\n                gRefractionRoughness = mix(1.0 - fetch, 1.0, gRefractionRoughness);\n            #endif\n\n            return uGlossinessPBRFactor * fetch;\n        #else\n            return uGlossinessPBRFactor;\n        #endif\n    }\n#endif\n\n\n#ifdef HAS_EMITCOLOR\n    uniform float uEmitColorFactor;\n    uniform int uEmitMultiplicative;\n\n    vec3 getMaterialEmitColor() {\n        #ifdef SAMPLER_EMITCOLOR\n            return uEmitColorFactor * COLOR_CONVERT_EMITCOLOR(texture2D(SAMPLER_EMITCOLOR, UV_EMITCOLOR).PACK_EMITCOLOR);\n        #else\n            return vec3(0.0);\n        #endif\n    }\n#endif\n\n#ifdef HAS_AOPBR\n    uniform float uAOPBRFactor;\n    uniform int uAOPBROccludeSpecular;\n\n    float getMaterialAO() {\n        return mix(1.0, COLOR_CONVERT_AOPBR(texture2D(SAMPLER_AOPBR, UV_AOPBR).PACK_AOPBR), uAOPBRFactor);\n    }\n#endif\n\n#ifdef HAS_CAVITYPBR\n    uniform float uCavityPBRFactor;\n\n    float getMaterialCavity() {\n        return mix(1.0, COLOR_CONVERT_CAVITYPBR(texture2D(SAMPLER_CAVITYPBR, UV_CAVITYPBR).PACK_CAVITYPBR), uCavityPBRFactor);\n    }\n#endif\n\n#ifdef HAS_SUBSURFACETRANSLUCENCY\n    uniform float uSubsurfaceTranslucencyFactor;\n    uniform float uSubsurfaceTranslucencyThicknessFactor;\n    uniform vec3 uSubsurfaceTranslucencyColor;\n    \n    float getMaterialTranslucency() {\n        #ifdef SAMPLER_SUBSURFACETRANSLUCENCY\n            return uSubsurfaceTranslucencyFactor * COLOR_CONVERT_SUBSURFACETRANSLUCENCY(texture2D(SAMPLER_SUBSURFACETRANSLUCENCY, UV_SUBSURFACETRANSLUCENCY).PACK_SUBSURFACETRANSLUCENCY);\n        #else\n            return uSubsurfaceTranslucencyFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_NORMALMAP\n    uniform float uNormalMapFactor;\n    uniform int uNormalMapFlipY;\n\n    vec3 getMaterialNormalMap() {\n        vec3 nmap = COLOR_CONVERT_NORMALMAP(texture2D(SAMPLER_NORMALMAP, UV_NORMALMAP).PACK_NORMALMAP) * 2.0 - 1.0;\n        nmap.y = uNormalMapFlipY == 1 ? -nmap.y : nmap.y;\n        return nmap;\n    }\n#endif\n\n#ifdef HAS_BUMPMAP\n    uniform float uBumpMapFactor;\n    uniform vec2 uBumpMapSize;\n\n    vec2 getMaterialBumpMap() {\n        vec2 bump;\n        vec3 invSize = vec3(1.0 / uBumpMapSize, 0.0);\n        return uBumpMapFactor * vec2(COLOR_CONVERT_BUMPMAP(texture2D(SAMPLER_BUMPMAP, UV_BUMPMAP - invSize.xz).PACK_BUMPMAP)\n                                    - COLOR_CONVERT_BUMPMAP(texture2D(SAMPLER_BUMPMAP, UV_BUMPMAP + invSize.xz).PACK_BUMPMAP),\n                                    COLOR_CONVERT_BUMPMAP(texture2D(SAMPLER_BUMPMAP, UV_BUMPMAP - invSize.zy).PACK_BUMPMAP)\n                                    -COLOR_CONVERT_BUMPMAP(texture2D(SAMPLER_BUMPMAP, UV_BUMPMAP + invSize.zy).PACK_BUMPMAP));\n    }\n#endif\n\n#ifdef HAS_SUBSURFACESCATTERING\n    uniform float uSubsurfaceScatteringProfile;\n    uniform float uSubsurfaceScatteringFactor;\n    uniform float uScatteringFactorPacker;\n    \n    float getMaterialScattering() {\n        #ifdef SAMPLER_SUBSURFACESCATTERING\n            return uScatteringFactorPacker * uSubsurfaceScatteringFactor * COLOR_CONVERT_SUBSURFACESCATTERING(texture2D(SAMPLER_SUBSURFACESCATTERING, UV_SUBSURFACESCATTERING).PACK_SUBSURFACESCATTERING);\n        #else\n            return uScatteringFactorPacker * uSubsurfaceScatteringFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_OPACITY\n    uniform float uOpacityFactor;\n    uniform int uOpacityInvert;\n\n    #ifdef HAS_OPACITY_MASK_OR_DITHER\n        uniform float uOpacityThinLayer;\n        uniform int uOpacityDithering;\n    #endif\n\n    #ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n        uniform int uOpacityAdditive;\n    #endif\n\n    #ifdef HAS_OPACITY_REFRACTION\n        uniform float uOpacityRoughnessFactor;\n    #endif\n\n    float getMaterialOpacity() {\n        float alpha = 1.0;\n    \n        #ifdef SAMPLER_OPACITY\n            alpha = COLOR_CONVERT_OPACITY(texture2D(SAMPLER_OPACITY, UV_OPACITY).PACK_OPACITY);\n            if (uOpacityInvert == 1) alpha = 1.0 - alpha;\n        #endif\n\n        #ifndef HAS_OPACITY_MASK_OR_DITHER\n            alpha *= uOpacityFactor;\n        #endif\n\n        #ifdef HAS_VERTEX_ALPHA\n            alpha *= vColor.a;\n        #endif\n\n        return alpha;\n    }\n#endif // HAS_OPACITY\n\n\n#ifdef HAS_CLEARCOAT\n    uniform vec3 uClearCoatTint;\n    uniform float uClearCoatThickness;\n    uniform float uClearCoatIor;\n    uniform float uClearCoatFactor;\n    uniform float uClearCoatF0;\n    \n    float getMaterialClearCoat() {\n        #ifdef SAMPLER_CLEARCOAT\n            return uClearCoatFactor * COLOR_CONVERT_CLEARCOAT(texture2D(SAMPLER_CLEARCOAT, UV_CLEARCOAT).PACK_CLEARCOAT);\n        #else\n            return uClearCoatFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_CLEARCOATROUGHNESS\n    uniform float uClearCoatRoughnessFactor;\n    \n    float getMaterialClearCoatRoughness() {\n        #ifdef SAMPLER_CLEARCOATROUGHNESS\n            return uClearCoatRoughnessFactor * COLOR_CONVERT_CLEARCOATROUGHNESS(texture2D(SAMPLER_CLEARCOATROUGHNESS, UV_CLEARCOATROUGHNESS).PACK_CLEARCOATROUGHNESS);\n        #else\n            return uClearCoatRoughnessFactor;\n        #endif\n    }\n#endif\n\n#ifdef HAS_CLEARCOATNORMALMAP\n    uniform float uClearCoatNormalMapFactor;\n    uniform int uClearCoatNormalMapFlipY;\n    \n    vec3 getMaterialClearCoatNormal() {\n        vec3 nmap = COLOR_CONVERT_CLEARCOATNORMALMAP(texture2D(SAMPLER_CLEARCOATNORMALMAP, UV_CLEARCOATNORMALMAP).PACK_CLEARCOATNORMALMAP) * 2.0 - 1.0;\n        nmap.y = uClearCoatNormalMapFlipY == 1 ? -nmap.y : nmap.y;\n        return nmap;\n    }\n#endif\n\n#ifdef HAS_ANISOTROPY\n    uniform float uAnisotropyFactor;\n    uniform float uAnisotropyDirection;\n    uniform int uAnisotropyFlipXY;\n\n    #ifdef SAMPLER_ANISOTROPY\n        vec2 getMaterialDirectionAnisotropy() {\n            vec2 dir = COLOR_CONVERT_ANISOTROPY(texture2D(SAMPLER_ANISOTROPY, UV_ANISOTROPY).PACK_ANISOTROPY) * 2.0 - 1.0;\n            if (uAnisotropyFlipXY == 1) dir.xy = dir.yx;\n            return dir;\n        }\n    #endif\n\n#endif\n\n/////////////////\n// LEGACY CLASSIC\n/////////////////\n#ifdef HAS_LEGACY_CLASSIC\n    uniform vec2 uTextureEnvironmentSpecularTextureSize;\n    uniform samplerCube sEnvironmentSpecular;\n    uniform mat3 uEnvironmentTransform;\n\n    uniform float uReflection;\n\n    uniform float uDiffuseColorFactor;\n    uniform float uDiffuseIntensityFactor;\n        vec3 getMaterialLegacyDiffuse() {\n        vec3 diffuse = vec3(0.0);\n        #if defined(SAMPLER_DIFFUSECOLOR)\n            diffuse = uDiffuseColorFactor * COLOR_CONVERT_DIFFUSECOLOR(texture2D(SAMPLER_DIFFUSECOLOR, UV_DIFFUSECOLOR).PACK_DIFFUSECOLOR);\n        #elif defined(HAS_DIFFUSECOLOR)\n            diffuse = vec3(uDiffuseColorFactor);\n        #endif\n\n        #ifdef HAS_VERTEX_COLOR\n            diffuse *= getVertexColor();\n        #endif\n\n        #ifdef HAS_DIFFUSEINTENSITY\n            #ifdef SAMPLER_DIFFUSEINTENSITY\n                diffuse *= uDiffuseIntensityFactor * COLOR_CONVERT_DIFFUSEINTENSITY(texture2D(SAMPLER_DIFFUSEINTENSITY, UV_DIFFUSEINTENSITY).PACK_DIFFUSEINTENSITY);\n            #else\n                diffuse *= uDiffuseIntensityFactor;\n            #endif\n        #endif\n\n        return diffuse;\n    }\n\n    uniform float uSpecularColorFactor;\n        vec3 getMaterialLegacySpecular() {\n        #if defined(SAMPLER_SPECULARCOLOR)\n            return uSpecularColorFactor * COLOR_CONVERT_SPECULARCOLOR(texture2D(SAMPLER_SPECULARCOLOR, UV_SPECULARCOLOR).PACK_SPECULARCOLOR);\n        #elif defined(HAS_SPECULARCOLOR)\n            return vec3(uSpecularColorFactor);\n        #else\n            return vec3(0.0);\n        #endif\n    }\n\n    uniform float uSpecularHardnessFactor;\n    float getMaterialLegacyShininess() {\n        #if defined(SAMPLER_SPECULARHARDNESS)\n            return uSpecularHardnessFactor * COLOR_CONVERT_SPECULARHARDNESS(texture2D(SAMPLER_SPECULARHARDNESS, UV_SPECULARHARDNESS).PACK_SPECULARHARDNESS);\n        #elif defined(HAS_SPECULARHARDNESS)\n            return uSpecularHardnessFactor;\n        #else\n            return 0.0;\n        #endif\n    }\n\n#endif'},nplI:function(e,t,n){"use strict";var i=n("a3nb"),r=n("icjm"),a=n("ip6O"),o=n("H9HN"),s=function(){this._cache={},this._ShaderCompiler=void 0};s.prototype={setShaderCompiler:function(e){this._ShaderCompiler=e,e._validAttributeTypeMemberCache||this._computeStateAttributeCache(e)},getShaderCompiler:function(){return this._ShaderCompiler},filterAttributeTypes:function(e){return!(!e.isEnabled||e.isEnabled())},getActiveAttributeList:function(e,t){for(var n="",i=e._attributeArray,r=this._ShaderCompiler._validAttributeTypeMemberCache,a=0,o=r.length;a<o;a++){var s=r[a],u=s<i.length?i[s]:void 0;if(u){var l=u._lastApplied;l&&!this.filterAttributeTypes(l)&&(n+=l.getHash(),t.push(l))}}return n},getActiveAttributeListCache:function(e){for(var t="",n=this._ShaderCompiler._validAttributeTypeMemberCache,i=0,r=n.length;i<r;i++){var a=n[i],o=a<e._attributeArray.length?e._attributeArray[a]:void 0;if(o){var s=o._lastApplied;if(!s||this.filterAttributeTypes(s))continue;t+=o._lastApplied.getHash()}}return t},getActiveTextureAttributeListCache:function(e){for(var t="",n=this._ShaderCompiler._validTextureAttributeTypeMemberCache,i=e._textureAttributeArrayList,r=0;r<i.length;r++){var a=i[r];if(a)for(var o=a.length,s=0;s<n.length;s++){var u=n[s],l=u<o?a[u]:void 0;if(l){var c=l._lastApplied;if(!c||this.filterAttributeTypes(c)||c.isTextureNull())continue;t+=c.getHash()}}}return t},getActiveTextureAttributeList:function(e,t){var n,i,r="",a=e._textureAttributeArrayList,o=this._ShaderCompiler._validTextureAttributeTypeMemberCache;for(n=0,i=a.length;n<i;n++){var s=a[n];if(s){t[n]=[];for(var u=0,l=o.length;u<l;u++){var c=o[u],h=c<s.length?s[c]:void 0;if(h){var d=h._lastApplied;!d||this.filterAttributeTypes(d)||d.isTextureNull()||(r+=d.getHash(),t[n].push(d))}}}}return r},getActiveUniforms:function(e,t,n){for(var i={},r=0,a=t.length;r<a;r++){var o=t[r];if(o.getOrCreateUniforms){var s=o.getOrCreateUniforms();if(void 0!==s)for(var u in s){var l=s[u];i[l.getName()]=l}}}for(var c=0,h=n.length;c<h;c++){var d=n[c];if(d)for(var f=0,p=d.length;f<p;f++){var g=d[f].getOrCreateUniforms(c);for(var m in g){var v=g[m];i[v.getName()]=v}}}return i},_computeStateAttributeCache:function(e){var t,n,a,o,s,u=e.stateAttributeConfig.attribute||[],l=[];for(n=0,a=u.length;n<a;n++)t=u[n],void 0!==(s=i.a.getIdFromTypeMember(t))&&(-1!==l.indexOf(s)?r.a.warn("Compiler "+e.name+" contains duplicate attribute entry "+t+", check the Compiler configuration"):l.push(s));for(o=new Uint8Array(l),e._validAttributeTypeMemberCache=o,l=[],n=0,a=(u=e.stateAttributeConfig.textureAttribute||[]).length;n<a;n++)t=u[n],s=i.a.getTextureIdFromTypeMember(t),-1!==l.indexOf(s)?r.a.warn("Compiler "+e.name+" contains duplicate texture attribute entry "+t+", check the Compiler configuration"):l.push(s);o=new Uint8Array(l),e._validTextureAttributeTypeMemberCache=o},_createWaitingProgram:function(e,t,n){var i=new a.a(new o.a(o.a.VERTEX_SHADER,"attribute vec3 Vertex;uniform mat4 uModelViewMatrix;uniform mat4 uProjectionMatrix;void main(void) {  gl_Position = vec4(10.0,10.0,10.0,1.0);}\n"),new o.a(o.a.FRAGMENT_SHADER,"#define SHADER_NAME WaitSafe\nprecision lowp float; void main(void) { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);}\n"));return this.getActiveAttributeList(e,t),i.setActiveUniforms(this.getActiveUniforms(e,t,n)),i.generated=!0,i.apply(e),i},getOrCreateProgram:function(){var e=[],t=[];return function(n){var i=this.getActiveAttributeListCache(n)+this.getActiveTextureAttributeListCache(n),r=this._getProgram(i,n,t,e);return void 0!==r?r:this._createProgram(i,n,t,e)}}(),_getProgram:function(e){return this._cache[e]},_createProgram:function(e,t,n,i){n.length=0,i.length=0,this.getActiveAttributeList(t,n),this.getActiveTextureAttributeList(t,i);var r=new(0,this._ShaderCompiler)(n,i),s=r.createFragmentShader(),u=r.createVertexShader(),l=new a.a(new o.a(o.a.VERTEX_SHADER,u),new o.a(o.a.FRAGMENT_SHADER,s));return l.hash=e,l.setActiveUniforms(this.getActiveUniforms(t,n,i)),l.generated=!0,this._cache[e]=l,l.apply(t),l},resetCache:function(){this._cache={}}};var u=s,l=function(){return this._generators={},this.addShaderGenerator("default",new u),this};l.prototype={getShaderGenerator:function(e){if(!e)return this._generators.default;var t=this._generators[e];return t||(r.a.error("ShaderGenerator "+e+" does not exist in ShaderGeneratorProxy"),this._generators.default)},addShaderGenerator:function(e,t){this._generators[e]=t}};var c=l,h=n("dhQu"),d={};d.ShaderGenerator=u,d.ShaderGeneratorProxy=c,d.shaderProcessor=h.a;t.a=d},nqMk:function(e,t,n){"use strict";var i=n("77vZ"),r=n("nPtx"),a=n("gCTM"),o=n("nzRv"),s=n("f5KD"),u=o.a.extend({displayName:"UpgradePlanPopupContent",optionTypes:{popupSubTitle:s.b.string.isRequired},events:{"click .upgrade-additional-callback":"additionalButtonCallback"},additionalButtonCallback:function(e){this.options.additionalButton&&"function"==typeof this.options.additionalButton.callback&&this.options.additionalButton.callback(e)},template:function(){return a.default.getFromString('\n            {% if options.popupImg %}<div class="illustration --{{ options.popupImg }}"></div>{% endif %}\n            <p class="title">{{ options.popupSubTitle }}</p>\n            <div class="infos">\n                {% for message in options.popupMessages %}\n                    <p>{{message|safe}}</p>\n                {% endfor %}\n            </div>\n            <div class="actions">\n                {% if options.nextPlan %}\n                    <div class="btn-wrapper">\n                        <a class="button btn-huge btn-important upgrade-link" href="{{ url(\'pages:plans\') }}" target="_blank">Upgrade to {{ options.nextPlan }}</a>\n                    </div>\n                {% endif %}\n                {% if options.additionalButton %}\n                    <div class="btn-wrapper">\n                        <a class="button btn-large btn-primary upgrade-additional-callback"\n                        {% if options.additionalButton.href %}href="{{ options.additionalButton.href }}" target="_blank"{% endif %}>{{ options.additionalButton.text }}</a>\n                    </div>\n                {% endif %}\n            </div>\n            ',{options:this.options})}});t.a=Object(i.a)(o.a.extend({template:function(){return a.default.getFromString("{{ components.popup | component }}",{components:this.createChildrenComponents({popup:{viewClass:r.a,options:{title:"",className:"upgrade-plan-popup",child:{viewClass:u,options:{popupImg:this.options.popupImg,popupSubTitle:this.options.popupSubTitle,popupMessages:this.options.popupMessages,nextPlan:this.options.nextPlan,additionalButton:this.options.additionalButton}}}}})})}}))},nzRv:function(e,t,n){"use strict";var i=n("MVZn"),r=n.n(i),a=n("EVdn"),o=n.n(a),s=n("TSHB"),u=n("Ui7z"),l=n("f5KD"),c=n("vBtE"),h=n("X2EN"),d=n("w0gJ"),f={name:"WithRefs",refs:{},initialize:function(){this.refreshRefs()},afterRender:function(){this.refreshRefs()},refreshRefs:function(){this.refs=Object(d.c)(this.$("[data-ref]")).reduce(function(e,t){var n=t.getAttribute("data-ref");return e["$"+n]=o()(t),e[n]=t,e},{})}},p=c.a.extend({displayName:"Component",mixins:[h.a,f],isComponent:!0,setElement:function(){return c.a.prototype.setElement.apply(this,arguments),this.isRenderedManually()&&(this.$el.attr("data-component")||this.$el.attr("data-component",""),this.$el.attr("id")||this.$el.attr("id",this.cid)),this},$:function(e){var t=this.$el;return this.$el.find(e).filter(function(){return o()(this).parent().closest("[data-component]").is(t)})},delegate:function(e,t,n){var i=this.$el;return this.$el.on(e+".delegateEvents"+this.cid,t,function(e){o()(e.currentTarget).closest("[data-component]").is(i)&&n.apply(this,arguments)}),this},_removeElement:function(){this.isRenderedManually()&&this.$el.html("")},isRenderedManually:function(){return!this.options._isChildOfAComponent},getItemKey:function(e,t,n){return(!e.options||function(e){return void 0===e||null===e||""===e}(e.options.key)||n.filter(function(t){return t.options.key===e.options.key}).length>1)&&console.error('Each child in an array or iterator should have a unique "key" option. Check the render method of `'+this.displayName+"`."),e.options&&e.options.key||t},normalizeChildConfig:function(e,t){var n=t||{};return Object(l.a)({viewClass:l.b.func.isRequired,options:l.b.object},n,"child property",this.displayName+".children."+e),r()({viewClass:p},n,{options:r()({},n.options,{_isChildOfAComponent:!0,el:void 0})})},_getLazyComponent:function(e,t){return function(){var n=this,i=this.updateChildConfig(e,this.normalizeChildConfig(e,t)).refreshChild(e).getChild(e);return{isComponentElement:!0,template:function(){var t=n.setChildOptions(e).getChild(e);return t.isMounted?t.shouldUpdate?t._template:"":(t._template=t.template(),t._template)},cid:i.cid,displayName:i.displayName}}.bind(this)},createChildComponent:function(e,t){var n=this;return Array.isArray(t)?t.map(function(i,r){var a=n.getItemKey(i,r,t);return n._getLazyComponent(e+a,i)}):this._getLazyComponent(e,t)},createChildrenComponents:function(e){return Object(s.a)(e,function(e,t){return this.createChildComponent(t,e)}.bind(this))},beforeRender:function(){c.a.prototype.beforeRender.apply(this,arguments),Object.keys(this.children).map(this.getChild.bind(this)).filter(Object(u.k)("isComponent")).forEach(function(e){e.beforeRender()})},removeUnmountedChildren:function(e){Object.keys(this.children).filter(function(t){return this.getChild(t).isComponent&&!e.match('id="'+this.getChild(t).cid+'"')}.bind(this)).forEach(this.removeChild.bind(this))},onViewUpdate:function(e,t,n,i,r,a){e&&(a||this.isRenderedManually()?(this.render(),this.viewDidUpdate(t,n)):(this._template=this.template(),this.removeUnmountedChildren(this._template),this._executeAfterRender=this.viewDidUpdate.bind(this,t,n)))},render:function(){this._template=this.template(),this.removeUnmountedChildren(this._template),this.renderDiff(this._template)},afterRender:function(){var e=this;c.a.prototype.afterRender.apply(this,arguments),Object.keys(this.children).map(this.getChild.bind(this)).filter(Object(u.k)("isComponent")).map(function(t){var n=e.el.querySelector("#".concat(t.cid));return n&&t.el!==n&&t.setElement(n),t}).forEach(function(e){e.afterRender()}),this._executeAfterRender&&(this._executeAfterRender(),this._executeAfterRender=null)}});t.a=p},o0dJ:function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\nvarying vec4 vViewPos;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n  vViewPos = uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n  gl_Position = (uProjectionMatrix * vViewPos).xyww;\n}\n"},o1A9:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"loadUploadPopup",function(){return S}),n.d(t,"loadModelEmbedPopup",function(){return y}),n.d(t,"loadCollectionEmbedPopup",function(){return x}),n.d(t,"loadDownloadPopup",function(){return C}),n.d(t,"loadLikePopup",function(){return w}),n.d(t,"loadEmailConfirmationPopup",function(){return T}),n.d(t,"loadResetPassword",function(){return M}),n.d(t,"loadShareAfterPublishPopup",function(){return E}),n.d(t,"loadModelPagePopup",function(){return A}),n.d(t,"loadAddToCollectionPopup",function(){return O}),n.d(t,"loadAuthenticatePopup",function(){return R}),n.d(t,"openAddToCollectionPopup",function(){return P}),n.d(t,"openCartLimitReachedPopup",function(){return I}),n.d(t,"openDownloadPopup",function(){return N}),n.d(t,"loadDownloadOwnModelPopup",function(){return L}),n.d(t,"loadInviteMember",function(){return k}),n.d(t,"loadDeactivateMember",function(){return D}),n.d(t,"loadRemoveMember",function(){return F}),n.d(t,"loadAddSeats",function(){return V}),n.d(t,"loadShareOrgModel",function(){return B}),n.d(t,"openMaintenancePopup",function(){return U}),n.d(t,"loadVisibilityPopup",function(){return j});var i=n("o0o1"),r=n.n(i),a=n("yXPU"),o=n.n(a),s=n("12sq"),u=n("dZz+"),l=n("qCPs"),c=n("MzWk"),h=n("gPpI"),d=n("QKgc"),f=n("DWw0"),p=n("gBaA"),g=n("K/JG"),m=n("c1T2"),v=n("DTOf"),_=n("tgOl"),b=n("M4AY"),S=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(7),n.e(3),n.e(37),n.e(145)]).then(n.bind(null,"/Ogv"))},loading:{viewClass:g.a,options:{message:"Loading the required files for your upload.",title:"Preparing upload",width:600}}})},y=function(){return Object(c.a)({loader:function(){return e.all([n.e(2),n.e(40),n.e(47),n.e(48),n.e(147)]).then(n.bind(null,"gA+X"))},loading:{viewClass:g.a,options:{message:"Loading the required files",title:"Preparing embed popup"}}})},x=function(){return Object(c.a)({loader:function(){return e.all([n.e(2),n.e(40),n.e(47),n.e(48),n.e(152)]).then(n.bind(null,"/qoV"))},loading:{viewClass:g.a,options:{message:"Loading the required files",title:"Preparing embed popup"}}})},C=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(3),n.e(37),n.e(42),n.e(159)]).then(n.bind(null,"Ja8E"))},loading:{viewClass:g.a,options:{message:"Loading the required files",title:"Preparing download"}}})},w=function(){return Object(c.a)({loader:function(){return e.all([n.e(63),n.e(163)]).then(n.bind(null,"ZN8d"))},loading:{viewClass:g.a,options:{title:"Loading likes"}}})},T=function(){return Object(c.a)({loader:function(){return e.resolve().then(n.bind(null,"tgOl"))},loading:{viewClass:g.a}})},M=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(41),n.e(3),n.e(37),n.e(148)]).then(n.bind(null,"9DMy"))},loading:{viewClass:g.a}})},E=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(3),n.e(37),n.e(42),n.e(151)]).then(n.bind(null,"cUma"))},loading:{viewClass:g.a}})},A=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(2),n.e(7),n.e(52),n.e(144)]).then(n.bind(null,"wJwh"))},loading:{viewClass:g.a,options:{title:""}}})},O=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(7),n.e(3),n.e(37),n.e(158)]).then(n.bind(null,"e/wf"))},loading:{viewClass:g.a}})},R=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(41),n.e(3),n.e(37),n.e(149)]).then(n.bind(null,"rqom"))},loading:{viewClass:g.a}})},P=function(){var t=o()(r.a.mark(function t(n){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!u.a.me().get("isLimited")){t.next=5;break}return t.next=3,T();case 3:return i=t.sent,t.abrupt("return",new i({reason:"publish"}).open().then(function(){return e.reject(new Error("User need to confirm his email"))}));case 5:return t.next=7,new e(function(e){return u.a.authenticate(e)});case 7:return t.next=9,O();case 9:return a=t.sent,t.abrupt("return",new a({model:n}).open());case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),I=function(){return new m.a({title:"Cart limit reached",text:"You have reached the limit of ".concat(s.a.storeCartMaxSize," models you can put in one cart. Please proceed to checkout before adding new models to your cart."),renderButtons:function(e){return[{viewClass:v.a,options:{key:"cancel",text:"Cancel",type:"tertiary",onClick:e.cancel}},{viewClass:v.a,options:{key:"checkout",text:"checkout now",type:"store",onClick:function(){window.location.assign(Object(h.e)("store:checkout"))}}}]}}).open()},N=function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).userCanDownloadOrgModel,i=void 0!==n&&n,r=b.b.store.getState(),a=b.c.authUser.user(r);return i||Object(f.c)(a,t)?(p.a.modelPageDownloadButtonClicked(t.uid),"store"!==t.downloadType&&a.isLimited?new _.default({reason:"download"}).open():b.c.authUser.isAuthenticated(r)?(location.hash="#download",C().then(function(e){return new e({model:new l.a(t)}).open()}).then(function(){history.replaceState("",document.title,window.location.pathname+window.location.search)}).catch(Object(d.l)(d.j))):e.resolve(b.b.store.dispatch(b.a.authUser.authenticate(function(){},{redirectUrl:window.location.href})))):e.resolve()},L=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(3),n.e(37),n.e(42),n.e(153)]).then(n.bind(null,"Tt5v"))},loading:{viewClass:g.a}})},k=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(3),n.e(37),n.e(42),n.e(150)]).then(n.bind(null,"TJs2"))},loading:{viewClass:g.a}})},D=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(7),n.e(3),n.e(37),n.e(157)]).then(n.bind(null,"ovTh"))},loading:{viewClass:g.a}})},F=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(7),n.e(3),n.e(37),n.e(154)]).then(n.bind(null,"D0RM"))},loading:{viewClass:g.a}})},V=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(3),n.e(37),n.e(42),n.e(155)]).then(n.bind(null,"C64p"))},loading:{viewClass:g.a}})},B=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(3),n.e(37),n.e(42),n.e(156)]).then(n.bind(null,"8MlR"))},loading:{viewClass:g.a}})},U=function(e){return new m.a({title:"Maintenance",text:e,buttons:{ok:!0}}).open()},j=function(){return Object(c.a)({loader:function(){return e.all([n.e(1),n.e(37),n.e(62),n.e(168)]).then(n.bind(null,"IFcR"))},loading:{viewClass:g.a}})},G={loadUploadPopup:S,loadModelEmbedPopup:y,loadCollectionEmbedPopup:x,loadDownloadPopup:C,loadLikePopup:w,loadEmailConfirmationPopup:T,loadResetPassword:M,loadShareAfterPublishPopup:E,loadModelPagePopup:A,loadAddToCollectionPopup:O,loadAuthenticatePopup:R,openAddToCollectionPopup:P,openCartLimitReachedPopup:I,openDownloadPopup:N,loadInviteMember:k,loadAddSeats:V,loadDeactivateMember:D,loadRemoveMember:F,openMaintenancePopup:U,loadVisibilityPopup:j,loadDownloadOwnModelPopup:L};t.default=G}.call(this,n("CSL1"))},oCbj:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Qavt"),a=function(e,t,n,i){r.a.call(this),this._x=void 0!==e?e:-1,this._y=void 0!==t?t:-1,this._width=void 0!==n?n:-1,this._height=void 0!==i?i:-1};i.a.createPrototypeStateAttribute(a,i.a.objectInherit(r.a.prototype,{attributeType:"Scissor",cloneType:function(){return new a},setScissor:function(e,t,n,i){this._x=e,this._y=t,this._width=n,this._height=i},x:function(){return this._x},y:function(){return this._y},width:function(){return this._width},height:function(){return this._height},apply:function(e){e.applyScissor(this)}}),"osg","Scissor"),t.a=a},oDhZ:function(e,t,n){"use strict";n.r(t);var i=n("XKim"),r=n("wwkN"),a=n("czSk"),o=n("Ep1f"),s=n("r7P/"),u=n("a3nb"),l=n("b/No"),c=n("EnLC"),h=function(e){s.a.call(this,e),this._pooledMatrix=new c.a(a.c.create),this._matrixStack=new l.a,this._matrixStack.push(a.c.IDENTITY),this._bb=new i.a};u.a.createPrototypeObject(h,u.a.objectInherit(s.a.prototype,{reset:function(){this._pooledMatrix.reset(),this._matrixStack.reset(),this._matrixStack.push(a.c.IDENTITY),this._bb.init()},getBoundingBox:function(){return this._bb},applyTransform:function(e){var t=this._pooledMatrix.getOrCreateObject();a.c.copy(t,this._matrixStack.back()),e.computeLocalToWorldMatrix(t,this),this.pushMatrix(t),this.traverse(e),this.popMatrix()},apply:function(e){e instanceof o.a?this.applyTransform(e):e instanceof r.a?this.applyBoundingBox(e.getBoundingBox()):this.traverse(e)},pushMatrix:function(e){this._matrixStack.push(e)},popMatrix:function(){this._matrixStack.pop()},applyBoundingBox:function(){var e=new i.a;return function(t){t.valid()&&(t.transformMat4(e,this._matrixStack.back()),this._bb.expandByBoundingBox(e))}}(),getMatrixStack:function(){return this._matrixStack}}),"osg","ComputeBoundsVisitor"),t.default=h},oDvv:function(e,t,n){"use strict";var i=n("czSk"),r=n("R8W4"),a=n("QtKT"),o=function(){this._hit=!1,this._primitiveIndex=0,this._vertices=void 0,this._geometry=void 0,this._intersectionVisitor=void 0,this._intersector=void 0,this._limitOneIntersection=!1,this._primitiveMask=a.a.ALL_PRIMITIVES};o.Intersection=function(){this._nodePath=void 0,this._drawable=void 0,this._matrix=void 0,this._primitiveIndex=void 0,this._ratio=0,this._backface=!1,this._localIntersectionPoint=i.f.create()},o.prototype={reset:function(){this._hit=!1,this._vertices=void 0,this._primitiveIndex=0},setPrimitiveIndex:function(e){this._primitiveIndex=e},setGeometry:function(e){this._geometry=e,this._primitiveIndex=0,this._vertices=e.getAttributes().Vertex.getElements()},setVertices:function(e){this._vertices=e},setIntersectionVisitor:function(e){this._intersectionVisitor=e},setIntersector:function(e){this._intersector=e,this._primitiveMask=e.getPrimitiveMask();var t=e.getIntersectionLimit();this._limitOneIntersection=t===a.a.LIMIT_ONE_PER_DRAWABLE||t===a.a.LIMIT_ONE},setLimitOneIntersection:function(e){this._limitOneIntersection=e},leave:function(){},enter:function(){},initIntersection:function(e){return e._matrix=i.c.clone(this._intersectionVisitor.getModelMatrix()),e._nodePath=this._intersectionVisitor.getNodePath().slice(),e._primitiveIndex=this._primitiveIndex,e._drawable=this._geometry,this._intersector.getIntersections().push(e),this._hit=!0,e},intersectPoint:function(){},intersectLine:function(){},intersectTriangle:function(){},operatorPoint:function(){var e=i.f.create();return function(t){if(!(this._limitOneIntersection&&this._hit||0==(this._primitiveMask&a.a.POINT_PRIMITIVES))){var n=this._vertices;i.f.set(e,n[3*t],n[3*t+1],n[3*t+2]),this.intersectPoint(e,t),this._primitiveIndex++}}}(),operatorLine:function(){var e=i.f.create(),t=i.f.create();return function(n,r){if(!(this._limitOneIntersection&&this._hit||0==(this._primitiveMask&a.a.LINE_PRIMITIVES))){var o=this._vertices;i.f.set(e,o[3*n],o[3*n+1],o[3*n+2]),i.f.set(t,o[3*r],o[3*r+1],o[3*r+2]),this.intersectLine(e,t,n,r),this._primitiveIndex++}}}(),operatorTriangle:function(){var e=i.f.create(),t=i.f.create(),n=i.f.create();return function(r,o,s){if(!(this._limitOneIntersection&&this._hit||0==(this._primitiveMask&a.a.TRIANGLE_PRIMITIVES))){var u=this._vertices;i.f.set(e,u[3*r],u[3*r+1],u[3*r+2]),i.f.set(t,u[3*o],u[3*o+1],u[3*o+2]),i.f.set(n,u[3*s],u[3*s+1],u[3*s+2]),this.intersectTriangle(e,t,n,r,o,s),this._primitiveIndex++}}}(),apply:function(e){e.getAttributes().Vertex&&Object(r.a)(e,this)}},t.a=o},oR1v:function(e,t,n){"use strict";n.d(t,"f",function(){return a}),n.d(t,"g",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"d",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return f});var i=n("UXvI"),r=n("89mf");function a(e){return e.preventDefault(),e}function o(e){return e.stopPropagation(),e}function s(e){return{eventName:e.split(" ")[0],selector:e.split(" ").slice(1).join(" ")}}function u(e){var t=e.originalEvent||e;return{x:t.type.match(/^touch/)?t.changedTouches[0]?t.changedTouches[0].pageX:0:t.clientX,y:t.type.match(/^touch/)?t.changedTouches[0]?t.changedTouches[0].pageY:0:t.clientY}}function l(e,t){return t.velocity=function(e,t){var n=u(t),i=e?u(e):n;return{x:n.x-i.x,y:n.y-i.y}}(e,t),t}var c=function(e){var t=u(e),n=t.x,i=t.y;return e.dragX=n,e.dragY=i,e},h=function(e,t,n){return function(a){var o=!1,s=!1,u=Object(i.a)(Object(r.f)(l,void 0,function(e){o=!0,s||n.onDrag(c(e))}),16);window.addEventListener(e,u),window.addEventListener(t,function i(r){s=!0,o&&n.onDragEnd(c(r)),window.removeEventListener(e,u),window.removeEventListener(t,i)}),n.onDragStart(c(a))}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onDrag,n=e.onDragStart,i=void 0===n?function(e){return e}:n,r=e.onDragEnd,a=void 0===r?function(e){return e}:r;return{onMouseDown:h("mousemove","mouseup",{onDrag:t,onDragStart:i,onDragEnd:a}),onTouchStart:h("touchmove","touchend",{onDrag:t,onDragStart:i,onDragEnd:a})}},f=function(e){return function(t){13===function(e){return e.which||e.keyCode}(t)&&e(t)}}},oY7F:function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/components/atoms/button.jinja"]={root:function(e,t,n,i,r){var a="";try{var o=i.makeMacro([],["options"],function(r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var o,s="";return o=e.getFilter("merge").call(t,{attrs:{disabled:!0,classNames:{button:!0,"btn-medium":!0}},text:"",subtext:"",iconAttrs:{},loading:!1,hasIcon:!1},i.contextOrFrameLookup(t,n,"options")),n.set("options",o,!0),n.topLevel&&t.setVariable("options",o),n.topLevel&&t.addExport("options",o),s+="<button ",s+=i.suppressValue(e.getFilter("attributes").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"attrs")),e.opts.autoescape),s+=">",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"loading")?s+='<span class="spinner"></span>':i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"hasIcon")&&(s+="<span ",s+=i.suppressValue(e.getFilter("attributes").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"iconAttrs")),e.opts.autoescape),s+="></span>"),i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"subtext")&&(s+='<span class="button__text-container">'),s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"text"),e.opts.autoescape),i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"subtext")&&(s+='<span class="button__subtext">',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"subtext"),e.opts.autoescape),s+="</span>"),i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"subtext")&&(s+="</span>"),s+="</button>\n",n=a,new i.SafeString(s)});t.addExport("button"),t.setVariable("button",o),r(null,a+="\n")}catch(e){r(i.handleError(e,null,null))}}}},oYSw:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var i=n("lSNA"),r=n.n(i),a=n("MVZn"),o=n.n(a),s=n("m8R6"),u=n("Ui7z"),l=n("uoDY"),c=Object(u.j)(1/0),h=function(e){return function(t,n){return Object(l.b)(n)?n.payload.effect.caseOf({Pending:function(){return function(t,n){var i=e(t,n);if(i===t)return t;var a=Object(u.a)(i,t);return o()({},i,{optimistic:r()({},n.meta.effectId,a)})}(t,n)},Rejected:function(){return function(t,n){var i=e(t,n);return i.optimistic[n.meta.effectId]?o()({},c(i,i.optimistic[n.meta.effectId]),{optimistic:Object(s.a)(i.optimistic,[n.meta.effectId])}):i}(t,n)},Resolved:function(){return function(t,n){var i=e(t,n);return i.optimistic[n.meta.effectId]?o()({},i,{optimistic:Object(s.a)(i.optimistic,[n.meta.effectId])}):i}(t,n)}}):e(t,n)}}},olBt:function(e,t,n){"use strict";n.r(t);var i=[];t.default={applyFunctionArray:i,registerApplyFunction:function(e,t){i[e]=t},getApplyFunction:function(e){return i[e]}}},orCE:function(e,t){e.exports='#pragma include "utils/functions.glsl"\r\n\r\nvec2 computeUVForMipmap(const in float level, const in vec2 uv) {\r\n    // width for level\r\n    float widthForLevel = exp2(uTextureEnvironmentSpecularPBRLodRange.x - level);\r\n\r\n    // the height locally for the level in pixel\r\n    // to opimitize a bit we scale down the v by two in the inputs uv\r\n    float heightForLevel = widthForLevel * 0.5;\r\n\r\n    // compact version\r\n    float texelSize = 1.0 / uTextureEnvironmentSpecularPBRTextureSize.x;\r\n    vec2 uvSpaceLocal =  vec2(1.0) + uv * vec2(widthForLevel - 2.0, heightForLevel - 2.0);\r\n    uvSpaceLocal.y += uTextureEnvironmentSpecularPBRTextureSize.x - widthForLevel;\r\n    return uvSpaceLocal * texelSize;\r\n}\r\n\r\n//for y up\r\nvec2 normalToPanoramaUVY(const in vec3 dir) {\r\n    float n = length(dir.xz);\r\n\r\n    // to avoid bleeding the max(-1.0,dir.x / n) is needed\r\n    vec2 pos = vec2((n > 0.0000001) ? max(-1.0, dir.x / n) : 0.0, dir.y);\r\n\r\n    // fix edge bleeding\r\n    if (pos.x > 0.0) pos.x = min(0.999999, pos.x);\r\n\r\n    pos = acos(pos) * 0.3183098861837907; // inv_pi\r\n\r\n    pos.x = (dir.z > 0.0) ? pos.x * 0.5 : 1.0 - (pos.x * 0.5);\r\n\r\n    // shift u to center the panorama to -z\r\n    pos.x = mod(pos.x - 0.25 + 1.0, 1.0);\r\n    pos.y = 1.0 - pos.y;\r\n    return pos;\r\n}\r\n\r\nvec3 prefilterEnvMapPanorama(const in float rLinear, const in vec3 R) {\r\n    float lod = min(uTextureEnvironmentSpecularPBRLodRange.x, linRoughnessToMipmap(rLinear) * uTextureEnvironmentSpecularPBRLodRange.y);\r\n    vec2 uvBase = normalToPanoramaUVY(R);\r\n\r\n    // // we scale down v here because it avoid to do twice in sub functions\r\n    // uvBase.y *= 0.5;\r\n\r\n    vec3 texel0 = LUVToRGB(texture2D(sSpecularPBR, computeUVForMipmap(floor(lod), uvBase)));\r\n    vec3 texel1 = LUVToRGB(texture2D(sSpecularPBR, computeUVForMipmap(ceil(lod), uvBase)));\r\n\r\n    return mix(texel0, texel1, fract(lod));\r\n}\r\n'},orRi:function(e,t){e.exports={skfbWhite:"#ffffff",skfbRed:"#f02624",skfbDarkRed:"#d7100e",skfbLightBlue:"#49cdf8",skfbLighterBlue:"#e8f7fb",skfbLightBlueBackground:"#f7f9fa",skfbBlue:"#1caad9",skfbDarkBlue:"#1c88bb",skfbLightYellow:"#fff8eb",skfbYellow:"#fed600",skfbOrange:"#ff9e3a",skfbGreen:"#28cca7",skfbBrightGreen:"#1ac95d",skfbPurple:"#df1660",skfbLightPurple:"#ffe4ee",skfbBlack:"#222222",skfbDarkBlack:"#000000",skfbGrey0:"#555555",skfbGrey1:"#888888",skfbGrey2:"#999999",skfbGrey3:"#cccccc",skfbGrey4:"#dddddd",skfbGrey5:"#e7e7e7",skfbGrey6:"#f2f2f2",skfbDarkAlpha:"rgba(0, 0, 0, 0.2)",skfbBlueAlpha:"rgba(28, 170, 217, 0.1)",skfbEditorGrey0:"#000000",skfbEditorGrey1:"#1a1a1a",skfbEditorGrey2:"#333333",skfbEditorGrey3:"#595959",skfbEditorGrey4:"#666666",skfbEditorGrey5:"#777777",skfbEditorGrey6:"#888888",skfbEditorGrey7:"#cccccc",containerInfoBg:"#ddf6fa",containerInfoBorder:"#8bdded",containerWarningBg:"#fff8eb",containerWarningBorder:"#fed600",containerDangerBg:"#f6d3d6",containerDangerBorder:"#e07881",colorPositive:"#1ac95d",colorError:"#f02624",colorRestricted:"#f02624",colorDanger:"#f02624",colorWarning:"#fed600",colorStaff:"#ff9e3a",colorMaster:"#28cca7",websiteBackgroundColor:"#f2f2f2",websiteTopBackgroundColor:"white",websiteTopTextColor:"#222222",websiteTopHoverColor:"#1caad9",websiteTopSearchColor:"#999999",websiteTopSearchActiveColor:"black",websiteOddTextColor:"#555555",websiteOddLinkColor:"#1caad9",websiteOddHoverLinkColor:"#1c88bb",websiteEvenTextColor:"#eeeeee",websiteEvenLinkColor:"white",websiteEvenHoverLinkColor:"#f2f2f2",websiteSidebarIconColor:"#999999",editorColor:"#333333",editorImportantColor:"#0d0d0d",editorKeyColor:"#1a1a1a",editorMinorColor:"#4d4d4d",editorTrivialColor:"#595959",editorTextColor:"#cccccc",editorStrongColor:"white",editorBorderColor:"black",editorActiveColor:"#1caad9",editorScrollbarTrackColor:"#a3a3a3",editorScrollbarThumbColor:"#444444",viewerRadialBackgroundFrom:"#f2f2f2",viewerRadialBackgroundTo:"#b3b3b3",viewerPrimaryLoadingColor:"#1caad9",viewerSecondaryLoadingColor:"#1caad9",viewerBackgroundColor:"black",brandColor:"#1caad9",facebookColor:"#3a589a",twitterColor:"#00c4fc",googleButtonColor:"#ffffff",pinterestColor:"#ce1d21",linkedinColor:"#1884bc",instagramColor:"#125688",tumblrColor:"#36465d",redditColor:"#ff5700",mailColor:"#555555",websiteSuccessColor:"#00a317",storeColor:"#df1660",storeHoverColor:"#c81859",storeGradient:"linear-gradient(45deg, #a60b43 0%, #f42671 100%)",websiteStoreCheckoutGradient:"linear-gradient(45deg, #1caad9, #49cdf8)",labelColor:"#888888",dropdownArrowColor:"#b8b8b8",dropdownArrowColorHighlight:"#222222",linkColor:"#1caad9",linkHoverColor:"#1c88bb",privateLimitInfoBg:"#fff8eb",privateLimitInfoBorder:"#fed600",privateLimitReachedBg:"#f6d3d6",privateLimitReachedBorder:"#e07881",colorPlusUser:"#4cc8f1",colorProUser:"#00aad8",colorPremUser:"#007395",colorBizUser:"#003748",colorEntUser:"#222222",userFlagPlus:"#4cc8f1",userFlagPro:"#00aad8",userFlagPrem:"#007395",userFlagBiz:"#003748",userFlagEnt:"#222222",userFlagStaff:"#ff9e3a",userFlagMaster:"#28cca7",colorHeaderTop:"#2e3338",colorHeaderMain:"#2a404e",colorButtonPrimary:"#1caad9",colorButtonTextBright:"#ffffff"}},ovGl:function(e,t){e.exports="\nvoid main(void) {\n    gl_FragColor =  vec4(0.2, 0.2, 0.2, 1.0);\n}\n"},ozxe:function(e,t,n){"use strict";var i=n("q1z7"),r=n.n(i),a=n("EVdn"),o=n.n(a),s=n("YfG3"),u=n("4kdM"),l=n("i6dD");t.a=l.a.extend({el:['<div class="widget slider-widget">','          <div class="widget-wrapper">','              <div class="bar">','                  <div class="slide">','                      <div class="cursor"></div>',"                  </div>","              </div>","          </div>","      </div>"].join(""),events:Object(s.a)({},l.a.prototype.events,{"mousedown .bar":"trackDrag","mousedown .cursor":"cursorDrag","touchstart .bar":"trackDrag","touchstart .cursor":"cursorDrag"}),constructor:function(e,t){t=Object(u.a)(t||{},{model:new r.a.Model,name:"value",minimum:0,maximum:1,step:.01,orientation:"horizontal"}),l.a.prototype.constructor.call(this,e,t),void 0===this.get()&&this.set(0)},initialize:function(){this.$slide=this.$(".slide"),"vertical"===this.options.orientation&&this.$el.addClass("--vertical"),this.started=!1,this.render()},delegateEvents:function(){l.a.prototype.delegateEvents.apply(this,arguments),o()(window).on("mousemove.delegateEvents"+this.cid,this.moveEvent.bind(this)),o()(window).on("mouseup.delegateEvents"+this.cid,this.stopEvent.bind(this)),o()(window).on("touchmove.delegateEvents"+this.cid,this.moveEvent.bind(this)),o()(window).on("touchend.delegateEvents"+this.cid,this.stopEvent.bind(this))},undelegateEvents:function(){l.a.prototype.undelegateEvents.apply(this,arguments),o()(window).off(".delegateEvents"+this.cid)},render:function(){var e=this.options.maximum-this.options.minimum,t=(this.get()-this.options.minimum)/e*100,n={};"vertical"===this.options.orientation?n.height=t+"%":n.width=t+"%",this.$slide.css(n)},startEvent:function(e){e.preventDefault(),this.$el.addClass("fast"),this.started=!0},stopEvent:function(e){this.started&&(e.preventDefault(),this.$el.removeClass("fast"),this.started=!1)},moveEvent:function(e){this.started&&(e.preventDefault(),this.selectEvent(e))},selectEvent:function(e){var t,n;if(e.preventDefault(),"horizontal"===this.options.orientation){var i=this.$el.offset().left,r=this.$el.width();void 0===(n=e.pageX)&&(n=e.originalEvent.touches[0].pageX),t=(n-i)/r}else if("vertical"===this.options.orientation){var a=this.$el.offset().top,o=this.$el.height();(n=e.pageY)||(n=e.originalEvent.touches[0].pageY),t=(a+o-n)/o}t=Math.min(Math.max(0,t),1),t=this.options.minimum+t*(this.options.maximum-this.options.minimum),this.change(t)},cursorDrag:function(e){this.startEvent(e),e.stopPropagation()},trackDrag:function(e){this.startEvent(e),this.moveEvent(e)}})},"p4E/":function(e,t,n){"use strict";var i=n("gcR/"),r=n.n(i),a=n("q1tI"),o=n.n(a),s=n("/MKj"),u=n("G9Ht"),l=n.n(u),c=n("wsGC"),h=n("M4AY"),d=n("/f4T"),f=n("gPpI"),p=n("5bbf"),g=n("pVnL"),m=n.n(g),v=r()("path",{d:"M6 11A5 5 0 106 1a5 5 0 000 10zM6 0a6 6 0 014.581 9.875l3.273 3.271a.5.5 0 01-.708.708L9.875 10.58A6 6 0 116 0z",id:"search",fillRule:"evenodd"}),_=function(e){return o.a.createElement("svg",m()({viewBox:"0 0 14 14"},e),v)};n.d(t,"a",function(){return y});var b=Object(s.c)(function(e){return{value:h.c.search.query(e),isSearchOpen:h.c.search.isOpen(e)}},{onChange:h.a.search.updateQuery,onBack:h.a.search.back,onOpen:h.a.search.open}),S=r()(_,{className:"c-page-header__action__icon"}),y=b(function(e){var t=e.className,n=e.onOpen;return r()("div",{className:Object(c.a)("c-page-header__action",t)},void 0,r()("a",{href:Object(f.e)("search:search"),className:"c-page-header__action__icon-container","aria-label":"Search",onClick:function(e){e.preventDefault(),n()}},void 0,S))}),x=r()("button",{"aria-hidden":"true",className:"c-search-bar__icon custom-icons icon-search",type:"submit"});t.b=b(function(e){var t=e.value,n=e.isSearchOpen,i=e.onBack,o=e.onOpen,s=e.onChange,u=a.useRef(null);a.useEffect(function(){n&&u.current&&u.current.focus()},[n]);var h=a.useContext(p.a);return r()("form",{className:Object(c.a)("c-search-bar","c-page-header__col",{"--searching":n,"--transparent":"transparent"===h}),action:".",onSubmit:function(e){return e.preventDefault()}},void 0,r()("div",{className:"c-search-bar__box"},void 0,x,a.createElement("input",{"data-selenium":"search-input","aria-label":"Search",ref:u,className:"c-search-bar__input",type:"text",name:"query",placeholder:"Search 3D models",autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",maxLength:128,value:t,onChange:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return s(e.target.value)}),onFocus:function(){return o()},onKeyUp:function(e){13===e.keyCode&&(l.a.any&&u.current&&u.current.blur(),e.stopPropagation())},onKeyDown:function(e){27===e.keyCode&&u.current&&u.current.blur()}}),r()("a",{"aria-label":"Clear search",className:Object(c.a)("c-search-bar__clear",{"--hidden":!t}),onClick:function(){s(""),u.current&&u.current.focus()}})),r()(d.a,{size:"medium",type:"tertiary",href:"/",className:Object(c.a)("c-search-bar__cancel",{"--hidden":!n}),onClick:function(e){e.preventDefault(),i()},text:"Cancel"}))})},p7hb:function(e,t,n){n("rMSa"),(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/user.jinja"]={root:function(e,t,n,i,r){var a=null,o=null,s="";try{e.getTemplate("skfb_front/macros/buttons.jinja",!1,"skfb_front/macros/user.jinja",!1,function(u,l){u?r(u):l.getExported(function(u,l){if(u)r(u);else if(l.hasOwnProperty("follow_button")){var c=l.follow_button;t.setVariable("follow_button",c),s+="\n\n";var h=i.makeMacro(["user"],["options"],function(r,a){var o=n;n=new i.Frame,(a=a||{}).hasOwnProperty("caller")&&n.set("caller",a.caller),n.set("user",r),n.set("options",a.hasOwnProperty("options")?a.options:{});var s,u="";return u+="\n    ",s=e.getFilter("merge").call(t,{avatarWidth:20,avatarHeight:20},i.contextOrFrameLookup(t,n,"options")),n.set("options",s,!0),n.topLevel&&t.setVariable("options",s),n.topLevel&&t.addExport("options",s),u+='\n    <div\n        class="avatar"\n        data-user-summary-anchor="true"\n        data-user="',u+=i.suppressValue(i.memberLookup(r,"uid"),e.opts.autoescape),u+='">\n        ',u+=i.suppressValue(e.getFilter("image_container").call(t,i.memberLookup(r,"avatars"),i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"avatarWidth"),i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"avatarHeight")),e.opts.autoescape),u+="\n    </div>\n",n=o,new i.SafeString(u)});t.addExport("user_name_avatar"),t.setVariable("user_name_avatar",h),s+="\n\n";var d=i.makeMacro(["authUser","user"],["options"],function(r,s,u){var l=n;n=new i.Frame,(u=u||{}).hasOwnProperty("caller")&&n.set("caller",u.caller),n.set("authUser",r),n.set("user",s),n.set("options",u.hasOwnProperty("options")?u.options:{});var c,h,d,f,p,g="";return c=e.getFilter("merge").call(t,{noLink:!1,noBadge:!1,tag:!1},i.contextOrFrameLookup(t,n,"options")),n.set("options",c,!0),n.topLevel&&t.setVariable("options",c),n.topLevel&&t.addExport("options",c),g+="\n\n    ",a=22,o=25,h=i.callWrap(i.contextOrFrameLookup(t,n,"url"),"url",t,["users:profile_summary",i.makeKeywordArgs({username:i.memberLookup(s,"username")})]),n.set("profileUrl",h,!0),n.topLevel&&t.setVariable("profileUrl",h),n.topLevel&&t.addExport("profileUrl",h),g+='\n\n    <div class="user-name ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"noLink")&&(g+="--no-link"),g+=" ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"noBadge")&&(g+="--no-badge-link"),g+='">\n        <a class="user-name__link" href="',g+=i.suppressValue(i.contextOrFrameLookup(t,n,"profileUrl"),e.opts.autoescape),g+='" title="',g+=i.suppressValue(i.memberLookup(s,"displayName"),e.opts.autoescape),g+='" ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"target")&&(g+=' target="',g+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"target"),e.opts.autoescape),g+='"'),g+='>\n            <data itemprop="url" value="',g+=i.suppressValue(i.contextOrFrameLookup(t,n,"profileUrl"),e.opts.autoescape),g+='"></data>\n            ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"withAvatar")&&(g+="\n            <span ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"withSummary")&&(g+='data-action="show-user-summary"\n                data-user="',g+=i.suppressValue(i.memberLookup(s,"uid"),e.opts.autoescape),g+='"'),g+=">\n                ",g+=i.suppressValue((a=32,o=33,i.callWrap(i.contextOrFrameLookup(t,n,"user_name_avatar"),"user_name_avatar",t,[s,i.contextOrFrameLookup(t,n,"options")])),e.opts.autoescape),g+="\n            </span>\n            "),g+='\n\n            <div class="text">\n                ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"by")&&(g+="by"),g+="\n                ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"isProfilePage")&&!i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"isProfileCollection")?(g+='\n                    <h1\n                        class="username-wrapper"\n                        itemprop="name">\n                        ',g+=i.suppressValue(i.memberLookup(s,"displayName"),e.opts.autoescape),g+="\n                    </h1>\n                "):(g+='\n                    <div\n                        class="username-wrapper"\n                        itemprop="name">\n                        ',g+=i.suppressValue(i.memberLookup(s,"displayName"),e.opts.autoescape),g+="\n                        ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tag")&&(g+='\n                            <div class="user-name__tag">@',g+=i.suppressValue(i.memberLookup(s,"username"),e.opts.autoescape),g+="</div>\n                        "),g+="\n                    </div>\n                "),g+="\n            </div>\n        </a>\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"withoutBadge")||!i.memberLookup(s,"planDetail")&&"basic"==i.memberLookup(s,"account")||(g+="\n            ",i.memberLookup(s,"planDetail")&&(g+="\n                ","staff"==i.memberLookup(i.memberLookup(s,"planDetail"),"badge")?(g+="\n                    ",a=59,o=40,d=i.callWrap(i.contextOrFrameLookup(t,n,"url"),"url",t,["pages:careers"])+"#team",n.set("badgeLink",d,!0),n.topLevel&&t.setVariable("badgeLink",d),n.topLevel&&t.addExport("badgeLink",d),g+="\n                "):"master"==i.memberLookup(i.memberLookup(s,"planDetail"),"badge")&&(g+="\n                    ",f="https://forum.sketchfab.com/g/Sketchfab-Masters?utm_source=website&utm_campaign=master-badge",n.set("badgeLink",f,!0),n.topLevel&&t.setVariable("badgeLink",f),n.topLevel&&t.addExport("badgeLink",f),g+="\n                "),g+="\n            "),g+="\n            ",i.contextOrFrameLookup(t,n,"badgeLink")||(g+="\n                ",a=65,o=36,p=i.callWrap(i.contextOrFrameLookup(t,n,"url"),"url",t,["pages:plans"])+"?ref=plan-badge",n.set("badgeLink",p,!0),n.topLevel&&t.setVariable("badgeLink",p),n.topLevel&&t.addExport("badgeLink",p),g+="\n            "),g+='\n            <a class="user-name__flag" href="',g+=i.suppressValue(i.contextOrFrameLookup(t,n,"badgeLink"),e.opts.autoescape),g+='" target="_blank">\n                ',i.memberLookup(s,"planDetail")?(g+='\n                    <span class="flag --',g+=i.suppressValue(i.memberLookup(i.memberLookup(s,"planDetail"),"badge"),e.opts.autoescape),g+='">',g+=i.suppressValue(i.memberLookup(i.memberLookup(s,"planDetail"),"title"),e.opts.autoescape),g+="</span>\n                "):"basic"!=i.memberLookup(s,"account")&&(g+='\n                    <span class="flag --',g+=i.suppressValue(i.memberLookup(s,"account"),e.opts.autoescape),g+='">',g+=i.suppressValue(e.getFilter("badge_label").call(t,i.memberLookup(s,"account")),e.opts.autoescape),g+="</span>\n                "),g+="\n            </a>\n        "),g+="\n    </div>",n=l,new i.SafeString(g)});t.addExport("user_name"),t.setVariable("user_name",d),s+="\n\n";var f=i.makeMacro(["users"],["options"],function(r,s){var u=n;n=new i.Frame,(s=s||{}).hasOwnProperty("caller")&&n.set("caller",s.caller),n.set("users",r),n.set("options",s.hasOwnProperty("options")?s.options:{});var l,c,h="";h+="\n    ",l=e.getFilter("merge").call(t,{maxDisplayed:3,avatarWidth:18,avatarHeight:18},i.contextOrFrameLookup(t,n,"options")),n.set("options",l,!0),n.topLevel&&t.setVariable("options",l),n.topLevel&&t.addExport("options",l),h+="\n    ",c=e.getFilter("first_n").call(t,r,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"maxDisplayed")),n.set("shortList",c,!0),n.topLevel&&t.setVariable("shortList",c),n.topLevel&&t.addExport("shortList",c),h+='\n    <div class="inline-avatars">\n        ',n=n.push();var d=i.contextOrFrameLookup(t,n,"shortList");if(d)for(var f=d.length,p=0;p<d.length;p++){var g=d[p];n.set("user",g),n.set("loop.index",p+1),n.set("loop.index0",p),n.set("loop.revindex",f-p),n.set("loop.revindex0",f-p-1),n.set("loop.first",0===p),n.set("loop.last",p===f-1),n.set("loop.length",f),h+='\n            <a\n                href="',h+=i.suppressValue(i.memberLookup(g,"profileUrl"),e.opts.autoescape),h+='"',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"target")&&(h+=' target="',h+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"target"),e.opts.autoescape),h+='" '),h+='data-action="show-user-summary"\n                data-user="',h+=i.suppressValue(i.memberLookup(g,"uid"),e.opts.autoescape),h+='">\n                ',h+=i.suppressValue((a=93,o=36,i.callWrap(i.contextOrFrameLookup(t,n,"user_name_avatar"),"user_name_avatar",t,[g,i.contextOrFrameLookup(t,n,"options")])),e.opts.autoescape),h+="\n            </a>\n        "}return n=n.pop(),h+="\n    </div>\n",n=u,new i.SafeString(h)});t.addExport("user_inline_avatars"),t.setVariable("user_inline_avatars",f),s+="\n\n";var p=i.makeMacro(["authUser","list"],["options"],function(r,s,u){var l=n;n=new i.Frame,(u=u||{}).hasOwnProperty("caller")&&n.set("caller",u.caller),n.set("authUser",r),n.set("list",s),n.set("options",u.hasOwnProperty("options")?u.options:{});var c,h,d,f,p="";c=e.getFilter("merge").call(t,{maxDisplayed:3,othersHref:""},i.contextOrFrameLookup(t,n,"options")),n.set("options",c,!0),n.topLevel&&t.setVariable("options",c),n.topLevel&&t.addExport("options",c),p+="\n    ",h=e.getFilter("first_n").call(t,s,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"maxDisplayed")),n.set("shortList",h,!0),n.topLevel&&t.setVariable("shortList",h),n.topLevel&&t.addExport("shortList",h),p+="\n    ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"totalCount")?(p+="\n        ",d=i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"totalCount")-i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"maxDisplayed"),n.set("otherCount",d,!0),n.topLevel&&t.setVariable("otherCount",d),n.topLevel&&t.addExport("otherCount",d),p+="\n    "):(p+="\n        ",f=e.getFilter("length").call(t,s)-e.getFilter("length").call(t,i.contextOrFrameLookup(t,n,"shortList")),n.set("otherCount",f,!0),n.topLevel&&t.setVariable("otherCount",f),n.topLevel&&t.addExport("otherCount",f),p+="\n    "),p+="\n\n    ",n=n.push();var g=i.contextOrFrameLookup(t,n,"shortList");if(g)for(var m=g.length,v=0;v<g.length;v++){var _=g[v];n.set("user",_),n.set("loop.index",v+1),n.set("loop.index0",v),n.set("loop.revindex",m-v),n.set("loop.revindex0",m-v-1),n.set("loop.first",0===v),n.set("loop.last",v===m-1),n.set("loop.length",m),i.memberLookup(i.contextOrFrameLookup(t,n,"loop"),"first")||(i.memberLookup(i.contextOrFrameLookup(t,n,"loop"),"last")&&i.contextOrFrameLookup(t,n,"otherCount")<1?p+="<span> and </span>":p+="<span>, </span>"),p+=i.suppressValue((a=120,o=18,i.callWrap(i.contextOrFrameLookup(t,n,"user_name"),"user_name",t,[r,_,{withoutBadge:!0}])),e.opts.autoescape)}return n=n.pop(),i.contextOrFrameLookup(t,n,"otherCount")>0&&(p+="<span> and </span>\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"othersHref")||i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"otherAction")?(p+='\n        <a\n            class="others ',p+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"otherAction")?"skfb-link":"",e.opts.autoescape),p+='"\n            ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"othersHref")&&(p+=' href="',p+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"othersHref"),e.opts.autoescape),p+='" '),p+="\n            ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"otherAction")&&(p+=' data-action="',p+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"otherAction"),e.opts.autoescape),p+='" '),p+=">",p+=i.suppressValue(i.contextOrFrameLookup(t,n,"otherCount"),e.opts.autoescape),p+=" other",p+=i.suppressValue(e.getFilter("pluralize").call(t,i.contextOrFrameLookup(t,n,"otherCount")),e.opts.autoescape),p+="</a>\n        "):(p+='\n    <span class="others">',p+=i.suppressValue(i.contextOrFrameLookup(t,n,"otherCount"),e.opts.autoescape),p+=" other",p+=i.suppressValue(e.getFilter("pluralize").call(t,i.contextOrFrameLookup(t,n,"otherCount")),e.opts.autoescape),p+="</span>\n        "),p+="\n    "),n=l,new i.SafeString(p)});t.addExport("user_name_list"),t.setVariable("user_name_list",p),s+="\n\n";var g=i.makeMacro(["avatars"],["options"],function(r,a){var o=n;n=new i.Frame,(a=a||{}).hasOwnProperty("caller")&&n.set("caller",a.caller),n.set("avatars",r),n.set("options",a.hasOwnProperty("options")?a.options:{});var s,u="";return u+="\n    ",s=e.getFilter("merge").call(t,{size:32,expand:!1},i.contextOrFrameLookup(t,n,"options")),n.set("options",s,!0),n.topLevel&&t.setVariable("options",s),n.topLevel&&t.addExport("options",s),u+="\n    ",u+=i.suppressValue(e.getFilter("image_container").call(t,r,i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"size"),i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"size"),i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"expand")),e.opts.autoescape),u+="\n",n=o,new i.SafeString(u)});t.addExport("user_avatar"),t.setVariable("user_avatar",g),s+="\n\n";var m=i.makeMacro(["authUser","user"],["options"],function(r,s,u){var l=n;n=new i.Frame,(u=u||{}).hasOwnProperty("caller")&&n.set("caller",u.caller),n.set("authUser",r),n.set("user",s),n.set("options",u.hasOwnProperty("options")?u.options:{});var c="";c+='\n\n    <div class="user">\n        <a href="',c+=i.suppressValue((a=148,o=21,i.callWrap(i.contextOrFrameLookup(t,n,"url"),"url",t,["users:profile_summary",i.makeKeywordArgs({username:i.memberLookup(s,"username")})])),e.opts.autoescape),c+='">\n        ',c+=i.suppressValue((a=149,o=20,i.callWrap(i.contextOrFrameLookup(t,n,"user_avatar"),"user_avatar",t,[i.memberLookup(s,"avatars"),{size:104}])),e.opts.autoescape),c+='\n        </a>\n        <div class="info">\n            <p class="name" title="',c+=i.suppressValue(i.memberLookup(s,"displayName"),e.opts.autoescape),c+='"><a href="',c+=i.suppressValue((a=152,o=68,i.callWrap(i.contextOrFrameLookup(t,n,"url"),"url",t,["users:profile_summary",i.makeKeywordArgs({username:i.memberLookup(s,"username")})])),e.opts.autoescape),c+='">',c+=i.suppressValue(i.memberLookup(s,"displayName"),e.opts.autoescape),c+='</a></p>\n            <p class="tagline" title="',c+=i.suppressValue(i.memberLookup(s,"tagline"),e.opts.autoescape),c+='"><a href="',c+=i.suppressValue((a=153,o=67,i.callWrap(i.contextOrFrameLookup(t,n,"url"),"url",t,["users:profile_summary",i.makeKeywordArgs({username:i.memberLookup(s,"username")})])),e.opts.autoescape),c+='">',c+=i.suppressValue(i.memberLookup(s,"tagline"),e.opts.autoescape),c+="</a></p>\n            ",0!=i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"followButton")&&i.memberLookup(r,"uid")!=i.memberLookup(s,"uid")&&(c+='\n                <div class="follow-wrapper">\n                    ',c+=i.suppressValue((a=156,o=34,i.callWrap(i.contextOrFrameLookup(t,n,"follow_button"),"follow_button",t,[r,s])),e.opts.autoescape),c+='\n                    <p class="follow-count"><a href="',c+=i.suppressValue((a=157,o=57,i.callWrap(i.contextOrFrameLookup(t,n,"url"),"url",t,["users:profile_followers",i.makeKeywordArgs({username:i.memberLookup(s,"username")})])),e.opts.autoescape),c+='"><span>',c+=i.suppressValue(e.getFilter("humanize_number").call(t,i.memberLookup(s,"followerCount")),e.opts.autoescape),c+="</span> followers</a></p>\n                </div>\n            "),c+='\n        </div>\n    </div>\n    <div class="models">',n=n.push();var h=e.getFilter("first_n").call(t,i.memberLookup(s,"thumbnails"),3);if(h)for(var d=h.length,f=0;f<h.length;f++){var p=h[f];n.set("thumb",p),n.set("loop.index",f+1),n.set("loop.index0",f),n.set("loop.revindex",d-f),n.set("loop.revindex0",d-f-1),n.set("loop.first",0===f),n.set("loop.last",f===d-1),n.set("loop.length",d),c+='\n            <a data-route href="',c+=i.suppressValue(i.memberLookup(p,"viewerUrl"),e.opts.autoescape),c+='">\n                ',c+=i.suppressValue(e.getFilter("image_container").call(t,i.memberLookup(p,"thumbnail"),133,88,!1),e.opts.autoescape),c+="\n            </a>\n        "}return n=n.pop(),c+='\n    </div>\n    <div class="stats">\n        <p class="model-count">',c+=i.suppressValue(e.getFilter("humanize_number").call(t,i.memberLookup(s,"modelCount")),e.opts.autoescape),c+=" model",c+=i.suppressValue(e.getFilter("pluralize").call(t,i.memberLookup(s,"modelCount")),e.opts.autoescape),c+='</p>\n        <p class="view-count">',c+=i.suppressValue(e.getFilter("humanize_number").call(t,i.memberLookup(i.memberLookup(s,"stats"),"publicViewCount")),e.opts.autoescape),c+=" view",c+=i.suppressValue(e.getFilter("pluralize").call(t,i.memberLookup(i.memberLookup(s,"stats"),"publicViewCount")),e.opts.autoescape),c+='</p>\n        <p class="like-count">',c+=i.suppressValue(e.getFilter("humanize_number").call(t,i.memberLookup(i.memberLookup(s,"stats"),"modelLikeCount")),e.opts.autoescape),c+=" like",c+=i.suppressValue(e.getFilter("pluralize").call(t,i.memberLookup(i.memberLookup(s,"stats"),"modelLikeCount")),e.opts.autoescape),c+="</p>\n    </div>\n\n",n=l,new i.SafeString(c)});t.addExport("user_summary"),t.setVariable("user_summary",m),s+="\n\n";var v=i.makeMacro(["authUser","followSuggestion","cloaked"],["options"],function(r,s,u,l){var c=n;n=new i.Frame,(l=l||{}).hasOwnProperty("caller")&&n.set("caller",l.caller),n.set("authUser",r),n.set("followSuggestion",s),n.set("cloaked",u),n.set("options",l.hasOwnProperty("options")?l.options:{});var h="";return h+="\n\n\n    ",h+=i.suppressValue(e.getFilter("image_container").call(t,i.memberLookup(s,"avatars"),64,64),e.opts.autoescape),h+='\n\n    <div class="info">\n        <p class="name">',h+=i.suppressValue(i.memberLookup(s,"displayName"),e.opts.autoescape),h+='</p>\n        <p class="stats">',h+=i.suppressValue(e.getFilter("humanize_number").call(t,i.memberLookup(s,"followerCount")),e.opts.autoescape),h+=" follower",h+=i.suppressValue(e.getFilter("pluralize").call(t,i.memberLookup(s,"followerCount")),e.opts.autoescape),h+=", ",h+=i.suppressValue(e.getFilter("humanize_number").call(t,i.memberLookup(s,"modelCount")),e.opts.autoescape),h+=" model",h+=i.suppressValue(e.getFilter("pluralize").call(t,i.memberLookup(s,"modelCount")),e.opts.autoescape),h+=" </p>\n    </div>\n\n    ",i.memberLookup(r,"uid")!=i.memberLookup(s,"uid")&&(h+="\n        ",h+=i.suppressValue((a=188,o=22,i.callWrap(i.contextOrFrameLookup(t,n,"follow_button"),"follow_button",t,[r,s])),e.opts.autoescape),h+="\n    "),h+="\n\n",n=c,new i.SafeString(h)});t.addExport("follow_suggestion_large"),t.setVariable("follow_suggestion_large",v),s+="\n\n";var _=i.makeMacro(["authUser","user","cloaked"],["options"],function(r,s,u,l){var c=n;n=new i.Frame,(l=l||{}).hasOwnProperty("caller")&&n.set("caller",l.caller),n.set("authUser",r),n.set("user",s),n.set("cloaked",u),n.set("options",l.hasOwnProperty("options")?l.options:{});var h="";return h+='\n\n    <span\n        class="avatar-container"\n        data-action="show-user-summary"\n        data-user="',h+=i.suppressValue(i.memberLookup(s,"uid"),e.opts.autoescape),h+='">\n        ',h+=i.suppressValue(e.getFilter("image_container").call(t,i.memberLookup(s,"avatars"),64,64),e.opts.autoescape),h+='\n    </span>\n\n    <div class="info">\n        <p\n            class="name"\n            data-action="show-user-summary"\n            data-user="',h+=i.suppressValue(i.memberLookup(s,"uid"),e.opts.autoescape),h+='"\n            data-user-summary-anchor-class=".avatar-container[data-user=\'',h+=i.suppressValue(i.memberLookup(s,"uid"),e.opts.autoescape),h+="']\">\n            ",h+=i.suppressValue(i.memberLookup(s,"displayName"),e.opts.autoescape),h+='\n        </p>\n        <p class="stats">',h+=i.suppressValue(e.getFilter("humanize_number").call(t,i.memberLookup(s,"followerCount")),e.opts.autoescape),h+=" follower",h+=i.suppressValue(e.getFilter("pluralize").call(t,i.memberLookup(s,"followerCount")),e.opts.autoescape),h+=", ",h+=i.suppressValue(e.getFilter("humanize_number").call(t,i.memberLookup(s,"modelCount")),e.opts.autoescape),h+=" model",h+=i.suppressValue(e.getFilter("pluralize").call(t,i.memberLookup(s,"modelCount")),e.opts.autoescape),h+=" </p>\n    </div>\n\n    ",i.memberLookup(r,"uid")!=i.memberLookup(s,"uid")&&(h+="\n        ",h+=i.suppressValue((a=214,o=22,i.callWrap(i.contextOrFrameLookup(t,n,"follow_button"),"follow_button",t,[r,s])),e.opts.autoescape),h+="\n    "),h+='\n\n    <div class="reason">\n        <p>',h+=i.suppressValue(e.getFilter("print_suggestion_verb").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"followSuggestion"),"verb"),i.memberLookup(i.contextOrFrameLookup(t,n,"followSuggestion"),"user")),e.opts.autoescape),h+=" ",h+=i.suppressValue(e.getFilter("print_suggestion_target").call(t,i.memberLookup(i.contextOrFrameLookup(t,n,"followSuggestion"),"target"),i.memberLookup(i.contextOrFrameLookup(t,n,"followSuggestion"),"verb")),e.opts.autoescape),h+="</p>\n    </div>\n\n",n=c,new i.SafeString(h)});t.addExport("follow_suggestion_reason"),t.setVariable("follow_suggestion_reason",_),s+="\n\n";var b=i.makeMacro(["authUser","followSuggestion","cloaked"],["options"],function(r,s,u,l){var c=n;n=new i.Frame,(l=l||{}).hasOwnProperty("caller")&&n.set("caller",l.caller),n.set("authUser",r),n.set("followSuggestion",s),n.set("cloaked",u),n.set("options",l.hasOwnProperty("options")?l.options:{});var h="";return h+='\n\n    <li class="follow-item',u&&(h+=" cloaked"),h+='" data-user="',h+=i.suppressValue(i.memberLookup(s,"uid"),e.opts.autoescape),h+='">\n\n        ',h+=i.suppressValue((a=227,o=18,i.callWrap(i.contextOrFrameLookup(t,n,"user_name"),"user_name",t,[r,s,i.makeKeywordArgs({options:{withAvatar:!0,withSummary:i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"withSummary"),avatarHeight:32,avatarWidth:32}})])),e.opts.autoescape),h+="\n\n        ",i.memberLookup(r,"uid")!=i.memberLookup(s,"uid")&&(h+="\n\n            ",h+=i.suppressValue((a=236,o=26,i.callWrap(i.contextOrFrameLookup(t,n,"follow_button"),"follow_button",t,[i.contextOrFrameLookup(t,n,"user"),s])),e.opts.autoescape),h+="\n\n        "),h+="\n\n    </li>\n\n",n=c,new i.SafeString(h)});t.addExport("follow_suggestion"),t.setVariable("follow_suggestion",b),s+="\n\n";var S=i.makeMacro(["authUser","followSuggestions"],["options"],function(r,s,u){var l=n;n=new i.Frame,(u=u||{}).hasOwnProperty("caller")&&n.set("caller",u.caller),n.set("authUser",r),n.set("followSuggestions",s),n.set("options",u.hasOwnProperty("options")?u.options:{});var c,h,d,f="";f+='\n\n    <div class="sidebar-box suggested-follow',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"container_class")&&(f+=" ",f+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"container_class"),e.opts.autoescape)),f+='">\n        <h5 class="sidebar-title">',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"title")?f+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"title"),e.opts.autoescape):f+="Who to follow ",f+="</h5>\n        <ul>\n\n            ",c=e.getFilter("length").call(t,s),n.set("suggestionsCount",c,!0),n.topLevel&&t.setVariable("suggestionsCount",c),n.topLevel&&t.addExport("suggestionsCount",c),f+="\n\n            ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"maxSuggestions")?(f+="\n                ",h=i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"maxSuggestions"),n.set("max",h,!0),n.topLevel&&t.setVariable("max",h),n.topLevel&&t.addExport("max",h),f+="\n            "):(f+="\n                ",d=i.contextOrFrameLookup(t,n,"suggestionsCount"),n.set("max",d,!0),n.topLevel&&t.setVariable("max",d),n.topLevel&&t.addExport("max",d),f+="\n            "),f+="\n\n            ",n=n.push();var p=s;if(p)for(var g=p.length,m=0;m<p.length;m++){var v=p[m];n.set("following",v),n.set("loop.index",m+1),n.set("loop.index0",m),n.set("loop.revindex",g-m),n.set("loop.revindex0",g-m-1),n.set("loop.first",0===m),n.set("loop.last",m===g-1),n.set("loop.length",g),f+="\n\n                ",f+=i.suppressValue((a=260,o=34,i.callWrap(i.contextOrFrameLookup(t,n,"follow_suggestion"),"follow_suggestion",t,[r,v,i.memberLookup(i.contextOrFrameLookup(t,n,"loop"),"index")>i.contextOrFrameLookup(t,n,"max"),i.contextOrFrameLookup(t,n,"options")])),e.opts.autoescape),f+="\n\n            "}return n=n.pop(),f+="\n        </ul>\n\n    </div>\n\n",n=l,new i.SafeString(f)});t.addExport("follow_suggestions"),t.setVariable("follow_suggestions",S),s+="\n\n";var y=i.makeMacro(["profileUser","followX"],["options"],function(r,a,o){var s=n;n=new i.Frame,(o=o||{}).hasOwnProperty("caller")&&n.set("caller",o.caller),n.set("profileUser",r),n.set("followX",a),n.set("options",o.hasOwnProperty("options")?o.options:{});var u,l,c,h,d,f,p,g="";return g+="\n\n    ",("follower"==a||"following"==a)&&(g+="\n\n        ",u=i.memberLookup(r,"displayName")+"(@"+i.memberLookup(r,"username")+")",n.set("messageEnding",u,!0),n.topLevel&&t.setVariable("messageEnding",u),n.topLevel&&t.addExport("messageEnding",u),g+="\n        ",l=i.memberLookup(r,a+"Count"),n.set("number",l,!0),n.topLevel&&t.setVariable("number",l),n.topLevel&&t.addExport("number",l),g+="\n        ",c=i.memberLookup(r,a+"sUrl"),n.set("url",c,!0),n.topLevel&&t.setVariable("url",c),n.topLevel&&t.addExport("url",c),g+="\n\n        ","follower"==a?(g+="\n            ",1==i.contextOrFrameLookup(t,n,"number")?(g+="\n                ",h={message:"1 person is following "+i.contextOrFrameLookup(t,n,"messageEnding")},n.set("options",h,!0),n.topLevel&&t.setVariable("options",h),n.topLevel&&t.addExport("options",h),g+="\n            "):(g+="\n                ",d={message:e.getFilter("string").call(t,e.getFilter("comma_formatted_number").call(t,i.contextOrFrameLookup(t,n,"number")))+" people are following "+i.contextOrFrameLookup(t,n,"messageEnding")},n.set("options",d,!0),n.topLevel&&t.setVariable("options",d),n.topLevel&&t.addExport("options",d),g+="\n            "),g+="\n        "):(g+="\n            ",1==i.contextOrFrameLookup(t,n,"number")?(g+="\n                ",f={message:"1 person is followed by "+i.contextOrFrameLookup(t,n,"messageEnding")},n.set("options",f,!0),n.topLevel&&t.setVariable("options",f),n.topLevel&&t.addExport("options",f),g+="\n            "):(g+="\n                ",p={message:e.getFilter("string").call(t,e.getFilter("comma_formatted_number").call(t,i.contextOrFrameLookup(t,n,"number")))+" people are followed by "+i.contextOrFrameLookup(t,n,"messageEnding")},n.set("options",p,!0),n.topLevel&&t.setVariable("options",p),n.topLevel&&t.addExport("options",p),g+="\n            "),g+="\n        "),g+='\n\n        <a class="',g+=i.suppressValue(a,e.opts.autoescape),g+='-count" href="',g+=i.suppressValue(i.contextOrFrameLookup(t,n,"url"),e.opts.autoescape),g+='" title="',g+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"message"),e.opts.autoescape),g+='">\n            <span class="count">',g+=i.suppressValue(e.getFilter("humanize_number").call(t,i.contextOrFrameLookup(t,n,"number")),e.opts.autoescape),g+="</span> ",g+=i.suppressValue(e.getFilter("capitalize").call(t,a),e.opts.autoescape),g+=i.suppressValue(e.getFilter("pluralize").call(t,i.contextOrFrameLookup(t,n,"number")),e.opts.autoescape),g+="\n        </a>\n\n    "),g+="\n\n",n=s,new i.SafeString(g)});t.addExport("follower_or_following_count"),t.setVariable("follower_or_following_count",y),r(null,s+="\n")}else r(new Error("cannot import 'follow_button'"))})})}catch(e){r(i.handleError(e,a,o))}}}},pBOM:function(e,t){e.exports="uniform vec3 uBoneColor;\n\nvarying vec3 vViewNormal;\n\nvoid main(void) {\n    vec3 boneColor = uBoneColor * 0.95; // slightingly darker than influence color\n    vec3 boneLinkColor = vec3(max(0.25, abs(dot(normalize(vViewNormal), vec3(0.15, 0.3, 0.9)))));\n    gl_FragColor = vec4(uBoneColor.r < 0.0 ? boneLinkColor : boneColor, 1.0);\n}\n"},"pJ/q":function(e,t){e.exports='varying vec2 vTexCoord0;\n\nuniform sampler2D uTextureTeleportCircle;\nuniform float uScale;\nuniform float uAlpha;\nuniform int uOutputLinear;\n\n#pragma include "utils/functions.glsl"\n\nvoid main(void) {\n  vec3 tex = sRGBToLinear(texture2D(uTextureTeleportCircle, vTexCoord0).rgb);\n  vec4 color = uScale == 1.0 ? vec4(tex.rrr, 1.0) * uAlpha * tex.g : vec4(uAlpha * tex.b);\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n}\n'},par7:function(e,t,n){"use strict";var i,r,a,o,s=n("QLQS"),u=n("gRsq"),l=n("R+tb"),c=n("9oTK"),h=n.n(c),d=n("UpON"),f=n("fgaA"),p=s.a.osg,g={},m=-1,v=0,_=!1,b=40,S=p.Timer.instance().tick(),y=!1,x=!1,C=Object(l.a)(),w=function(){(window.setTimeout(w,b),i&&r)&&(y||g.isDrawAlreadyQueued()||(Object(l.b)()&&!d.a.getHighResBound().isFulfilled()&&o(),p.Timer.instance().tick()-S-b<=b||(r.enable(),m=-1)))};Object(u.a)()||window.setTimeout(w,b),o=function(){a||(a=new h.a(function(e){e()}).finally(function(){i.requestRedraw(),i.frame(),a=void 0}))};var T=function(e){if(i&&!y){if(Object(l.b)())return o(),void(x=!0);x=!1;var t=g.isDrawAlreadyQueued();if(t||i.requestRedraw(),r&&!e&&(r.reset(),!t)){var n=p.Timer.instance().tick();v+=n-S,0===++m?(m=0,v=0):4===m&&(b=Math.min(200,Math.max(16,v/m)),m=0,v=0),S=n}}};g.setPoseForScreenshot=function(e){y=e},g.isDrawAlreadyQueued=function(){return i._requestRedraw},g.draw=function(){T()},g.drawNoJitter=function(){this._doJitter=!1,T()},g.drawSameFrame=function(){T(!0)},g.redrawShadow=function(){_=!0,T()},g.redrawShadowNextFrame=function(){window.setTimeout(g.redrawShadow,0)},g.getShadowForcedUpdate=function(){return _},g.setShadowForcedUpdate=function(e){_=e},g.setViewer=function(e){i=e},g.setSuperSample=function(e){r=e},g.getSuperSample=function(){return r},g.getFrameTimeAverage=function(){return b},g.requestDrawHiddenDefered=function(){o()};var M=0,E=0;g.requestTextureBudget=function(e){if(!d.a.getModelDisplayed().isResolved())return!0;if(!i)return!0;var t=i.getFrameStamp().getFrameNumber();if(E<t&&(E=t,M=0),(M+=e)===e)return!0;var n=Object(f.a)().textureFrameBudget;return M<=n*n},C&&document.addEventListener(C,function(){x&&T()}),t.a=g},pg5E:function(e,t){e.exports='#pragma include "utils/checkerboard.glsl"\n\n// blur jimenez\n// https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L454\n\n// blur UE4 (based on jimenez)\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/SeparableSSS.usf\n\n// UE 4 pre/post passes (down/upsample/checkerboard)\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/PostProcessSubsurface.usf\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Common.usf#L501\n// also solution 2 of http://stackoverflow.com/questions/596216/formula-to-determine-brightness-of-rgb-color\nfloat luminanceLinear(const in vec3 color) {\n    return dot(color, vec3(0.3, 0.59, 0.11));\n}\n\n// https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/PostProcessSubsurface.usf#L247\nvoid uncheckerboard(out vec3 diffuse, out vec3 specular) {\n    vec2 coordCenter = floor(gTexCoord * uTextureSSSColorSize) + 0.5;\n    vec2 uvCenter = coordCenter / uTextureSSSColorSize;\n\n    vec3 offset = vec3(1.0 / uTextureSSSColorSize.xy, 0.0);\n    vec3 A = TEXTURE_2D_TextureSSSColor(uvCenter + offset.xz).rgb;\n    vec3 B = TEXTURE_2D_TextureSSSColor(uvCenter - offset.xz).rgb;\n    vec3 C = TEXTURE_2D_TextureSSSColor(uvCenter + offset.zy).rgb;\n    vec3 D = TEXTURE_2D_TextureSSSColor(uvCenter - offset.zy).rgb;\n\n    // Luminance could be green channel only\n    float a = luminanceLinear(A);\n    float b = luminanceLinear(B);\n    float c = luminanceLinear(C);\n    float d = luminanceLinear(D);\n\n    float ab = abs(a - b);\n    float cd = abs(c - d);\n\n    // take the average in the direction that avoids dither pattern\n    vec3 quant1 = 0.5 * mix(A + B, C + D, ab > cd ? 1.0 : 0.0);\n    vec3 quant0 = TEXTURE_2D_TextureSSSColor(uvCenter).rgb;\n\n    float checker = checkerboard(coordCenter, uHalton);\n    diffuse = mix(quant1, quant0, checker);\n    specular = mix(quant0, quant1, checker);\n}\n'},prpr:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("hbEN");function r(e,t,n){var r=[],a=Object(i.a)(function(){var e=r.slice();r=[],n.trigger(t,e)},20),o=function(e){r.push(e),a()};return n.on(e,o),function(){n.off(e,o)}}},pts4:function(e,t){e.exports="attribute vec3 Vertex;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec4 uHalton;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\n\nvarying vec3 vLocalVertex;\n\nvoid main(void)\n{\n    vLocalVertex = Vertex.rgb;\n\n    mat4 projectionMatrix = uProjectionMatrix;\n    vec2 halt = uGlobalTexRatio.xy * uHalton.xy / uGlobalTexSize.xy;\n    projectionMatrix[2][0] += halt.x;\n    projectionMatrix[2][1] += halt.y;\n\n    gl_Position = (projectionMatrix * (uModelViewMatrix * vec4(Vertex, 1.0))).xyww;\n}\n"},"q+nQ":function(e,t){e.exports='#pragma include "utils/decodeDepth.glsl"\n\nconst float MAX_BLUR = 16.0;\nconst float EPS_EARLY_OUT = 0.01; // early out (typically when we move the camera fast and the dof might be not effective)\n\nfloat texDepthToCoC(const in vec4 fetch) {\n    // background should be always max blurred so that the near blur can expand onto the background (because of special dilate background codepath below)\n    if(fetch.x == 1.0) return max(uDofBlurNearFarFocal.x, uDofBlurNearFarFocal.y);\n\n    float coc = decodeDepth(fetch);\n    coc = clamp((coc - uDofBlurNearFarFocal.z) / coc, -1.0, 1.0);\n    return (coc < 0.0 ? coc * uDofBlurNearFarFocal.x : coc * uDofBlurNearFarFocal.y);\n}'},qCPs:function(e,t,n){"use strict";(function(e){var i=n("MVZn"),r=n.n(i),a=n("lSNA"),o=n.n(a),s=n("Bw5p"),u=n("5cdn"),l=n("dqY5"),c=n("dZz+"),h=n("eEbW"),d=n("/0FW"),f=n("M4AY"),p=n("tNdj"),g=n("DWw0"),m=n("QKgc");t.a=p.a.extend({mixins:[Object(u.a)("model"),Object(l.a)(function(e,t){return t.options.preventGlobalState?{}:Object(s.a)(f.c.entities.model(t.get("uid"),e),["name","description","htmlDescription","visibility","tags","categories","likeCount","isRestricted"])||{}})],defaults:{collections:{}},initialize:function(){p.a.prototype.initialize.apply(this,arguments),this.maxFailCount=5},endpoint:function(){return"/models".concat(this.isNew()?"":"/".concat(this.get("uid")))},reuploadUrl:function(){return this.url()+"/versions"},like:function(){return f.b.store.dispatch(f.a.authUser.likeModel(this.get("uid")))},unlike:function(){return f.b.store.dispatch(f.a.authUser.unlikeModel(this.get("uid")))},toggleLike:function(){return f.b.store.dispatch(f.a.authUser.toggleLikeModel(this.get("uid")))},hit:function(){var t=c.a.me();try{var n=window.parent?window.parent.location.pathname:window.location.pathname;if(/^\/orgs\/\w*\/.*/.test(n))return e.resolve()}catch(e){}if(t.isAuthenticated()){var i=this.get("user")&&t.get("uid")===this.get("user").uid,r=t.get("isStaff");if(i||r)return e.resolve()}return this.get("isPublished")?h.b.viewModel(this.get("uid")):e.resolve()},isPublished:function(){return(this.get("isPublished")||!!this.get("publishedAt"))&&!this.get("isDeleted")},publish:function(){var e=this;return f.b.store.dispatch(f.a.models.tryPublish(this.get("uid"))).then(function(t){t.caseOf({Left:function(e){throw e},Right:function(){e.set({isPublished:!0,publishedAt:new Date})}})})},sharing:function(){var e=this;return h.b.getModelSharing(this.get("uid")).then(function(t){return e.set("sharing",t),t})},addCollection:function(e,t){this.addCollections(o()({},e,t))},addCollections:function(e){this.set("collections",r()({},this.get("collections"),e))},isInflated:function(){var e=Object.keys(this.attributes);return e.indexOf("description")>-1&&e.indexOf("tags")>-1},isInCollection:function(e){return!!this.get("collections")[e]},isProcessing:function(){var e=this.get("status");return e&&("PROCESSING"===e.processing||"PENDING"===e.processing)},canEdit:function(){var e=c.a.me();return Object(g.d)(e.toJSON(),this.toJSON())},canDownload:function(){var e=c.a.me().toJSON();return Object(g.c)(e.toJSON(),this.toJSON())},getCollections:function(t){var n=this,i=t.filter(function(e){return!(e in n.get("collections"))});return i.length?h.b.getModelCollections(this.get("uid"),i).then(function(e){var t=e.results;return n.addCollections(t),t}):(this.trigger("change:collections"),e.resolve())},getOwnershipStatus:function(e){return h.b.getModelDownload(this.get("uid"),{allowPrefetching:e})},checkStatusAndRetry:function(){var t=this;return d.b.retry(1/0,function(){return h.b.getModelStatus(t.get("uid")).then(function(n){return n?(t.set("status",n),t.set("processingStatus",{PENDING:0,PROCESSING:1,SUCCEEDED:2,FAILED:3}[n.processing.toUpperCase()]),["SUCCEEDED","FAILED"].includes(n.processing.toUpperCase())?n:e.reject(new m.f)):e.reject(new m.f)})},{interval:2e3}).catch(function(){return{processing:"FAILED",error:"The server failed to answer in time"}})},getRatings:function(){return h.b.getModelRatings(this.get("uid"))}})}).call(this,n("CSL1"))},qRO0:function(e,t,n){"use strict";var i=function(){this._name=void 0,this._userdata=void 0,this._instanceID=i.getInstanceID()};n("a3nb").a.createPrototypeObject(i,{cloneType:function(){return new(0,this.constructor)},getInstanceID:function(){return this._instanceID},setName:function(e){this._name=e},getName:function(){return this._name},setUserData:function(e){this._userdata=e},getUserData:function(){return this._userdata}},"osg","Object");var r=0;i.getInstanceID=function(){return r+=1},t.a=i},qk7X:function(e,t,n){window.glStats=function(){var e=null,t=0,n=0,i=0,r=0,a=0,o=0,s=0;function u(e,t){return function(){t.apply(this,arguments),e.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=u(WebGLRenderingContext.prototype.drawArrays,function(){t++,arguments[0]==this.POINTS?o+=arguments[2]:a+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=u(WebGLRenderingContext.prototype.drawElements,function(){n++,r+=arguments[1]/3,a+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=u(WebGLRenderingContext.prototype.useProgram,function(){i++}),WebGLRenderingContext.prototype.bindTexture=u(WebGLRenderingContext.prototype.bindTexture,function(){s++});return{update:function(){e("allcalls").set(t+n),e("drawElements").set(n),e("drawArrays").set(t),e("bindTexture").set(s),e("useProgram").set(i),e("glfaces").set(r),e("glvertices").set(a),e("glpoints").set(o)},start:function(){t=0,n=0,i=0,r=0,a=0,o=0,s=0},end:function(){},attach:function(t){e=t},values:{allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},groups:[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],fractions:[{base:"allcalls",steps:["drawelements","drawarrays"]}]}},window.threeStats=function(e){var t=null;return{update:function(){t("renderer.info.memory.geometries").set(e.info.memory.geometries),t("renderer.info.programs").set(e.info.programs.length),t("renderer.info.memory.textures").set(e.info.memory.textures),t("renderer.info.render.calls").set(e.info.render.calls),t("renderer.info.render.faces").set(e.info.render.faces),t("renderer.info.render.points").set(e.info.render.points),t("renderer.info.render.vertices").set(e.info.render.vertices)},start:function(){},end:function(){},attach:function(e){t=e},values:{"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.faces":{caption:"Faces",over:1e3},"renderer.info.render.points":{caption:"Points"},"renderer.info.render.vertices":{caption:"Vertices"}},groups:[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.faces","renderer.info.render.points","renderer.info.render.vertices"]}],fractions:[]}},window.BrowserStats=function(){var e=null,t=0,n=0,i={usedJSHeapSize:0,totalJSHeapSize:0};window.performance&&performance.memory&&(i=performance.memory),0===i.totalJSHeapSize&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var r=Math.log(1024);function a(e){var t=Math.floor(Math.log(e)/r);return Math.round(100*e/Math.pow(1024,t))/100}return{update:function(){t=a(i.usedJSHeapSize),n=a(i.totalJSHeapSize),e("memory").set(t),e("total").set(n)},start:function(){t=0},end:function(){},attach:function(t){e=t},values:{memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},groups:[{caption:"Browser",values:["memory","total"]}],fractions:[{base:"total",steps:["memory"]}]}},e.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},qxX9:function(e,t,n){"use strict";var i=function(e,t,n){this._mode=e,this._first=t,this._arrayLengths=n.slice(0)};i.prototype={draw:function(e){for(var t=e.getGraphicContext(),n=this._mode,i=this._first,r=this._arrayLengths,a=0,o=r.length;a<o;a++){var s=r[a];t.drawArrays(n,i,s),i+=s}},getMode:function(){return this._mode},getNumIndices:function(){for(var e=0,t=this._arrayLengths,n=0,i=t.length;n<i;n++)e+=t[n];return e},getCount:function(){return this.getNumIndices()},getArrayLengths:function(){return this._arrayLengths},getFirst:function(){return this._first},setFirst:function(e){this._first=e}},t.a=i},r28r:function(e,t,n){"use strict";var i=n("yIs4"),r=n("dAuA"),a=function(e,t){return Math.min(e,Math.max(0,parseInt(t)||0))},o=function(){var e={};return{get:function(t){return e[t]},update:function(t){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(n){e[n.uid]=t})}}};t.a=function(e,t){var n=function(){var t=Object(i.a)(e.lastPage)?e.lastPage:0,n=a(t,e.firstPage);return{lastPage:t,currentPageIndex:n,hasPrevious:0!==n}},s=o(),u=n(),l=function(e){return function(t){return s.update(e,t.results),u.currentPageIndex=e,t.previous||(u.hasPrevious=!1),t.next?u.lastPage=1/0:u.lastPage=e,t}};return{type:"offset",loadPrevious:function(e){var n=a(u.lastPage,u.currentPageIndex-1);return t(n,e).then(l(n))},loadNext:function(e){var n=a(u.lastPage,u.currentPageIndex+1);return t(n,e).then(l(n))},loadFirst:function(e){return u=n(),s=o(),t(0,e).then(l(0))},reset:function(){u=n()},hasPrevious:function(){return u.hasPrevious},hasNext:function(){return u.currentPageIndex+1<u.lastPage},isFirst:function(){return 0===u.currentPageIndex},getQueryParamsForElementUid:function(e){return{page:s.get(e)||""}},getQueryParams:function(){return{page:u.currentPageIndex}},setInitialQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r.b)(e.split("?")[1]||"").page}(e);s.update(n,t.results)}}}},r5U0:function(e,t,n){e.exports=n.p+"static/assets/images/editor/Sound-c9d6e5b9ed6c02f1dfaea84e549485c1.png"},r6Wx:function(e,t){e.exports='#ifdef VR_DISTORTION\nuniform vec2 uDistortion;\nuniform vec4 uProjectionLeft;\nuniform vec4 uUnprojectionLeft;\n\n#pragma include "distortion.glsl"\n#endif\n\n#ifdef ASCII_FOOL\n#pragma include "ascii.glsl"\n#endif\n\nuniform sampler2D TextureInput;\n\nvec4 passThrough() {\n#ifdef VR_DISTORTION\n    gTexCoord = distortion(gTexCoord);\n#endif\n\n#ifdef ASCII_FOOL\n    return ascii(gTexCoord.xy);\n#else\n    return TEXTURE_2D_TextureInput(gTexCoord);\n#endif\n}\n'},"r7P/":function(e,t,n){"use strict";var i=function(e){this.traversalMask=-1,this.nodeMaskOverride=0,this.traversalMode=e,void 0===e&&(this.traversalMode=i.TRAVERSE_ALL_CHILDREN),this.nodePath=[],this.visitorType=i.NODE_VISITOR,this._databaseRequestHandler=void 0,this._frameStamp=void 0,this.traverse=i._traversalFunctions[this.traversalMode],this.pushOntoNodePath=i._pushOntoNodePath[this.traversalMode],this.popFromNodePath=i._popFromNodePath[this.traversalMode]};i.TRAVERSE_PARENTS=1,i.TRAVERSE_ALL_CHILDREN=2,i.TRAVERSE_ACTIVE_CHILDREN=3,i.NODE_VISITOR=0,i.UPDATE_VISITOR=1,i.CULL_VISITOR=2;var r=function(e){e.traverse(this)};i._traversalFunctions=[void 0,function(e){e.ascend(this)},r,r];var a=function(e){this.nodePath.push(e)};i._pushOntoNodePath=[void 0,function(e){this.nodePath.unshift(e)},a,a];var o=function(){this.nodePath.pop()};i._popFromNodePath=[void 0,function(){return this.nodePath.shift()},o,o],i.prototype={reset:function(){this.nodePath.length=0},setFrameStamp:function(e){this._frameStamp=e},getFrameStamp:function(){return this._frameStamp},setNodeMaskOverride:function(e){this.nodeMaskOverride=e},getNodeMaskOverride:function(){return this.nodeMaskOverride},setTraversalMask:function(e){this.traversalMask=e},getTraversalMask:function(){return this.traversalMask},getNodePath:function(){return this.nodePath},validNodeMask:function(e){var t=e.getNodeMask();return 0!=(this.traversalMask&(this.nodeMaskOverride|t))},apply:function(e){this.traverse(e)},getVisitorType:function(){return this.visitorType},setDatabaseRequestHandler:function(e){this._databaseRequestHandler=e},getDatabaseRequestHandler:function(){return this._databaseRequestHandler}},t.a=i},rC6e:function(e,t,n){"use strict";var i=n("RIqP"),r=n.n(i),a=n("q1tI"),o=n("89mf");t.a=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=Object(a.useRef)(e()),u=function(e){return t(function(t){var i=n(t,e);return s.current=i,i})},l=Object(a.useRef)(u);Object(a.useEffect)(function(){l.current=u});var c=Object(a.useMemo)(function(){var e=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},t={getState:function(){return s.current},dispatch:function(){return e.apply(void 0,arguments)}},n=i.map(function(e){return e(t)});return e=o.b.apply(void 0,r()(n))(function(){return l.current.apply(l,arguments)})},[]);return[e(),c]}},rGsq:function(e,t){e.exports="uniform vec4 uColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vec4( vec3(vColor) * uColor.a, uColor.a);\n}\n"},rMSa:function(e,t,n){n("irww"),(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/buttons.jinja"]={root:function(e,t,n,i,r){var a=null,o=null,s="";try{e.getTemplate("skfb_front/macros/popovers.jinja",!1,"skfb_front/macros/buttons.jinja",!1,function(u,l){u?r(u):l.getExported(function(u,l){if(u)r(u);else if(l.hasOwnProperty("share_popover")){var c=l.share_popover;t.setVariable("share_popover",c),s+="\n\n";var h=i.makeMacro(["authUser","user"],["options"],function(t,r,a){var o=n;n=new i.Frame,(a=a||{}).hasOwnProperty("caller")&&n.set("caller",a.caller),n.set("authUser",t),n.set("user",r),n.set("options",a.hasOwnProperty("options")?a.options:{});var s="";return s+='\n\n    <span class="toggle-button follow-user-button btn-loading" data-action="follow" data-user="',s+=i.suppressValue(i.memberLookup(r,"uid"),e.opts.autoescape),s+='">\n        <a class="button btn-primary toggle btn-disabled btn-small">\n            <i class="icon fa fa-plus"></i>\n            Follow\n        </a>\n        <a class="button btn-important untoggle btn-small">\n            <span class="toggled">\n                Following\n            </span>\n            <span class="untoggled">\n                Unfollow\n            </span>\n        </a>\n    </span>\n\n',n=o,new i.SafeString(s)});t.addExport("follow_button"),t.setVariable("follow_button",h),s+="\n\n";var d=i.makeMacro(["authUser"],["options"],function(r,s){var u=n;n=new i.Frame,(s=s||{}).hasOwnProperty("caller")&&n.set("caller",s.caller),n.set("authUser",r),n.set("options",s.hasOwnProperty("options")?s.options:{});var l="";return l+='\n\n    <div class="button btn-medium btn-primary-inverted btn-loading like like-button popover-container btn-disabled" data-action="like-model">\n        <i class="icon fa fa-star"></i>\n        Like\n        ',i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"popover"),"display")&&(l+="\n            ",l+=i.suppressValue((a=27,o=26,i.callWrap(i.contextOrFrameLookup(t,n,"share_popover"),"share_popover",t,[{class:i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"popover"),"arrow")}])),e.opts.autoescape),l+="\n        "),l+="\n    </div>\n\n",n=u,new i.SafeString(l)});t.addExport("like_button"),t.setVariable("like_button",d),s+="\n\n";var f=i.makeMacro(["authUser"],["options"],function(r,s){var u=n;n=new i.Frame,(s=s||{}).hasOwnProperty("caller")&&n.set("caller",s.caller),n.set("authUser",r),n.set("options",s.hasOwnProperty("options")?s.options:{});var l="";return l+='\n\n    <div class="help like-button star-like-button btn-loading popover-container',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"buttonClass")&&(l+=" ",l+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"buttonClass"),e.opts.autoescape)),l+='" data-action="like-model">\n        ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"count")&&i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"count"),"display")&&(l+='\n            <span class="count">',l+=i.suppressValue(i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"count"),"like"),e.opts.autoescape),l+="</span>\n        "),l+='\n        <span class="tooltip liked-content',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tooltipClass")?(l+=" ",l+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tooltipClass"),e.opts.autoescape)):l+=" tooltip-down",l+='">Like</span>\n        <span class="tooltip unliked-content',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tooltipClass")?(l+=" ",l+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tooltipClass"),e.opts.autoescape)):l+=" tooltip-down",l+='">Unlike</span>\n        ',i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"popover"),"display")&&(l+="\n            ",l+=i.suppressValue((a=42,o=26,i.callWrap(i.contextOrFrameLookup(t,n,"share_popover"),"share_popover",t,[{class:i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"popover"),"arrow")}])),e.opts.autoescape),l+="\n        "),l+="\n    </div>\n\n",n=u,new i.SafeString(l)});t.addExport("star_like_button"),t.setVariable("star_like_button",f),s+="\n\n";var p=i.makeMacro(["model"],["options"],function(r,a){var o=n;n=new i.Frame,(a=a||{}).hasOwnProperty("caller")&&n.set("caller",a.caller),n.set("model",r),n.set("options",a.hasOwnProperty("options")?a.options:{});var s="";return s+='\n\n    <a class="',s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"className"),e.opts.autoescape),s+=' help" ',s+=i.suppressValue(i.memberLookup(r,"isPublished")?"data-route":"",e.opts.autoescape),s+=' itemprop="discussionUrl" href="',s+=i.suppressValue(i.memberLookup(r,"viewerUrl"),e.opts.autoescape),s+='#comments">\n        <span class="count">\n            ',s+=i.suppressValue(e.getFilter("humanize_number").call(t,i.memberLookup(r,"commentCount")),e.opts.autoescape),s+='\n        </span>\n        <span class="tooltip tooltip-up">Comment</span>\n    </a>\n\n',n=o,new i.SafeString(s)});t.addExport("comments_button"),t.setVariable("comments_button",p),s+="\n\n";var g=i.makeMacro(["authUser"],["options"],function(r,s){var u=n;n=new i.Frame,(s=s||{}).hasOwnProperty("caller")&&n.set("caller",s.caller),n.set("authUser",r),n.set("options",s.hasOwnProperty("options")?s.options:{});var l="";return l+='\n\n    <div class="',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"buttonClass")&&(l+=" ",l+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"buttonClass"),e.opts.autoescape),l+=" "),l+=i.suppressValue(e.getFilter("class_names").call(t,{help:!0,"subscribe-button":!0,"count-subscribe-button":!0,"btn-loading":!0,"popover-container":!0,"--disabled":i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"disabled")}),e.opts.autoescape),l+='"\n\n        ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"disabled")||(l+='\n            data-action="subscribe-collection"\n        '),l+=">\n\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"count")&&i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"count"),"display")&&(l+='\n            <span class="count">',l+=i.suppressValue(i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"count"),"subscribe"),e.opts.autoescape),l+="</span>\n        "),l+="\n\n        ",i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"disabled")?(l+='\n            <span class="tooltip subscribed-content',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tooltipClass")?(l+=" ",l+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tooltipClass"),e.opts.autoescape)):l+=" tooltip-down",l+='">Subscribers</span>\n        '):(l+='\n             <span class="tooltip subscribed-content',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tooltipClass")?(l+=" ",l+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tooltipClass"),e.opts.autoescape)):l+=" tooltip-down",l+='">Subscribe</span>\n            <span class="tooltip unsubscribed-content',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tooltipClass")?(l+=" ",l+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"tooltipClass"),e.opts.autoescape)):l+=" tooltip-down",l+='">Unsubscribe</span>\n        '),l+="\n\n        ",i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"popover"),"display")&&(l+="\n            ",l+=i.suppressValue((a=86,o=26,i.callWrap(i.contextOrFrameLookup(t,n,"share_popover"),"share_popover",t,[{class:i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"popover"),"arrow")}])),e.opts.autoescape),l+="\n        "),l+="\n    </div>\n\n",n=u,new i.SafeString(l)});t.addExport("subscribe_button_count"),t.setVariable("subscribe_button_count",g),s+="\n\n";var m=i.makeMacro(["collection"],[],function(t,r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("collection",t);var o="";return o+='\n\n    <span class="toggle-button addto-button" data-action="add-to-collection" data-collection="',o+=i.suppressValue(i.memberLookup(t,"uid"),e.opts.autoescape),o+='">\n        <a class="button btn-small btn-primary toggle">\n            Add\n        </a>\n        <a class="button btn-small btn-important untoggle">\n            <span class="toggled">\n                Added\n            </span>\n            <span class="untoggled">\n                Remove\n            </span>\n        </a>\n    </span>\n\n',n=a,new i.SafeString(o)});t.addExport("add_to_collection_button"),t.setVariable("add_to_collection_button",m),s+="\n\n";var v=i.makeMacro(["collection"],[],function(t,r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("collection",t);var o="";return o+='\n\n    <span class="toggle-button subscribe-collection-button btn-loading" data-action="subscribe-collection" data-collection="',o+=i.suppressValue(i.memberLookup(t,"uid"),e.opts.autoescape),o+='">\n        <div class="subscribe">\n            <a class="button btn-medium btn-primary btn-disabled toggle">\n                <i class="icon fa fa-rss"></i>\n                Subscribe\n            </a>\n            <a class="button btn-medium btn-important untoggle">\n                <i class="icon icon-fixed-left fa fa-rss"></i>\n                <span class="toggled">\n                    Subscribed\n                </span>\n                <span class="untoggled">\n                    Unsubscribe\n                </span>\n            </a>\n        </div>\n    </span>\n\n',n=a,new i.SafeString(o)});t.addExport("subscribe_button"),t.setVariable("subscribe_button",v),s+="\n\n";var _=i.makeMacro([],["options"],function(r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var o,s="";return s+="\n\n    ",o=e.getFilter("merge").call(t,{buttonClass:"btn-primary-inverted"},i.contextOrFrameLookup(t,n,"options")),n.set("options",o,!0),n.topLevel&&t.setVariable("options",o),n.topLevel&&t.addExport("options",o),s+='\n\n\n    <a\n        class="button btn-medium ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"buttonClass")&&(s+=" ",s+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"buttonClass"),e.opts.autoescape)),s+='"\n        data-action="open-collection-popup"\n        data-selenium="open-collection-popup">\n        <div class="add-to">\n            <i class="icon fa fa-plus"></i>\n            Add to\n        </div>\n    </a>\n\n',n=a,new i.SafeString(s)});t.addExport("add_to_open_popup"),t.setVariable("add_to_open_popup",_),s+="\n\n";var b=i.makeMacro([],[],function(e){var t=n;n=new i.Frame,(e=e||{}).hasOwnProperty("caller")&&n.set("caller",e.caller);var r="";return r+='\n\n    <li class="item create-collection">\n        <div class="collection-addcard" data-action="open-create-collection-popup">\n            <div class="thumbnail create-new-collection">\n                <i class="icon fa fa-plus"></i>\n            </div>\n            <div class="js-title">\n                Create new collection\n            </div>\n        </div>\n    </li>\n\n',n=t,new i.SafeString(r)});t.addExport("open_create_collection"),t.setVariable("open_create_collection",b),r(null,s+="\n")}else r(new Error("cannot import 'share_popover'"))})})}catch(e){r(i.handleError(e,a,o))}}}},sbnD:function(e,t,n){"use strict";var i=n("G9Ht"),r=n.n(i),a=n("EVdn"),o=n.n(a),s=n("YfG3"),u=n("gCTM"),l=n("vBtE"),c=n("48vN"),h=n("1lVO"),d=n("dZz+"),f=(n("p7hb"),l.a.extend({mixins:[Object(h.a)()],template:u.default.getFromMacro("skfb_front/macros/user","user_summary"),className:"user-summary hidden",initialize:function(){l.a.prototype.initialize.apply(this,arguments),o()("body").append(this.$el),this.model=new d.a},render:function(){this.$el.html(this.template([d.a.me().toJSON(),this.model.toJSON(),this.userOptions])),!1!==this.userOptions.followButton&&new c.a({el:this.$(".follow-user-button")[0],trackerEvent:"userSummaryFollowButtonClicked",afterFollowAction:this.onUserFollow.bind(this)})},setUser:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.userOptions=n,this.$el.addClass("loading"),this.model.clear().set({uid:e}).getSummary().then(function(){t.render(),t.$el.removeClass("loading")})},onUserFollow:function(e){var t="follow"===e?1:-1,n=this.$(".follow-count span"),i=parseInt(n.text(),10);n.text(i+t)},anchor:function(e){var t=o()(e),n=this.$el.outerWidth(!0),i=o()(window).width(),r=o()(window).height(),a=Object(s.a)(t.offset(),{width:t.width(),height:t.height()}),u="summary-right",l="summary-bottom",c={left:"auto",right:"auto",top:"auto",bottom:"auto"};this.$el.removeClass("summary-left summary-right summary-top summary-bottom"),a.left+n>i&&(u="summary-left"),a.top-window.scrollY+300>r&&(l="summary-top"),"summary-right"===u?c.left=a.left+a.width/2-22:c.right=i-(a.left+a.width/2)-22,"summary-bottom"===l?c.top=a.top+a.height+7:c.bottom=r-(a.top+a.height/2)+22,this.$el.addClass(u+" "+l),this.$el.css(c)},show:function(){this.$el.off("transitionend webkitTransitionEnd"),this.$el.css({display:"block"}),this.$el.width(),this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden"),this.$el.one("transitionend webkitTransitionEnd",function(){this.$el.css({display:"none"})}.bind(this))},isVisible:function(){return!this.$el.hasClass("hidden")}}));t.a={name:"UserSummary",constructor:function(){this.enabled=!r.a.any,this.enabled&&(this.userSummary=new f,this.userSummaryOnBodyClick=this.userSummaryOnBodyClick.bind(this),this.userSummaryOnClick=this.userSummaryOnClick.bind(this),this.userSummaryEnterElement=this.userSummaryEnterElement.bind(this),this.userSummaryLeaveElement=this.userSummaryLeaveElement.bind(this),this.userSummaryEnterUserSummary=this.userSummaryEnterUserSummary.bind(this),this.userSummaryLeaveUserSummary=this.userSummaryLeaveUserSummary.bind(this))},delegateUserSummary:function(){if(this.enabled){var e=o()("body");e.on("click",this.userSummaryOnBodyClick),e.on("click",".user-summary",this.userSummaryOnClick),e.on("mouseenter",'[data-action="show-user-summary"][data-user]',this.userSummaryEnterElement),e.on("mouseleave",'[data-action="show-user-summary"][data-user]',this.userSummaryLeaveElement),e.on("mouseenter",".user-summary",this.userSummaryEnterUserSummary),e.on("mouseleave",".user-summary",this.userSummaryLeaveUserSummary)}},undelegateUserSummary:function(){if(this.enabled){var e=o()("body");e.off("click",this.userSummaryOnBodyClick),e.off("click",".user-summary",this.userSummaryOnClick),e.off("mouseenter",'[data-action="show-user-summary"][data-user]',this.userSummaryEnterElement),e.off("mouseleave",'[data-action="show-user-summary"][data-user]',this.userSummaryLeaveElement),e.off("mouseenter",".user-summary",this.userSummaryEnterUserSummary),e.off("mouseleave",".user-summary",this.userSummaryLeaveUserSummary)}},isUserSummaryVisible:function(){return!(!this._inAvatar&&!this._inUserSummary)},userSummaryToggleUserSummary:function(){this.isUserSummaryVisible()?this.userSummary.show():this.userSummary.hide()},userSummaryOnBodyClick:function(){this.isUserSummaryVisible()||this.userSummary.hide()},userSummaryOnClick:function(e){e.stopPropagation()},userSummaryEnterElement:function(e){clearTimeout(this.userSummaryLeaveElementTimeout);var t=o()(e.currentTarget),n=t.data("user"),i=this._getAnchor(t),r=this;this.userSummary.isVisible()&&n===this.userSummary.model.get("uid")||(this.userSummaryTimeout=setTimeout(function(){r._inAvatar=!0,r._inUserSummary=!1,r.userSummary.setUser(n,this.userSummaryOptions),r.userSummary.anchor(i),r.userSummaryToggleUserSummary()}.bind(this),300)),this.userSummary.isVisible()&&(this.userSummaryTimeout=setTimeout(function(){this._inAvatar=!0,this._inUserSummary=!1,this.userSummaryToggleUserSummary(),r.userSummary.anchor(i)}.bind(this),300))},userSummaryLeaveElement:function(){this.userSummaryLeaveElementTimeout=setTimeout(function(){clearTimeout(this.userSummaryTimeout),this._inAvatar=!1,this.userSummaryToggleUserSummary()}.bind(this),100)},userSummaryEnterUserSummary:function(){clearTimeout(this.userSummaryLeaveElementTimeout),this._inUserSummary=!0,this._inAvatar=!1,this.userSummaryToggleUserSummary()},userSummaryLeaveUserSummary:function(){this.userSummaryLeaveElementTimeout=setTimeout(function(){this._inUserSummary=!1,this.userSummaryToggleUserSummary()}.bind(this),100)},_getAnchor:function(e){var t=e.find("[data-user-summary-anchor]"),n=e.data("user-summary-anchor-class"),i=!!n;return t.length?t[0]:i?o()(n)[0]:e[0]}}},sgO5:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("J4zp"),r=n.n(i),a=n("q1tI"),o=n("4WAW"),s=n("bXkX");function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.initialState,u=void 0===i?o.c:i,l=n.reducer,c=void 0===l?o.f:l,h=n.schema,d=a.useCallback(function(t,n){return e(t,n).then(function(e){return{list:e.results,cursors:e.cursors}})},t),f=Object(s.a)(c,u,a.useMemo(function(){return h?{list:[h]}:{}},[h])),p=r()(f,2),g=p[0],m=p[1],v=a.useCallback(function(){return m(o.b.first(function(e){return d(e,null)}))},[d,m]),_=a.useCallback(function(){return m(o.b.next(function(e,t){return d(e,t)}))},[d,m]),b=a.useCallback(function(){return m(o.b.previous(function(e,t){return d(e,t)}))},[d,m]),S=a.useCallback(function(){return m(o.b.reset())},[m]);return{dispatch:m,onLoadFirst:v,onLoadNext:_,onLoadPrevious:b,onReset:S,list:o.g.list(g),loading:o.g.loading(g),isLoading:o.g.isLoading(g),hasPreviousPage:o.g.hasPreviousPage(g),hasNextPage:o.g.hasNextPage(g)}}},skoe:function(e,t,n){"use strict";t.a=function(e,t,n){return e?0===(i=e.images?e.images:e).length?"":1===i.length?i[0].url:i.reduce(function(e,i){var r=Math.abs(t-e.width)+Math.abs(n-e.height),a=Math.abs(t-i.width)+Math.abs(n-i.height);return(e.width<t||e.height<n)&&(r+=t*n),(i.width<t||i.height<n)&&(a+=t*n),r<a?e:i}).url:"";var i}},t04s:function(e,t,n){"use strict";(function(e){n.d(t,"d",function(){return r}),n.d(t,"b",function(){return C}),n.d(t,"c",function(){return w}),n.d(t,"a",function(){return N});var i,r,a=n("RIqP"),o=n.n(a),s=n("o0o1"),u=n.n(s),l=n("yXPU"),c=n.n(l),h=n("lSNA"),d=n.n(h),f=n("MVZn"),p=n.n(f),g=n("12sq"),m=n("XiPH"),v=n("WRMX"),_=n("QKgc"),b=n("RzKY"),S=n("NpZ0"),y=n("wHZf"),x=n("Fhuz");!function(e){e.GET="cart.GET",e.ADD_MODEL="cart.ADD_MODEL",e.REMOVE_MODEL="cart.REMOVE_MODEL",e.CLEAR="cart.CLEAR"}(r||(r={}));var C=Object(y.optimistic)(Object(S.b)({models:[],optimistic:{}},(i={},d()(i,r.GET,function(e,t){return t.effect.caseOf({Pending:function(){return e},Rejected:function(){return e},Resolved:function(t){var n=t.result;return p()({},e,{models:n})}})}),d()(i,r.ADD_MODEL,function(e,t){return t.effect.caseOf({Pending:function(){return p()({},e,{models:e.models.concat(t.modelUid)})},Rejected:function(){return e},Resolved:function(t){var n=t.result;return p()({},e,{models:n})}})}),d()(i,r.REMOVE_MODEL,function(e,t){return t.effect.caseOf({Pending:function(){return p()({},e,{models:e.models.filter(function(e){return e!==t.modelUid})})},Rejected:function(){return e},Resolved:function(t){var n=t.result;return p()({},e,{models:n})}})}),d()(i,r.CLEAR,function(e,t){return t.effect.caseOf({Pending:function(){return p()({},e,{models:[]})},Rejected:function(){return e},Resolved:function(){return e}})}),i))),w={isModelInCart:function(e,t){return t.cart.models.includes(e)},models:function(e){return Object(m.a)(e.cart.models,[v.f],e.entities)},modelUids:function(e){return e.cart.models}},T=function(){var e=c()(u.a.mark(function e(t,n){var i,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.addModelsToCart(t);case 2:return i=e.sent,r=i.results,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),M=function(){var e=c()(u.a.mark(function e(t,n){var i,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.removeModelsFromCart(t);case 2:return i=e.sent,r=i.results,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),E=function(e){return e.getJSON("skfb-cart").then(function(e){return e||[]}).catch(function(){return[]})},A=function(){var e=c()(u.a.mark(function e(t,n){var i,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(n);case 2:return i=e.sent,r=[].concat(o()(i),o()(t.filter(function(e){return i.every(function(t){return t.uid!==e.uid})}))),n.setJSON("skfb-cart",r),e.abrupt("return",r);case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),O=function(){var e=c()(u.a.mark(function e(t,n){var i,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(n);case 2:return i=e.sent,r=i.filter(function(e){return t.every(function(t){return e.uid!==t})}),n.setJSON("skfb-cart",r),e.abrupt("return",r);case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),R=function(){var e=c()(u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setJSON("skfb-cart",[]),e.abrupt("return",[]);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=c()(u.a.mark(function e(t,n,i,r){var a,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.length){e.next=11;break}if(!t.length){e.next=10;break}return e.next=4,M(n.map(function(e){return e.uid}),i);case 4:return e.next=6,T(t.map(function(e){return e.uid}),i);case 6:return a=e.sent,e.next=9,R(r);case 9:return e.abrupt("return",a);case 10:return e.abrupt("return",n);case 11:if(!t.length){e.next=18;break}return e.next=14,T(t.map(function(e){return e.uid}),i);case 14:return o=e.sent,e.next=17,R(r);case 17:return e.abrupt("return",o);case 18:return e.abrupt("return",[]);case 19:case"end":return e.stop()}},e)}));return function(t,n,i,r){return e.apply(this,arguments)}}(),I=b.f(function(e){return e({type:r.GET,payload:{effect:Object(y.clientOnly)(function(){var e=c()(u.a.mark(function e(t){var n,i,r,a,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Api,i=t.LocalStorage,r=t.getState,e.next=3,E(i);case 3:if(a=e.sent,x.c.isAuthenticated(r())){e.next=8;break}e.t0=a,e.next=11;break;case 8:return e.next=10,n.getCart().then(function(e){var t=e.results;return P(a,t,n,i)});case 10:e.t0=e.sent;case 11:return o=e.t0,e.abrupt("return",Object(m.b)(o,[v.f]));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.GET)}})}),N={get:function(){return I},addModel:function(t){return function(n,i){var a=i(),o=w.isModelInCart(t.uid,a),s=w.models(a);return o?e.resolve(Object(m.b)(s,[v.f])):n({type:r.ADD_MODEL,payload:{modelUid:t.uid,entities:Object(m.b)(t,v.f).entities,effect:Object(y.clientOnly)(function(){var e=c()(u.a.mark(function e(n){var i,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.Api,r=n.LocalStorage,!(s.length+1>g.a.storeCartMaxSize)){e.next=3;break}throw new _.d;case 3:if(!x.c.isAuthenticated(a)){e.next=9;break}return e.next=6,T([t.uid],i);case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,A([t],r);case 11:e.t0=e.sent;case 12:return o=e.t0,e.abrupt("return",Object(m.b)(o,[v.f]));case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.ADD_MODEL)}})}},removeModel:function(t){return function(n,i){var a=i(),o=w.isModelInCart(t.uid,a),s=w.models(a);return o?n({type:r.REMOVE_MODEL,payload:{modelUid:t.uid,entities:Object(m.b)(t,v.f).entities,effect:Object(y.clientOnly)(function(){var e=c()(u.a.mark(function e(n){var i,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.Api,r=n.LocalStorage,!x.c.isAuthenticated(a)){e.next=7;break}return e.next=4,M([t.uid],i);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,O([t.uid],r);case 9:e.t0=e.sent;case 10:return o=e.t0,e.abrupt("return",Object(m.b)(o,[v.f]));case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.REMOVE_MODEL)}}):e.resolve(Object(m.b)(s,[v.f]))}},clear:function(){return function(e,t){var n=t();return e({type:r.CLEAR,payload:{effect:Object(y.clientOnly)(function(){var e=c()(u.a.mark(function e(t){var i,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.Api,r=t.LocalStorage,!x.c.isAuthenticated(n)){e.next=6;break}return e.next=4,M(w.modelUids(n),i);case 4:e.next=8;break;case 6:return e.next=8,R(r);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.CLEAR)}})}}}}).call(this,n("CSL1"))},t8Ru:function(e,t,n){"use strict";var i=n("QLQS"),r=n("JBIC"),a=n("kZIE"),o=i.a.osg,s=function(){o.StateAttribute.call(this),this._channelMapping={},this._materialModel=void 0,this._stateSetContext=void 0,this._additive=!1,this._depthWrite=!0,this._castShadows=!0,this._hashes=["",""],this._dirtyUniforms=!0,this._activeChannels=[]};s.SHADING_COMPILER=0,s.EARLYZ_COMPILER=1,s.SHADOWCAST_COMPILER=2,s.WIREFRAME_COMPILER=3,s.CURRENT_COMPILER=s.SHADING_COMPILER,(s.compilerChannels=[])[s.SHADING_COMPILER]=r.a,s.compilerChannels[s.EARLYZ_COMPILER]=["Opacity","Displacement","SubsurfaceScattering"],s.compilerChannels[s.SHADOWCAST_COMPILER]=["Displacement","Opacity"],s.compilerChannels[s.WIREFRAME_COMPILER]=["Displacement"],s.hasVertexColor=!1,s.hasVertexAlpha=!1,o.createPrototypeStateAttribute(s,o.objectInherit(o.StateAttribute.prototype,{attributeType:"SketchfabMaterial",dirtyMaterial:function(){for(var e=this._hashes.length,t=0;t<e;++t)this._hashes[t]="";this._dirtyUniforms=!0},getHash:function(){if(!this._materialModel)return"";var e=this._hashes[s.CURRENT_COMPILER];if(e)return e;e=this.attributeType,s.CURRENT_COMPILER!==s.WIREFRAME_COMPILER&&(e+=this.getVertexAlphaEnable()?"1":"0"),s.CURRENT_COMPILER===s.SHADING_COMPILER&&(e+=this.getShadeless()?"1":"0",e+=this.getVertexColorEnable()?"1":"0",e+=this.getHasOnlyPoints()?"1":"0",e+="srgb"===this.getVertexColorColorSpace()?"1":"0",e+=a.a.get("hasSsr")?"1":"0");for(var t=s.CURRENT_COMPILER===s.SHADOWCAST_COMPILER,n=this._materialModel.getChannels(),i=s.compilerChannels[s.CURRENT_COMPILER],r=i.length,o=this._channelMapping,u=0;u<r;++u){var l=i[u],c=n[l];if(c.isEnableEffective())if(!t||this._castShadows){var h=o[l];e+=".",e+=h<0?"":h,e+=c.getShaderHash(),e+=this.getChannelPacking(l)}else e+=".0";else e+=".0"}return this._hashes[s.CURRENT_COMPILER]=e,e},setMaterialModel:function(e){this._materialModel=e},setStateSetContext:function(e){this._stateSetContext=e},setChannelMapping:function(e,t){this._channelMapping[e]=t},getChannelPacking:function(e){return this._stateSetContext?this._stateSetContext.getChannelPacking(e):""},updateOpacity:function(){this._additive=!1,this._depthWrite=!0,this._castShadows=!0;var e=this._materialModel.getChannels().Opacity;if(e.isEffective()){var t=e.getTransparency();if("alphaMask"!==t&&"dithering"!==t){if("additive"===t)return this._additive=!0,this._depthWrite=!1,void(this._castShadows=!1);var n=!1;return 1===e.getFactor()&&(n=e.getTextureModel()||this.getVertexAlphaEnable()),n?void 0:(this._depthWrite=!1,void(this._castShadows=!1))}}},cloneType:function(){return new s},getType:function(){return this.attributeType},getTypeMember:function(){return this.attributeType},getMaterialModel:function(){return this._materialModel},getShadeless:function(){return this._materialModel&&this._materialModel.get("shadeless")},getReflection:function(){return this._materialModel&&this._materialModel.get("reflection")},getVertexColorEnable:function(){return this._materialModel&&this._materialModel.get("vertexColorEnable")},getVertexAlphaEnable:function(){return this._materialModel&&this._materialModel.get("vertexAlphaEnable")},getVertexColorColorSpace:function(){return this._materialModel&&this._materialModel.get("vertexColorColorSpace")},getCullFace:function(){return this._materialModel&&this._materialModel.get("cullFace")},getHasOnlyPoints:function(){return this._materialModel&&this._materialModel.hasOnlyPoints()},getAdditive:function(){return this._additive},getDepthWrite:function(){return this._depthWrite},getCastShadows:function(){return this._castShadows},getChannelMapping:function(e){return this._channelMapping[e]},getOrCreateUniforms:function(){if(s.uniforms)return s.uniforms;var e=s.uniforms={};e.uReflection=o.Uniform.createFloat("uReflection");for(var t=n("4E7f").default,i=r.a.length,a=0;a<i;++a){var u=r.a[a],l=t[u].model;l.prototype.addUniforms.call(l,e,u)}return e},_cacheChannelUniforms:function(){var e=this.getOrCreateUniforms(),t=this._materialModel.getChannels(),n=r.a.length,i=this._activeChannels;i.length=0;for(var a=0;a<n;++a){var o=t[r.a[a]];o.isEnableEffective()&&(o.cacheUniforms(e),i.push(o))}},apply:function(){if(this._materialModel){this._dirtyUniforms&&(this._dirtyUniforms=!1,this._cacheChannelUniforms()),this.getOrCreateUniforms().uReflection.setFloat(this.getReflection());for(var e=this._activeChannels,t=e.length,n=0;n<t;++n)e[n].updateUniforms()}}}),"osgSketchfab","Material"),t.a=s},tLMR:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return h});var i=n("77vZ"),r=n("nzRv"),a=n("f5KD"),o=n("9mpE"),s=n("gCTM"),u=n("nPtx"),l=r.a.extend({optionTypes:{url:a.b.string.isRequired,title:a.b.string.isRequired,height:a.b.number.isRequired},template:function(){return s.default.getFromString('\n            <iframe title="{{ title }}" class="wufoo-popup" height="{{ height }}px" src="{{ url }}"></iframe>\n            ',this.options)}}),c=Object(i.a)(r.a.extend({displayName:"WufooPopup",optionTypes:{url:a.b.string.isRequired,title:a.b.string.isRequired,height:a.b.number.isRequired},template:function(){var e=this.options,t=e.title,n=e.url,i=e.height;return s.default.getFromString("{{ components.popup | component }}",{components:this.createChildrenComponents({popup:{viewClass:u.a,options:{title:t,child:{viewClass:l,options:{title:t,url:n,height:i}}}}})})}})),h=function(e,t){var n=t.sourceField,i=t.mediumField,r=t.campaignField,a=t.gclidField,s=t.fbclidField,u=t.contentField,l=t.termField,c=t.refField,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=h.interestedInField,f=h.interestedIn,p={};return p["field".concat(n)]=o.c.string("utm_source"),p["field".concat(i)]=o.c.string("utm_medium"),p["field".concat(r)]=o.c.string("utm_campaign"),p["field".concat(a)]=o.c.string("gclid"),p["field".concat(s)]=o.c.string("fbclid"),p["field".concat(u)]=o.c.string("utm_content"),l&&(p["field".concat(l)]=o.c.string("utm_term")),p["field".concat(c)]=o.c.string("ref"),d&&f&&(p["field".concat(d)]=f),"".concat("https://sketchfab.wufoo.com/embed/").concat(e).concat(o.c.craft("/def/",p))}},tNdj:function(e,t,n){"use strict";var i=n("cDf5"),r=n.n(i),a=n("MG+9"),o=n("YfG3"),s=n("q1z7"),u=n.n(s),l=n("P9l5"),c=n("yktj"),h=n("9mpE"),d=n("f5KD"),f=Object(l.a)(["initialize","destroy"])(u.a.Model);t.a=f.extend({optionTypes:{},idAttribute:"uid",backend:c.a,constructor:function(){this.options=arguments[1]||{},f.apply(this,arguments)},initialize:function(){f.prototype.initialize.apply(this,arguments),this.checkModelTypes()},set:function(){return f.prototype.set.apply(this,arguments)},sync:function(){return f.prototype.sync.apply(this,arguments).then(function(){return this}.bind(this))},domain:function(){return Object(a.a)(this.backend,"domain")},queryParams:function(){return{}},url:function(){var e=Object(a.a)(this,"domain")+Object(a.a)(this,"endpoint")+h.c.craft("?",this.queryParams());return e=e.replace(/(?!^)\/{2,}/g,"/")},isNew:function(){var e=this.get(this.idAttribute);return void 0===e||!(!e||"tmp_"!==e.toString().substr(0,4))},checkModelTypes:function(){Object(d.a)(this.optionTypes,this.toJSON(),"value",this.displayName||"Model")}},{extend:function(e,t){var n=Object(o.a)({},e,{optionTypes:Object(o.a)({},this.prototype.optionTypes||{},e.optionTypes||{})});return f.extend.call(this,n,t)},get:function(e,t){t=Object(o.a)({},t),"object"!==r()(e)&&(e={uid:e});var n=new this(e),i=function(e){return e.set({}),e};return t.immediate?(n.fetch(t),i(n)):n.fetch(t).then(i)}})},tSPY:function(e,t,n){"use strict";var i=n("i4v/");t.a=i.a.extend({events:{"click .close":"hide","touchstart .close":"hide"},show:function(e){e&&e.preventDefault&&e.preventDefault(),this.$el.removeClass("hidden")},hide:function(e){e&&e.preventDefault&&e.preventDefault(),this.$el.addClass("hidden")},isVisible:function(){return!this.el.classList.contains("hidden")}})},tgOl:function(e,t,n){"use strict";n.r(t);var i=n("dZz+"),r=n("V5OH"),a=n("gCTM"),o=n("gzuT"),s=n("eEbW");n("vLTl");t.default=r.a.extend({events:{'click [data-action="cancel"]':"cancel",'click [data-action="validate"]':"sendAccountConfirmationMail","reset form":"cancel","submit form":"continue"},reasons:{publish:"Before publishing your 3D model, you must confirm your e-mail address",upgrade:"Before upgrading, you must confirm your e-mail address",collections:"You must confirm you e-mail address to be able to create collections",invite:"You must confirm you e-mail address to be able to invite friends",download:"You must confirm you e-mail address to be able to download this model"},initialize:function(){r.a.prototype.initialize.apply(this,arguments),this.$container.addClass("popup-email-verification")},template:function(){return a.default.get("skfb_front/popups/email-confirmation",{reason:this.reasons[this.options.reason],email:i.a.me().get("email")})},sendAccountConfirmationMail:function(){s.b.sendAccountConfirmationMail({after:this.options.noAfter?null:window.location.href}).then(function(){new o.a({content:"A confirmation email has been sent to "+i.a.me().get("email"),class:"success",delay:5e3})}).catch(function(){new o.a({content:'The confirmation email could not be sent.<br/>Please <a href="https://help.sketchfab.com/hc/en-us/requests/new?type=accounts_general&utm_source=website&utm_campaign=email-confirmation-error" target="_blank">contact us</a> if the problem persists.',class:"error",delay:5e3})}),this.continue()}})},tkW9:function(e,t){e.exports='varying vec2 vTexCoord0;\n\nuniform sampler2D uTexturePanel;\nuniform vec4 uHoveredArea;\nuniform float uHoveredOpaque;\nuniform float uAlpha;\nuniform float uRatio;\nuniform float uRound;\nuniform float uVeilFactor;\n\n#pragma include "utils/functions.glsl"\n\n// signed distance to a 2D rounded box\nfloat sdRoundBox( const in vec2 p, const in vec2 b, const in float r ) {\n    vec2 q = abs(p) - b;\n    vec2 m = vec2( min(q.x,q.y), max(q.x,q.y) );\n    float d = (m.x > 0.0) ? length(q) : m.y;\n    return d - r;\n}\n\nvoid main(void) {\n  vec4 color = texture2D(uTexturePanel, vTexCoord0);\n\n  float lerpValue = step(0.0, -vTexCoord0.x);\n  lerpValue += step(1.0, vTexCoord0.x);\n\n  float round = uRound;\n  float left = uHoveredArea.x + round;\n  float right = uHoveredArea.y - round;\n  float top = uHoveredArea.z - round;\n  float bottom = uHoveredArea.w + round;\n\n  vec2 halfSize = abs(vec2(left - right, top - bottom) * 0.5);\n  vec2 center = vec2(halfSize.x + left, halfSize.y + bottom);\n\n  lerpValue += max(0.0, -sign(sdRoundBox( vTexCoord0 - center, halfSize, round)));\n\n  color.rgba = mix(color.rgba, color.rgba + vec4(0.109, 0.664, 0.848, step(0.1, uHoveredOpaque)), lerpValue);\n\n  color.a *= uAlpha;\n  color.rgb *= (color.a * uVeilFactor);\n\n  gl_FragColor = color;\n}\n'},tvnS:function(e,t,n){"use strict";var i=n("QLQS"),r=n("TGBA"),a=n("zmn3"),o=i.a.osg,s=function(){o.NodeVisitor.apply(this,arguments),this.reset()};o.createPrototypeObject(s,o.objectInherit(o.NodeVisitor.prototype,{reset:function(){this._nodes=[],this._nodeMap={},this._nodeList={},this._dirty=!0},isDirty:function(){return this._dirty},getRootNode:function(){return this._nodes[0]},getRealNodeMap:function(){return this._nodeList},getRepresentationNodeMap:function(){return this._nodeMap},createNodeEntry:function(e){this._dirty=!1;var t=e.getInstanceID();this._nodeList[t]||(this._nodeList[t]=e);var n={name:e.getName(),instanceID:t,nodeMask:e.getNodeMask()};return this._nodeMap[t]||(this._nodeMap[t]=n),n},applyNode:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var n=this.createNodeEntry(e);n.children=this._nodes,n.type="Group",t.push(n),this._nodes=t},applyMatrixTransform:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var n=this.createNodeEntry(e);n.children=this._nodes,n.type="MatrixTransform",n.localMatrix=o.mat4.clone(e.getMatrix()),n.worldMatrix=e.getWorldMatrices()[0],t.push(n),this._nodes=t},applyGeometry:function(e){var t=this._nodes;this._nodes=[],this.traverse(e);var n=this.createNodeEntry(e);n.type=e.className(),t.push(n),this._nodes=t},apply:function(e){var t=e.getTypeID();t===o.Node.typeID?this.applyNode(e):t===o.MatrixTransform.typeID?this.applyMatrixTransform(e):e instanceof o.Geometry?this.applyGeometry(e):this.traverse(e)}}));var u=s,l=n("joy8"),c=n("par7");function h(){this.handlers=[],this.events=[]}h.prototype={subscribe:function(e){this.events.forEach(function(t){e(t.name,t.args)});var t=this.handlers.push(e);return function(){this.handlers.split(t-1,1)}},emit:function(e,t){this.events.push({name:e,args:t}),this.handlers.forEach(function(n){n(e,t)})}};var d=h,f=n("Kp3F"),p=n("Auie"),g=n("kUJ5"),m=i.a.osg,v=i.a.osgAnimation,_=function(e){this._partial=e,this._events={},this._replayEmitter=new d,this._partial.on("model-loaded",function(){this._emitEvents()}.bind(this)),this._sceneGraphVisitor=new u,this._nodeMap=void 0};_.prototype={_filterAnnotationModelMessage:function(e){delete e.refreshAction,delete e.sticky},addGlobalListener:function(e){this._replayEmitter.subscribe(e)},intersectPoint:function(e,t,n,i){var r=this._getFeatureModel("material").findFirstMaterial(e._nodePath);this._replayEmitter.emit("click",{position3D:t,position2D:n,normal:i,instanceID:this._getHitNodeID(e),material:r?r.getJSON():null})},_getFeatureModel:function(e){var t=this._partial.scene.getFeatures()[e];if(t)return t.getModel()},_getViewerOSG:function(){return this._getViewer()._viewer},_getViewer:function(){return this._partial.scene},_emitEvents:function(){var e=["viewerready","annotationFocus","annotationBlur","click"];this._partial.scene.on("all",function(t,n){-1!==e.indexOf(t)&&this._replayEmitter.emit(t,n)}.bind(this)),this.emitEvents=function(){}},_computeSceneGraph:function(){var e=this._sceneGraphVisitor;e.isDirty()&&this._getViewer().getRootModel().accept(e)},_getRootNode:function(){return this._computeSceneGraph(),this._sceneGraphVisitor.getRootNode()},_getRealNodeMap:function(){return this._computeSceneGraph(),this._sceneGraphVisitor.getRealNodeMap()},_getRepresentationNodeMap:function(){return this._computeSceneGraph(),this._sceneGraphVisitor.getRepresentationNodeMap()},_convertDataUriToImage:function(e,t,n){var i=this._getFeatureModel("material").getImageCollection();l.default.instance.getOrCreateImage(e).promise.then(function(r){var a=i.addNewImage({uid:t,url:e,width:r.getWidth(),height:r.getHeight(),name:e.slice(0,100)});n(null,a.getUID())}).catch(function(){n("failed to add texture")})},start:function(e){this._partial.start(),e(null)},stop:function(e){this._partial.stop(),e(null)},load:function(e){this._partial.load(),e(null)},gotoAnnotation:function(e,t){var n=this._getFeatureModel("hotspot").get("hotspots"),i=n.at(e);n.trigger("select",i),t(null,e)},getAnnotationList:function(e){var t=this._getFeatureModel("hotspot").get("hotspots").toJSON();t.forEach(this._filterAnnotationModelMessage.bind(this)),e(null,t)},lookat:function(e,t,n,i){this.setCameraLookAt(e,t,n,i)},setFov:function(e,t){var n=this._getFeatureModel("camera");n.set("dollyPrevent",!0);var i=n.setJSON({fov:e});t(i.length?i:null,e),n.set("dollyPrevent",!1)},getCurrentTime:function(e){var t=this._getFeatureModel("animation"),n=t.getCurrentAnimation().get("duration");e(null,t.get("progress")*n/100)},play:function(e){this._getFeatureModel("animation").set("playing",!0),e(null)},pause:function(e){var t=this._getFeatureModel("animation");t?(t.set("playing",!1),e(null)):e("no animation feature")},seekTo:function(e,t){var n=this._getFeatureModel("animation"),i=100*e/n.getCurrentAnimation().get("duration");n.trigger("seek",i),t(null)},getAnimations:function(e){var t=[];this._getFeatureModel("animation").get("animations").forEach(function(e){var n=[];n.push(e.get("uid")),n.push(e.get("name")),n.push(e.get("duration")),t.push(n)}),e(null,t)},setCurrentAnimationByUID:function(e,t){this._getFeatureModel("animation").set("currentUID",e),t(null)},setCycleMode:function(e,t){var n=this._getFeatureModel("animation");1===n.get("animations").length&&"all"===e&&(e="one");var i=n.setJSON({cycleMode:e},{validate:!0,warnOnError:!0});t(i&&i.length?i:null)},setSpeed:function(e,t){var n=this._getFeatureModel("animation").setJSON({speed:e},{validate:!0,warnOnError:!0});t(n&&n.length?n:null,e)},getSceneGraph:function(e){e(null,this._getRootNode())},getNodeMap:function(e){e(null,this._getRepresentationNodeMap())},getNodeMask:function(e,t){var n=this._getNodeFromUserNodeID(e);n?t(null,n.getNodeMask()):t("node with id "+e.toString()+" not found")},getMatrix:function(e,t){var n=this._getNodeFromUserNodeID(e);n?t(null,{local:n.getMatrix(),world:n.getWorldMatrices()[0]}):t("node with id "+e.toString()+" not found")},setMatrix:function(e,t,n){var i=this._getNodeFromUserNodeID(e);i?(m.mat4.copy(i.getMatrix(),t),i.dirtyBound(),n(null),c.a.redrawShadow()):n("node with id "+e.toString()+" not found")},hide:function(e,t){var n=this._getNodeFromUserNodeID(e);n?(n.setNodeMask(0),t(null)):t("show: node id "+e+" not found"),c.a.redrawShadow()},show:function(e,t){var n=this._getNodeFromUserNodeID(e);n?(n.setNodeMask(-1),t(null)):t("show: node id "+e+" not found"),c.a.redrawShadow()},translate:function(){var e,t,n=arguments.length,i=arguments[n-1],r=arguments[0],a=arguments[1];4===n?e=arguments[2]:5===n&&(e=arguments[2],t=arguments[3]),e=e||0;var o=v[t]||v.easeOutQuad,s=this._getNodeFromUserNodeID(r);if(s)if(s.getTypeID()===m.MatrixTransform.typeID){if(e>0){var u=m.vec3.create();m.mat4.getTranslation(u,s.getMatrix());var l=new f.c(u,a,e,o,function(e){s.removeUpdateCallback(l),i(null,e)});s.addUpdateCallback(l)}else m.mat4.setTranslation(s.getMatrix(),a),s.dirtyBound(),i(null,a);c.a.redrawShadow()}else i("you can only translate MatrixTransform nodes");else i("node with id "+r.toString()+" not found")},rotate:function(){var e=m.vec3.create(),t=m.vec3.create();return function(){var n,i,r=arguments.length,a=arguments[r-1],o=arguments[0],s=arguments[1];4===r?n=arguments[2]:5===r&&(n=arguments[2],i=arguments[3]),n=n||0;var u=v[i]||v.easeOutQuad,l=this._getNodeFromUserNodeID(o);if(l)if(l.getTypeID()===m.MatrixTransform.typeID){var h=m.quat.create(),d=m.mat4.create();if(m.mat4.fromRotation(d,-s[0],m.vec3.set(t,s[1],s[2],s[3])),m.mat4.getRotation(h,d),n>0){var p=m.quat.create();m.mat4.getRotation(p,l.getMatrix());var g=new f.a(p,h,n,u,function(e){l.removeUpdateCallback(g),a(null,e)});l.addUpdateCallback(g)}else m.mat4.fromQuat(d,h),m.mat4.getTranslation(e,l.getMatrix()),m.mat4.setTranslation(d,e),m.mat4.copy(l.getMatrix(),d),l.dirtyBound(),a(null,s);c.a.redrawShadow()}else a("you can only translate MatrixTransform nodes");else a("node with id "+o.toString()+" not found")}}(),getRootMatrixNode:function(e){var t=this._getViewer().getRootModel();if(t||e("No scene loaded"),!this._nodeInTheMiddle){this._nodeInTheMiddle=new m.MatrixTransform,this._nodeInTheMiddle.setName("NITM");for(var n=t.getChildren(),i=0,r=n.length;i<r;i++)this._nodeInTheMiddle.addChild(n[i]);t.removeChildren(),t.addChild(this._nodeInTheMiddle)}e(null,this._nodeInTheMiddle.getInstanceID(),this._nodeInTheMiddle.getMatrix())},getCameraLookAt:function(e){var t=this._getViewerOSG().getManipulator(),n=[],i=[];t.getTarget(n),t.getEyePosition(i),e(null,{position:i,target:n})},setCameraLookAt:function(e,t){var n=this._getFeatureModel("camera"),i=this._getViewerOSG().getManipulator(),r=arguments[arguments.length-1],a=3===arguments.length?2:arguments[2];a<=0?i.setTargetAndEye(t,e):(n.setTargetAndEye(t,e),n.set("animationDuration",a)),r(null)},getScreenShot:function(){var e,t,n=arguments.length,i=arguments[n-1],r="image/jpeg";if(2===n)r=arguments[0];else if(3===n)e=Math.floor(arguments[0]),t=Math.floor(arguments[1]);else if(4===n)e=Math.floor(arguments[0]),t=Math.floor(arguments[1]),r=arguments[2];else if(1!==n)return void i("Wrong number of arguments, signature should be (width, height, [callback]), (width, height, mimetype, [callback]), (mimetype, [callback]) or ([callback]).");i(null,this._getViewer().getScreenShot(e,t).toDataURL(r))},getMaterialList:function(e){var t=this._getFeatureModel("material");e(null,Object(r.a)(t.getJSON()))},getTextureList:function(e){e(null,this._getFeatureModel("material").getImageCollection().toJSON())},addTexture:function(e,t){this._convertDataUriToImage(e,void 0,t)},updateTexture:function(e,t,n){this._convertDataUriToImage(e,t,function(e){if(e)n(e);else{var i=this._getFeatureModel("material").getMaterials();for(var r in i){var a=i[r].getChannels();for(var o in a){var s=a[o],u=s.getTextureModel();u&&u.getUID()===t&&s.trigger("updateChannel")}}n(null,t)}}.bind(this))},setTextureQuality:function(e,t){var n=this._getFeatureModel("quality");n.get("promiseReady").then(function(i){var r={ld:0,sd:1,hd:2};if(i.high||(r={ld:0,hd:1}),i.mid||(r={hd:0}),e in r){var o=r[e];n.set("level",o),t(null,"texture quality set to "+o)}else{var s=Object(a.a)(r,function(e,t){return t}).join(", ");t(['Quality must be a string "ld", "sd" or "hd".'," Available qualities for this model are : ",s].join(""),null)}}.bind(this))},setMaterial:function(e,t){var n=this._getFeatureModel("material"),i=e.stateSetID,r=n.getMaterialByStateSetID(i);r.setMaterialJSON(e,n.getImageCollection(),{validate:!1,warnOnError:!1}),r.trigger("apply"),c.a.redrawShadow(),t(null)},setPostProcessing:function(e,t){this._getFeatureModel("postProcess").set(e),t(null)},getPostProcessing:function(e){e(this._getFeatureModel("postProcess").toJSON())},getWorldToScreenCoordinates:function(e,t){var n=p.a.getScreenPositionFromWorldPoint(e);t({glCoord:n.slice(0,2),canvasCoord:g.a.glCoordToCanvas(n[0],n[1],n).slice(0,2)})},_getNodeFromUserNodeID:function(e){return this._getRealNodeMap()[e]},_getHitNodeID:function(e){if(e&&e._nodePath&&e._nodePath.length){var t=e._nodePath[e._nodePath.length-1];if(t)return t.getInstanceID()}}};t.a=_},tvqq:function(e,t,n){!function(){var n=Array.prototype.forEach,i=Object.prototype.hasOwnProperty,r=Array.prototype.slice,a=0;var o,s={keys:Object.keys||function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("keys() called on a non-object");var t,n=[];for(t in e)e.hasOwnProperty(t)&&(n[n.length]=t);return n},uniqueId:function(e){var t=++a+"";return e?e+t:t},has:function(e,t){return i.call(e,t)},each:function(e,t,i){if(null!=e)if(n&&e.forEach===n)e.forEach(t,i);else if(e.length===+e.length)for(var r=0,a=e.length;r<a;r++)t.call(i,e[r],r,e);else for(var o in e)this.has(e,o)&&t.call(i,e[o],o,e)},once:function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}}};o={on:function(e,t,n){return l(this,"on",e,[t,n])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this}),this):this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var i=this,r=s.once(function(){i.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,n)},off:function(e,t,n){var i,r,a,o,u,c,h,d;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(u=0,c=(o=e?[e]:s.keys(this._events)).length;u<c;u++)if(e=o[u],a=this._events[e]){if(this._events[e]=i=[],t||n)for(h=0,d=a.length;h<d;h++)r=a[h],(t&&t!==r.callback&&t!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&c(n,t),i&&c(i,arguments),this},stopListening:function(e,t,n){var i=this._listeners;if(!i)return this;var r=!t&&!n;for(var a in"object"==typeof t&&(n=this),e&&((i={})[e._listenerId]=e),i)i[a].off(t,n,this),r&&delete this._listeners[a];return this}};var u=/\s+/,l=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)e[t].apply(e,[r,n[r]].concat(i));return!1}if(u.test(n)){for(var a=n.split(u),o=0,s=a.length;o<s;o++)e[t].apply(e,[a[o]].concat(i));return!1}return!0},c=function(e,t){var n,i=-1,r=e.length,a=t[0],o=t[1],s=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,a);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,a,o);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,a,o,s);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t)}};s.each({listenTo:"on",listenToOnce:"once"},function(e,t){o[t]=function(t,n,i){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=s.uniqueId("l"))]=t,"object"==typeof n&&(i=this),t[e](n,i,this),this}}),o.bind=o.on,o.unbind=o.off,o.mixin=function(e){return s.each(["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"],function(t){e[t]=this[t]},this),e},e.exports&&(t=e.exports=o),t.BackboneEvents=o}()},u4Ci:function(e,t,n){e.exports=n.p+"static/assets/images/editor/Hemi-069d53239a191b55450d472c13408320.png"},uCEv:function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\nuniform float uScale;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n\n  vec3 posLocal = Vertex.xyz * vec3(uScale, uScale, 1.0 - uScale);\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(posLocal, 1.0));\n}\n"},"uCb/":function(e,t){e.exports='#pragma include "utils/encodeDecode.glsl"\n\nuniform sampler2D TextureBlurInput;\nuniform vec2 uTextureBlurInputSize;\n\n#define SSAO_FILTER_RADIUS 3\n\n#define SSAO_TAP_BLUR(id, absid) sampleTex = TEXTURE_2D_TextureBlurInput(uv + axis * float(id) * 2.0); \\\n    z = decode24(sampleTex.xyz); \\\n    weight = max(0.0, 1.0 - sharpnessFactor * abs(z - initialZ)) * (0.3 + gaussian[absid]); \\\n    sum += weight * sampleTex.a; \\\n    totalWeight += weight;\n\nvec4 ssaoBlur(const in vec2 axis) {\n    vec2 uv = gTexCoord;\n\n    vec4 aoDepth = TEXTURE_2D_TextureBlurInput(uv);\n\n    // background\n    if(aoDepth.x == 1.0){\n        return aoDepth;\n    }\n\n    float initialZ = decode24(aoDepth.xyz);\n\n    float gaussian[SSAO_FILTER_RADIUS + 2]; // dummy because of intel off-by-one bug\n    gaussian[0] = 0.153170;\n    gaussian[1] = 0.144893;\n    gaussian[2] = 0.122649;\n    gaussian[3] = 0.092902;\n    gaussian[4] = 0.0;\n\n    float totalWeight = gaussian[0];\n    float sum = aoDepth.a * totalWeight;\n    float sharpnessFactor = 400.0;\n\n    // ---- UNROLL ----\n    vec2 ofs;\n    float z;\n    float weight;\n    vec4 sampleTex;\n\n    SSAO_TAP_BLUR(-3, 3);\n    SSAO_TAP_BLUR(-2, 2);\n    SSAO_TAP_BLUR(-1, 1);\n    SSAO_TAP_BLUR(1, 1);\n    SSAO_TAP_BLUR(2, 2);\n    SSAO_TAP_BLUR(3, 3);\n    // ---- UNROLL ----\n\n    aoDepth.a = sum / totalWeight;\n    return aoDepth;\n}\n\n#ifdef SSAO_BLUR_H\nvec4 ssaoBlurH() {\n    return ssaoBlur(vec2(1.0, 0.0) / uTextureBlurInputSize);\n}\n#else\nvec4 ssaoBlurV() {\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\n    return vec4(color * ssaoBlur(vec2(0.0, 1.0) / uTextureBlurInputSize).aaa, 1.0);\n}\n#endif'},uGjJ:function(e,t,n){"use strict";n.r(t);var i=n("gCTM"),r=n("V5OH"),a=n("f5KD");n("c2bz");t.default=r.a.extend({displayName:"MessagePopup",optionTypes:{title:a.b.string.isRequired,text:a.b.string.isRequired,buttons:a.b.shape({cancel:a.b.bool,cancelClass:a.b.string,cancelLabel:a.b.string,close:a.b.bool,closeClass:a.b.string,closeLabel:a.b.string,continue:a.b.bool,continueClass:a.b.string,continueLabel:a.b.string,ok:a.b.bool,okClass:a.b.string,okLabel:a.b.string,delete:a.b.bool,deleteClass:a.b.string,deleteLabel:a.b.string}),popupClass:a.b.string,safe:a.b.bool,popupClosable:a.b.bool,shouldRejectOnCancel:a.b.bool},defaultOptions:{shouldRejectOnCancel:!0},events:{"reset form":"cancel","submit form":"continue"},template:function(){return i.default.get("skfb_front/popups/message",{title:this.options.title,text:this.options.text,buttons:this.options.buttons,safe:this.options.safe,popupClass:this.options.popupClass,popupClosable:this.options.popupClosable})}})},uPP5:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n("9oTK"),r=n.n(i);function a(){var e={},t=new r.a(function(t,n){e.resolve=t,e.reject=n});return t.resolve=e.resolve,t.reject=e.reject,t.promise=t,t}},uoDY:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r});var i=function(e){return e&&e.meta&&e.meta.isEffect},r=function(e,t){return function(n){if(n.isServer)throw new Error("".concat(t," should never be called on the server. Something must be wrong"));return e(n)}}},uvJm:function(e,t,n){"use strict";var i=function(){this._frame=0,this._startSimulation=0,this._currentSimulation=0,this._deltaTime=0};i.prototype={setReferenceTime:function(e){this._startSimulation=e},getReferenceTime:function(){return this._startSimulation},setSimulationTime:function(e){this._currentSimulation=e},getSimulationTime:function(){return this._currentSimulation},setDeltaTime:function(e){this._deltaTime=e},getDeltaTime:function(){return this._deltaTime},setFrameNumber:function(e){this._frame=e},getFrameNumber:function(){return this._frame}},t.a=i},uymv:function(e,t){e.exports='#pragma include "utils/functions.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\nvarying vec2 vTexCoord0;\n\nuniform sampler2D uTextureFloor;\nuniform float uScaleToMeter;\nuniform int uOutputLinear;\n\nvarying vec4 vViewPos;\nuniform vec2 uNearFar;\nuniform sampler2D uTextureDepth;\nuniform vec2 uGlobalTexSize;\nuniform vec2 uGlobalTexRatio;\n\nvoid main(void) {\n\n#ifndef DISPLAY_FLOOR\n  discard;\n#else\n\n  float distDepth = distanceToDepth(uTextureDepth, uGlobalTexRatio * gl_FragCoord.xy / uGlobalTexSize, vViewPos, uNearFar);\n  if (distDepth >= 0.0) discard;\n\n  float x = length(vTexCoord0 * 2.0 - 1.0);\n  x *= x;\n  float fade = smoothstep(0.0, 1.0, 1.0 - x * x);\n\n  float value = sRGBToLinear(texture2D(uTextureFloor, (vTexCoord0 * 1.0 - 0.5) * uScaleToMeter).r);\n  vec4 color = vec4(vec3(value), fade * max(0.8, value));\n  color.rgb *= color.a;\n\n  gl_FragColor = uOutputLinear == 0 ? linearTosRGB(color) : color;\n#endif\n}\n'},"v+9t":function(e,t,n){"use strict";var i=n("a3nb"),r=n("Qavt"),a=function(e,t,n,i){r.a.call(this),this._sourceFactor=a.DISABLE,this._destinationFactor=a.DISABLE,this._sourceFactorAlpha=this._sourceFactor,this._destinationFactorAlpha=this._destinationFactor,this._separate=!1,void 0!==e&&this.setSource(e),void 0!==t&&this.setDestination(t),void 0!==n&&this.setSourceAlpha(n),void 0!==i&&this.setDestinationAlpha(i)};a.DISABLE=-1,a.ZERO=0,a.ONE=1,a.SRC_COLOR=768,a.ONE_MINUS_SRC_COLOR=769,a.SRC_ALPHA=770,a.ONE_MINUS_SRC_ALPHA=771,a.DST_ALPHA=772,a.ONE_MINUS_DST_ALPHA=773,a.DST_COLOR=774,a.ONE_MINUS_DST_COLOR=775,a.SRC_ALPHA_SATURATE=776,a.BLEND_DST_RGB=32968,a.BLEND_SRC_RGB=32969,a.BLEND_DST_ALPHA=32970,a.BLEND_SRC_ALPHA=32971,a.CONSTANT_COLOR=32769,a.ONE_MINUS_CONSTANT_COLOR=32770,a.CONSTANT_ALPHA=32771,a.ONE_MINUS_CONSTANT_ALPHA=32772,a.BLEND_COLOR=32773,i.a.createPrototypeStateAttribute(a,i.a.objectInherit(r.a.prototype,{attributeType:"BlendFunc",cloneType:function(){return new a},setSource:function(e){this.setSourceRGB(e),this.setSourceAlpha(e)},getSource:function(){return this._sourceFactor},setDestination:function(e){this.setDestinationRGB(e),this.setDestinationAlpha(e)},getDestination:function(){return this._destinationFactor},getSeparate:function(){return this._separate},checkSeparate:function(){return this._sourceFactor!==this._sourceFactorAlpha||this._destinationFactor!==this._destinationFactorAlpha},setSourceRGB:function(e){this._sourceFactor="string"==typeof e?a[e]:e,this._separate=this.checkSeparate()},getSourceRGB:function(){return this._sourceFactor},setSourceAlpha:function(e){this._sourceFactorAlpha="string"==typeof e?a[e]:e,this._separate=this.checkSeparate()},getSourceAlpha:function(){return this._sourceFactorAlpha},setDestinationRGB:function(e){this._destinationFactor="string"==typeof e?a[e]:e,this._separate=this.checkSeparate()},getDestinationRGB:function(){return this._destinationFactor},setDestinationAlpha:function(e){this._destinationFactorAlpha="string"==typeof e?a[e]:e,this._separate=this.checkSeparate()},getDestinationAlpha:function(){return this._destinationFactorAlpha},apply:function(e){e.applyBlendFunc(this)}}),"osg","BlendFunc"),t.a=a},vBtE:function(e,t,n){"use strict";var i=n("cDf5"),r=n.n(i),a=n("MVZn"),o=n.n(a),s=n("EVdn"),u=n.n(s),l=n("YfG3"),c=n("u3oV"),h=n("Ui7z"),d=n("89mf"),f=n("PteP"),p=n("3CzM"),g=n("TYgF"),m=n("X2EN"),v=n("vJtL");function _(e){return e.__withState.nextState||e.state}var b={name:"WithState",state:{},constructor:function(){var e=this;this.__withState={planRender:Object(d.e)(function(t){var n=_(e);!function(e){delete e.__withState.nextState}(e),e.update(e.options,n,!0,t)},{leading:!1})}},setState:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=_(this),i=Object(v.a)(e)?e(n):e;!function(e,t){e.__withState.nextState=t}(this,Object(l.a)({},n,i)),this.__withState.planRender(t)}};t.a=f.a.extend({mixins:[b,g.b,p.a],defaultOptions:function(){return{}},isInitialized:!1,isMounted:!1,constructor:function(){this.options=Object(l.a)({},this.defaultOptions(),Object(c.a)(arguments[0]||{},function(e){return void 0!==e})),f.a.apply(this,arguments)},initialize:function(){f.a.prototype.initialize.apply(this,arguments),this.isInitialized=!0},setElement:function(e){var t=e[0]||e;return this.isInitialized&&this.el===t||f.a.prototype.setElement.apply(this,arguments),this.el&&(this.el[m.b]=this),this},_removeElement:function(){this.$el.html("")},template:function(){return""},update:function(e,t,n,i){this.shouldUpdate=i||this.shouldViewUpdate(e,t);var r=this.isMounted&&this.shouldUpdate;r&&this.viewWillUpdate(e,t);var a=this.options,o=this.state;return this.options=e,this.state=t,this.onViewUpdate(r,a,o,e,t,n)},onViewUpdate:function(e,t,n){e&&(this.render(),this.viewDidUpdate(t,n))},viewWillReceiveOptions:function(e){var t=this,n=this.getDerivedStateFromOptions(e,this.state);n&&Object.keys(n).some(function(e){return n[e]!==t.state[e]})&&(this.state=o()({},this.state,n))},getDerivedStateFromOptions:function(){},shouldViewUpdate:function(){return!0},viewWillUpdate:function(){},viewDidUpdate:function(){},forceUpdate:function(){this.setState({},!0)},afterRender:function(){f.a.prototype.afterRender.apply(this,arguments),this.isMounted||(this.isMounted=!0,this.viewDidMount())},beforeRemove:function(){f.a.prototype.beforeRemove.apply(this,arguments),this.isMounted&&(this.viewWillUnmount(),this.isMounted=!1,this.el&&delete this.el[m.b])},automagicErrors:function(e){if(this.$(".form-global-error").removeAttr("data-error"),this.$(".form-global-error").hide(),this.$("[data-error-for]").removeAttr("data-error"),null!==e)if("object"===r()(e)){var t=this.$("[data-error-for]");Object.keys(e).forEach(function(n){t.filter(function(){return u()(this).attr("data-error-for").split(",").indexOf(n)>-1}).attr("data-error",e[n].join("\n")).focus()}.bind(this))}else this.$(".form-global-error .message").text(e),this.$(".form-global-error").attr("data-error",e),this.$(".form-global-error").fadeIn()}},{isView:!0,extend:function(e,t){var n=Object(l.a)({},e,{defaultOptions:Object(h.h)(Object(d.g)(this.prototype.defaultOptions||{}),Object(d.g)(e.defaultOptions||{})),events:Object(l.a)({},this.prototype.events||{},e.events||{}),children:Object(l.a)({},this.prototype.children||{},e.children||{}),optionTypes:Object(l.a)({},this.prototype.optionTypes||{},e.optionTypes||{})});return f.a.extend.call(this,n,t)}})},vIRb:function(e,t,n){"use strict";var i=n("Z0Cl"),r=n("QLQS"),a=n("fgaA"),o=n("mbgM"),s=r.a.osg,u=function(e,t,n,i){var r=n-e,a=i-t;return r*r+a*a},l=function(e){return o.a.isPowerOf2(e.width)&&o.a.isPowerOf2(e.height)},c={isVideoURL:function(e){var t=e.split("."),n=t[t.length-1].toLowerCase();return"ogv"===n||"ogg"===n||"mp4"===n||"avi"===n||"webm"===n},isVideo:function(){return this.isVideoURL(this.get("images")[0].url)},getUID:function(){return this.get("uid")},getImages:function(){return this.get("images")},getURL:function(){console.error("dont call ImageSet.getURL")},filterPng:function(e,t){var n=e[0];if(!n)return e;for(var r=1;r<e.length;++r)if(e[r].width===n.width&&e[r].height===n.height)return Object(i.a)(e,function(e){return e.url.endsWith(".png")===t});return e},findFormat:function(e){var t=Object(i.a)(this.get("images"),function(t){return!t.options||t.options.format===e});return"N"===e&&Object(a.a)().preferOriginalNormalMap?this.filterPng(t,!0):t},getFilteredImages:function(e){if(!e||!Object(a.a)().imageCompression)return this.findFormat();var t;switch(e){case s.Texture.ALPHA:if((t=this.findFormat("A")).length>0)return t;break;case s.Texture.RGB:if((t=this.findFormat("RGB")).length>0)return t;if((t=this.findFormat("N")).length>0)return t;break;case s.Texture.LUMINANCE:if((t=this.findFormat("R")).length>0)return t;if((t=this.findFormat("RGB")).length>0)return t;if((t=this.findFormat("N")).length>0)return t}return this.findFormat()},findImageNearestPowerOfTwoUpToResolution:function(e,t,n){return this.findImageNearestUpToResolution(e,t,!0,n)},findImageNearestUpToResolution:function(e,t,n,i){for(var r,a,o=1/0,s=!1,c=1/0,h=this.getFilteredImages(i),d=0,f=h.length;d<f;++d){var p=h[d],g=u(e,t,p.width,p.height);if(g<o&&(o=g,r=p),!(p.width>e||p.height>t))if(n){var m=l(p);s&&!m||(!a||!s&&m||g<c||c===1/0&&p.width>a.width&&p.height>a.height)&&(a=p,s=m,c=g)}else(!a||g<c||c===1/0&&p.width>a.width&&p.height>a.height)&&(a=p,c=g)}return a||r},findImageSmallest:function(e){return this.findImageNearestToResolution(0,0,e)},findImageWidget:function(){return this.findImageNearestToResolution(0,0,s.Texture.RGB)},findImageNearestToResolution:function(e,t,n){for(var i,r=1/0,a=this.getFilteredImages(n),o=0,s=a.length;o<s;++o){var l=a[o],c=u(e,t,l.width,l.height);c<r&&(r=c,i=l)}return i}};t.a=c},vKVh:function(e,t){e.exports="float checkerboard(const in vec2 uv, const in vec4 halton) {\n    return mod(step(halton.z, 0.0) + floor(uv.x) + floor(uv.y), 2.0);\n}\n"},vLTl:function(e,t,n){n("jWd+"),(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/popups/email-confirmation.jinja"]={b_popup_content:function(e,t,n,i,r){var a="";try{n=n.push(!0),a+='\n\n    <div class="icon-wrapper">\n        <i class="fa fa-envelope"></i>\n    </div>\n    <div class="text">\n        <p>',a+=i.suppressValue(i.contextOrFrameLookup(t,n,"reason"),e.opts.autoescape),a+=".</p>\n        <p>If you haven't received your confirmation mail at <strong>",a+=i.suppressValue(i.contextOrFrameLookup(t,n,"email"),e.opts.autoescape),r(null,a+="</strong>, request a new one.</p>\n    </div>\n\n")}catch(e){r(i.handleError(e,null,null))}},b_popup_footer:function(e,t,n,i,r){var a="";try{n=n.push(!0),r(null,a+='\n\n    <div class="actions">\n        <button class="button btn-medium btn-tertiary" data-action="cancel">Cancel</button>\n        <button class="button btn-medium btn-primary" data-action="validate">Send me a new mail</button>\n    </div>\n\n')}catch(e){r(i.handleError(e,null,null))}},root:function(e,t,n,i,r){var a="";try{var o=null;e.getTemplate("skfb_front/layouts/popup.jinja",!0,"skfb_front/popups/email-confirmation.jinja",!1,function(s,u){if(s)r(s);else{for(var l in(o=u).blocks)t.addBlock(l,o.blocks[l]);var c,h;a+="\n\n",c="E-mail verification",n.set("popupTitle",c,!0),n.topLevel&&t.setVariable("popupTitle",c),n.topLevel&&t.addExport("popupTitle",c),a+="\n",h="popup-email-verification",n.set("popupClass",h,!0),n.topLevel&&t.setVariable("popupClass",h),n.topLevel&&t.addExport("popupClass",h),a+="\n\n",(o?function(e,t,n,i,r){r("")}:t.getBlock("popup_content"))(e,t,n,i,function(s,u){s?r(s):(a+=u,a+="\n\n",(o?function(e,t,n,i,r){r("")}:t.getBlock("popup_footer"))(e,t,n,i,function(s,u){s?r(s):(a+=u,a+="\n",o?o.rootRenderFunc(e,t,n,i,r):r(null,a))}))})}})}catch(e){r(i.handleError(e,null,null))}}}},vQSd:function(e,t,n){"use strict";var i=n("qRO0"),r=n("Qavt"),a=n("a3nb"),o=function(){i.a.call(this),this._parents=[],this._attributeArray=[],this._textureAttributeArrayList=[],this._activeTextureAttributeUnit=[],this._activeAttribute=[],this._activeTextureAttribute=[],this._binName=void 0,this._binNumber=0,this._shaderGeneratorPair=null,this._updateCallbackList=[],this.uniforms={},this._hasUniform=!1,this._drawID=-1};(o.AttributePair=function(e,t){this._object=e,this._value=t}).prototype={getShaderGeneratorName:function(){return this._object},getAttribute:function(){return this._object},getUniform:function(){return this._object},getValue:function(){return this._value}},a.a.createPrototypeObject(o,a.a.objectInherit(i.a.prototype,{setDrawID:function(e){this._drawID=e},getDrawID:function(){return this._drawID},getAttributePair:function(e,t){return new o.AttributePair(e,t)},addUniform:function(e,t){var n=void 0!==t?t:r.a.ON,i=e.getName();this.uniforms[i]=this.getAttributePair(e,n),this._hasUniform=!0},addParent:function(e){this._parents.push(e)},removeParent:function(e){var t=this._parents.indexOf(e);-1!==t&&this._parents.splice(t,1)},removeUniform:function(e){this.removeUniformByName(e.getName())},removeUniformByName:function(e){delete this.uniforms[e],this._hasUniform=!!window.Object.keys(this.uniforms).length},hasUniform:function(){return this._hasUniform},getUniform:function(e){var t=this.uniforms;if(t[e])return t[e].getAttribute()},getUniformList:function(){return this.uniforms},setTextureAttributeAndModes:function(e,t,n){this._setTextureAttribute(e,this.getAttributePair(t,void 0!==n?n:r.a.ON))},getNumTextureAttributeLists:function(){return this._textureAttributeArrayList.length},getTextureAttribute:function(e,t){var n=a.a.getTextureIdFromTypeMember(t);if(void 0!==n&&this._hasTextureAttribute(e,n)){var i=this._textureAttributeArrayList[e];return i[n]?i[n].getAttribute():void 0}},removeTextureAttribute:function(e,t){var n=a.a.getTextureIdFromTypeMember(t);void 0!==n&&this._hasTextureAttribute(e,n)&&(this._textureAttributeArrayList[e][n]=void 0,this._computeValidTextureUnit())},getAttribute:function(e){var t=a.a.getIdFromTypeMember(e);if(void 0!==t&&this._hasAttribute(t))return this._attributeArray[t].getAttribute()},setAttributeAndModes:function(e,t){this._setAttribute(this.getAttributePair(e,void 0!==t?t:r.a.ON))},setAttribute:function(e,t){this.setAttributeAndModes(e,t)},removeAttribute:function(e){var t=a.a.getIdFromTypeMember(e);this._hasAttribute(t)&&(this._attributeArray[t]=void 0,this._computeValidAttribute())},setRenderingHint:function(e){"OPAQUE_BIN"===e?this.setRenderBinDetails(0,"RenderBin"):"TRANSPARENT_BIN"===e?this.setRenderBinDetails(10,"DepthSortedBin"):this.setRenderBinDetails(0,"")},getUpdateCallbackList:function(){return this._updateCallbackList},removeUpdateCallback:function(e){var t=this._updateCallbackList.indexOf(e);if(-1!==t&&(this._updateCallbackList.splice(t,1),0===this._updateCallbackList.length))for(var n=this._parents,i=0,r=n.length;i<r;i++){var a=n[i];a.setNumChildrenRequiringUpdateTraversal(a.getNumChildrenRequiringUpdateTraversal()-1)}},requiresUpdateTraversal:function(){return!!this._updateCallbackList.length},addUpdateCallback:function(e){var t=Boolean(this._updateCallbackList.length);if(this._updateCallbackList.push(e),!t)for(var n=this._parents,i=0,r=n.length;i<r;i++){var a=n[i];a.setNumChildrenRequiringUpdateTraversal(a.getNumChildrenRequiringUpdateTraversal()+1)}},hasUpdateCallback:function(e){return-1!==this._updateCallbackList.indexOf(e)},setRenderBinDetails:function(e,t){this._binNumber=e,this._binName=t},getAttributeMap:function(){for(var e={},t=0,n=this._attributeArray.length;t<n;t++){var i=this._attributeArray[t];if(i)e[i.getAttribute().getTypeMember()]=i}return e},getBinNumber:function(){return this._binNumber},getBinName:function(){return this._binName},setBinNumber:function(e){this._binNumber=e},setBinName:function(e){this._binName=e},getAttributeList:function(){for(var e=this._attributeArray,t=[],n=0,i=e.length;n<i;n++)e[n]&&t.push(e[n]);return t},setShaderGeneratorName:function(e,t){this._shaderGeneratorPair=this.getAttributePair(e,void 0!==t?t:r.a.ON)},getShaderGeneratorPair:function(){return this._shaderGeneratorPair},getShaderGeneratorName:function(){return this._shaderGeneratorPair?this._shaderGeneratorPair.getShaderGeneratorName():void 0},releaseGLObjects:function(){for(var e=0,t=this._textureAttributeArrayList.length;e<t;e++){var n=this.getTextureAttribute(e,"Texture");n&&n.releaseGLObjects()}for(var i=this.getAttributeList(),r=0,a=i.length;r<a;r++)i[r]._object.releaseGLObjects&&i[r]._object.releaseGLObjects()},_setTextureAttribute:function(e,t){a.a.arrayDense(e,this._textureAttributeArrayList),this._textureAttributeArrayList[e]||(this._textureAttributeArrayList[e]=[]);var n=a.a.getOrCreateTextureStateAttributeTypeMemberIndex(t.getAttribute());a.a.arrayDense(n,this._textureAttributeArrayList[e]),this._textureAttributeArrayList[e][n]=t,this._computeValidTextureUnit()},_computeValidTextureUnit:function(){this._activeTextureAttributeUnit.length=0,this._activeTextureAttribute.length=0;for(var e=this._textureAttributeArrayList,t=0,n=e.length;t<n;t++){var i=e[t];if(i&&i.length){for(var r=!1,a=0,o=i.length;a<o;a++)i[a]&&(r=!0,-1===this._activeTextureAttribute.indexOf(a)&&this._activeTextureAttribute.push(a));r&&this._activeTextureAttributeUnit.push(t)}}},_computeValidAttribute:function(){this._activeAttribute.length=0;for(var e=this._attributeArray,t=0,n=e.length;t<n;t++)e[t]&&this._activeAttribute.push(t)},_setAttribute:function(e){var t=a.a.getOrCreateStateAttributeTypeMemberIndex(e.getAttribute());a.a.arrayDense(t,this._attributeArray),this._attributeArray[t]=e,this._computeValidAttribute()},_hasAttribute:function(e){return!(e>=this._attributeArray.length)&&!!this._attributeArray[e]},_hasTextureAttribute:function(e,t){return!(e>=this._textureAttributeArrayList.length||!this._textureAttributeArrayList[e])&&(!(t>=this._textureAttributeArrayList[e].length)&&!!this._textureAttributeArrayList[e][t])}}),"osg","StateSet"),t.a=o},vcgX:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Qavt"),a=n("/QLk"),o=n("czSk"),s=function(e,t){r.a.call(this);var n=void 0!==e?e:0;this._ambient=o.g.fromValues(.2,.2,.2,1),this._diffuse=o.g.fromValues(.8,.8,.8,1),this._specular=o.g.fromValues(.2,.2,.2,1),this._position=o.g.fromValues(0,0,1,0),this._direction=o.f.fromValues(0,0,-1),this._ground=o.g.fromValues(.2,.2,.2,-1),this._spotCutoff=180,this._spotBlend=.01,this._attenuation=o.g.fromValues(1,0,0,0),this._lightNumber=n,this._enable=!t,this._dirtyHash=!0,this._hash=""};s.DIRECTION="DIRECTION",s.SPOT="SPOT",s.POINT="POINT",s.HEMI="HEMI",s.uniforms={},i.a.createPrototypeStateAttribute(s,i.a.objectInherit(r.a.prototype,{attributeType:"Light",cloneType:function(){return new s(this._lightNumber,!0)},getTypeMember:function(){return this.attributeType+this._lightNumber},getUniformName:function(e){return"u"+this.getTypeMember()+"_"+e},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!1,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+this.getLightType()+this.isEnabled().toString()},getOrCreateUniforms:function(){var e=s,t=this.getTypeMember();return e.uniforms[t]?e.uniforms[t]:(e.uniforms[t]={viewPosition:a.a.createFloat4(this.getUniformName("viewPosition")),viewDirection:a.a.createFloat3(this.getUniformName("viewDirection")),modelViewMatrix:a.a.createMatrix4(this.getUniformName("modelViewMatrix")),modelViewNormalMatrix:a.a.createMatrix3(this.getUniformName("modelViewNormalMatrix")),ambient:a.a.createFloat4(this.getUniformName("ambient")),diffuse:a.a.createFloat4(this.getUniformName("diffuse")),specular:a.a.createFloat4(this.getUniformName("specular")),attenuation:a.a.createFloat4(this.getUniformName("attenuation")),spotCutOff:a.a.createFloat1(this.getUniformName("spotCutOff")),spotBlend:a.a.createFloat1(this.getUniformName("spotBlend")),ground:a.a.createFloat4(this.getUniformName("ground"))},e.uniforms[t])},isEnabled:function(){return this._enable},setEnabled:function(e){this._enable=e,this._dirtyHash=!0},setAmbient:function(e){o.g.copy(this._ambient,e)},getAmbient:function(){return this._ambient},setDiffuse:function(e){o.g.copy(this._diffuse,e)},getDiffuse:function(){return this._diffuse},setSpecular:function(e){o.g.copy(this._specular,e)},getSpecular:function(){return this._specular},setPosition:function(e){o.g.copy(this._position,e)},getPosition:function(){return this._position},setDirection:function(e){o.f.copy(this._direction,e)},getDirection:function(){return this._direction},setSpotCutoff:function(e){this._spotCutoff=e},getSpotCutoff:function(){return this._spotCutoff},setSpotBlend:function(e){this._spotBlend=e},getSpotBlend:function(){return this._spotBlend},setGround:function(e){o.f.copy(this._ground,e)},getGround:function(){return this._ground},setConstantAttenuation:function(e){this._attenuation[0]=e},getConstantAttenuation:function(){return this._attenuation[0]},setLinearAttenuation:function(e){this._attenuation[1]=e},getLinearAttenuation:function(){return this._attenuation[1]},setQuadraticAttenuation:function(e){this._attenuation[2]=e},getQuadraticAttenuation:function(){return this._attenuation[2]},setLightType:function(e){return e===s.DIRECTION?this.setLightAsDirection():e===s.SPOT?this.setLightAsSpot():e===s.HEMI?this.setLightAsHemi():this.setLightAsPoint()},getLightType:function(){return this.isDirectionLight()?s.DIRECTION:this.isSpotLight()?s.SPOT:this.isHemiLight()?s.HEMI:s.POINT},setLightAsSpot:function(){o.g.set(this._position,0,0,0,1),o.f.set(this._direction,0,0,-1),this._ground[3]=-1,this._spotCutoff=90,this._dirtyHash=!0},setLightAsPoint:function(){o.g.set(this._position,0,0,0,1),o.f.set(this._direction,0,0,-1),this._ground[3]=-1,this._dirtyHash=!0},setLightAsDirection:function(){o.g.set(this._position,0,0,1,0),this._spotCutoff=180,this._ground[3]=-1,this._dirtyHash=!0},setLightAsHemi:function(){o.g.set(this._position,0,0,1,0),this._spotCutoff=180,this._ground[3]=1,this._dirtyHash=!0},setLightNumber:function(e){this._lightNumber=e,this._dirtyHash=!0},getLightNumber:function(){return this._lightNumber},isSpotLight:function(){return this._spotCutoff<180},isDirectionLight:function(){return 0===this._position[3]&&-1===this._ground[3]},isHemiLight:function(){return 1===this._ground[3]},applyPositionedUniform:function(e){var t=this.getOrCreateUniforms(),n=t.modelViewMatrix.getInternalArray(),i=t.modelViewNormalMatrix.getInternalArray(),r=t.viewPosition.getInternalArray(),a=t.viewDirection.getInternalArray();o.c.copy(n,e),o.b.normalFromMat4(i,e),o.g.transformMat4(r,this._position,n),o.f.transformMat3(a,this._direction,i)},apply:function(){if(this._enable){var e=this.getOrCreateUniforms();if(this.isSpotLight()){var t=Math.cos(this._spotCutoff*Math.PI/180);e.spotCutOff.setFloat(t),e.spotBlend.setFloat((1-t)*this._spotBlend)}this.isHemiLight()&&e.ground.setFloat4(this._ground),e.attenuation.setFloat4(this._attenuation),e.diffuse.setFloat4(this._diffuse),e.specular.setFloat4(this._specular),e.ambient.setFloat4(this._ambient)}}}),"osg","Light"),t.a=s},vnIN:function(e,t,n){"use strict";var i=n("a3nb"),r=n("Qavt"),a=n("/QLk"),o=function(e,t){r.a.call(this),this._enable=!e,this._boneUniformSize=t,this._dirtyHash=!0,this._hash=""};o.uniforms={},o.maxBoneUniformSize=1,o.maxBoneUniformAllowed=1/0,i.a.createPrototypeStateAttribute(o,i.a.objectInherit(r.a.prototype,{attributeType:"Skinning",cloneType:function(){return new o(!0)},getBoneUniformSize:function(){return void 0!==this._boneUniformSize?this._boneUniformSize:o.maxBoneUniformSize},getOrCreateUniforms:function(){var e=o,t=this.getBoneUniformSize();return e.uniforms[t]?e.uniforms[t]:(e.uniforms[t]={uBones:a.a.createFloat4Array("uBones",t)},e.uniforms[t])},setMatrixPalette:function(e){this._matrixPalette=e,void 0===this._boneUniformSize&&(o.maxBoneUniformSize=Math.max(o.maxBoneUniformSize,e.length/4),o.maxBoneUniformSize=Math.min(o.maxBoneUniformAllowed,o.maxBoneUniformSize))},getMatrixPalette:function(){return this._matrixPalette},isEnabled:function(){return this._enable},getHash:function(){return this._dirtyHash?(this._hash=this._computeInternalHash(),this._dirtyHash=!0,this._hash):this._hash},_computeInternalHash:function(){return this.getTypeMember()+this.getBoneUniformSize()+this.isEnabled()},apply:function(){this._enable&&this.getOrCreateUniforms().uBones.getInternalArray().set(this._matrixPalette)}}),"osgAnimation","SkinningAttribute"),t.a=o},w0gJ:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return o});var i=n("XsDm");function r(e,t,n){return e.filter(n)[0]||t}function a(e){return Array.prototype.slice.call(e)}function o(e,t){var n=e.find(function(e){return Boolean(t(e))});return void 0===n?i.a:Object(i.b)(n)}},w3fr:function(e,t,n){"use strict";var i=n("QLQS"),r=n("fgaA"),a=i.a.osg;t.a=function(){var e=a.WebGLCaps.instance().getWebGLParameter("MAX_TEXTURE_IMAGE_UNITS");return Math.min(e,Object(r.a)().maxTextureUnits)}},wDbS:function(e,t,n){"use strict";n.r(t);var i=n("a3nb"),r=n("Qavt"),a=n("czSk"),o=n("/QLk"),s=function(){r.a.call(this),this._ambient=a.g.fromValues(.2,.2,.2,1),this._diffuse=a.g.fromValues(.8,.8,.8,1),this._specular=a.g.fromValues(0,0,0,1),this._emission=a.g.fromValues(0,0,0,1),this._shininess=12.5};i.a.createPrototypeStateAttribute(s,i.a.objectInherit(r.a.prototype,{attributeType:"Material",cloneType:function(){return new s},getParameterName:function(e){return"u"+this.getType()+"_"+e},getOrCreateUniforms:function(){var e=s;return e.uniforms?e.uniforms:(e.uniforms={ambient:o.a.createFloat4("uMaterialAmbient"),diffuse:o.a.createFloat4("uMaterialDiffuse"),specular:o.a.createFloat4("uMaterialSpecular"),emission:o.a.createFloat4("uMaterialEmission"),shininess:o.a.createFloat1("uMaterialShininess")},e.uniforms)},setEmission:function(e){a.g.copy(this._emission,e)},getEmission:function(){return this._emission},setAmbient:function(e){a.g.copy(this._ambient,e)},getAmbient:function(){return this._ambient},setSpecular:function(e){a.g.copy(this._specular,e)},getSpecular:function(){return this._specular},setDiffuse:function(e){a.g.copy(this._diffuse,e)},getDiffuse:function(){return this._diffuse},setShininess:function(e){this._shininess=e},getShininess:function(){return this._shininess},setTransparency:function(e){this._diffuse[3]=1-e},getTransparency:function(){return this._diffuse[3]},apply:function(){var e=this.getOrCreateUniforms();e.ambient.setFloat4(this._ambient),e.diffuse.setFloat4(this._diffuse),e.specular.setFloat4(this._specular),e.emission.setFloat4(this._emission),e.shininess.setFloat(this._shininess)}}),"osg","Material"),t.default=s},wHZf:function(e,t,n){"use strict";var i=n("8348");n.d(t,"createEffectMiddleware",function(){return i.a});var r=n("Ou4k");n.d(t,"EffectContext",function(){return r.a});var a=n("oYSw");n.d(t,"optimistic",function(){return a.a});var o=n("h16v");n.o(o,"EffectStatus")&&n.d(t,"EffectStatus",function(){return o.EffectStatus}),n.o(o,"Pending")&&n.d(t,"Pending",function(){return o.Pending}),n.o(o,"Rejected")&&n.d(t,"Rejected",function(){return o.Rejected}),n.o(o,"Resolved")&&n.d(t,"Resolved",function(){return o.Resolved}),n.o(o,"clientOnly")&&n.d(t,"clientOnly",function(){return o.clientOnly}),n.o(o,"isEffect")&&n.d(t,"isEffect",function(){return o.isEffect});var s=n("wWmz");n.d(t,"EffectStatus",function(){return s.a}),n.d(t,"Pending",function(){return s.b}),n.d(t,"Rejected",function(){return s.c}),n.d(t,"Resolved",function(){return s.d});var u=n("uoDY");n.d(t,"clientOnly",function(){return u.a}),n.d(t,"isEffect",function(){return u.b})},wMJb:function(e,t){e.exports='#define NO_JITTER\n#pragma include "base.vert"\n'},wWmz:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return c});var i,r=n("lwsE"),a=n.n(r),o=n("lSNA"),s=n.n(o);!function(e){e.Pending="Pending",e.Resolved="Resolved",e.Rejected="Rejected"}(i||(i={}));var u=function e(){a()(this,e),s()(this,"type",i.Pending),s()(this,"caseOf",function(e){return e.Pending()}),s()(this,"map",function(){return this})},l=function e(t){a()(this,e),this.value=t,s()(this,"type",i.Rejected),s()(this,"caseOf",function(e){return e.Rejected(this.value)}),s()(this,"map",function(){return this})},c=function e(t){a()(this,e),this.value=t,s()(this,"type",i.Resolved),s()(this,"caseOf",function(e){return e.Resolved(this.value)}),s()(this,"map",function(t){return new e(t(this.value))})}},wgeW:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"b",function(){return d});var i=n("lwsE"),r=n.n(i),a=n("W8MJ"),o=n.n(a),s=n("lSNA"),u=n.n(s),l=function(){function e(t){r()(this,e),this.value=t,u()(this,"tag","Left")}return o()(e,[{key:"map",value:function(t){return new e(this.value)}},{key:"mapLeft",value:function(t){return new e(t(this.value))}},{key:"caseOf",value:function(e){return e.Left(this.value)}},{key:"reduce",value:function(e,t){return t}},{key:"chain",value:function(t){return new e(this.value)}}]),e}(),c=function(){function e(t){r()(this,e),this.value=t,u()(this,"tag","Right")}return o()(e,[{key:"map",value:function(t){return new e(t(this.value))}},{key:"mapLeft",value:function(t){return new e(this.value)}},{key:"caseOf",value:function(e){return e.Right(this.value)}},{key:"reduce",value:function(e,t){return e(t,this.value)}},{key:"chain",value:function(e){return e(this.value)}}]),e}(),h=function(e){return new l(e)},d=function(e){return new c(e)}},wsGC:function(e,t,n){"use strict";n.d(t,"d",function(){return d}),n.d(t,"f",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"h",function(){return g}),n.d(t,"a",function(){return m}),n.d(t,"c",function(){return v});var i=n("J4zp"),r=n.n(i),a=n("HiDb"),o=n("Ui7z"),s=n("orRi"),u=n.n(s);n.d(t,"b",function(){return u.a});var l=n("1oLb"),c=n.n(l);n.d(t,"g",function(){return c.a});var h=n("f4yh"),d=function(e){var t=e.width,n=void 0===t?window.innerWidth:t,i=e.breakpoint;return n<=parseInt(c.a[i])},f=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.innerWidth)<=parseInt(c.a.responsiveBreakpointXSmall)},p=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.innerWidth)<=parseInt(c.a.breakpointXSmall)},g=function(e){var t=Object(h.a)(),n=r()(t,1)[0];return d({width:n,breakpoint:e})},m=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(a.a)(t,function(e){return Object(o.f)(e)?Object(a.a)(Object.keys(e),function(t){return e[t]?[t]:[]}):Array.isArray(e)?e:e?[e]:[]}).join(" ")},v=function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;if(e/t<n/i){var a=t*n/e+r;return{width:n+r,height:a,x:0,y:-Math.abs(a-i)/2||0}}var o=e*i/t+r;return{width:o,height:i+r,x:-Math.abs(o-n)/2||0,y:0}}},wwK1:function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vTexCoord0;\n\n// uniform mat4 uModelMatrix;\n// uniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat4 uModelViewMatrix;\n\nvoid main(void) {\n  vTexCoord0 = TexCoord0;\n  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex.xyz, 1.0);\n}\n"},wwkN:function(e,t,n){"use strict";var i=n("a3nb"),r=n("icjm"),a=n("Vx0a"),o=n("AwiE"),s=n("OZCL"),u=n("Q7Tl"),l=n("kKFa"),c=function(){a.a.call(this),this._attributes={},this._primitives=[],this._cacheDrawCall={},this._useVAO=void 0,this._vao={},this._cacheVertexAttributeBufferList={},this._shape=void 0};c.enableVAO=!0,i.a.createPrototypeNode(c,i.a.objectInherit(a.a.prototype,{releaseGLObjects:function(){for(var e in void 0!==this.stateset&&this.stateset.releaseGLObjects(),this._attributes){this._attributes[e].releaseGLObjects()}for(var t=0,n=this._primitives.length;t<n;t++){var i=this._primitives[t];void 0!==i.getIndices&&void 0!==i.getIndices()&&null!==i.getIndices()&&i.indices.releaseGLObjects()}this.releaseVAO()},releaseVAO:function(){if(this._useVAO&&this._glContext)for(var e in this._vao)this._vao[e]&&(this._vao[e].releaseGLObjects(),this._vao[e]=void 0)},dirty:function(){this._cacheDrawCall={},this.releaseVAO()},getPrimitives:function(){return this.getPrimitiveSetList()},getAttributes:function(){return this.getVertexAttributeList()},getShape:function(){return this._shape},setShape:function(e){this._shape=e},getVertexAttributeList:function(){return this._attributes},getPrimitiveSetList:function(){return this._primitives},setVertexAttribArray:function(e,t){this._attributes[e]!==t&&(this._attributes[e]=t,this.dirty())},_generateVertexSetup:function(e,t,n){for(var i=["//generated by Geometry::implementation","state.lazyDisablingOfVertexAttributes();","var attr;"],r=0,a=e.length;r<a;r++)i.push("attr = this._attributes['"+e[r]+"'];"),i.push("if ( attr.BufferArrayProxy ) attr = attr.getBufferArray();"),i.push("if ( !attr.isValid() ) return;"),i.push("state.setVertexAttribArray("+t[r]+", attr, attr.getNormalize() );");return i.push("state.applyDisablingOfVertexAttributes();"),n&&i.push("state.setIndexArray( this._primitives[ 0 ].getIndices() );"),i},_generatePrimitives:function(e,t,n){var i=[t?"state.enableVertexColor();":"state.disableVertexColor();"];if(n)return i.concat(["var primitive = this._primitives[ "+e[0]+" ];","var indexes = primitive.getIndices();","if ( indexes.isDirty() ) {;","  indexes.bind( gl );","  indexes.compile( gl );","};","primitive.drawElements( state );"]);i.push("var primitives = this._primitives;");for(var r=0,a=e.length;r<a;r++)i.push("primitives["+e[r]+"].draw(state);");return i},generateDrawCommand:function(){var e=[],t=[];return function(n,i,r,a){var o,c,h,d=i._attributesCache,f=this.getVertexAttributeList();t.length=0,e.length=0;var p,g,m=this._useVAO,v=m?[]:void 0,_=!1;for(var b in d)if(o=d[b],void 0!==f[b]){var S=this._attributes[b];if(S instanceof u.a&&(S=S.getBufferArray(),m=!1),!S.isValid())return;m&&v.push(S),_||"Color"!==b||(_=!0),t.push(b),e.push(o)}if(m){this._cacheVertexAttributeBufferList[r]=v;var y=1===a.length&&this._primitives[a[0]]instanceof s.a,x=this._generateVertexSetup(t,e,y);n.clearVertexAttribCache();var C=n.getGraphicContext(),w=new l.a(C);w.create(C),n.setVertexArrayObject(w),this._vao[r]=w,new Function("state",x.join("\n")).call(this,n);var T=["var gl = state.getGraphicContext();","var vao = this._vao[ "+r+" ] ","var hasChanged = state.setVertexArrayObject( vao );","if ( hasChanged ) {","  var vaList = this._cacheVertexAttributeBufferList[ "+r+" ];","  var va;"];for(c=0,h=v.length;c<h;c++)T.push("  va = vaList[ "+c+"];"),T.push("  if ( va.isDirty() ) {;"),T.push("    va.bind( gl );"),T.push("    va.compile( gl );"),T.push("  };");T.push("}"),p=T.concat(this._generatePrimitives(a,_,y)).join("\n"),g="GeometryDrawImplementationCacheVAO"}else p=this._generateVertexSetup(t,e,!1).concat(this._generatePrimitives(a,_,!1)).join("\n"),g="GeometryDrawImplementationCache";var M=new Function("state","return function "+g+"( state ) { "+p+"}")();return this._cacheDrawCall[r]=M,M}}(),_getValidPrimitives:function(){for(var e=[],t=0;t<this._primitives.length;t++){this._primitives[t].getCount()?e.push(t):this._warnInvalidPrimitives||(r.a.warn("geometry with instanceID "+this._instanceID+" has invalid primitives"),this._warnInvalidPrimitives=!0)}return e},drawImplementation:function(e){var t=e.getLastProgramApplied(),n=t.getInstanceID();e.drawGeometry(this);var i=this._cacheDrawCall[n];if(this._vao[n]?this._vao[n].isDirty()&&(i=void 0):e.setVertexArrayObject(null),i)i.call(this,e);else if(this._primitives.length){var a=this._getValidPrimitives();a.length&&(void 0===this._useVAO&&c.enableVAO&&(this._useVAO=o.a.instance().hasVAO(),this._glContext=e.getGraphicContext()),(i=this.generateDrawCommand(e,t,n,a)).call(this,e),e.setVertexArrayObject(null))}else this._warnNoPrimitives||(r.a.warn("geometry with instanceID "+this._instanceID+" has no primitives"),this._warnNoPrimitives=!0)},setBound:function(e){this._boundingBox=e,this._boundingBoxComputed=!0},computeBoundingBox:function(e){e.init();var t=e.getMin(),n=e.getMax(),i=this.getVertexAttributeList().Vertex;if(i&&i.getElements()&&i.getItemSize()>2){for(var r=i.getElements(),a=i.getItemSize(),o=t[0],s=t[1],u=t[2],l=n[0],c=n[1],h=n[2],d=0,f=r.length;d<f;d+=a){var p=r[d],g=r[d+1],m=r[d+2];p<o&&(o=p),p>l&&(l=p),g<s&&(s=g),g>c&&(c=g),m<u&&(u=m),m>h&&(h=m)}t[0]=o,t[1]=s,t[2]=u,n[0]=l,n[1]=c,n[2]=h}if(this._displacementFactor){t=e.getMin(),n=e.getMax();var v=this._displacementFactor;t[0]-=v,t[1]-=v,t[2]-=v,n[0]+=v,n[1]+=v,n[2]+=v}return e},computeBoundingSphere:function(e){return e.init(),e.expandByBoundingBox(this.getBoundingBox()),this._displacementFactor&&e.set(e.center(),e.radius()+this._displacementFactor),e}}),"osg","Geometry"),c.appendVertexAttributeToList=function(e,t,n){for(var i in e){var r=i;void 0!==n&&(r+="_"+n),t[r]=e[i]}},t.a=c},x17P:function(e,t){e.exports="uniform sampler2D TextureTransparent;\n\nvec4 combineOpacity(const in vec4 color) {\n\t// should be replaced with TEXTURE_2D_TextureTransparent as is can make sense\n    vec4 transparent = TEXTURE_2D_TextureTransparent(gTexCoord);\n    return vec4(color.rgb * (1.0 - transparent.a) + transparent.rgb, 1.0);\n}"},x2jA:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return u}),n.d(t,"k",function(){return h}),n.d(t,"c",function(){return d}),n.d(t,"o",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"b",function(){return g}),n.d(t,"m",function(){return m}),n.d(t,"n",function(){return v}),n.d(t,"a",function(){return _}),n.d(t,"d",function(){return b}),n.d(t,"f",function(){return S}),n.d(t,"j",function(){return y}),n.d(t,"l",function(){return x});var i=n("J4zp"),r=n.n(i),a=n("8vnj");n("qAkX");function o(e){return e?String(e).split("").reduce(function(e,t,n,i){var r=i.length-n;return e+(!n||r%3?t:","+t)},""):"0"}function s(e){var t=e/100;if(Object(a.a)(t))return"$"+o(t);var n=String(Math.round(e)).split(""),i=n.filter(function(e,t){return t>=n.length-2}).join(""),r=n.filter(function(e,t){return t<n.length-2}).join("");return"$".concat(o(r||"0"),".").concat(i.length<2?"0":"").concat(i)}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).numberOnly,n=void 0!==t&&t;return g(0,5,Math.round(10*Number(e))/10)+(n?"":"/5")}function l(e,t){if(t<=0)return e;var n=Math.pow(10,t),i=e*n;return Math.round(i)/n}var c=["k","M","B","T","P"];function h(e){if(!e||"null"===e||"0"===e)return"0";var t="string"==typeof e?parseFloat(e):e,n=[3,6,9,12,15];if(Object.is(t,NaN))return"Unknown";var i=t<0?"-":"",r=Math.abs(t);if(r<1e3)return"".concat(t);for(var a=0,o=n.length;a<o;++a){var s=l(r/Math.pow(10,n[a]),1);if(s<1e3){var u=Math.floor(s);return s!==u?i+s+c[a]:i+u+c[a]}}return t<0?"1000- P":"1000+ P"}function d(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t}function f(e,t,n){return(n-e)/(t-e)}function p(e,t,n){return n*(t-e)+e}function g(e,t,n){return Math.max(e,Math.min(t,n))}function m(e,t,n){var i=r()(e,2),a=i[0],o=i[1],s=r()(t,2),u=s[0],l=s[1];return u+function(e,t,n){return(g(e,t,n)-e)/(t-e)}(a,o,n)*(l-u)}function v(e,t){var n=t||1;return Math.round(e/n)*n}function _(e){return e.reduce(function(t,n){return t+n/e.length},0)}function b(e,t,n){if(!e.length)return null;if(1===e.length)return e[0];var i=n||{},r=function(n){return i[n]=void 0===i[n]?t(e[n]):i[n],i[n]};if(2===e.length)return Math.abs(r(0))<Math.abs(r(1))?e[0]:e[1];var a=Math.floor(e.length/2);return b(r(a)>0?e.slice(0,a+1):e.slice(a),t,i)}var S={linear:function(e){return e},easeInQuad:function(e){return e*e},easeInCubic:function(e){return e*e*e}};function y(e){var t=Math.floor(e),n=Math.floor(e/1024),i=Math.floor(e/1048576),r=Math.floor(e/1073741824);return r?r+"GB":i?i+"MB":n?n+"kB":t+"B"}function x(e,t,n){return e.start===t&&e.end>=n?"Any":e.start===t?"Up to "+h(e.end):e.start>=n?h(e.start)+"+":h(e.start)+" to "+h(e.end)}},xM9Z:function(e,t,n){"use strict";(function(e){var i=n("EVdn"),r=n.n(i),a=n("CpTu"),o=Object(a.a)({WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},function(e,t){return t in document.body.style});t.a=function(t){return new e(function(e){return r()(t).one(o,e)})}}).call(this,n("CSL1"))},xPCe:function(e,t,n){e.exports=n.p+"static/assets/images/editor/Direction-da0354ccc70bc3322aa657cdcd356e39.png"},xTlW:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"c",function(){return f}),n.d(t,"a",function(){return p});var i=n("gcR/"),r=n.n(i),a=n("12sq"),o=(n("q1tI"),n("/MKj")),s=n("M4AY"),u=n("gPpI"),l=n("wsGC"),c=n("gBaA"),h=n("/f4T");function d(e){var t=e.className,n=e.redirectUrl,i=e.usageType,a=Object(o.d)();return r()(h.a,{"data-selenium":"login",size:"medium",type:"ninja",href:Object(u.e)("users:signin"),className:Object(l.a)("skfb-link",t),onClick:function(e){e.preventDefault(),e.stopPropagation(),a(s.a.authUser.authenticate(function(){},{redirectUrl:n,usageType:i,initialForm:"login"}))},text:"Login"})}function f(e){var t=e.className,n=e.redirectUrl,i=e.usageType,a=e.disabled,l=Object(o.d)(),c=Object(o.e)(s.c.authUser.canAccessFeature("ff_read_only_mode"));return r()(h.a,{"data-selenium":"signup",size:"medium",type:"primary",href:Object(u.e)("users:signup"),className:t,onClick:function(e){e.preventDefault(),e.stopPropagation(),l(s.a.authUser.authenticate(function(){},{redirectUrl:n,usageType:i,initialForm:"signup"}))},text:"Sign Up",disabled:c||a})}function p(e){var t=e.className,n=Object(o.d)();return Object(o.e)(s.c.authUser.isAuthenticated)?r()(h.a,{size:"medium",type:"store",href:"".concat(a.a.hosts.faq,"/articles/115004259063-Selling-3D-Models?utm_source=website&utm_campaign=header"),className:t,text:"Become a seller"}):r()(h.a,{size:"medium",type:"store",href:Object(u.e)("users:signup",{},{next:"/store"}),className:t,onClick:function(e){e.preventDefault(),e.stopPropagation(),c.a.headerStoreSellerSignupButtonClicked(),n(s.a.authUser.authenticate(function(){},{initialForm:"signup"}))},text:"Become a seller"})}},xVfI:function(e,t,n){"use strict";var i=n("czSk"),r=n("icjm"),a=n("qRO0"),o=n("ip6O"),s=n("Qavt"),u=n("b/No"),l=n("N3k8"),c=n("/QLk"),h=n("a3nb"),d=n("AwiE"),f=n("1D44"),p=n("v+9t"),g=n("jTTs"),m=function(){this._stateClearColor={buffer:{red:0,green:0,blue:0,alpha:0},state:{red:void 0,green:void 0,blue:void 0,alpha:void 0},changed:!0},this._stateClearDepth={buffer:{value:1},state:{value:void 0},changed:!0},this._stateDepthMask={state:{value:!0},buffer:{value:void 0},changed:!0},this._stateViewport={buffer:{x:0,y:0,width:640,height:480},state:{x:void 0,y:void 0,width:void 0,height:void 0},changed:!0},this._stateColorMask={buffer:{red:!0,green:!0,blue:!0,alpha:!0},state:{red:void 0,green:void 0,blue:void 0,alpha:void 0},changed:!0},this._stateScissor={buffer:{enable:!1,x:0,y:0,width:640,height:480},state:{enable:!1,x:void 0,y:void 0,width:void 0,height:void 0},changed:!0},this._stateDepth={buffer:{func:f.a.LESS,enable:!1,near:0,far:1},state:{func:void 0,enable:!1,near:void 0,far:void 0},changed:!0},this._stateCullFace={buffer:{enable:!1,mode:g.a.BACK},state:{enable:!1,mode:void 0},changed:!0},this._stateBlendFunc={buffer:{separate:!1,enable:!1,sourceFactor:p.a.ONE,destinationFactor:p.a.ZERO,sourceFactorAlpha:p.a.ONE,destinationFactorAlpha:p.a.ZERO},state:{separate:void 0,enable:!1,sourceFactor:void 0,destinationFactor:void 0,sourceFactorAlpha:void 0,destinationFactorAlpha:void 0},changed:!0}};m.prototype={clearColor:function(e){var t=this._stateClearColor,n=t.buffer,i=t.state;t.changed=!1,n.red=e[0],n.green=e[1],n.blue=e[2],n.alpha=e[3],i.red===e[0]&&i.green===e[1]&&i.blue===e[2]&&i.alpha===e[3]||(t.changed=!0)},applyClearColor:function(e){var t=this._stateClearColor,n=t.state,i=t.buffer;t.changed=!1,n.red=i.red,n.green=i.green,n.blue=i.blue,n.alpha=i.alpha,e.clearColor(n.red,n.green,n.blue,n.alpha)},clearDepth:function(e){var t=this._stateClearDepth,n=t.buffer,i=t.state;t.changed=!1,n.value=e,i.value!==e&&(t.changed=!0)},applyClearDepth:function(e){var t=this._stateClearDepth,n=t.buffer,i=t.state;t.changed=!1,i.value=n.value,e.clearDepth(i.value)},depthMask:function(e){var t=this._stateDepthMask,n=t.buffer,i=t.state;t.changed=!1,n.value=e,i.value!==e&&(t.changed=!0)},applyDepthMask:function(e){var t=this._stateDepthMask,n=t.buffer,i=t.state;t.changed=!1,i.value=n.value,e.depthMask(i.value)},applyViewportAttribute:function(e){this.viewport(e._x,e._y,e._width,e._height)},viewport:function(e,t,n,i){var r=this._stateViewport,a=r.buffer,o=r.state;r.changed=!1,a.x=e,a.y=t,a.width=n,a.height=i,o.x===e&&o.y===t&&o.width===n&&o.height===i||(r.changed=!0)},applyViewport:function(e){var t=this._stateViewport,n=t.buffer,i=t.state;t.changed=!1,i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height,e.viewport(i.x,i.y,i.width,i.height)},applyColorMaskAttribute:function(e){var t=this._stateColorMask,n=t.buffer,i=t.state;t.changed=!1,n.red=e._red,n.green=e._green,n.blue=e._blue,n.alpha=e._alpha,i.red===e._red&&i.green===e._green&&i.blue===e._blue&&i.alpha===e._alpha||(t.changed=!0)},applyColorMask:function(e){var t=this._stateColorMask,n=t.buffer,i=t.state;t.changed=!1,i.red=n.red,i.green=n.green,i.blue=n.blue,i.alpha=n.alpha,e.colorMask(i.red,i.green,i.blue,i.alpha)},applyScissorAttribute:function(e){var t=-1!==e._x,n=this._stateScissor,i=n.buffer,r=n.state;n.changed=!1,i.enable=t,i.x=e._x,i.y=e._y,i.width=e._width,i.height=e._height,r.enable===t&&r.x===e._x&&r.y===e._y&&r.width===e._width&&r.height===e._height||(n.changed=!0)},applyScissor:function(e){var t=this._stateScissor,n=t.buffer,i=t.state;t.changed=!1,i.enable!==n.enable&&(i.enable=n.enable,i.enable?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST)),i.enable&&(i.x===n.x&&i.y===n.y&&i.width===n.width&&i.height===n.height||(i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height,e.scissor(i.x,i.y,i.width,i.height)))},applyCullFaceAttribute:function(e){var t=this._stateCullFace,n=t.buffer,i=t.state,r=e._mode!==g.a.DISABLE;t.changed=!1,n.enable=r,n.mode=e._mode,i.enable===r&&i.mode===e._mode||(t.changed=!0)},applyCullFace:function(e){var t=this._stateCullFace,n=t.buffer,i=t.state;t.changed=!1,i.enable!==n.enable&&(i.enable=n.enable,i.enable?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE)),i.enable&&i.mode!==n.mode&&(i.mode=n.mode,e.cullFace(i.mode))},applyDepthAttribute:function(e){var t=e._func!==f.a.DISABLE,n=this._stateDepth,i=n.buffer,r=n.state;n.changed=!1,i.enable=t,i.func=e._func,i.far=e._far,i.near=e._near,r.enable===t&&r.func===e._func&&r.near===e._near&&r.far===e._far||(n.changed=!0),this.depthMask(e._writeMask)},applyDepth:function(e){var t=this._stateDepth,n=t.buffer,i=t.state;t.changed=!1,i.enable!==n.enable&&(i.enable=n.enable,i.enable?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST)),i.enable&&(i.func!==n.func&&(i.func=n.func,e.depthFunc(i.func)),i.near===n.near&&i.far===n.far||(i.far=n.far,i.near=n.near,e.depthRange(i.near,i.far)))},applyBlendFuncAttribute:function(e){var t=this._stateBlendFunc,n=t.buffer,i=t.state,r=e._sourceFactor!==p.a.DISABLE&&e._destinationFactor!==p.a.DISABLE;t.changed=!1,n.enable=r,n.separate=e._separate,n.sourceFactor=e._sourceFactor,n.destinationFactor=e._destinationFactor,n.sourceFactorAlpha=e._sourceFactorAlpha,n.destinationFactorAlpha=e._destinationFactorAlpha,i.enable===r&&i.sourceFactor===e._sourceFactor&&i.destinationFactor===e._destinationFactor&&i.sourceFactorAlpha===e._sourceFactorAlpha&&i.destinationFactorAlpha===e._destinationFactorAlpha||(t.changed=!0)},applyBlendFunc:function(e){var t=this._stateBlendFunc,n=t.buffer,i=t.state;t.changed=!1,i.enable!==n.enable&&(i.enable=n.enable,i.enable?e.enable(e.BLEND):e.disable(e.BLEND)),i.enable&&(i.separate=n.separate,i.separate?i.sourceFactor===n.sourceFactor&&i.destinationFactor===n.destinationFactor&&i.sourceFactorAlpha===n.sourceFactorAlpha&&i.destinationFactorAlpha===n.destinationFactorAlpha||(i.sourceFactor=n.sourceFactor,i.destinationFactor=n.destinationFactor,i.sourceFactorAlpha=n.sourceFactorAlpha,i.destinationFactorAlpha=n.destinationFactorAlpha,e.blendFuncSeparate(i.sourceFactor,i.destinationFactor,i.sourceFactorAlpha,i.destinationFactorAlpha)):i.sourceFactor===n.sourceFactor&&i.destinationFactor===n.destinationFactor||(i.sourceFactor=n.sourceFactor,i.destinationFactor=n.destinationFactor,e.blendFunc(i.sourceFactor,i.destinationFactor)))},applyClearStates:function(e){this._stateDepthMask.changed&&this.applyDepthMask(e),this._stateScissor.changed&&this.applyScissor(e),this._stateClearColor.changed&&this.applyClearColor(e),this._stateClearDepth.changed&&this.applyClearDepth(e),this._stateColorMask.changed&&this.applyColorMask(e)},applyDrawStates:function(e){this._stateViewport.changed&&this.applyViewport(e),this._stateScissor.changed&&this.applyScissor(e),this._stateDepth.changed&&this.applyDepth(e),this._stateDepthMask.changed&&this.applyDepthMask(e),this._stateCullFace.changed&&this.applyCullFace(e),this._stateBlendFunc.changed&&this.applyBlendFunc(e),this._stateColorMask.changed&&this.applyColorMask(e)},clear:function(e,t){this.applyClearStates(e),e.clear(t)},drawGeometry:function(e){this.applyDrawStates(e)}};var v=m,_=[void 0,function(e,t){return e[0]===t[0]||(t[0]=e[0],!1)},function(e,t){return e[0]===t[0]&&e[1]===t[1]||(t[0]=e[0],t[1]=e[1],!1)},function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(t[0]=e[0],t[1]=e[1],t[2]=e[2],!1)},function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]||(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],!1)}],b=function(e){a.a.call(this),this._excludeUniforms={uProjectionMatrix:!0,uModelMatrix:!0,uViewMatrix:!0,uModelViewMatrix:!0,uModelNormalMatrix:!0,uModelViewNormalMatrix:!0,uArrayColorEnabled:!0},this._graphicContext=void 0,this._shaderGeneratorProxy=e,void 0===e&&console.break(),this._currentVAO=null,this._currentIndexVBO=null,this._stateSets=new u.a,this._shaderGeneratorNames=new l.a,this._uniforms={},this._textureAttributeArrayList=[],this._attributeArray=[],this._projectionMatrix=c.a.createMatrix4(i.c.create(),"uProjectionMatrix"),this._modelMatrix=c.a.createMatrix4(i.c.create(),"uModelMatrix"),this._viewMatrix=c.a.createMatrix4(i.c.create(),"uViewMatrix"),this._modelViewMatrix=c.a.createMatrix4(i.c.create(),"uModelViewMatrix"),this._modelNormalMatrix=c.a.createMatrix3(i.b.create(),"uModelNormalMatrix"),this._modelViewNormalMatrix=c.a.createMatrix3(i.b.create(),"uModelViewNormalMatrix");var t=new l.a;t._globalDefault=c.a.createFloat1(0,"uArrayColorEnabled"),this._uniforms.ArrayColorEnabled=t,this._previousColorAttribPair={},this._vertexAttribMap={},this._vertexAttribMap._disable=[],this._vertexAttribMap._keys=[],this._frameStamp=void 0,this._programCommonUniformsCache={},this._lastAppliedModelViewMatrix=void 0,this._lastAppliedProjectionMatrix=void 0,this._program=void 0;var n=new o.a;this.applyAttribute(n),this._programType=h.a.getOrCreateStateAttributeTypeMemberIndex(n),this._programAttribute=this._attributeArray[this._programType],this._numPushStateSet=0,this._numApply=0,this._programUniformCache=[],this._cacheUniformId=0,this._stateCache=new v,this.resetStats()};h.a.createPrototypeObject(b,h.a.objectInherit(a.a.prototype,{getExcludeUniforms:function(){return this._excludeUniforms},resetCaches:function(){this._currentVAO=null,this._currentIndexVBO=null,this._previousColorAttribPair={},this._vertexAttribMap={},this._vertexAttribMap._disable=[],this._vertexAttribMap._keys=[],this._programCommonUniformsCache={}},applyColorMask:function(e){this._stateCache.applyColorMaskAttribute(e)},applyBlendFunc:function(e){this._stateCache.applyBlendFuncAttribute(e)},applyCullFace:function(e){this._stateCache.applyCullFaceAttribute(e)},applyDepth:function(e){this._stateCache.applyDepthAttribute(e)},applyViewport:function(e){this._stateCache.applyViewportAttribute(e)},applyScissor:function(e){this._stateCache.applyScissorAttribute(e)},viewport:function(e,t,n,i){this._stateCache.viewport(e,t,n,i)},depthMask:function(e){this._stateCache.depthMask(e)},clearDepth:function(e){this._stateCache.clearDepth(e)},clearColor:function(e){this._stateCache.clearColor(e)},clear:function(e){this._stateCache.clear(this._graphicContext,e)},drawGeometry:function(e){this._stateCache.drawGeometry(this._graphicContext,e)},getCacheUniformsApplyRenderLeaf:function(){return this._programCommonUniformsCache},setGraphicContext:function(e){this._graphicContext=e,this._extVAO=d.a.instance(e).getWebGLExtension("OES_vertex_array_object")},getGraphicContext:function(){return this._graphicContext},getShaderGeneratorProxy:function(){return this._shaderGeneratorProxy},pushCheckOverride:function(e,t,n){var i=this._evaluateOverrideObjectOnStack(e,t,n);i!==t?e.push(i,e._back.value):e.push(t,n)},_evaluateOverrideObjectOnStack:function(e,t,n){var i=e._back;return 0===e._length?t:i.value&s.a.OVERRIDE&&!(n&s.a.PROTECTED)?i.object:t},pushStateSet:function(e){this._numPushStateSet++,this._stateSets.push(e),this.pushAttributeMap(this._attributeArray,e._attributeArray,e._activeAttribute);for(var t=e._textureAttributeArrayList,n=e._activeTextureAttributeUnit,i=e._activeTextureAttribute,r=0,a=n.length;r<a;r++){var o=n[r],s=t[o],u=this.getOrCreateTextureAttributeArray(o);this.pushAttributeMap(u,s,i)}e.hasUniform()&&this.pushUniformsList(this._uniforms,e.getUniformList());var l=e.getShaderGeneratorPair();l&&this.pushCheckOverride(this._shaderGeneratorNames,l.getShaderGeneratorName(),l.getValue())},getStateSetStackSize:function(){return this._stateSets.getLength()},insertStateSet:function(){var e=new u.a,t=e.getArray();return function(n,i){e.reset();for(var r=this.getStateSetStackSize();r>n;)e.push(this._stateSets.back()),this.popStateSet(),r--;this.pushStateSet(i);for(var a=e._length-1;a>=0;a--)this.pushStateSet(t[a])}}(),removeStateSet:function(){var e=new u.a,t=e.getArray();return function(n){var i=this.getStateSetStackSize();if(n>=i)r.a.warn("Warning State:removeStateSet "+n+" out of range");else{for(e.reset();i-1>n;)e.push(this._stateSets.back()),this.popStateSet(),i--;this.popStateSet();for(var a=e._length-1;a>=0;a--)this.pushStateSet(t[a])}}}(),resetCacheFrame:function(){this._lastAppliedModelViewMatrix=this._lastAppliedProjectionMatrix=void 0},resetStats:function(){this._numApply=0,this._numPushStateSet=0},applyProgram:function(e){this._program!==e&&(this._program=e,this.getGraphicContext().useProgram(e))},applyModelViewMatrix:function(){var e=i.b.create();return function(t,n){if(this._lastAppliedModelViewMatrix===t)return!1;var r,a=this.getLastProgramApplied().getUniformsCache(),o=this._modelViewMatrix,s=a.uModelViewMatrix,u=this.getGraphicContext();if(s&&(o.setMatrix4(t),o.apply(u,s)),this._lastAppliedModelViewMatrix){for(var l=this._lastAppliedModelViewMatrix,c=0;c<11;c++)if(t[c]!==l[c]){r=!0;break}}else r=!0;return r&&(o=this._modelViewNormalMatrix,(s=a.uModelViewNormalMatrix)&&(i.b.normalFromMat4(e,t),o.setMatrix3(e),o.apply(u,s)),(s=a.uModelNormalMatrix)&&(i.b.normalFromMat4(e,n),o.setMatrix3(e),o.apply(u,s))),this._lastAppliedModelViewMatrix=t,!0}}(),applyProjectionMatrix:function(e){if(this._lastAppliedProjectionMatrix!==e){this._lastAppliedProjectionMatrix=e;var t=this.getLastProgramApplied(),n=this._projectionMatrix,i=t.getUniformsCache()[n.getName()];i&&(n.setMatrix4(e),n.apply(this.getGraphicContext(),i))}},getCurrentShaderGeneratorStateSet:function(e){var t=this._programAttribute,n=e._attributeArray[this._programType];if(!(0!==t._length&&t._back.value!==s.a.OFF||n&&n.getValue()!==s.a.OFF)){var i,r=e.getShaderGeneratorPair(),a=this._shaderGeneratorNames;if(r){var o=r.getValue(),u=r.getShaderGeneratorName();i=this._evaluateOverrideObjectOnStack(this._shaderGeneratorNames,u,o)}else a._length&&(i=a._back.object);var l=i;return this._shaderGeneratorProxy.getShaderGenerator(l)}},_applyAttributeMapStateSet:function(e,t){for(var n=0,i=e.length>t.length?e.length:t.length;n<i;n++){var r,a=n,o=a<e.length?e[a]:void 0,s=a<t.length?t[a]:void 0,u=!!o,l=u&&o._changed;if(s||l){var c=s?s.getAttribute():void 0;if(u)if(c){var h=s.getValue();(r=this._evaluateOverrideObjectOnStack(o,c,h))!==c?o._changed&&(this._applyAttributeStack(r,o),o._changed=!1):this._applyAttributeStack(r,o)&&(o._changed=!0)}else o._length?(o._changed=!1,this._applyAttributeStack(o._back.object,o)):(o._changed=!1,this._applyAttributeStack(o._globalDefault,o));else(o=this._createAttributeStack(e,a,c.cloneType()))._changed=!0,this._applyAttributeStack(c,o)}}},_applyTextureAttributeMapListStateSet:function(e,t){for(var n,i,r,a=0;a<16;a++){var o=a;n=o<e.length?e[o]:void 0;var s=o<t.length?t[o]:void 0;if(n||s){i=r=0,n?(r=n.length,s&&(i=s.length)):(n=this.getOrCreateTextureAttributeArray(o),i=s.length);for(var u=r>i?r:i,l=0;l<u;l++){var c,h=l,d=h<r?n[h]:void 0,f=s&&h<s.length?s[h]:void 0,p=!!d,g=p&&d._changed;if(f||g){var m=f?f.getAttribute():void 0;if(p)if(m){var v=f.getValue();(c=this._evaluateOverrideObjectOnStack(d,m,v))!==m?d._changed&&(this._applyTextureAttribute(o,c,d),d._changed=!1):this._applyTextureAttribute(o,c,d)&&(d._changed=!0)}else d._length?(d._changed=!1,this._applyTextureAttribute(o,d._back.object,d)):(d._changed=!1,this._applyTextureAttribute(o,d._globalDefault,d));else c=f.getAttribute(),(d=this._createAttributeStack(n,h,c.cloneType()))._changed=!0,this._applyTextureAttribute(o,c,d)}}}}},applyStateSet:function(e){this._numApply++;var t,n=this.getLastProgramApplied();if(this._currentShaderGenerator=this.getCurrentShaderGeneratorStateSet(e),this._applyAttributeMapStateSet(this._attributeArray,e._attributeArray),this._applyTextureAttributeMapListStateSet(this._textureAttributeArrayList,e._textureAttributeArrayList),this._currentShaderGenerator){var i=this._currentShaderGenerator.getOrCreateProgram(this);this.applyAttribute(i),t=i,this._applyGeneratedProgramUniforms(i,e)}else t=this.getLastProgramApplied(),this._applyCustomProgramUniforms(t,e);n!==t&&(this._lastAppliedModelViewMatrix=void 0,this._lastAppliedProjectionMatrix=void 0)},popAllStateSets:function(){for(;this._stateSets._length;)this.popStateSet()},popStateSet:function(){if(this._stateSets._length){var e=this._stateSets.pop();this.popAttributeMap(this._attributeArray,e._attributeArray,e._activeAttribute);for(var t=e._textureAttributeArrayList,n=e._activeTextureAttributeUnit,i=e._activeTextureAttribute,r=0,a=n.length;r<a;r++){var o=n[r],s=t[o],u=this._textureAttributeArrayList[o];this.popAttributeMap(u,s,i)}e.hasUniform()&&this.popUniformsList(this._uniforms,e.getUniformList()),e.getShaderGeneratorPair()&&this._shaderGeneratorNames.pop()}},_createAttributeStack:function(e,t,n){h.a.arrayDense(t,e);var i=new l.a;return i._globalDefault=n,e[t]=i,i},haveAppliedAttribute:function(e){if(e){var t=this._attributeArray,n=h.a.getOrCreateStateAttributeTypeMemberIndex(e),i=n<t.length?t[n]:void 0;i||(i=this._createAttributeStack(t,n,e.cloneType())),i._lastApplied=e,i._changed=!0}},applyAttribute:function(e){var t=h.a.getOrCreateStateAttributeTypeMemberIndex(e),n=this._attributeArray,i=t<n.length?n[t]:void 0;i||(i=this._createAttributeStack(n,t,e.cloneType())),i._changed=!0,this._applyAttributeStack(e,i)},_applyAttributeStack:function(e,t){return t._lastApplied!==e&&(e.apply&&e.apply(this),t._lastApplied=e,!0)},_applyTextureAttribute:function(e,t,n){if(n._lastApplied===t)return!1;if(n._lastApplied=t,!t.apply)return!0;var i=this.getGraphicContext();return i.activeTexture(i.TEXTURE0+e),t.apply(this,e),!0},applyTextureAttribute:function(e,t){var n=h.a.getOrCreateTextureStateAttributeTypeMemberIndex(t),i=this.getOrCreateTextureAttributeArray(e),r=i[n];r||(r=this._createAttributeStack(i,n,t.cloneType())),r._changed=!0,this._applyTextureAttribute(e,t,r)},getLastProgramApplied:function(){return this._programAttribute._lastApplied},applyDefault:function(){this.popAllStateSets(),this._currentShaderGenerator=void 0,this.applyAttributeMap(this._attributeArray),this.applyTextureAttributeMapList(this._textureAttributeArrayList)},applyAttributeMap:function(e){for(var t,n=0,i=e.length;n<i;n++){var r;if(t=e[n])r=t._length?t._back.object:t._globalDefault,t._changed&&(t._lastApplied!==r&&(r.apply&&r.apply(this),t._lastApplied=r),t._changed=!1)}},pushUniformsList:function(e,t){var n,i;for(var r in t){var a=t[r];e[n=(i=a.getUniform()).getName()]||this._createAttributeStack(e,n,i),this.pushCheckOverride(e[n],i,a.getValue())}},popUniformsList:function(e,t){for(var n in t)e[n].pop()},applyTextureAttributeMapList:function(e){for(var t,n=this._graphicContext,i=0,r=e.length;i<r;i++)if(t=e[i])for(var a=0,o=t.length;a<o;a++){var s,u=t[a];if(u)s=u._length?u._back.object:u._globalDefault,u._changed&&(u._lastApplied!==s&&(n.activeTexture(n.TEXTURE0+i),s.apply(this,i),u._lastApplied=s),u._changed=!1)}},setGlobalDefaultAttribute:function(e){var t=h.a.getOrCreateStateAttributeTypeMemberIndex(e);t>=this._attributeArray.length||!this._attributeArray[t]?this._createAttributeStack(this._attributeArray,t,e):this._attributeArray[t]._globalDefault=e},getGlobalDefaultAttribute:function(e){var t=this._attributeArray,n=h.a.getIdFromTypeMember(e);if(!(void 0===n||n>=t.length))return t[n]?t[n]._globalDefault:void 0},setGlobalDefaultTextureAttribute:function(e,t){var n=this.getOrCreateTextureAttributeArray(e),i=h.a.getOrCreateTextureStateAttributeTypeMemberIndex(t);i>=n.length||!n[i]?this._createAttributeStack(n,i,t):n[i]._globalDefault=t},getGlobalDefaultTextureAttribute:function(e,t){var n=this.getOrCreateTextureAttributeArray(e),i=h.a.getTextureIdFromTypeMember(t);if(!(void 0===i||i>=n.length))return n[i]?n[i]._globalDefault:void 0},getOrCreateTextureAttributeArray:function(e){return h.a.arrayDense(e,this._textureAttributeArrayList),this._textureAttributeArrayList[e]||(this._textureAttributeArrayList[e]=[]),this._textureAttributeArrayList[e]},pushAttributeMap:function(e,t,n){for(var i,r=t.length,a=e.length,o=0,s=n.length;o<s;o++){var u=n[o],l=u<r?t[u]:void 0,c=l.getAttribute();(i=u<a?e[u]:void 0)||(i=this._createAttributeStack(e,u,c.cloneType())),this.pushCheckOverride(i,c,l.getValue()),i._changed=!0}},popAttributeMap:function(e,t,n){for(var i=0,r=n.length;i<r;i++){var a=e[n[i]];a.pop(),a._changed=!0}},setIndexArray:function(e){var t=this._graphicContext;this._currentIndexVBO!==e&&(e.bind(t),this._currentIndexVBO=e),e.isDirty()&&e.compile(t)},lazyDisablingOfVertexAttributes:function(){for(var e=this._vertexAttribMap._keys,t=0,n=e.length;t<n;t++){var i=e[t];this._vertexAttribMap[i]&&(this._vertexAttribMap._disable[i]=!0)}},enableVertexColor:function(){var e=this._programAttribute._lastApplied;if(e.getUniformsCache().uArrayColorEnabled&&e.getAttributesCache().Color){var t=this._uniforms.ArrayColorEnabled._globalDefault;this._previousColorAttribPair[e.getInstanceID()]||(t.setFloat(1),t.apply(this.getGraphicContext(),e.getUniformsCache().uArrayColorEnabled),this._previousColorAttribPair[e.getInstanceID()]=!0)}},disableVertexColor:function(){var e=this._programAttribute._lastApplied;if(e.getUniformsCache().uArrayColorEnabled&&e.getAttributesCache().Color){var t=this._uniforms.ArrayColorEnabled._globalDefault;this._previousColorAttribPair[e.getInstanceID()]&&(t.setFloat(0),t.apply(this.getGraphicContext(),e.getUniformsCache().uArrayColorEnabled),this._previousColorAttribPair[e.getInstanceID()]=!1)}},applyDisablingOfVertexAttributes:function(){for(var e=this._vertexAttribMap._keys,t=0,n=e.length;t<n;t++)if(!0===this._vertexAttribMap._disable[e[t]]){var i=e[t];this._graphicContext.disableVertexAttribArray(i),this._vertexAttribMap._disable[i]=!1,this._vertexAttribMap[i]=!1}},clearVertexAttribCache:function(){for(var e=this._vertexAttribMap,t=e._keys,n=0,i=t.length;n<i;n++){var r=t[n];e[r]=void 0,e._disable[r]=!1}this._vertexAttribMap._disable.length=0,this._vertexAttribMap._keys.length=0},setVertexArrayObject:function(e){return this._currentVAO!==e&&(this._currentVAO=e,e?e.bind(this._graphicContext):(this._graphicContext.bindVertexArray(null),this.clearVertexAttribCache()),this._currentIndexVBO=void 0,!0)},setVertexAttribArray:function(e,t){var n=this._vertexAttribMap;n._disable[e]=!1;var i=this._graphicContext,r=!1;t.isDirty()&&(t.bind(i),t.compile(i),r=!0);var a=n[e];a!==t&&(r||t.bind(i),a||(i.enableVertexAttribArray(e),void 0===a&&n._keys.push(e)),n[e]=t,i.vertexAttribPointer(e,t.getGlItemSize(),t.getGlType(),t.getGlNormalize(),0,0))},_getActiveUniformsFromProgramAttributes:function(e,t){var n=this._attributeArray,i=e.getTrackAttributes().attributeKeys;if(i.length>0)for(var r=0,a=i.length;r<a;r++){var o=i[r],s=n[this.typeMember[o]];if(s){var u=s._globalDefault;if(u.getOrCreateUniforms){var l=u.getOrCreateUniforms();for(var c in l)t.push(l[c])}}}},_getActiveUniformsFromProgramTextureAttributes:function(e,t){var n=e.getTrackAttributes().textureAttributeKeys;if(n)for(var i=0,r=n.length;i<r;i++){var a=n[i];if(a){var o=this._textureAttributeArrayList[i];if(o)for(var s=0,u=a.length;s<u;s++){var l=o[a[s]];if(l){var c=l._globalDefault;if(c.getOrCreateUniforms){var h=c.getOrCreateUniforms();for(var d in h)t.push(h[d])}}}}}},_cacheUniformsForCustomProgram:function(e,t){this._getActiveUniformsFromProgramAttributes(e,t),this._getActiveUniformsFromProgramTextureAttributes(e,t);for(var n=this._graphicContext,i={},r=0,a=t.length;r<a;r++){var o=t[r],s=o.getName(),u=n.getUniformLocation(e._program,s);void 0!==u&&null!==u&&(i[s]=o)}e.trackUniforms=i},_applyCustomProgramUniforms:function(){var e=[];return function(t,n){e.length=0,void 0!==t.getTrackAttributes()&&void 0===t.trackUniforms&&this._cacheUniformsForCustomProgram(t,e);var i,r,a=t.getUniformsCache(),o=this._uniforms;for(var s in t.trackUniforms&&(i=t.trackUniforms),a){var u=a[s],l=o[s],c=n&&n.uniforms[s];if(l||c)if(c){var h=n.uniforms[s],d=h.getValue(),f=h.getUniform();r=l?this._evaluateOverrideObjectOnStack(l,f,d):f}else r=l._length?l._back.object:l._globalDefault;else{if(void 0===i){this._checkErrorUniform(s);continue}r=i[s]}r.apply(this._graphicContext,u)}}}(),_checkErrorUniform:function(e){var t=e.substr(7);this._textureAttributeArrayList[t]&&e==="Texture"+t||this._excludeUniforms[e]||(this._excludeUniforms[e]=1,r.a.error("Uniform not in the scene hierarchy : "+e))},_computeForeignUniforms:function(e,t){var n=[];for(var i in e){void 0!==e[i]&&void 0===t[i]&&(this._excludeUniforms[i]||n.push(i))}return n},_removeUniformsNotRequiredByProgram:function(e,t){for(var n in e){var i=t[n];void 0!==i&&null!==i||delete e[n]}},_cacheUniformsForGeneratedProgram:function(e){var t=e.getUniformsCache(),n=e.getActiveUniforms(),i=this._computeForeignUniforms(t,n);e.setForeignUniforms(i),this._removeUniformsNotRequiredByProgram(n,t)},_copyUniformEntry:function(e){var t,n=e.getInternalArray();return n.length<16&&(t=new n.constructor(n.length)),t},_initUniformCache:function(e){var t,n,i,r,a,o=e.getActiveUniforms(),s=e.getForeignUniforms(),u=this._uniforms,l=[],c=[];if(e._cacheUniformId=this._cacheUniformId++,this._programUniformCache[e._cacheUniformId]={},s.length)for(i=l,t=0,n=s.length;t<n;t++){var h=u[s[t]];h&&(a=h._globalDefault,r=this._copyUniformEntry(a),i.push(r))}for(var d in o)a=o[d],r=this._copyUniformEntry(a),c.push(r);this._programUniformCache[e._cacheUniformId].foreign=l,this._programUniformCache[e._cacheUniformId].active=c},_checkCacheAndApplyUniform:function(e,t,n,i,r){var a,o=e.getInternalArray(),s=o.length;if(s<=4){var u=t[n];a=_[s](o,u)}else a=!1;if(!a){var l=i[r];e.apply(this._graphicContext,l)}},_applyGeneratedProgramUniforms:function(e,t){var n,i,r,a,o=this._uniforms,s=e.getForeignUniforms();if(!s){if(this._cacheUniformsForGeneratedProgram(e),s=e.getForeignUniforms(),t){var u=t.uniforms;for(a=0;a<s.length;a++)o[i=s[a]]||u[i]&&(n=u[i].getUniform(),this._createAttributeStack(o,i,n))}this._initUniformCache(e)}var l=e.getUniformsCache(),c=e.getActiveUniforms(),h=this._programUniformCache[e._cacheUniformId].active,d=this._programUniformCache[e._cacheUniformId].foreign,f=0;for(var p in c)n=c[p],this._checkCacheAndApplyUniform(n,h,f,l,p),f++;f=0;var g=s.length;for(a=0;a<g;a++){r=o[i=s[a]];var m=t&&t.uniforms[i];if(m||r){if(m){var v=t.uniforms[i],_=v.getValue(),b=v.getUniform();n=this._evaluateOverrideObjectOnStack(r,b,_)}else r._length?n=r._back.object:(n=r._globalDefault,this._checkErrorUniform(i));this._checkCacheAndApplyUniform(n,d,f,l,i),f++}else this._checkErrorUniform(i)}},_setStateSetsDrawID:function(e){for(var t=this._stateSets.getArray(),n=0,i=this._stateSets.length;n<i;n++)t[n].setDrawID(e)},_stateSetStackChanged:function(e,t){var n=this._stateSets.getArray(),i=this._stateSets.length;if(t!==i)return!0;for(var r=0;r<i;r++)if(e!==n[r].getDrawID())return!0;return!1}}),"osg","State");t.a=b},xcv8:function(e,t){e.exports='uniform float uRGBMRange;\nuniform int uOutputLinear;\n\n// stuffs (ssr, opacity, scattering)\nuniform vec4 uHalton;\nuniform vec2 uNearFar;\nuniform float uFrameMod;\nuniform int uDrawOpaque;\n\n// shadow signature...\n#ifdef HAS_SUBSURFACETRANSLUCENCY\n    #define _OUT_DISTANCE\n    #define OPT_DISTANCE shadowDistance,\n#else\n    #define OPT_DISTANCE\n#endif\n\n//////////\n// VARYING\n//////////\nvarying vec4 vViewVertex;\nvarying vec3 vViewNormal;\n\n#ifdef HAS_SHADOW\n    varying vec3 vModelNormal;\n    varying vec3 vModelVertex;\n#endif\n\n#ifdef HAS_VIEW_TANGENT\n    varying vec4 vViewTangent;\n#endif\n\n#pragma include "utils/common.glsl"\n\n#pragma include "utils/functions.glsl"\n\n#pragma include "utils/material.glsl"\n\n// TODO ifdef around pragma include can result in error (files being included multiple times can be ignored)\n#pragma include "utils/decodeDepth.glsl"\n\n#pragma include "utils/rand.glsl"\n\n#if defined(HAS_NORMALMAP) || defined(HAS_BUMPMAP) || defined(HAS_CLEARCOATNORMALMAP) || defined(SAMPLER_ANISOTROPY)\n#pragma include "utils/normalBump.glsl"\n#endif\n\n#ifdef HAS_SHADOW\n#pragma include "shadowing/shadowReceive.glsl"\n#endif\n\n// /!\\ (lightsPBR is also included in clearcoat file, and ifdef around pragma include is not reliable)\n#if defined(HAS_LIGHT) || defined(HAS_CLEARCOAT)\n#pragma include "utils/lightsPBR.glsl"\n#endif\n\n#ifdef HAS_ENVIRONMENT\n#pragma include "utils/environment.glsl"\n#endif\n\n#ifdef HAS_SUBSURFACETRANSLUCENCY\n#pragma include "utils/lightsSSS.glsl"\n#endif\n\n#ifdef HAS_SUBSURFACESCATTERING\n#pragma include "utils/checkerboard.glsl"\n#endif\n\n#ifdef HAS_CLEARCOAT\n#pragma include "utils/clearCoat.glsl"\n#endif\n\n// #ifdef HAS_OPACITY_MASK_OR_DITHER\n// #pragma include "utils/rand.glsl"\n// #endif\n\n#ifdef HAS_OPACITY_REFRACTION\n#pragma include "utils/refraction.glsl"\n#endif\n\n#ifdef HAS_SSR\n#pragma include "utils/ssr.glsl"\n#endif\n\nfloat specularOcclusion(const in int occlude, const in float ao, const in vec3 normal, const in vec3 eyeVector) {\n    if (occlude == 0) return 1.0;\n    // Yoshiharu Gotanda\'s specular occlusion approximation:\n    // cf http://research.tri-ace.com/Data/cedec2011_RealtimePBR_Implementation_e.pptx pg59\n    float d = dot(normal, eyeVector) + ao;\n    return clamp((d * d) - 1.0 + ao, 0.0, 1.0);\n}\n\nfloat adjustRoughnessNormalMap(const in float roughness, const in vec3 normal) {\n    // Based on The Order : 1886 SIGGRAPH course notes implementation (page 21 notes)\n    float nlen2 = dot(normal, normal);\n    if (nlen2 < 1.0) {\n        float nlen = sqrt(nlen2);\n        float kappa = (3.0 * nlen -  nlen2 * nlen) / (1.0 - nlen2);\n        // http://www.frostbite.com/2014/11/moving-frostbite-to-pbr/\n        // page 91 : they use 0.5/kappa instead\n        return min(1.0, sqrt(roughness * roughness + 1.0 / kappa));\n    }\n    return roughness;\n}\n\nvec3 computeAnisotropicBentNormal(const in vec3 normal, const in vec3 eyeVector, const in float roughness, const in vec3 anisotropicT, const in vec3 anisotropicB, const in float anisotropy) {\n    vec3 anisotropyDirection = anisotropy >= 0.0 ? anisotropicB : anisotropicT;\n    vec3 anisotropicTangent = cross(anisotropyDirection, eyeVector);\n    vec3 anisotropicNormal = cross(anisotropicTangent, anisotropyDirection);\n    float bendFactor = abs(anisotropy) * clamp(5.0 * roughness, 0.0, 1.0);\n    return normalize(mix(normal, anisotropicNormal, bendFactor));\n}\n\nvoid main() {\n    //////////////////\n    // OPACITY DISCARD\n    //////////////////\n#ifdef HAS_POINT_CIRCLE\n    if (length(2.0 * gl_PointCoord - 1.0) > 1.0) discard;\n#endif\n\n#ifdef HAS_OPACITY_MASK_OR_DITHER\n    ditheringMaskingDiscard(gl_FragCoord, uOpacityDithering, getMaterialOpacity(), uOpacityFactor, uOpacityThinLayer, uFrameMod, uNearFar, uHalton);\n#endif\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    float alpha = getMaterialOpacity();\n    float alphaFinal = alpha * float(1 - uOpacityAdditive);\n    if (alpha == 0.0 || (uDrawOpaque == 1 && alphaFinal < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaFinal >= EPSILON_ALPHA)) discard;\n#endif\n\n    // /!\\ because of refraction roughness, this part should be done before the call to getMetalness/getSpecular\n#ifdef HAS_OPACITY_REFRACTION\n    gRefractionRoughness = uOpacityRoughnessFactor;\n    float alphaRefraction = getMaterialOpacity();\n    if ((uDrawOpaque == 1 && alphaRefraction < EPSILON_ALPHA) || (uDrawOpaque == 0 && alphaRefraction >= EPSILON_ALPHA)) discard;\n#endif\n\n    ///////////\n    // GEOMETRY\n    ///////////\n    // https://twitter.com/pyalot/status/711956736639418369\n    vec3 eyeVector = -normalize(vViewVertex.xyz);\n    vec3 frontNormal = normalize(gl_FrontFacing ? vViewNormal : -vViewNormal);\n\n#ifdef HAS_VIEW_TANGENT\n    vec4 tangent;\n    tangent = vViewTangent;\n\n    tangent = gl_FrontFacing ? tangent : -tangent;\n    tangent.xyz = normalize(tangent.xyz);\n    vec3 binormal = normalize(cross(frontNormal, tangent.xyz)) * tangent.w;\n#endif\n\n    ///////////\n    // MATERIAL\n    ///////////\n#if defined(HAS_LEGACY_CLASSIC)\n    vec3 materialDiffuse = getMaterialLegacyDiffuse();\n    vec3 materialSpecular = getMaterialLegacySpecular();\n#elif defined(HAS_METALNESSPBR)\n    float f0 = 0.08 * getMaterialF0();\n    float metal = getMaterialMetalness();\n\n    #ifdef HAS_OPACITY_REFRACTION\n        metal *= alphaRefraction;\n    #endif\n\n    vec3 materialDiffuse = getMaterialAlbedo();\n    vec3 materialSpecular = mix(vec3(f0), materialDiffuse, metal);\n    materialDiffuse *= 1.0 - metal;\n#else\n    vec3 materialSpecular = getMaterialSpecular();\n    vec3 materialDiffuse = getMaterialDiffuse();\n\n    #ifdef HAS_OPACITY_REFRACTION\n        materialSpecular *= mix(0.08, 1.0, alphaRefraction);\n    #endif\n#endif // HAS_METALNESSPBR\n\n#if defined(HAS_ENVIRONMENT) || defined(HAS_LIGHT)\n    float materialF90 = clamp(50.0 * materialSpecular.g, 0.0, 1.0);\n#endif\n\n#if defined(HAS_LEGACY_CLASSIC)\n    float materialShininess = getMaterialLegacyShininess();\n    float materialRoughness = 0.0;\n#elif defined(HAS_ROUGHNESSPBR)\n    float materialRoughness = getMaterialRoughness();\n#else\n    float materialRoughness = 1.0 - getMaterialGlossiness();\n#endif // HAS_ROUGHNESSPBR\n\n#ifdef HAS_AOPBR\n    float materialAO = getMaterialAO();\n#endif\n\n#ifdef HAS_EMITCOLOR\n    vec3 materialEmit = getMaterialEmitColor();\n#endif\n\n#ifdef HAS_CAVITYPBR\n    float materialCavity = getMaterialCavity();\n#endif\n\n#ifdef HAS_SUBSURFACETRANSLUCENCY\n    float materialTranslucency = getMaterialTranslucency();\n#endif\n\n    vec3 materialNormal = frontNormal;\n#ifdef HAS_NORMALMAP\n    materialNormal = getMaterialNormalMap();\n    materialRoughness = adjustRoughnessNormalMap(materialRoughness, materialNormal);\n    materialNormal = transformNormal(uNormalMapFactor, materialNormal, tangent.xyz, binormal, frontNormal);\n#endif\n\n#ifdef HAS_BUMPMAP\n    materialNormal = transformBump(getMaterialBumpMap(), tangent.xyz, binormal, frontNormal);\n#endif\n\n#ifdef HAS_CLEARCOAT\n    float materialClearCoat = getMaterialClearCoat();\n    float materialClearCoatRoughness = getMaterialClearCoatRoughness();\n    #ifdef HAS_CLEARCOATNORMALMAP\n        vec3 materialClearCoatNormal = transformNormal(uClearCoatNormalMapFactor, getMaterialClearCoatNormal(), tangent.xyz, binormal, frontNormal);\n    #else\n        vec3 materialClearCoatNormal = frontNormal;\n    #endif\n#endif\n\n#if defined(HAS_ANISOTROPY) && (defined(HAS_LIGHT) || defined(HAS_ENVIRONMENT))\n    float anisotropy = uAnisotropyFactor;\n\n    #ifdef SAMPLER_ANISOTROPY\n        vec2 aniso = getMaterialDirectionAnisotropy();\n        vec3 anisotropicT = transformTangent(aniso, tangent.xyz, binormal);\n        // reproject tangent/binormal on the material normal plane\n        anisotropicT = normalize(anisotropicT - materialNormal * dot(anisotropicT, materialNormal));\n        vec3 anisotropicB = normalize(cross(materialNormal, anisotropicT.xyz));\n\n        anisotropy *= length(aniso);\n    #else\n        #if defined(HAS_NORMALMAP) || defined(HAS_BUMPMAP)\n            // reproject tangent/binormal on the material normal plane\n            tangent.xyz = normalize(tangent.xyz - materialNormal * dot(tangent.xyz, materialNormal));\n            binormal = normalize(cross(materialNormal, tangent.xyz)) * tangent.w;\n        #endif\n\n        vec3 anisotropicT = normalize(mix(tangent.xyz, binormal, uAnisotropyDirection));\n        vec3 anisotropicB = normalize(mix(binormal, -tangent.xyz, uAnisotropyDirection));\n    #endif\n#endif\n\n    vec3 diffuse = vec3(0.0);\n    vec3 specular = vec3(0.0);\n\n#if defined(HAS_CLEARCOAT) && (defined(HAS_ENVIRONMENT) || defined(HAS_LIGHT))\n    float ccNoV = saturate(dot(materialClearCoatNormal, -refract(eyeVector, materialClearCoatNormal, 1.0 / uClearCoatIor)));\n#endif\n\n    //////////////\n    // ENVIRONMENT\n    //////////////\n#ifdef HAS_ENVIRONMENT\n\n    #ifdef HAS_ANISOTROPY\n        vec3 bentAnisotropicNormal = computeAnisotropicBentNormal(materialNormal, eyeVector, materialRoughness, anisotropicT, anisotropicB, anisotropy);\n    #else\n        vec3 bentAnisotropicNormal = materialNormal;\n    #endif\n\n    diffuse = materialDiffuse * computeDiffuseSPH(materialNormal);\n\n    #ifdef HAS_LEGACY_CLASSIC\n        specular = materialSpecular * textureCubeFixed(sEnvironmentSpecular, uEnvironmentTransform * normalize((2.0 * clamp(dot(materialNormal, eyeVector), 0.0, 1.0)) * materialNormal - eyeVector), uTextureEnvironmentSpecularTextureSize.x);\n    #else\n        specular = computeIBLSpecularUE4(bentAnisotropicNormal, eyeVector, materialRoughness, materialSpecular, frontNormal, materialF90);\n    #endif\n\n    #ifdef HAS_CLEARCOAT\n        float ccF0 = materialClearCoat * F_Schlick(uClearCoatF0, 1.0, ccNoV);\n        vec3 ccAbsorbtion = getClearCoatAbsorbtion(ccNoV, ccNoV, materialClearCoat);\n        specular = mix(specular * ccAbsorbtion, getPrefilteredEnvMapColor(materialClearCoatNormal, eyeVector, materialClearCoatRoughness, frontNormal), ccF0);\n        diffuse *= ccAbsorbtion * (1.0 - ccF0);\n    #endif\n\n    float aoSpec = 1.0;\n    #ifdef HAS_LEGACY_CLASSIC\n        aoSpec = uReflection;\n        specular *= aoSpec;\n    #endif\n\n    #ifdef HAS_AOPBR\n        diffuse *= uEnvironmentExposure * materialAO;\n        aoSpec = specularOcclusion(uAOPBROccludeSpecular, materialAO, materialNormal, eyeVector);\n        specular *= uEnvironmentExposure * aoSpec;\n    #else\n        diffuse *= uEnvironmentExposure;\n        specular *= uEnvironmentExposure;\n    #endif // HAS_AOPBR\n\n    #ifdef HAS_SSR\n        #ifdef HAS_CLEARCOAT\n            vec3 normalSsr = normalize(mix(bentAnisotropicNormal, materialClearCoatNormal, materialClearCoat * 0.5));\n            float roughnessSsr = mix(materialRoughness, materialClearCoatRoughness, materialClearCoat);\n            vec3 specularSsr = aoSpec * materialSpecular * mix(vec3(1.0), ccAbsorbtion, materialClearCoat);\n            specular = ssr(specular, specularSsr, roughnessSsr, normalSsr, eyeVector);\n        #else\n            specular = ssr(specular, materialSpecular * aoSpec, materialRoughness, bentAnisotropicNormal, eyeVector);\n        #endif\n    #endif // HAS_SSR\n#endif // HAS_ENVIRONMENT\n\n    /////////////////////////\n    // LIGHTING AND SHADOWING\n    /////////////////////////\n#ifdef HAS_LIGHT\n    float attenuation, dotNL;\n    vec3 eyeLightDir;\n    bool lighted;\n    vec3 lightSpecular;\n    vec3 lightDiffuse;\n    vec4 prepGGX = precomputeGGX(materialNormal, eyeVector, max(MIN_ROUGHNESS, materialRoughness));\n\n    #ifdef HAS_CLEARCOAT\n        vec4 prepGGXClearCoat = precomputeGGX(materialClearCoatNormal, eyeVector, materialClearCoatRoughness);\n        vec3 ccSpecular;\n        vec3 ccAttenuation;\n    #endif\n#endif\n\n#ifdef HAS_SHADOW\n    float shadow;\n    vec3 modelNormal = normalize(gl_FrontFacing ? vModelNormal : -vModelNormal);\n\n    #ifdef HAS_SUBSURFACETRANSLUCENCY\n        float shadowDistance;\n    #endif\n#endif // HAS_SHADOW\n\n%UNROLL 4%\n#ifdef LIGHT_TYPE_%ID%\n\n    #if LIGHT_TYPE_%ID% == LIGHT_SPOT\n        precomputeSpot(materialNormal, vViewVertex.xyz, uSketchfabLight%ID%_viewDirection, uSketchfabLight%ID%_attenuation, uSketchfabLight%ID%_viewPosition.xyz, uSketchfabLight%ID%_spotCutOff, uSketchfabLight%ID%_spotBlend, attenuation, eyeLightDir, dotNL);\n    #elif LIGHT_TYPE_%ID% == LIGHT_POINT\n        precomputePoint(materialNormal, vViewVertex.xyz, uSketchfabLight%ID%_attenuation, uSketchfabLight%ID%_viewPosition.xyz, attenuation, eyeLightDir, dotNL);\n    #elif LIGHT_TYPE_%ID% == LIGHT_DIRECTION\n        precomputeSun(materialNormal, uSketchfabLight%ID%_viewDirection, attenuation, eyeLightDir, dotNL);\n    #elif LIGHT_TYPE_%ID% == LIGHT_HEMI\n        precomputeSun(materialNormal, uSketchfabLight%ID%_viewDirection, attenuation, eyeLightDir, dotNL);\n    #endif\n\n    #ifdef HAS_LEGACY_CLASSIC\n        #if LIGHT_TYPE_%ID% == LIGHT_HEMI\n            hemiLight(materialNormal, eyeVector, dotNL, eyeLightDir, materialDiffuse, materialSpecular, materialShininess, uSketchfabLight%ID%_diffuse.rgb, uSketchfabLight%ID%_ground.rgb, lightDiffuse, lightSpecular, lighted);\n        #else\n            computeLightLambertCookTorrance(materialNormal, eyeVector, dotNL, attenuation, materialDiffuse, materialSpecular, materialShininess, uSketchfabLight%ID%_diffuse.rgb, uSketchfabLight%ID%_diffuse.rgb, eyeLightDir, lightDiffuse, lightSpecular, lighted);\n        #endif\n    #else\n        #ifdef HAS_ANISOTROPY\n            computeLightLambertGGXAnisotropy(materialNormal, eyeVector, dotNL, prepGGX, materialDiffuse, materialSpecular, attenuation, uSketchfabLight%ID%_diffuse.rgb, eyeLightDir, materialF90, anisotropicT, anisotropicB, anisotropy, lightDiffuse, lightSpecular, lighted);\n        #else\n            computeLightLambertGGX(materialNormal, eyeVector, dotNL, prepGGX, materialDiffuse, materialSpecular, attenuation, uSketchfabLight%ID%_diffuse.rgb, eyeLightDir, materialF90, lightDiffuse, lightSpecular, lighted);\n        #endif\n    #endif\n\n    #ifdef HAS_CLEARCOAT\n        computeLightLambertGGXClearCoat(ccNoV, materialClearCoatNormal, eyeVector, dot(materialClearCoatNormal, eyeLightDir), prepGGXClearCoat, attenuation, uSketchfabLight%ID%_diffuse.rgb, eyeLightDir, materialClearCoat, ccSpecular, ccAttenuation);\n        lightDiffuse *= ccAttenuation;\n        lightSpecular = ccSpecular + lightSpecular * ccAttenuation;\n    #endif\n\n    #ifdef HAS_SHADOW_%ID%\n        #ifdef _ATLAS_SHADOW\n            shadow = shadowReceive(lighted, modelNormal, vModelVertex, Texture7, uShadow_Texture0_renderSize, uShadow_Texture%ID%_projection, uShadow_Texture%ID%_viewRight, uShadow_Texture%ID%_viewUp, uShadow_Texture%ID%_viewLook, uShadow_Texture%ID%_depthRange, uShadowReceive%ID%_bias, uShadow_Texture%ID%_mapSize, OPT_DISTANCE uStaticFrameNumShadow%ID%);\n        #else\n            shadow = shadowReceive(lighted, modelNormal, vModelVertex, TEX_SHADOW_%ID%, uShadow_Texture%ID%_renderSize, uShadow_Texture%ID%_projection, uShadow_Texture%ID%_viewRight, uShadow_Texture%ID%_viewUp, uShadow_Texture%ID%_viewLook, uShadow_Texture%ID%_depthRange, uShadowReceive%ID%_bias, OPT_DISTANCE uStaticFrameNumShadow%ID%);\n        #endif // _ATLAS_SHADOW\n\n        lightDiffuse *= shadow;\n        lightSpecular *= shadow;\n\n        #ifdef HAS_SUBSURFACETRANSLUCENCY\n            lightDiffuse += computeLightSSS(dotNL, attenuation, uSubsurfaceTranslucencyThicknessFactor, uSubsurfaceTranslucencyColor, materialTranslucency, shadowDistance, materialDiffuse, uSketchfabLight%ID%_diffuse.rgb);\n        #endif\n    #endif // HAS_SHADOW\n\n    diffuse += lightDiffuse;\n    specular += lightSpecular;\n#endif // LIGHT_TYPE\n%%\n\n    /////////////\n    // REFRACTION\n    /////////////\n#ifdef HAS_OPACITY_REFRACTION\n    #ifdef HAS_REFRACTION_NORMAL_OFFSET\n        vec3 refractLight = refraction(gRefractionRoughness, materialNormal, frontNormal);\n    #else\n        vec3 refractLight = refraction(gRefractionRoughness, materialNormal, eyeVector);\n    #endif\n\n    #ifdef HAS_REFRACTION_ALBEDO_TINT\n        refractLight *= materialDiffuse;\n    #endif\n\n    diffuse = mix(refractLight, diffuse, alphaRefraction);\n#endif // HAS_OPACITY_REFRACTION\n\n    //////////////////////\n    // SCATTERING AND EMIT\n    //////////////////////\n#ifdef HAS_SUBSURFACESCATTERING\n    #ifdef HAS_EMITCOLOR\n        diffuse = uEmitMultiplicative == 1 ? diffuse * materialEmit : diffuse + materialEmit;\n        if (uEmitMultiplicative == 1) specular *= materialEmit;\n    #endif\n    vec3 frag = mix(specular, diffuse, checkerboard(gl_FragCoord.xy, uHalton));\n#else\n    vec3 frag = diffuse + specular;\n    #ifdef HAS_EMITCOLOR\n        frag = uEmitMultiplicative == 1 ? frag * materialEmit : frag + materialEmit;\n    #endif\n#endif // HAS_SUBSURFACESCATTERING\n\n#ifdef HAS_CAVITYPBR\n    frag *= materialCavity;\n#endif\n\n    // premult\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    frag *= alpha;\n#endif\n\n    if (uOutputLinear != 1) frag = linearTosRGB(frag);\n\n#ifdef HAS_OPACITY_BLEND_OR_ADDITIVE\n    gl_FragColor = uDrawOpaque == 1 ? encodeRGBM(frag, uRGBMRange) : vec4(frag, alphaFinal);\n#else\n    gl_FragColor = encodeRGBM(frag, uRGBMRange);\n#endif\n}\n'},xgxp:function(e,t){e.exports="attribute vec2 TexCoord0;\nattribute vec3 Vertex;\n\nvarying vec2 vLocalVertex;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main(void) {\n  vLocalVertex = Vertex.xy;\n\n  vec3 posLocal = Vertex.xyz * 0.5;\n  posLocal += vec3(0.0, 0.0, 0.1);\n\n  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(posLocal, 1.0));\n}\n"},xjMu:function(e,t,n){"use strict";var i=n("q1z7"),r=n.n(i),a=n("QLQS"),o=n("Bozv"),s=n("eDuk"),u=n.n(s),l=n("OL4R"),c=n("oaNE"),h=a.a.osg,d=Object(l.a)(a.a.osg.CullFace),f=r.a.Model,p=function(e){return Array.isArray(e)||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array},g=f.extend({initialize:function(){if(f.prototype.initialize.apply(this,arguments),this._featureSchema=this.getSubSchema(this.getModelOptionPath()),this._featureSchema){this._typeMap={},this._buildTypeMap(this._featureSchema,this._typeMap);var e=this.getInstance();this.initDefaults(e)}},getModelOptionPath:function(){return""},getSubSchema:function(e,t){for(void 0===t&&(t=!0),e=e?0===e.indexOf("#")?e.substring(2).replace(/\//g,"."):"properties."+e.replace(/\./g,".properties."):"properties";e.indexOf(":")>0;){var n=e.split(":"),i=this._getAttribute(o,n[0]);if(i.patternProperties){var r=n[1].indexOf(".");r<0&&(r=n[1].length);var a=n[1].substring(0,r),s=Object.keys(i.patternProperties)[a];e=e.replace(":"+a,".patternProperties."+s)}}var u=this._getAttribute(o,e);if(u&&t)if(0===e.indexOf("definition")){u.definitions=Object(c.a)({},o.definitions);var l=e.split(".");l=l[l.length-1],delete u.definitions[l]}else u.definitions=o.definitions;return u},_getAttribute:function(e,t){for(var n=t.split(".");n.length&&(e=e[n.shift()]););return e},getInstance:function(e){return e||(e=this._featureSchema),this._instantiateFromSchema(e)},_getRequiredFields:function(e){var t=e.required?e.required.slice():void 0;return e.oneOf&&e.oneOf.length&&e.oneOf[0].required&&e.oneOf[0].required.length&&t.push(e.oneOf[0].required[0]),t},_instantiateFromSchema:function(e){if("object"===e.type){var t={},n=this._getRequiredFields(e);for(var i in e=e.properties?e.properties:e)if(!(n&&n.indexOf(i)<0)){var r=e[i];t[i]=this._instantiateAttribute(r)}return t}return this._instantiateAttribute(e)},_instantiateAttribute:function(e){var t=e.default;if(e.$ref){var n=e.$ref,i=this.getSubSchema(n,!1),r=this._instantiateFromSchema(i);return t&&("object"==typeof t?Object(c.a)(r,t):r=t),r}if(e.type){if(t&&"array"!==e.type)return t;switch(e.type){case"object":return this._instantiateFromSchema(e);case"array":var a;if(a=e.minItems?new Array(e.minItems):[],e.items)for(var o=e.items,s=0;s<a.length;s++)Array.isArray(e.items)&&(o=e.items[Object.keys(e.items)[s]]),a[s]=this._instantiateFromSchema(o);return a;case"number":case"integer":return 0;case"boolean":return!1;case"string":return e.enum?e.enum[0]:""}}},validate:function(e,t){var n=this._validator,i=t&&t.schema||this._featureSchema;n||(n=new u.a({allErrors:!0,removeAdditional:!0}).compile(i),this._validator=n);var r=[];if(n(e))return r;for(var a=0;a<n.errors.length;a++){var o,s=n.errors[a],l=s.dataPath.substring(1);if(l.indexOf("]")>=0&&(l=l.replace(/]/g,"")),"type"===s.keyword){if(null===(o=this._getAttribute(e,l))||void 0===o)continue;if(p(o))continue}"pattern"===s.keyword&&(o=this._getAttribute(e,l),-1!==l.indexOf("texture.uid")&&-1!==o.indexOf("tmp_"))||"required"!==s.keyword&&r.push(this._formatErrorMessage(s,l,t))}return r},_formatErrorMessage:function(e,t,n){var i;n&&n.context&&(i=n.context);var r=i?i+": ":"";if(r+=t.length?'"'+t+'" ':"",r+=e.message,"enum"===e.keyword){r+=": ";for(var a=0;a<e.params.allowedValues.length;a++){r+=e.params.allowedValues[a]+", "}}else"additionalProperties"===e.keyword&&(r+=" ("+e.params.additionalProperty+")");return r},setJSON:function(e,t){if(!this._featureSchema)return["Json Schema not initialized"];this._adaptJSON&&this._adaptJSON(e);var n,i=t||{};if(i.schema?(n={},this._buildTypeMap(i.schema,n)):(i.schema=this._featureSchema,n=this._typeMap),i.validate){var r=this.validate(e,i);if(r.length){if(!i.warnOnError)return console.error("Failed to validate json",e,r),r.join("\n");console.warn("Failed to validate json",e),console.warn(r.join("\n"))}}var a=this._flattenObject(e,n,i);return this.set(a),[]},_buildTypeMap:function(e,t){if(e.properties){var n=e.properties;for(var i in n){var r=n[i];"object"===r.type?(t[i]={},this._buildTypeMap(r,t[i])):r.type?t[i]=r.type:r.$ref&&(t[i]=r.$ref)}}else e.$ref&&this._buildTypeMap(this.getSubSchema(e.$ref,!1),t)},initDefaults:function(e){if(e){var t=this._flattenObject(e,this._typeMap);this.set(t)}},getJSON:function(e){if(!this._featureSchema)return["Json Schema not initialized"];var t=this.getInstance();if(e&&e.ignore)for(var n=0;n<e.ignore.length;n++){delete t[e.ignore[n]]}return this._populate(t,this._typeMap,"",e),t},_flattenObject:function(e,t,n){var i={},r=n&&n.ignore?n.ignore:void 0;for(var a in t)if(e.hasOwnProperty(a)&&!(r&&r.indexOf(a)>=0))if("object"==typeof t[a]){var o=this._flattenObject(e[a],t[a],n);for(var s in o)o.hasOwnProperty(s)&&(i[a+s.charAt(0).toUpperCase()+s.slice(1)]=o[s])}else void 0!==e[a]&&(i[a]=this._toModelType(e[a],t[a]));return i},_toModelType:function(e,t){return void 0===e?e:t.indexOf("vec2")>0||t.indexOf("unitVec2")>0?h.vec2.clone(e):t.indexOf("vec3")>0||t.indexOf("unitVec3")>0?h.vec3.clone(e):t.indexOf("vec4")>0||t.indexOf("unitVec4")>0?h.vec4.clone(e):t.indexOf("quaternion")>0?h.quat.clone(e):t.indexOf("matrix")>0?h.mat4.clone(e):t.indexOf("cullFace")>0?h.CullFace[e]:e},_toJsonType:function(e,t){return t.indexOf("vec2")>0||t.indexOf("unitVec2")>0||t.indexOf("vec3")>0||t.indexOf("unitVec3")>0||t.indexOf("vec4")>0||t.indexOf("unitVec4")>0||t.indexOf("quaternion")>0||t.indexOf("matrix")>0?Array.prototype.slice.call(e):t.indexOf("cullFace")>0?d[e]:e},_populate:function(e,t,n,i){for(var r in t)if(!(i&&i.ignore&&i.ignore.indexOf(r)>=0)){var a=n?n+r.charAt(0).toUpperCase()+r.slice(1):r;if("object"==typeof t[r])this._populate(e[r],t[r],a);else{var o=this.get(a);void 0!==o&&(e[r]=this._toJsonType(o,t[r]))}}}});t.a=g},xqmJ:function(e,t,n){"use strict";(function(e){var i=n("oTSI"),r=n("226B"),a=n.n(r),o=n("dZz+"),s=n("12sq"),u=Object(i.a)(function(){return a.a.connect(s.a.getstream.apiKey,null,s.a.getstream.appId,{location:s.a.getstream.location})}),l=Object(i.a)(function(){var e=o.a.me().get("streamFeedsCredentials").filter(function(e){return"notifications"===e.feedName})[0];return u().feed(e.feedName,e.feedId,e.token)}),c=Object(i.a)(function(){var e=o.a.me().get("streamFeedsCredentials").filter(function(e){return"models"===e.feedName})[0];return u().feed(e.feedName,e.feedId,e.token)});t.a={subscribeToActivities:function(){if(!o.a.me().isAuthenticated())return e.reject();var t=l();return t.subscribe.apply(t,arguments)},subscribeToModels:function(){if(!o.a.me().isAuthenticated())return e.reject();var t=c();return t.subscribe.apply(t,arguments)}}}).call(this,n("CSL1"))},xszh:function(e,t,n){"use strict";var i=n("OL4R"),r=n("QLQS"),a=n("tNdj"),o=n("B306"),s=n("joy8"),u=r.a.osg,l=Object(i.a)(u.Texture),c=["magFilter","minFilter","wrapS","wrapT","textureTarget","internalFormat"],h=a.a.extend({initialize:function(){if(a.a.prototype.initialize.apply(this,arguments),this.attributes.image){var e=o.a.createValidOptionsForMaterial(this.attributes);this.set(e),this.setMultiresTextureFromValidOptions(e),void 0===this.get("texCoordUnit")&&this.set("texCoordUnit",0),this.bind("change:image",this.updateMultiresTexture,this)}else u.error("no image found in attributes, TextureModel invalid")},getImageModel:function(){return this.get("image")},setImageModel:function(e){this.set("image",e)},getResourceManager:function(){return this._resourceManager||s.default.instance},getMultiresTexture:function(){return this.get("multiresTexture")},getURL:function(){console.trace("dont call TextureModel.getURL")},setMultiresTextureFromValidOptions:function(e){var t=this.get("image").getUID(),n=this.getResourceManager().getOrCreateMultiresTexture(t,e);n&&this.set("multiresTexture",n.resource)},updateMultiresTexture:function(){this.setMultiresTextureFromValidOptions(o.a.createValidOptionsForMaterial(this.attributes))},isLuminance:function(){return this.get("internalFormat")===u.Texture.LUMINANCE},isAlpha:function(){return this.get("internalFormat")===u.Texture.ALPHA},getUID:function(){return this.getImageModel().getUID()},getJSON:function(){for(var e={},t=0,n=c.length;t<n;++t){var i=c[t];e[i]=l[this.get(i)]}return e.texCoordUnit=this.get("texCoordUnit"),e.uid=this.getUID(),e}});t.a=h},xvcl:function(e,t,n){"use strict";var i=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&!navigator.userAgent.match("CriOS");t.a=i},yLV6:function(e,t,n){var i;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(r,a,o,s){"use strict";var u,l=["","webkit","Moz","MS","ms","o"],c=a.createElement("div"),h="function",d=Math.round,f=Math.abs,p=Date.now;function g(e,t,n){return setTimeout(x(e,n),t)}function m(e,t,n){return!!Array.isArray(e)&&(v(e,n[t],n),!0)}function v(e,t,n){var i;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==s)for(i=0;i<e.length;)t.call(n,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function _(e,t,n){var i="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=r.console&&(r.console.warn||r.console.log);return a&&a.call(r.console,i,n),e.apply(this,arguments)}}u="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==s&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t}:Object.assign;var b=_(function(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;)(!n||n&&e[i[r]]===s)&&(e[i[r]]=t[i[r]]),r++;return e},"extend","Use `assign`."),S=_(function(e,t){return b(e,t,!0)},"merge","Use `assign`.");function y(e,t,n){var i,r=t.prototype;(i=e.prototype=Object.create(r)).constructor=e,i._super=r,n&&u(i,n)}function x(e,t){return function(){return e.apply(t,arguments)}}function C(e,t){return typeof e==h?e.apply(t&&t[0]||s,t):e}function w(e,t){return e===s?t:e}function T(e,t,n){v(O(t),function(t){e.addEventListener(t,n,!1)})}function M(e,t,n){v(O(t),function(t){e.removeEventListener(t,n,!1)})}function E(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function A(e,t){return e.indexOf(t)>-1}function O(e){return e.trim().split(/\s+/g)}function R(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function P(e){return Array.prototype.slice.call(e,0)}function I(e,t,n){for(var i=[],r=[],a=0;a<e.length;){var o=t?e[a][t]:e[a];R(r,o)<0&&i.push(e[a]),r[a]=o,a++}return n&&(i=t?i.sort(function(e,n){return e[t]>n[t]}):i.sort()),i}function N(e,t){for(var n,i,r=t[0].toUpperCase()+t.slice(1),a=0;a<l.length;){if((i=(n=l[a])?n+r:t)in e)return i;a++}return s}var L=1;function k(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||r}var D="ontouchstart"in r,F=N(r,"PointerEvent")!==s,V=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B=25,U=1,j=2,G=4,H=8,z=1,W=2,q=4,X=8,Y=16,K=W|q,Q=X|Y,J=K|Q,Z=["x","y"],$=["clientX","clientY"];function ee(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){C(e.options.enable,[e])&&n.handler(t)},this.init()}function te(e,t,n){var i=n.pointers.length,r=n.changedPointers.length,a=t&U&&i-r==0,o=t&(G|H)&&i-r==0;n.isFirst=!!a,n.isFinal=!!o,a&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,i=t.pointers,r=i.length;n.firstInput||(n.firstInput=ne(t));r>1&&!n.firstMultiple?n.firstMultiple=ne(t):1===r&&(n.firstMultiple=!1);var a=n.firstInput,o=n.firstMultiple,u=o?o.center:a.center,l=t.center=ie(i);t.timeStamp=p(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=se(u,l),t.distance=oe(u,l),function(e,t){var n=t.center,i=e.offsetDelta||{},r=e.prevDelta||{},a=e.prevInput||{};t.eventType!==U&&a.eventType!==G||(r=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y});t.deltaX=r.x+(n.x-i.x),t.deltaY=r.y+(n.y-i.y)}(n,t),t.offsetDirection=ae(t.deltaX,t.deltaY);var c=re(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=f(c.x)>f(c.y)?c.x:c.y,t.scale=o?function(e,t){return oe(t[0],t[1],$)/oe(e[0],e[1],$)}(o.pointers,i):1,t.rotation=o?function(e,t){return se(t[1],t[0],$)+se(e[1],e[0],$)}(o.pointers,i):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,i,r,a,o=e.lastInterval||t,u=t.timeStamp-o.timeStamp;if(t.eventType!=H&&(u>B||o.velocity===s)){var l=t.deltaX-o.deltaX,c=t.deltaY-o.deltaY,h=re(u,l,c);i=h.x,r=h.y,n=f(h.x)>f(h.y)?h.x:h.y,a=ae(l,c),e.lastInterval=t}else n=o.velocity,i=o.velocityX,r=o.velocityY,a=o.direction;t.velocity=n,t.velocityX=i,t.velocityY=r,t.direction=a}(n,t);var h=e.element;E(t.srcEvent.target,h)&&(h=t.srcEvent.target);t.target=h}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function ne(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:d(e.pointers[n].clientX),clientY:d(e.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:t,center:ie(t),deltaX:e.deltaX,deltaY:e.deltaY}}function ie(e){var t=e.length;if(1===t)return{x:d(e[0].clientX),y:d(e[0].clientY)};for(var n=0,i=0,r=0;r<t;)n+=e[r].clientX,i+=e[r].clientY,r++;return{x:d(n/t),y:d(i/t)}}function re(e,t,n){return{x:t/e||0,y:n/e||0}}function ae(e,t){return e===t?z:f(e)>=f(t)?e<0?W:q:t<0?X:Y}function oe(e,t,n){n||(n=Z);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(i*i+r*r)}function se(e,t,n){n||(n=Z);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return 180*Math.atan2(r,i)/Math.PI}ee.prototype={handler:function(){},init:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(k(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(k(this.element),this.evWin,this.domHandler)}};var ue={mousedown:U,mousemove:j,mouseup:G},le="mousedown",ce="mousemove mouseup";function he(){this.evEl=le,this.evWin=ce,this.pressed=!1,ee.apply(this,arguments)}y(he,ee,{handler:function(e){var t=ue[e.type];t&U&&0===e.button&&(this.pressed=!0),t&j&&1!==e.which&&(t=G),this.pressed&&(t&G&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var de={pointerdown:U,pointermove:j,pointerup:G,pointercancel:H,pointerout:H},fe={2:"touch",3:"pen",4:"mouse",5:"kinect"},pe="pointerdown",ge="pointermove pointerup pointercancel";function me(){this.evEl=pe,this.evWin=ge,ee.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(pe="MSPointerDown",ge="MSPointerMove MSPointerUp MSPointerCancel"),y(me,ee,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),r=de[i],a=fe[e.pointerType]||e.pointerType,o="touch"==a,s=R(t,e.pointerId,"pointerId");r&U&&(0===e.button||o)?s<0&&(t.push(e),s=t.length-1):r&(G|H)&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),n&&t.splice(s,1))}});var ve={touchstart:U,touchmove:j,touchend:G,touchcancel:H},_e="touchstart",be="touchstart touchmove touchend touchcancel";function Se(){this.evTarget=_e,this.evWin=be,this.started=!1,ee.apply(this,arguments)}y(Se,ee,{handler:function(e){var t=ve[e.type];if(t===U&&(this.started=!0),this.started){var n=function(e,t){var n=P(e.touches),i=P(e.changedTouches);t&(G|H)&&(n=I(n.concat(i),"identifier",!0));return[n,i]}.call(this,e,t);t&(G|H)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}});var ye={touchstart:U,touchmove:j,touchend:G,touchcancel:H},xe="touchstart touchmove touchend touchcancel";function Ce(){this.evTarget=xe,this.targetIds={},ee.apply(this,arguments)}y(Ce,ee,{handler:function(e){var t=ye[e.type],n=function(e,t){var n=P(e.touches),i=this.targetIds;if(t&(U|j)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,a,o=P(e.changedTouches),s=[],u=this.target;if(a=n.filter(function(e){return E(e.target,u)}),t===U)for(r=0;r<a.length;)i[a[r].identifier]=!0,r++;r=0;for(;r<o.length;)i[o[r].identifier]&&s.push(o[r]),t&(G|H)&&delete i[o[r].identifier],r++;if(!s.length)return;return[I(a.concat(s),"identifier",!0),s]}.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}});var we=2500,Te=25;function Me(){ee.apply(this,arguments);var e=x(this.handler,this);this.touch=new Ce(this.manager,e),this.mouse=new he(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Ee(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout(function(){var e=i.indexOf(n);e>-1&&i.splice(e,1)},we)}}y(Me,ee,{handler:function(e,t,n){var i="touch"==n.pointerType,r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)(function(e,t){e&U?(this.primaryTouch=t.changedPointers[0].identifier,Ee.call(this,t)):e&(G|H)&&Ee.call(this,t)}).call(this,t,n);else if(r&&function(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],a=Math.abs(t-r.x),o=Math.abs(n-r.y);if(a<=Te&&o<=Te)return!0}return!1}.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ae=N(c.style,"touchAction"),Oe=Ae!==s,Re="auto",Pe="manipulation",Ie="none",Ne="pan-x",Le="pan-y",ke=function(){if(!Oe)return!1;var e={},t=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||r.CSS.supports("touch-action",n)}),e}();function De(e,t){this.manager=e,this.set(t)}De.prototype={set:function(e){"compute"==e&&(e=this.compute()),Oe&&this.manager.element.style&&ke[e]&&(this.manager.element.style[Ae]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return v(this.manager.recognizers,function(t){C(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(A(e,Ie))return Ie;var t=A(e,Ne),n=A(e,Le);if(t&&n)return Ie;if(t||n)return t?Ne:Le;if(A(e,Pe))return Pe;return Re}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var i=this.actions,r=A(i,Ie)&&!ke[Ie],a=A(i,Le)&&!ke[Le],o=A(i,Ne)&&!ke[Ne];if(r){var s=1===e.pointers.length,u=e.distance<2,l=e.deltaTime<250;if(s&&u&&l)return}if(!o||!a)return r||a&&n&K||o&&n&Q?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Fe=1,Ve=2,Be=4,Ue=8,je=Ue,Ge=16;function He(e){this.options=u({},this.defaults,e||{}),this.id=L++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=Fe,this.simultaneous={},this.requireFail=[]}function ze(e){return e&Ge?"cancel":e&Ue?"end":e&Be?"move":e&Ve?"start":""}function We(e){return e==Y?"down":e==X?"up":e==W?"left":e==q?"right":""}function qe(e,t){var n=t.manager;return n?n.get(e):e}function Xe(){He.apply(this,arguments)}function Ye(){Xe.apply(this,arguments),this.pX=null,this.pY=null}function Ke(){Xe.apply(this,arguments)}function Qe(){He.apply(this,arguments),this._timer=null,this._input=null}function Je(){Xe.apply(this,arguments)}function Ze(){Xe.apply(this,arguments)}function $e(){He.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function et(e,t){return(t=t||{}).recognizers=w(t.recognizers,et.defaults.preset),new tt(e,t)}He.prototype={defaults:{},set:function(e){return u(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(m(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=qe(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return m(e,"dropRecognizeWith",this)?this:(e=qe(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(m(e,"requireFailure",this))return this;var t=this.requireFail;return-1===R(t,e=qe(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(m(e,"dropRequireFailure",this))return this;e=qe(e,this);var t=R(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function i(n){t.manager.emit(n,e)}n<Ue&&i(t.options.event+ze(n)),i(t.options.event),e.additionalEvent&&i(e.additionalEvent),n>=Ue&&i(t.options.event+ze(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|Fe)))return!1;e++}return!0},recognize:function(e){var t=u({},e);if(!C(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(je|Ge|32)&&(this.state=Fe),this.state=this.process(t),this.state&(Ve|Be|Ue|Ge)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},y(Xe,He,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=t&(Ve|Be),r=this.attrTest(e);return i&&(n&H||!r)?t|Ge:i||r?n&G?t|Ue:t&Ve?t|Be:Ve:32}}),y(Ye,Xe,{defaults:{event:"pan",threshold:10,pointers:1,direction:J},getTouchAction:function(){var e=this.options.direction,t=[];return e&K&&t.push(Le),e&Q&&t.push(Ne),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,r=e.direction,a=e.deltaX,o=e.deltaY;return r&t.direction||(t.direction&K?(r=0===a?z:a<0?W:q,n=a!=this.pX,i=Math.abs(e.deltaX)):(r=0===o?z:o<0?X:Y,n=o!=this.pY,i=Math.abs(e.deltaY))),e.direction=r,n&&i>t.threshold&&r&t.direction},attrTest:function(e){return Xe.prototype.attrTest.call(this,e)&&(this.state&Ve||!(this.state&Ve)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=We(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),y(Ke,Xe,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Ve)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),y(Qe,He,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Re]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!i||!n||e.eventType&(G|H)&&!r)this.reset();else if(e.eventType&U)this.reset(),this._timer=g(function(){this.state=je,this.tryEmit()},t.time,this);else if(e.eventType&G)return je;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===je&&(e&&e.eventType&G?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),y(Je,Xe,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Ve)}}),y(Ze,Xe,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:K|Q,pointers:1},getTouchAction:function(){return Ye.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(K|Q)?t=e.overallVelocity:n&K?t=e.overallVelocityX:n&Q&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&f(t)>this.options.velocity&&e.eventType&G},emit:function(e){var t=We(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),y($e,He,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),e.eventType&U&&0===this.count)return this.failTimeout();if(i&&r&&n){if(e.eventType!=G)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||oe(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&a?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=g(function(){this.state=je,this.tryEmit()},t.interval,this),Ve):je}return 32},failTimeout:function(){return this._timer=g(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==je&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),et.VERSION="2.0.7",et.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Je,{enable:!1}],[Ke,{enable:!1},["rotate"]],[Ze,{direction:K}],[Ye,{direction:K},["swipe"]],[$e],[$e,{event:"doubletap",taps:2},["tap"]],[Qe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function tt(e,t){this.options=u({},et.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=function(e){var t=e.options.inputClass;return new(t||(F?me:V?Ce:D?Me:he))(e,te)}(this),this.touchAction=new De(this,this.options.touchAction),nt(this,!0),v(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function nt(e,t){var n,i=e.element;i.style&&(v(e.options.cssProps,function(r,a){n=N(i.style,a),t?(e.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}tt.prototype={set:function(e){return u(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var i=this.recognizers,r=t.curRecognizer;(!r||r&&r.state&je)&&(r=t.curRecognizer=null);for(var a=0;a<i.length;)n=i[a],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&n.state&(Ve|Be|Ue)&&(r=t.curRecognizer=n),a++}},get:function(e){if(e instanceof He)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(m(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(m(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=R(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var n=this.handlers;return v(O(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==s){var n=this.handlers;return v(O(e),function(e){t?n[e]&&n[e].splice(R(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=a.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](t),i++}},destroy:function(){this.element&&nt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(et,{INPUT_START:U,INPUT_MOVE:j,INPUT_END:G,INPUT_CANCEL:H,STATE_POSSIBLE:Fe,STATE_BEGAN:Ve,STATE_CHANGED:Be,STATE_ENDED:Ue,STATE_RECOGNIZED:je,STATE_CANCELLED:Ge,STATE_FAILED:32,DIRECTION_NONE:z,DIRECTION_LEFT:W,DIRECTION_RIGHT:q,DIRECTION_UP:X,DIRECTION_DOWN:Y,DIRECTION_HORIZONTAL:K,DIRECTION_VERTICAL:Q,DIRECTION_ALL:J,Manager:tt,Input:ee,TouchAction:De,TouchInput:Ce,MouseInput:he,PointerEventInput:me,TouchMouseInput:Me,SingleTouchInput:Se,Recognizer:He,AttrRecognizer:Xe,Tap:$e,Pan:Ye,Swipe:Ze,Pinch:Ke,Rotate:Je,Press:Qe,on:T,off:M,each:v,merge:S,extend:b,assign:u,inherit:y,bindFn:x,prefixed:N}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=et,(i=function(){return et}.call(t,n,t,e))===s||(e.exports=i)}(window,document)},yOYh:function(e,t,n){"use strict";var i=n("pVnL"),r=n.n(i),a=n("QILm"),o=n.n(a),s=n("q1tI"),u=n("YO6B"),l=n("wsGC");t.a=function(e){var t=e.avatars,n=e.size,i=void 0===n?32:n,a=e.className,c=e.shape,h=o()(e,["avatars","size","className","shape"]);return s.createElement(u.a,r()({className:Object(l.a)("c-user-avatar",a,{"--round":"round"===c})},h,{images:t,height:i,width:i}))}},yWLT:function(e,t,n){"use strict";var i=n("QLQS"),r=n("/s5t"),a=n("par7"),o=i.a.osg,s=function(e,t){this._color=e,this._colorDelta=o.vec4.create(),this._lastRatio=0,r.a.call(this,t),this._finished=!0,this._disableAfterFinished=!1,this._finishCallback=void 0,this._lastFrame=0};o.createPrototypeObject(s,o.objectInherit(r.a.prototype,{hide:function(){o.vec3.init(this._colorDelta),this._colorDelta[3]=-this._color[3],this._disableAfterFinished=!0,this._lastRatio=0,this.reset()},show:function(e){o.vec3.init(this._colorDelta),this._colorDelta[3]=void 0!==e?e:1-this._color[3],this._disableAfterFinished=!1,this._lastRatio=0,this.reset()},setColorTarget:function(e){o.vec4.sub(this._colorDelta,e,this._color),this._disableAfterFinished=!1,this._lastRatio=0,this.reset()},setFinishCallback:function(e){this._finishCallback=e},finished:function(){!0===this._disableAfterFinished&&this._finishCallback&&this._finishCallback()},update:function(e,t){if(!0===this._finished)return!0;a.a.draw();var n=t.getFrameStamp(),i=n.getFrameNumber();if(this._lastFrame===i)return!0;this._lastFrame=i;var r=n.getSimulationTime(),s=this.interpolate(r,e,t),u=(s=o.smoothStep(0,1,s))-this._lastRatio;return this._lastRatio=s,o.vec4.scaleAndAdd(this._color,this._color,this._colorDelta,u),!0}})),t.a=s},yYum:function(e,t){e.exports='attribute float Offset;\nuniform float uScale;\n\n#define HAS_MODEL_VERTEX\n#define HAS_MODEL_NORMAL\n\n#define INJECT_VERT gl_Position = uProjectionMatrix * uViewMatrix * vec4(Offset == 1.0 ? vModelVertex + normalize(vModelNormal) * uScale : vModelVertex, 1.0);\n\n#pragma include "base.vert"\n'},yktj:function(e,t,n){"use strict";t.a={name:"internal",domain:"/i",parse:function(e){return e.results||[]}}},z206:function(e,t){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["skfb_front/macros/components/molecules/popup.jinja"]={root:function(e,t,n,i,r){var a="";try{var o=i.makeMacro([],["options"],function(r){var a=n;n=new i.Frame,(r=r||{}).hasOwnProperty("caller")&&n.set("caller",r.caller),n.set("options",r.hasOwnProperty("options")?r.options:{});var o="";return o+='\n    <section\n        style="',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"width")?"width:"+i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"width")+"px":"",e.opts.autoescape),o+='"\n        class="c-popup ',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"className"),e.opts.autoescape),o+='">\n        ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"title")&&(o+='\n            <header class="c-popup__header">\n                <div class="c-popup__title">\n                    ',o+=i.suppressValue(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"title"),e.opts.autoescape),o+='\n                </div>\n\n                <div class="c-popup__actions">\n                    ',i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"isClosable")&&(o+='\n                        <a data-selenium="close-popup" class="c-popup__close" data-action="close" arial-label="Close popup">\n                            <i class="fa fa-times"></i>\n                        </a>\n                    '),o+="\n                </div>\n            </header>\n        "),o+='\n\n        <div class="c-popup__content c-popup__full-height">\n            ',o+=i.suppressValue(e.getFilter("component").call(t,i.memberLookup(i.memberLookup(i.contextOrFrameLookup(t,n,"options"),"components"),"child")),e.opts.autoescape),o+="\n        </div>\n    </section>\n",n=a,new i.SafeString(o)});t.addExport("popup"),t.setVariable("popup",o),r(null,a+="\n")}catch(e){r(i.handleError(e,null,null))}}}},zB1R:function(e,t,n){"use strict";var i=n("icjm"),r=n("a3nb"),a=n("KL/6"),o=n("r7P/"),s=n("62xh"),u=n("R3Hf"),l=n("czSk"),c=n("GhR1"),h=n("6ZYx"),d=n("QD80"),f=n("4KCM"),p=n("olBt"),g=n("wwkN"),m=n("Usex"),v=n("jYW0"),_=n("05ve"),b=n("Vx0a"),S=n("JNWj"),y=n("CPsH"),x=n("Wx9w"),C=n("YVF9"),w=n("LTZp"),T=n("/pUn"),M=n("hLWu"),E=n("gHdx"),A=n("WqyB"),O=n("b/No"),R=n("EnLC"),P=function(){return new m.a},I=function(){return new s.a},N=function(){o.a.call(this,o.a.TRAVERSE_ACTIVE_CHILDREN),s.a.call(this),u.a.call(this),this._rootStateGraph=void 0,this._currentStateGraph=void 0,this._currentRenderBin=void 0,this._currentRenderStage=void 0,this._rootRenderStage=void 0,this._computedNear=Number.POSITIVE_INFINITY,this._computedFar=Number.NEGATIVE_INFINITY,this._camera=void 0,this._pooledLeaf=new R.a(P),this._pooledRenderStages={},this._pooledCullSettings=new R.a(I),this._renderBinStack=new O.a,this.visitorType=o.a.CULL_VISITOR,this._identityMatrix=l.c.create(),this._renderer=void 0,this._renderStageType=_.a,this._numCamera=0,this._numMatrixTransform=0,this._numProjection=0,this._numNode=0,this._numLightSource=0,this._numGeometry=0};N.registerApplyFunction=p.default.registerApplyFunction,N.getApplyFunction=p.default.getApplyFunction,r.a.createPrototypeObject(N,r.a.objectInherit(u.a.prototype,r.a.objectInherit(o.a.prototype,{applyFunctionArray:p.default.applyFunctionArray,distance:function(e,t){return-(e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+t[14])},getComputedNear:function(){return this._computedNear},getComputedFar:function(){return this._computedFar},resetStats:function(){this._numCamera=0,this._numMatrixTransform=0,this._numProjection=0,this._numNode=0,this._numLightSource=0,this._numGeometry=0},handleCullCallbacksAndTraverse:function(e){var t=e.getCullCallback();t&&!t.cull(e,this)||this.traverse(e)},getCurrentCamera:function(){return this._currentRenderBin.getStage().getCamera()},updateCalculatedNearFar:function(){var e=l.f.create(),t=l.f.create();return function(n,i){var r,a,o=i.getBoundingBox();if((r=this.distance(o.corner(this._bbCornerNear,e),n))>(a=this.distance(o.corner(this._bbCornerFar,t),n))){var s=r;r=a,a=s}return!(a<0)&&(r<this._computedNear&&(this._computedNear=r),a>this._computedFar&&(this._computedFar=a),!0)}}(),setStateGraph:function(e){this._rootStateGraph=e,this._currentStateGraph=e},setRenderStage:function(e){this._rootRenderStage=e,this._currentRenderBin=e},setRenderer:function(e){this._renderer=e},getRenderer:function(){return this._renderer},reset:function(){for(var e in u.a.prototype.reset.call(this),this._pooledLeaf.reset(),this._pooledCullSettings.reset(),this._pooledRenderStages)this._pooledRenderStages[e].reset();v.a.reset(),this._computedNear=Number.POSITIVE_INFINITY,this._computedFar=Number.NEGATIVE_INFINITY},getCurrentRenderBin:function(){return this._currentRenderBin},setCurrentRenderBin:function(e){this._currentRenderBin=e},addPositionedAttribute:function(e,t){var n=e||this._identityMatrix;this._currentRenderBin.getStage().addPositionAttribute(n,t)},pushStateSet:function(e){if(this._currentStateGraph=this._currentStateGraph.findOrInsert(e),void 0!==e.getBinName()){var t=this._renderBinStack,n=this._currentRenderBin;t.push(n),this._currentRenderBin=n.getStage().findOrInsert(e.getBinNumber(),e.getBinName())}},popStateSet:function(){var e=this._currentStateGraph,t=e.getStateSet();if(this._currentStateGraph=e.getParent(),void 0!==t.getBinName()){var n=this._renderBinStack;0===n.getLength()?this._currentRenderBin=this._currentRenderBin.getStage():this._currentRenderBin=n.pop()}},popProjectionMatrix:function(){if(!0===this._computeNearFar&&this._computedFar>=this._computedNear){var e=this.getCurrentProjectionMatrix();void 0!==this._clampProjectionMatrixCallback?this._clampProjectionMatrixCallback(e,this._computedNear,this._computedFar,this._nearFarRatio):this.clampProjectionMatrix(e,this._computedNear,this._computedFar,this._nearFarRatio)}u.a.prototype.popProjectionMatrix.call(this)},clampProjectionMatrix:function(e,t,n,r,a){var o,s;if(n<t-1e-6)return i.a.log("clampProjectionMatrix not applied, invalid depth range, znear = "+t+"  zfar = "+n,!1,!0),!1;if(n<t+1e-6){var u=.5*(t+n);t=u-1e-6,n=u+1e-6}if(Math.abs(e[3])<1e-6&&Math.abs(e[7])<1e-6&&Math.abs(e[11])<1e-6){var l=.02*(n-t);l<1&&(l=1),t=o=t-l,n=s=n+l,e[10]=-2/(s-o),e[14]=-(s+o)/(s-o)}else{s=1.02*n;var c=n*r;(o=.98*t)<c&&(o=c),t=o,n=s;var h=e[10],d=e[14],f=e[11],p=e[15],g=(-o*h+d)/(-o*f+p),m=(-s*h+d)/(-s*f+p),v=Math.abs(2/(g-m)),_=-(g+m)/2*v;e[2]=e[2]*v+e[3]*_,e[6]=e[6]*v+e[7]*_,e[10]=h*v+f*_,e[14]=d*v+p*_}return void 0!==a&&(a[0]=t,a[1]=n),!0},popCameraModelViewProjectionMatrix:function(){this.popModelViewMatrix(),this.popProjectionMatrix()},pushCameraModelViewProjectionMatrix:function(e,t,n){this.pushModelViewMatrix(t),this.pushProjectionMatrix(n)},apply:function(e){this.applyFunctionArray[e.nodeTypeID].call(this,e)},createOrReuseRenderLeaf:function(){return this._pooledLeaf.getOrCreateObject()},createOrReuseRenderStage:function(e){var t=e?e.className():"RenderStage";if(!this._pooledRenderStages[t]){var n=e?e.constructor:_.a;this._pooledRenderStages[t]=new R.a(function(){return new n})}return this._pooledRenderStages[t].getOrCreateObject().init()},postPushGeometry:function(e,t){var n,i;t instanceof M.a?((i=t.getStateSetAnimation())&&e.pushStateSet(i),(n=t.getSourceGeometry())instanceof A.a&&(i=n.getStateSetAnimation())&&e.pushStateSet(i)):t instanceof A.a&&(i=t.getStateSetAnimation())&&e.pushStateSet(i)},prePopGeometry:function(e,t){if(t instanceof M.a){var n=t.getSourceGeometry();n instanceof A.a&&n.getStateSetAnimation()&&e.popStateSet(),t.getStateSetAnimation()&&e.popStateSet()}else t instanceof A.a&&t.getStateSetAnimation()&&e.popStateSet()},pushLeaf:function(e,t){var n=this._currentStateGraph.getLeafs();n.getLength()||this._currentRenderBin.addStateGraph(this._currentStateGraph);var i=this.createOrReuseRenderLeaf();i.init(this._currentStateGraph,e,this.getCurrentProjectionMatrix(),this.getCurrentViewMatrix(),this.getCurrentModelViewMatrix(),this.getCurrentModelMatrix(),t),n.push(i)}})),"osg","CullVisitor");var L=function(e){if(this._numMatrixTransform++,!this.isCulled(e,this.nodePath)){this.pushCurrentMask();var t=this._pooledMatrix.getOrCreateObject(),n=this.getCurrentModelViewMatrix();l.c.copy(t,n),e.computeLocalToWorldMatrix(t),this.pushModelViewMatrix(t);var i=e.getStateSet();i&&this.pushStateSet(i),this.handleCullCallbacksAndTraverse(e),i&&this.popStateSet(),this.popModelViewMatrix(),this.popCurrentMask()}},k=function(e){if(this._numNode++,!this.isCulled(e,this.nodePath)){this.pushCurrentMask();var t=e.getStateSet();t&&this.pushStateSet(t),this.handleCullCallbacksAndTraverse(e),t&&this.popStateSet(),this.popCurrentMask()}},D=l.f.create(),F=!1,V=function(e){this._numGeometry++;var t=this.getCurrentModelViewMatrix(),n=e.getBoundingBox();if(!this._computeNearFar||!n.valid()||this.updateCalculatedNearFar(t,e)){var r=e.getCullCallback();if(!r||r.cull(e,this)){var o=e.getStateSet();o&&this.pushStateSet(o),this.postPushGeometry(this,e);var s=0;n.valid()&&(s=this.distance(n.center(D),t)),a.a.isNaN(s)?F||(i.a.warn("warning geometry has a NaN depth, "+t+" center "+D),F=!0):this.pushLeaf(e,s),this.prePopGeometry(this,e),o&&this.popStateSet()}}};p.default.registerApplyFunction(b.a.nodeTypeID,k),p.default.registerApplyFunction(y.a.nodeTypeID,k),p.default.registerApplyFunction(x.a.nodeTypeID,k),p.default.registerApplyFunction(C.a.nodeTypeID,function(e){this._numCamera++;var t=e.getStateSet();t&&this.pushStateSet(t);var n=this._pooledMatrix.getOrCreateObject(),i=this._pooledMatrix.getOrCreateObject();if(e.getReferenceFrame()===w.a.RELATIVE_RF){var r=this.getCurrentProjectionMatrix();l.c.mul(i,r,e.getProjectionMatrix());var a=this.getCurrentModelViewMatrix();l.c.mul(n,a,e.getViewMatrix())}else l.c.copy(n,e.getViewMatrix()),l.c.copy(i,e.getProjectionMatrix());var o=this._computedNear,s=this._computedFar,u=this._pooledCullSettings.getOrCreateObject();if(u.reset(),u.setCullSettings(this),this._computedNear=Number.POSITIVE_INFINITY,this._computedFar=Number.NEGATIVE_INFINITY,this.setCullSettings(e),u.getSettingSourceOverrider()===this&&u.getEnableFrustumCulling()&&this.setEnableFrustumCulling(!0),this.pushCameraModelViewProjectionMatrix(e,n,i),e.getViewport()&&this.pushViewport(e.getViewport()),e.getRenderOrder()===C.a.NESTED_RENDER)this.handleCullCallbacksAndTraverse(e);else{var c=this.getCurrentRenderBin(),h=c.getStage(),d=this.createOrReuseRenderStage(this._rootRenderStage);d.setCamera(e),d.setClearDepth(e.getClearDepth()),d.setClearColor(e.getClearColor()),d.setClearMask(e.getClearMask());var f=e.getViewport()?e.getViewport():h.getViewport(),p=e.getScissor()?e.getScissor():h.getScissor();d.setViewport(f),d.setScissor(p),this.setCurrentRenderBin(d),this.handleCullCallbacksAndTraverse(e),this.setCurrentRenderBin(c),e.getRenderOrder()===C.a.PRE_RENDER?this.getCurrentRenderBin().getStage().addPreRenderStage(d,e.renderOrderNum):this.getCurrentRenderBin().getStage().addPostRenderStage(d,e.renderOrderNum)}this.popCameraModelViewProjectionMatrix(e),e.getViewport()&&this.popViewport(),this.setCullSettings(u),this._computedNear=o,this._computedFar=s,t&&this.popStateSet()}),p.default.registerApplyFunction(c.a.nodeTypeID,L),p.default.registerApplyFunction(d.a.nodeTypeID,function(e){this._numProjection++;var t=this.getCurrentProjectionMatrix(),n=this._pooledMatrix.getOrCreateObject();l.c.mul(n,t,e.getProjectionMatrix()),this.pushProjectionMatrix(n);var i=e.getStateSet();i&&this.pushStateSet(i),this.handleCullCallbacksAndTraverse(e),i&&this.popStateSet(),this.popProjectionMatrix()}),p.default.registerApplyFunction(g.a.nodeTypeID,V),p.default.registerApplyFunction(T.a.nodeTypeID,L),p.default.registerApplyFunction(E.a.nodeTypeID,L),p.default.registerApplyFunction(h.a.nodeTypeID,L),p.default.registerApplyFunction(S.a.nodeTypeID,k),p.default.registerApplyFunction(f.a.nodeTypeID,function(e){this._numLightSource++;var t=e.getStateSet();t&&this.pushStateSet(t);var n=e.getLight();n&&(e.getReferenceFrame()===w.a.RELATIVE_RF?this.addPositionedAttribute(this.getCurrentModelViewMatrix(),n):this.addPositionedAttribute(null,n)),this.handleCullCallbacksAndTraverse(e),t&&this.popStateSet()}),p.default.registerApplyFunction(M.a.nodeTypeID,V),p.default.registerApplyFunction(A.a.nodeTypeID,V),t.a=N},zE1p:function(e,t){e.exports='#pragma include "utils/getLuminance.glsl"\n#pragma include "utils/decodeDepth.glsl"\n\nuniform sampler2D TextureInput;\n\n#ifdef HAS_BACKGROUND\nuniform sampler2D TextureDepth;\n#endif\n\nuniform float uBloomThreshold;\n\nvec3 extractBright(const in vec3 color) {\n    // TODO manage hdr pixel with high frequency? (use derivative??), for now we clamp the extracted pixel :(\n    return clamp(color * clamp(getLuminance(color) - uBloomThreshold, 0.0, 1.0), 0.0, 1.0);\n}\n\nvec4 bloomExtract() {\n    vec3 color = TEXTURE_2D_TextureInput(gTexCoord).rgb;\n\n#ifdef HAS_BACKGROUND\n\tfloat alpha = decodeAlpha(TEXTURE_2D_TextureDepth(gTexCoord));\n\tif(alpha == 0.0) {\n\t\treturn vec4(vec3(0.0), 1.0);\n    }\n#else\n\tfloat alpha = 1.0;\n#endif\n\n\treturn vec4(extractBright(color * alpha), 1.0);\n}'},"zP/P":function(e,t,n){"use strict";var i=function(){var e=window||global;if(void 0===e.performance)return function(){return Date.now()};var t=e.performance.now||e.performance.mozNow||e.performance.msNow||e.performance.oNow||e.performance.webkitNow||function(){return Date.now()};return function(){return t.apply(e.performance,arguments)}}(),r=function(){};r.instance=function(){return r._instance||(r._instance=new r),r._instance},r.tick=i,r.prototype={deltaS:function(e,t){return(t-e)/1e3},deltaM:function(e,t){return t-e},tick:function(){return i()}},t.a=r},zWCM:function(e,t,n){"use strict";var i=n("czSk"),r=n("LTZp");t.a={computeLocalToWorld:function(e,t,n,a){var o=t,s=void 0!==a?a:e.length;void 0===o&&(o=!0);var u=n||i.c.create(),l=0;if(o){for(l=s-1;l>=0;l--){var c=e[l];if("Camera"===c.className()&&(c.getReferenceFrame()!==r.a.RELATIVE_RF||0===c.getParents().length))break}l+=1}for(var h=l,d=s;h<d;h++){var f=e[h];f.computeLocalToWorldMatrix&&f.computeLocalToWorldMatrix(u)}return u}}},zeFU:function(e,t,n){"use strict";n.r(t);var i=n("9oTK"),r=n.n(i),a=n("a3nb"),o=n("IOd0"),s=n("hIgY"),u={prefixURL:"",databasePath:"",progressXHRCallback:void 0,readNodeURL:void 0,readImageURL:void 0,readBinaryArrayURL:void 0,imageLoadingUsePromise:!0,imageOnload:void 0,imageCrossOrigin:void 0},l=n("ljaD"),c=n.n(l),h=n("icjm"),d=n("HORL"),f=n("D1Qd"),p=n("SoBM"),g=n("qxX9"),m=n("OZCL"),v=n("QVk6"),_=a.a.rejectObject,b=function(e,t){this._json=e;var n=t;void 0===n&&(n={}),this._identifierMap=n,this._objectRegistry={},this._cacheReadObject={},this.setOptions(a.a.objectMix({},u))};b.imageFallback||(b.imageFallback=function(){var e=new window.Image;return e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2P8DwQACgAD/il4QJ8AAAAASUVORK5CYII=",e}()),b.prototype={clone:function(){var e=new b;return e._objectRegistry=this._objectRegistry,e._cacheReadObject=this._cacheReadObject,e},setOptions:function(e){this._defaultOptions=e},getOptions:function(){return this._defaultOptions},setProgressXHRCallback:function(e){this._defaultOptions.progressXHRCallback=e},setReadNodeURLCallback:function(e){this._defaultOptions.readNodeURL=e},registerObject:function(e,t){this._objectRegistry[e]=t},getJSON:function(){return this._json},setJSON:function(e){return this._json=e,this},setPrefixURL:function(e){this._defaultOptions.prefixURL=e},getPrefixURL:function(){return this._defaultOptions.prefixURL},setDatabasePath:function(e){this._defaultOptions.databasePath=e},getDatabasePath:function(){return this._defaultOptions.databasePath},computeURL:function(e){return"string"==typeof this._defaultOptions.prefixURL&&this._defaultOptions.prefixURL.length>0?this._defaultOptions.prefixURL+e:e},requestFile:function(e,t){return s.a.requestURI(e,t)},getObjectWrapper:function(e){if(this._objectRegistry[e])return new this._objectRegistry[e];for(var t=o.a,n=e.split("."),i=0,r=n.length;i<r;i++){var a=t[n[i]];if(void 0===a)return;t=a}return this._objectRegistry[e]=t,new t},fetchImage:function(e,t,n){var i="data:image/"===t.substring(0,"data:image/".length),a=new window.Image;return!i&&n.imageCrossOrigin&&(a.crossOrigin=n.imageCrossOrigin),e.setURL(t),e.setImage(a),a.src=t,new r.a(function(i){a.onerror=function(){h.a.warn("warning use white texture as fallback instead of "+t),e.setImage(b.imageFallback),i(e)},a.onload=function(){n.imageOnload&&n.imageOnload.call(e),i(e)}})},readImageURL:function(e,t){if(void 0===t&&(t=this._defaultOptions),t.readImageURL)return t.readImageURL.call(this,e,t);"data:image"!==e.substr(0,10)&&(e=this.computeURL(e));var n=new d.a;return this.fetchImage(n,e,t)},readNodeURL:function(e,t){var i=t;if(void 0===i&&(i=this._defaultOptions),i.readNodeURL)return i.readNodeURL.call(this,e,i);e=this.computeURL(e);var r=this;if(!(i=a.a.objectMix({},i)).prefixURL){var o=r.getPrefixURL(),s=e.lastIndexOf("/");-1!==s&&(o=e.substring(0,s+1)),i.prefixURL=o}var u=n("RTFJ").default,l=function(t){return u.parseSceneGraph(t,i).then(function(t){return h.a.log("loaded "+e),t})};return a.a.time("osgjs.metric:Input.readNodeURL",h.a.INFO),r.requestFile(e).then(function(t){var n;try{n=JSON.parse(t)}catch(t){h.a.error("cant parse url "+e+" try to gunzip")}return n?l(n):r.requestFile(e,{responseType:"arraybuffer"}).then(function(e){var t=function(e){function t(e){return e.length<2?"0"+e:e}var n=e;return c.a.isGunzipBuffer(e)&&(n=c.a.gunzip(e)),function(e){for(var n="",i=0,r=e.length;i<r;++i)n+="%"+t(e[i].toString(16));return n=decodeURIComponent(n)}(new Uint8Array(n))}(e);return n=JSON.parse(t),l(n)}).catch(function(t){var n="cant read file "+e+" status "+t;return h.a.error(n),n})}).catch(function(t){var n="cant get file "+e+" status "+t;return h.a.error(n),n}).finally(function(){a.a.timeEnd("osgjs.metric:Input.readNodeURL")})},_unzipTypedArray:function(e){var t=new Uint8Array(e);if(31===t[0]&&139===t[1]){var i=n("ljaD");return i||h.a.error("osg failed to use a gunzip.min.js to uncompress a gz file.\n You can add this vendors to enable this feature or adds the good header in your gzip file served by your server"),new i.Gunzip(t).decompress().buffer}return e},readBinaryArrayURL:function(e,t){if(void 0===t&&(t=this._defaultOptions),t.readBinaryArrayURL)return t.readBinaryArrayURL.call(this,e,t);if(e=this.computeURL(e),void 0!==this._identifierMap[e])return this._identifierMap[e];var n=this.requestFile(e,{responseType:"arraybuffer",progress:this._defaultOptions.progressXHRCallback}),i=this;return this._identifierMap[e]=n.then(function(e){return i._unzipTypedArray(e)}),this._identifierMap[e]},initializeBufferArray:function(e,t,n,i){if(void 0===i&&(i=this.getOptions()),i.initializeBufferArray)return i.initializeBufferArray.call(this,e,t,n);var r=e.File;return this.readBinaryArrayURL(r).then(function(i){var r,o;!function(){var e=new Uint8Array([18,52]),t=new Uint16Array(e.buffer);o="1234"===t[0].toString(16)}();var s=0;void 0!==e.Offset&&(s=e.Offset);var u=a.a[t].BYTES_PER_ELEMENT,l=e.Size,c=n.getItemSize(),d=l*u*c;if(o){h.a.log("big endian detected");var f=new(0,a.a[t])(l*c),p=new DataView(i,s,d),g=0,m=f.length;if("Uint16Array"===t)for(;g<m;g++)f[g]=p.getUint16(g*u,!0);else if("Float32Array"===t)for(;g<m;g++)f[g]=p.getFloat32(g*u,!0);r=f,p=null}else r=new a.a[t](i,s,c*l);return n.setElements(r),n})},readBufferArray:function(e){var t,n,i=this.getJSON(),o=i.UniqueID;if(void 0!==o&&void 0!==(t=this._identifierMap[o]))return t;if(void 0===e&&(e=this.getOptions()),e.readBufferArray)return e.readBufferArray.call(this);if(!i.Elements&&!i.Array||!i.ItemSize||!i.Type)return _("BufferArray",i);if(i.Elements)n=r.a.resolve(new f.a(f.a[i.Type],i.Elements,i.ItemSize));else if(i.Array){var s,u,l=new f.a(f.a[i.Type]);if(l.setItemSize(i.ItemSize),i.Array.Float32Array?(s=i.Array.Float32Array,u="Float32Array"):i.Array.Uint16Array?(s=i.Array.Uint16Array,u="Uint16Array"):i.Array.Uint8Array&&(s=i.Array.Uint8Array,u="Uint8Array"),void 0===s)return _("Typed Array "+window.Object.keys(i.Array)[0]);s.File?n=this.initializeBufferArray(s,u,l):s.Elements&&(l.setElements(new a.a[u](s.Elements)),n=r.a.resolve(l))}return void 0!==o&&(this._identifierMap[o]=n),n},readUserDataContainer:function(){var e,t=this.getJSON(),n=t.UniqueID;return void 0!==n&&void 0!==(e=this._identifierMap[n])?e.Values:(this._identifierMap[n]=t,t.Values)},readPrimitiveSet:function(){var e,t,n,i,a,o,s,u=this.getJSON(),l=u.DrawElementUShort||u.DrawElementUByte||u.DrawElementUInt||u.DrawElementsUShort||u.DrawElementsUByte||u.DrawElementsUInt,c=u.DrawArray||u.DrawArrays,h=u.DrawArrayLengths;if(l){if(void 0!==(e=l.UniqueID)&&void 0!==(t=this._identifierMap[e]))return t;a=l.Mode?v.a[l.Mode]:v.a.TRIANGLES,i=new m.a(a),this.setJSON(l.Indices),n=this.readBufferArray().then(function(e){return i.setIndices(e),i}),this.setJSON(u)}else if(c){if(void 0!==(e=c.UniqueID)&&void 0!==(t=this._identifierMap[e]))return t;a=c.Mode||c.mode,o=void 0!==c.First?c.First:c.first,s=void 0!==c.Count?c.Count:c.count,i=new p.a(v.a[a],o,s),n=r.a.resolve(i)}else if(h){if(void 0!==(e=h.UniqueID)&&void 0!==(t=this._identifierMap[e]))return t;a=h.Mode,o=h.First;var d=h.ArrayLengths;i=new g.a(v.a[a],o,d),n=r.a.resolve(i)}else n=_("PrimitiveSet",u);return void 0!==e&&(this._identifierMap[e]=n),n},readObject:function(){var e=this.getJSON(),t=window.Object.keys(e),i=t[0];if(!i)return _("can't find property for object "+t);var r,a=e[i].UniqueID;if(void 0!==a&&void 0!==(r=this._identifierMap[a]))return r;var o=this.getObjectWrapper(i);if(!o)return _("can't instanciate object "+i);var s=n("RTFJ").default.ObjectWrapper.serializers;if(this._cacheReadObject[i])s=this._cacheReadObject[i];else{for(var u=i.split("."),l=0,c=u.length;l<c;l++){var h=u[l],d=s[h];if(!d)return _("Unknown scope "+i+"("+h+")");s=d}this._cacheReadObject[i]=s}var f=s(this.setJSON(e[i]),o);return void 0!==a&&(this._identifierMap[a]=f,o._uniqueID=a),f}};t.default=b}},[["6c2W",0,1,2,4,6,5,7,8,9,10,16,11,12,13,14,15,17,35,32,23,19,28,20,30,31,29,34,18,21,22,24,25,26,27,33,36,38,39,46,49]]])});
//# sourceMappingURL=embed-8beeaa0790081df7d887274dc3dbb05e.js.map